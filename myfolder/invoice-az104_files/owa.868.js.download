self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.868.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[868,892],{1085:function(e,n,t){"use strict";function r(e){return Object.assign({__type:"PropertyUri:#Exchange"},e)}t.d(n,"a",(function(){return r}))},13389:function(e,n,t){"use strict";t.r(n);var r=t(4946),o=t(1085),i=t(2805),u=t(391),s=t(710),d=t(4128),c=t(4374),a=t(4432),l=t(167);t.d(n,"foldersWeb",(function(){return f}));const f=async(e,n,t,f)=>{var p,g;let v,y=[];(null===(p=n.options)||void 0===p?void 0:p.additionalProperties)?(y=n.options.additionalProperties.map(e=>Object(o.a)({FieldURI:e})),y.push(Object(o.a)({FieldURI:"ParentFolderId"}))):v="Folder";const I=await async function(e,n,t,r,o){return Object(a.a)({Header:Object(l.b)(),Body:Object(c.a)({FolderShape:Object(d.a)({BaseShape:"IdOnly",AdditionalProperties:e}),ShapeName:t,FolderIds:n.map(e=>Object(s.a)({Id:e}))})},Object(u.a)(r,o)).then(e=>{var n,t;return null===(t=null===(n=e.Body)||void 0===n?void 0:n.ResponseMessages)||void 0===t?void 0:t.Items})}(y,n.ids,v,null===(g=n.options)||void 0===g?void 0:g.mailboxInfo,t.requestOptions);await Object(i.a)(I);const h=[];if(I.forEach(e=>{var t;null===(t=e.Folders)||void 0===t||t.forEach(e=>{const t=Object(r.c)(e,n.options.mailboxInfo);t&&h.push(t)})}),0===h.length)throw new Error("foldersWeb: failed to get folders");return h}},167:function(e,n,t){"use strict";t.d(n,"b",(function(){return d})),t.d(n,"a",(function(){return c}));var r=t(433),o=t(558),i=t(557),u=t(395),s=t(12);function d(e){return e||(e=Object(s.a)().timezone),e?Object(r.a)({RequestServerVersion:"V2018_01_08",TimeZoneContext:Object(o.a)({TimeZoneDefinition:Object(i.a)({Id:e})})}):Object(r.a)({RequestServerVersion:"V2018_01_08"})}function c(e,n,t){return Object(u.a)({PropertySetId:e,PropertyName:n,PropertyType:t})}},19452:function(e,n,t){"use strict";t.r(n),t.d(n,"folderWeb",(function(){return o}));var r=t(13389);const o=async(e,n,t,o)=>{const i={ids:[n.id],options:n.options};return(await Object(r.foldersWeb)(e,i,t,o))[0]}},2741:function(e,n,t){"use strict";t.d(n,"f",(function(){return r})),t.d(n,"d",(function(){return o})),t.d(n,"k",(function(){return i})),t.d(n,"a",(function(){return u})),t.d(n,"h",(function(){return s})),t.d(n,"b",(function(){return d})),t.d(n,"i",(function(){return c})),t.d(n,"m",(function(){return a})),t.d(n,"l",(function(){return l})),t.d(n,"j",(function(){return f})),t.d(n,"c",(function(){return p})),t.d(n,"e",(function(){return g})),t.d(n,"g",(function(){return v}));const r=["journal","outbox","syncissues"],o="archivemsgfolderroot",i="msgfolderroot",u="archivedeleteditems",s="deleteditems",d="archiverecoverableitemsdeletions",c="recoverableitemsdeletions",a="msgfolderroot",l="sharedFolderTree",f="primaryFolderTree",p="archiveFolderTree",g="favorites",v="groups"},2805:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(2812),o=t(2810);function i(e){if(!e)return Promise.reject(Object(r.a)("500","Server returned a null response!",null));const n=Array.isArray(e)?e:[e];for(const e of n)if(e&&!Object(o.a)(e))return Promise.reject(Object(r.a)(e.ResponseCode,e.StackTrace,e.MessageText));return Promise.resolve()}},2810:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));const r="Success";function o(e){return e&&e.ResponseClass==r}},2812:function(e,n,t){"use strict";function r(e,n,t){let r="ResponseCode="+e;n&&(r+=", Stacktrace="+n);const o=new Error(r);return o.responseCode=e,o.fetchErrorType="ServerFailure",t&&(o.diagnosticInfo="MessageText= "+t),o}t.d(n,"a",(function(){return r}))},391:function(e,n,t){"use strict";function r(e,n){return e?Object.assign({mailboxInfo:e},n):null!=n?n:void 0}t.d(n,"a",(function(){return r}))},395:function(e,n,t){"use strict";function r(e){return Object.assign({__type:"ExtendedPropertyUri:#Exchange"},e)}t.d(n,"a",(function(){return r}))},4128:function(e,n,t){"use strict";function r(e){return Object.assign({__type:"FolderResponseShape:#Exchange"},e)}t.d(n,"a",(function(){return r}))},433:function(e,n,t){"use strict";function r(e){return Object.assign({__type:"JsonRequestHeaders:#Exchange"},e)}t.d(n,"a",(function(){return r}))},4374:function(e,n,t){"use strict";function r(e){return Object.assign({__type:"GetFolderRequest:#Exchange"},e)}t.d(n,"a",(function(){return r}))},4432:function(e,n,t){"use strict";var r=t(35);function o(e,n){var t;return void 0===e||e.__type||(t=e,e=Object.assign({__type:"GetFolderJsonRequest:#Exchange"},t)),Object(r.a)("GetFolder",e,n)}t.d(n,"a",(function(){return o}))},4946:function(e,n,t){"use strict";var r=function(e,n){var t,r;if(e.ExtendedProperty)for(let o=0;o<e.ExtendedProperty.length;o++){let i=e.ExtendedProperty[o];if((null===(t=null==i?void 0:i.ExtendedFieldURI)||void 0===t?void 0:t.PropertyTag)===n||(null===(r=null==i?void 0:i.ExtendedFieldURI)||void 0===r?void 0:r.PropertyName)===n)return i.Value}};var o=e=>{const n=r(e,"SourceWellKnownFolderType");return n&&parseInt(n,10)||-1};var i=e=>r(e,"0x7018")||null;var u=e=>"false"!==r(e,"0x10f4"),s=t(6546);var d=t(2741),c=t(22);function a(e,n,t,r){var o;const i=e.RootFolder;if(!i||!i.Folders||!i.ParentFolder)throw new Error("folderHierarchyWeb: failed to get folders");let s=[];null==i||i.Folders.forEach(e=>{if(e&&function(e,n,t){if(r=null==e?void 0:e.__type,"Folder:#Exchange"!=r)return!1;var r;if((null==e?void 0:e.DistinguishedFolderId)&&d.f.indexOf(e.DistinguishedFolderId)>=0)return!1;if(u(e))return!1;if("clutter"===e.DistinguishedFolderId&&0===e.TotalCount)return!1;if("junkemail"===e.DistinguishedFolderId)return!!n;if("notes"===e.DistinguishedFolderId)return!!t;return!0}(e,t,r)){const t=l(e,n);t&&s.push(t)}});const c=function(e,n){return"SharedMailbox"===n?void 0:e}((null===(o=null==i?void 0:i.ParentFolder)||void 0===o?void 0:o.DistinguishedFolderId)||"none",n.type);i.ParentFolder.DistinguishedFolderId=c;let a=l(i.ParentFolder,n);return{__typename:"FolderHierarchyResult",Folders:s,RootFolder:a,offset:i.IndexedPagingOffset,TotalItemsInView:i.TotalItemsInView,IncludesLastItemInRange:i.IncludesLastItemInRange}}function l(e,n){const t=e,{FolderId:u,ParentFolderId:d,DisplayName:a,ArchiveTag:l,PolicyTag:v,ChildFolderCount:y,UnreadCount:I,TotalCount:h,FolderClass:F,DistinguishedFolderId:b}=t;if(!u||!d)return c.h.warn("mapOWSFolderToGql: ignoring folder with missing folderId or missing parentFolderId"),null;const m=y||0,j=p(u),x=function(e){const n=r(e,s.a);if(n){const e=atob(n);return[e.substr(0,e.length-1)]}return null}(t);return{id:j.Id,__typename:"MailFolder",type:t.__type,FolderId:j,parentFolderId:p(d).Id,displayName:a||"",DistinguishedFolderId:b||null,FolderClass:F||"IPF.Note",UnreadCount:I||0,TotalCount:h||0,ArchiveTag:l?g(l):null,PolicyTag:v?g(v):null,childFolderCount:m,remoteFolderDisplayName:i(t),sourceWellKnownFolderType:o(t),replicaList:x,PermissionSet:t.PermissionSet,messageSizeInBytes:f(t),pausedTotalCount:null,principalSMTPAddress:null,mailboxInfo:{type:n.type,userIdentity:n.userIdentity,mailboxSmtpAddress:n.mailboxSmtpAddress,auxiliaryMailboxGuid:null==x?void 0:x[0]}}}function f(e){var n,t;return null===(t=null===(n=e.ExtendedProperty)||void 0===n?void 0:n[0])||void 0===t?void 0:t.Value}function p(e){return{__typename:"FolderId",Id:e.Id,ChangeKey:e.ChangeKey}}function g(e){return{__typename:"RetentionTagType",IsExplicit:!!e.IsExplicit,Value:e.Value}}t.d(n,"a",(function(){return o})),t.d(n,"b",(function(){return a})),t.d(n,"c",(function(){return l}))},557:function(e,n,t){"use strict";function r(e){return Object.assign({__type:"TimeZoneDefinitionType:#Exchange"},e)}t.d(n,"a",(function(){return r}))},558:function(e,n,t){"use strict";function r(e){return Object.assign({__type:"TimeZoneContext:#Exchange"},e)}t.d(n,"a",(function(){return r}))},6546:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));const r="0x6698"},710:function(e,n,t){"use strict";function r(e){return Object.assign({__type:"FolderId:#Exchange"},e)}t.d(n,"a",(function(){return r}))}}]);
//# sourceMappingURL=owa.868.js.map
self.scriptsLoaded['owa.868.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.868.js'] = (new Date()).getTime();