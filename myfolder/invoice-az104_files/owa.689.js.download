self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.689.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[689],{10418:function(e,t,n){var a=n(10419);"string"==typeof a&&(a=[[e.i,a,""]]);var i={transform:void 0};n(84)(a,i);a.locals&&(e.exports=a.locals)},10419:function(e,t,n){(t=e.exports=n(83)(!1)).push([e.i,"._1Q3scbUvAgP_hRG7PGakn{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}@media screen and (-ms-high-contrast:active){._3QEIhGWDMMp1pnzADGXRY_,._1dI05iBqLNzdMiJK1FVA3F{-ms-high-contrast-adjust:none;color:var(--neutralSecondary)}}._1dI05iBqLNzdMiJK1FVA3F._2ku0nP_adSQL2THBkixc3i,._1dI05iBqLNzdMiJK1FVA3F._17rHATEhMrMW5NmE1nKUmX{font-weight:400;font-size:11px}._1dI05iBqLNzdMiJK1FVA3F._1MTQd-7t9b-A4dhjUuoYbO{font-size:12px}@media screen and (-ms-high-contrast:active){._12YqE07cIgWKRg9SsAMfXH{-ms-high-contrast-adjust:none;color:var(--neutralSecondary)}}",""]),t.locals={textOverFlow:"_1Q3scbUvAgP_hRG7PGakn",firstLineCommonStyle:"_3QEIhGWDMMp1pnzADGXRY_",firstLineCommonStyleNext:"_1dI05iBqLNzdMiJK1FVA3F",compact:"_2ku0nP_adSQL2THBkixc3i",medium:"_17rHATEhMrMW5NmE1nKUmX",full:"_1MTQd-7t9b-A4dhjUuoYbO",secondLineCommonStyle:"_12YqE07cIgWKRg9SsAMfXH"}},10420:function(e){e.exports=JSON.parse('{"a":"ODb"}')},10421:function(e){e.exports=JSON.parse('{"a":"NDb"}')},10422:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(22);class i{constructor(e=5,t=5e3){this.throttleCallbacks=[],this.activeRequests=0,this.processedRequests=0,this.lastProcessedRequests=0,this.watchDogTimer=null,this.clearQueue=()=>{this.throttleCallbacks.length=0,this.activeRequests=0},this.maxConcurrentRequests=e,this.watchDogTimerInterval=t}watchDogAction(){this.throttleCallbacks.length>0?this.processedRequests===this.lastProcessedRequests?(this.activeRequests=0,this.traceInfo("Watch dog is processing the queue."),this.processNextRequest()):(this.traceInfo("Watch dog is watching."),this.lastProcessedRequests=this.processedRequests):(window.clearInterval(this.watchDogTimer),this.watchDogTimer=null,this.traceInfo("Stop watch dog."))}traceInfo(e){a.h.info(`ThrottleRequests:active=${this.activeRequests};throttled=${this.throttleCallbacks.length};processed=${this.processedRequests};lastProcessed=${this.lastProcessedRequests};info=${e}`)}processNextRequest(){if(this.processedRequests++,0===this.throttleCallbacks.length)this.activeRequests>0&&this.activeRequests--,this.traceInfo("Queue is empty.");else{this.throttleCallbacks.shift()(!1),this.traceInfo("Process next.")}}registerCallback(e){if(null==e)throw new Error("A null callback is registered to Throttle Thumbnails queue.");this.activeRequests<this.maxConcurrentRequests?(e(!1),this.activeRequests++,this.processedRequests++,this.traceInfo("Process now.")):(e(!0),this.throttleCallbacks.push(e),this.traceInfo("Pushes to queue."),this.watchDogTimer||(this.watchDogTimer=window.setInterval(()=>{this.watchDogAction()},this.watchDogTimerInterval),this.traceInfo("Start watch dog.")))}unregisterCallback(e){const t=this.throttleCallbacks.indexOf(e);this.throttleCallbacks.splice(t,1),this.activeRequests=0,this.traceInfo("unregisterComponent:"+t)}}},1087:function(e,t,n){"use strict";function a(e){return Object.assign({__type:"ItemResponseShape:#Exchange"},e)}n.d(t,"a",(function(){return a}))},14092:function(e){e.exports=JSON.parse('{"a":"PDb"}')},14093:function(e,t,n){var a=n(14094);"string"==typeof a&&(a=[[e.i,a,""]]);var i={transform:void 0};n(84)(a,i);a.locals&&(e.exports=a.locals)},14094:function(e,t,n){(t=e.exports=n(83)(!1)).push([e.i,"._29iMsAUBV8TBh-CNKxOhvl{-o-object-fit:cover;object-fit:cover}html[dir] ._29iMsAUBV8TBh-CNKxOhvl{border-radius:2px}._2xjehIMS7slIB7r1my5d77{position:relative;display:-webkit-box;display:-ms-flexbox;display:flex}._3B8kLim5qpzi0KdGPiH978{position:absolute}._1bh6FyX3OBoMdZ2PDomfnY,._3B8kLim5qpzi0KdGPiH978{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}",""]),t.locals={thumbnail:"_29iMsAUBV8TBh-CNKxOhvl",spanContainer:"_2xjehIMS7slIB7r1my5d77",notLoadedContainer:"_3B8kLim5qpzi0KdGPiH978",errorLoadingContainer:"_1bh6FyX3OBoMdZ2PDomfnY"}},14095:function(e,t,n){var a=n(14096);"string"==typeof a&&(a=[[e.i,a,""]]);var i={transform:void 0};n(84)(a,i);a.locals&&(e.exports=a.locals)},14096:function(e,t,n){(t=e.exports=n(83)(!1)).push([e.i,"._1w19voRbzfxyIaCyHTgAys{font-size:12px;width:256px}html[dir] ._1w19voRbzfxyIaCyHTgAys{padding:8px}.yEnxHvN6fEVj29kqA0sBy{z-index:20}html[dir=ltr] .yEnxHvN6fEVj29kqA0sBy{margin:3px 0 0 4px}html[dir=rtl] .yEnxHvN6fEVj29kqA0sBy{margin:3px 4px 0 0}",""]),t.locals={callout:"_1w19voRbzfxyIaCyHTgAys",iconStyle:"yEnxHvN6fEVj29kqA0sBy"}},14097:function(e,t,n){var a=n(14098);"string"==typeof a&&(a=[[e.i,a,""]]);var i={transform:void 0};n(84)(a,i);a.locals&&(e.exports=a.locals)},14098:function(e,t,n){(t=e.exports=n(83)(!1)).push([e.i,"._33FC7KaXt2pXlV9AgZXmXD{-webkit-box-flex:2;-ms-flex-positive:2;flex-grow:2;overflow-x:hidden}._3fniE9D61r0OcjYhRCGidx{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:30px;min-width:0}html[dir] ._3fniE9D61r0OcjYhRCGidx{border:1px solid var(--neutralLight);border-radius:4px}html[dir=ltr] ._3fniE9D61r0OcjYhRCGidx{padding-right:8px}html[dir=rtl] ._3fniE9D61r0OcjYhRCGidx{padding-left:8px}.ABy839_TqozYiNjJlPihy:hover{cursor:pointer;color:var(--themeSecondary)}html[dir] .ABy839_TqozYiNjJlPihy:hover{background-color:var(--neutralLight)}._2jSg_DFMBvtIixXXOj-1Io{min-width:16px}html[dir] ._2jSg_DFMBvtIixXXOj-1Io{margin:10px}",""]),t.locals={attachmentText:"_33FC7KaXt2pXlV9AgZXmXD",attachmentDocView:"_3fniE9D61r0OcjYhRCGidx",attachmentDocViewHover:"ABy839_TqozYiNjJlPihy",attachmentIcon:"_2jSg_DFMBvtIixXXOj-1Io"}},1462:function(e,t,n){"use strict";function a(e){return Object.assign({__type:"FindItemJsonRequest:#Exchange"},e)}n.d(t,"a",(function(){return a}))},1490:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(35),i=n(1462);function o(e,t){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(a.a)("FindItem",e,t)}},1498:function(e,t,n){"use strict";function a(e){return Object.assign({__type:"FindItemRequest:#Exchange"},e)}n.d(t,"a",(function(){return a}))},2352:function(e,t,n){"use strict";e.exports=function(e,t){return"string"!=typeof e?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),/["'() \t\n]/.test(e)||t?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e)}},2665:function(e,t,n){"use strict";n.r(t);var a=n(21),i=n(9097),o=n(2778),r=n(0);var s=Object(a.a)((function(e){const t=Object(o.a)(e.attachmentId),n=1===t.type;let a=!!n&&t.model.AttachmentIsFolder,s=null;return n||2!==t.type||(s=t.model.EmbeddedItemClass||"IPM.Note"),r.createElement(i.b,{contentType:t.model.ContentType,customizeStyle:e.className,embeddedItemClass:s,fileName:t.model.Name,iconSize:e.iconSize,isBlocked:1===t.attachmentClass,isCloudy:n,isFolder:a,useCloudIcon:e.useCloudIcon})})),c=n(9152),l=Object(a.a)((function(e){const t=Object(c.a)(e.attachmentViewState,e.attachment),n=Object(c.c)(e.attachmentViewState,e.attachment);return r.createElement(i.a,{firstLineStyle:e.firstLineStyle,firstLineText:e.attachment.model.Name,firstLineTitle:t,highlightAttachmentName:e.highlightAttachmentName,isShortDocView:e.isShortDocView,secondLineStyle:e.secondLineStyle,secondLineText:n.text,secondLineTitle:n.title?n.title:t})})),u=n(365),d=n(53),h=n(351),m=n(2936),f=n(8005),p=n(6),b=n(14092),w=n(10422),v=n(77),x=n.n(v),g=n(14093),I=n.n(g);const y=new w.a(5,5e3);var O=Object(a.a)((function(e){r.useEffect(()=>(y.registerCallback(s),()=>{a&&y.unregisterCallback(s)}),[]),r.useEffect(()=>{const{attachmentId:t,isReadOnly:a,isPlaceholderAttachment:i}=e.attachmentViewState;i||(async()=>{await Object(f.a)(t,a);const e=Object(o.a)(t).thumbnailImage.url;n(e)})()},[]),r.useEffect(()=>{n(e.thumbnailUrl)},[e.thumbnailUrl]);const[t,n]=r.useState(e.thumbnailUrl),[a,i]=r.useState(!0),s=e=>{i(e)},c=e.attachmentViewState.thumbnailLoadState;return r.createElement("span",{className:I.a.spanContainer},(a||0===c)&&r.createElement("div",{className:I.a.notLoadedContainer,style:{height:e.thumbnailHeight,width:e.thumbnailWidth}},e.fileIconCssClass?r.createElement("span",{className:e.imageLoadErrorCSSClass}):r.createElement(h.a,Object.assign({},e.placeHolder))),2===c&&r.createElement("div",{className:I.a.errorLoadingContainer,style:{height:e.thumbnailHeight,width:e.thumbnailWidth}},e.imageLoadErrorCSSClass?r.createElement("span",{className:e.imageLoadErrorCSSClass}):r.createElement(h.a,Object.assign({},e.placeHolder))),2!==c&&r.createElement(u.a,{src:a?"":t,onError:t=>{a||(y.processNextRequest(),Object(m.i)(e.attachmentViewState,2),e.onImageLoadError&&e.onImageLoadError())},onLoad:t=>{a||(y.processNextRequest(),Object(m.i)(e.attachmentViewState,1))},width:e.thumbnailWidth,height:e.thumbnailHeight,className:e.customThumbnailCssClass?e.customThumbnailCssClass:I.a.thumbnail,imageFit:e.fileIconCssClass?d.b.contain:d.b.cover,alt:Object(p.b)(b.a)}),1===c&&e.fileIconCssClass&&r.createElement("span",{style:e.customFileIconCssClass?null:{position:"absolute",top:5-e.thumbnailHeight,left:5},className:x()(e.fileIconCssClass,e.customFileIconCssClass)}))})),C=n(168),T=n(3114),A=n(2851),k=n(7455),j=n(3254),E=n(6935),S=n(3318),D=n(1251),N=n(57),_=n(159),P=n(3378),L=n(14095),M=Object(a.a)((function(){const[e,t]=r.useState(!1),n=r.useCallback(n=>{n.stopPropagation(),t(!e)},[e]),a="calloutId"+Object(_.a)();return r.createElement(r.Fragment,null,r.createElement(h.a,{id:a,iconName:"Info",className:L.iconStyle,onClick:n}),r.createElement(D.a,{hidden:!e,className:L.callout,onDismiss:n,directionalHint:N.a.rightCenter,isBeakVisible:!0,target:"#"+a},Object(p.b)(P.a)))})),R=n(14097);var F=Object(a.a)((function({attachment:e,parentItemId:t,isShortDocView:n,useCloudIcon:a,showInfoIcon:s}){const l=e.AttachmentId.Id,u=Object(S.d)(),d=l&&1!=u,h=r.useCallback(()=>{d&&Object(E.a)(t,l,!1)},[e]),m={Id:l,mailboxInfo:Object(C.d)()};!async function(e,t){(await A.d.import())([{attachmentId:e,attachment:t}],!0)}(m,e);const f=Object(o.a)(m);if(!f)return null;const p=Object(T.a)(e),b=Object(j.b)(e,!0),w=Object(k.a)(b,e),v=1===p,g=!!v&&!!e.AttachmentIsFolder;let I=null;v||2!==p||(I=e.EmbeddedItemClass||"IPM.Note");const y=Object(c.b)(f,v),O=x()(R.attachmentDocView,{[R.attachmentDocViewHover]:d});return r.createElement("div",{className:x()(O),onClick:h},r.createElement(i.b,{contentType:e.ContentType?e.ContentType:"",customizeStyle:R.attachmentIcon,embeddedItemClass:I||void 0,fileName:e.Name?e.Name:"",iconSize:0,isBlocked:1===w,isCloudy:v,isFolder:g,useCloudIcon:a}),r.createElement("div",{className:R.attachmentText},r.createElement(i.a,{firstLineText:e.Name?e.Name:"",firstLineTitle:y,isShortDocView:n})),s&&!d&&r.createElement(M,null))}));n.d(t,"AttachmentIconView",(function(){return s})),n.d(t,"AttachmentDocInfoView",(function(){return l})),n.d(t,"AttachmentThumbnailView",(function(){return O})),n.d(t,"AttachmentDocView",(function(){return F}))},2761:function(e,t,n){"use strict";function a(e,t){Object.keys(t).forEach(n=>e.set(n,t[n]))}function i(e){let t=null!=e?e:{headers:new Headers};return t.datapoint=t.datapoint||{},t.datapoint.mailbox="Default",t}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}))},2762:function(e,t,n){"use strict";var a=n(2820),i=n(284),o=n(753),r=n(68),s=n(5),c=n(22);const l="X-AnchorMailbox",u="Authorization",d="X-OwaWebSessionType",h="X-OWA-ExplicitLogonUser";async function m(e,t){const n={},m=Object(i.k)(e);if(m){if(m.accountState==i.b.AccessRevoked)return null;if(m.accountState==i.b.AccountDeprovisioned||m.accountState==i.b.AccountNotFound)return Object(i.d)(m.accountState,m.accountProviderType),null}if(t?(n[l]=t,n[h]=t):m&&(n[l]=m.anchorMailbox),m){let t,i=m.token,l=Object(o.g)(m.tokenExpiry);!l&&i||(Object(r.p)("getAndUpdateAccessToken",{tokenExpiry:Object(s.y)(m.tokenExpiry,Object(s.Tb)()),isTokenExpired_1:l,isTokenInvalid_2:!i},{isCore:!0}),i=await a.a.importAndExecute(m.accountId,e,i),c.h.info("[AccountLoadRecovery] getConnectedAccountHeaders: finished GetAndUpdateAccessToken for "+e+i),i||(i="")),"Outlook"==m.accountProviderType?(t=`MSAuth1.0 usertoken="${i}", type="MSACT"`,n[d]=1..toString()):"Google"!=m.accountProviderType&&"ICloud"!=m.accountProviderType&&"Yahoo"!=m.accountProviderType||(t=`Bearer ${i}`,n[d]=2..toString()),n[u]=t}return n}var f=n(2761);async function p(e,t){const n=Object(f.a)();return n.headers=await async function(e,t){var n;const a=t&&(null===(n=e.headers)||void 0===n?void 0:n.set)?new Headers(e.headers):new Headers,i=await m(e.mailboxInfo.userIdentity,b(e.mailboxInfo.type,e.mailboxInfo.mailboxSmtpAddress)?e.mailboxInfo.mailboxSmtpAddress:null);return Object(f.b)(a,i),a}(e,t),n.authNeededOnUnAuthorized=!1,n.datapoint=n.datapoint||{},n.datapoint.mailbox="Connected",n}function b(e,t){const n="GroupMailbox"==e||"TeamsMailbox"==e||"SharedMailbox"==e||"PublicMailbox"==e;return n&&null==t&&c.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return b}))},2763:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2);const i=Object(a.action)("triggerReInitializeAccount",e=>({userIdentity:e}))},2820:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(20),i=n(2763);n.d(t,"b",(function(){return i.a}));const o=new a.c(()=>n.e(1069).then(n.bind(null,3034))),r=new a.a(o,e=>e.getAndUpdateAccessToken)},2851:function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"l",(function(){return l})),n.d(t,"h",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"k",(function(){return h})),n.d(t,"j",(function(){return m})),n.d(t,"i",(function(){return f})),n.d(t,"g",(function(){return p})),n.d(t,"e",(function(){return b})),n.d(t,"m",(function(){return w}));var a=n(20),i=n(2990);n.d(t,"n",(function(){return i.a})),n.d(t,"o",(function(){return i.b})),n.d(t,"p",(function(){return i.c}));var o=n(2961);n.d(t,"a",(function(){return o.a}));var r=n(3106);n.d(t,"c",(function(){return r.a})),n.d(t,"b",(function(){return r.b}));const s=new a.c(()=>Promise.all([n.e(0),n.e(25),n.e(29),n.e(50),n.e(299),n.e(667)]).then(n.bind(null,4804))),c=new a.a(s,e=>e.addAndInitializeAttachments),l=new a.a(s,e=>e.setPreviewImageUrl),u=new a.a(s,e=>e.refreshDownloadUrl),d=new a.a(s,e=>e.createAttachmentInfo),h=new a.a(s,e=>e.setAttachmentInfo),m=new a.a(s,e=>e.refreshThumbnailImageUrl),f=new a.a(s,e=>e.refreshPreviewImageUrl),p=new a.b(s,e=>e.getAttachment),b=new a.b(s,e=>e.checkPendingAttachmentOperation),w=new a.b(s,e=>e.shouldShowImageView)},2855:function(e,t,n){"use strict";function a(e){return Object.assign({__type:"IndexedPageView:#Exchange"},e)}n.d(t,"a",(function(){return a}))},2936:function(e,t,n){"use strict";var a=n(3126),i=n(3098),o=n(2851),r=n(3114),s=n(3578),c=n(2852);function l(e,t,n,l){if(Object(o.c)(n))return function(e){return 2===Object(r.a)(e)?h():u()}(n);if(3===Object(r.a)(n)&&!l)return d();let m;switch(t){case 2:m={allowEdit:!1,previewMethod:i.a.Image,supportedOpenActions:[a.a.Preview,a.a.Download]};break;case 3:m={allowEdit:!1,previewMethod:i.a.NativeView,supportedOpenActions:[a.a.Preview,a.a.Download]};break;case 6:m={allowEdit:!1,previewMethod:i.a.GoogleDoc,supportedOpenActions:[a.a.Preview]};break;case 4:m={allowEdit:e.wacEdit,previewMethod:i.a.Wac,supportedOpenActions:[a.a.Preview,a.a.Download]};break;case 5:m={allowEdit:!1,previewMethod:i.a.Audio,supportedOpenActions:[a.a.Preview,a.a.Download]};break;case 7:m={allowEdit:!1,previewMethod:i.a.PdfJs,supportedOpenActions:[a.a.Preview]};break;case 8:case 9:case 10:m=h();break;case 11:m={allowEdit:!1,previewMethod:i.a.Text,supportedOpenActions:[a.a.Preview,a.a.Download]};break;case 12:m={allowEdit:!1,previewMethod:i.a.Video,supportedOpenActions:[a.a.Preview,a.a.Download]};break;case 1:m={allowEdit:!1,previewMethod:i.a.Unsupported,supportedOpenActions:[]};break;case 13:m={allowEdit:!1,previewMethod:i.a.CalendarEvent,supportedOpenActions:[a.a.Preview,a.a.Download]};break;default:m=function(e){return Object(s.a)(e)||Object(c.a)(e)}(n)?d():u()}return m}function u(){return{allowEdit:!1,previewMethod:i.a.Unsupported,supportedOpenActions:[a.a.Download]}}function d(){return{allowEdit:!1,previewMethod:i.a.Unsupported,supportedOpenActions:[a.a.OpenInNewTab]}}function h(){return{allowEdit:!1,previewMethod:i.a.ItemAttachment,supportedOpenActions:[a.a.Preview,a.a.Download]}}var m=n(2),f=Object(m.mutatorAction)("setIsPlaceholderAttachment",(function(e,t){e.isPlaceholderAttachment=t})),p=Object(m.mutatorAction)("setThumbnailLoadState",(function(e,t){e.thumbnailLoadState=t}));function b(e,t,n,a,o,r=null){return{attachmentId:e,thumbnailLoadState:0,previewLoaded:!1,isCloudy:n,isReadOnly:t,isPlaceholderAttachment:a,strategy:{allowEdit:!1,previewMethod:i.a.Unsupported,supportedOpenActions:[]},parentItemId:r,fileType:o}}var w,v=n(30);function x(){return Object(v.a)().SessionSettings.CompanyName}function g(e){return e.supportedOpenActions.length&&e.supportedOpenActions[0]||a.a.NoAction}!function(e){e[e.MailList=0]="MailList",e[e.ReadingPane=1]="ReadingPane",e[e.FilesHub=2]="FilesHub",e[e.PhotoHub=3]="PhotoHub",e[e.GroupFilesHub=4]="GroupFilesHub",e[e.ConversationAttachmentWell=5]="ConversationAttachmentWell",e[e.Deeplink=6]="Deeplink",e[e.FileSuggestion=7]="FileSuggestion",e[e.LinkSuggestion=8]="LinkSuggestion",e[e.ComposeDocLink=9]="ComposeDocLink",e[e.ReadingPaneDocLink=10]="ReadingPaneDocLink",e[e.ConsumerGroupFilesHub=11]="ConsumerGroupFilesHub",e[e.FolderTree=12]="FolderTree"}(w||(w={})),n.d(t,"e",(function(){return l})),n.d(t,"h",(function(){return f})),n.d(t,"i",(function(){return p})),n.d(t,"d",(function(){return b})),n.d(t,"g",(function(){return x})),n.d(t,"f",(function(){return g})),n.d(t,"b",(function(){return i.a})),n.d(t,"a",(function(){return a.a})),n.d(t,"c",(function(){return w}))},2951:function(e,t){e.exports=function(e){return e instanceof Date}},2961:function(e,t,n){"use strict";var a=n(13),i=n(2);const o={attachments:new a.ObservableMap({})},r=Object(i.createStore)("attachment",o);t.a=r},2990:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r}));var a=n(2);const i=Object(a.action)("REFRESH_SHARING_TIPS_FOR_ATTACHMENT",e=>({attachmentId:e})),o=Object(a.action)("SET_ATTACHMENT_CONTENTID",(e,t)=>({attachmentId:e,attachmentContentId:t})),r=Object(a.action)("SET_ATTACHMENT_ISINLINE",(e,t)=>({attachmentId:e,isInline:t}))},3030:function(e,t,n){var a=n(2951),i=36e5,o=6e4,r=2,s=/[T ]/,c=/:/,l=/^(\d{2})$/,u=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],d=/^(\d{4})/,h=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],m=/^-(\d{2})$/,f=/^-?(\d{3})$/,p=/^-?(\d{2})-?(\d{2})$/,b=/^-?W(\d{2})$/,w=/^-?W(\d{2})-?(\d{1})$/,v=/^(\d{2}([.,]\d*)?)$/,x=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,g=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,I=/([Z+-].*)$/,y=/^(Z)$/,O=/^([+-])(\d{2})$/,C=/^([+-])(\d{2}):?(\d{2})$/;function T(e,t,n){t=t||0,n=n||0;var a=new Date(0);a.setUTCFullYear(e,0,4);var i=7*t+n+1-(a.getUTCDay()||7);return a.setUTCDate(a.getUTCDate()+i),a}e.exports=function(e,t){if(a(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?r:Number(n);var A=function(e){var t,n={},a=e.split(s);c.test(a[0])?(n.date=null,t=a[0]):(n.date=a[0],t=a[1]);if(t){var i=I.exec(t);i?(n.time=t.replace(i[1],""),n.timezone=i[1]):n.time=t}return n}(e),k=function(e,t){var n,a=u[t],i=h[t];if(n=d.exec(e)||i.exec(e)){var o=n[1];return{year:parseInt(o,10),restDateString:e.slice(o.length)}}if(n=l.exec(e)||a.exec(e)){var r=n[1];return{year:100*parseInt(r,10),restDateString:e.slice(r.length)}}return{year:null}}(A.date,n),j=k.year,E=function(e,t){if(null===t)return null;var n,a,i,o;if(0===e.length)return(a=new Date(0)).setUTCFullYear(t),a;if(n=m.exec(e))return a=new Date(0),i=parseInt(n[1],10)-1,a.setUTCFullYear(t,i),a;if(n=f.exec(e)){a=new Date(0);var r=parseInt(n[1],10);return a.setUTCFullYear(t,0,r),a}if(n=p.exec(e)){a=new Date(0),i=parseInt(n[1],10)-1;var s=parseInt(n[2],10);return a.setUTCFullYear(t,i,s),a}if(n=b.exec(e))return o=parseInt(n[1],10)-1,T(t,o);if(n=w.exec(e)){o=parseInt(n[1],10)-1;var c=parseInt(n[2],10)-1;return T(t,o,c)}return null}(k.restDateString,j);if(E){var S,D=E.getTime(),N=0;return A.time&&(N=function(e){var t,n,a;if(t=v.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*i;if(t=x.exec(e))return n=parseInt(t[1],10),a=parseFloat(t[2].replace(",",".")),n%24*i+a*o;if(t=g.exec(e)){n=parseInt(t[1],10),a=parseInt(t[2],10);var r=parseFloat(t[3].replace(",","."));return n%24*i+a*o+1e3*r}return null}(A.time)),A.timezone?S=function(e){var t,n;if(t=y.exec(e))return 0;if(t=O.exec(e))return n=60*parseInt(t[2],10),"+"===t[1]?-n:n;if(t=C.exec(e))return n=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-n:n;return 0}(A.timezone):(S=new Date(D+N).getTimezoneOffset(),S=new Date(D+N+S*o).getTimezoneOffset()),new Date(D+N+S*o)}return new Date(e)}},3098:function(e,t,n){"use strict";var a;!function(e){e[e.Unsupported=0]="Unsupported",e[e.Image=1]="Image",e[e.MailItem=2]="MailItem",e[e.CalendarEvent=3]="CalendarEvent",e[e.Wac=4]="Wac",e[e.SuiteExtensions=5]="SuiteExtensions",e[e.Audio=6]="Audio",e[e.Text=7]="Text",e[e.NativeView=8]="NativeView",e[e.GoogleDoc=9]="GoogleDoc",e[e.PdfJs=10]="PdfJs",e[e.ItemAttachment=11]="ItemAttachment",e[e.Video=12]="Video"}(a||(a={})),t.a=a},3106:function(e,t,n){"use strict";function a(e){return(null==e?void 0:e.AttachmentId)&&i(e.AttachmentId.Id)}function i(e){return e&&-1!==e.indexOf("smime-")}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}))},3114:function(e,t,n){"use strict";var a=n(1427),i=n(6);const o=e=>e&&["IPM.Note","IPM.Schedule.Meeting","IPM.GroupMailbox.JoinRequest","IPM.Post"].includes(e);function r(e){const t=e.__type||e.OwsTypeName;switch(t){case a.a:return 0;case a.e:return e.IsLink?3:1;case a.d:return 3;case a.b:return 2;case a.c:const n=e,r=e.EmbeddedItemClass;return r&&o(r)||Object(i.j)(n.AttachmentIdToAttach)?2:0;default:throw new Error(`Invalid type of attachment ${t}`)}}n.d(t,"a",(function(){return r}))},3126:function(e,t,n){"use strict";var a;!function(e){e[e.NoAction=0]="NoAction",e[e.Preview=1]="Preview",e[e.Download=2]="Download",e[e.OpenInNewTab=3]="OpenInNewTab"}(a||(a={})),t.a=a},3578:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(1427);function i(e){return(e.__type||e.OwsTypeName)===a.d}},462:function(e,t,n){"use strict";class a{constructor(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}add(e){this.taskList.unshift(e),this.scheduleTask()}clear(){this.taskList.splice(0,this.taskList.length)}canRunMoreTasks(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0}scheduleTask(){this.canRunMoreTasks()&&setTimeout(()=>{this.tryRunTask()},this.taskDelay)}onTaskComplete(){this.numberOfTasksRunning--,this.scheduleTask()}tryRunTask(){if(this.canRunMoreTasks()){let e=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(e).then(()=>{this.onTaskComplete()}).catch(()=>{this.onTaskComplete()}),this.scheduleTask()}}}n.d(t,"a",(function(){return a}))},6935:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(20);const i=new a.c(()=>n.e(2149).then(n.bind(null,9929))),o=new a.a(i,e=>e.previewAttachmentInPopOut).importAndExecute},8376:function(e,t,n){var a=n(8377);"string"==typeof a&&(a=[[e.i,a,""]]);var i={transform:void 0};n(84)(a,i);a.locals&&(e.exports=a.locals)},8377:function(e,t,n){(t=e.exports=n(83)(!1)).push([e.i,"._3y2-q_CzC1YITIEDtX-IUI,._35WXVW2VlSBf5JBAejKLlt{width:32px;height:32px;display:inline-block}html[dir] ._3y2-q_CzC1YITIEDtX-IUI,html[dir] ._35WXVW2VlSBf5JBAejKLlt{background-color:transparent}._3y2-q_CzC1YITIEDtX-IUI{width:16px;height:16px}html[dir] .fPFlBAuQpX1HDftEw0nbj{margin:10px 10px 10px 10px}",""]),t.locals={extraSmallIcon:"_3y2-q_CzC1YITIEDtX-IUI",icon:"_35WXVW2VlSBf5JBAejKLlt",iconDefault:"fPFlBAuQpX1HDftEw0nbj"}},9097:function(e,t,n){"use strict";var a=n(6),i=n(21),o=n(3373),r=n(0),s=n(8376),c=n.n(s),l=n(209),u=n.n(l);const d=u.a.bind(c.a);var h=Object(i.a)((function(e){const{contentType:t,customizeStyle:n,embeddedItemClass:i,fileName:s,iconSize:l,isBlocked:u,isCloudy:h,isFolder:m,useCloudIcon:f}=e;if(f&&h)return r.createElement(o.a,{fileName:s,contentType:t,isBlocked:u,isFolder:m,embeddedItemClass:null});let p;const b=0===l;return p=b?Object(o.f)(s,t,u,m,i).extraSmall:Object(o.f)(s,t,u,m,i).medium,r.createElement("div",{className:d(b?c.a.extraSmallIcon:c.a.icon,Object(a.j)(n)?c.a.iconDefault:n,p)})})),m=n(25),f=n(109),p=n(10418),b=n.n(p);const w=u.a.bind(b.a),v=Object(m.k)("mon-densities"),x=Object(f.e)();var g=Object(i.a)((function(e){const{firstLineTitle:t,firstLineText:n,secondLineTitle:a,secondLineText:i,highlightAttachmentName:o}=e;return e.isShortDocView?r.createElement("div",{className:w(v?b.a.firstLineCommonStyleNext:b.a.firstLineCommonStyle,v&&x,e.firstLineStyle,b.a.textOverFlow),title:t,ref:o},n):r.createElement(r.Fragment,null,r.createElement("div",{className:w(v?b.a.firstLineCommonStyleNext:b.a.firstLineCommonStyle,v&&x,e.firstLineStyle,b.a.textOverFlow),title:t},n),r.createElement("div",{title:a,className:w(b.a.secondLineCommonStyle,e.secondLineStyle,b.a.textOverFlow)},i))}));n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return g}))},9152:function(e,t,n){"use strict";function a(e,t){var n;const a=e?null===(n=new URL(e))||void 0===n?void 0:n.hostname:null;return null!=a?a:t}var i=n(9388),o=n(25),r=n(2767),s=n(10421),c=n(6);function l(e,t){return u(t,e.isCloudy)}function u(e,t){let n=e.model.Name;if(t){const t=e;let a;a=Object(o.k)("doc-unwrap-safelinks")?t.originalUrl:t.openUrl,a||(a=e.model.AttachLongPathName),a&&(n=Object(c.c)(Object(c.b)(s.a),e.model.Name,a))}return n}function d(e,t){var n,o;if(e.isCloudy){const r=t.model;if(e.isReadOnly)return{text:a(t.openUrl,r.AttachLongPathName||null),title:null};const s=null===(o=null===(n=t.info)||void 0===n?void 0:n.sharingInfo)||void 0===o?void 0:o.expirationDate,c=Object(i.a)(r.PermissionType,r.ProviderType,s,e.isPlaceholderAttachment);return{text:c,title:c}}const s=t.model.Size>0?Object(r.i)(t.model.Size):null;return{text:s,title:s}}n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d}))},9388:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(10420),i=n(6),o=n(3997),r=n(25),s=n(5);function c(e,t,n=null,c=!1){return null==e||c?null:Object(r.k)("doc-attachment-referenceAttachmentExpiration")&&n&&Object(s.Jb)(n,Object(s.Tb)())?Object(i.c)(Object(i.b)(a.a),n):Object(o.d)(e,t)}}}]);
//# sourceMappingURL=owa.689.js.map
self.scriptsLoaded['owa.689.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.689.js'] = (new Date()).getTime();