self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.153.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[153],{4049:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2);const a=Object(r.action)("__DIAGNOSTICS_ADD_E2E_TIME_TO_DIAGNOSTICS_STORE",(e,t)=>({jsEndToEndTime:e,jsRenderingTime:t}))},4814:function(e,t,n){"use strict";var r=n(4049),a=n(20);const i=new a.c(()=>Promise.all([n.e(15),n.e(16),n.e(20),n.e(69),n.e(83),n.e(133),n.e(158),n.e(1005)]).then(n.bind(null,20185))),o=new a.b(i,e=>e.addSearchRequestInstrumentation),l=new a.b(i,e=>e.addResourceTimingEntry),c=new a.b(i,e=>e.searchDiagnostics),s=()=>{const e=c.tryImportForRender(),t=e?e.getIfInitialized():null;return t?t.searchInstrumentationList:[]};n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return l}))},5361:function(e,t,n){"use strict";var r=n(2),a=n(2735);t.a=Object(r.mutatorAction)("setCurrentSearchQueryId",(e,t)=>{Object(a.d)(t).currentSearchQueryId=e})},5970:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"AttachmentItemsPagingDetails:#Exchange"},e)}var a=n(2855),i=n(35);function o(e){return Object.assign({__type:"SearchAttachmentDataProviderItemsRequest:#Exchange"},e)}var l=n(22);function c(e,t,n,r){return e?n(e):(l.h.warn(null==t?void 0:t.statusText),404===(null==t?void 0:t.status)?r(4):401===(null==t?void 0:t.status)||403===(null==t?void 0:t.status)?r(2):r(1))}const s=Object.freeze({SortColumn:2,SortOrder:1}),u="maxResults=1000&fields=nextPageToken,files(id,mimeType,name,size,modifiedTime,thumbnailLink,webViewLink,webContentLink,createdTime,fileExtension)",d="GDriveDataProviderItem:#Exchange",m="FacebookDataProviderItem:#Exchange",f="FileAttachmentDataProviderItem:#Exchange",h="FolderAttachmentDataProviderItem:#Exchange",p="OneDriveProScope:#Exchange",b="OneDriveProItemSkipTokenPagingMetadata:#Client",y="OneDriveConsumerScope:#Exchange",g="oneNote",v="application/onenote";var I=n(3758);function T(e,t){return{TotalItemCount:e.length,ResultCode:0,Items:e.map(e=>t(e))}}function O(e){return{TotalItemCount:0,ResultCode:e,Items:[]}}const w="application/vnd.google-apps.folder";function j(e){return{__type:d,Name:e.name,Size:parseInt(e.size),Thumbnail:{Url:e.thumbnailLink},Preview:{Url:e.thumbnailLink+"2"},CreatedTime:e.createdTime,DownloadUrl:e.webContentLink,WebViewLink:e.webViewLink,FileExtension:e.fileExtension,Modified:e.modifiedTime,MimeType:e.mimeType,Location:e.id,Id:e.id,AttachmentProviderId:null,ProviderType:5,Type:e.mimeType===w?1:0}}function P(e){return Object.assign(Object.assign({},T(e.files,j)),{NextPageToken:e.nextPageToken})}function S(e){return Object.assign(Object.assign({},O(e)),{NextPageToken:null})}async function D(e,t=!1){const{errorResponse:n,result:r}=await Object(I.m)(e,t);return r?c(r,null,P,S):c(null,n,P,S)}var C=n(5361),_=n(3409);function k(e){var t;return(null===(t=e.From)||void 0===t?void 0:t.Mailbox)?e.From.Mailbox.Name:null}function E(e){return{__type:e.__type,Id:e.ItemId.Id,AttachmentProviderId:null,ProviderType:10,Type:0,Size:e.Size,From:k(e),Subject:e.Subject,ReceivedDate:e.DateTimeSent,MessagePreview:e.Preview,IsRead:e.IsRead}}const R=e=>T(e,E);var x=n(159),M=n(167),A=n(2738),F=n(2735),U=n(4814),L=n(2842),q=n(2908);const N=200;async function z(e){if(0==e.length)throw new Error("FilePicker - Mail Messages: StartSearch should not be called with an empty search!!");const t=Object(F.d)(F.a.FilesPicker);Object(C.a)(t.nextSearchQueryId,F.a.FilesPicker),Object(_.a)(Object(x.a)(),F.a.FilesPicker);const n=Object(M.b)(),r={Cvid:Object(x.a)(),Scenario:{Name:L.c.MailEmailAttachmentPicker},TimeZone:Object(L.B)(n),TextDecorations:"Off",EntityRequests:$(e)},a=new Date,i=await Object(L.K)(r,t.searchSessionGuid);if(!i||2!=i.length){return l.h.warn("3S Response for search mail messages failed"),c(null,{body:null,headers:null,ok:!1,redirected:!1,status:1,statusText:"Get mail message items error",type:null,url:null,clone:null,bodyUsed:null,arrayBuffer:null,blob:null,formData:null,json:null,text:null,trailer:null},R,O)}const o=i[0].status==N,s=o?null:i[0].statusText,u=function(e,t,n,r,a,i,o){if(!e||2!=e.length)return null;const l=Object(L.f)(e[0],t,n,"SubstrateSearch",r,new Date,a.currentSearchQueryId,new Headers(e[1]),0,L.c.MailEmailAttachmentPicker);return l.ClientJSPreRequestTime=i,l.ClientJSRequestThreadTime=o,Object(A.W)(l.SearchTraceID,F.a.FilesPicker,!1),U.d.import().then(e=>e(l)),q.j.importAndExecute(l.SearchTraceID,l.ClientNetworkTime,l.ClientHttpStatus,new Date),l}(i,e,s,a,t,0,0);if(o){const e=await i[0].json(),t=function(e,t){if(e&&e.Results&&0!==e.Results.length){const n=[],r=e.Results;for(const e of r){const r=Object(L.n)(e.Source,t);r.InstanceKey=e.ReferenceId,n.push(r)}return n}return[]}(Object(L.y)(e),r);return q.l.importAndExecute(u.SearchTraceID,new Date,L.c.MailEmailAttachmentPicker),c(t,null,R,O)}{l.h.warn(`3S Response for search mail messages failed with ${s}`);const e={body:null,headers:null,ok:!1,redirected:!1,status:1,statusText:s,type:null,url:null,clone:null,bodyUsed:null,arrayBuffer:null,blob:null,formData:null,json:null,text:null,trailer:null};return q.i.importAndExecute(u.SearchTraceID,L.c.MailEmailAttachmentPicker),c(null,e,R,O)}}function $(e){return[{EntityType:"Message",Filter:null,From:0,PropertySet:"ProvenanceOptimized",Provenances:["Exchange"],Query:{QueryString:e},RefiningQueries:null,Size:50,Sort:[{Field:"Time",SortDirection:"Desc"}]}]}function B(e,t,n,l,c,d=null,m){if(5===e)return async function(e,t=""){let n=`${u}&q=mimeType!='application/octet-stream' and trashed=false and fullText contains '${e}'`;return t&&(n=`${n} and '${t}' in parents`),D(n)}(n,c);if(10===e)return z(n);const f=o({AttachmentDataProviderId:t,Query:n,Paging:r({Sort:m||(h=s,Object.assign({__type:"AttachmentItemsSort:#Exchange"},h)),FolderId:l,Location:c,RequestedData:Object(a.a)({BasePoint:"Beginning",Offset:0,MaxEntriesReturned:100}),PagingMetadata:d})});var h,p,b;return void 0===(p={request:f}).request||p.request.__type||(p.request=o(p.request)),Object(i.a)("SearchAttachmentDataProviderItems",p,b)}var Q=n(68),G=n(4763),W=n(25),H=n(6);function V(e,t){var n;return void 0===e.request||e.request.__type||(e.request=(n=e.request,Object.assign({__type:"GetAttachmentDataProviderItemsRequest:#Exchange"},n))),Object(i.a)("GetAttachmentDataProviderItems",e,t)}var J=n(4513);function K(e){return null!==e&&e.__type===p}function Z(e){return e&&e.__type===b}function X(e,t){return 1===e&&t&&function(e){return null!==e&&e.__type===y}(t)?t.Type:null}function Y(e,t){return 0===e&&t&&K(t)?t.Type:null}async function ee(e,t){const n=[e];try{const r=await Object(J.c)(e,!1,t);return!Object(H.j)(r)||(Object(Q.p)("FPAccessTokenUnavailable",n),!1)}catch(e){return Object(Q.p)("FPAccessTokenUnavailable",n),!1}}async function te(e,t,n){switch(e){case 3:case 2:case 6:return ee(e,void 0);case 5:case 10:return!0;case 0:return(0===Y(e,n)||4===Y(e,n))&&ee(e,t);case 1:return 4===X(e,n);default:return!1}}function ne(e){return e.__type===h||1===e.Type}function re(e){const t=e.filter(ne),n=e.filter(e=>!ne(e));return t.concat(n)}var ae=n(72);function ie(e,t,n){let r=null,a=null;switch(e){case"asc":[r,a]=[t,n];break;case"desc":[r,a]=[n,t];break;default:Object(ae.a)(e)}return r<a?-1:r>a?1:0}function oe(e,t,n){switch(t){case 2:e.sort((e,t)=>{const r=e.Modified,a=t.Modified,i=r?new Date(r):new Date(0),o=a?new Date(a):new Date(0);return ie(0===n?"asc":"desc",i,o)});break;case 1:e.sort((e,t)=>{const r=e.Size||0,a=t.Size||0;return 0===n?r-a:a-r});break;default:e.sort((e,t)=>{const r=e.Name.toLowerCase(),a=t.Name.toLowerCase();return ie(0===n?"asc":"desc",r,a)})}}function le(e){return{__type:Object(I.s)(e)?h:f,Id:e.id,AttachmentProviderId:null,Location:`${t=e.path_collection,`/${(t.entries||[]).map(e=>e.name).join("/")}`}/${e.name}`,Modified:e.modified_at,ModifiedBy:e.modified_by?e.modified_by.name:null,Name:e.name,ProviderType:3,Size:e.size,Type:Object(I.s)(e)?1:0};var t}const ce=e=>T(e,le);function se(e){return{__type:Object(I.v)(e)?h:f,Id:Object(I.t)(e)?null:e.id,AttachmentProviderId:null,Location:Object(I.t)(e)?"":e.path_lower,Modified:Object(I.u)(e)?e.server_modified:"",Name:e.name,ProviderType:2,Size:Object(I.u)(e)?e.size:0,Type:Object(I.v)(e)?1:0}}const ue=e=>T(e,se);function de(e){return Object.assign({__type:"AttachmentThumbnailInfo:#Exchange"},e)}const me=150,fe=200;function he(e){const t=function(e){const[t]=[...e].reverse().filter(e=>e.width>=fe&&e.height>=me);return t||e[0]}(e.images);return de({Url:t.source,Height:t.height,Width:t.width})}function pe(e){const t=he(e),n=e.images[0],r=de({Url:n.source,Height:n.height,Width:n.width});return{__type:m,Id:e.id,Name:`Photo ${e.id}.jpg`,AttachmentProviderId:null,ProviderType:6,Location:n.source,DownloadUrl:`${n.source}&dl=1`,Thumbnail:t,Preview:r,From:e.from?e.from.name:null,PlaceName:e.place?e.place.name:null,AlbumName:e.album?e.album.name:null,CreatedTime:e.created_time||null,PostUrl:e.link,Type:0}}const be=e=>T(e,pe);function ye(e){return e?function(e){switch(e){case 1:return I.c.Uploaded;case 0:return I.c.Tagged;default:return Object(ae.a)(e)}}(e.Type):I.c.Tagged}function ge(e){return e.file?e.file.mimeType:e.package&&e.package.type===g?v:null}function ve(e){return{TotalItemCount:0,ResultCode:e,Items:[]}}function Ie(e,t,n,r,a,i){let o=void 0;if(a)switch(r){case 0:const t=i?i.totalItemsFetched+e.length:e.length;l={skipToken:a,totalItemsFetched:t},o=Object.assign(Object.assign({},l),{__type:"OneDriveProItemSkipTokenPagingMetadata:#Client"});break;case 1:throw new Error("We do not support skip token based paging for OneDriveConsumer");default:Object(ae.a)(r)}var l;let c=e.length;return a&&o?c=o.totalItemsFetched+1:o&&(c=o.totalItemsFetched),{TotalItemCount:c,ResultCode:0,Items:e.map(e=>(function(e,t,n,r){var a,i,o;const[l,c,s,u,d]=e.folder?[h,null,e.folder.childCount,1,0]:[f,ge(e),0,0,e.size];return{__type:l,Id:e.id,Name:e.name,Size:d,Thumbnail:{Url:(null===(i=null===(a=e.thumbnails)||void 0===a?void 0:a[0])||void 0===i?void 0:i.medium)?e.thumbnails[0].medium.url:null},Modified:e.lastModifiedDateTime,ModifiedBy:(null===(o=e.lastModifiedBy)||void 0===o?void 0:o.user)?e.lastModifiedBy.user.displayName:null,MimeType:c,Location:e.webDavUrl,ProviderEndpointUrl:t,ChildCount:s,AttachmentProviderId:n,ProviderType:r,Type:u}})(e,t,n,r)),PagingMetadata:o}}function Te(e,t,n,r,a,i,o){return t?c(t,null,e=>Ie(e,n,r,a,i,o),ve):c(null,e,e=>Ie(e,n,r,a,i,o),ve)}const Oe="maxResults=1000&fields=files(id,mimeType,name,size,modifiedTime,thumbnailLink)";var we=n(2746),je=n(220);async function Pe(e,t,n,r=!1){const{errorResponse:a,result:i}=await Object(I.p)(e,n,r);return i?c(i.value,null,r=>Se(r,e,t,n),ve):c(null,a,r=>Se(r,e,t,n),ve)}function Se(e,t,n,r){const a=function(e,t,n,r){const a=[];return e.forEach(e=>{const i=function(e,t,n,r){var a,i,o;if(!Object(je.a)()&&".fluid"===Object(we.a)(e.name))return null;return{__type:f,Id:e.remoteItem.id?e.remoteItem.id:e.id,Name:e.name,Size:e.remoteItem.size,Modified:null===(a=e.remoteItem.fileSystemInfo)||void 0===a?void 0:a.lastAccessedDateTime,ModifiedBy:null===(o=null===(i=e.remoteItem.lastModifiedBy)||void 0===i?void 0:i.user)||void 0===o?void 0:o.displayName,MimeType:De(e),Location:e.remoteItem.webDavUrl,ProviderEndpointUrl:ke(e)?null:t,ChildCount:0,AttachmentProviderId:n,ProviderType:r,Type:0}}(e,t,n,r);i&&a.push(i)}),a}(e,t,n,r);return{TotalItemCount:a.length,ResultCode:0,Items:a,PagingMetadata:null}}function De(e){var t;return e.remoteItem.file?e.remoteItem.file.mimeType:(null===(t=e.package)||void 0===t?void 0:t.type)===g?v:null}const Ce=(e,t)=>e.substring(0,t.length)===t,_e="https://";function ke(e){return!!e.remoteItem.webDavUrl&&!!Ce(e.remoteItem.webDavUrl.toLowerCase(),_e)}const Ee=(Re={Type:0,DisplayName:"Files",AriaLabel:"Files"},Object.assign({__type:"OneDriveProScope:#Exchange"},Re));var Re;async function xe(e,t,n,i,o=null,u=null,d,m,f=null,h,p=null,b=!1){try{const l=await te(e,u,o);let y,g=!1;if(l)if(1===e){g=!0;try{y=await Pe(u,t,e)}catch(e){Object(Q.p)("OneDriveConsumerMRUError",{info:e.message})}}else if(5===e)g=!0,y=await D(function(e,t){let n="modifiedTime";t&&0===t.SortColumn?n="name":t&&1===t.SortColumn&&(n="quotaBytesUsed");const r=t&&0===t.SortOrder?"asc":"desc";return`${Oe}&orderBy=folder,${n} ${r}&q=mimeType!="application/octet-stream" and trashed=false and "${e||"root"}" in parents`}(m,h));else if(2===e){const e=h?h.SortColumn:s.SortColumn,t=h?h.SortOrder:s.SortOrder;g=!0;try{y=await async function(e,t,n){const{errorResponse:r,result:a}=await Object(I.j)({path:e});if(a){const e=c(a,null,ue,O);return oe(e.Items,t,n),e.Items=re(e.Items),e}return c(null,r,ue,O)}(m,e,t)}catch(e){}}else if(3===e){const e=h?h.SortColumn:s.SortColumn,t=h?h.SortOrder:s.SortOrder;g=!0;try{y=await async function(e,t,n){const{errorResponse:r,result:a}=await Object(I.h)(e);if(a){const e=c(a,null,ce,O);return oe(e.Items,t,n),e.Items=re(e.Items),e}return c(null,r,ce,O)}(d,e,t)}catch(e){}}else if(6===e){g=!0;try{y=await async function(e){const t=ye(e),{errorResponse:n,result:r}=await Object(I.k)(t);return r?c(r,null,be,O):c(null,n,be,O)}(o)}catch(e){}}else 10===e&&(g=!0,y=await async function(e,t){const{errorResponse:n,result:r}=await Object(I.n)(e,t);return r?c(r,null,R,O):c(null,n,R,O)}(d,n));if(0===Y(e,o)){if(f&&!Z(f))throw new Error("The paging metadata is not of type OneDriveProItemsSkipTokenPagingMetadata");g=l;try{y=await async function(e,t,n,r,a,i=null){const o=new URL(e),l=`${o.protocol}//${o.host}`,c=i?{maxEntries:i.maxEntries,skipToken:i.metadata?i.metadata.skipToken:null}:null,{errorResponse:s,result:{items:u,skipToken:d}}=await Object(I.o)(l,0,n,r,a,void 0,c);return Te(s,u,e,t,0,d,i?i.metadata:null)}(u,t,h?h.SortColumn:s.SortColumn,h?h.SortOrder:s.SortOrder,d,{metadata:f,maxEntries:100})}catch(e){}}if(4===Y(e,o)){g=!0;try{y=await Pe(u,t,e,b)}catch(e){Object(Q.p)("OneDriveProMRUError",{info:e.message})}}if(y&&0===y.ResultCode)return Object(Q.p)("FPgetItemsClientCall",[!0,e]),y;g&&Object(Q.p)("FPgetItemsClientCall",[!1,e]);let v=null,T=function(e,t){if(4===Y(e,t)||4===X(e,t)){const e=new Q.b("getOneDriveMRUItemsDataProvider");return e.addCustomData({IsViaServer:!0}),e}return null}(e,o);try{return v=await async function e(t,n,i,o,l,c,u,d,m,f){const h={AttachmentDataProviderId:t,Paging:r({Sort:f||s,FolderId:l||"",Location:u||"",ItemsEndpointUrl:c||"",FilterBy:i,RequestedData:Object(a.a)({BasePoint:"Beginning",Offset:n,MaxEntriesReturned:100}),PagingMetadata:m}),Scope:null==d?Ee:d};let p=await V({request:h});if(Object(W.k)("doc-authContext")&&!o&&p&&!Object(H.j)(p.ClaimsChallenge)){try{const e=await G.a.import();await e(p.ClaimsChallenge)}catch(e){return p}p=await e(t,n,i,!0,l,c,u,d,m,f);const r=p&&Object(H.j)(p.ClaimsChallenge);return Object(Q.p)("getFileProviderItemsAfterReAuth",{isSuccess:r}),p}return p}(t,n,i,b,d,p,m,o,f,h),T&&T.end(),v}catch(e){throw T&&T.endWithError("ClientError"),e}}catch(e){throw l.h.warn("FilePicker: getFileProviderItems got error: "+e.message),e}}n.d(t,"f",(function(){return B})),n.d(t,"b",(function(){return xe})),n.d(t,"a",(function(){return te})),n.d(t,"e",(function(){return K})),n.d(t,"d",(function(){return Z})),n.d(t,"c",(function(){return ge}))}}]);
//# sourceMappingURL=owa.153.js.map
self.scriptsLoaded['owa.153.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.153.js'] = (new Date()).getTime();