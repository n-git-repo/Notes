self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.34.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[34],{187:function(n,e,r){"use strict";r.d(e,"s",(function(){return u})),r.d(e,"v",(function(){return i})),r.d(e,"e",(function(){return l})),r.d(e,"q",(function(){return s})),r.d(e,"p",(function(){return f})),r.d(e,"m",(function(){return p})),r.d(e,"k",(function(){return I})),r.d(e,"l",(function(){return b})),r.d(e,"j",(function(){return O})),r.d(e,"o",(function(){return j})),r.d(e,"f",(function(){return y})),r.d(e,"h",(function(){return m})),r.d(e,"i",(function(){return G})),r.d(e,"t",(function(){return x})),r.d(e,"c",(function(){return g})),r.d(e,"d",(function(){return C})),r.d(e,"b",(function(){return M})),r.d(e,"w",(function(){return E})),r.d(e,"x",(function(){return h})),r.d(e,"z",(function(){return v})),r.d(e,"a",(function(){return T})),r.d(e,"g",(function(){return L})),r.d(e,"y",(function(){return w})),r.d(e,"n",(function(){return F})),r.d(e,"r",(function(){return K})),r.d(e,"u",(function(){return A}));var t=r(344),d=r(98),a=r(168),c=r(217);r.d(e,"A",(function(){return c.i}));var o=r(494);function u(n){return n||(n=Object(a.d)().userIdentity),Object(d.a)().defaultCalendars.get(n)}function i(n,e){const r=u(e);return r&&n===r.calendarId}function l(){const{calendarEntryMapping:n,calendarIdOrderedList:e}=Object(d.a)();return e.map(e=>n.get(e))}function s(n){const e=Object(o.a)(Object(d.a)().calendarIdOrderedList,e=>e===n);return e?e.index:-1}function f(){return Object(d.a)().calendarIdOrderedList}function p(){const{calendarGroupsMapping:n,calendarGroupKeyOrderedList:e}=Object(d.a)();return e.map(e=>n.get(e))}function I(n,e){const r=Object(t.a)(e,n),a=Object(o.a)(Object(d.a)().calendarGroupKeyOrderedList,n=>n===r);return a?a.index:-1}function b(){return Object(d.a)().calendarGroupKeyOrderedList}function O(n,e){const{calendarGroupsMapping:r}=Object(d.a)(),a=Object(t.a)(e,n);return r.get(a)}function j(n){const{folderIdToCalendarId:e}=Object(d.a)();return e.get(n)}function y(n){const{calendarEntryMapping:e}=Object(d.a)();return e.get(n)}function m(n){const e=j(n);return e?y(e.id):void 0}function G(n){return x(n.calendarId.id)}function x(n){const{calendarEntryMapping:e}=Object(d.a)(),r=e.get(n);return r&&(r.FolderId||r.DistinguishedFolderId)?r.FolderId?r.FolderId.Id:r.DistinguishedFolderId:g(n)}function g(n){const{calendarEntryMapping:e}=Object(d.a)(),r=e.get(n);if(r){const n=Object(c.e)(r);return n?n.Id:null}return null}function C(n){const e=u(n);return e?Object(c.e)(e).Id:null}function M(n){return!!y(n)}function E(n){const{folderIdToCalendarId:e,calendarEntryMapping:r}=Object(d.a)(),t=e.get(n);if(t){const n=r.get(t.id);return n&&!n.IsGroupMailboxCalendar&&null!=n.LocalCalendarFolderId}return!1}function h(n){if(E(n)){let e=m(n);return null==e?void 0:e.IsReadOnly}return!1}function v(n){const{validEntryMapping:e}=Object(d.a)();return n&&e.get(n.calendarId.id)}function T(n){if(!E(x(n))){return!v(y(n))}return!1}function L(n){const{folderIdToCalendarId:e,calendarEntryMapping:r}=Object(d.a)(),t=e.get(n);let a;if(t)a=r.get(t.id);else{a=[...r.values()].filter(e=>e.OwnerEmailAddress&&e.OwnerEmailAddress.toLowerCase()==n.toLowerCase())[0]}return a}function w(n){var e,r;return"TeamsMailbox"==(null===(r=null===(e=null==n?void 0:n.id)||void 0===e?void 0:e.mailboxInfo)||void 0===r?void 0:r.type)}function F(n){const e=p();return{userCalendarGroups:e.filter(e=>"UserMailbox"===e.calendarGroupId.mailboxInfo.type&&e.calendarGroupId.mailboxInfo.userIdentity==n),groupCalendarGroups:e.filter(e=>"GroupMailbox"===e.calendarGroupId.mailboxInfo.type&&e.calendarGroupId.mailboxInfo.userIdentity==n),teamsCalendarGroups:e.filter(e=>"TeamsMailbox"===e.calendarGroupId.mailboxInfo.type&&e.calendarGroupId.mailboxInfo.userIdentity==n)}}function K(n,e){return l().filter(r=>r&&r.ParentGroupId===e&&r.calendarId.mailboxInfo.userIdentity===n)}function A(){let n=[];return l().forEach(e=>{e.CanShare&&n.push(e)}),n}},344:function(n,e,r){"use strict";function t(n,e){return`${e}_${n}`}r.d(e,"a",(function(){return t}))},494:function(n,e,r){"use strict";function t(n,e){for(let r=0,t=n.length;r<t;r++){let t=n[r];if(e(t))return{item:t,index:r}}return null}r.d(e,"a",(function(){return t}))},79:function(n,e,r){"use strict";var t=r(98),d=r(1),a=r(2);const c=Object(a.action)("initializeCalendarsCacheInStore",(n,e,r,t)=>({defaultCalendarEntry:n,calendarEntries:e,calendarGroups:r,folderIdMapping:t})),o=Object(a.action)("addToCalendarsCache",(n,e=-1)=>({calendarEntry:n,indexToInsert:e})),u=Object(a.action)("addCalendarGroupToCalendarsCache",(n,e=-1)=>({calendarGroup:n,indexToInsert:e})),i=Object(a.action)("removeCalendarGroupFromCalendarsCache",n=>({calendarGroup:n})),l=Object(a.action)("updateCalendarEntry",(n,e)=>({id:n,calendarEntry:e})),s=Object(a.action)("updateCalendarFolder",(n,e)=>({calendar:n,calendarFolder:e})),f=Object(a.action)("markCalendarEntryAsValid",n=>({calendarEntry:n})),p=Object(a.action)("removeCalendarWithIDFromCalendarsCache",(n,e,r=!1)=>({calendarId:n,userId:e,shouldPersistCalendarEntry:r})),I=Object(a.action)("updateCalendarGroup",(n,e,r)=>({groupId:n,userIdentity:e,calendarGroup:r})),b=Object(a.action)("updateCalendarIdOrderedList",(n,e)=>({indexToUpdate:n,idToAdd:e})),O=Object(a.action)("updateCalendarGroupKeyOrderedList",(n,e)=>({indexToUpdate:n,idToAdd:e}));var j=r(187);Object(a.mutator)(l,n=>{const{id:e,calendarEntry:r}=n,t=Object(j.f)(e),{calendarId:a}=r,c=Object(d.__rest)(r,["calendarId"]);t&&Object.keys(c).forEach(n=>{t[n]=c[n]})}),Object(a.mutator)(f,n=>{const{calendarEntry:e}=n;Object(t.a)().validEntryMapping.set(e.calendarId.id,!0)});var y=r(494),m=r(344);function G(n,e){Object.keys(e).forEach(r=>n.set(r,e[r]))}function x(n){const e=Object(j.o)(n);return e?e.mailboxInfo:null}function g(n){return n&&!n.IsReadOnly&&n.EffectiveRights&&n.EffectiveRights.CreateContents}Object(a.mutator)(c,({defaultCalendarEntry:n})=>{n&&Object(t.a)().defaultCalendars.set(n.calendarId.mailboxInfo.userIdentity,n)}),Object(a.mutator)(c,({calendarEntries:n})=>{const e=Object(t.a)();G(e.calendarEntryMapping,n),e.calendarIdOrderedList=e.calendarIdOrderedList.concat(Object.keys(n))}),Object(a.mutator)(c,({folderIdMapping:n})=>{G(Object(t.a)().folderIdToCalendarId,n)}),Object(a.mutator)(c,({calendarGroups:n})=>{const e=Object(t.a)();G(e.calendarGroupsMapping,n),e.calendarGroupKeyOrderedList=e.calendarGroupKeyOrderedList.concat(Object.keys(n))}),Object(a.mutator)(o,n=>{const{calendarEntry:e,indexToInsert:r}=n,d=Object(t.a)();d.calendarEntryMapping.set(e.calendarId.id,e),r>-1?d.calendarIdOrderedList.splice(r,0,e.calendarId.id):d.calendarIdOrderedList.push(e.calendarId.id),e.FolderId?d.folderIdToCalendarId.set(e.FolderId.Id,{id:e.calendarId.id,changeKey:e.calendarId.changeKey,mailboxInfo:e.calendarId.mailboxInfo}):e.DistinguishedFolderId&&d.folderIdToCalendarId.set(e.DistinguishedFolderId,{id:e.calendarId.id,changeKey:e.calendarId.changeKey,mailboxInfo:e.calendarId.mailboxInfo})}),Object(a.mutator)(u,n=>{const{calendarGroup:e,indexToInsert:r}=n,d=Object(t.a)(),a=Object(m.a)(e.calendarGroupId.mailboxInfo.userIdentity,e.serverGroupId);d.calendarGroupsMapping.set(a,e),r>-1?d.calendarGroupKeyOrderedList.splice(r,0,a):d.calendarGroupKeyOrderedList.push(a)}),Object(a.mutator)(i,n=>{const{calendarGroup:e}=n,r=Object(t.a)(),d=Object(m.a)(e.calendarGroupId.mailboxInfo.userIdentity,e.serverGroupId);r.calendarGroupsMapping.delete(d);const a=Object(y.a)(r.calendarGroupKeyOrderedList,n=>n===d);a&&r.calendarGroupKeyOrderedList.splice(a.index,1)}),Object(a.mutator)(p,n=>{const{calendarId:e,shouldPersistCalendarEntry:r}=n;!function(n,e,r){const d=Object(t.a)(),a=Object(y.a)(d.calendarIdOrderedList,e=>e===n);a&&d.calendarIdOrderedList.splice(a.index,1);r||(d.calendarEntryMapping.delete(n),d.validEntryMapping.delete(n));e&&d.folderIdToCalendarId.delete(e)}(e,Object(j.t)(e),r)}),Object(a.mutator)(s,n=>{const{calendar:e,calendarFolder:r}=n,t=Object(j.f)(e.calendarId.id);Object.keys(r).forEach(n=>{t[n]=r[n]})}),Object(a.mutator)(I,n=>{const{groupId:e,userIdentity:r,calendarGroup:a}=n,c=Object(t.a)(),o=Object(m.a)(r,e),u=c.calendarGroupsMapping.get(o),{calendarGroupId:i}=a,l=Object(d.__rest)(a,["calendarGroupId"]);u&&Object.keys(l).forEach(n=>{u[n]=l[n]})}),Object(a.mutator)(b,({indexToUpdate:n,idToAdd:e})=>{e?Object(t.a)().calendarIdOrderedList.splice(n,0,e):Object(t.a)().calendarIdOrderedList.splice(n,1)}),Object(a.mutator)(O,({indexToUpdate:n,idToAdd:e})=>{e?Object(t.a)().calendarGroupKeyOrderedList.splice(n,0,e):Object(t.a)().calendarGroupKeyOrderedList.splice(n,1)});var C=r(217),M=r(30);function E(n,e){var r;if(Object(C.f)(n)){let r=n;return!r.IsOwnerEmailAddressInvalid&&r.OwnerEmailAddress==e}return(null===(r=n.calendarId)||void 0===r?void 0:r.mailboxInfo)?e.indexOf(n.calendarId.mailboxInfo.mailboxSmtpAddress)>=0:Object(M.a)().SessionSettings.UserEmailAddress==e}function h(n){return n?n.map(j.f).filter(n=>!!n):null}function v(n){return!!n&&n.IsGroupMailboxCalendar}function T(n){const e=n;return null==e?void 0:e.IsSchoolCalendar}function L(n){return 4==(null==n?void 0:n.CalendarFolderType)}var w=r(284),F=r(52),K=r(25);function A(n){if(n.IsGroupMailboxCalendar){const e=n.OwnerEmailAddress,r=n.calendarId.mailboxInfo.userIdentity;return{MailboxId:Object(j.y)(n)&&Object(K.k)("cal-showAddTeamsCalendars")?Object(C.d)(e):e,MailboxType:Object(w.r)(r)?1:0}}const{FolderId:e}=n;if(e){const r=n.calendarId.mailboxInfo.userIdentity;return Object(F.s)(r)?{FolderId:e.Id}:Object(w.r)(r)?{FolderId:e.Id,MailboxId:r,MailboxType:Object(w.t)(r)?2:3}:null}return null}function k(n,e){return!!n&&n.calendarId.mailboxInfo.userIdentity===e}function S(n,e){return!!n&&n.ParentGroupId===e}function U(n,e){return n.CalendarName.localeCompare(e.CalendarName)}function D(n,e){const r=Object(j.s)(n),t=Object(j.e)().filter(t=>k(t,n)&&S(t,e)&&!function(n,e){return!!n&&!!e&&n.calendarId.id===e.calendarId.id}(t,r)).sort(U);return r&&S(r,e)&&t.unshift(r),t}function P(n){return Object(j.m)().filter(e=>(function(n,e){return!!n&&n.calendarGroupId.mailboxInfo.userIdentity===e})(e,n)).sort(N)}function N(n,e){const r=R[n.GroupType]-R[e.GroupType];if(0!==r)return r;const t=_[n.calendarGroupId.mailboxInfo.type]-_[e.calendarGroupId.mailboxInfo.type];return 0!==t?t:n.GroupName.localeCompare(e.GroupName)}const R={0:0,2:1,1:2,3:3},_={UserMailbox:0,TeamsMailbox:1,GroupMailbox:2,PublicMailbox:3,SharedMailbox:4,ArchiveMailbox:5};function z(n){const e=[];return Object(j.e)().forEach(r=>{k(r,n)&&e.push(r.calendarId.id)}),e}var $=r(168);function q(n){if(z(Object($.d)().userIdentity).includes(n))return Object($.d)().userIdentity;const e=Object(w.i)();if(e){if(z(e.userIdentity).includes(n))return e.userIdentity}return null}function V(n){const e=new Map;return n.forEach(n=>{const r=q(n);if(e.has(r)){const t=e.get(r);t.push(n),e.set(r,t)}else e.set(r,[n])}),e}r.d(e,"F",(function(){return c})),r.d(e,"b",(function(){return o})),r.d(e,"a",(function(){return u})),r.d(e,"S",(function(){return i})),r.d(e,"U",(function(){return l})),r.d(e,"V",(function(){return s})),r.d(e,"R",(function(){return f})),r.d(e,"T",(function(){return p})),r.d(e,"W",(function(){return I})),r.d(e,"Y",(function(){return b})),r.d(e,"X",(function(){return O})),r.d(e,"Q",(function(){return j.A})),r.d(e,"x",(function(){return j.s})),r.d(e,"H",(function(){return j.v})),r.d(e,"i",(function(){return j.e})),r.d(e,"v",(function(){return j.q})),r.d(e,"u",(function(){return j.p})),r.d(e,"r",(function(){return j.m})),r.d(e,"o",(function(){return j.k})),r.d(e,"q",(function(){return j.l})),r.d(e,"n",(function(){return j.j})),r.d(e,"t",(function(){return j.o})),r.d(e,"j",(function(){return j.f})),r.d(e,"l",(function(){return j.h})),r.d(e,"m",(function(){return j.i})),r.d(e,"y",(function(){return j.t})),r.d(e,"g",(function(){return j.c})),r.d(e,"h",(function(){return j.d})),r.d(e,"d",(function(){return j.b})),r.d(e,"K",(function(){return j.w})),r.d(e,"L",(function(){return j.x})),r.d(e,"O",(function(){return j.z})),r.d(e,"c",(function(){return j.a})),r.d(e,"k",(function(){return j.g})),r.d(e,"N",(function(){return j.y})),r.d(e,"s",(function(){return j.n})),r.d(e,"w",(function(){return j.r})),r.d(e,"B",(function(){return j.u})),r.d(e,"z",(function(){return x})),r.d(e,"p",(function(){return m.a})),r.d(e,"P",(function(){return g})),r.d(e,"G",(function(){return E})),r.d(e,"A",(function(){return h})),r.d(e,"I",(function(){return v})),r.d(e,"M",(function(){return T})),r.d(e,"J",(function(){return L})),r.d(e,"E",(function(){return A})),r.d(e,"D",(function(){return D})),r.d(e,"C",(function(){return P})),r.d(e,"e",(function(){return q})),r.d(e,"f",(function(){return V}))},98:function(n,e,r){"use strict";var t=r(2),d=r(13);const a={calendarEntryMapping:new d.ObservableMap,folderIdToCalendarId:new d.ObservableMap,validEntryMapping:new d.ObservableMap,calendarGroupsMapping:new d.ObservableMap,defaultCalendars:new d.ObservableMap,calendarIdOrderedList:[],calendarGroupKeyOrderedList:[]};e.a=Object(t.createStore)("calendarsCacheStore",a)}}]);
//# sourceMappingURL=owa.34.js.map
self.scriptsLoaded['owa.34.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.34.js'] = (new Date()).getTime();