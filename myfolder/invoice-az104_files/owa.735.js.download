self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.735.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[735],{11446:function(e){e.exports=JSON.parse('{"a":"dnc"}')},11447:function(e){e.exports=JSON.parse('{"a":"Nmc"}')},11459:function(e){e.exports=JSON.parse('{"a":"hmc"}')},18098:function(e,t,n){var r=n(18099);"string"==typeof r&&(r=[[e.i,r,""]]);var i={transform:void 0};n(84)(r,i);r.locals&&(e.exports=r.locals)},18099:function(e,t,n){(t=e.exports=n(83)(!1)).push([e.i,'.iVDUAPPz0v5pGspIdBxq-{display:block;width:261px}html[dir] .iVDUAPPz0v5pGspIdBxq-._3-nNBk1k9JjO-V-1SWS7zN,html[dir] .iVDUAPPz0v5pGspIdBxq-:focus,html[dir] .iVDUAPPz0v5pGspIdBxq-:hover{background:var(--neutralLighter)}.iVDUAPPz0v5pGspIdBxq-._3-nNBk1k9JjO-V-1SWS7zN .HMcY69KBPwoYoMDF-mzD,.iVDUAPPz0v5pGspIdBxq-:hover .HMcY69KBPwoYoMDF-mzD{width:138px}._2kQgr4wqaJ4gW7AqCCoekg{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;position:relative}._38CwiZZyki0w679RN5twWC{display:block}html[dir] ._38CwiZZyki0w679RN5twWC{margin:6px 8px}.W42ZElu3aL6W2lC448Xcq{font-size:24px;color:var(--neutralTertiaryAlt)}html[dir] .W42ZElu3aL6W2lC448Xcq{background:transparent}._1tQCe--SRy7aS7qZYvQZo1{display:block;white-space:nowrap;position:relative;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}html[dir] ._1tQCe--SRy7aS7qZYvQZo1{padding:6px 4px}._19PNEL3Be2moTtaPUeGaRm{font-size:14px;font-weight:400;max-width:194px}._1lFJAn9fiQ0_GRFse-zHaQ{text-decoration:underline}.HMcY69KBPwoYoMDF-mzD{font-size:11px;font-weight:400;max-width:194px}html[dir] .HMcY69KBPwoYoMDF-mzD{padding-top:3px}.HMcY69KBPwoYoMDF-mzD ._2ICCUeGACJvzyvjmxq72wh{font-size:12px;font-weight:400;font-weight:600;position:relative;top:2px}html[dir=ltr] .HMcY69KBPwoYoMDF-mzD ._2ICCUeGACJvzyvjmxq72wh{padding-right:4px}html[dir=rtl] .HMcY69KBPwoYoMDF-mzD ._2ICCUeGACJvzyvjmxq72wh{padding-left:4px}.HMcY69KBPwoYoMDF-mzD ._1Z_rWayxzKuhQaJXqqgJUa{color:#107c10}.HMcY69KBPwoYoMDF-mzD ._1-uDr9vezPy7pScujNApf1{color:#e81123}._32QGS0saqH-U9pVCUe31yI{overflow:hidden;text-overflow:ellipsis}.HAJtz0gI6kEp_PNC9LNwL{height:26px;width:56px;position:absolute;bottom:0;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}html[dir=ltr] .HAJtz0gI6kEp_PNC9LNwL{right:0}html[dir=rtl] .HAJtz0gI6kEp_PNC9LNwL{left:0}._3r93OWpfqsM0zFaNUYjrIg{display:block;height:100%;width:28px;position:absolute;bottom:0}html[dir=ltr] ._3r93OWpfqsM0zFaNUYjrIg{right:0}html[dir=rtl] ._3r93OWpfqsM0zFaNUYjrIg{left:0}html[dir] ._3r93OWpfqsM0zFaNUYjrIg:focus,html[dir] ._3r93OWpfqsM0zFaNUYjrIg:hover{background:var(--neutralTertiaryAlt)}._2ICCUeGACJvzyvjmxq72wh{font-size:14px}html[dir] ._2ICCUeGACJvzyvjmxq72wh{margin:0}._1MLbkBQ6BLvoKEvtWBB0Wk{font-size:12px;font-weight:400;line-height:30px;cursor:pointer;width:261px;-webkit-box-sizing:border-box;box-sizing:border-box;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}html[dir=ltr] ._1MLbkBQ6BLvoKEvtWBB0Wk{padding:0 20px 0 54px}html[dir=rtl] ._1MLbkBQ6BLvoKEvtWBB0Wk{padding:0 54px 0 20px}html[dir] ._1MLbkBQ6BLvoKEvtWBB0Wk:focus,html[dir] ._1MLbkBQ6BLvoKEvtWBB0Wk:hover{background:var(--neutralLight)}html[dir] ._16rMllY30U1i2TiWIR2WIx{margin-top:-4px}._16rMllY30U1i2TiWIR2WIx .ms-ProgressIndicator-itemName{display:none}._16rMllY30U1i2TiWIR2WIx .ms-ProgressIndicator,._16rMllY30U1i2TiWIR2WIx .ms-ProgressIndicator .ms-ProgressIndicator-itemProgress,._16rMllY30U1i2TiWIR2WIx .ms-ProgressIndicator .ms-ProgressIndicator-progressBar,._16rMllY30U1i2TiWIR2WIx .ms-ProgressIndicator .ms-ProgressIndicator-progressTrack{height:4px}html[dir] ._16rMllY30U1i2TiWIR2WIx .ms-ProgressIndicator,html[dir] ._16rMllY30U1i2TiWIR2WIx .ms-ProgressIndicator .ms-ProgressIndicator-itemProgress,html[dir] ._16rMllY30U1i2TiWIR2WIx .ms-ProgressIndicator .ms-ProgressIndicator-progressBar,html[dir] ._16rMllY30U1i2TiWIR2WIx .ms-ProgressIndicator .ms-ProgressIndicator-progressTrack{padding:0}._1obvG2dpsKoH4kYm2hvbtu{position:fixed;pointer-events:"none";z-index:1000;top:0;font-size:12px;font-weight:400}html[dir] ._1obvG2dpsKoH4kYm2hvbtu{border-width:1px;border-style:solid;padding:0 4px;background:var(--neutralTertiary)}html[dir=ltr] ._1obvG2dpsKoH4kYm2hvbtu{left:0}html[dir=rtl] ._1obvG2dpsKoH4kYm2hvbtu{right:0}',""]),t.locals={container:"iVDUAPPz0v5pGspIdBxq-",active:"_3-nNBk1k9JjO-V-1SWS7zN",secondLine:"HMcY69KBPwoYoMDF-mzD",innerContainer:"_2kQgr4wqaJ4gW7AqCCoekg",thumbnailDiv:"_38CwiZZyki0w679RN5twWC",placeholder:"W42ZElu3aL6W2lC448Xcq",infoDiv:"_1tQCe--SRy7aS7qZYvQZo1",firstLine:"_19PNEL3Be2moTtaPUeGaRm",firstLineLink:"_1lFJAn9fiQ0_GRFse-zHaQ",icon:"_2ICCUeGACJvzyvjmxq72wh",success:"_1Z_rWayxzKuhQaJXqqgJUa",failure:"_1-uDr9vezPy7pScujNApf1",textOverFlow:"_32QGS0saqH-U9pVCUe31yI",actionsContainer:"HAJtz0gI6kEp_PNC9LNwL",menuButton:"_3r93OWpfqsM0zFaNUYjrIg",menuItem:"_1MLbkBQ6BLvoKEvtWBB0Wk",progressIndicator:"_16rMllY30U1i2TiWIR2WIx",dragPreview:"_1obvG2dpsKoH4kYm2hvbtu"}},18100:function(e,t,n){var r=n(18101);"string"==typeof r&&(r=[[e.i,r,""]]);var i={transform:void 0};n(84)(r,i);r.locals&&(e.exports=r.locals)},18101:function(e,t,n){(t=e.exports=n(83)(!1)).push([e.i,"._3aFSZ1Cdm0WPzzZJshVqME{overflow-y:auto;overflow-x:hidden}",""]),t.locals={container:"_3aFSZ1Cdm0WPzzZJshVqME"}},18102:function(e){e.exports=JSON.parse('{"a":"uGc"}')},18103:function(e,t,n){var r=n(18104);"string"==typeof r&&(r=[[e.i,r,""]]);var i={transform:void 0};n(84)(r,i);r.locals&&(e.exports=r.locals)},18104:function(e,t,n){(t=e.exports=n(83)(!1)).push([e.i,".u57qN9RErCHobCQoYwBf-{color:var(--neutralDark)}html[dir] .u57qN9RErCHobCQoYwBf-{border-radius:2px;border-color:transparent}html[dir] .u57qN9RErCHobCQoYwBf-:not(:hover){background-color:transparent}.u57qN9RErCHobCQoYwBf-.ms-Button{min-width:50px}html[dir] .u57qN9RErCHobCQoYwBf-.ms-Button{padding:0}html[dir=ltr] ._1TOVQ8DMlm61Z7V5KIcSXk{margin-left:2px}html[dir=rtl] ._1TOVQ8DMlm61Z7V5KIcSXk{margin-right:2px}.hHM9mkU8EB4upiEL8UjUR{font-size:10px}html[dir] .hHM9mkU8EB4upiEL8UjUR{margin:2px 6px 0 6px}.XSOvFOvp5wFsenRj1LPO3{font-size:14px;font-weight:400}html[dir] .XSOvFOvp5wFsenRj1LPO3{margin:0}",""]),t.locals={button:"u57qN9RErCHobCQoYwBf-",icon:"_1TOVQ8DMlm61Z7V5KIcSXk",menuIcon:"hHM9mkU8EB4upiEL8UjUR",label:"XSOvFOvp5wFsenRj1LPO3"}},19976:function(e,t,n){"use strict";n.r(t);var r=n(21),i=n(711),a=n(1251),o=n(57),c=n(68),s=n(4406),l=n(2),u=Object(l.mutatorAction)("setConversationAttachmentWellVisible",(function(e,t){e.isVisible=t})),d=n(6),m=n(11459),f=n(0),h=n(12722),p=Object(l.mutatorAction)("updateConversationAttachmentWellMaxHeight",(function(e){e.maxHeight=(window.innerHeight||document.body.clientHeight)-200})),w=n(9150),I=n(3148),b=n(1444),v=n(351),g=n(5984),S=n(50),k=n(2936),x=n(8160),C=n(11435),O=n(13380),L=n(12957),E=n(2851),N=n(2778),A=n(5060),P=n(1558),_=n(2960),y=n(2765),R=n(2767),j=n(3373),D=n(8902),M=n(753),F=n(2864),U=n(22),W=n(4348),B=n(25),T=n(7318),V=n(18098),z=n.n(V),H=n(209),Y=n.n(H);const G=Y.a.bind(z.a);var q=Object(r.a)((function(e){const t=f.useRef(),n=f.useRef();f.useEffect(()=>{if(n.current&&(n.current=!1,e.attachmentViewState.shouldShowContextMenu)){const e=t.current.parentElement.clientHeight,n=t.current.parentElement.scrollTop,r=t.current.offsetHeight,i=t.current.offsetTop;r+i>e+n?t.current.parentElement.scrollTop=r+i-e:i<n&&(t.current.parentElement.scrollTop=i)}});const r=e=>{i()},i=async()=>{const n=Object(k.f)(e.attachmentViewState.strategy);if(n!==k.a.NoAction){let r;const i=Object(T.a)(e.attachmentViewState.attachmentId);if(Object(B.k)("doc-SxS-jsApi-ODB-Links")&&i){const t=await W.a.import();r=await t(e.attachmentViewState,F.b.ConversationAttachmentWell,window,e.onBeforePreview)}if(!i||!r){const{name:r,customData:i}=C.g.OnClick;Object(c.p)(r,i(n)),Object(A.b)(e.attachmentViewState,F.b.ConversationAttachmentWell,e.instrumentationContext,e.parentItemId,!1,e.onBeforePreview,e.createImageGallery,t.current.parentElement,window)}}},a=()=>{var t;null===(t=e.onFocus)||void 0===t||t.call(e,e.attachmentViewState.attachmentId.Id)},o=Object(N.a)(e.attachmentViewState.attachmentId),l=!!o&&13===o.attachmentClass;return f.createElement("div",{"aria-label":o.model.Name,ref:t,onFocus:a,onKeyDown:e=>{e.keyCode!==S.a.enter&&e.keyCode!==S.a.space||r()},onMouseOver:a,className:G(z.a.container,{active:e.attachmentViewState.shouldShowContextMenu}),tabIndex:0,"data-is-focusable":!0,onClick:r,onContextMenu:t=>{t.preventDefault(),Object(s.a)(e.attachmentViewState,n.current=!0)}},f.createElement(_.b,{canDrag:()=>!!Object(N.a)(e.attachmentViewState.attachmentId),getDragData:()=>{const t=Object(N.a)(e.attachmentViewState.attachmentId).model,n=Object(x.a)(t);return{itemType:y.a.Attachment,attachmentFile:n}},getDragPreview:()=>{const t=document.createElement("div");return t.className=z.a.dragPreview,t.innerText=Object(N.a)(e.attachmentViewState.attachmentId).model.Name,t},xOffset:-12,yOffset:5},f.createElement("div",{className:z.a.innerContainer},(t=>{const n=E.m.tryImportForRender();if(null==n?void 0:n(t.model)){const n=t.model.Name,r=Object(j.g)(n);let i=null,a={className:z.a.placeholder,iconName:"Photo2"};return Object(R.h)(n)&&(i=r.small,a={className:G(r.small,a.className),iconName:void 0}),f.createElement("div",{className:z.a.thumbnailDiv},f.createElement(P.d,{attachmentViewState:e.attachmentViewState,placeHolder:a,fileIconCssClass:i,imageLoadErrorCSSClass:r.small,thumbnailWidth:32,thumbnailHeight:32}))}return f.createElement(P.c,{attachmentId:e.attachmentViewState.attachmentId})})(o),(t=>{const n=1!==t.type&&0===e.attachmentViewState.actionMessage?{text:Object(M.a)(e.itemReceivedTime),title:null,shouldDisplaySuccessIcon:!1,shouldDisplayFailureIcon:!1}:Object(O.a)(e.attachmentViewState,t,!1);return f.createElement("div",{className:z.a.infoDiv},f.createElement("div",{className:G(z.a.firstLine,z.a.textOverFlow,3===t.type&&z.a.firstLineLink),title:t.model.Name},t.model.Name),f.createElement("div",{className:G(z.a.secondLine,z.a.textOverFlow),title:n.title},n.shouldDisplaySuccessIcon?f.createElement(v.a,{iconName:"Accept",className:G(z.a.icon,z.a.success)}):null,n.shouldDisplayFailureIcon?f.createElement(v.a,{iconName:"Cancel",className:G(z.a.icon,z.a.failure)}):null,n.text))})(o),e.attachmentViewState.strategy.showActionsMenu&&e.attachmentViewState.shouldShowActionsContainer&&f.createElement("div",{className:z.a.actionsContainer},f.createElement(C.b,{attachmentViewState:e.attachmentViewState,isForImageView:!1,previewState:F.a.None,shouldNotHandleOnBlur:!0,action:l?C.f.addToCalendar:C.f.download,parentItemId:e.parentItemId}),f.createElement(b.a,{"data-is-focusable":!0,className:z.a.menuButton,onClick:t=>{t.stopPropagation(),Object(s.a)(e.attachmentViewState,n.current=!e.attachmentViewState.shouldShowContextMenu)},title:Object(d.b)(D.a),ariaLabel:Object(d.b)(D.a),"aria-expanded":e.attachmentViewState.shouldShowContextMenu,onKeyDown:Q,iconProps:{iconName:e.attachmentViewState.shouldShowContextMenu?"ChevronUp":"ChevronDown",styles:{root:z.a.icon}}})))),(()=>Object(L.a)(e.attachmentViewState)?f.createElement("div",{className:z.a.progressIndicator},f.createElement(g.a,{percentComplete:e.attachmentViewState.actionCompletePercent})):null)(),e.attachmentViewState.shouldShowContextMenu?(n=>{const r=C.h.tryImportForRender(),i=r?r(e.attachmentViewState,n,{viewState:e.attachmentViewState,attachmentSelectionSource:F.b.ConversationAttachmentWell,parentItemId:e.parentItemId,isDraft:!1,isEdit:!1,onBeforePreview:e.onBeforePreview,createImageGallery:e.createImageGallery,instrumentationContext:e.instrumentationContext,targetWindow:window},e.parentItemId,null,t.current.parentElement,null):[];return f.createElement(f.Fragment,null,i.map(t=>f.createElement(K,{key:t.key,attachmentViewState:e.attachmentViewState,menuItem:t})))})(o):null)}));const K=Object(r.a)((function(e){const t=f.useCallback(t=>{t.stopPropagation(),e.menuItem.onClick(t,e.menuItem),Object(s.a)(e.attachmentViewState,!1)},[e.menuItem,e.attachmentViewState]),n=f.useCallback(t=>{t.keyCode!==S.a.enter&&t.keyCode!==S.a.space||(t.stopPropagation(),e.menuItem.onClick(),Object(s.a)(e.attachmentViewState,!1))},[e.menuItem,e.attachmentViewState]);return f.createElement("div",{tabIndex:0,"data-is-focusable":!0,className:z.a.menuItem,onClick:t,onKeyDown:n},e.menuItem.name)}));function Q(e){e.keyCode!==S.a.enter&&e.keyCode!==S.a.space||(U.h.info("AttachmentMenuButton.keyDown enter|space"),e.stopPropagation())}var J=n(18100),Z=n.n(J);const X=Y.a.bind(Z.a);var $=Object(r.a)((function(e){f.useEffect(()=>(n(),I.a.importAndExecute(n),()=>{I.c.importAndExecute(n)}),[]);const t=t=>{e.viewState.docViewAttachments.forEach(e=>{Object(h.a)(e,e.attachmentId.Id===t),e.shouldShowContextMenu&&e.attachmentId.Id!==t&&Object(s.a)(e,!1)})},n=()=>{p(e.viewState)},r=async()=>Object(w.a)(e.viewState,"",!0);let i=!1,a=null,o=null;const c=()=>{const n=null==a?void 0:a.nextElementSibling;null==n||n.focus(),t(e.viewState.docViewAttachments[0].attachmentId.Id)};return f.createElement("div",{className:X("disableTextSelection","customScrollBar",Z.a.container),style:{maxHeight:e.viewState.maxHeight+"px"}},f.createElement("div",{ref:e=>a=e,tabIndex:0,onFocus:()=>{if(i){const n=null==o?void 0:o.previousElementSibling;null==n||n.focus(),t(e.viewState.docViewAttachments[e.viewState.docViewAttachments.length-1].attachmentId.Id)}else i=!0,c()}}),e.viewState.docViewAttachments.map(n=>f.createElement(q,{key:"convoWell_"+n.attachmentId.Id,attachmentViewState:n,parentItemId:e.viewState.parentItemIdMap[n.attachmentId.Id],itemReceivedTime:e.viewState.itemReceivedTimeMap[n.attachmentId.Id],instrumentationContext:e.instrumentationContext,onBeforePreview:e.onBeforePreview,onFocus:t,createImageGallery:r})),f.createElement("div",{ref:e=>o=e,tabIndex:0,onFocus:c}))})),ee=n(18102),te=n(18103),ne=n.n(te),re=Object(r.a)((function(e){f.useEffect(()=>{!n.current&&e.viewState.docViewAttachments.length>0&&(n.current=!0,Object(c.p)("ConversationAttachmentWellButtonShown"))});const t=f.useRef(),n=f.useRef(!1),r=()=>{u(e.viewState,!1),e.viewState.docViewAttachments.forEach(e=>{Object(s.a)(e,!1)})},l=e.viewState.docViewAttachments.length;if(0===l)return null;const h=l+(e.canLoadMore?"+":"");return f.createElement("div",{className:e.className||""},f.createElement("div",{ref:e=>t.current=e},f.createElement(i.a,{onClick:()=>{e.viewState.isVisible?r():(u(e.viewState,!0),Object(c.p)("ConversationAttachmentWellButtonClicked",null,{cosmosOnlyData:JSON.stringify({numberOfAttachments:e.viewState.docViewAttachments.length})}))},text:h,className:ne.a.button,iconProps:{iconName:"Attach",styles:{root:ne.a.icon}},menuIconProps:{iconName:"ChevronDown",styles:{root:ne.a.menuIcon}},ariaLabel:(()=>{const t=e.viewState.docViewAttachments.length;return t>1?Object(d.c)(Object(d.b)(m.a),t):Object(d.c)(Object(d.b)(ee.a),t)})(),styles:{label:ne.a.label}})),e.viewState.isVisible?f.createElement(a.a,{setInitialFocus:!0,isBeakVisible:!1,target:t.current,onDismiss:r,directionalHint:o.a.bottomRightEdge},f.createElement($,{viewState:e.viewState,instrumentationContext:e.instrumentationContext,onBeforePreview:r})):null)}));n.d(t,"ConversationAttachmentWellButton",(function(){return re}))},2759:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"i",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"g",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"h",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"e",(function(){return m}));var r=n(2);const i=Object(r.action)("ADD_SHARING_LINK",(e,t,n,r,i,a,o,c,s,l,u,d,m)=>({linkId:e,url:t,sharingLinkIds:n,response:r,source:i,providerType:a,linksContainerId:o,unwrappedUrl:c,creationDateTime:s,thumbnailUrl:l,previewUrl:u,shareId:d,fromQuotedBody:m})),a=Object(r.action)("SHARING_LINK_REMOVED",(e,t,n,r,i)=>({linkId:e,sharingLinkIds:t,fileName:n,providerType:r,linksContainerId:i})),o=Object(r.action)("DELETE_LINK",(e,t)=>({linkId:e,targetWindow:t})),c=Object(r.action)("CREATE_ATTACHMENT_FROM_LINK",(e,t,n,r)=>({linkId:e,providerId:t,isTryAgain:n,targetWindow:r})),s=Object(r.action)("ON_LINK_HAS_CHANGED",(e,t,n,r)=>({linkId:e,recipientInfos:t,composeId:n,isCalendar:r})),l=Object(r.action)("ADD_SHARING_LINK_TO_CONTAINER",(e,t)=>({linkId:e,linkIdContainer:t})),u=Object(r.action)("REMOVE_SHARING_LINK_FROM_CONTAINER",(e,t)=>({linkId:e,linkIdContainer:t})),d=Object(r.action)("ON_FLUID_LINK_CREATED",(e,t,n,r,i)=>({linkId:e,containerId:t,owaSource:n,url:r,viewStateId:i})),m=Object(r.action)("ON_EXISTING_FLUID_LINK_PROCESSED",(e,t,n,r,i)=>({linkId:e,containerId:t,owaSource:n,url:r,viewStateId:i}))},2765:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r={FavoriteNode:"favoritenode",InboxRule:"inboxrule",MessageRule:"messagerule",LocalFile:"Files",MailFolderNode:"mailfoldernode",MailListItemPart:"maillistitempart",MailListRow:"maillistrow",MultiMailListConversationRows:"multimaillistconversationrows",MultiMailListMessageRows:"multimaillistmessagerows",ReadWriteRecipient:"recipient",RibbonCustomizerButton:"ribboncustomizerbutton",NoteFeedItem:"notefeeditem",Todo:"todo",Attachment:"attachment",CommandBarEditorButton:"commandbareditorbutton",CalendarNode:"calendarnode",CalendarGroupNode:"calendargroupnode",CalendarItem:"calendaritem"}},2809:function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return a})),n.d(t,"g",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return l})),n.d(t,"d",(function(){return u}));var r=n(2);const i=Object(r.action)("UPDATE_SHARING_LINK_FROM_SHARING_DIALOG",(e,t)=>({linkId:e,sharingDialogResponse:t})),a=Object(r.action)("UPDATE_SHAREPOINT_LINK_PERMISSION",(e,t)=>({linkId:e,newPermission:t})),o=Object(r.action)("UPDATE_SHAREPOINT_LINK_URL",(e,t,n,r)=>({linkId:e,newLinkUrl:t,oldLinkUrl:n,expirationDate:r})),c=Object(r.action)("SET_REFRESH_STATUS_FOR_LINK",(e,t)=>({linkId:e,actionStatus:t})),s=Object(r.action)("CREATE_OR_UPDATE_SHARING_LINK",(e,t,n,r,i,a,o,c,s)=>({linkId:e,sharingUrl:t,currentUrl:n,canonicalUrl:r,newPermissionLevel:i,providerType:a,composeId:o,recipientInfos:c,isCalendar:s})),l=Object(r.action)("ADD_SHARING_LINK_INFO",(e,t)=>({linkId:e,linkModel:t})),u=Object(r.action)("TOKEN_UNAVAILABLE",e=>({linkId:e}))},2848:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3070),i=n(2849);function a(e){const t=Object(r.a)(),n=Object(i.b)(e);return t.sharingLinks.get(n)}},2849:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return c}));var r=n(25);const i="_ODSPPSL";function a(e){return Object(r.k)("doc-link-savePermission")&&e&&-1!==e.indexOf(i)?e.substring(0,e.length-i.length):e}function o(e){return!!Object(r.k)("doc-link-savePermission")&&e.lastIndexOf(i)===e.length-i.length}function c(e,t){return!Object(r.k)("doc-link-savePermission")||2!==t&&1!==t?e:e+i}},2881:function(e,t,n){"use strict";var r,i=n(20),a=n(2759),o=n(2809),c=n(3131);!function(e){e.PasteHtml="PasteHtml",e.InsertLinkFromToolbar="InsertLinkFromToolbar",e.InsertLinkFromAttachMenu="InsertLinkFromAttachMenu",e.AutoLink="AutoLink",e.ReplyOrForward="ReplyOrForward",e.LinkContextMenu="LinkContextMenu",e.Undo="Undo",e.EditorLoadedOrDraftOrReply="EditorLoadedOrDraftOrReply",e.RestoreCursor="RestoreCursor",e.ShareLinkCompose="ShareLinkCompose",e.NewFluidFile="NewFluidFile",e.Unknown="Unknown"}(r||(r={}));var s=n(2942),l=n(3140),u=n(3107),d=n(2849),m=n(2848);const f=[r.PasteHtml,r.InsertLinkFromToolbar,r.AutoLink,r.ShareLinkCompose,r.InsertLinkFromAttachMenu];function h(e){const t=Object(m.a)(e);return t&&-1!==f.indexOf(t.source)}var p=n(3092);function w(e){const t=Object(m.a)(e);return t?{id:t.linkId,name:t.fileName,supportsDownsell:!1,currentPermissionLevel:t.permissionLevel,sharingInfo:t.sharingInfo,sharingTipsIgnored:t.sharingTipsIgnored,sharingRecipientsInfo:t.sharingRecipientsInfo,typeOfLink:h(e)?"newLink":"oldLink"}:null}var I=n(3070);function b(){return Object(I.a)().sharingLinks.size}var v=n(3132);n.d(t,"t",(function(){return S})),n.d(t,"D",(function(){return k})),n.d(t,"K",(function(){return x})),n.d(t,"G",(function(){return C})),n.d(t,"E",(function(){return O})),n.d(t,"B",(function(){return L})),n.d(t,"H",(function(){return E})),n.d(t,"I",(function(){return N})),n.d(t,"J",(function(){return A})),n.d(t,"v",(function(){return P})),n.d(t,"s",(function(){return _})),n.d(t,"A",(function(){return y})),n.d(t,"u",(function(){return R})),n.d(t,"F",(function(){return j})),n.d(t,"C",(function(){return D})),n.d(t,"y",(function(){return M})),n.d(t,"x",(function(){return F})),n.d(t,"w",(function(){return U})),n.d(t,"z",(function(){return W})),n.d(t,"P",(function(){return g})),n.d(t,"d",(function(){return a.a})),n.d(t,"e",(function(){return a.b})),n.d(t,"f",(function(){return a.c})),n.d(t,"h",(function(){return a.d})),n.d(t,"R",(function(){return a.h})),n.d(t,"T",(function(){return a.i})),n.d(t,"M",(function(){return a.f})),n.d(t,"N",(function(){return a.g})),n.d(t,"L",(function(){return a.e})),n.d(t,"U",(function(){return o.e})),n.d(t,"V",(function(){return o.f})),n.d(t,"W",(function(){return o.g})),n.d(t,"S",(function(){return o.c})),n.d(t,"g",(function(){return o.b})),n.d(t,"Q",(function(){return c.b})),n.d(t,"a",(function(){return r})),n.d(t,"o",(function(){return s.a})),n.d(t,"q",(function(){return s.b})),n.d(t,"O",(function(){return l.a})),n.d(t,"c",(function(){return u.a})),n.d(t,"i",(function(){return d.a})),n.d(t,"j",(function(){return d.b})),n.d(t,"r",(function(){return d.c})),n.d(t,"p",(function(){return h})),n.d(t,"b",(function(){return p.a})),n.d(t,"m",(function(){return m.a})),n.d(t,"l",(function(){return w})),n.d(t,"k",(function(){return b})),n.d(t,"n",(function(){return v.a}));const g=new i.c(()=>Promise.all([n.e(0),n.e(29),n.e(87),n.e(687)]).then(n.bind(null,19718))),S=new i.b(g,e=>e.addRecipientsIntoLink),k=new i.b(g,e=>e.removeRecipientsFromLink),x=new i.b(g,e=>e.updateRecipientPermissionInfos),C=new i.b(g,e=>e.setGetPermissionInfoFailure),O=new i.b(g,e=>e.resetSharingRecipientsInfo),L=new i.b(g,e=>e.ignoreSharingTip),E=new i.b(g,e=>e.setLinkActionStatus),N=new i.b(g,e=>e.updateLinkContainerIdOfLink),A=new i.b(g,e=>e.updateLinkIds),P=new i.b(g,e=>e.createLinksIdContainer),_=new i.b(g,e=>e.addLinkIdToLinksIdContainer),y=new i.b(g,e=>e.getSharingTipRecipientInfo),R=new i.b(g,e=>e.createCloudFileFromSharingLink),j=new i.b(g,e=>e.retrieveImageUrlsForImageFile),D=new i.b(g,e=>e.imageLinkPreviewCondition),M=new i.b(g,e=>e.getLinksIdContainer),F=new i.b(g,e=>e.getAllLinksContainerIds),U=new i.b(g,e=>e.doesLinksIdContainerExist),W=new i.b(g,e=>e.getSharingLinkInfo)},2907:function(e,t,n){"use strict";var r;function i(){return[r.noPermissionToShare,r.getSharingInfoFailed,r.linkHasExpired,r.linkWillExpire,r.noPermissionToShareExternally,r.externalRecipientCSL,r.noPermissionSet,r.sharingWithLargeDL]}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),function(e){e.noPermissionToShare="WarningNoPermissionToShare",e.getSharingInfoFailed="WarningGetSharingInfoFailed",e.linkHasExpired="WarningLinksHasExpired",e.linkWillExpire="WarningLinksWillExpire",e.noPermissionToShareExternally="WarningExternalRecipientButNoPermissionToShareExternally",e.externalRecipientCSL="WarningExternalRecipientsCannotOpenCSLs",e.noPermissionSet="WarningOnlyPeopleWithExistingAccessCanAccess",e.sharingWithLargeDL="WarningNotAllMembersOfDLCanAccess"}(r||(r={}))},2942:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var r=n(2746),i=n(25);function a(e){const t=(Object(r.a)(e)||"").toLowerCase();return!!e&&(Object(i.k)("cmp-prague")&&(".fluid"===t||".note"===t))}function o(e){const t=(Object(r.a)(e)||"").toLowerCase();return!!e&&(Object(i.k)("cmp-prague")&&".note"===t)}},3045:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.InProgress=0]="InProgress",e[e.Failed=1]="Failed",e[e.Succeeded=2]="Succeeded"}(r||(r={}))},3061:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2);const i=Object(r.action)("REFRESH_EXPIRATION_DATE",e=>({id:e}))},3062:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ignore=0]="ignore",e[e.refreshExpiration=1]="refreshExpiration",e[e.changePermission=2]="changePermission",e[e.attachAsACopy=3]="attachAsACopy"}(r||(r={}))},3070:function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));var r=n(13),i=n(2);const a={sharingLinks:new r.ObservableMap({}),linksIdContainerMap:new r.ObservableMap({})},o=Object(i.createStore)("sharingLinkStore",a);t.a=o},3092:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.none=0]="none",e[e.refreshing=1]="refreshing",e[e.refreshFailed=2]="refreshFailed",e[e.refreshSucceeded=3]="refreshSucceeded",e[e.attachingAsACopy=4]="attachingAsACopy",e[e.pendingAttachAsACopy=5]="pendingAttachAsACopy"}(r||(r={}))},3131:function(e,t,n){"use strict";function r(e){return void 0!==e.recipients}function i(e){return void 0!==e.length}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}))},3132:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3146),i=n(242),a=n(244);async function o(e){return function(e){if(!Object(i.a)(null==e?void 0:e.nav)){const t={nav:e.nav};return Object(a.stringify)(t)}return null}((await r.b.import())(e))}},3140:function(e){e.exports=JSON.parse('{"a":"uVa"}')},3146:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return u}));var r=n(20);const i=new r.c(()=>n.e(1274).then(n.bind(null,3884))),a=new r.b(i,e=>e.extractFileUrlFromOfficeSharePointLink),o=new r.b(i,e=>e.isLinkPrefixedWithBaseUrl),c=new r.b(i,e=>e.isSharePointLink),s=new r.b(i,e=>e.isSharePointServiceGeneratedLink),l=new r.b(i,e=>e.isOfficeSharePointLink),u=new r.b(i,e=>e.getParsedQueryStringFromUrl)},3164:function(e,t,n){"use strict";n.d(t,"h",(function(){return l})),n.d(t,"i",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"k",(function(){return m})),n.d(t,"n",(function(){return f})),n.d(t,"e",(function(){return h})),n.d(t,"l",(function(){return p})),n.d(t,"g",(function(){return w})),n.d(t,"j",(function(){return I})),n.d(t,"m",(function(){return b}));var r=n(20),i=n(3061);n.d(t,"o",(function(){return i.a}));var a=n(3045);n.d(t,"a",(function(){return a.a}));var o=n(2907);n.d(t,"d",(function(){return o.b})),n.d(t,"c",(function(){return o.a}));var c=n(3062);n.d(t,"b",(function(){return c.a}));const s=new r.c(()=>Promise.all([n.e(0),n.e(29),n.e(87),n.e(795)]).then(n.bind(null,4080))),l=new r.b(s,e=>e.getSharingInformation),u=new r.b(s,e=>e.getSharingIssuesForSharingData),d=new r.b(s,e=>e.getInfoBarCreator),m=new r.b(s,e=>e.hasLargeDLRecipient),f=new r.b(s,e=>e.hasRecipientExpansionFailure),h=new r.b(s,e=>e.getGroupsAndSmallDLs),p=new r.b(s,e=>e.isDLOrGroup),w=new r.b(s,e=>e.getInvididualRecipients),I=new r.b(s,e=>e.hasGetRecipientPermissionFailed),b=new r.b(s,e=>e.logSharingTipChangesForLinkRemoval)},3667:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(35);function i(e,t){return Object(r.a)("GetWacAttachmentInfo",e,t)}},4058:function(e,t,n){"use strict";function r(e,t){t&&e&&(e.addCustomData({httpStatusCode:t.status}),function(e,t){t&&e&&e.addCustomData({frontendServer:t.get("x-feserver"),requestId:t.get("request-id"),backendServer:t.get("x-beserver"),backendHttpStatus:t.get("x-backendhttpstatus"),serverVersion:t.get("x-owa-version")})}(e,t.headers))}function i(e){return e&&void 0!==e.fetchErrorType}function a(e,t){e.addCustomProperty("ErrorInformation",t)}function o(e,t){let n="";n=t?"Empty response from server":"Null response from server",a(e,n)}n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return o}))},6234:function(e){e.exports=JSON.parse('{"a":"enc"}')},8160:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2748),i=n(1427),a=n(2852);function o(e){const t=e.AttachmentId.Id||"";if(Object(a.a)(e)){const n=e;return{fileType:r.a.Cloud,name:n.Name,size:n.Size,providerId:"",providerType:4,location:n.AttachLongPathName,providerEndpointUrl:"",isFolder:!1,thumbnailUrl:n.AttachmentThumbnailUrl,previewUrl:n.AttachmentPreviewUrl,fileId:t,fileParentId:"",type:n.__type}}return{attachmentItemId:t,name:e.Name,size:e.Size,fileType:r.a.AttachmentItem,type:i.c}}},9150:function(e,t,n){"use strict";var r=n(68),i=n(2851),a=n(168),o=n(25),c=n(2881),s=n(22);async function l(e,t,n=!1){const l=[],u=await i.g.import(),d=await i.j.import(),m=n?await i.m.import():null,f=n?null==e?void 0:e.docViewAttachments:null==e?void 0:e.imageViewAttachments;for(let t=0;t<(null==f?void 0:f.length);t++){const r=f[t],i=u(r.attachmentId);if(n&&!m(i.model))continue;try{await d(r.attachmentId,e.isReadOnly)}catch(e){s.h.warn(`Unable to refresh thumbnail image for ${r.attachmentId}. Got error ${e}`)}const a={downloadUrl:i.download.url,id:r.attachmentId,previewUrl:i.previewImage.url,thumbnailUrl:i.thumbnailImage.url};l.push(a)}let h=0;const p=new r.b("BeautifulImageLinksShownInPreview"),w=(await c.y.import())(t);if((Object(o.k)("doc-deprecateCloudy-preview")||Object(o.k)("doc-deprecateCloudy-preview-thumbnailView"))&&w){const e=await c.z.import(),t=w.linkIds.concat(w.quotedBodyLinkIds),n=await c.C.import();for(let r=0;r<t.length;r++){const i=e(t[r]);if(n(i.fileName,i.providerType)){h++;const e={downloadUrl:i.url,id:{Id:t[r],RootItemId:t[r],mailboxInfo:Object(a.d)()},previewUrl:i.previewUrl,thumbnailUrl:i.thumbnailUrl};e.previewUrl&&l.push(e)}}}return p.addCustomData({countOfImageLinks:h}),p.end(),l}n.d(t,"a",(function(){return l}))}}]);
//# sourceMappingURL=owa.735.js.map
self.scriptsLoaded['owa.735.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.735.js'] = (new Date()).getTime();