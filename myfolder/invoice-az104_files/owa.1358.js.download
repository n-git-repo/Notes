self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.1358.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[1358],{18170:function(e,t,r){"use strict";r.r(t);var n=r(8024);r.d(t,"getAdditionalPropertiesFromServer",(function(){return n.b})),r.d(t,"getItemProperties",(function(){return n.c})),r.d(t,"cleanUpByItemId",(function(){return n.a}))},8024:function(e,t,r){"use strict";var n=r(2),s=r(2742),i=Object(n.mutatorAction)("updateItemInStore",(e,t)=>{const r=s.u.items.get(e);r&&Object.keys(t).forEach(e=>{"ExtendedProperty"==e?r.ExtendedProperty=[...t.ExtendedProperty,...r.ExtendedProperty]:"ItemId"!=e&&(r[e]=t[e])})}),o=r(68),u=r(2793),a=r(2740),c=r(1087),d=r(22),l=r(391);r.d(t,"d",(function(){return P})),r.d(t,"b",(function(){return p})),r.d(t,"c",(function(){return I})),r.d(t,"a",(function(){return h}));const m={},f={},g="GetItemManagerFailure";function P(e){e.forEach(e=>{f[e.featureId]=e})}function p(e,t,r){if(m[e]&&"Pending"==m[e].requestStatus)return;const{itemShape:n,defaultValues:s}=function(e,t){const r=[];let n={};if(Object.keys(f).forEach(s=>{const{isPropertyExistedOnItem:i,shouldGetItemPropertiesFromServer:o,propertyPaths:u,getDefaultValues:a}=f[s];!i(e)&&o(e,t)&&(r.push(...u),n=Object.assign(Object.assign({},n),null==a?void 0:a()))}),r.length>0)return{itemShape:Object(c.a)({BaseShape:"IdOnly",AdditionalProperties:r}),defaultValues:n};return{itemShape:null,defaultValues:null}}(e,t);if(!n)return;const P=a.a.items.get(e);if(!P)return;const p={itemId:e,listViewType:t,requestStatus:"Pending",pendingPromise:null};m[e]=p;const I=Object(l.a)(P.MailboxInfo);p.pendingPromise=Object(u.a)(e,n,null,null,P.MailboxInfo,I,null,null,r).then(t=>{if(!t||t instanceof Error)return t?(t.fetchErrorType="ServerFailure",Promise.reject(t)):Promise.resolve(null);{let r;p.requestStatus="Success",r=Array.isArray(t)?t[0]:t;const n=Object.assign(Object.assign({},s),r);return i(e,n),Promise.resolve(a.a.items.get(e))}}).catch(e=>(p.requestStatus="Error",Object(o.p)(g,{errorMessage:e.message}),d.h.warn(`[GetItemManager_getAdditionalPropertiesFromServer] Error: ${e.message}`),Promise.reject(e)))}function I(e,t){const r=f[t];if(!r)return Promise.reject(new Error("GetItemManager: The featureId is not registered in GetItemManager."));if(r.isPropertyExistedOnItem(e))return Promise.resolve(a.a.items.get(e));if(!m[e])return Promise.reject("GetItemManager: Please trigger getItem after the container finished loading.");{const t=m[e];switch(t.requestStatus){case"Success":return Promise.resolve(a.a.items.get(e));case"Pending":case"Error":return t.pendingPromise;default:return Promise.reject(new Error("GetItemManager: The request status is unknown."))}}}function h(e){delete m[e]}}}]);
//# sourceMappingURL=owa.1358.js.map
self.scriptsLoaded['owa.1358.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.1358.js'] = (new Date()).getTime();