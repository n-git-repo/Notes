self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.816.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[816],{19853:function(e,t,n){"use strict";n.r(t);var i=n(7793),a=n(5),o=n(3653),r=n(7590),d=n(3677),c=n(2733),l=n(358),u=Object(l.action)("updateRollupOnAddOrUpdateRowNotification")((function(e){const t=Object(c.I)();if(null==t)return;const n=Object(c.n)(e),i=Object(c.n)(t);(0==n&&1==i||1==n&&0==i)&&Object(d.b)(e.tableQuery)})),s=n(3012),b=n(3399),f=n(4173),m=n(8673),p=n(2742),y=n(25),v=n(3509);var k=Object(l.action)("rowNotificationHandler.onAddOrUpdateRow")((function(e,t){const n=e.InstanceKey;if(!n)throw new Error("onAddOrUpdateNotification: Row instanceKey should not be null");if(!Object(s.k)(e,t))return;const{lastDeliveryOrRenewTimeStamp:d,lastDeliveryTimeStamp:l}=Object(s.e)(e,t.tableQuery.listViewType);let k=Object(m.b)(d,l,t,0,n);const w=Object(i.a)(n,t),O=w>=0;-1!=k?Object(c.V)(t.tableQuery.folderId)&&Object(a.Hb)(Object(a.pc)(l),c.Z.inboxPausedDateTime)||(!function(e,t){if(Object(y.k)("tri-spotlight2")){let n;if(1===t.tableQuery.listViewType){const i=c.b.getRowClientItemId(e.InstanceKey,t),a=p.u.items.get(null==i?void 0:i.Id);n=null==a?void 0:a.SpotlightIsVisible}else{const i=Object(c.M)(e.InstanceKey,t.id);n=null==i?void 0:i.spotlightIsVisible}(e.SpotlightIsVisible&&!n||!e.SpotlightIsVisible&&n)&&v.c.importAndExecute()}}(e,t),O?(w<k&&k--,function(e,t,n){Object(s.g)(e,t)?(b.a.updateRowData(e,t),Object(c.bb)(t,4)):(b.a.updateRow(n,e,t,"RowUpdateNotification"),Object(c.bb)(t,2)),Object(r.a)(e.InstanceKey,t)}(e,t,k)):function(e,t,n){b.a.addRow(n,e,t,"RowAddNotification"),Object(c.bb)(t,1),t.currentLoadedIndex++}(e,t,k),f.d.importAndExecute(n,t,!0),-1!=Object(c.n)(t)&&u(t),Object(s.d)(t)):O&&Object(o.a)([n],t,"UpdateNotification")})),w=n(5783),O=n(2),N=Object(O.action)("TRY_REMOVE_ITEM_NORMALIZED_BODY",e=>({item:e})),I=n(3020),j=n(2834),T=n(3184),S=n(2883),g=n(68),R=n(22);let h=Object(l.action)("handleRowNotification")((function(e,t={tableView:S.a.tableViews.get(e.id)}){Object(y.k)("auth-signalrChannelLogging")&&Object(g.p)("SignalRNotification",{NotificationType:e.id,EventType:e.EventType});const n=t.tableView;if(!n)return void R.h.info("Received row notification for a deleted folder");if(!n.isInitialLoadComplete)return void R.h.info("Ignore row notifications as table has not loaded");let i;switch(e.EventType){case"RowAdded":i=V(e,n),F(i,n);break;case"RowModified":i=V(e,n),C(i,n);break;case"RowDeleted":i=V(e,n),D(i,n);break;case"QueryResultChanged":case"Reload":P(n);break;default:return}}));function V(e,t){switch(t.tableQuery.listViewType){case 0:return e.Conversation?e.Conversation:(R.d("Conversation should not be undefined or empty in notification payload."+e.EventType+", "+e.id),null);case 1:return e.Item?e.Item:(R.d("Item should not be undefined or empty in notification payload."+e.EventType+", "+e.id),null);default:return R.d("rowNotificationStrategy: unsupported listViewType: "+t.tableQuery.listViewType),null}}let F=Object(l.action)("rowNotificationHandler.onAddRow")((function(e,t){Object(c.V)(t.tableQuery.folderId)||t.totalRowsInView++,k(e,t)})),C=Object(l.action)("rowNotificationHandler.onUpdateRow")((function(e,t){k(e,t)})),D=Object(l.action)("rowNotificationHandler.onDeleteRow")((function(e,t){const n=e.InstanceKey;if(!n)throw new Error("onDeleteNotification: Row instanceKey should not be null");t.totalRowsInView--,Object(s.j)(e,t)&&Object(i.a)(n,t)>=0&&(Object(o.a)([n],t,"DeleteNotification"),Object(c.bb)(t,3))})),P=Object(l.action)("rowNotificationHandler.onReload")((function(e,t={conversations:j.a,items:p.u.items}){!function(e,t){switch(e.tableQuery.listViewType){case 0:t.conversations.clear();const n=t.conversations.getItemIds();for(let i=0,a=n.length;i<a;i++){const a=n[i];if(t.conversations.has(a)){const n=t.conversations.get(a);f.c.importAndExecute(n.conversationId,e)}}break;case 1:for(const n of e.rowKeys){const i=c.b.getRowClientItemId(n,e),a=t.items.get(i.Id);N(a),t.items.get(i.Id).NormalizedBody&&f.c.importAndExecute(i,e)}}}(e,t),Object(w.a)(e),I.a.clearMapForFolder(e.serverFolderId)}));Object(O.mutator)(N,e=>{const t=e.item;Object(T.d)(t.ConversationId.Id,0)||Object(T.e)(t.ItemId.Id,0)||(t.NormalizedBody=void 0)});var E=n(2737),A=n(6076),Q=n(1085),x=n(3329);var M=n(3919),B=n(937),_=n(8119),L=n(9226);const U={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"subscribeToRowNotifications"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subscriptionId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"listViewType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ReactListViewType"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"type"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"TableQueryType"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"categoryName"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"focusedViewFilter"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"FocusedViewFilter"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"viewFilter"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ViewFilter"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"sortBy"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SortByInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shapeName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isScheduledFolder"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"subscribeToRowNotifications"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"subscriptionId"},value:{kind:"Variable",name:{kind:"Name",value:"subscriptionId"}}},{kind:"ObjectField",name:{kind:"Name",value:"listViewType"},value:{kind:"Variable",name:{kind:"Name",value:"listViewType"}}},{kind:"ObjectField",name:{kind:"Name",value:"type"},value:{kind:"Variable",name:{kind:"Name",value:"type"}}},{kind:"ObjectField",name:{kind:"Name",value:"categoryName"},value:{kind:"Variable",name:{kind:"Name",value:"categoryName"}}},{kind:"ObjectField",name:{kind:"Name",value:"focusedViewFilter"},value:{kind:"Variable",name:{kind:"Name",value:"focusedViewFilter"}}},{kind:"ObjectField",name:{kind:"Name",value:"viewFilter"},value:{kind:"Variable",name:{kind:"Name",value:"viewFilter"}}},{kind:"ObjectField",name:{kind:"Name",value:"commonRowsOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}},{kind:"ObjectField",name:{kind:"Name",value:"sortBy"},value:{kind:"Variable",name:{kind:"Name",value:"sortBy"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}},{kind:"ObjectField",name:{kind:"Name",value:"shape"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"ShapeName"},value:{kind:"Variable",name:{kind:"Name",value:"shapeName"}}},{kind:"ObjectField",name:{kind:"Name",value:"IsScheduledFolder"},value:{kind:"Variable",name:{kind:"Name",value:"isScheduledFolder"}}}]}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"NotificationPayload"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"EventType"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"RowNotificationChangePayload"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Conversation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ConversationTypeFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"Item"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ItemRowFragment"}}]}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"RowNotificationDeletePayload"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Conversation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"InstanceKey"}}]}},{kind:"Field",name:{kind:"Name",value:"Item"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"InstanceKey"}}]}}]}}]}}]}},..._.a.definitions,...L.a.definitions]};var K=n(595),q=n(2827),H=n(2751);var z=n(20);const G=new z.c(()=>n.e(2182).then(n.bind(null,20101))),W=new z.a(G,e=>e.subscribeToChannelReadyNotification),Y={};function $(e){const t=Y[e];if(t){ee(Object(c.L)().tableViews.get(e))?function(e){e.unsubscribe()}(t):B.k.importAndExecute(t,h),delete Y[e]}}function Z(e){if(Y[e.id])return;if(Object(y.k)("grp-loadFolders")&&3===e.tableQuery.type)return;if(0!=e.tableQuery.type&&2!=e.tableQuery.type)throw new Error("subscribeToRowNotifications should only be called for Folder or Group table type");const t=e.tableQuery;1!=t.sortBy.sortColumn||Object(p.m)(e.tableQuery.folderId)||Object(E.C)(e.tableQuery.folderId,"SharedMailbox")||"spotlight"!==t.scenarioType&&(ee(e)?(W.importAndExecute(),async function(e){const t=e.tableQuery;return Object(K.a)().subscribe({query:U,variables:{subscriptionId:e.id,folderId:e.tableQuery.folderId,listViewType:Object(c.s)(t.listViewType),type:Object(c.u)(e.tableQuery.type),categoryName:t.categoryName,focusedViewFilter:Object(c.r)(t.focusedViewFilter),viewFilter:Object(c.v)(t.viewFilter),sortBy:{sortColumn:Object(c.t)(t.sortBy.sortColumn),sortDirection:t.sortBy.sortDirection,canSortByRenewTime:Object(s.l)(t)},shapeName:A.c(e.tableQuery.folderId,Object(c.T)(t.scenarioType)),isScheduledFolder:"scheduled"==Object(H.a)(e.tableQuery.folderId),mailboxInfo:Object(q.d)(t)}}).subscribe({next:e=>h(e.data.subscribeToRowNotifications),error:e=>{R.h.info(`Row notification error ${e}`)}})}(e).then(t=>{Y[e.id]=t})):B.b.import().then(n=>{const i={NotificationType:"RowNotification",FolderId:J(e),FocusedViewFilter:t.focusedViewFilter,IsConversation:0==t.listViewType,CategoryFilter:t.categoryName,Filter:t.viewFilter,ChannelId:n(),MailboxId:X(e)};!0===i.IsConversation?(i.ConversationShapeName=A.c(e.tableQuery.folderId,Object(c.T)(t.scenarioType)),i.ConversationResponseShape=A.b(e.tableQuery.folderId),i.SortBy=function(e){const t=e.sortBy;let n;switch(e.sortBy.sortColumn){case 1:Object(s.l)(e)&&(n="ConversationLastDeliveryOrRenewTime");break;case 3:n="ConversationUniqueSenders";break;case 7:n="ConversationSize";break;case 8:n="ConversationTopic";break;case 5:n="ConversationImportance";break;default:throw new Error("getConversationSortByProperty: sort column is not supported "+t.sortColumn)}const i=[];n&&i.push(Object(x.a)({Order:t.sortDirection,Path:Object(Q.a)({FieldURI:n})}));const a=1==e.sortBy.sortColumn?e.sortBy.sortDirection:c.c.DESCENDING_SORT_DIR;return i.push(Object(x.a)({Order:a,Path:Object(Q.a)({FieldURI:"ConversationLastDeliveryTime"})})),i}(t)):i.SortBy=Object(M.a)(t);const a={subscriptionId:e.id,requiresExplicitSubscribe:!0,subscriptionParameters:i};B.j.importAndExecute(a,h),Y[e.id]=a}))}function J(e){return 0==e.tableQuery.type?e.tableQuery.folderId:null}function X(e){return 2==e.tableQuery.type?e.tableQuery.folderId:null}function ee(e){return e&&(0==e.tableQuery.listViewType||1==e.tableQuery.listViewType&&Object(y.k)("mon-messageList-useGqlForFindItem"))}n.d(t,"subscribeToRowNotifications",(function(){return Z})),n.d(t,"unsubscribeToRowNotifications",(function(){return $}))},2750:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return d}));var i=n(2754),a=n(2);const o={tabs:[{id:"primaryTab",type:i.a.Primary,state:2,blink:!1,sxsId:"primaryTab"}],tabBarWidth:0,isOverflowMenuShown:!1};let r=Object(a.createStore)("tab",o);r();const d=r().tabs[0]},2754:function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.Primary=0]="Primary",e[e.OverflowMenu=1]="OverflowMenu",e[e.SecondaryReadingPane=2]="SecondaryReadingPane",e[e.MailCompose=3]="MailCompose",e[e.SxS=4]="SxS",e[e.CalendarCompose=5]="CalendarCompose"}(i||(i={}))},2817:function(e,t,n){"use strict";var i=n(20),a=n(2750),o=n(2902),r=n(2754);function d(e){const t=Object(a.a)();for(const n of t.tabs)if(n.type!==r.a.Primary&&n.type!==r.a.SxS&&n.data==e)return n;return null}function c(e){const t=Object(a.a)();for(const n of t.tabs)if(n.sxsId===e)return n.id;return null}function l(e){var t,n;const i=Object(a.a)();for(const a of i.tabs)if(a.type!==r.a.Primary&&a.type!==r.a.SxS&&(null===(n=null===(t=a.data)||void 0===t?void 0:t.id)||void 0===n?void 0:n.Id)==e)return!0;return!1}function u(e){switch(e.type){case r.a.SecondaryReadingPane:return e.data.subject;default:return null}}var s=n(2891);n(2979);n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return m})),n.d(t,"i",(function(){return p})),n.d(t,"l",(function(){return y})),n.d(t,"k",(function(){return v})),n.d(t,"j",(function(){return k})),n.d(t,"e",(function(){return a.a})),n.d(t,"m",(function(){return a.b})),n.d(t,"d",(function(){return o.a})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return c})),n.d(t,"o",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"a",(function(){return r.a})),n.d(t,"n",(function(){return s.b}));const b=new i.c(()=>n.e(1143).then(n.bind(null,20073)));let f=new i.a(b,e=>e.activateTab),m=new i.a(b,e=>e.addTab),p=new i.a(b,e=>e.closeTab),y=new i.a(b,e=>e.setTabIsShown),v=new i.a(b,e=>e.reloadSecondaryTabAsDeeplink),k=new i.b(b,e=>e.getTabById)},2829:function(e,t,n){"use strict";n.d(t,"b",(function(){return d}));var i=n(13),a=n(2834),o=n(2);const r={loadedItemReadingPaneViewStates:new i.ObservableMap({}),loadedConversationReadingPaneViewStates:new i.ObservableMap({}),itemPreviewPaneViewState:null,itemPrintPaneViewState:null,deeplinkId:null,shouldShowMobileUpsellEmptyState:!1,primaryReadingPaneTabId:null,sxsItemId:null,loadingProjectionIds:[]};let d=Object(o.createStore)("readingpane",r);const c=d();a.a.registerReference(()=>[...c.loadedConversationReadingPaneViewStates.keys()]),t.a=c},2891:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return r}));var i=n(2754);const a={};function o(e,t){a[i.a[e]]=t}function r(e){return a[i.a[e]]}},2902:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(2750),a=n(22);function o(){const e=Object(i.a)();for(const t of e.tabs)if(2==t.state)return t;return a.d("There is no active tab. Something went very wrong."),null}},2913:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(2829),a=n(3359);function o(e){return Object(i.b)().loadedConversationReadingPaneViewStates.get(e||Object(i.b)().sxsItemId||Object(a.a)())}},2979:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(2750);function a(){return Object(i.a)().tabs.filter(e=>3===e.state)}},3173:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(2829),a=n(3359);function o(e){return Object(i.b)().loadedItemReadingPaneViewStates.get(e||Object(a.a)())}},3184:function(e,t,n){"use strict";var i=n(20),a=n(3543),o=n(3163),r=n(3077),d=n(3117),c=n(3285),l=n(3275),u=n(3377),s=n(3570),b=n(3427),f=n(2829),m=n(2740);function p(e,t){return!!e&&(1!==t&&!!m.a.conversations.get(e))}function y(e,t){return 2!=t&&f.a.loadedItemReadingPaneViewStates.has(e)}var v=n(3259),k=n(3260),w=n(3173),O=n(2913);n.d(t,"l",(function(){return I})),n.d(t,"p",(function(){return j})),n.d(t,"m",(function(){return T})),n.d(t,"q",(function(){return S})),n.d(t,"s",(function(){return g})),n.d(t,"n",(function(){return R})),n.d(t,"o",(function(){return h})),n.d(t,"i",(function(){return V})),n.d(t,"j",(function(){return F})),n.d(t,"k",(function(){return C})),n.d(t,"g",(function(){return D})),n.d(t,"r",(function(){return P})),n.d(t,"h",(function(){return E})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return y})),n.d(t,"f",(function(){return v.a})),n.d(t,"a",(function(){return k.a})),n.d(t,"t",(function(){return f.a})),n.d(t,"c",(function(){return w.a})),n.d(t,"b",(function(){return O.a}));const N=new i.c(()=>Promise.all([n.e(0),n.e(5),n.e(6),n.e(9),n.e(13),n.e(15),n.e(18),n.e(25),n.e(27),n.e(30),n.e(42),n.e(62),n.e(73),n.e(98),n.e(156),n.e(168),n.e(190),n.e(257),n.e(237),n.e(280),n.e(417)]).then(n.bind(null,19704)));let I=new i.a(N,e=>e.loadConversationReadingPane),j=new i.a(N,e=>e.moveReadingPaneToTab),T=new i.a(N,e=>e.loadConversationReadingPaneForSingleMailItemSelected),S=new i.a(N,e=>e.print),g=new i.a(N,e=>e.setItemIdToScrollTo),R=new i.a(N,e=>e.loadItemReadingPane),h=new i.a(N,e=>e.loadItemReadingPaneForSingleMailItemSelected),V=new i.a(N,e=>e.expandCollapseAllItemParts);Object(i.f)(r.a,N,e=>e.deleteItemsStoreUpdateOrchestrator),Object(i.f)(c.a,N,e=>e.markConversationsAsReadStoreUpdateOrchestrator),Object(i.f)(l.a,N,e=>e.markItemsAsReadStoreUpdateOrchestrator),Object(i.f)(d.a,N,e=>e.markAllAsReadOrchestrator),Object(i.f)(a.a,N,e=>e.applyConversationFlagStateStoreUpdateOrchestrator),Object(i.f)(o.a,N,e=>e.deleteConversationStoreUpdateOrchestrator),Object(i.f)(b.a,N,e=>e.conversationReadyToLoadOrchestrator),Object(i.f)(b.b,N,e=>e.updateAttachmentsOrchestrator),Object(i.f)(b.c,N,e=>e.updateItemMandatoryPropertiesOrchestrator),Object(i.f)(u.a,N,e=>e.updateInternetMessageIdOrchestrator),Object(i.f)(s.a,N,e=>e.initializeExtendedCardForItemReadingPaneOrchestrator);new i.b(N,e=>e.getLastestNonDraftItemId);let F=new i.b(N,e=>e.getLatestNonDraftItemIdFromConversation),C=new i.b(N,e=>e.isUnsupportedItem),D=new i.a(N,e=>e.clearReadingPaneStore),P=new i.a(N,e=>e.replyByMeeting),E=new i.a(N,e=>e.ensureSecondaryReadingPaneTabHandler)},3259:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(25);function a(){return Object(i.k)("rp-linkedInViewProfile")||Object(i.k)("rp-linkedInViewProfileV1_1")}},3260:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const i="displaylinkedindataprebind"},3359:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(2817),a=n(3571);function o(){const e=Object(i.d)();switch(e.type){case i.a.SecondaryReadingPane:return e.data.id.Id;case i.a.Primary:default:return Object(a.a)()}}},3377:function(e,t,n){"use strict";var i=n(2);t.a=Object(i.action)("updateInternetMessageId",(e,t,n)=>({conversationId:e,itemId:t,internetMessageId:n}))},3427:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r}));var i=n(2);const a=Object(i.action)("CONVERSATION_READY_TO_LOAD",(e,t)=>({conversationId:e,nodeIdCollectionChange:t})),o=Object(i.action)("UPDATE_ATTACHMENTS"),r=Object(i.action)("UPDATE_ITEM_MANDATORY_PROPERTIES",(e,t)=>({conversationId:e,nodeIdCollectionWithItemMandatoryPropertiesChanged:t}))},3543:function(e,t,n){"use strict";var i=n(2);t.a=Object(i.action)("APPLY_CONVERSATION_FLAG_STATE_STORE_UPDATE",(e,t,n)=>({conversationIds:e,flagType:t,tableViewId:n}))},3570:function(e,t,n){"use strict";var i=n(2);t.a=Object(i.action)("initializeExtendedCardForItemReadingPane",(e,t)=>({itemReadingPaneViewState:e,loadedItem:t}))},3571:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(2829),a=n(483);function o(){var e,t;return Object(a.w)()?null===(e=Object(i.b)().deeplinkId)||void 0===e?void 0:e.id:null===(t=Object(i.b)().primaryReadingPaneTabId)||void 0===t?void 0:t.Id}},5783:function(e,t,n){"use strict";var i=n(68),a=n(3012),o=n(358);let r=Object(o.action)("onReloadTableSucceeded")((function(e,t,n){Object(a.h)(t,e,n,!0,!1,"MergeOnReload"),e.currentLoadedIndex=e.rowKeys.length})),d=Object(o.action)("onReloadTableFailed")((function(e){Object(i.p)("TnS_ReloadError",[e])}));var c=n(3451),l=n(25),u=n(3652),s=n(3046),b=n(2844),f=n(3919),m=n(462),p=n(2733),y=n(2827);const v=new m.a(1,(async function(e){const t=e.tableViewId,n=Object(p.L)().tableViews.get(t);if(!n)return Promise.resolve();const o=Math.max(n.currentLoadedIndex,b.a);switch(n.tableQuery.listViewType){case 0:await function(e,t){var n;const i=e.tableQuery,o=Object(p.l)(e,!0),l=null===(n=o)||void 0===n?void 0:n.Id;return Object(s.d)(i.folderId,t,i.viewFilter,i.sortBy,Object(a.l)(i),i.focusedViewFilter,i.requestShapeName,Object(y.d)(i),void 0,i.categoryName,l).then(t=>{let n=[];t.edges&&(n=t.edges.map(e=>e.node)),r(e,n,t.totalConversationRowsInView)}).catch(e=>{const t=Object(c.a)(e);d(t)})}(n,o);break;case 1:await function(e,t){const n=e.tableQuery;return Object(l.k)("mon-messageList-useGqlForFindItem")?Object(s.h)(Object(p.k)(n),t,n.viewFilter,n.sortBy,Object(a.l)(n),n.focusedViewFilter,n.requestShapeName,Object(y.d)(n),void 0,Object(y.e)(n),n.categoryName,Object(p.l)(e,!0)).then(t=>{let n=[];t.edges&&(n=t.edges.map(e=>e.node)),r(e,n,t.totalItemRowsInView)}).catch(e=>{const t=Object(c.a)(e);d(t)}):Object(s.c)(Object(p.k)(n),0,t,n.viewFilter,Object(f.a)(n),n.focusedViewFilter,n.requestShapeName,void 0,Object(y.e)(n),n.categoryName,Object(p.l)(e,!0)).then(t=>{"Success"==t.ResponseClass?r(e,t.RootFolder.Items,t.RootFolder.TotalItemsInView):d(t.ResponseCode)}).catch(e=>{d()})}(n,o)}0==n.tableQuery.type&&Object(u.a)(n.tableQuery.folderId);return Object(i.p)("ReloadTable",[o],{sessionSampleRate:10}),Promise.resolve()}),150);t.a=Object(o.action)("reloadMailListTableAction")((function(e){1===e.tableQuery.type||Object(p.V)(e.tableQuery.folderId)||v.add({tableViewId:e.id})}))},7590:function(e,t,n){"use strict";var i=n(2);t.a=Object(i.action)("ROW_UPDATED",(e,t)=>({rowKey:e,tableView:t}))},7793:function(e,t,n){"use strict";function i(e,t){return t.rowKeys.indexOf(e)}n.d(t,"a",(function(){return i}))},8673:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return c}));var i=n(3441),a=n(2733),o=n(3012);function r(e,t,n,i){const r=new Date(a.b.getLastDeliveryTimeStamp(n,i)).getTime()-new Date(t).getTime();if(Object(o.l)(i.tableQuery)){const t=new Date(a.b.getLastDeliveryOrRenewTimeStamp(n,i)).getTime()-new Date(e).getTime();return 0!=t?t:r}return r}function d(e,t,n,a,r){return Object(i.a)(r,n.id,e)?Object(o.f)(n,0):c(e,t,n,a)}function c(e,t,n,o){const d=n.rowKeys.length;if(0==d)return 0;const c=Object(a.K)(n).sortDirection==a.c.DESCENDING_SORT_DIR;let l;for(l=o;l<d;l++){const a=n.rowKeys[l];if(Object(i.a)(a,n.id,e))continue;const o=r(e,t,a,n);if(c?o<=0:o>0)return l}return d==n.totalRowsInView?d:-1}},937:function(e,t,n){"use strict";var i=n(20);var a={ChannelData:"ChannelData",SubscriptionAdded:"SubscriptionAdded",SubscriptionRemoved:"SubscriptionRemoved",SubscriptionUpdated:"SubscriptionUpdated",NotificationData:"NotificationData",TraceWarn:"TraceWarn",TraceError:"TraceError"};n.d(t,"j",(function(){return r})),n.d(t,"k",(function(){return d})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return s})),n.d(t,"e",(function(){return b})),n.d(t,"i",(function(){return f})),n.d(t,"f",(function(){return m})),n.d(t,"d",(function(){return p})),n.d(t,"a",(function(){return a}));const o=new i.c(()=>Promise.all([n.e(0),n.e(707)]).then(n.bind(null,19753))),r=new i.a(o,e=>e.subscribe),d=new i.a(o,e=>e.unsubscribe),c=new i.b(o,e=>e.getChannelId),l=new i.a(o,e=>e.getChannelReady),u=new i.a(o,e=>e.retryDisconnectionWithMinimumReconnectInterval),s=new i.a(o,e=>e.setup),b=new i.a(o,e=>e.handleNotification),f=new i.a(o,e=>e.stopConnection),m=new i.a(o,e=>e.initializeNotificationManager),p=new i.b(o,e=>e.getNotificationEmitter)}}]);
//# sourceMappingURL=owa.816.js.map
self.scriptsLoaded['owa.816.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.816.js'] = (new Date()).getTime();