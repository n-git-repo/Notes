self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.73.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[73],{2806:function(n,t,e){"use strict";var r=e(4463),o=e(4816),i=e(2),u=Object(i.mutatorAction)("appendOnSendAction",(n,t)=>{const e=n.appendOnSend;if(!e)return;let r=!1;for(let o=0;o<e.length;o++)if(e[o].id===t.id){n.appendOnSend[o]=t,r=!0;break}r||n.appendOnSend.push(t)}),c=e(2785),a=e(3974),d=e(4747),s=e(4464),f=e(4748),l=e(3343),m=e(3658),p=e(4858),I=e(3975),h=e(3111),g=e(4275),E=e(2900),v=e(4180),A=e(4367),O=e(4368),C=e(4369),x=e(4465),S=e(4466);e.d(t,"Y",(function(){return r.a})),e.d(t,"Z",(function(){return o.a})),e.d(t,"k",(function(){return u})),e.d(t,"M",(function(){return c.v})),e.d(t,"V",(function(){return c.E})),e.d(t,"v",(function(){return c.d})),e.d(t,"Q",(function(){return c.z})),e.d(t,"T",(function(){return c.C})),e.d(t,"U",(function(){return c.D})),e.d(t,"S",(function(){return c.B})),e.d(t,"R",(function(){return c.A})),e.d(t,"x",(function(){return c.f})),e.d(t,"A",(function(){return c.i})),e.d(t,"B",(function(){return c.j})),e.d(t,"I",(function(){return c.r})),e.d(t,"W",(function(){return c.F})),e.d(t,"N",(function(){return c.w})),e.d(t,"E",(function(){return c.n})),e.d(t,"P",(function(){return c.y})),e.d(t,"j",(function(){return c.a})),e.d(t,"H",(function(){return c.q})),e.d(t,"L",(function(){return c.u})),e.d(t,"C",(function(){return c.l})),e.d(t,"t",(function(){return c.b})),e.d(t,"J",(function(){return c.s})),e.d(t,"u",(function(){return c.c})),e.d(t,"K",(function(){return c.t})),e.d(t,"F",(function(){return c.o})),e.d(t,"w",(function(){return c.e})),e.d(t,"O",(function(){return c.x})),e.d(t,"z",(function(){return c.h})),e.d(t,"y",(function(){return c.g})),e.d(t,"G",(function(){return c.p})),e.d(t,"D",(function(){return c.m})),e.d(t,"n",(function(){return a.a})),e.d(t,"q",(function(){return a.b})),e.d(t,"i",(function(){return d.a})),e.d(t,"h",(function(){return s.a})),e.d(t,"l",(function(){return f.a})),e.d(t,"X",(function(){return l.a})),e.d(t,"s",(function(){return m.d})),e.d(t,"f",(function(){return p.a})),e.d(t,"o",(function(){return I.e})),e.d(t,"c",(function(){return h.b})),e.d(t,"b",(function(){return g.a})),e.d(t,"m",(function(){return E.c})),e.d(t,"a",(function(){return v.a})),e.d(t,"d",(function(){return A.a})),e.d(t,"e",(function(){return O.a})),e.d(t,"g",(function(){return C.a})),e.d(t,"r",(function(){return x.a})),e.d(t,"p",(function(){return S.a}))},2899:function(n,t,e){"use strict";var r;!function(n){n[n.Unknown=0]="Unknown",n[n.AppointmentOrganizer=1]="AppointmentOrganizer",n[n.AppointmentAttendee=2]="AppointmentAttendee",n[n.MessageCompose=3]="MessageCompose",n[n.MessageRead=4]="MessageRead",n[n.MeetingRequest=5]="MeetingRequest",n[n.DetectedEntity=7]="DetectedEntity",n[n.Events=8]="Events",n[n.LaunchEvent=9]="LaunchEvent",n[n.TrapOnSendEvent=6]="TrapOnSendEvent"}(r||(r={}));var o=r;e.d(t,"a",(function(){return o}))},2900:function(n,t,e){"use strict";const r={};function o(n,t){c(n)&&i(n),r[n]=t}function i(n){delete r[n]}function u(n){return r[n]}function c(n){return!!r[n]}e.d(t,"d",(function(){return c})),e.d(t,"c",(function(){return u})),e.d(t,"b",(function(){return i})),e.d(t,"a",(function(){return o}))},3111:function(n,t,e){"use strict";var r;e.d(t,"a",(function(){return r})),function(n){n[n.OoeInvalidDataFormat=2006]="OoeInvalidDataFormat",n[n.OperationNotSupported=5e3]="OperationNotSupported",n[n.AttachmentSizeExceeded=9e3]="AttachmentSizeExceeded",n[n.NumberOfAttachmentsExceeded=9001]="NumberOfAttachmentsExceeded",n[n.InvalidAttachmentId=9003]="InvalidAttachmentId",n[n.InvalidAttachmentPath=9004]="InvalidAttachmentPath",n[n.CannotAddAttachmentBeforeUpgrade=9005]="CannotAddAttachmentBeforeUpgrade",n[n.AttachmentDeletedBeforeUploadCompletes=9006]="AttachmentDeletedBeforeUploadCompletes",n[n.AttachmentUploadGeneralFailure=9007]="AttachmentUploadGeneralFailure",n[n.AttachmentToDeleteDoesNotExist=9008]="AttachmentToDeleteDoesNotExist",n[n.AttachmentDeleteGeneralFailure=9009]="AttachmentDeleteGeneralFailure",n[n.InvalidEndTime=9010]="InvalidEndTime",n[n.HtmlSanitizationFailure=9011]="HtmlSanitizationFailure",n[n.NumberOfRecipientsExceeded=9012]="NumberOfRecipientsExceeded",n[n.CursorPositionChanged=9014]="CursorPositionChanged",n[n.ComposeFormNotReadyForAttachments=9015]="ComposeFormNotReadyForAttachments",n[n.InvalidSelection=9016]="InvalidSelection",n[n.GenericTokenError=9018]="GenericTokenError",n[n.GenericSettingsError=9019]="GenericSettingsError",n[n.GenericResponseError=9020]="GenericResponseError",n[n.SaveError=9021]="SaveError",n[n.DuplicateNotificationKey=9023]="DuplicateNotificationKey",n[n.NotificationKeyNotFound=9024]="NotificationKeyNotFound",n[n.NumberOfNotificationsExceeded=9025]="NumberOfNotificationsExceeded",n[n.PersistedNotificationArrayReadError=9026]="PersistedNotificationArrayReadError",n[n.PersistedNotificationArraySaveError=9027]="PersistedNotificationArraySaveError",n[n.CannotPersistPropertyInUnsavedDraftError=9028]="CannotPersistPropertyInUnsavedDraftError",n[n.CallSaveAsyncBeforeToken=9029]="CallSaveAsyncBeforeToken",n[n.InvalidParameterValueError=9031]="InvalidParameterValueError",n[n.ApiCallNotSupportedByExtensionPoint=9032]="ApiCallNotSupportedByExtensionPoint",n[n.SetRecurrenceOnInstance=9033]="SetRecurrenceOnInstance",n[n.InvalidRecurrence=9034]="InvalidRecurrence",n[n.InsufficientItemPermissions=9038]="InsufficientItemPermissions",n[n.InternalServerError=9042]="InternalServerError",n[n.AttachmentTypeNotSupported=9043]="AttachmentTypeNotSupported",n[n.InvalidCategoryError=9044]="InvalidCategoryError",n[n.DuplicateCategoryError=9045]="DuplicateCategoryError",n[n.ItemNotSavedError=9046]="ItemNotSavedError",n[n.MissingExtendedPermissionsForAPIError=9047]="MissingExtendedPermissionsForAPIError",n[n.ItemNotFound=9049]="ItemNotFound",n[n.KeyNotFound=9050]="KeyNotFound",n[n.SessionDataObjectMaxLengthExceeded=9051]="SessionDataObjectMaxLengthExceeded"}(r||(r={})),t.b=r},3658:function(n,t,e){"use strict";e.d(t,"e",(function(){return c})),e.d(t,"d",(function(){return a})),e.d(t,"b",(function(){return d})),e.d(t,"c",(function(){return s})),e.d(t,"a",(function(){return f})),e.d(t,"f",(function(){return l}));var r=e(2952),o=e(4582),i=e(4749),u=e(3816);function c(n){return Object(r.a)().runningUILessExtendedAddinCommands.has(n)}function a(n){var t;const e=null===(t=Object(r.a)().runningUILessExtendedAddinCommands)||void 0===t?void 0:t.get(n);if(e)for(let n of e.values()){if(!(n.addinCommand instanceof o.a))return!0}return!1}function d(n){const t=m();if(!t)return null;for(const e of t.values())for(const t of e.keys())if(t===n)return e.get(t).addinCommand;return null}function s(n,t){const e=Object(i.a)(t),r=Object(u.a)(e,n);return m().has(r)&&m().get(r).has(t)?m().get(r).get(t).addinCommandTelemetry:null}function f(n){const t=m();if(!t)return null;for(const e of t.keys()){const r=t.get(e);for(const t of r.keys())if(t===n)return e}return null}function l(n){return null!==d(n)}function m(){return Object(r.a)().runningUILessExtendedAddinCommands}},3816:function(n,t,e){"use strict";e.d(t,"a",(function(){return o}));var r=e(3154);function o(n,t){let e="";if("string"==typeof n)e=n;else{const t=Object(r.a)(n);e=t?t.tabId:n===window?"Main":null}const o={hostItemIndex:t,tabId:e};return JSON.stringify(o)}},3974:function(n,t,e){"use strict";e.d(t,"a",(function(){return r})),e.d(t,"b",(function(){return o})),e.d(t,"c",(function(){return i}));let r=n=>`extCompose_${n}`,o=n=>`extRead_${n}`,i=n=>0===n.indexOf("extCompose")?"Compose":0===n.indexOf("extRead")?"Read":""},3975:function(n,t,e){"use strict";e.d(t,"a",(function(){return u})),e.d(t,"h",(function(){return c})),e.d(t,"e",(function(){return a})),e.d(t,"f",(function(){return d})),e.d(t,"g",(function(){return s})),e.d(t,"d",(function(){return f})),e.d(t,"c",(function(){return l})),e.d(t,"b",(function(){return m}));const r=5;let o={},i={};function u(n,t,e,r){h([n,"data",t])||function(n,t){o[n]=o[n]||{data:{},messageIds:[]},o[n].data[t]={}}(n,t),d(e)&&p(e),function(n,t,e,r){o[n].data[t][e]=r,o[n].messageIds.push(e),i[e]={hostItemIndex:n,extensionId:t}}(n,t,e,r)}function c(n){a(n)&&p(n)}function a(n){if(!d(n))return null;const{hostItemIndex:t,extensionId:e}=i[n];return h([t,"data",e,n])}function d(n){return!!i[n]}function s(n,t,e){const o=I(n,t)||[],i=Object.keys(o).length||0;return e?i>=1:i>=r}function f(n,t){const e=I(n,t);return e?Object.keys(e).reduce((n,t)=>{const r=e[t];return r.Persistent&&(n[t]=r),n},{}):{}}function l(n){return o[n]?o[n].messageIds:[]}function m(n){if(!o[n])return;o[n].messageIds.forEach(n=>delete i[n]),delete o[n]}function p(n){const{hostItemIndex:t,extensionId:e}=i[n];delete I(t,e)[n],delete i[n];const r=o[t].messageIds,u=r.indexOf(n);~u&&r.splice(u,1)}function I(n,t){return h([n,"data",t])}function h(n){let t=o;for(let e=0;e<n.length;e++){const r=n[e];if(!t[r])return null;t=t[r]}return t}},4180:function(n,t,e){"use strict";e.d(t,"a",(function(){return r})),e.d(t,"b",(function(){return c}));var r,o=e(6),i=e(1427),u=e(2852);!function(n){n[n.File=0]="File",n[n.Item=1]="Item",n[n.Cloud=2]="Cloud"}(r||(r={}));const c=n=>n.map(n=>({id:a(n),name:n.Name,contentType:n.ContentType,size:n.Size,attachmentType:d(n),isInline:n.IsInline||!1}));function a(n){var t;return Object(u.a)(n)?n.AttachLongPathName:null===(t=n.AttachmentId)||void 0===t?void 0:t.Id}function d(n){switch(n.__type||n.OwsTypeName){case i.a:return r.File;case i.b:return r.Item;case i.e:return r.Cloud;case i.c:const t=n;return Object(o.j)(t.AttachmentIdToAttach)?r.Item:r.File;default:throw new Error(`Invalid type of attachment ${n.__type}`)}}},4275:function(n,t,e){"use strict";t.a=class{constructor(n){this.errorCode=n}}},4367:function(n,t,e){"use strict";var r;!function(n){n[n.Added=0]="Added",n[n.Deleted=1]="Deleted"}(r||(r={})),t.a=r},4368:function(n,t,e){"use strict";var r;e.d(t,"a",(function(){return r})),function(n){n.Room="room",n.Custom="custom"}(r||(r={}))},4369:function(n,t,e){"use strict";var r;!function(n){n[n.To=0]="To",n[n.Cc=1]="Cc",n[n.Bcc=2]="Bcc",n[n.RequiredAttendees=0]="RequiredAttendees",n[n.OptionalAttendees=1]="OptionalAttendees",n[n.Resources=2]="Resources"}(r||(r={})),t.a=r},4463:function(n,t,e){"use strict";function r(n){if(null!=n.RightsManagementLicenseData)return!1;if(n.IsDraft)return!1;{const t=n.ItemClass?n.ItemClass.toLowerCase():"";if(0==t.indexOf("ipm.note.smime")&&-1==t.indexOf("ipm.note.smime.multipartsigned"))return!1;if(0==t.indexOf("report"))return!1}return!0}e.d(t,"a",(function(){return r}))},4464:function(n,t,e){"use strict";var r;e.d(t,"a",(function(){return r})),function(n){n[n.Unknown=0]="Unknown",n[n.Single=1]="Single",n[n.Empty=2]="Empty",n[n.Multi=3]="Multi",n[n.NotSupported=4]="NotSupported"}(r||(r={}))},4465:function(n,t,e){"use strict";e.d(t,"a",(function(){return i}));var r=e(3047),o=e(2899);function i(n){switch(n){case o.a.MessageRead:return r.a.mailReadSurfaceNewAddinId;case o.a.MessageCompose:return r.a.mailComposeSurfaceNewAddinId;case o.a.AppointmentOrganizer:case o.a.AppointmentAttendee:return r.a.calendarSurfaceNewAddinId;default:return""}}},4466:function(n,t,e){"use strict";e.d(t,"a",(function(){return o}));var r=e(3047);function o(n){const t=r.a.Context;for(let e of t.Extensions)if(e.Id.toLowerCase()===n.toLowerCase())return e;return null}},4582:function(n,t,e){"use strict";var r=e(2899);t.a=class{constructor(n,t,e,r){this.event=n,this.control=t,this.extension=e,this.mode=r}getLaunchEventType(){return this.event}getControl(){return this.control}get_EntryPoint(){switch(this.mode){case r.a.LaunchEvent:return this.extension.ExtensionPointCollection.LaunchEvent.SourceLocation;default:return null}}get_Label(){return this.control.Label}get_ExtensionDisplayName(){return this.extension.DisplayName}get_Id(){return this.extension.Id}get_Size16Icon(){return this.extension.IconUrl}}},4747:function(n,t,e){"use strict";t.a={sendFeedback:()=>{}}},4748:function(n,t,e){"use strict";function r(n,t,e=window){const o={hostItemIndex:n,targetWindow:e};if(t.getClickHandler)t.onClick=t.getClickHandler(o);else if(t.sectionProps){t.sectionProps.items.forEach(t=>{r(n,t,e)})}else if(t.subMenuProps){t.subMenuProps.items.forEach(t=>{r(n,t,e)})}}e.d(t,"a",(function(){return r}))},4749:function(n,t,e){"use strict";e.d(t,"a",(function(){return i})),e.d(t,"b",(function(){return u}));var r=e(2952),o=e(3658);function i(n){const t=Object(o.a)(n);let e=window;const r=c();return t&&r?(r.forEach((r,o)=>{o===t&&r.forEach((t,r)=>{n==r&&(e=t.targetWindow)})}),e):e}function u(n){let t=window;const e=c();return e?(e.forEach((e,r)=>{JSON.parse(r).hostItemIndex===n&&e.forEach((n,e)=>{t=n.targetWindow})}),t):t}function c(){return Object(r.a)().runningUILessExtendedAddinCommands}},4816:function(n,t,e){"use strict";var r=e(4992),o=e(2952);var i=e(5135),u=e(30);function c(){const n=null!=Object(o.a)().Context,t=Object(r.a)(),e=Object(u.a)().SegmentationSettings.OnSendAddinsEnabled;return n&&t?e&&Object(i.a)(1).length>0:e}e.d(t,"a",(function(){return c}))},4858:function(n,t,e){"use strict";var r;!function(n){n[n.Selected=0]="Selected",n[n.Deselected=1]="Deselected"}(r||(r={})),t.a=r},4992:function(n,t,e){"use strict";e.d(t,"a",(function(){return o}));var r=e(2952);function o(){const n=Object(r.a)().EnabledAddinCommands;return!!n&&n.isInitialized}},5135:function(n,t,e){"use strict";e.d(t,"a",(function(){return a})),e.d(t,"b",(function(){return d}));var r=e(2899),o=e(2952);const i="User",u="Organization",c="Default";function a(n){const t=Object(o.a)().EnabledAddinCommands;return t?t.getExtensionPoint(r.a.TrapOnSendEvent).map(t=>t.AddinCommands.get(n.toString())):[]}function d(n){const t=a(n),e=t.filter(n=>n.extension.OriginString==i),r=t.filter(n=>n.extension.OriginString==c),o=t.filter(n=>n.extension.OriginString==u);return e.sort((n,t)=>s(n,t)),r.sort((n,t)=>s(n,t)),o.sort((n,t)=>s(n,t)),[...e,...r,...o]}function s(n,t){const e=n.get_Id(),r=t.get_Id();return e<r?-1:e>r?1:0}}}]);
//# sourceMappingURL=owa.73.js.map
self.scriptsLoaded['owa.73.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.73.js'] = (new Date()).getTime();