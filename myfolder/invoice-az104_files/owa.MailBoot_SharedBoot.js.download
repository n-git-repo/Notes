self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~SharedBoot.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[422,2148],{102:function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,a){function i(e){try{s(o.next(e))}catch(e){a(e)}}function c(e){try{s(o.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}s((o=o.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,o,r,a,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(r=(r=i.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.throwIfVersionIsNotSupported=t.IsVersonSupportedByHost=t.isPIEHostPresent=t.HostBridge=void 0;var a=function(){function e(){this.nextHandlerId=1,this.registeredHandlers=new Map}return e.prototype.registerHandler=function(e){var t=this,n=this.nextHandlerId;return this.nextHandlerId=this.nextHandlerId+1,this.registeredHandlers.set(n,e),function(){t.unregisterHandler(n)}},e.prototype.RaiseEvent=function(e){this.registeredHandlers.forEach((function(t){t(e)}))},e.prototype.HasHandlers=function(){return 0!==this.registeredHandlers.size},e.prototype.unregisterHandler=function(e){this.registeredHandlers.has(e)&&this.registeredHandlers.delete(e)},e}(),i=function(){function e(){this.nextMessageId=1,this.pendingMessages=new Map,this.eventHandlers=new Map,this.abandonedCallHandlers=new a,this.namespaceVersionChangeHandlers=new a,this.hostNotificationHandlers=new a,this.firstSyncIdCall=!0,this.nextSyncId=1,this.maxMessageId=2147483647}return e.prototype.isNamespaceVersionChange=function(e){return e.isIdRequest&&"version-change"===e.messageName&&-3===e.messageId},e.prototype.onMessageFromHost=function(e){if("app/pie"===e.contentType)if(this.raiseMessageInfoIfNeeded(e,!1),e.isEvent){var t=e.messageName;this.eventHandlers.has(t)&&this.eventHandlers.get(t).RaiseEvent(e.args)}else{var n=e.messageId;if(this.pendingMessages.has(n)){var o=this.pendingMessages.get(n);this.pendingMessages.delete(n),e.abandoned?this.abandonedCallHandlers.RaiseEvent(e.messageName):e.wasSuccessful?o.resolve(o.postProcessing?o.postProcessing(e.message):e.message):o.reject(new Error(e.messageName+":"+e.errorMessage))}else this.isNamespaceVersionChange(e)&&this.namespaceVersionChangeHandlers.RaiseEvent(e.message)}},e.prototype.addMessageToPendingMessages=function(e,t,n){var o=this.nextMessageId;this.nextMessageId=this.nextMessageId===this.maxMessageId?1:this.nextMessageId+1;var r={resolve:e,reject:t,postProcessing:n};return this.pendingMessages.set(o,r),o},e.prototype.invokeIdRequest=function(e,t,n,o,r){var a={contentType:"app/pie",messageName:t,isIdRequest:!0,messageId:this.addMessageToPendingMessages(o,r),message:n};this.raiseMessageInfoIfNeeded(a,!0,!0),e.sendMessageToHost(a)},e.throwPieSyncNotSupported=function(){throw new Error("Synchronous bridge not supported")},e.prototype.getNextSyncId=function(e){this.firstSyncIdCall&&(this.nextSyncId=e.getStartingSyncId(),this.firstSyncIdCall=!1);var t=this.nextSyncId;return this.nextSyncId=this.nextSyncId===Number.MAX_SAFE_INTEGER?1:this.nextSyncId+1,t},e.prototype.invokeOnHostSync=function(t,n,o,r,a,i){if(t.sendMessageToHostSync){var c=this.addMessageToPendingMessages(r,a,i),s={contentType:"app/pie",messageName:n,syncId:this.getNextSyncId(t),messageId:c,message:o};this.raiseMessageInfoIfNeeded(s,!0,!1),t.sendMessageToHostSync(s)}else e.throwPieSyncNotSupported()},e.prototype.invokeOnHost=function(e,t,n,o,r,a){var i={contentType:"app/pie",messageName:t,messageId:this.addMessageToPendingMessages(o,r,a),message:n};this.raiseMessageInfoIfNeeded(i,!0,!0),e.sendMessageToHost(i)},e.prototype.registerForEvent=function(e,t){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new a),this.eventHandlers.get(e).registerHandler(t)},e.prototype.registerForAbandonedCalls=function(e){return this.abandonedCallHandlers.registerHandler(e)},e.prototype.registerForNamespaceVersionChange=function(e){return this.namespaceVersionChangeHandlers.registerHandler(e)},e.prototype.registerForHostMessageNotification=function(e){return this.hostNotificationHandlers.registerHandler(e)},e.prototype.raiseMessageInfoIfNeeded=function(e,t,n){if(this.hostNotificationHandlers.HasHandlers()){var o={isToHost:t,isAsync:n,messageName:e.messageName,isIdRequest:e.isIdRequest,syncId:e.syncId,messageId:e.messageId,isEvent:e.isEvent,wasSuccessful:e.wasSuccessful,abandoned:e.abandoned};this.hostNotificationHandlers.RaiseEvent(o)}},e}(),c=function(){function e(e){this.bridge=e,this.processor=new i,this.instanceId=null,this.namespaceVersions=new Map;var t=function(e){this.namespaceVersions.has(e)&&this.namespaceVersions.delete(e)}.bind(this);this.processor.registerForNamespaceVersionChange(t);var n=function(e){this.processor.onMessageFromHost(e)}.bind(this);this.bridge.addHostMessageHandler(n)}return e.prototype.isUsingBridge=function(e){return this.bridge===e},e.prototype.invokeHost=function(e,t,n){var o=this;return new Promise((function(r,a){o.processor.invokeOnHost(o.bridge,e,t,r,a,n)}))},e.prototype.invokeHostSync=function(e,t,n){var o;return this.processor.invokeOnHostSync(this.bridge,e,t,(function(e){o=e}),(function(e){throw e}),n),o},e.prototype.invokeIdRequestOnHost=function(e,t){var n=this;return new Promise((function(o,r){n.processor.invokeIdRequest(n.bridge,e,t,o,r)}))},e.prototype.registerForEvent=function(e,t){return this.processor.registerForEvent(e,t)},e.prototype.registerForAbandonedCalls=function(e){return this.processor.registerForAbandonedCalls(e)},e.prototype.registerForHostMessageNotification=function(e){return this.processor.registerForHostMessageNotification(e)},e.prototype.getInstanceId=function(){var e=this;return new Promise((function(t,n){e.instanceId?t(e.instanceId):e.invokeIdRequestOnHost("instance","id").then((function(n){e.instanceId=n,t(e.instanceId)})).catch((function(e){n(e)}))}))},e.prototype.getNamespaceVersion=function(e){var t=this;return new Promise((function(n,o){t.namespaceVersions.has(e)?n(t.namespaceVersions.get(e)):t.invokeIdRequestOnHost("version",e).then((function(r){var a=parseFloat(r);isNaN(a)?o("Non numeric version returned"):(t.namespaceVersions.set(e,a),n(a))})).catch((function(e){o(e)}))}))},e}(),s=function(){function e(){}return e.setGlobalPreprocessCheck=function(t){e._globalPreprocessCheck=t},e.isInitializationNeeded=function(t){return!e._implInstance||!e._implInstance.isUsingBridge(t)},e.initialize=function(t){e.isInitializationNeeded(t)&&(e._implInstance=new c(t))},e.resetBridgeForUnitTests=function(){e._implInstance=null},e.reloadBridgeForUnitTests=function(){if(e._implInstance){var t=e._implInstance.bridge;e._implInstance=new c(t)}},e.failBridgeNotInitialized=function(){return new Promise((function(e,t){t(new Error("HostBridge not initialized"))}))},e.invokeHost=function(t,n,a){return o(this,void 0,void 0,(function(){return r(this,(function(o){switch(o.label){case 0:return e._implInstance?e._globalPreprocessCheck?[4,e._globalPreprocessCheck(t)]:[3,2]:[3,3];case 1:o.sent(),o.label=2;case 2:return[2,e._implInstance.invokeHost(t,n,a)];case 3:return[2,e.failBridgeNotInitialized()]}}))}))},e.invokeHostSync=function(t,n,o){if(e._implInstance)return e._implInstance.invokeHostSync(t,n,o);throw new Error("HostBridge not initialized")},e.getInstanceId=function(){return o(this,void 0,void 0,(function(){return r(this,(function(t){return e._implInstance?[2,e._implInstance.getInstanceId()]:[2,e.failBridgeNotInitialized()]}))}))},e.getNamespaceVersion=function(t){return o(this,void 0,void 0,(function(){return r(this,(function(n){return e._implInstance?[2,e._implInstance.getNamespaceVersion(t)]:[2,e.failBridgeNotInitialized()]}))}))},e.registerForEvent=function(t,n){return e._implInstance?e._implInstance.registerForEvent(t,n):null},e.registerForAbandonedCalls=function(t){return e._implInstance?e._implInstance.registerForAbandonedCalls(t):null},e.registerForHostMessageNotification=function(t){return e._implInstance?e._implInstance.registerForHostMessageNotification(t):null},e.throwPieSyncNotSupported=function(){i.throwPieSyncNotSupported()},e._implInstance=null,e._globalPreprocessCheck=null,e}();function u(){return o(this,void 0,void 0,(function(){return r(this,(function(e){return[2,new Promise((function(e){s.getInstanceId().then((function(t){e(!!t)})).catch((function(){e(!1)}))}))]}))}))}function d(e,t,n){return o(this,void 0,void 0,(function(){var o;return r(this,(function(r){switch(r.label){case 0:return[4,u()];case 1:return r.sent()?[4,s.getNamespaceVersion(e)]:[3,3];case 2:if((o=r.sent())>=t&&(!n||o<n))return[2,!0];r.label=3;case 3:return[2,!1]}}))}))}t.HostBridge=s,t.isPIEHostPresent=u,t.IsVersonSupportedByHost=d,t.throwIfVersionIsNotSupported=function(e,t,n){return o(this,void 0,void 0,(function(){return r(this,(function(o){switch(o.label){case 0:return[4,d(e,t,n)];case 1:if(!o.sent())throw new Error("VersionNotSupported for "+e+": "+t+", "+n);return[2]}}))}))}},1045:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n(5077),a=n(9194),i=n(3352),c=n(9196),s=n(21),u=n(13562),d=n.n(u),l=Object(s.a)((function(e,t){const n=o.useRef(),r=o.useRef(o.createRef()),[a,i]=o.useState(!1);o.useImperativeHandle(t,()=>({focus(){var e,t;(null===(t=null===(e=r.current)||void 0===e?void 0:e.current)||void 0===t?void 0:t.focus)?r.current.current.focus():n.current&&n.current.focus()}}),[]);return a?o.createElement(c.a,{ref:r.current}):o.createElement("button",{key:"default",onFocus:()=>{a||i(!0)},className:d.a.button,ref:e=>{n.current=e}},"placeholder text")}),{forwardRef:!0}),f=n(13322),p=n(625),b=n(20);const v=new b.c(()=>n.e(977).then(n.bind(null,20130))),g=new b.a(v,e=>e.setupAppModuleKeys);var m=n(3013),h=n(8080);const O=new b.c(()=>Promise.all([n.e(1),n.e(2),n.e(3),n.e(4),n.e(11),n.e(691)]).then(n.bind(null,19907))),y=Object(b.d)(O,e=>e.RebootModal);var S=n(25),j=n(154);const w=new b.c(()=>Promise.all([n.e(1),n.e(2),n.e(3),n.e(11),n.e(62),n.e(67),n.e(208),n.e(657)]).then(n.bind(null,19865))),I=Object(b.d)(w,e=>e.ProjectionPopoutHost);var x=n(4147);const k=new b.c(()=>Promise.all([n.e(1),n.e(2),n.e(3),n.e(4),n.e(11),n.e(623)]).then(n.bind(null,19878))),A=Object(b.d)(k,e=>e.RestoreItemsDialog);var M=n(10),H=n(13565),N=n(487);const T={useLazyLoadQueryWithDocumentNode:n(3889).b,useSubscriptionWithDocumentNode:N.useSubscription};var C=n(13564),E=n(4812),_=n(4720),P=n(6916),F=n(178),R=n(6010),L=n(6917),D=n(7469);const V={trigger:e=>(function(e){if(e.entity.type===C.c.m365_app){const t=e.entity.entityId,n=Object(F.a)();if(!n)return;const o=Object(P.a)(t,n),r=Object(_.a)(t)?Object(L.a)(t):o.Url;e.command.stateTransition!==C.b.new&&Object(_.a)(e.entity.entityId||"")?(Object(D.b)(t),Object(E.f)(t)):window.open(r,"_blank")}else{const t=G(Object(D.a)()),n=G(e.entity.entityId||"");e.command.stateTransition!==C.b.new&&Object(E.b)(t,n)?Object(E.e)(n,t):window.open(Object(R.a)(n),"_blank")}}(e),Promise.resolve())};function G(e){let t;switch(e){case"Mail":t=p.a.Mail;break;case"Calendar":t=p.a.Calendar;break;case"People":t=p.a.People;break;case"FilesHub":t=p.a.FilesHub;break;case"Tasks":case"ToDo":t=p.a.Tasks;break;case"Eventify":t=p.a.Eventify;break;default:t=p.a.AppHost}return t}const z=e=>{const{children:t}=e,n={commanding:V,graphql:T};return o.createElement(H.a.Provider,{value:n},t)};z.displayName="NovaContextProvider";var J=n(3066);var B=Object(s.a)((function(e){var t,n;Object(m.d)(void 0,g.importAndExecute,void 0);const r=Object(x.a)()||p.a.Mail,c=Object(a.a)(r).appModuleProps,s=o.useRef(null),u=o.useRef(null),d=null===(t=c.isSkiplinkEnabled)||void 0===t?void 0:t.call(c),b=o.useCallback(()=>d?o.createElement(l,{ref:s}):void 0,[d]),v=null===(n=c.getHeaderInfo)||void 0===n?void 0:n.call(c,u),O=null==v?void 0:v.props;O&&e.wrapSuiteHeader&&(O.wrapSuiteHeader=e.wrapSuiteHeader);const w=o.useCallback(()=>{var e;const t=null===(e=c.overrideHeader)||void 0===e?void 0:e.call(c);return Object(j.a)("hideAppSuiteHeader")?void 0:t?o.createElement(t,null):O?o.createElement(f.a,Object.assign({},O)):void 0},[r,null==O?void 0:O.searchAlignmentWidth,null==O?void 0:O.enableResponsiveLayout,null==v?void 0:v.changes]);Object(h.a)(c.overrideFavIcon||"resources/images/favicons/mail-seen.ico");const k=()=>o.createElement(i.a,{renderHeader:w,renderSkipLinkPlaceholder:b},e.AppBarComponent&&!Object(j.a)("hideOfficeRail")&&Object(J.a)(r)&&o.createElement(e.AppBarComponent,{selectedModule:r,activeModuleAction:c.activeModuleAction}),c.renderModule(u,s),Object(S.k)("fwk-reboot-notif")&&o.createElement(y,null),o.createElement(I,{module:r}),Object(j.a)("native")&&Object(S.k)("nh-freezeDry")&&o.createElement(A,null));return Object(M.i)("novaappbar")?o.createElement(z,null,k()):k()})),U=n(19),W=n(22),q=n(408);async function Y(e){var t,n;Object(j.a)("incorrectNativeEntryPoint")&&"Native"!=U.b&&W.d("IncorrectNativeEntryPoint");const i=e.appModuleProps.module;Object(x.b)(i);const c=Object(q.a)(i,Object(j.a)("opxServiceWorker"));c&&(e.swConfig=c),Object(a.b)(e);const s=null===(t=e.strategies)||void 0===t?void 0:t.suiteWrapper,u=s?await s.import():void 0;let d;u&&(e.windowIcons=u.windowIcons,d=e=>o.createElement(u.suiteHeader,{suiteHeader:e}));const l=null===(n=e.strategies)||void 0===n?void 0:n.appBarStrategy,f=l?await l.import():void 0;return e.renderMainComponent=()=>o.createElement(B,{wrapSuiteHeader:d,AppBarComponent:f}),Object(r.a)(e)}n.d(t,"appBootstrap",(function(){return Y}))},1094:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var o=n(489),r=n(885),a=n(310);const i=5e4;function c(e){return Object(o.a)(async t=>{const n=Object(a.a)(await e.getMail(t));await Object(r.a)(n,e=>!e.sentItemsViewId.isNil(),i)})}},1200:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(13),r=n(933),a=n(137);t.default=function(e,t,n,i){a.getGlobalContext().legacyInDispatch++,o.action(t||"(anonymous action)",r.dispatchWithMiddleware.bind(null,e,t,n,i))(),a.getGlobalContext().legacyInDispatch--}},1201:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(755),r=n(137);function a(e,t){var n={};return Object.keys(e).forEach((function(o){void 0===n[o]&&Object.defineProperty(n,o,{enumerable:!0,get:function(){return e[o].apply(null,t)}})})),Object.freeze(n),n}t.default=function(e){return function(t){if(r.getGlobalContext().legacyTestMode)return t;var n=this,i=t.length-1,c=o.getOriginalTarget(t);c&&(i=c.length-1);var s=function(){var o=a(e,arguments),r=Array.prototype.slice.call(arguments);if(void 0===r[i]){for(var c=r.length;c<i;c++)r[c]=void 0;r[i]=o}return t.apply(n,r)};return o.setActionType(s,o.getActionType(t)),s}}},1202:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(13),r=n(931),a=0,i=null;var c=[];function s(e){var t,n=e.object;switch(e.type){case"update":t=void 0!==e.index?{verify:function(){return n[e.index]===e.newValue},objectName:e.name,propertyName:e.index,undo:function(){n[e.index]=e.oldValue}}:void 0!==n.get?{verify:function(){return n.get(e.key)===e.newValue},objectName:e.name,propertyName:e.key,undo:function(){n.set(e.key,e.oldValue)}}:{verify:function(){return n[e.key]===e.newValue},objectName:e.name,propertyName:e.key,undo:function(){n[e.key]=e.oldValue}};break;case"splice":t={verify:function(){for(var t=0;t<e.addedCount;t++)if(n[e.index+t]!==e.added[t])return!1;return!0},objectName:e.name,propertyName:e.index,undo:function(){n.splice(e.index,e.addedCount);for(var t=0;t<e.removedCount;t++)n.splice(e.index+t,0,e.removed[t])}};break;case"add":t=void 0!==n.get?{verify:function(){return n.get(e.key)===e.newValue},objectName:e.name,propertyName:e.key,undo:function(){n.delete(e.key)}}:{verify:function(){return n[e.key]===e.newValue},objectName:e.name,propertyName:e.key,undo:function(){delete n[e.key]}};break;case"delete":t={verify:function(){return!n.has(e.key)},objectName:e.name,propertyName:e.key,undo:function(){n.set(e.key,e.oldValue)}};break;default:return}c.forEach((function(e){return e.steps.push(t)}))}function u(e,t,n){0===a&&(i=o.spy(s)),a++,c.push({steps:[]});try{var u=t(),d=c[c.length-1],l=!1;d.steps.reverse();var f=r.default("undo-"+e)((function(){if(l)throw"This instance of undo-"+e+" has already been executed";n&&d.steps.forEach((function(e){if(!e.verify())throw'Property "'+e.propertyName+' on store object "'+e.objectName+" changed since action was performed."})),d.steps.forEach((function(e){return e.undo()})),l=!0}));return f.actionReturnValue=u,f}finally{c.pop(),0==--a&&(i(),i=null)}}t.default=function(e,t){return function(n){return u(e,n,!!t)}}},1203:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(137);t.initializeTestMode=function(){o.getGlobalContext().legacyTestMode=!0},t.resetTestMode=function(){o.getGlobalContext().legacyTestMode=!1}},1212:function(e,t,n){"use strict";n.r(t),n.d(t,"getHxAccount",(function(){return v}));var o=n(354),r=n(154),a=n(10),i=n(22),c=n(563),s=n(626),u=n(1094),d=n(1133),l=n(159);let f,p;const b="GetHxAccountAuthFailure";async function v(e){if(Object(a.i)("disablehx")&&Object(i.e)("ShouldNotBeCallingGetHxAccount"),Object(r.a)("acctmonaccounts")&&Object(a.i)("strictsourceid")&&Object(i.d)("UseGetHxAccountBySourceId"),Object(r.a)("acctmonaccounts")&&Object(a.i)("acctmonaccounts")){if(e)return Object(c.b)(e);{const e=await Object(s.getSelectedSourceId)(),t=await Object(s.getHxAccountBySourceId)(e);if(!t)throw Object(i.d)("GetHxAccountFailed"),new Error("Didn't get selected account by SourceId");return t}}if(!f){const t=await Object(c.c)();if(t.items.length>0)if(e){const n=t.items.filter(t=>t.primarySmtp===e);if(1!==n.length)throw 0===n.length?(Object(i.d)("GetHxAccountFailed"),new Error("Didn't get an account by primarySmtp")):(Object(i.d)("GetHxAccountFailed"),new Error("Get duplicated accounts by primarySmtp"));f=n[0]}else f=t.items[0];else p||(p=async function(){const e=Object(l.a)(),t=await o.b(e);if(t.successful&&t.accessToken&&t.expiresDurationSecondsSinceZero){const e=t.isAad?"OFFICE365":"OUTLOOKDOTCOM";return Object(c.a)(t.email,t.accessToken,t.expiresDurationSecondsSinceZero,e)}throw i.h.warn(`Failed to add initial account for correlationGuid: ${e}`),new Error(`${b} Error retrieving auth token for ${t?t.email:""}`)}()),f=await p,Object(d.a)(f);await Object(u.a)(f)}return f}},13562:function(e,t,n){var o=n(13563);"string"==typeof o&&(o=[[e.i,o,""]]);var r={transform:void 0};n(84)(o,r);o.locals&&(e.exports=o.locals)},13563:function(e,t,n){(t=e.exports=n(83)(!1)).push([e.i,".v6_NaCTzdLH8aN2TYSGeY{position:absolute;width:0;height:0;opacity:0}",""]),t.locals={button:"v6_NaCTzdLH8aN2TYSGeY"}},13564:function(e,t,n){"use strict";var o,r,a,i;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),function(e){e.show="show",e.hide="hide",e.toggle="toggle"}(o||(o={})),function(e){e.none="none",e.flush="flush",e.forceFlush="forceFlush",e.new="new",e.extend="extend"}(r||(r={})),function(e){e.default="default",e.view="view",e.list="list",e.info="info",e.delete="delete"}(a||(a={})),function(e){e.outlook_mail="outlook_mail",e.outlook_calendar="outlook_calendar",e.outlook_people="outlook_people",e.outlook_fileshub="outlook_fileshub",e.outlook_tasks="outlook_tasks",e.teams_activity="teams_activity",e.teams_chat="teams_chat",e.m365_app="m365_app",e.office_home="office_home",e.office_create="office_create",e.office_spaces="office_spaces",e.office_word="office_word",e.office_excel="office_excel",e.office_powerpoint="office_powerpoint",e.office_outlook="office_outlook",e.office_onenote="office_onenote"}(i||(i={}))},13565:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var o=n(0),r=o.createContext(void 0);r.displayName="NovaFacade";var a=function(){return o.useContext(r)}},154:function(e,t,n){"use strict";var o=n(3);const r={showOwaBranding:{default:!0,native:!1},includePartnerIn3SRequest:{default:!1},loadThemeFromHostApp:{default:!1,opx:!0},loadCultureFromHostApp:{default:!1,opx:!0},opxDeeplink:{default:!1,opx:!0},authRedirectOnSessionTimeout:{default:!0,native:!1,opx:!1},opxComponentLifecycle:{default:!1,native:!1,opx:!0},navigateToView:{default:!1,opx:!0},readingPaneModal:{default:!0,teams:!1},readingPaneHeaderTitleAndJoinLink:{default:!0,teams:!1},composeFormSaveCloseHandlers:{default:!1,teams:!0},opxServiceWorker:{default:!1,opx:!0},routeOptionsStaticUrl:{default:!1,opx:!0},scenarioData:{default:!1,opx:!0},teamsChannelOptions:{default:!1,teams:!0},macA11y:{default:!1,macoutlook:!0},teamsCalendarPicker:{default:!1,teams:!0},joinTeamsMeeting:{default:!1,hub:!0,opx:!0},calendarPaneHeaderWeather:{default:!0,teams:!1},use3SPeopleSuggestions:{default:!0,macoutlook:!1},defaultCalendarColor:{default:!1,opx:!0},roomAddedHandler:{default:!1,opx:!0},roomFinderFreeBusyStyles:{default:!1,macoutlook:!0,outlookdesktop:!0},defaultSelectCalendarItemSvg:{default:!0,opx:!1},opxInboxRules:{default:!1,opx:!0},moduleNameFromWindow:{default:!0,opx:!1},showArchiveUnreadCount:{default:!1,native:!0},headerFeedback:{default:!0,opx:!1},ribbonFeedback:{default:!1,hub:!0},composeFrom:{default:!1,opx:!0},groupDiscoverCloseButton:{default:!1,opx:!0},updateModalProps:{default:!1,opx:!0},modalOpenedHandler:{default:!1,opx:!0},fullscreenComposeFormPopOut:{default:!1,teams:!0},defaultOutlookThemeColor:{default:!0,opx:!1},yammerDailyDigest:{default:!1,outlookdesktop:!0},yammerDirectFollower:{default:!1,outlookdesktop:!0},yammerDiscovery:{default:!1,outlookdesktop:!0},yammerHostClientType:{default:!1,native:!0,opx:!0},linkClicked:{default:!1,outlookdesktop:!0},showMinimumThreeInsights:{default:!1,opx:!0},groupCreatedHandler:{default:!1,opx:!0},groupDeletedHandler:{default:!1,opx:!0},updateSearchAnswerOnQueryChange:{default:!1,opx:!0},insightsCountUpdatedHandler:{default:!1,opx:!0},processMeetingInsightsHandler:{default:!1,opx:!0},processEmptyYammerPublishersHandler:{default:!1,opx:!0},focusZoneCicularNavigation:{default:!1,opx:!0},componentTokenProvider:{default:!1,opx:!0,native:!0,hub:!0},hideCalendarModuleContent:{default:!1,teams:!0},hideCalendarLeftNav:{default:!1,teamshub:!0},hideAppSuiteHeader:{default:!1,hub:!0},metaOSTest:{default:!1,hub:!0},hideOfficeRail:{default:!1,hub:!0},openMailInHub:{default:!1,win32outlookhub:!0},openComposeMailInHub:{default:!1,win32outlookhub:!0},fullComposeFormModal:{default:!0,teams:!1},renderCalendarHeader:{default:!0,teams:!1},weekWeatherIcon:{default:!0,teams:!1},surfacePLTDataPoint:{default:!1,teams:!0},schedulingAssistant:{default:!0,teams:!1},composeFormHeader:{default:!0,teams:!1},saveInFullCompose:{default:!0,teams:!1},discardInFullCompose:{default:!0,teams:!1},addIns:{default:!0,teams:!1},settings:{default:!0,teams:!1},multiAccounts:{default:!0,teams:!1,outlookdesktop:!1,widget:!1,native:!1,hub:!1},accountSettingsHx:{default:!1,native:!0},nativeDiagnostics:{default:!1,native:!0},nativeQsp:{default:!1,native:!0},moduleSwitch:{default:!1,native:!0},diagInAppSupport:{default:!1,native:!0},diagFeedbackJs:{default:!1,native:!0},diagFeedbackEmailGroup:{default:!1,native:!0},diagFeedbackNoAttachSR:{default:!1,native:!0},diagFeatureCrew:{default:!1,native:!0},diagThrottleFeedbackEmail:{default:!1,native:!0},diagToggleFeedback:{default:!1,native:!0},newOutlookToggle:{default:!1,native:!0},folderHierarchyHx:{default:!1,native:!0},monarchErrorMessage:{default:!1,native:!0},noteFeedSidePanel:{default:!0,native:!1},whatsNew:{default:!0,native:!1},owaBrandingCharm:{default:!0,native:!1},appLauncher:{default:!0,native:!1},incorrectNativeEntryPoint:{default:!1,native:!0},metaOSFeedback:{default:!1,hub:!0},monarchFeedback:{default:!1,native:!0},native:{default:!1,native:!0},nativeResolvers:{default:!1,native:!0},managedQueryLink:{default:!1,native:!0},wrongIndex:{default:!1,native:!0},outlookSuiteHeaderStrategy:{default:!1,native:!0},calendarRibbon:{default:!1,native:!0},mailRibbon:{default:!1,native:!0},pauseInbox:{default:!0,native:!1},hxVersionQueryStringParam:{default:!1,native:!0},nativeServiceWorker:{default:!1,native:!0},nativeHostAttachmentHijack:{default:!1,native:!0},useNativeConversationOptions:{default:!1,native:!0},reboot:{default:!1,native:!0},calendarFolderHx:{default:!1,native:!0},skipAwaitLpcConfig:{default:!1,opx:!0},workloadScenarioSettings:{default:!0,opx:!1},ribbonDefaultToSLR:{default:!1,native:!0},ribbonPersistDefault:{default:!1,native:!0},updateHostAppIcon:{default:!1,native:!0},projectionCustomTitlebar:{default:!1,native:!0},monarchDensity:{default:!1,native:!0},toDoNewTab:{default:!1,native:!0},reduceCalBarExp:{default:!0,native:!1,opx:!1},floodgate:{default:!0,opx:!1},meControlAccountSwitching:{default:!0,native:!1},smimeExtension:{default:!0,native:!1},platformAppSdk:{default:!1,hub:!0},resourceTokenFromHost:{default:!1,native:!0,opx:!0},useBaseTheme:{default:!1,win32outlookhub:!0,hub:!1},acctmonaccounts:{default:!1,native:!0},showOWAMailtoBanner:{default:!0,native:!1},copyLinkUsingClipboardApi:{default:!1,native:!0},outlookDesktopToMonarchPreferenceMigration:{default:!1,native:!0},disableServiceWorker:{default:!1,native:!0},nativeMessaging:{default:!1,native:!0,widget:!0},disableAppModuleKeys:{default:!1,hub:!0},nativeReactions:{default:!1,native:!0},promptRebootNativeHost:{default:!1,native:!0},openNewEventInNewWindow:{default:!1,native:!0}};var a=n(170),i=n(160);const c=e=>{const t=(e=>r[e])(e);if(t){if(Object(a.a)()&&o.e in t)return t[o.e];if(Object(i.b)()&&o.h in t)return t[o.h];let e=Object(o.A)();if(e&&e in t)return t[e];if(e&&(e===o.i||e===o.k)&&o.b in t)return t[o.b];const n=Object(o.E)();return n&&n in t?t[n]:n&&(n===o.g||n===o.d||n===o.c||n===o.a||n===o.h||n===o.f||n===o.j)&&"opx"in t?t.opx:t.default}return!1};n.d(t,"a",(function(){return c}))},159:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));const o=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function r(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function a(){return r()+r()+"-"+r()+"-"+r()+"-"+r()+"-"+r()+r()+r()}function i(e){return o.test(e)}},160:function(e,t,n){"use strict";var o=n(162),r=n(3),a=n(14),i=n(7);function c(){return!!Object(i.f)("hostApp",Object(a.a)().location)&&Object(i.c)("hostApp").toLowerCase()==r.h}n.d(t,"a",(function(){return o.a})),n.d(t,"c",(function(){return o.b})),n.d(t,"b",(function(){return c}))},162:function(e,t,n){"use strict";let o;function r(){if(!o)throw new Error("OpxHostApi has not been initialized yet.");return o}function a(){return!!o}function i(e){o=e}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i}))},168:function(e,t,n){"use strict";var o=n(30),r=n(394),a=n(25),i=n(22);function c(){const e=Object(o.a)();if(!e||!e.SessionSettings)return i.d("SessionSettings not available"),"no-mailbox-id";let t=e.SessionSettings.UserEmailAddress;return Object(a.k)("doc-attachment-usePrimarySmtpAddressForMailboxId")?t:(e.SessionSettings.IsShadowMailbox?t=e.SessionSettings.LogonEmailAddress:Object(r.c)(e.HexCID,e.SessionSettings.UserEmailAddress)&&(t=Object(r.b)(e.HexCID,e.SessionSettings.NotManagedEmailAddresses,e.SessionSettings.UserProxyAddresses)),t)}var s=n(544),u=n(460);function d(e){const t=Object(u.a)().userMailboxInfoMap;t&&t.delete(e)}function l(e,t){return e===t||null!=e&&null!=t&&e.Id===t.Id}var f=n(314);n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return s.a})),n.d(t,"g",(function(){return s.b})),n.d(t,"f",(function(){return d})),n.d(t,"e",(function(){return l})),n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return f.a}))},180:function(e,t,n){"use strict";var o=n(22);let r;function a(){return null==r&&(r="undefined"!=typeof window&&null!=window.performance&&null!=window.performance.timing&&null!=window.performance.navigation&&null!=window.performance.getEntriesByName),r}const i=500,c=[],s=[],u=[],d=[];let l,f=!0;function p(e,t){Object(o.g)((e,t,n)=>{f&&(t==o.b.Error&&s.push({message:e,error:n}),c.push({message:e,level:t}))}),e(g),t(g),a()&&(window.performance.setResourceTimingBufferSize?window.performance.setResourceTimingBufferSize(i):window.performance.webkitSetResourceTimingBufferSize&&window.performance.webkitSetResourceTimingBufferSize(i))}function b(e,t,n){l?l(e,t,n):d.push({name:e,customData:t})}function v(e){return l=e,f=!1,{traces:c,errors:s,network:u,usage:d}}function g(){f&&u.push(arguments)}n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return v})),n.d(t,"d",(function(){return b})),n.d(t,"c",(function(){return a}))},284:function(e,t,n){"use strict";var o,r=n(2);!function(e){e[e.Valid=0]="Valid",e[e.AccountDeprovisioned=1]="AccountDeprovisioned",e[e.AccessRevoked=2]="AccessRevoked",e[e.TransientTokenError=3]="TransientTokenError",e[e.FailedToInitializeOWAConfig=4]="FailedToInitializeOWAConfig",e[e.AccountNotFound=5]="AccountNotFound",e[e.UnknownTokenError=6]="UnknownTokenError"}(o||(o={}));var a=n(66);const i=Object(r.action)("addAccount",e=>({userIdentity:e.userIdentity,account:e})),c=Object(r.action)("removeAccount",e=>({userIdentity:e})),s=Object(r.action)("updateAccount",(e,t,n)=>({userIdentity:e,accountToken:t,accountTokenExpiresIn:n})),u=Object(r.action)("updateOWAConnectedAccountStatus",(e,t)=>({userIdentity:e,accountState:t})),d=Object(r.action)("connectedAccountIsInErrorState",(e,t)=>Object(a.b)({name:"connectedAccountIsInErrorState",customData:{accountState_1:o[e],accountProvider_2:t}},{accountState:e})),l=Object(r.action)("connectedAccountsListRequested",e=>({isSuccess:e})),f=Object(r.action)("setAccountsStoreState",e=>({state:e}));var p,b=n(13);!function(e){e[e.None=0]="None",e[e.Loading=1]="Loading",e[e.AccountsLoadSuccessful=2]="AccountsLoadSuccessful",e[e.AccountsLoadError=3]="AccountsLoadError"}(p||(p={}));var v=Object(r.createStore)("OWAAccountsStore",{accountsMap:new b.ObservableMap({}),accountsLoadedState:p.None}),g=n(72),m=n(52);function h(e){if(e==Object(m.b)())return!1;return void 0!==y(e)}function O(){return[...v().accountsMap.values()]}function y(e){return v().accountsMap.get(e)}function S(){var e;return(null===(e=O())||void 0===e?void 0:e.length)>0?O()[0]:null}function j(){return O().filter(e=>e.accountState!=o.Valid)}function w(e){return O().filter(t=>e.includes(t.accountState))}function I(e){return O().filter(t=>t.accountProviderType==e)}function x(e){return h(e)?y(e).accountProviderType:null}function k(e){return"Outlook"==e.accountProviderType?`MSAuth1.0 usertoken="${e.token}", type="MSACT"`:"Google"==e.accountProviderType||"ICloud"==e.accountProviderType||"Yahoo"==e.accountProviderType?`Bearer ${e.token}`:Object(g.a)(e.accountProviderType)}function A(e,t){return function(n){const o=y(n);return o?o[e]:t}}A("accountUniqueId","0");const M=A("accountState",o.Valid),H=()=>O().some(e=>!C(e.userIdentity)),N=A("accountProviderType",null),T=e=>"Outlook"==N(e),C=e=>M(e)==o.Valid,E=()=>O().length>0;function _(){return v().accountsLoadedState}var P=n(5),F=n(68);Object(r.mutator)(i,({account:e})=>{Object(F.p)("owaAccountAdded",{accountStatus_1:o[e.accountState]}),v().accountsMap.set(e.userIdentity,e)}),Object(r.mutator)(c,({userIdentity:e})=>{v().accountsMap.delete(e)}),Object(r.mutator)(s,({userIdentity:e,accountToken:t,accountTokenExpiresIn:n})=>{const o=v().accountsMap.get(e);o.token=t,o.tokenExpiry=Object(P.j)(Object(P.Tb)(),n)}),Object(r.mutator)(u,({userIdentity:e,accountState:t})=>{const n=v().accountsMap.get(e);n.accountState==o.Valid&&t!=o.Valid&&Object(F.p)("owaConnectedAccountStatusUpdated",{accountStatus_1:o[t]}),n.accountState=t}),Object(r.mutator)(l,e=>{const t=e.isSuccess?p.AccountsLoadSuccessful:p.AccountsLoadError;v().accountsLoadedState=t}),Object(r.mutator)(f,e=>{v().accountsLoadedState=e.state}),n.d(t,"c",(function(){return i})),n.d(t,"u",(function(){return c})),n.d(t,"x",(function(){return s})),n.d(t,"w",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return l})),n.d(t,"v",(function(){return f})),n.d(t,"n",(function(){return O})),n.d(t,"k",(function(){return y})),n.d(t,"i",(function(){return S})),n.d(t,"f",(function(){return j})),n.d(t,"g",(function(){return w})),n.d(t,"o",(function(){return I})),n.d(t,"j",(function(){return x})),n.d(t,"m",(function(){return k})),n.d(t,"l",(function(){return M})),n.d(t,"q",(function(){return H})),n.d(t,"t",(function(){return T})),n.d(t,"s",(function(){return C})),n.d(t,"p",(function(){return E})),n.d(t,"h",(function(){return _})),n.d(t,"r",(function(){return h})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return p}))},2930:function(e,t,n){"use strict";var o=n(634);t.a=function(e,t){return Object(o.a)(e,t)}},3066:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var o=n(25),r=n(625);function a(e){return Object(o.k)("tri-officeRail")&&(e===r.a.Mail||e===r.a.Calendar||e===r.a.AppHost||e===r.a.People||e===r.a.FilesHub)}},314:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var o=n(52),r=n(25);function a(e){const t=Object(o.h)(e);return t&&t.SessionSettings?0===t.SessionSettings.WebSessionType?Object(r.k)("doc-attachment-routingKeyAadSmtp")?"SMTP:":"":"MSA:":"no-routing-key:"}},332:function(e,t,n){"use strict";var o=n(521),r=n(713),a=n(306);t.a=function(e){return Object(a.a)(e)?Object(o.a)(e):Object(r.a)(e)}},3424:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var o=n(0),r=n(3680);function a(e,t){const n={query:e,variables:null==t?void 0:t.variables,context:null==t?void 0:t.context};Object(o.useEffect)(()=>(r.a.addRef(n),()=>r.a.releaseRef(n)))}},3425:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return r}));const o=e=>{const t=e||{},n=t.context||{};return t.fetchPolicy=t.fetchPolicy||"cache-first",Object.assign(Object.assign({},t),{context:Object.assign(Object.assign({},n),{isManagedQuery:!0})})},r=e=>{const t=e||{},n=t.context||{};return Object.assign(Object.assign({},t),{context:Object.assign(Object.assign({},n),{isManagedQuery:!0})})}},3562:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(25);function r(){return Object(o.k)("tri-officeRailHost")||Object(o.k)("tri-appServiceApps")}},358:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(933);t.legacyApplyMiddleware=o.default;var r=n(931);t.action=r.default;var a=n(1201);t.select=a.default;var i=n(1202);t.createUndo=i.default;var c=n(755);t.getActionType=c.getActionType;var s=n(1203);t.initializeTestMode=s.initializeTestMode,t.resetTestMode=s.resetTestMode},3634:function(e,t,n){"use strict";var o=n(2);t.a=Object(o.action)("onOfficeAppClick",(e,t)=>({app:e,currentlySelectedModule:t}))},3680:function(e,t,n){"use strict";var o=n(635),r=n(22),a=n(68),i=n(2930);const c=500,s=-1;function u(){const e=new Map;return{upsert:t=>(function(e,t){const n=e.get(t.key)||[],o=d(n,t);return o!==s?n[o]:(n.push(t),e.set(t.key,n),n.length>c&&Object(a.p)("KVMap.TooBig",{size:n.length,name:t.diag(t.key)}),t)})(e,t),remove:t=>(function(e,t){const n=e.get(t.key),o=d(n,t);n.splice(o,1)})(e,t),get:t=>(function(e,t){const n=e.get(t.key)||[];return n[d(n,t)]})(e,t),clear:()=>e.clear(),count:()=>e.size,forEach:t=>{e.forEach((e,n)=>{e.forEach(e=>t(e))})}}}function d(e,t){let n=s;return e.some((e,o)=>{const r=Object(i.a)(e.variables,t.variables);return r&&(n=o),r}),n}var l=n(595);function f(e){var t;for(const n of e.definitions)if("OperationDefinition"===n.kind)return`${n.operation}:${(null===(t=n.name)||void 0===t?void 0:t.value)||"unknown"}`;return"unknown"}var p=n(10),b=n(3);const v=u(),g=u(),m=new Map,h=3e4;function O(e){e.count=e.count?e.count+1:1}function y(e){e.count=e.count?e.count-1:0}function S(e){const t=new Array;for(const n of e.key.definitions)if("OperationDefinition"===n.kind){if("query"!=n.operation&&"mutation"!=n.operation){Object(r.c)(`cannot track operation of type ${n.operation}`);break}n.selectionSet.selections.forEach(n=>{if("Field"===n.kind){const o=n.name.value,r={};(n.arguments||[]).forEach(t=>{var n;if("Variable"===t.value.kind){const o=t.value.name.value;r[o]=null===(n=e.variables)||void 0===n?void 0:n[o]}}),t.push({key:o,variables:r,diag:j,count:0})}})}return t}const j=e=>e;const w={addRef:function(e){const t=v.upsert({key:e.query,variables:e.variables,context:e.context,diag:f,count:0}),n=S(t).map(g.upsert);O(t),n.forEach(O)},releaseRef:function(e){const t=v.get({key:e.query,variables:e.variables}),n=S(t).map(g.get);y(t),n.forEach(y),0===t.count&&self.setTimeout(()=>(function(e,t){if(!e.disposed&&0===e.count){if(e.sessionId&&!Object(p.i)("disablehx")){Object(o.d)().activeSet.releaseSession(e.sessionId),m.delete(e.sessionId)}e.disposed=!0,v.remove(e);let n=!1;t.forEach(e=>{if(!e.disposed&&0===e.count){const t={id:"ROOT_QUERY",fieldName:e.key,broadcast:!1};e.variables&&!Object(i.a)({},e.variables)&&(t.args=e.variables),Object(l.a)().cache.evict(t),g.remove(e),n=!0,e.disposed=!0}}),n&&Object(l.a)().cache.gc()}})(t,n),h)},getSessionId:function(e){const t=v.upsert({key:e.query,variables:e.variables,context:e.context,diag:f,count:0});if(S(t).forEach(g.upsert),!t.sessionId){const e=Object(p.i)("disablehx")?Object(b.M)():Object(o.d)().activeSet.createSession();t.sessionId=e,m.set(e,{query:t.key,variables:t.variables,context:t.context})}return t.sessionId},getQueryFromSessionId:function(e){return m.get(e)},resetStateForTests:function(){v.clear(),g.clear(),m.clear()}};n.d(t,"a",(function(){return w})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return f}))},3689:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var o=n(487),r=n(3424),a=n(3717),i=n(3425);function c(e,t){const n=Object(i.b)(t);return Object(r.a)(e,n),Object(a.a)(e,n),Object(o.useQuery)(e,n)}},3690:function(e,t,n){"use strict";var o=n(2);t.a=Object(o.action)("onModuleClick",(e,t,n)=>({module:e,currentlySelectedModule:t,activeModuleAction:n}))},3717:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var o=n(64),r=n(5104),a=n(3680),i=n(367),c=n(595),s=n(154),u=n(68),d=n(10);const l=Object(a.b)();let f=!1;function p(e,t){Object(s.a)("nativeResolvers")&&!Object(d.i)("disablehx")&&(f||(Object(i.a)().activeSet.registerHandler(b),f=!0))}const b={onActiveSetChanged:e=>{e.forEach(e=>{e.type!==o.HxActiveSetEventType.ObjectChanged&&e.type!==o.HxActiveSetEventType.ObjectDeleted&&e.type!==o.HxActiveSetEventType.CollectionChanged||e.sessionIds.forEach(e=>{var t;const n=a.a.getQueryFromSessionId(e);n&&"query"===(null===(t=Object(r.a)(n.query))||void 0===t?void 0:t.operation)&&l.upsert(Object.assign(Object.assign({},n),{key:n.query,diag:a.c}))})}),l.count()>0&&self.setTimeout(v,500)}};function v(){const e=Object(c.a)();l.forEach(t=>{const n=(Object(a.c)(t.key)||"unknown")+"_requery",o=new u.b("ApolloLiveQuery");o.addCustomData({opName:n}),e.query({query:t.key,variables:t.variables,context:t.context,fetchPolicy:"network-only"}).then(e=>o.end()).catch(e=>o.endWithError("ClientError",e))}),l.clear()}},3889:function(e,t,n){"use strict";var o=n(3689),r=n(487),a=n(3424),i=(n(3717),n(3425));function c(e,t){const n=Object(i.a)(t);return Object(a.a)(e,n),Object(r.useMutation)(e,n)}n.d(t,"b",(function(){return o.a})),n.d(t,"a",(function(){return c}))},394:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return u}));var o=n(30),r=n(314),a=n(25),i=n(22);function c(e,t,n){if(n)for(const t of n)if(!s(e,t))return t;return t&&t.length>0?t[0]:"NoResolvableAddress@invalid.outlook.com"}function s(e,t){return("outlook_"+e+"@outlook.com").toLowerCase()===t.toLowerCase()}function u(){let e=function(){const e=Object(o.a)();if(!e||!e.SessionSettings)return i.d("SessionSettings not available"),"no-routing-key";let t=e.SessionSettings.UserEmailAddress;if(0===e.SessionSettings.WebSessionType)return Object(r.a)()+t;if(Object(a.k)("doc-attachment-routingKeyPuid"))return"PUID:"+e.SessionSettings.UserPuid+"@"+e.SessionSettings.TenantGuid;if(e.SessionSettings.IsShadowMailbox)return Object(r.a)()+e.SessionSettings.LogonEmailAddress;if(s(e.HexCID,e.SessionSettings.UserEmailAddress))return Object(r.a)()+c(e.HexCID,e.SessionSettings.NotManagedEmailAddresses,e.SessionSettings.UserProxyAddresses);return Object(r.a)()+t}();return e=encodeURIComponent(e),e}},397:function(e,t,n){"use strict";var o=n(221),r=n(193),a="[object Symbol]";t.a=function(e){return"symbol"==typeof e||Object(r.a)(e)&&Object(o.a)(e)==a}},4011:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(2);let r=Object(o.createStore)("leftRailStore",{selectedApp:null,enabledRailItems:[]});r()},4147:function(e,t,n){"use strict";var o=n(2),r=Object(o.createStore)("appModule",{module:void 0});function a(){return r().module}var i=Object(o.action)("updateModule",e=>({newModule:e}));function c(e){r().module||i(e)}Object(o.mutator)(i,e=>{const t=e.newModule,n=r();n.module!=t&&(n.module=t)});n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return i}))},4247:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return s}));var o=n(25),r=n(154),a=n(3562);const i={Mail:!0,Calendar:!0,People:!0,FilesHub:!0,AppHost:!0};function c(e){return(Object(r.a)("moduleSwitch")||Object(o.k)("fwk-module-switch")||Object(a.a)())&&i[e]}function s(e,t){return c(e)&&c(t)}},4440:function(e,t,n){"use strict";var o=n(2);t.a=Object(o.action)("onAppDrawerAppClick",e=>({appId:e}))},460:function(e,t,n){"use strict";var o=n(2),r=n(13);t.a=Object(o.createStore)("OWAClientIdStore",{userMailboxInfoMap:new r.ObservableMap})},4720:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(100),r=n(3562);const a=["Yammer","Bookings","OrgExplorer","AppStore","Y29tLm1pY3Jvc29mdC50ZWFtc3BhY2UudGFiLnBsYW5uZXIjIzEuMi4zIyNQdWJsaXNoZWQ=","MmUzYTYyOGQtNmY1NC00MTAwLTllN2EtZjAwYmMzNjIxYTg1IyMxLjAuOCMjUHVibGlzaGVk","ZGI1ZTU5NzAtMjEyZi00NzdmLWEzZmMtMjIyN2RjNzc4MmJmIyMyLjIuMyMjUHVibGlzaGVk"];function i(e){return!Object(o.g)()&&Object(r.a)()&&a.includes(e)}},4812:function(e,t,n){"use strict";var o=n(20),r=n(3690),a=n(3634),i=n(2),c=Object(i.action)("onAppHostHeaderStartSearch"),s=n(3562),u=n(4247),d=n(4011);Object(i.mutator)(r.a,e=>{Object(d.a)().selectedApp=null}),Object(i.mutator)(c,e=>{Object(d.a)().selectedApp=null});n(5308);n.d(t,"c",(function(){return f})),n.d(t,"e",(function(){return r.a})),n.d(t,"f",(function(){return a.a})),n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return s.a})),n.d(t,"b",(function(){return u.b}));const l=new o.c(()=>n.e(1253).then(n.bind(null,20021))),f=(new o.b(l,e=>e.getSelectedOfficeRailApp),new o.b(l,e=>e.getLeftRailItemContextualMenuItems));Object(o.f)(r.a,l,e=>e.onModuleClickOrchestrator),Object(o.f)(a.a,l,e=>e.onOfficeAppClickOrchestrator)},5087:function(e,t,n){"use strict";var o=n(20),r=n(4440),a=n(5109);function i(e){return Object(a.a)().appServiceApps.filter(t=>t.id===e)[0]}n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return r.a})),n.d(t,"b",(function(){return i}));const c=new o.c(()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(11),n.e(21),n.e(24),n.e(56),n.e(230),n.e(532)]).then(n.bind(null,19908))),s=Object(o.d)(c,e=>e.AppDrawer)},5109:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(2);let r=Object(o.createStore)("appDrawerStore",{appServiceApps:[],hasFetchedAppData:!1});r()},5308:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var o=n(2),r=n(4011),a=n(3634),i=n(4720),c=n(5087);Object(o.mutator)(a.a,e=>{Object(i.a)(e.app)&&(Object(r.a)().selectedApp=e.app)}),Object(o.mutator)(c.c,e=>{Object(r.a)().selectedApp=e.appId});const s=Object(o.mutatorAction)("selectOfficeRailApp",e=>{Object(r.a)().selectedApp=e})},543:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));n(659);let o;function r(e){if(!o)throw new Error("Localization has not yet been initialized");return o(e)}function a(e){o=e}},544:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return c}));var o=n(52),r=n(460);let a=void 0;function i(e){a=e}function c(e,t){if(a&&!t){const t=a(e);if(t)return t}const n=Object(r.a)().userMailboxInfoMap;if(!n||!n.get(e)){let t=!1;e&&(t=e!=Object(o.b)());let r={type:"UserMailbox",userIdentity:t?e:Object(o.b)(),mailboxSmtpAddress:t?e:Object(o.c)()};return n.set(e,r),r}return n.get(e)}},5799:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var o=n(279),r=n(19);const a="shortcut icon",i="image/x-icon";function c(e,t){if(!document)return;const n=Object(o.b)(e);let c=document.querySelector(`link[rel="${a}"]`);c||(c=document.createElement("link"),c.rel=a,c.type=i,document.head.appendChild(c));const u=Object(r.a)(n);if(c.href!=u)for(const e of s)e(u,t);c.href=n}let s=[];function u(e){s.push(e)}},6010:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var o=n(2937),r=n(483),a=n(46),i=n(625);function c(e){const t=Object(a.b)().search;switch(e){case i.a.Mail:return Object(r.l)()+t;case i.a.Calendar:return Object(r.e)()+t;case i.a.People:return Object(r.p)()+t;case i.a.FilesHub:return Object(r.h)()+t;case i.a.Tasks:return Object(o.b)()?Object(r.u)():Object(r.o)({path:"/tasks"});case i.a.Eventify:return Object(r.f)();default:throw new Error("Cannot get module switcher item URL of a workload that doesn't exist")}}},635:function(e,t,n){"use strict";var o=n(626),r=n(64),a=n(354),i=n(563);async function c(e,t){const n=await a.d(e,function(e){switch(e){case"OFFICE365":return a.a.OFFICE365;case"OUTLOOKDOTCOM":return a.a.OUTLOOKDOTCOM;case"GOOGLE":return a.a.GOOGLE;case"YAHOO":return a.a.YAHOO;case"ICLOUD":return a.a.ICLOUD;case"OTHER":return a.a.OTHER;default:throw new Error(`Add Account not supported for type: ${e}`)}}(t));if(n.successful&&n.accessToken&&n.expiresDurationSecondsSinceZero){return await Object(i.a)(n.email,n.accessToken,n.expiresDurationSecondsSinceZero,t)}throw r.HxEnums.HxAccountCreationFailureType.Err_InvalidCredentials}var s=n(1212),u=n(367),d=n(489);n(310),n(989);var l=n(1094);n.d(t,"c",(function(){return o.getHxAccountBySourceId})),n.d(t,"e",(function(){return o.getPreliminaryHxAccountAndSourceIds})),n.d(t,"f",(function(){return o.getSelectedSourceId})),n.d(t,"h",(function(){return o.selectAccountSource})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return s.getHxAccount})),n.d(t,"d",(function(){return u.a})),n.d(t,"g",(function(){return d.a})),n.d(t,"i",(function(){return l.a}))},636:function(e){e.exports=JSON.parse('{"a":"uxa"}')},637:function(e){e.exports=JSON.parse('{"a":"txa"}')},638:function(e){e.exports=JSON.parse('{"a":"sxa"}')},639:function(e){e.exports=JSON.parse('{"a":"rxa"}')},640:function(e){e.exports=JSON.parse('{"a":"qxa"}')},641:function(e){e.exports=JSON.parse('{"a":"pxa"}')},642:function(e){e.exports=JSON.parse('{"a":"oxa"}')},643:function(e){e.exports=JSON.parse('{"a":"nxa"}')},644:function(e){e.exports=JSON.parse('{"a":"mxa"}')},645:function(e){e.exports=JSON.parse('{"a":"lxa"}')},646:function(e){e.exports=JSON.parse('{"a":"kxa"}')},647:function(e){e.exports=JSON.parse('{"a":"jxa"}')},713:function(e,t,n){"use strict";var o=n(416),r=n(522),a=Object(r.a)(Object.keys,Object),i=Object.prototype.hasOwnProperty;t.a=function(e){if(!Object(o.a)(e))return a(e);var t=[];for(var n in Object(e))i.call(e,n)&&"constructor"!=n&&t.push(n);return t}},716:function(e,t,n){"use strict";var o=/\s/;var r=function(e){for(var t=e.length;t--&&o.test(e.charAt(t)););return t},a=/^\s+/;var i=function(e){return e?e.slice(0,r(e)+1).replace(a,""):e},c=n(165),s=n(397),u=NaN,d=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,f=/^0o[0-7]+$/i,p=parseInt;t.a=function(e){if("number"==typeof e)return e;if(Object(s.a)(e))return u;if(Object(c.a)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Object(c.a)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=i(e);var n=l.test(e);return n||f.test(e)?p(e.slice(2),n?2:8):d.test(e)?u:+e}},7469:function(e,t,n){"use strict";var o=n(487);const r=Object(o.makeVar)("");function a(){return r()}function i(e){r(e)}var c=n(2),s=n(4147),u=n(625);Object(c.orchestrator)(s.c,e=>{const{newModule:t}=e;t!==u.a.AppHost&&i(t.toString())}),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}))},755:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setOriginalTarget=function(e,t){e.__SATCHELJS_ORIGINAL_TARGET=t},t.getOriginalTarget=function(e){if(void 0!==e.__SATCHELJS_ORIGINAL_TARGET)return e.__SATCHELJS_ORIGINAL_TARGET},t.setActionType=function(e,t){e.__SATCHELJS_ACTION_TYPE=t},t.getActionType=function(e){return e.__SATCHELJS_ACTION_TYPE}},774:function(e){e.exports=JSON.parse('{"a":"awa"}')},775:function(e){e.exports=JSON.parse('{"a":"gwa"}')},776:function(e){e.exports=JSON.parse('{"a":"fwa"}')},777:function(e){e.exports=JSON.parse('{"a":"ewa"}')},778:function(e){e.exports=JSON.parse('{"a":"dwa"}')},779:function(e){e.exports=JSON.parse('{"a":"cwa"}')},780:function(e){e.exports=JSON.parse('{"a":"bwa"}')},784:function(e){e.exports=JSON.parse('{"a":"Qwa"}')},785:function(e){e.exports=JSON.parse('{"a":"Pwa"}')},786:function(e){e.exports=JSON.parse('{"a":"Owa"}')},787:function(e){e.exports=JSON.parse('{"a":"Nwa"}')},788:function(e){e.exports=JSON.parse('{"a":"Mwa"}')},789:function(e){e.exports=JSON.parse('{"a":"Lwa"}')},790:function(e){e.exports=JSON.parse('{"a":"Kwa"}')},791:function(e){e.exports=JSON.parse('{"a":"Jwa"}')},792:function(e){e.exports=JSON.parse('{"a":"Iwa"}')},793:function(e){e.exports=JSON.parse('{"a":"Hwa"}')},794:function(e){e.exports=JSON.parse('{"a":"Gwa"}')},795:function(e){e.exports=JSON.parse('{"a":"Fwa"}')},8080:function(e,t,n){"use strict";var o=n(5799);n.d(t,"a",(function(){return o.a}))},885:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var o=n(64),r=n(489),a=n(367),i=n(1131);function c(e,t,n,c){return Object(r.a)(async r=>{const s=e.objectId;if(e=await Object(a.a)().activeSet.getObject(s,r),t(e))return Promise.resolve(e);return Object(i.a)(e=>{if(e.type===o.HxActiveSetEventType.ObjectChanged&&e.object.objectId.isEqual(s)&&t(e.object))return e.object},n,c)})}},897:function(e){e.exports=JSON.parse('{"a":"c$a"}')},9194:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return s}));var o=n(4147),r=n(9195);const a={},i={};function c(e){const t=e.appModuleProps.module;e.routerOptions&&(e.routerOptions.routeGenerator.then(e=>{i[t]=e}),e.routerOptions.setModuleForVdir=()=>Object(r.a)(e),0==Object.keys(a).length&&(e.routerOptions.routeGenerator=e.routerOptions.routeGenerator.then(()=>()=>i[Object(o.a)()]()))),a[t]=e}function s(e){return a[e]}},9195:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var o=n(19),r=n(5105),a=n(625),i=n(4147),c=n(6912),s=n(5976);function u(e){const t=e.appModuleProps.module;Object(i.a)()!=t&&(Object(a.e)(e.workload||0),Object(o.k)(t),Object(r.a)(()=>Object(c.a)(e.getModuleName)),e.routerOptions&&Object(s.e)(e.routerOptions.vdir),Object(i.c)(t))}},931:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(1200),r=n(755);function a(e,t,n){var a=function(){var r,a=this,i=arguments;return o.default((function(){return r=e.apply(a,i)}),t,arguments,n),r};return r.setOriginalTarget(a,e),r.setActionType(a,t),a}function i(e,t,n,o,r){if(!n||"function"!=typeof n.value)throw new Error("The @action decorator can only apply to class methods.");n.value=a(n.value,o,r)}t.default=function(e,t){return function(n,o,r){if(1==arguments.length&&"function"==typeof n)return a(n,e,t);i(n,o,r,e,t)}}},933:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(137);function r(e,t){return e.bind(null,t)}function a(e,t,n,o){return e()}t.default=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=a,i=e.length-1;i>=0;i--)n=r(e[i],n);o.getGlobalContext().legacyDispatchWithMiddleware=n},t.dispatchWithMiddleware=function(e,t,n,r){o.getGlobalContext().legacyDispatchWithMiddleware||(o.getGlobalContext().legacyDispatchWithMiddleware=a),o.getGlobalContext().legacyDispatchWithMiddleware(e,t,n,r)}}}]);
//# sourceMappingURL=owa.MailBoot~SharedBoot.js.map
self.scriptsLoaded['owa.MailBoot~SharedBoot.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~SharedBoot.js'] = (new Date()).getTime();