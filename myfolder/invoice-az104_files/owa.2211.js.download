self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.2211.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[2211],{11748:function(e,t,c){"use strict";c.r(t);var r=c(22),o=c(2851),a=c(2);const n=Object(a.action)("PREFETCH_ALL_WAC_RESOURCES"),s=Object(a.action)("PREFETCH_WAC_RESOURCES_ATTACHMENTS",e=>({attachmentIds:e})),i=Object(a.action)("PREFETCH_WAC_RESOURCES_FILES",e=>({fileNames:e}));var d=c(2767);const p=Object(a.action)("WAC_PRELOAD_APPS_FOR_FILES",e=>({fileNames:e})),l=Object(a.action)("WAC_PRELOAD_APPS",e=>({appsToPreload:e})),u=Object(a.action)("WAC_APPS_PRELOADED",e=>({appsPreloaded:e})),f={appsPreloaded:{[d.a.Word]:!1,[d.a.Excel]:!1,[d.a.PowerPoint]:!1}},P=Object(a.createStore)("wacPrefetchResourcesStore",f);var b=c(25),O=c(100);function h(){return!function(){const{appsPreloaded:e}=P();return Object.keys(e).every(t=>e[t])}()&&Object(b.k)("doc-SxS-Wac-prefetchStaticResources")&&!Object(O.g)()}function E(e){const t=document.createElement("iframe");t.setAttribute("src",e),t.setAttribute("style","visibility:hidden; position:absolute; width:0px; height:0px; left:0px; top:0px;"),document.body.appendChild(t)}Object(a.orchestrator)(n,()=>{h()&&l([d.a.Word,d.a.Excel,d.a.PowerPoint])}),Object(a.orchestrator)(i,({fileNames:e})=>{h()&&e&&0!==e.length&&p(e)}),Object(a.orchestrator)(s,async e=>{try{const{attachmentIds:t}=e;if(!h()||!t||0===t.length)return;const c=await o.g.import(),r=t.map(c).filter(e=>!!e).map(e=>e.model.Name);p(r)}catch(e){r.d("PrefetchWacResourcesError: Unhandled error",e)}}),Object(a.orchestrator)(p,({fileNames:e})=>{const t=e.reduce((e,t)=>{const c=Object(d.b)(t),r=Object(d.f)(c);return null!=r&&(e[r]=!0),e},{}),c=Object.keys(t);l(c)});const j=[".docx",".doc",".docm",".odt"],m=[".xlsx",".xlsm",".xlsb",".ods"],A=[".pptx",".ppxs",".odp"];var R=c(2773);Object(a.orchestrator)(l,({appsToPreload:e})=>{const t=P();e=e.filter(e=>!t.appsPreloaded[e]),u(e),function(e){const t=function(e){const t=t=>{const[c]=t.map(t=>e[t]).filter(e=>!!e);return c};return{[d.a.Word]:t(j),[d.a.Excel]:t(m),[d.a.PowerPoint]:t(A)}}((Object(R.a)().WacPreloadMappings||[]).reduce((e,[t,c])=>(e[t]=c,e),{}));return e.map(e=>t[e])}(e).filter(e=>!!e).forEach(E)}),Object(a.mutator)(u,({appsPreloaded:e})=>{const t=P();e.forEach(e=>t.appsPreloaded[e]=!0)}),c.d(t,"prefetchAllWacResources",(function(){return n})),c.d(t,"prefetchWacResourcesForAttachments",(function(){return s})),c.d(t,"prefetchWacResourcesForFiles",(function(){return i}))}}]);
//# sourceMappingURL=owa.2211.js.map
self.scriptsLoaded['owa.2211.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.2211.js'] = (new Date()).getTime();