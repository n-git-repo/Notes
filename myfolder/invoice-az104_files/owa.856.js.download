self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.856.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[856],{11759:function(e,t,n){"use strict";var a=n(2);const i=Object(a.action)("updateAutoOpenRegistrationInStore",(e,t)=>({autoOpenPaneId:e,autoOpenRegistration:t}));var c=n(66);const r=Object(a.action)("updateAutoOpenRegistration",(e,t)=>({autoOpenPaneId:e,autoOpenRegistration:t})),o=Object(a.action)("flexPaneAutoOpened",e=>Object(c.b)({name:"flexPaneAutoOpened",customData:{autoOpenPaneId:e}},{autoOpenPaneId:e})),s=["whatsNewPane","OwaTimePanel"];var d=n(13);const u=Object(a.createStore)("suiteHeaderAutoOpenStore",{autoOpenRegistrationMap:new d.ObservableMap});var l=n(6852),b=n(3709);let f=!1;Object(a.orchestrator)(r,e=>{const{autoOpenPaneId:t,autoOpenRegistration:n}=e;i(t,n),f||function(){const e=u().autoOpenRegistrationMap;for(let t of s){if(!e.has(t))break;{const{shouldAutoOpen:n,handleAutoOpen:a}=e.get(t);if(n&&!Object(l.b)()){a?a():Object(b.b)(t),o(t),f=!0;break}}}}()});Object(a.mutator)(i,e=>{u().autoOpenRegistrationMap.set(e.autoOpenPaneId,e.autoOpenRegistration)});n.d(t,"a",(function(){return r}))},20068:function(e,t,n){"use strict";n.r(t);var a=n(3215),i=(n(5974),n(3995),n(4705),n(25)),c=n(168),r=n(11759),o=n(2843),s=n(3217),d=n(2);let u=null;function l(){Object(s.d)("AutoOpen")}Object(d.orchestrator)(a.i,e=>{const{settings:t,userIdentity:n}=e;if(Object(c.d)().userIdentity!==n)return;if(u=t.isTimePanelOpen,!Object(o.c)())return;const a=u&&Object(s.b)()&&Object(i.k)("cal-time-panel-softPin");Object(r.a)("OwaTimePanel",{shouldAutoOpen:a,handleAutoOpen:l})}),Object(d.orchestrator)(o.e,e=>{if(null===u)return;const t=e.isRendered&&u&&Object(s.b)()&&Object(i.k)("cal-time-panel-softPin");Object(r.a)("OwaTimePanel",{shouldAutoOpen:t,handleAutoOpen:l})}),n.d(t,"loadWorkloadScenarioSettings",(function(){return a.a}))},2761:function(e,t,n){"use strict";function a(e,t){Object.keys(t).forEach(n=>e.set(n,t[n]))}function i(e){let t=null!=e?e:{headers:new Headers};return t.datapoint=t.datapoint||{},t.datapoint.mailbox="Default",t}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}))},2762:function(e,t,n){"use strict";var a=n(2820),i=n(284),c=n(753),r=n(68),o=n(5),s=n(22);const d="X-AnchorMailbox",u="Authorization",l="X-OwaWebSessionType",b="X-OWA-ExplicitLogonUser";async function f(e,t){const n={},f=Object(i.k)(e);if(f){if(f.accountState==i.b.AccessRevoked)return null;if(f.accountState==i.b.AccountDeprovisioned||f.accountState==i.b.AccountNotFound)return Object(i.d)(f.accountState,f.accountProviderType),null}if(t?(n[d]=t,n[b]=t):f&&(n[d]=f.anchorMailbox),f){let t,i=f.token,d=Object(c.g)(f.tokenExpiry);!d&&i||(Object(r.p)("getAndUpdateAccessToken",{tokenExpiry:Object(o.y)(f.tokenExpiry,Object(o.Tb)()),isTokenExpired_1:d,isTokenInvalid_2:!i},{isCore:!0}),i=await a.a.importAndExecute(f.accountId,e,i),s.h.info("[AccountLoadRecovery] getConnectedAccountHeaders: finished GetAndUpdateAccessToken for "+e+i),i||(i="")),"Outlook"==f.accountProviderType?(t=`MSAuth1.0 usertoken="${i}", type="MSACT"`,n[l]=1..toString()):"Google"!=f.accountProviderType&&"ICloud"!=f.accountProviderType&&"Yahoo"!=f.accountProviderType||(t=`Bearer ${i}`,n[l]=2..toString()),n[u]=t}return n}var O=n(2761);async function p(e,t){const n=Object(O.a)();return n.headers=await async function(e,t){var n;const a=t&&(null===(n=e.headers)||void 0===n?void 0:n.set)?new Headers(e.headers):new Headers,i=await f(e.mailboxInfo.userIdentity,m(e.mailboxInfo.type,e.mailboxInfo.mailboxSmtpAddress)?e.mailboxInfo.mailboxSmtpAddress:null);return Object(O.b)(a,i),a}(e,t),n.authNeededOnUnAuthorized=!1,n.datapoint=n.datapoint||{},n.datapoint.mailbox="Connected",n}function m(e,t){const n="GroupMailbox"==e||"TeamsMailbox"==e||"SharedMailbox"==e||"PublicMailbox"==e;return n&&null==t&&s.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return m}))},2763:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2);const i=Object(a.action)("triggerReInitializeAccount",e=>({userIdentity:e}))},2815:function(e,t,n){"use strict";var a=n(2761);function i(e,t){return{"X-OWA-ExplicitLogonUser":e,"X-AnchorMailbox":t||e}}function c(e,t,n){t&&(e||n)&&Object(a.b)(t,i(e,n))}function r(e,t){var n;const a=null!=t?t:{},i=(null===(n=a.headers)||void 0===n?void 0:n.set)?new Headers(a.headers):new Headers;return a.datapoint=a.datapoint||{},a.datapoint.mailbox=a.datapoint.mailbox||"Explicit",c(e,i),Object.assign(Object.assign({},a),{headers:i})}var o=n(284),s=n(2762),d=n(74),u=n(251),l=n.n(u);async function b(e){return Object(d.b)().then(async t=>{if(e)if(Object(o.r)(e.userIdentity)){const n=await Object(s.a)(e.userIdentity,"GroupMailbox"==e.type||"TeamsMailbox"==e.type?e.mailboxSmtpAddress:null);l()(t,n)}else if("GroupMailbox"==e.type||"TeamsMailbox"==e.type){const n=i(e.mailboxSmtpAddress);l()(t,n)}return t})}function f(){return Object(d.b)().then(e=>(e.prefer='exchange.Behavior="CalendarInternal"',e))}function O(e=null){return Object(o.r)(e)?f().then(t=>{return Object(s.a)(e).then(e=>(Object.keys(e).forEach(n=>t[n]=e[n]),t))}):Promise.resolve({})}var p=n(69);function m(e,t,n,a){let i=new Headers;return n&&i.set("X-OWA-CANARY",Object(p.a)()),t&&i.set("X-OWA-ActionName",t),(e||a)&&(a?c(e,i,a):c(e,i)),i}n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return b})),n.d(t,"b",(function(){return O})),n.d(t,"c",(function(){return f})),n.d(t,"f",(function(){return c})),n.d(t,"e",(function(){return m}))},2820:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(20),i=n(2763);n.d(t,"b",(function(){return i.a}));const c=new a.c(()=>n.e(1069).then(n.bind(null,3034))),r=new a.a(c,e=>e.getAndUpdateAccessToken)},2937:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o}));var a,i=n(52);function c(){const e=d();return s()&&e?a.ToDo:function(){var e;const t=Object(i.g)();return!(null===(e=t.SessionSettings)||void 0===e?void 0:e.IsShadowMailbox)}()&&!e?a.LegacyTasks:a.None}function r(){return s()&&d()}function o(){return s()&&d(!0)}function s(){var e,t;const n=Object(i.g)(),a=null===(e=n.SessionSettings)||void 0===e?void 0:e.IsExplicitLogon,c=null===(t=n.SessionSettings)||void 0===t?void 0:t.IsShadowMailbox;return!a&&!c}function d(e){const t=Object(i.g)(),n=t.UserOptions,a=t.PolicySettings;return!!((null==n?void 0:n.ReactOptinSettings)&&(n.ReactOptinSettings.TasksGraduatedFromBeta||n.ReactOptinSettings.TasksEnabled&&(e||function(e){var t;return(null===(t=null==e?void 0:e.ReactOptinSettings)||void 0===t?void 0:t.TasksShouldUseSharedToggle)?1!==e.ClientTypeOptInState:1!==e.TasksClientTypeOptInState}(n))&&function(e){if(e&&!1===e.OutlookBetaToggleEnabled)return!1;return!0}(a))&&null!==n.ReactOptinSettings.TasksRedirectUrl)}!function(e){e[e.None=0]="None",e[e.LegacyTasks=1]="LegacyTasks",e[e.ToDo=2]="ToDo"}(a||(a={}))},3215:function(e,t,n){"use strict";var a=n(2),i=n(52);const c=Object(a.action)("WORKLOAD_SCENARIO_SETTINGS_LOADED",(e,t)=>({settings:e,userIdentity:t})),r=Object(a.action)("LOADING_WORKLOAD_SCENARIO_SETTINGS_FAILED",e=>({userIdentity:e}));const o="ows/beta/ScenarioSettings",s=["IsTimePanelDatePickerExpanded","TimePanelCalendarIds","IsTimePanelCalendarViewTaskListSelected"];function d(e){switch(e){case 1:return"Mail";case 2:return"Calendar";case 64:return"FilesHub";case 4:return"People";default:throw new Error("getWorkloadScenarioType: The workload type is not supported")}}const u=71;var l=n(154);function b(e){return!!Object(l.a)("workloadScenarioSettings")&&0!=(e&u)}var f=n(625);function O(e){if(s.some(t=>t===e))return"Owa";const t=Object(f.c)();return b(t)?d(t):null}var p=n(2815),m=n(155);async function j(e){var t;const n=["Owa"],a=Object(f.c)();if(b(a)){const e=d(a);n.push(e)}const i=function(e){const t=e.join(",");return`${o}/?Scenarios=${t}`}(n),c=await Object(m.b)(i,void 0,void 0,await Object(p.b)(e),!0,void 0,"GET_WORKLOAD_SCENARIO_SETTINGS"),r={timePanelSelectedView:null,timePanelCalendarIds:[],timePanelSelectedCalendarView:null,isTimePanelOpen:!1,isTimePanelDatePickerExpanded:!1,isTimePanelCalendarViewTaskListSelected:!0};return null===(t=null==c?void 0:c.settings)||void 0===t||t.forEach(e=>{const t=O(e.settingName);!function(e){return!!e.calendarIds&&"TimePanelCalendarIds"===e.settingName}(e)||t!==O("TimePanelCalendarIds")?!function(e){return!!e.selectedView&&"TimePanelSelectedView"===e.settingName}(e)||t!==O("TimePanelSelectedView")?!function(e){return!!e.selectedView&&"SelectedCalendarListView"===e.settingName}(e)||t!==O("SelectedCalendarListView")?!function(e){return void 0!==e.isOpen&&"IsTimePanelOpen"===e.settingName}(e)||t!==O("IsTimePanelOpen")?!function(e){return void 0!==e.isExpanded&&"IsTimePanelDatePickerExpanded"===e.settingName}(e)||t!==O("IsTimePanelDatePickerExpanded")?function(e){return void 0!==e.isSelected&&"IsTimePanelCalendarViewTaskListSelected"===e.settingName}(e)&&t===O("IsTimePanelCalendarViewTaskListSelected")&&(r.isTimePanelCalendarViewTaskListSelected=e.isSelected):r.isTimePanelDatePickerExpanded=e.isExpanded:r.isTimePanelOpen=e.isOpen:r.timePanelSelectedCalendarView=e.selectedView:r.timePanelSelectedView=e.selectedView:r.timePanelCalendarIds=e.calendarIds}),r}var w=n(603);const S=Object(w.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(w.a)(1e3)}),T={};async function v(){const e=Object(i.d)().map(I);await Promise.all(e)}async function I(e){let t;try{if(T[e])return;T[e]=S(()=>j(e)),t=await T[e].retriableFunc(),c(t,e)}catch(t){r(e)}}var P=n(958);Object(a.orchestrator)(P.f,e=>{const{userIdentity:t}=e;I(t)});function h(e,t){return`${o}/${e}/${t}`}async function y(e){const t=O("TimePanelSelectedView");if(t){const n=h(t,"TimePanelSelectedView"),a={ViewType:e};await Object(m.d)(n,a,void 0,void 0,void 0,!0,void 0)}}async function k(e,t){const n=O("TimePanelCalendarIds");if(n){const a=h(n,"TimePanelCalendarIds"),i={CalendarIds:e};await Object(m.d)(a,i,void 0,void 0,await Object(p.b)(t),!0,void 0,"UpdateTimePanelCalendarIdsRequest")}}async function g(e){const t=O("IsTimePanelOpen");if(t){const n=h(t,"IsTimePanelOpen"),a={IsOpen:e};await Object(m.d)(n,a,void 0,void 0,void 0,!0,void 0)}}async function C(e){const t=O("SelectedCalendarListView");if(t){const n=h(t,"SelectedCalendarListView"),a={ViewType:e};await Object(m.d)(n,a,void 0,void 0,void 0,!0,void 0)}}async function x(e){const t=O("IsTimePanelDatePickerExpanded");if(t){const n=h(t,"IsTimePanelDatePickerExpanded"),a={isExpanded:e};await Object(m.d)(n,a,void 0,void 0,void 0,!0,void 0)}}async function E(e){const t=O("IsTimePanelCalendarViewTaskListSelected");if(t){const n=h(t,"IsTimePanelCalendarViewTaskListSelected"),a={isSelected:e};await Object(m.d)(n,a,void 0,void 0,void 0,!0,void 0)}}n.d(t,"i",(function(){return c})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return v})),n.d(t,"h",(function(){return y})),n.d(t,"g",(function(){return k})),n.d(t,"f",(function(){return g})),n.d(t,"e",(function(){return C})),n.d(t,"d",(function(){return x})),n.d(t,"c",(function(){return E}))},3217:function(e,t,n){"use strict";var a=n(2);const i=Object(a.action)("openTimePanel",e=>({source:e})),c=Object(a.action)("handleTimePanelClosed",(e,t,n,a)=>({source:e,sessionDuration:t,lastView:n,clientItemId:a})),r=Object(a.action)("popView");var o=n(483);function s(){return!Object(o.w)()||!window.opener}var d=n(3423);function u(){return s()&&Object(d.a)("Tasks")}n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return c})),n.d(t,"e",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return u}))},3320:function(e,t,n){"use strict";var a=n(2);const i=Object(a.action)("closeFlexPane",e=>({flexPaneId:e}));t.a=i},3404:function(e,t,n){"use strict";var a=n(3598),i=n(2937),c=n(625);let r={abovePanelHeight:a.b,initialPanelView:2===Object(c.c)()&&Object(i.c)()?"Tasks":"Calendar",initialCalendarView:"Agenda",areFREsDisabled:!1,isInlineComposeEnabled:()=>2!=Object(c.c)(),isClosePaneButtonEnabled:!1,isTasksViewDisabled:!1,isModuleDeeplinkDisabled:!1};function o(e){r=Object.assign({},e)}function s(){return r}n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}))},3423:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(3485),i=n(3404),c=n(2937);function r(e){return"Tasks"!==Object(a.a)(e)||Object(c.c)()&&!Object(i.a)().isTasksViewDisabled}},3485:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const a={Conflicts:"Calendar",EventDetails:"Calendar",AttendeeTracking:"Calendar",Calendar:"Calendar",ComposeForm:"Calendar",Tasks:"Tasks",TaskDetails:"Tasks"};function i(e){return e?a[e]:null}},3598:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));const a=48,i=65},3709:function(e,t,n){"use strict";function a(){return window.O365Shell}var i=n(2);var c=Object(i.action)("openFlexPane",e=>({flexPaneId:e}));Object(i.orchestrator)(c,e=>{const t=a();t&&t.FlexPane.OpenFlexPaneForProvider(e.flexPaneId)});var r=n(3320);Object(i.orchestrator)(r.a,e=>{const t=a();t&&t.FlexPane.CloseFlexPaneForProvider(e.flexPaneId)});function o(e){const t=a();t&&t.Theme.SetSearchActive(e)}function s(e,t){requestAnimationFrame(()=>a().Extensibility.SetCustomHeaderButtonBadgeValue(e,t))}function d(e,t){a().Extensibility.UpdateButtonState(e,t)}n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return d}))},3995:function(e,t,n){"use strict";var a=n(3404),i=n(2);const c=Object(i.createStore)("timePanelSettingStore",{panelViewStack:function(...e){return{stack:e||[]}}(Object(a.a)().initialPanelView)});var r=n(3423),o=n(3215),s=n(168);const d=Object(i.action)("pushTimePanelView",e=>({newView:e})),u=Object(i.action)("updateTopTimePanelView",e=>({updatedView:e})),l=Object(i.action)("popTimePanelView");function b(e){Object(r.a)(e)&&function(e,t){if(0===t.length)return null;t[t.length-1]=e}(e,c().panelViewStack.stack)}Object(i.mutator)(d,e=>{const{newView:t}=e;Object(r.a)(t)&&function(e,t){t.push(e)}(t,c().panelViewStack.stack)}),Object(i.mutator)(u,e=>b(e.updatedView)),Object(i.mutator)(l,()=>{const{panelViewStack:e}=c();!function(e){e.pop()}(e.stack)}),Object(i.mutator)(o.i,e=>{const{settings:t,userIdentity:n}=e;Object(s.d)().userIdentity===n&&t.timePanelSelectedView&&b(t.timePanelSelectedView)});var f=n(603),O=n(22);const p=Object(f.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(f.a)(1e3)});let m=null;Object(i.orchestrator)(u,async e=>{const{updatedView:t}=e;if(function(e){return"Tasks"===e||"Calendar"===e}(t)&&Object(r.a)(t)){try{m&&m.cancel(),m=p(()=>Object(o.h)(t)),await m.retriableFunc()}catch(e){O.h.warn(`viewStackOrchestrator: updateTimePanelSelectedViewService with retry failed: ${e}`)}m=null}});var j=n(3485);function w(){return Object(j.a)(S())}function S(){const{panelViewStack:e}=c();return 0===(t=e.stack).length?null:t[t.length-1];var t}function T(){const{panelViewStack:e}=c();return e.stack.length}function v(){const{panelViewStack:e}=c();return-1!==e.stack.indexOf("Conflicts")}function I(){const{panelViewStack:e}=c();return-1!==e.stack.indexOf("AttendeeTracking")}function P(){const{panelViewStack:e}=c();return T()>=2?e.stack[T()-2]:null}n.d(t,"j",(function(){return d})),n.d(t,"k",(function(){return u})),n.d(t,"i",(function(){return l})),n.d(t,"b",(function(){return w})),n.d(t,"a",(function(){return S})),n.d(t,"e",(function(){return T})),n.d(t,"g",(function(){return v})),n.d(t,"f",(function(){return I})),n.d(t,"d",(function(){return P})),n.d(t,"c",(function(){return j.a})),n.d(t,"h",(function(){return r.a}))},4705:function(e,t,n){"use strict";var a=n(2),i=n(66);const c=Object(a.action)("updateSelectedCalendarView",e=>({updatedView:e})),r=Object(a.action)("updateIsTaskListSelected",e=>Object(i.b)({name:"updateIsTaskListSelected",customData:{isSelected:e}},{isSelected:e})),o=Object(a.action)("updateIsDatePickerExpanded",e=>Object(i.b)({name:"updateIsDatePickerExpanded",customData:{isExpanded:e}},{isExpanded:e}));var s=n(52),d=n(3404);const u=Object(a.createStore)("calendarListSettingsStore",{selectedView:Object(d.a)().initialCalendarView,isDatePickerExpanded:Object(s.r)(),isTaskListSelected:!0});function l(){return u().selectedView}function b(){return u().isTaskListSelected}function f(){return u().isDatePickerExpanded}var O=n(3215),p=n(168);function m(e){u().isDatePickerExpanded=e}function j(e){u().isTaskListSelected=e}Object(a.mutator)(o,e=>m(e.isExpanded)),Object(a.mutator)(O.i,e=>{const{settings:t,userIdentity:n}=e;Object(p.d)().userIdentity===n&&null!==t.isTimePanelDatePickerExpanded&&void 0!==t.isTimePanelDatePickerExpanded&&m(e.settings.isTimePanelDatePickerExpanded)}),Object(a.mutator)(r,e=>j(e.isSelected)),Object(a.mutator)(O.i,e=>{const{settings:t,userIdentity:n}=e;Object(p.d)().userIdentity===n&&null!==t.isTimePanelCalendarViewTaskListSelected&&void 0!==t.isTimePanelCalendarViewTaskListSelected&&j(e.settings.isTimePanelCalendarViewTaskListSelected)});const w=Object(a.action)("updateSelectedCalendarViewInStore",e=>({updatedView:e}));Object(a.mutator)(w,e=>{const{updatedView:t}=e;u().selectedView=t});var S=n(603),T=n(22);const v=Object(S.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(S.a)(1e3)});let I=null;Object(a.orchestrator)(o,async e=>{const{isExpanded:t}=e;try{I&&I.cancel(),I=v(()=>Object(O.d)(t)),await I.retriableFunc()}catch(e){T.h.warn(`updateIsDatePickerExpandedOrchestrator: updateIsTimePanelDatePickerExpandedService with retry failed: ${e}`)}I=null});const P=Object(S.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(S.a)(1e3)});let h=null;Object(a.orchestrator)(r,async e=>{const{isSelected:t}=e;try{h&&h.cancel(),h=P(()=>Object(O.c)(t)),await h.retriableFunc()}catch(e){T.h.warn(`updateIsTaskListSelectedOrchestrator: updateIsTimePanelCalendarViewTaskListSelectedService with retry failed: ${e}`)}h=null});const y=Object(S.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(S.a)(1e3)});let k=null;Object(a.orchestrator)(c,async e=>{const{updatedView:t}=e;w(t);try{k&&k.cancel(),k=y(()=>Object(O.e)(t)),await k.retriableFunc()}catch(e){T.h.warn(`updateSelectedCalendarViewOrchestrator: updateSelectedCalendarView with retry failed: ${e}`)}k=null});Object(a.orchestrator)(O.i,e=>{const{settings:t,userIdentity:n}=e;Object(p.d)().userIdentity===n&&t.timePanelSelectedCalendarView&&w(t.timePanelSelectedCalendarView)});n.d(t,"f",(function(){return c})),n.d(t,"e",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return b})),n.d(t,"b",(function(){return f}))},5974:function(e,t,n){"use strict";var a=n(2);const i=Object(a.action)("UPDATE_SELECTED_TIME_PANEL_CALENDARIDS_IN_STORE",(e,t)=>({calendarIds:e,userIdentity:t})),c=Object(a.action)("SET_TIME_PANEL_CONFIG_LOAD_STATE",(e,t)=>({loadState:e,userIdentity:t})),r=Object(a.action)("UPDATE_SELECTED_TIME_PANEL_CALENDARIDS",(e,t)=>({calendarIds:e,userIdentity:t})),o=Object(a.action)("ON_SELECTED_TIME_PANEL_CALENDARIDS_UPDATED");var s;!function(e){e[e.Loaded=0]="Loaded",e[e.Failed=1]="Failed"}(s||(s={}));var d=n(3215);Object(a.orchestrator)(d.b,e=>{c(s.Failed,e.userIdentity),o()});var u=n(13);const l=Object(a.createStore)("timePanelSelectedCalendarIdsStore",{configLoadStates:new u.ObservableMap,calendarIdsMap:new u.ObservableMap});var b=n(2870);function f(){return Object(b.c)(l().calendarIdsMap)}function O(e){return e?function(e){const t=f().get(e);return t?t.length:0}(e):Object(b.d)(f()).length}function p(){return O()>0}var m=n(3124);Object(a.orchestrator)(m.h,()=>{p()||o()});function j(){return l().configLoadStates}var w=n(284),S=n(79),T=n(168);function v(){const e=j(),t=0===e.size,n=new u.ObservableMap;return t?n:([Object(T.d)().userIdentity,...Object(w.n)().map(e=>e.userIdentity)].forEach(t=>{if(p()&&e.get(t)!==s.Failed)n.set(t,f().get(t));else if(Object(m.c)()>0)n.set(t,Object(m.b)().get(t));else{const e=Object(S.x)(t);e&&n.set(t,[e.calendarId.id])}}),n)}var I=n(603),P=n(52),h=n(22);const y=Object(I.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(I.a)(1e3)});let k={};Object(a.orchestrator)(r,async e=>{const{calendarIds:t,userIdentity:n}=e;Object(T.d)().userIdentity===n&&1===O()&&1===O(n)&&0===t.length||(p()||await async function(){await Promise.all(Object(P.d)().map(e=>{var t;let n=null!==(t=Object(m.b)().get(e))&&void 0!==t?t:[];if(0===Object(m.c)()){const t=Object(S.x)(e);t&&(n=[t.calendarId.id])}C(n,e,!0)}))}(),C(t,n))});const g=1e3;async function C(e,t,n){var a;const c=Object(b.b)(e),r=v().get(t);try{i(c,t),n||o(),null===(a=k[t])||void 0===a||a.cancel();let e=y(()=>Object(d.g)(c,t));const r=function(e,t){let n=!1;return{delayFunc:()=>new Promise((a,i)=>((a,i)=>{setTimeout(()=>{if(!n)return e(),a()},t)})(a)),cancel:()=>n=!0}}(e.retriableFunc,g),s={cancel:()=>{r.cancel(),e.cancel()},updateFunc:r.delayFunc};k[t]=s,await s.updateFunc()}catch(e){h.h.warn(`updateSelectedCalendarIdsOrchestrator: updateTimePanelCalendarIdsService with retry failed: ${e}`),i(r,t),n||o()}finally{delete k[t]}}var x=n(3115),E=n(3018);Object(a.orchestrator)(d.i,async e=>{var t;const{settings:n,userIdentity:a}=e;if(c(s.Loaded,a),(null===(t=n.timePanelCalendarIds)||void 0===t?void 0:t.length)>0)if(Object(E.c)(n.timePanelCalendarIds,a)){const e=await Object(x.b)(n.timePanelCalendarIds,Object(E.b)(a),a,x.a.MyDay);r(e,a)}else i(n.timePanelCalendarIds,a);o()}),Object(a.mutator)(c,e=>{const{userIdentity:t,loadState:n}=e;l().configLoadStates.set(t,n)}),Object(a.mutator)(i,e=>{const{calendarIds:t,userIdentity:n}=e;l().calendarIdsMap.set(n,Object(b.b)(t))});function A(){return Object(b.d)(v())}n.d(t,"e",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return j})),n.d(t,"c",(function(){return v})),n.d(t,"b",(function(){return A}))},6852:function(e,t,n){"use strict";var a=n(2),i=Object(a.action)("DEACTIVATE_CHARM",(function(e){return{charm:e}})),c=Object(a.createStore)("headerViewState",{activeCharm:null});Object(a.mutator)(i,e=>{const t=e.charm,n=c();n.activeCharm===t&&(n.activeCharm=null)});var r=Object(a.action)("TOGGLE_CHARM",(function(e){return{charm:e}}));function o(){return c().activeCharm}Object(a.mutator)(r,e=>{const t=e.charm,n=c();n.activeCharm===t?n.activeCharm=null:n.activeCharm=t}),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r}))}}]);
//# sourceMappingURL=owa.856.js.map
self.scriptsLoaded['owa.856.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.856.js'] = (new Date()).getTime();