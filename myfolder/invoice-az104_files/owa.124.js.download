self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.124.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[124],{11503:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Constants=void 0;var i=function(){function e(){}return e.keys={tab:"Tab",enter:"Enter",escape:"Escape",space:" ",up:"ArrowUp",down:"ArrowDown",delete:"Delete"},e}();t.Constants=i},12946:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CardObjectRegistry=void 0;var i=n(7870),r=function(){function e(){this._items={}}return e.prototype.findByName=function(e){return this._items.hasOwnProperty(e)?this._items[e]:void 0},e.prototype.clear=function(){this._items={}},e.prototype.register=function(e,t,n){void 0===n&&(n=i.Versions.v1_0);var r=this.findByName(e);void 0!==r?r.objectType=t:r={typeName:e,objectType:t,schemaVersion:n},this._items[e]=r},e.prototype.unregister=function(e){delete this._items[e]},e.prototype.createInstance=function(e,t){var n=this.findByName(e);return n&&n.schemaVersion.compareTo(t)<=0?new n.objectType:void 0},e.prototype.getItemCount=function(){return Object.keys(this._items).length},e.prototype.getItemAt=function(e){var t=this;return Object.keys(this._items).map((function(e){return t._items[e]}))[e]},e}();t.CardObjectRegistry=r},12947:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.CardObject=t.ValidationResults=void 0;var a=n(6800),s=n(8898),l=n(7388),p=n(12948),u=n(7870),c=function(){function e(){this.allIds={},this.validationEvents=[]}return e.prototype.addFailure=function(e,t,n){this.validationEvents.push({phase:a.ValidationPhase.Validation,source:e,event:t,message:n})},e}();t.ValidationResults=c;var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._shouldFallback=!1,t}return r(t,e),t.prototype.getSchemaKey=function(){return this.getJsonTypeName()},Object.defineProperty(t.prototype,"requires",{get:function(){return this.getValue(t.requiresProperty)},enumerable:!1,configurable:!0}),t.prototype.contains=function(e){return!!this._renderedElement&&this._renderedElement.contains(e)},t.prototype.preProcessPropertyValue=function(e,t){var n=void 0===t?this.getValue(e):t;if(l.GlobalSettings.allowPreProcessingPropertyValues){for(var i=this;i&&!i.onPreProcessPropertyValue;)i=i.parent;if(i&&i.onPreProcessPropertyValue)return i.onPreProcessPropertyValue(this,e,n)}return n},t.prototype.setParent=function(e){this._parent=e},t.prototype.setShouldFallback=function(e){this._shouldFallback=e},t.prototype.shouldFallback=function(){return this._shouldFallback||!this.requires.areAllMet(this.hostConfig.hostCapabilities)},t.prototype.getRootObject=function(){for(var e=this;e.parent;)e=e.parent;return e},t.prototype.internalValidateProperties=function(e){this.id&&(e.allIds.hasOwnProperty(this.id)?(1==e.allIds[this.id]&&e.addFailure(this,a.ValidationEvent.DuplicateId,s.Strings.errors.duplicateId(this.id)),e.allIds[this.id]+=1):e.allIds[this.id]=1)},t.prototype.validateProperties=function(){var e=new c;return this.internalValidateProperties(e),e},t.prototype.findDOMNodeOwner=function(e){return this.contains(e)?this:void 0},Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderedElement",{get:function(){return this._renderedElement},enumerable:!1,configurable:!0}),t.typeNameProperty=new u.StringProperty(u.Versions.v1_0,"type",void 0,void 0,void 0,(function(e){return e.getJsonTypeName()})),t.idProperty=new u.StringProperty(u.Versions.v1_0,"id"),t.requiresProperty=new u.SerializableObjectProperty(u.Versions.v1_2,"requires",p.HostCapabilities,!1,new p.HostCapabilities),o([u.property(t.idProperty)],t.prototype,"id",void 0),o([u.property(t.requiresProperty)],t.prototype,"requires",null),t}(u.SerializableObject);t.CardObject=h},12948:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.HostCapabilities=void 0;var o=n(7870),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._capabilities={},t}return r(t,e),t.prototype.getSchemaKey=function(){return"HostCapabilities"},t.prototype.internalParse=function(t,n){if(e.prototype.internalParse.call(this,t,n),t)for(var i in t){var r=t[i];if("string"==typeof r)if("*"==r)this.addCapability(i,"*");else{var a=o.Version.parse(r,n);a&&a.isValid&&this.addCapability(i,a)}}},t.prototype.internalToJSON=function(t,n){for(var i in e.prototype.internalToJSON.call(this,t,n),this._capabilities)t[i]=this._capabilities[i]},t.prototype.addCapability=function(e,t){this._capabilities[e]=t},t.prototype.removeCapability=function(e){delete this._capabilities[e]},t.prototype.clear=function(){this._capabilities={}},t.prototype.hasCapability=function(e,t){return!!this._capabilities.hasOwnProperty(e)&&("*"==t||"*"==this._capabilities[e]||t.compareTo(this._capabilities[e])<=0)},t.prototype.areAllMet=function(e){for(var t in this._capabilities)if(!e.hasCapability(t,this._capabilities[t]))return!1;return!0},t}(o.SerializableObject);t.HostCapabilities=a},12949:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};Object.defineProperty(t,"__esModule",{value:!0}),t.SerializationContext=t.GlobalRegistry=t.AdaptiveCard=t.Authentication=t.TokenExchangeResource=t.AuthCardButton=t.RefreshDefinition=t.RefreshActionProperty=t.ContainerWithActions=t.ColumnSet=t.Column=t.Container=t.BackgroundImage=t.StylableCardElementContainer=t.ActionSet=t.ShowCardAction=t.HttpAction=t.HttpHeader=t.ToggleVisibilityAction=t.OpenUrlAction=t.ExecuteAction=t.SubmitAction=t.SubmitActionBase=t.Action=t.TimeInput=t.TimeProperty=t.DateInput=t.NumberInput=t.ChoiceSetInput=t.Choice=t.ToggleInput=t.TextInput=t.Input=t.Media=t.MediaSource=t.ImageSet=t.CardElementContainer=t.Image=t.FactSet=t.Fact=t.RichTextBlock=t.TextRun=t.TextBlock=t.BaseTextBlock=t.ActionProperty=t.CardElement=void 0;var a=n(6800),s=n(7388),l=n(7871),p=n(9705),u=n(17983),c=n(12947),h=n(7870),d=n(12946),f=n(8898),y=n(17984),g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._truncatedDueToOverflow=!1,t}return r(t,e),Object.defineProperty(t.prototype,"lang",{get:function(){var e=this.getValue(t.langProperty);return e||(this.parent?this.parent.lang:void 0)},set:function(e){this.setValue(t.langProperty,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isVisible",{get:function(){return this.getValue(t.isVisibleProperty)},set:function(e){s.GlobalSettings.useAdvancedCardBottomTruncation&&!e&&this.undoOverflowTruncation(),this.isVisible!==e&&(this.setValue(t.isVisibleProperty,e),this.updateRenderedElementVisibility(),this._renderedElement&&se(this)),this._renderedElement&&this._renderedElement.setAttribute("aria-expanded",e.toString())},enumerable:!1,configurable:!0}),t.prototype.internalRenderSeparator=function(){var e=l.renderSeparation(this.hostConfig,{spacing:this.hostConfig.getEffectiveSpacing(this.spacing),lineThickness:this.separator?this.hostConfig.separator.lineThickness:void 0,lineColor:this.separator?this.hostConfig.separator.lineColor:void 0},this.separatorOrientation);if(s.GlobalSettings.alwaysBleedSeparators&&e&&this.separatorOrientation==a.Orientation.Horizontal){var t=this.getParentContainer();if(t&&t.getEffectivePadding()){var n=this.hostConfig.paddingDefinitionToSpacingDefinition(t.getEffectivePadding());e.style.marginLeft="-"+n.left+"px",e.style.marginRight="-"+n.right+"px"}}return e},t.prototype.updateRenderedElementVisibility=function(){var e=this.isDesignMode()||this.isVisible?this._defaultRenderedElementDisplayMode:"none";this._renderedElement&&(e?this._renderedElement.style.display=e:this._renderedElement.style.removeProperty("display")),this._separatorElement&&(this.parent&&this.parent.isFirstElement(this)?this._separatorElement.style.display="none":e?this._separatorElement.style.display=e:this._separatorElement.style.removeProperty("display"))},t.prototype.hideElementDueToOverflow=function(){this._renderedElement&&this.isVisible&&(this._renderedElement.style.visibility="hidden",this.isVisible=!1,se(this,!1))},t.prototype.showElementHiddenDueToOverflow=function(){this._renderedElement&&!this.isVisible&&(this._renderedElement.style.removeProperty("visibility"),this.isVisible=!0,se(this,!1))},t.prototype.handleOverflow=function(e){if(this.isVisible||this.isHiddenDueToOverflow()){var t=this.truncateOverflow(e);this._truncatedDueToOverflow=t||this._truncatedDueToOverflow,t?t&&!this.isVisible&&this.showElementHiddenDueToOverflow():this.hideElementDueToOverflow()}},t.prototype.resetOverflow=function(){var e=!1;return this._truncatedDueToOverflow&&(this.undoOverflowTruncation(),this._truncatedDueToOverflow=!1,e=!0),this.isHiddenDueToOverflow()&&this.showElementHiddenDueToOverflow(),e},t.prototype.getDefaultSerializationContext=function(){return new me},t.prototype.createPlaceholderElement=function(){var e=this.getEffectiveStyleDefinition(),t=l.stringToCssColor(e.foregroundColors.default.subtle),n=document.createElement("div");return n.style.border="1px dashed "+t,n.style.padding="4px",n.style.minHeight="32px",n.style.fontSize="10px",n.style.color=t,n.innerText="Empty "+this.getJsonTypeName(),n},t.prototype.adjustRenderedElementSize=function(e){"auto"===this.height?e.style.flex="0 0 auto":e.style.flex="1 1 auto"},t.prototype.isDisplayed=function(){return void 0!==this._renderedElement&&this.isVisible&&this._renderedElement.offsetHeight>0},t.prototype.overrideInternalRender=function(){return this.internalRender()},t.prototype.applyPadding=function(){if(this.separatorElement&&this.separatorOrientation===a.Orientation.Horizontal)if(s.GlobalSettings.alwaysBleedSeparators&&!this.isBleeding()){var e=new s.PaddingDefinition;this.getImmediateSurroundingPadding(e);var t=this.hostConfig.paddingDefinitionToSpacingDefinition(e);this.separatorElement.style.marginLeft="-"+t.left+"px",this.separatorElement.style.marginRight="-"+t.right+"px"}else this.separatorElement.style.marginRight="0",this.separatorElement.style.marginLeft="0"},t.prototype.truncateOverflow=function(e){return!1},t.prototype.undoOverflowTruncation=function(){},t.prototype.getDefaultPadding=function(){return new s.PaddingDefinition},t.prototype.getHasBackground=function(){return!1},t.prototype.getPadding=function(){return this._padding},t.prototype.setPadding=function(e){this._padding=e},t.prototype.shouldSerialize=function(e){return void 0!==e.elementRegistry.findByName(this.getJsonTypeName())},Object.defineProperty(t.prototype,"useDefaultSizing",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowCustomPadding",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"separatorOrientation",{get:function(){return a.Orientation.Horizontal},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"defaultStyle",{get:function(){return a.ContainerStyle.Default},enumerable:!1,configurable:!0}),t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n||new me)},t.prototype.asString=function(){return""},t.prototype.isBleeding=function(){return!1},t.prototype.getEffectiveStyle=function(){return this.parent?this.parent.getEffectiveStyle():this.defaultStyle},t.prototype.getEffectiveStyleDefinition=function(){return this.hostConfig.containerStyles.getStyleByName(this.getEffectiveStyle())},t.prototype.getEffectiveTextStyleDefinition=function(){return this.parent?this.parent.getEffectiveTextStyleDefinition():this.hostConfig.textStyles.default},t.prototype.getForbiddenActionTypes=function(){return[]},t.prototype.getImmediateSurroundingPadding=function(e,t,n,i,r){if(void 0===t&&(t=!0),void 0===n&&(n=!0),void 0===i&&(i=!0),void 0===r&&(r=!0),this.parent){var o=t&&this.parent.isTopElement(this),s=n&&this.parent.isRightMostElement(this),l=i&&this.parent.isBottomElement(this),p=r&&this.parent.isLeftMostElement(this),u=this.parent.getEffectivePadding();u&&(o&&u.top!=a.Spacing.None&&(e.top=u.top,o=!1),s&&u.right!=a.Spacing.None&&(e.right=u.right,s=!1),l&&u.bottom!=a.Spacing.None&&(e.bottom=u.bottom,l=!1),p&&u.left!=a.Spacing.None&&(e.left=u.left,p=!1)),(o||s||l||p)&&this.parent.getImmediateSurroundingPadding(e,o,s,l,p)}},t.prototype.getActionCount=function(){return 0},t.prototype.getActionAt=function(e){throw new Error(f.Strings.errors.indexOutOfRange(e))},t.prototype.remove=function(){return!!(this.parent&&this.parent instanceof w)&&this.parent.removeItem(this)},t.prototype.render=function(){return this._renderedElement=this.overrideInternalRender(),this._separatorElement=this.internalRenderSeparator(),this._renderedElement?(this.id&&(this._renderedElement.id=this.id),this.customCssSelector&&this._renderedElement.classList.add(this.customCssSelector),this._renderedElement.style.boxSizing="border-box",this._defaultRenderedElementDisplayMode=this._renderedElement.style.display?this._renderedElement.style.display:void 0,this.adjustRenderedElementSize(this._renderedElement),this.updateLayout(!1)):this.isDesignMode()&&(this._renderedElement=this.createPlaceholderElement()),this._renderedElement},t.prototype.updateLayout=function(e){void 0===e&&(e=!0),this.updateRenderedElementVisibility(),this.applyPadding()},t.prototype.indexOf=function(e){return-1},t.prototype.isDesignMode=function(){var e=this.getRootElement();return e instanceof fe&&e.designMode},t.prototype.isFirstElement=function(e){return!0},t.prototype.isLastElement=function(e){return!0},t.prototype.isAtTheVeryLeft=function(){return!this.parent||this.parent.isLeftMostElement(this)&&this.parent.isAtTheVeryLeft()},t.prototype.isAtTheVeryRight=function(){return!this.parent||this.parent.isRightMostElement(this)&&this.parent.isAtTheVeryRight()},t.prototype.isAtTheVeryTop=function(){return!this.parent||this.parent.isFirstElement(this)&&this.parent.isAtTheVeryTop()},t.prototype.isAtTheVeryBottom=function(){return!this.parent||this.parent.isLastElement(this)&&this.parent.isAtTheVeryBottom()},t.prototype.isBleedingAtTop=function(){return!1},t.prototype.isBleedingAtBottom=function(){return!1},t.prototype.isLeftMostElement=function(e){return!0},t.prototype.isRightMostElement=function(e){return!0},t.prototype.isTopElement=function(e){return this.isFirstElement(e)},t.prototype.isBottomElement=function(e){return this.isLastElement(e)},t.prototype.isHiddenDueToOverflow=function(){return void 0!==this._renderedElement&&"hidden"==this._renderedElement.style.visibility},t.prototype.getRootElement=function(){return this.getRootObject()},t.prototype.getParentContainer=function(){for(var e=this.parent;e;){if(e instanceof te)return e;e=e.parent}},t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),[]},t.prototype.getResourceInformation=function(){return[]},t.prototype.getElementById=function(e){return this.id===e?this:void 0},t.prototype.getActionById=function(e){},t.prototype.getEffectivePadding=function(){var e=this.getPadding();return e&&this.allowCustomPadding?e:this.getDefaultPadding()},Object.defineProperty(t.prototype,"hostConfig",{get:function(){return this._hostConfig?this._hostConfig:this.parent?this.parent.hostConfig:p.defaultHostConfig},set:function(e){this._hostConfig=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"index",{get:function(){return this.parent?this.parent.indexOf(this):0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInteractive",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInline",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){return!(!this.parent||!this.separatorElement)&&(!this.parent.isFirstElement(this)&&(this.isVisible||this.isDesignMode()))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"separatorElement",{get:function(){return this._separatorElement},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),t.langProperty=new h.StringProperty(h.Versions.v1_1,"lang",!0,/^[a-z]{2,3}$/gi),t.isVisibleProperty=new h.BoolProperty(h.Versions.v1_2,"isVisible",!0),t.separatorProperty=new h.BoolProperty(h.Versions.v1_0,"separator",!1),t.heightProperty=new h.ValueSetProperty(h.Versions.v1_1,"height",[{value:"auto"},{value:"stretch"}],"auto"),t.horizontalAlignmentProperty=new h.EnumProperty(h.Versions.v1_0,"horizontalAlignment",a.HorizontalAlignment,a.HorizontalAlignment.Left),t.spacingProperty=new h.EnumProperty(h.Versions.v1_0,"spacing",a.Spacing,a.Spacing.Default),o([h.property(t.horizontalAlignmentProperty)],t.prototype,"horizontalAlignment",void 0),o([h.property(t.spacingProperty)],t.prototype,"spacing",void 0),o([h.property(t.separatorProperty)],t.prototype,"separator",void 0),o([h.property(t.heightProperty)],t.prototype,"height",void 0),o([h.property(t.langProperty)],t.prototype,"lang",null),o([h.property(t.isVisibleProperty)],t.prototype,"isVisible",null),t}(c.CardObject);t.CardElement=g;var m=function(e){function t(t,n,i){void 0===i&&(i=[]);var r=e.call(this,t,n,void 0)||this;return r.targetVersion=t,r.name=n,r.forbiddenActionTypes=i,r}return r(t,e),t.prototype.parse=function(e,t,n){var i=e;return n.parseAction(i,t[this.name],this.forbiddenActionTypes,i.isDesignMode())},t.prototype.toJSON=function(e,t,n,i){i.serializeValue(t,this.name,n?n.toJSON(i):void 0,void 0,!0)},t}(h.PropertyDefinition);t.ActionProperty=m;var v=function(e){function t(t){var n=e.call(this)||this;return n.ariaHidden=!1,t&&(n.text=t),n}return r(t,e),t.prototype.populateSchema=function(n){e.prototype.populateSchema.call(this,n),n.remove(t.selectActionProperty)},Object.defineProperty(t.prototype,"text",{get:function(){return this.getValue(t.textProperty)},set:function(e){this.setText(e)},enumerable:!1,configurable:!0}),t.prototype.getFontSize=function(e){switch(this.effectiveSize){case a.TextSize.Small:return e.fontSizes.small;case a.TextSize.Medium:return e.fontSizes.medium;case a.TextSize.Large:return e.fontSizes.large;case a.TextSize.ExtraLarge:return e.fontSizes.extraLarge;default:return e.fontSizes.default}},t.prototype.getColorDefinition=function(e,t){switch(t){case a.TextColor.Accent:return e.accent;case a.TextColor.Dark:return e.dark;case a.TextColor.Light:return e.light;case a.TextColor.Good:return e.good;case a.TextColor.Warning:return e.warning;case a.TextColor.Attention:return e.attention;default:return e.default}},t.prototype.setText=function(e){this.setValue(t.textProperty,e)},t.prototype.init=function(e){this.size=e.size,this.weight=e.weight,this.color=e.color,this.isSubtle=e.isSubtle},t.prototype.asString=function(){return this.text},t.prototype.applyStylesTo=function(e){var t,n=this.hostConfig.getFontTypeDefinition(this.effectiveFontType);switch(n.fontFamily&&(e.style.fontFamily=n.fontFamily),this.effectiveSize){case a.TextSize.Small:t=n.fontSizes.small;break;case a.TextSize.Medium:t=n.fontSizes.medium;break;case a.TextSize.Large:t=n.fontSizes.large;break;case a.TextSize.ExtraLarge:t=n.fontSizes.extraLarge;break;default:t=n.fontSizes.default}e.style.fontSize=t+"px";var i,r=this.getColorDefinition(this.getEffectiveStyleDefinition().foregroundColors,this.effectiveColor);switch(e.style.color=l.stringToCssColor(this.effectiveIsSubtle?r.subtle:r.default),this.effectiveWeight){case a.TextWeight.Lighter:i=n.fontWeights.lighter;break;case a.TextWeight.Bolder:i=n.fontWeights.bolder;break;default:i=n.fontWeights.default}e.style.fontWeight=i.toString(),this.ariaHidden&&e.setAttribute("aria-hidden","true")},Object.defineProperty(t.prototype,"effectiveColor",{get:function(){return void 0!==this.color?this.color:this.getEffectiveTextStyleDefinition().color},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"effectiveFontType",{get:function(){return void 0!==this.fontType?this.fontType:this.getEffectiveTextStyleDefinition().fontType},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"effectiveIsSubtle",{get:function(){return void 0!==this.isSubtle?this.isSubtle:this.getEffectiveTextStyleDefinition().isSubtle},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"effectiveSize",{get:function(){return void 0!==this.size?this.size:this.getEffectiveTextStyleDefinition().size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"effectiveWeight",{get:function(){return void 0!==this.weight?this.weight:this.getEffectiveTextStyleDefinition().weight},enumerable:!1,configurable:!0}),t.textProperty=new h.StringProperty(h.Versions.v1_0,"text",!0),t.sizeProperty=new h.EnumProperty(h.Versions.v1_0,"size",a.TextSize),t.weightProperty=new h.EnumProperty(h.Versions.v1_0,"weight",a.TextWeight),t.colorProperty=new h.EnumProperty(h.Versions.v1_0,"color",a.TextColor),t.isSubtleProperty=new h.BoolProperty(h.Versions.v1_0,"isSubtle"),t.fontTypeProperty=new h.EnumProperty(h.Versions.v1_2,"fontType",a.FontType),t.selectActionProperty=new m(h.Versions.v1_1,"selectAction",["Action.ShowCard"]),o([h.property(t.sizeProperty)],t.prototype,"size",void 0),o([h.property(t.weightProperty)],t.prototype,"weight",void 0),o([h.property(t.colorProperty)],t.prototype,"color",void 0),o([h.property(t.fontTypeProperty)],t.prototype,"fontType",void 0),o([h.property(t.isSubtleProperty)],t.prototype,"isSubtle",void 0),o([h.property(t.textProperty)],t.prototype,"text",null),o([h.property(t.selectActionProperty)],t.prototype,"selectAction",void 0),t}(g);t.BaseTextBlock=v;var b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.wrap=!1,t._treatAsPlainText=!0,t.useMarkdown=!0,t}return r(t,e),t.prototype.restoreOriginalContent=function(){void 0!==this.renderedElement&&(this.maxLines&&this.maxLines>0&&(this.renderedElement.style.maxHeight=this._computedLineHeight*this.maxLines+"px"),this.renderedElement.innerHTML=this._originalInnerHtml)},t.prototype.truncateIfSupported=function(e){if(void 0!==this.renderedElement){var t=this.renderedElement.children,n=!t.length;if(n||1==t.length&&"p"==t[0].tagName.toLowerCase()){var i=n?this.renderedElement:t[0];return l.truncate(i,e,this._computedLineHeight),!0}}return!1},t.prototype.setText=function(t){e.prototype.setText.call(this,t),this._processedText=void 0},t.prototype.internalRender=function(){var e=this;if(this._processedText=void 0,this.text){var t=this.preProcessPropertyValue(v.textProperty),n=this.hostConfig,i=void 0;if(this.forElementId){var r=document.createElement("label");r.htmlFor=this.forElementId,i=r}else i=document.createElement("div");if(i.classList.add(n.makeCssClassName("ac-textBlock")),i.style.overflow="hidden",this.applyStylesTo(i),"heading"===this.style){i.setAttribute("role","heading");var o=this.hostConfig.textBlock.headingLevel;void 0!==o&&o>0&&i.setAttribute("aria-level",o.toString())}if(this.selectAction&&n.supportsInteractivity&&(i.onclick=function(t){t.preventDefault(),t.cancelBubble=!0,e.selectAction&&e.selectAction.execute()},this.selectAction.setupElementForAccessibility(i),i.classList.add(n.makeCssClassName("ac-selectable"))),!this._processedText){this._treatAsPlainText=!0;var a=u.formatText(this.lang,t);if(this.useMarkdown&&a){s.GlobalSettings.allowMarkForTextHighlighting&&(a=a.replace(/<mark>/g,"===").replace(/<\/mark>/g,"/==/"));var p=fe.applyMarkdown(a);if(p.didProcess&&p.outputHtml){if(this._processedText=p.outputHtml,this._treatAsPlainText=!1,s.GlobalSettings.allowMarkForTextHighlighting&&this._processedText){var c="",h=this.getEffectiveStyleDefinition();h.highlightBackgroundColor&&(c+="background-color: "+h.highlightBackgroundColor+";"),h.highlightForegroundColor&&(c+="color: "+h.highlightForegroundColor+";"),c&&(c='style="'+c+'"'),this._processedText=this._processedText.replace(/===/g,"<mark "+c+">").replace(/\/==\//g,"</mark>")}}else this._processedText=a,this._treatAsPlainText=!0}else this._processedText=a,this._treatAsPlainText=!0}if(this._processedText||(this._processedText=""),this._treatAsPlainText?i.innerText=this._processedText:i.innerHTML=this._processedText,i.firstElementChild instanceof HTMLElement){var d=i.firstElementChild;d.style.marginTop="0px",d.style.width="100%",this.wrap||(d.style.overflow="hidden",d.style.textOverflow="ellipsis")}i.lastElementChild instanceof HTMLElement&&(i.lastElementChild.style.marginBottom="0px");for(var f=i.getElementsByTagName("a"),y=0;y<f.length;y++){var g=f[y];g.classList.add(n.makeCssClassName("ac-anchor")),g.target="_blank",g.onclick=function(t){oe(e,t.target,t)&&(t.preventDefault(),t.cancelBubble=!0)},g.oncontextmenu=function(t){return!oe(e,t.target,t)||(t.preventDefault(),t.cancelBubble=!0,!1)}}return this.wrap?(i.style.wordWrap="break-word",this.maxLines&&this.maxLines>0&&(i.style.overflow="hidden",l.isInternetExplorer()||!s.GlobalSettings.useWebkitLineClamp?i.style.maxHeight=this._computedLineHeight*this.maxLines+"px":(i.style.removeProperty("line-height"),i.style.display="-webkit-box",i.style.webkitBoxOrient="vertical",i.style.webkitLineClamp=this.maxLines.toString()))):(i.style.whiteSpace="nowrap",i.style.textOverflow="ellipsis"),(s.GlobalSettings.useAdvancedTextBlockTruncation||s.GlobalSettings.useAdvancedCardBottomTruncation)&&(this._originalInnerHtml=i.innerHTML),i}},t.prototype.truncateOverflow=function(e){return e>=this._computedLineHeight&&this.truncateIfSupported(e)},t.prototype.undoOverflowTruncation=function(){if(this.restoreOriginalContent(),s.GlobalSettings.useAdvancedTextBlockTruncation&&this.maxLines){var e=this._computedLineHeight*this.maxLines;this.truncateIfSupported(e)}},t.prototype.applyStylesTo=function(t){switch(e.prototype.applyStylesTo.call(this,t),this.horizontalAlignment){case a.HorizontalAlignment.Center:t.style.textAlign="center";break;case a.HorizontalAlignment.Right:t.style.textAlign="end";break;default:t.style.textAlign="start"}var n=this.hostConfig.lineHeights;if(n)switch(this.effectiveSize){case a.TextSize.Small:this._computedLineHeight=n.small;break;case a.TextSize.Medium:this._computedLineHeight=n.medium;break;case a.TextSize.Large:this._computedLineHeight=n.large;break;case a.TextSize.ExtraLarge:this._computedLineHeight=n.extraLarge;break;default:this._computedLineHeight=n.default}else this._computedLineHeight=1.33*this.getFontSize(this.hostConfig.getFontTypeDefinition(this.effectiveFontType));t.style.lineHeight=this._computedLineHeight+"px"},t.prototype.getJsonTypeName=function(){return"TextBlock"},t.prototype.getEffectiveTextStyleDefinition=function(){return this.style?this.hostConfig.textStyles.getStyleByName(this.style):e.prototype.getEffectiveTextStyleDefinition.call(this)},t.prototype.updateLayout=function(t){void 0===t&&(t=!1),e.prototype.updateLayout.call(this,t),s.GlobalSettings.useAdvancedTextBlockTruncation&&this.maxLines&&this.isDisplayed()&&(this.restoreOriginalContent(),this.truncateIfSupported(this._computedLineHeight*this.maxLines))},t.wrapProperty=new h.BoolProperty(h.Versions.v1_0,"wrap",!1),t.maxLinesProperty=new h.NumProperty(h.Versions.v1_0,"maxLines"),t.styleProperty=new h.ValueSetProperty(h.Versions.v1_5,"style",[{value:"default"},{value:"heading"}]),o([h.property(t.wrapProperty)],t.prototype,"wrap",void 0),o([h.property(t.maxLinesProperty)],t.prototype,"maxLines",void 0),o([h.property(t.styleProperty)],t.prototype,"style",void 0),t}(v);t.TextBlock=b;var C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.italic=!1,t.strikethrough=!1,t.highlight=!1,t.underline=!1,t}return r(t,e),t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t),t.add(v.selectActionProperty)},t.prototype.internalRender=function(){var e=this;if(this.text){var t=this.preProcessPropertyValue(v.textProperty),n=this.hostConfig,i=u.formatText(this.lang,t);i||(i="");var r=document.createElement("span");if(r.classList.add(n.makeCssClassName("ac-textRun")),this.applyStylesTo(r),this.selectAction&&n.supportsInteractivity){var o=document.createElement("a");o.classList.add(n.makeCssClassName("ac-anchor"));var a=this.selectAction.getHref();o.href=a||"",o.target="_blank",o.onclick=function(t){t.preventDefault(),t.cancelBubble=!0,e.selectAction&&e.selectAction.execute()},this.selectAction.setupElementForAccessibility(o),o.innerText=i,r.appendChild(o)}else r.innerText=i;return r}},t.prototype.applyStylesTo=function(t){if(e.prototype.applyStylesTo.call(this,t),this.italic&&(t.style.fontStyle="italic"),this.strikethrough&&(t.style.textDecoration="line-through"),this.highlight){var n=this.getColorDefinition(this.getEffectiveStyleDefinition().foregroundColors,this.effectiveColor);t.style.backgroundColor=l.stringToCssColor(this.effectiveIsSubtle?n.highlightColors.subtle:n.highlightColors.default)}this.underline&&(t.style.textDecoration="underline")},t.prototype.getJsonTypeName=function(){return"TextRun"},Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInline",{get:function(){return!0},enumerable:!1,configurable:!0}),t.italicProperty=new h.BoolProperty(h.Versions.v1_2,"italic",!1),t.strikethroughProperty=new h.BoolProperty(h.Versions.v1_2,"strikethrough",!1),t.highlightProperty=new h.BoolProperty(h.Versions.v1_2,"highlight",!1),t.underlineProperty=new h.BoolProperty(h.Versions.v1_3,"underline",!1),o([h.property(t.italicProperty)],t.prototype,"italic",void 0),o([h.property(t.strikethroughProperty)],t.prototype,"strikethrough",void 0),o([h.property(t.highlightProperty)],t.prototype,"highlight",void 0),o([h.property(t.underlineProperty)],t.prototype,"underline",void 0),t}(v);t.TextRun=C;var S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._inlines=[],t}return r(t,e),t.prototype.internalAddInline=function(e,t){if(void 0===t&&(t=!1),!e.isInline)throw new Error(f.Strings.errors.elementCannotBeUsedAsInline());if(!(void 0===e.parent||t)&&e.parent!=this)throw new Error(f.Strings.errors.inlineAlreadyParented());e.setParent(this),this._inlines.push(e)},t.prototype.internalParse=function(t,n){if(e.prototype.internalParse.call(this,t,n),this._inlines=[],Array.isArray(t.inlines))for(var i=0,r=t.inlines;i<r.length;i++){var o=r[i],a=void 0;if("string"==typeof o){var s=new C;s.text=o,a=s}else a=n.parseElement(this,o,!1);a&&this.internalAddInline(a,!0)}},t.prototype.internalToJSON=function(t,n){if(e.prototype.internalToJSON.call(this,t,n),this._inlines.length>0){for(var i=[],r=0,o=this._inlines;r<o.length;r++){var a=o[r];i.push(a.toJSON(n))}n.serializeValue(t,"inlines",i)}},t.prototype.internalRender=function(){if(this._inlines.length>0){var e=void 0;if(this.forElementId){var t=document.createElement("label");t.htmlFor=this.forElementId,e=t}else e=document.createElement("div");switch(e.className=this.hostConfig.makeCssClassName("ac-richTextBlock"),this.horizontalAlignment){case a.HorizontalAlignment.Center:e.style.textAlign="center";break;case a.HorizontalAlignment.Right:e.style.textAlign="end";break;default:e.style.textAlign="start"}for(var n=0,i=0,r=this._inlines;i<r.length;i++){var o=r[i].render();o&&(e.appendChild(o),n++)}if(n>0)return e}},t.prototype.asString=function(){for(var e="",t=0,n=this._inlines;t<n.length;t++){e+=n[t].asString()}return e},t.prototype.getJsonTypeName=function(){return"RichTextBlock"},t.prototype.getInlineCount=function(){return this._inlines.length},t.prototype.getInlineAt=function(e){if(e>=0&&e<this._inlines.length)return this._inlines[e];throw new Error(f.Strings.errors.indexOutOfRange(e))},t.prototype.addInline=function(e){"string"==typeof e?this.internalAddInline(new C(e)):this.internalAddInline(e)},t.prototype.removeInline=function(e){var t=this._inlines.indexOf(e);return t>=0&&(this._inlines[t].setParent(void 0),this._inlines.splice(t,1),!0)},t}(g);t.RichTextBlock=S;var _=function(e){function t(t,n){var i=e.call(this)||this;return i.name=t,i.value=n,i}return r(t,e),t.prototype.getSchemaKey=function(){return"Fact"},t.titleProperty=new h.StringProperty(h.Versions.v1_0,"title"),t.valueProperty=new h.StringProperty(h.Versions.v1_0,"value"),o([h.property(t.titleProperty)],t.prototype,"name",void 0),o([h.property(t.valueProperty)],t.prototype,"value",void 0),t}(h.SerializableObject);t.Fact=_;var P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),Object.defineProperty(t.prototype,"useDefaultSizing",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.internalRender=function(){var e=void 0,t=this.hostConfig;if(this.facts.length>0){(e=document.createElement("table")).style.borderWidth="0px",e.style.borderSpacing="0px",e.style.borderStyle="none",e.style.borderCollapse="collapse",e.style.display="block",e.style.overflow="hidden",e.classList.add(t.makeCssClassName("ac-factset")),e.setAttribute("role","presentation");for(var n=0;n<this.facts.length;n++){var i=document.createElement("tr");n>0&&(i.style.marginTop=t.factSet.spacing+"px");var r=document.createElement("td");r.style.padding="0",r.classList.add(t.makeCssClassName("ac-fact-title")),t.factSet.title.maxWidth&&(r.style.maxWidth=t.factSet.title.maxWidth+"px"),r.style.verticalAlign="top";var o=new b;o.setParent(this),o.text=!this.facts[n].name&&this.isDesignMode()?"Title":this.facts[n].name,o.size=t.factSet.title.size,o.color=t.factSet.title.color,o.isSubtle=t.factSet.title.isSubtle,o.weight=t.factSet.title.weight,o.wrap=t.factSet.title.wrap,o.spacing=a.Spacing.None,l.appendChild(r,o.render()),l.appendChild(i,r),(r=document.createElement("td")).style.width="10px",l.appendChild(i,r),(r=document.createElement("td")).style.padding="0",r.style.verticalAlign="top",r.classList.add(t.makeCssClassName("ac-fact-value")),(o=new b).setParent(this),o.text=this.facts[n].value,o.size=t.factSet.value.size,o.color=t.factSet.value.color,o.isSubtle=t.factSet.value.isSubtle,o.weight=t.factSet.value.weight,o.wrap=t.factSet.value.wrap,o.spacing=a.Spacing.None,l.appendChild(r,o.render()),l.appendChild(i,r),l.appendChild(e,i)}}return e},t.prototype.getJsonTypeName=function(){return"FactSet"},t.factsProperty=new h.SerializableObjectCollectionProperty(h.Versions.v1_0,"facts",_),o([h.property(t.factsProperty)],t.prototype,"facts",void 0),t}(g);t.FactSet=P;var A=function(e){function t(t,n,i,r){var o=e.call(this,t,n)||this;return o.targetVersion=t,o.name=n,o.internalName=i,o.fallbackProperty=r,o}return r(t,e),t.prototype.getInternalName=function(){return this.internalName},t.prototype.parse=function(e,t,n){var i=void 0,r=t[this.name];if(void 0===r)return this.defaultValue;var o=!1;if("string"==typeof r){try{var l=s.SizeAndUnit.parse(r,!0);l.unit==a.SizeUnit.Pixel&&(i=l.physicalSize,o=!0)}catch(e){}!o&&this.fallbackProperty&&(o=this.fallbackProperty.isValidValue(r,n))}return o||n.logParseEvent(e,a.ValidationEvent.InvalidPropertyValue,f.Strings.errors.invalidPropertyValue(r,this.name)),i},t.prototype.toJSON=function(e,t,n,i){i.serializeValue(t,this.name,"number"!=typeof n||isNaN(n)?void 0:n+"px")},t}(h.PropertyDefinition),E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.size=a.Size.Auto,t.style=a.ImageStyle.Default,t}return r(t,e),t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t),t.remove(g.heightProperty)},t.prototype.applySize=function(e){if(this.pixelWidth||this.pixelHeight)this.pixelWidth&&(e.style.width=this.pixelWidth+"px"),this.pixelHeight&&(e.style.height=this.pixelHeight+"px");else if(this.maxHeight){switch(this.size){case a.Size.Small:e.style.height=this.hostConfig.imageSizes.small+"px";break;case a.Size.Large:e.style.height=this.hostConfig.imageSizes.large+"px";break;default:e.style.height=this.hostConfig.imageSizes.medium+"px"}e.style.maxHeight=this.maxHeight+"px"}else{switch(this.size){case a.Size.Stretch:e.style.width="100%";break;case a.Size.Auto:e.style.maxWidth="100%";break;case a.Size.Small:e.style.width=this.hostConfig.imageSizes.small+"px";break;case a.Size.Large:e.style.width=this.hostConfig.imageSizes.large+"px";break;case a.Size.Medium:e.style.width=this.hostConfig.imageSizes.medium+"px"}e.style.maxHeight="100%"}},Object.defineProperty(t.prototype,"useDefaultSizing",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.internalRender=function(){var e=this,n=void 0;if(this.url){(n=document.createElement("div")).style.display="flex",n.style.alignItems="flex-start";var i=this.hostConfig;switch(this.selectAction&&i.supportsInteractivity&&(n.onkeypress=function(t){!e.selectAction||13!=t.keyCode&&32!=t.keyCode||(t.preventDefault(),t.cancelBubble=!0,e.selectAction.execute())},n.onclick=function(t){e.selectAction&&(t.preventDefault(),t.cancelBubble=!0,e.selectAction.execute())},this.selectAction.setupElementForAccessibility(n),n.classList.add(i.makeCssClassName("ac-selectable"))),this.horizontalAlignment){case a.HorizontalAlignment.Center:n.style.justifyContent="center";break;case a.HorizontalAlignment.Right:n.style.justifyContent="flex-end";break;default:n.style.justifyContent="flex-start"}var r=document.createElement("img");r.onload=function(t){re(e)},r.onerror=function(t){if(e.renderedElement){var n=e.getRootElement();if(e.renderedElement.innerHTML="",n&&n.designMode){var i=document.createElement("div");i.style.display="flex",i.style.alignItems="center",i.style.justifyContent="center",i.style.backgroundColor="#EEEEEE",i.style.color="black",i.innerText=":-(",i.style.padding="10px",e.applySize(i),e.renderedElement.appendChild(i)}}re(e)},r.style.minWidth="0",r.classList.add(i.makeCssClassName("ac-image")),this.selectAction&&i.supportsInteractivity&&(this.selectAction.setupElementForAccessibility(r),r.classList.add(i.makeCssClassName("ac-selectable"))),this.applySize(r),this.style===a.ImageStyle.Person&&(r.style.borderRadius="50%",r.style.backgroundPosition="50% 50%",r.style.backgroundRepeat="no-repeat"),r.style.backgroundColor=l.stringToCssColor(this.backgroundColor),r.src=this.preProcessPropertyValue(t.urlProperty);var o=this.preProcessPropertyValue(t.altTextProperty);o&&(r.alt=o),n.appendChild(r)}return n},t.prototype.getJsonTypeName=function(){return"Image"},t.prototype.getActionById=function(t){var n=e.prototype.getActionById.call(this,t);return!n&&this.selectAction&&(n=this.selectAction.getActionById(t)),n},t.prototype.getResourceInformation=function(){return this.url?[{url:this.url,mimeType:"image"}]:[]},t.urlProperty=new h.StringProperty(h.Versions.v1_0,"url"),t.altTextProperty=new h.StringProperty(h.Versions.v1_0,"altText"),t.backgroundColorProperty=new h.StringProperty(h.Versions.v1_1,"backgroundColor"),t.styleProperty=new h.EnumProperty(h.Versions.v1_0,"style",a.ImageStyle,a.ImageStyle.Default),t.sizeProperty=new h.EnumProperty(h.Versions.v1_0,"size",a.Size,a.Size.Auto),t.pixelWidthProperty=new A(h.Versions.v1_1,"width","pixelWidth"),t.pixelHeightProperty=new A(h.Versions.v1_1,"height","pixelHeight",g.heightProperty),t.selectActionProperty=new m(h.Versions.v1_1,"selectAction",["Action.ShowCard"]),o([h.property(t.urlProperty)],t.prototype,"url",void 0),o([h.property(t.altTextProperty)],t.prototype,"altText",void 0),o([h.property(t.backgroundColorProperty)],t.prototype,"backgroundColor",void 0),o([h.property(t.sizeProperty)],t.prototype,"size",void 0),o([h.property(t.styleProperty)],t.prototype,"style",void 0),o([h.property(t.pixelWidthProperty)],t.prototype,"pixelWidth",void 0),o([h.property(t.pixelHeightProperty)],t.prototype,"pixelHeight",void 0),o([h.property(t.selectActionProperty)],t.prototype,"selectAction",void 0),t}(g);t.Image=E;var w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allowVerticalOverflow=!1,t}return r(t,e),t.prototype.populateSchema=function(n){e.prototype.populateSchema.call(this,n),this.isSelectable||n.remove(t.selectActionProperty)},t.prototype.isElementAllowed=function(e){return this.hostConfig.supportsInteractivity||!e.isInteractive},t.prototype.applyPadding=function(){if(e.prototype.applyPadding.call(this),this.renderedElement){var t=new s.SpacingDefinition;this.getEffectivePadding()&&(t=this.hostConfig.paddingDefinitionToSpacingDefinition(this.getEffectivePadding())),this.renderedElement.style.paddingTop=t.top+"px",this.renderedElement.style.paddingRight=t.right+"px",this.renderedElement.style.paddingBottom=t.bottom+"px",this.renderedElement.style.paddingLeft=t.left+"px",this.renderedElement.style.marginRight="0",this.renderedElement.style.marginLeft="0"}},Object.defineProperty(t.prototype,"isSelectable",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t);for(var n=0;n<this.getItemCount();n++){var i=this.getItemAt(n);!this.hostConfig.supportsInteractivity&&i.isInteractive&&t.addFailure(this,a.ValidationEvent.InteractivityNotAllowed,f.Strings.errors.interactivityNotAllowed()),this.isElementAllowed(i)||t.addFailure(this,a.ValidationEvent.InteractivityNotAllowed,f.Strings.errors.elementTypeNotAllowed(i.getJsonTypeName())),i.internalValidateProperties(t)}this._selectAction&&this._selectAction.internalValidateProperties(t)},t.prototype.render=function(){var t=this,n=e.prototype.render.call(this);if(n){var i=this.hostConfig;this.allowVerticalOverflow&&(n.style.overflowX="hidden",n.style.overflowY="auto"),n&&this.isSelectable&&this._selectAction&&i.supportsInteractivity&&(n.onclick=function(e){void 0!==t._selectAction&&(e.preventDefault(),e.cancelBubble=!0,t._selectAction.execute())},n.onkeypress=function(e){void 0===t._selectAction||13!=e.keyCode&&32!=e.keyCode||(e.preventDefault(),e.cancelBubble=!0,t._selectAction.execute())},this._selectAction.setupElementForAccessibility(n),n.classList.add(i.makeCssClassName("ac-selectable")))}return n},t.prototype.updateLayout=function(t){if(void 0===t&&(t=!0),e.prototype.updateLayout.call(this,t),t)for(var n=0;n<this.getItemCount();n++)this.getItemAt(n).updateLayout()},t.prototype.getAllInputs=function(e){void 0===e&&(e=!0);for(var t=[],n=0;n<this.getItemCount();n++)t=t.concat(this.getItemAt(n).getAllInputs(e));return t},t.prototype.getResourceInformation=function(){for(var e=[],t=0;t<this.getItemCount();t++)e=e.concat(this.getItemAt(t).getResourceInformation());return e},t.prototype.getElementById=function(t){var n=e.prototype.getElementById.call(this,t);if(!n)for(var i=0;i<this.getItemCount()&&!(n=this.getItemAt(i).getElementById(t));i++);return n},t.prototype.findDOMNodeOwner=function(t){for(var n=void 0,i=0;i<this.getItemCount();i++)if(n=this.getItemAt(i).findDOMNodeOwner(t))return n;return e.prototype.findDOMNodeOwner.call(this,t)},t.selectActionProperty=new m(h.Versions.v1_1,"selectAction",["Action.ShowCard"]),o([h.property(t.selectActionProperty)],t.prototype,"_selectAction",void 0),t}(g);t.CardElementContainer=w;var x=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._images=[],t.imageSize=a.ImageSize.Medium,t}return r(t,e),t.prototype.internalRender=function(){var e=void 0;if(this._images.length>0){(e=document.createElement("div")).style.display="flex",e.style.flexWrap="wrap";for(var t=0,n=this._images;t<n.length;t++){var i=n[t];switch(this.imageSize){case a.ImageSize.Small:i.size=a.Size.Small;break;case a.ImageSize.Large:i.size=a.Size.Large;break;default:i.size=a.Size.Medium}i.maxHeight=this.hostConfig.imageSet.maxImageHeight;var r=i.render();r&&(r.style.display="inline-flex",r.style.margin="0px",r.style.marginRight="10px",l.appendChild(e,r))}}return e},t.prototype.getItemCount=function(){return this._images.length},t.prototype.getItemAt=function(e){return this._images[e]},t.prototype.getFirstVisibleRenderedItem=function(){return this._images&&this._images.length>0?this._images[0]:void 0},t.prototype.getLastVisibleRenderedItem=function(){return this._images&&this._images.length>0?this._images[this._images.length-1]:void 0},t.prototype.removeItem=function(e){if(e instanceof E){var t=this._images.indexOf(e);if(t>=0)return this._images.splice(t,1),e.setParent(void 0),this.updateLayout(),!0}return!1},t.prototype.getJsonTypeName=function(){return"ImageSet"},t.prototype.addImage=function(e){if(e.parent)throw new Error("This image already belongs to another ImageSet");this._images.push(e),e.setParent(this)},t.prototype.indexOf=function(e){return e instanceof E?this._images.indexOf(e):-1},t.imagesProperty=new h.SerializableObjectCollectionProperty(h.Versions.v1_0,"images",E,(function(e,t){t.setParent(e)})),t.imageSizeProperty=new h.EnumProperty(h.Versions.v1_0,"imageSize",a.ImageSize,a.ImageSize.Medium),o([h.property(t.imagesProperty)],t.prototype,"_images",void 0),o([h.property(t.imageSizeProperty)],t.prototype,"imageSize",void 0),t}(w);t.ImageSet=x;var I=function(e){function t(t,n){var i=e.call(this)||this;return i.url=t,i.mimeType=n,i}return r(t,e),t.prototype.getSchemaKey=function(){return"MediaSource"},t.prototype.isValid=function(){return!(!this.mimeType||!this.url)},t.prototype.render=function(){var e=void 0;return this.isValid()&&((e=document.createElement("source")).src=this.url,e.type=this.mimeType),e},t.mimeTypeProperty=new h.StringProperty(h.Versions.v1_1,"mimeType"),t.urlProperty=new h.StringProperty(h.Versions.v1_1,"url"),o([h.property(t.mimeTypeProperty)],t.prototype,"mimeType",void 0),o([h.property(t.urlProperty)],t.prototype,"url",void 0),t}(h.SerializableObject);t.MediaSource=I;var T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sources=[],t}return r(t,e),t.prototype.getPosterUrl=function(){return this.poster?this.poster:this.hostConfig.media.defaultPoster},t.prototype.processSources=function(){this._selectedSources=[],this._selectedMediaType=void 0;for(var e=0,n=this.sources;e<n.length;e++){var i=n[e],r=i.mimeType?i.mimeType.split("/"):[];if(2==r.length){if(!this._selectedMediaType){var o=t.supportedMediaTypes.indexOf(r[0]);o>=0&&(this._selectedMediaType=t.supportedMediaTypes[o])}r[0]==this._selectedMediaType&&this._selectedSources.push(i)}}},t.prototype.handlePlayButtonInvoke=function(e){if(this.hostConfig.media.allowInlinePlayback){if(e.preventDefault(),e.cancelBubble=!0,this.renderedElement){var n=this.renderMediaPlayer();this.renderedElement.innerHTML="",this.renderedElement.appendChild(n),n.play(),n.focus()}}else t.onPlay&&(e.preventDefault(),e.cancelBubble=!0,t.onPlay(this))},t.prototype.renderPoster=function(){var e=this,t=document.createElement("div");t.className=this.hostConfig.makeCssClassName("ac-media-poster"),t.setAttribute("role","contentinfo"),t.setAttribute("aria-label",this.altText?this.altText:f.Strings.defaults.mediaPlayerAriaLabel()),t.style.position="relative",t.style.display="flex";var n=this.getPosterUrl();if(n){var i=document.createElement("img");i.style.width="100%",i.style.height="100%",i.setAttribute("role","presentation"),i.onerror=function(e){i.parentNode&&i.parentNode.removeChild(i),t.classList.add("empty"),t.style.minHeight="150px"},i.src=n,t.appendChild(i)}else t.classList.add("empty"),t.style.minHeight="150px";if(this.hostConfig.supportsInteractivity&&this._selectedSources.length>0){var r=document.createElement("div");r.tabIndex=0,r.setAttribute("role","button"),r.setAttribute("aria-label",f.Strings.defaults.mediaPlayerPlayMedia()),r.className=this.hostConfig.makeCssClassName("ac-media-playButton"),r.style.display="flex",r.style.alignItems="center",r.style.justifyContent="center",r.onclick=function(t){e.handlePlayButtonInvoke(t)},r.onkeypress=function(t){13!=t.keyCode&&32!=t.keyCode||e.handlePlayButtonInvoke(t)};var o=document.createElement("div");o.className=this.hostConfig.makeCssClassName("ac-media-playButton-arrow"),o.style.width="12px",o.style.height="15px",o.style.borderTopWidth="7.5px",o.style.borderBottomWidth="7.5px",o.style.borderLeftWidth="12px",o.style.borderRightWidth="0",o.style.borderStyle="solid",o.style.borderTopColor="transparent",o.style.borderRightColor="transparent",o.style.borderBottomColor="transparent",o.style.transform="translate(1.2px,0px)",r.appendChild(o);var a=document.createElement("div");a.style.position="absolute",a.style.left="0",a.style.top="0",a.style.width="100%",a.style.height="100%",a.style.display="flex",a.style.justifyContent="center",a.style.alignItems="center",a.appendChild(r),t.appendChild(a)}return t},t.prototype.renderMediaPlayer=function(){var e;if("video"==this._selectedMediaType){var t=document.createElement("video"),n=this.getPosterUrl();n&&(t.poster=n),e=t}else e=document.createElement("audio");e.setAttribute("aria-label",this.altText?this.altText:f.Strings.defaults.mediaPlayerAriaLabel()),e.setAttribute("webkit-playsinline",""),e.setAttribute("playsinline",""),e.autoplay=!0,e.controls=!0,l.isMobileOS()&&(e.muted=!0),e.preload="none",e.style.width="100%";for(var i=0,r=this.sources;i<r.length;i++){var o=r[i].render();l.appendChild(e,o)}return e},t.prototype.internalRender=function(){var e=document.createElement("div");return e.className=this.hostConfig.makeCssClassName("ac-media"),this.processSources(),e.appendChild(this.renderPoster()),e},t.prototype.getJsonTypeName=function(){return"Media"},t.prototype.getResourceInformation=function(){var e=[],t=this.getPosterUrl();t&&e.push({url:t,mimeType:"image"});for(var n=0,i=this.sources;n<i.length;n++){var r=i[n];r.isValid()&&e.push({url:r.url,mimeType:r.mimeType})}return e},Object.defineProperty(t.prototype,"selectedMediaType",{get:function(){return this._selectedMediaType},enumerable:!1,configurable:!0}),t.sourcesProperty=new h.SerializableObjectCollectionProperty(h.Versions.v1_1,"sources",I),t.posterProperty=new h.StringProperty(h.Versions.v1_1,"poster"),t.altTextProperty=new h.StringProperty(h.Versions.v1_1,"altText"),t.supportedMediaTypes=["audio","video"],o([h.property(t.sourcesProperty)],t.prototype,"sources",void 0),o([h.property(t.posterProperty)],t.prototype,"poster",void 0),o([h.property(t.altTextProperty)],t.prototype,"altText",void 0),t}(g);t.Media=T;var V=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getAllLabelIds=function(){var e=[];return this.labelledBy&&e.push(this.labelledBy),this._renderedLabelElement&&e.push(this._renderedLabelElement.id),this._renderedErrorMessageElement&&e.push(this._renderedErrorMessageElement.id),e},t.prototype.updateInputControlAriaLabelledBy=function(){if(this._renderedInputControlElement){var e=this.getAllLabelIds();e.length>0?this._renderedInputControlElement.setAttribute("aria-labelledby",e.join(" ")):this._renderedInputControlElement.removeAttribute("aria-labelledby")}},Object.defineProperty(t.prototype,"isNullable",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderedInputControlElement",{get:function(){return this._renderedInputControlElement},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inputControlContainerElement",{get:function(){return this._inputControlContainerElement},enumerable:!1,configurable:!0}),t.prototype.overrideInternalRender=function(){var e=this.hostConfig;this._outerContainerElement=document.createElement("div"),this._outerContainerElement.style.display="flex",this._outerContainerElement.style.flexDirection="column";var t=l.generateUniqueId();if(this.label){var n=new S;n.setParent(this),n.forElementId=t;var i=new C(this.label);if(n.addInline(i),this.isRequired){i.init(e.inputs.label.requiredInputs);var r=new C(e.inputs.label.requiredInputs.suffix);r.color=e.inputs.label.requiredInputs.suffixColor,r.ariaHidden=!0,n.addInline(r)}else i.init(e.inputs.label.optionalInputs);this._renderedLabelElement=n.render(),this._renderedLabelElement&&(this._renderedLabelElement.id=l.generateUniqueId(),this._renderedLabelElement.style.marginBottom=e.getEffectiveSpacing(e.inputs.label.inputSpacing)+"px",this._outerContainerElement.appendChild(this._renderedLabelElement))}if(this._inputControlContainerElement=document.createElement("div"),this._inputControlContainerElement.className=e.makeCssClassName("ac-input-container"),this._inputControlContainerElement.style.display="flex","stretch"===this.height&&(this._inputControlContainerElement.style.alignItems="stretch",this._inputControlContainerElement.style.flex="1 1 auto"),this._renderedInputControlElement=this.internalRender(),this._renderedInputControlElement)return this._renderedInputControlElement.id=t,this._renderedInputControlElement.style.minWidth="0px",this.isNullable&&this.isRequired&&(this._renderedInputControlElement.setAttribute("aria-required","true"),this._renderedInputControlElement.classList.add(e.makeCssClassName("ac-input-required"))),this._inputControlContainerElement.appendChild(this._renderedInputControlElement),this._outerContainerElement.appendChild(this._inputControlContainerElement),this.updateInputControlAriaLabelledBy(),this._outerContainerElement},t.prototype.valueChanged=function(){var e,t,n;this.isValid()&&this.resetValidationFailureCue(),this.onValueChanged&&this.onValueChanged(this),t=(e=this).getRootElement(),(n=t&&t.onInputValueChanged?t.onInputValueChanged:fe.onInputValueChanged)&&n(e)},t.prototype.resetValidationFailureCue=function(){this.renderedInputControlElement&&(this.renderedInputControlElement.classList.remove(this.hostConfig.makeCssClassName("ac-input-validation-failed")),this.updateInputControlAriaLabelledBy(),this._renderedErrorMessageElement&&(this._outerContainerElement.removeChild(this._renderedErrorMessageElement),this._renderedErrorMessageElement=void 0))},t.prototype.showValidationErrorMessage=function(){if(this.renderedElement&&this.errorMessage&&s.GlobalSettings.displayInputValidationErrors){var e=new b;e.setParent(this),e.text=this.errorMessage,e.wrap=!0,e.init(this.hostConfig.inputs.errorMessage),this._renderedErrorMessageElement=e.render(),this._renderedErrorMessageElement&&(this._renderedErrorMessageElement.id=l.generateUniqueId(),this._outerContainerElement.appendChild(this._renderedErrorMessageElement),this.updateInputControlAriaLabelledBy())}},t.prototype.focus=function(){this._renderedInputControlElement&&this._renderedInputControlElement.focus()},t.prototype.isValid=function(){return!0},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this.id||t.addFailure(this,a.ValidationEvent.PropertyCantBeNull,f.Strings.errors.inputsMustHaveUniqueId()),this.isRequired&&(this.label||t.addFailure(this,a.ValidationEvent.RequiredInputsShouldHaveLabel,"Required inputs should have a label"),this.errorMessage||t.addFailure(this,a.ValidationEvent.RequiredInputsShouldHaveErrorMessage,"Required inputs should have an error message"))},t.prototype.validateValue=function(){this.resetValidationFailureCue();var e=this.isRequired?this.isSet()&&this.isValid():this.isValid();return!e&&this.renderedInputControlElement&&(this.renderedInputControlElement.classList.add(this.hostConfig.makeCssClassName("ac-input-validation-failed")),this.showValidationErrorMessage()),e},t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),[this]},Object.defineProperty(t.prototype,"isInteractive",{get:function(){return!0},enumerable:!1,configurable:!0}),t.labelProperty=new h.StringProperty(h.Versions.v1_3,"label",!0),t.isRequiredProperty=new h.BoolProperty(h.Versions.v1_3,"isRequired",!1),t.errorMessageProperty=new h.StringProperty(h.Versions.v1_3,"errorMessage",!0),o([h.property(t.labelProperty)],t.prototype,"label",void 0),o([h.property(t.isRequiredProperty)],t.prototype,"isRequired",void 0),o([h.property(t.errorMessageProperty)],t.prototype,"errorMessage",void 0),t}(g);t.Input=V;var O=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isMultiline=!1,t.style=a.InputTextStyle.Text,t}return r(t,e),t.prototype.setupInput=function(e){var t=this;e.style.flex="1 1 auto",e.tabIndex=0,this.placeholder&&(e.placeholder=this.placeholder,e.setAttribute("aria-label",this.placeholder)),this.defaultValue&&(e.value=this.defaultValue),this.maxLength&&this.maxLength>0&&(e.maxLength=this.maxLength),e.oninput=function(){t.valueChanged()},e.onkeypress=function(e){e.ctrlKey&&"Enter"===e.code&&t.inlineAction&&t.inlineAction.execute()}},t.prototype.internalRender=function(){var e;return this.isMultiline?((e=document.createElement("textarea")).className=this.hostConfig.makeCssClassName("ac-input","ac-textInput","ac-multiline"),"stretch"===this.height&&(e.style.height="initial")):((e=document.createElement("input")).className=this.hostConfig.makeCssClassName("ac-input","ac-textInput"),e.type=a.InputTextStyle[this.style].toLowerCase()),this.setupInput(e),e},t.prototype.overrideInternalRender=function(){var t=this,n=e.prototype.overrideInternalRender.call(this);if(this.inlineAction){var i=document.createElement("button");if(i.className=this.hostConfig.makeCssClassName("ac-inlineActionButton"),i.onclick=function(e){e.preventDefault(),e.cancelBubble=!0,t.inlineAction&&t.inlineAction.execute()},this.inlineAction.iconUrl){i.classList.add("iconOnly");var r=document.createElement("img");r.style.height="100%",r.setAttribute("role","presentation"),r.style.display="none",r.onload=function(){r.style.removeProperty("display")},r.onerror=function(){i.removeChild(r),i.classList.remove("iconOnly"),i.classList.add("textOnly"),i.textContent=t.inlineAction&&t.inlineAction.title?t.inlineAction.title:f.Strings.defaults.inlineActionTitle()},r.src=this.inlineAction.iconUrl,i.appendChild(r),i.title=this.inlineAction.title?this.inlineAction.title:f.Strings.defaults.inlineActionTitle()}else i.classList.add("textOnly"),i.textContent=this.inlineAction.title?this.inlineAction.title:f.Strings.defaults.inlineActionTitle();this.inlineAction.setupElementForAccessibility(i,!0),i.style.marginLeft="8px",this.inputControlContainerElement.appendChild(i)}return n},t.prototype.getJsonTypeName=function(){return"Input.Text"},t.prototype.getActionById=function(t){var n=e.prototype.getActionById.call(this,t);return!n&&this.inlineAction&&(n=this.inlineAction.getActionById(t)),n},t.prototype.isSet=function(){return!!this.value},t.prototype.isValid=function(){return!this.value||(!this.regex||new RegExp(this.regex,"g").test(this.value))},Object.defineProperty(t.prototype,"value",{get:function(){return this.renderedInputControlElement?(this.isMultiline,this.renderedInputControlElement.value):void 0},enumerable:!1,configurable:!0}),t.valueProperty=new h.StringProperty(h.Versions.v1_0,"value"),t.maxLengthProperty=new h.NumProperty(h.Versions.v1_0,"maxLength"),t.isMultilineProperty=new h.BoolProperty(h.Versions.v1_0,"isMultiline",!1),t.placeholderProperty=new h.StringProperty(h.Versions.v1_0,"placeholder"),t.styleProperty=new h.EnumProperty(h.Versions.v1_0,"style",a.InputTextStyle,a.InputTextStyle.Text),t.inlineActionProperty=new m(h.Versions.v1_0,"inlineAction",["Action.ShowCard"]),t.regexProperty=new h.StringProperty(h.Versions.v1_3,"regex",!0),o([h.property(t.valueProperty)],t.prototype,"defaultValue",void 0),o([h.property(t.maxLengthProperty)],t.prototype,"maxLength",void 0),o([h.property(t.isMultilineProperty)],t.prototype,"isMultiline",void 0),o([h.property(t.placeholderProperty)],t.prototype,"placeholder",void 0),o([h.property(t.styleProperty)],t.prototype,"style",void 0),o([h.property(t.inlineActionProperty)],t.prototype,"inlineAction",void 0),o([h.property(t.regexProperty)],t.prototype,"regex",void 0),t}(V);t.TextInput=O;var k=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.valueOn="true",t.valueOff="false",t.wrap=!1,t}return r(t,e),t.prototype.updateInputControlAriaLabelledBy=function(){if(this._checkboxInputElement){var e=this.getAllLabelIds().join(" ");this._checkboxInputLabelElement&&this._checkboxInputLabelElement.id&&(e+=" "+this._checkboxInputLabelElement.id),e?this._checkboxInputElement.setAttribute("aria-labelledby",e):this._checkboxInputElement.removeAttribute("aria-labelledby")}},t.prototype.internalRender=function(){var e=this,t=document.createElement("div");if(t.className=this.hostConfig.makeCssClassName("ac-input","ac-toggleInput"),t.style.width="100%",t.style.display="flex",t.style.alignItems="center",this._checkboxInputElement=document.createElement("input"),this._checkboxInputElement.id=l.generateUniqueId(),this._checkboxInputElement.type="checkbox",this._checkboxInputElement.style.display="inline-block",this._checkboxInputElement.style.verticalAlign="middle",this._checkboxInputElement.style.margin="0",this._checkboxInputElement.style.flex="0 0 auto",this.title&&this._checkboxInputElement.setAttribute("aria-label",this.title),this.isRequired&&this._checkboxInputElement.setAttribute("aria-required","true"),this._checkboxInputElement.tabIndex=0,this.defaultValue==this.valueOn&&(this._checkboxInputElement.checked=!0),this._checkboxInputElement.onchange=function(){e.valueChanged()},l.appendChild(t,this._checkboxInputElement),this.title||this.isDesignMode()){var n=new b;if(n.setParent(this),n.forElementId=this._checkboxInputElement.id,n.hostConfig=this.hostConfig,n.text=this.title?this.title:this.getJsonTypeName(),n.useMarkdown=s.GlobalSettings.useMarkdownInRadioButtonAndCheckbox,n.wrap=this.wrap,this._checkboxInputLabelElement=n.render(),this._checkboxInputLabelElement){this._checkboxInputLabelElement.id=l.generateUniqueId(),this._checkboxInputLabelElement.style.display="inline-block",this._checkboxInputLabelElement.style.flex="1 1 auto",this._checkboxInputLabelElement.style.marginLeft="6px",this._checkboxInputLabelElement.style.verticalAlign="middle";var i=document.createElement("div");i.style.width="6px",l.appendChild(t,i),l.appendChild(t,this._checkboxInputLabelElement)}}return t},Object.defineProperty(t.prototype,"isNullable",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.getJsonTypeName=function(){return"Input.Toggle"},t.prototype.focus=function(){this._checkboxInputElement&&this._checkboxInputElement.focus()},t.prototype.isSet=function(){return this.isRequired?this.value===this.valueOn:!!this.value},Object.defineProperty(t.prototype,"value",{get:function(){return this._checkboxInputElement?this._checkboxInputElement.checked?this.valueOn:this.valueOff:void 0},enumerable:!1,configurable:!0}),t.valueProperty=new h.StringProperty(h.Versions.v1_0,"value"),t.titleProperty=new h.StringProperty(h.Versions.v1_0,"title"),t.valueOnProperty=new h.StringProperty(h.Versions.v1_0,"valueOn",!0,void 0,"true",(function(e){return"true"})),t.valueOffProperty=new h.StringProperty(h.Versions.v1_0,"valueOff",!0,void 0,"false",(function(e){return"false"})),t.wrapProperty=new h.BoolProperty(h.Versions.v1_2,"wrap",!1),o([h.property(t.valueProperty)],t.prototype,"defaultValue",void 0),o([h.property(t.titleProperty)],t.prototype,"title",void 0),o([h.property(t.valueOnProperty)],t.prototype,"valueOn",void 0),o([h.property(t.valueOffProperty)],t.prototype,"valueOff",void 0),o([h.property(t.wrapProperty)],t.prototype,"wrap",void 0),t}(V);t.ToggleInput=k;var N=function(e){function t(t,n){var i=e.call(this)||this;return i.title=t,i.value=n,i}return r(t,e),t.prototype.getSchemaKey=function(){return"Choice"},t.titleProperty=new h.StringProperty(h.Versions.v1_0,"title"),t.valueProperty=new h.StringProperty(h.Versions.v1_0,"value"),o([h.property(t.titleProperty)],t.prototype,"title",void 0),o([h.property(t.valueProperty)],t.prototype,"value",void 0),t}(h.SerializableObject);t.Choice=N;var z=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isMultiSelect=!1,t.wrap=!1,t.choices=[],t}return r(t,e),Object.defineProperty(t.prototype,"isCompact",{get:function(){return"expanded"!==this.style},set:function(e){this.style=e?void 0:"expanded"},enumerable:!1,configurable:!0}),t.getUniqueCategoryName=function(){var e="__ac-category"+t.uniqueCategoryCounter;return t.uniqueCategoryCounter++,e},t.prototype.internalApplyAriaCurrent=function(){var e=this._selectElement.options;if(e)for(var t=0;t<e.length;t++)e[t].selected?e[t].setAttribute("aria-current","true"):e[t].removeAttribute("aria-current")},t.prototype.renderCompoundInput=function(e,t,n){var i=this,r=document.createElement("div");r.className=this.hostConfig.makeCssClassName("ac-input",e),r.style.width="100%",this._toggleInputs=[],this._labels=[];for(var o=0,a=this.choices;o<a.length;o++){var p=a[o],u=document.createElement("input");u.id=l.generateUniqueId(),u.type=t,u.style.margin="0",u.style.display="inline-block",u.style.verticalAlign="middle",u.style.flex="0 0 auto",u.name=this.id?this.id:this._uniqueCategoryName,this.isRequired&&u.setAttribute("aria-required","true"),p.value&&(u.value=p.value),p.title&&u.setAttribute("aria-label",p.title),n&&p.value&&n.indexOf(p.value)>=0&&(u.checked=!0),u.onchange=function(){i.valueChanged()},this._toggleInputs.push(u);var c=document.createElement("div");c.style.display="flex",c.style.alignItems="center",l.appendChild(c,u);var h=new b;h.setParent(this),h.forElementId=u.id,h.hostConfig=this.hostConfig,h.text=p.title?p.title:"Choice "+this._toggleInputs.length,h.useMarkdown=s.GlobalSettings.useMarkdownInRadioButtonAndCheckbox,h.wrap=this.wrap;var d=h.render();if(this._labels.push(d),d){d.id=l.generateUniqueId(),d.style.display="inline-block",d.style.flex="1 1 auto",d.style.marginLeft="6px",d.style.verticalAlign="middle";var f=document.createElement("div");f.style.width="6px",l.appendChild(c,f),l.appendChild(c,d)}l.appendChild(r,c)}return r},t.prototype.updateInputControlAriaLabelledBy=function(){if((this.isMultiSelect||"expanded"===this.style)&&this._toggleInputs&&this._labels)for(var t=this.getAllLabelIds(),n=0;n<this._toggleInputs.length;n++){var i=t.join(" "),r=this._labels[n];r&&r.id&&(i+=" "+r.id),i?this._toggleInputs[n].setAttribute("aria-labelledby",i):this._toggleInputs[n].removeAttribute("aria-labelledby")}else e.prototype.updateInputControlAriaLabelledBy.call(this)},t.prototype.internalRender=function(){var e=this;if(this._uniqueCategoryName=t.getUniqueCategoryName(),this.isMultiSelect)return this.renderCompoundInput("ac-choiceSetInput-multiSelect","checkbox",this.defaultValue?this.defaultValue.split(this.hostConfig.choiceSetInputValueSeparator):void 0);if("expanded"===this.style)return this.renderCompoundInput("ac-choiceSetInput-expanded","radio",this.defaultValue?[this.defaultValue]:void 0);this._selectElement=document.createElement("select"),this._selectElement.className=this.hostConfig.makeCssClassName("ac-input","ac-multichoiceInput","ac-choiceSetInput-compact"),this._selectElement.style.width="100%";var n=document.createElement("option");n.selected=!0,n.disabled=!0,n.hidden=!0,n.value="",this.placeholder&&(n.text=this.placeholder),l.appendChild(this._selectElement,n);for(var i=0,r=this.choices;i<r.length;i++){var o=r[i],a=document.createElement("option");a.value=o.value,a.text=o.title,a.setAttribute("aria-label",o.title),o.value==this.defaultValue&&(a.selected=!0),l.appendChild(this._selectElement,a)}return this._selectElement.onchange=function(){e.internalApplyAriaCurrent(),e.valueChanged()},this.internalApplyAriaCurrent(),this._selectElement},t.prototype.getJsonTypeName=function(){return"Input.ChoiceSet"},t.prototype.focus=function(){this._toggleInputs&&(this.isMultiSelect||"expanded"===this.style)?this._toggleInputs.length>0&&this._toggleInputs[0].focus():e.prototype.focus.call(this)},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),0==this.choices.length&&t.addFailure(this,a.ValidationEvent.CollectionCantBeEmpty,f.Strings.errors.choiceSetMustHaveAtLeastOneChoice());for(var n=0,i=this.choices;n<i.length;n++){var r=i[n];r.title&&r.value||t.addFailure(this,a.ValidationEvent.PropertyCantBeNull,f.Strings.errors.choiceSetChoicesMustHaveTitleAndValue())}},t.prototype.isSet=function(){return!!this.value},Object.defineProperty(t.prototype,"value",{get:function(){if(this.isMultiSelect){if(!this._toggleInputs||0==this._toggleInputs.length)return;for(var e="",t=0,n=this._toggleInputs;t<n.length;t++){(o=n[t]).checked&&(""!=e&&(e+=this.hostConfig.choiceSetInputValueSeparator),e+=o.value)}return e||void 0}if(this.isCompact)return this._selectElement&&this._selectElement.selectedIndex>0?this._selectElement.value:void 0;if(this._toggleInputs&&0!=this._toggleInputs.length)for(var i=0,r=this._toggleInputs;i<r.length;i++){var o;if((o=r[i]).checked)return o.value}},enumerable:!1,configurable:!0}),t.valueProperty=new h.StringProperty(h.Versions.v1_0,"value"),t.choicesProperty=new h.SerializableObjectCollectionProperty(h.Versions.v1_0,"choices",N),t.styleProperty=new h.ValueSetProperty(h.Versions.v1_0,"style",[{value:"compact"},{value:"expanded"}],"compact"),t.isMultiSelectProperty=new h.BoolProperty(h.Versions.v1_0,"isMultiSelect",!1),t.placeholderProperty=new h.StringProperty(h.Versions.v1_0,"placeholder"),t.wrapProperty=new h.BoolProperty(h.Versions.v1_2,"wrap",!1),t.uniqueCategoryCounter=0,o([h.property(t.valueProperty)],t.prototype,"defaultValue",void 0),o([h.property(t.styleProperty)],t.prototype,"style",void 0),o([h.property(t.isMultiSelectProperty)],t.prototype,"isMultiSelect",void 0),o([h.property(t.placeholderProperty)],t.prototype,"placeholder",void 0),o([h.property(t.wrapProperty)],t.prototype,"wrap",void 0),o([h.property(t.choicesProperty)],t.prototype,"choices",void 0),t}(V);t.ChoiceSetInput=z;var R=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.internalRender=function(){var e=this;return this._numberInputElement=document.createElement("input"),this._numberInputElement.setAttribute("type","number"),void 0!==this.min&&this._numberInputElement.setAttribute("min",this.min.toString()),void 0!==this.max&&this._numberInputElement.setAttribute("max",this.max.toString()),this._numberInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-numberInput"),this._numberInputElement.style.width="100%",this._numberInputElement.tabIndex=0,void 0!==this.defaultValue&&(this._numberInputElement.valueAsNumber=this.defaultValue),this.placeholder&&(this._numberInputElement.placeholder=this.placeholder,this._numberInputElement.setAttribute("aria-label",this.placeholder)),this._numberInputElement.oninput=function(){e.valueChanged()},this._numberInputElement},t.prototype.getJsonTypeName=function(){return"Input.Number"},t.prototype.isSet=function(){return void 0!==this.value&&!isNaN(this.value)},t.prototype.isValid=function(){if(void 0===this.value)return!this.isRequired;var e=!0;return void 0!==this.min&&(e=e&&this.value>=this.min),void 0!==this.max&&(e=e&&this.value<=this.max),e},Object.defineProperty(t.prototype,"value",{get:function(){return this._numberInputElement?this._numberInputElement.valueAsNumber:void 0},enumerable:!1,configurable:!0}),t.valueProperty=new h.NumProperty(h.Versions.v1_0,"value"),t.placeholderProperty=new h.StringProperty(h.Versions.v1_0,"placeholder"),t.minProperty=new h.NumProperty(h.Versions.v1_0,"min"),t.maxProperty=new h.NumProperty(h.Versions.v1_0,"max"),o([h.property(t.valueProperty)],t.prototype,"defaultValue",void 0),o([h.property(t.minProperty)],t.prototype,"min",void 0),o([h.property(t.maxProperty)],t.prototype,"max",void 0),o([h.property(t.placeholderProperty)],t.prototype,"placeholder",void 0),t}(V);t.NumberInput=R;var L=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.internalRender=function(){var e=this;return this._dateInputElement=document.createElement("input"),this._dateInputElement.setAttribute("type","date"),this.min&&this._dateInputElement.setAttribute("min",this.min),this.max&&this._dateInputElement.setAttribute("max",this.max),this.placeholder&&(this._dateInputElement.placeholder=this.placeholder,this._dateInputElement.setAttribute("aria-label",this.placeholder)),this._dateInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-dateInput"),this._dateInputElement.style.width="100%",this._dateInputElement.oninput=function(){e.valueChanged()},this.defaultValue&&(this._dateInputElement.value=this.defaultValue),this._dateInputElement},t.prototype.getJsonTypeName=function(){return"Input.Date"},t.prototype.isSet=function(){return!!this.value},t.prototype.isValid=function(){if(!this.value)return!this.isRequired;var e=new Date(this.value),t=!0;if(this.min){var n=new Date(this.min);t=t&&e>=n}if(this.max){var i=new Date(this.max);t=t&&e<=i}return t},Object.defineProperty(t.prototype,"value",{get:function(){return this._dateInputElement?this._dateInputElement.value:void 0},enumerable:!1,configurable:!0}),t.valueProperty=new h.StringProperty(h.Versions.v1_0,"value"),t.placeholderProperty=new h.StringProperty(h.Versions.v1_0,"placeholder"),t.minProperty=new h.StringProperty(h.Versions.v1_0,"min"),t.maxProperty=new h.StringProperty(h.Versions.v1_0,"max"),o([h.property(t.valueProperty)],t.prototype,"defaultValue",void 0),o([h.property(t.minProperty)],t.prototype,"min",void 0),o([h.property(t.maxProperty)],t.prototype,"max",void 0),o([h.property(t.placeholderProperty)],t.prototype,"placeholder",void 0),t}(V);t.DateInput=L;var B=function(e){function t(t,n){var i=e.call(this,t,n,(function(e,t,n,i){var r=n[t.name];if("string"==typeof r&&r&&/^[0-9]{2}:[0-9]{2}$/.test(r))return r}),(function(e,t,n,i,r){r.serializeValue(n,t.name,i)}))||this;return i.targetVersion=t,i.name=n,i}return r(t,e),t}(h.CustomProperty);t.TimeProperty=B;var D=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.convertTimeStringToDate=function(e){return new Date("1973-09-04T"+e+":00Z")},t.prototype.internalRender=function(){var e=this;return this._timeInputElement=document.createElement("input"),this._timeInputElement.setAttribute("type","time"),this._timeInputElement.setAttribute("min",this.min),this._timeInputElement.setAttribute("max",this.max),this._timeInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-timeInput"),this._timeInputElement.style.width="100%",this._timeInputElement.oninput=function(){e.valueChanged()},this.placeholder&&(this._timeInputElement.placeholder=this.placeholder,this._timeInputElement.setAttribute("aria-label",this.placeholder)),this.defaultValue&&(this._timeInputElement.value=this.defaultValue),this._timeInputElement},t.prototype.getJsonTypeName=function(){return"Input.Time"},t.prototype.isSet=function(){return!!this.value},t.prototype.isValid=function(){if(!this.value)return!this.isRequired;var e=t.convertTimeStringToDate(this.value),n=!0;if(this.min){var i=t.convertTimeStringToDate(this.min);n=n&&e>=i}if(this.max){var r=t.convertTimeStringToDate(this.max);n=n&&e<=r}return n},Object.defineProperty(t.prototype,"value",{get:function(){return this._timeInputElement?this._timeInputElement.value:void 0},enumerable:!1,configurable:!0}),t.valueProperty=new B(h.Versions.v1_0,"value"),t.placeholderProperty=new h.StringProperty(h.Versions.v1_0,"placeholder"),t.minProperty=new B(h.Versions.v1_0,"min"),t.maxProperty=new B(h.Versions.v1_0,"max"),o([h.property(t.valueProperty)],t.prototype,"defaultValue",void 0),o([h.property(t.minProperty)],t.prototype,"min",void 0),o([h.property(t.maxProperty)],t.prototype,"max",void 0),o([h.property(t.placeholderProperty)],t.prototype,"placeholder",void 0),t}(V);t.TimeInput=D;var M=function(){function e(e,t){this._state=0,this._focusable=!0,this._parentContainerStyle=t,this.action=e}return e.prototype.updateCssStyle=function(){var e,t;if(this.action.parent&&this.action.renderedElement){var n=this.action.parent.hostConfig;switch(this.action.renderedElement.className=n.makeCssClassName("ac-pushButton"),this._parentContainerStyle&&this.action.renderedElement.classList.add("style-"+this._parentContainerStyle),this.action.updateActionButtonCssStyle(this.action.renderedElement,this._state),this.action.renderedElement.tabIndex=this.focusable?0:-1,this.action.renderedElement.classList.remove(n.makeCssClassName("expanded")),this.action.renderedElement.classList.remove(n.makeCssClassName("subdued")),this._state){case 1:this.action.renderedElement.classList.add(n.makeCssClassName("expanded"));break;case 2:this.action.renderedElement.classList.add(n.makeCssClassName("subdued"))}this.action.style&&(this.action.style===a.ActionStyle.Positive?(e=this.action.renderedElement.classList).add.apply(e,n.makeCssClassNames("primary","style-positive")):(t=this.action.renderedElement.classList).add.apply(t,n.makeCssClassNames("style-"+this.action.style.toLowerCase())))}},e.prototype.render=function(){var e=this;this.action.render(),this.action.renderedElement&&(this.action.renderedElement.onclick=function(t){t.preventDefault(),t.cancelBubble=!0,e.click(t)},this.action.renderedElement.onblur=function(t){e.blur()},this.updateCssStyle())},e.prototype.blur=function(){void 0!==this.onBlur&&this.onBlur(this)},e.prototype.click=function(e){void 0!==this.onClick&&this.onClick(this,e)},Object.defineProperty(e.prototype,"action",{get:function(){return this._action},set:function(e){this._action!==e&&(void 0!==this._action&&this._action.renderedElement&&this._action.renderedElement.removeAttribute("onclick"),this._action=e,this.render())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(e){this._state=e,this.updateCssStyle()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"focusable",{get:function(){return this._focusable},set:function(e){e!=this._focusable&&(this._focusable=e,this.updateCssStyle())},enumerable:!1,configurable:!0}),e}(),j=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.style=a.ActionStyle.Default,t.mode=a.ActionMode.Primary,t}return r(t,e),t.prototype.getDefaultSerializationContext=function(){return new me},t.prototype.addCssClasses=function(e){},t.prototype.internalGetReferencedInputs=function(){return{}},t.prototype.internalPrepareForExecution=function(e){},t.prototype.internalValidateInputs=function(e){var t=[];if(e)for(var n=0,i=Object.keys(e);n<i.length;n++){var r=e[i[n]];r.validateValue()||t.push(r)}return t},t.prototype.shouldSerialize=function(e){return void 0!==e.actionRegistry.findByName(this.getJsonTypeName())},t.prototype.raiseExecuteActionEvent=function(){var e,t,n;this.onExecute&&this.onExecute(this),t=(e=this).parent?e.parent.getRootElement():void 0,n=t&&t.onExecuteAction?t.onExecuteAction:fe.onExecuteAction,e.prepareForExecution()&&n&&n(e)},t.prototype.getHref=function(){return""},t.prototype.getAriaRole=function(){return"button"},t.prototype.setupElementForAccessibility=function(e,t){if(void 0===t&&(t=!1),e.tabIndex=0,e.setAttribute("role",this.getAriaRole()),this.title&&(e.setAttribute("aria-label",this.title),e.title=this.title),this.tooltip){var n=t?this.title?"aria-description":"aria-label":"aria-description";e.setAttribute(n,this.tooltip),e.title=this.tooltip}},t.prototype.updateActionButtonCssStyle=function(e,t){void 0===t&&(t=0)},t.prototype.promoteAsPrimary=function(){if(this._actionCollection&&!this._actionCollection.findActionButton(this))return this._actionCollection.promoteAsPrimary(this)},t.prototype.parse=function(t,n){return e.prototype.parse.call(this,t,n||new me)},t.prototype.render=function(){var e=this.hostConfig,t=document.createElement("button");this.addCssClasses(t),null!=this.expanded&&t.setAttribute("aria-expanded",this.expanded.toString()),t.type="button",t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="center";var n=document.createElement("div");if(n.style.overflow="hidden",n.style.textOverflow="ellipsis",e.actions.iconPlacement==a.ActionIconPlacement.AboveTitle||e.actions.allowTitleToWrap||(n.style.whiteSpace="nowrap"),this.title&&(n.innerText=this.title),this.setupElementForAccessibility(t,!0),this.iconUrl){var i=document.createElement("img");i.src=this.iconUrl,i.style.width=e.actions.iconSize+"px",i.style.height=e.actions.iconSize+"px",i.style.flex="0 0 auto",e.actions.iconPlacement==a.ActionIconPlacement.AboveTitle?(t.classList.add("iconAbove"),t.style.flexDirection="column",this.title&&(i.style.marginBottom="6px")):(t.classList.add("iconLeft"),i.style.maxHeight="100%",this.title&&(i.style.marginRight="6px")),t.appendChild(i),t.appendChild(n)}else t.classList.add("noIcon"),t.appendChild(n);this._renderedElement=t},t.prototype.execute=function(){this._actionCollection&&this._actionCollection.actionExecuted(this),this.raiseExecuteActionEvent()},t.prototype.prepareForExecution=function(){var e=this.getReferencedInputs(),t=this.internalValidateInputs(e);return t.length>0?(t[0].focus(),!1):(this.internalPrepareForExecution(e),!0)},t.prototype.remove=function(){return!!this._actionCollection&&this._actionCollection.removeAction(this)},t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),[]},t.prototype.getResourceInformation=function(){return this.iconUrl?[{url:this.iconUrl,mimeType:"image"}]:[]},t.prototype.getActionById=function(e){return this.id===e?this:void 0},t.prototype.getReferencedInputs=function(){return this.internalGetReferencedInputs()},t.prototype.validateInputs=function(){return this.internalValidateInputs(this.getReferencedInputs())},Object.defineProperty(t.prototype,"shouldPromoteAsPrimaryOnExecute",{get:function(){return"primary"===this.mode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isPrimary",{get:function(){return this.style==a.ActionStyle.Positive},set:function(e){e?this.style=a.ActionStyle.Positive:this.style==a.ActionStyle.Positive&&(this.style=a.ActionStyle.Default)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hostConfig",{get:function(){return this.parent?this.parent.hostConfig:p.defaultHostConfig},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),t.titleProperty=new h.StringProperty(h.Versions.v1_0,"title"),t.iconUrlProperty=new h.StringProperty(h.Versions.v1_1,"iconUrl"),t.styleProperty=new h.ValueSetProperty(h.Versions.v1_2,"style",[{value:a.ActionStyle.Default},{value:a.ActionStyle.Positive},{value:a.ActionStyle.Destructive}],a.ActionStyle.Default),t.modeProperty=new h.ValueSetProperty(h.Versions.v1_5,"mode",[{value:a.ActionMode.Primary},{value:a.ActionMode.Secondary}],a.ActionMode.Primary),t.tooltipProperty=new h.StringProperty(h.Versions.v1_5,"tooltip"),o([h.property(t.titleProperty)],t.prototype,"title",void 0),o([h.property(t.iconUrlProperty)],t.prototype,"iconUrl",void 0),o([h.property(t.styleProperty)],t.prototype,"style",void 0),o([h.property(t.modeProperty)],t.prototype,"mode",void 0),o([h.property(t.tooltipProperty)],t.prototype,"tooltip",void 0),t}(c.CardObject);t.Action=j;var F=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._isPrepared=!1,t}return r(t,e),t.prototype.internalGetReferencedInputs=function(){var e={};if("none"!==this.associatedInputs){for(var t=this.parent,n=[];t;)n=n.concat(t.getAllInputs(!1)),t=t.parent;for(var i=0,r=n;i<r.length;i++){var o=r[i];o.id&&(e[o.id]=o)}}return e},t.prototype.internalPrepareForExecution=function(e){if(this._originalData?this._processedData=JSON.parse(JSON.stringify(this._originalData)):this._processedData={},this._processedData&&e)for(var t=0,n=Object.keys(e);t<n.length;t++){var i=e[n[t]];i.id&&i.isSet()&&(this._processedData[i.id]="string"==typeof i.value?i.value:i.value.toString())}this._isPrepared=!0},Object.defineProperty(t.prototype,"data",{get:function(){return this._isPrepared?this._processedData:this._originalData},set:function(e){this._originalData=e,this._isPrepared=!1},enumerable:!1,configurable:!0}),t.dataProperty=new h.PropertyDefinition(h.Versions.v1_0,"data"),t.associatedInputsProperty=new h.CustomProperty(h.Versions.v1_3,"associatedInputs",(function(e,t,n,i){var r=n[t.name];if(void 0!==r&&"string"==typeof r)return"none"===r.toLowerCase()?"none":"auto"}),(function(e,t,n,i,r){r.serializeValue(n,t.name,i)})),o([h.property(t.dataProperty)],t.prototype,"_originalData",void 0),o([h.property(t.associatedInputsProperty)],t.prototype,"associatedInputs",void 0),t}(j);t.SubmitActionBase=F;var H=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.JsonTypeName="Action.Submit",t}(F);t.SubmitAction=H;var W=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.JsonTypeName="Action.Execute",t.verbProperty=new h.StringProperty(h.Versions.v1_4,"verb"),o([h.property(t.verbProperty)],t.prototype,"verb",void 0),t}(F);t.ExecuteAction=W;var J=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.prototype.getAriaRole=function(){return"link"},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this.url||t.addFailure(this,a.ValidationEvent.PropertyCantBeNull,f.Strings.errors.propertyMustBeSet("url"))},t.prototype.getHref=function(){return this.url},t.urlProperty=new h.StringProperty(h.Versions.v1_0,"url"),t.JsonTypeName="Action.OpenUrl",o([h.property(t.urlProperty)],t.prototype,"url",void 0),t}(j);t.OpenUrlAction=J;var q=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.targetElements={},t}return r(t,e),t.prototype.updateAriaControlsAttribute=function(){if(this.targetElements){var e=Object.keys(this.targetElements);this._renderedElement&&(e.length>0?this._renderedElement.setAttribute("aria-controls",e.join(" ")):this._renderedElement.removeAttribute("aria-controls"))}},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this.targetElements||t.addFailure(this,a.ValidationEvent.PropertyCantBeNull,f.Strings.errors.propertyMustBeSet("targetElements"))},t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.prototype.render=function(){e.prototype.render.call(this),this.updateAriaControlsAttribute()},t.prototype.execute=function(){if(this.parent)for(var e=0,t=Object.keys(this.targetElements);e<t.length;e++){var n=t[e],i=this.parent.getRootElement().getElementById(n);i&&("boolean"==typeof this.targetElements[n]?i.isVisible=this.targetElements[n]:i.isVisible=!i.isVisible)}},t.prototype.addTargetElement=function(e,t){void 0===t&&(t=void 0),this.targetElements[e]=t,this.updateAriaControlsAttribute()},t.prototype.removeTargetElement=function(e){delete this.targetElements[e],this.updateAriaControlsAttribute()},t.targetElementsProperty=new h.CustomProperty(h.Versions.v1_2,"targetElements",(function(e,t,n,i){var r={};if(Array.isArray(n[t.name]))for(var o=0,a=n[t.name];o<a.length;o++){var s=a[o];if("string"==typeof s)r[s]=void 0;else if("object"==typeof s){var p=s.elementId;"string"==typeof p&&(r[p]=l.parseBool(s.isVisible))}}return r}),(function(e,t,n,i,r){for(var o=[],a=0,s=Object.keys(i);a<s.length;a++){var l=s[a];"boolean"==typeof i[l]?o.push({elementId:l,isVisible:i[l]}):o.push(l)}r.serializeArray(n,t.name,o)}),{},(function(e){return{}})),t.JsonTypeName="Action.ToggleVisibility",o([h.property(t.targetElementsProperty)],t.prototype,"targetElements",void 0),t}(j);t.ToggleVisibilityAction=q;var U=function(e){function t(t,n){var i=e.call(this,t,n,void 0,(function(){return new s.StringWithSubstitutions}))||this;return i.targetVersion=t,i.name=n,i}return r(t,e),t.prototype.parse=function(e,t,n){var i=new s.StringWithSubstitutions;return i.set(l.parseString(t[this.name])),i},t.prototype.toJSON=function(e,t,n,i){i.serializeValue(t,this.name,n.getOriginal())},t}(h.PropertyDefinition),G=function(e){function t(t,n){void 0===t&&(t=""),void 0===n&&(n="");var i=e.call(this)||this;return i.name=t,i.value=n,i}return r(t,e),t.prototype.getSchemaKey=function(){return"HttpHeader"},t.prototype.getReferencedInputs=function(e,t){this._value.getReferencedInputs(e,t)},t.prototype.prepareForExecution=function(e){this._value.substituteInputValues(e,s.ContentTypes.applicationXWwwFormUrlencoded)},Object.defineProperty(t.prototype,"value",{get:function(){return this._value.get()},set:function(e){this._value.set(e)},enumerable:!1,configurable:!0}),t.nameProperty=new h.StringProperty(h.Versions.v1_0,"name"),t.valueProperty=new U(h.Versions.v1_0,"value"),o([h.property(t.nameProperty)],t.prototype,"name",void 0),o([h.property(t.valueProperty)],t.prototype,"_value",void 0),t}(h.SerializableObject);t.HttpHeader=G;var X=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._ignoreInputValidation=!1,t}return r(t,e),t.prototype.internalGetReferencedInputs=function(){var e=this.parent?this.parent.getRootElement().getAllInputs():[],t={};this._url.getReferencedInputs(e,t);for(var n=0,i=this.headers;n<i.length;n++){i[n].getReferencedInputs(e,t)}return this._body.getReferencedInputs(e,t),t},t.prototype.internalPrepareForExecution=function(e){if(e){this._url.substituteInputValues(e,s.ContentTypes.applicationXWwwFormUrlencoded);for(var t=s.ContentTypes.applicationJson,n=0,i=this.headers;n<i.length;n++){var r=i[n];r.prepareForExecution(e),r.name&&"content-type"==r.name.toLowerCase()&&(t=r.value)}this._body.substituteInputValues(e,t)}},t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.prototype.internalValidateProperties=function(t){if(e.prototype.internalValidateProperties.call(this,t),this.url||t.addFailure(this,a.ValidationEvent.PropertyCantBeNull,f.Strings.errors.propertyMustBeSet("url")),this.headers.length>0)for(var n=0,i=this.headers;n<i.length;n++){i[n].name||t.addFailure(this,a.ValidationEvent.PropertyCantBeNull,f.Strings.errors.actionHttpHeadersMustHaveNameAndValue())}},Object.defineProperty(t.prototype,"ignoreInputValidation",{get:function(){return this._ignoreInputValidation},set:function(e){this._ignoreInputValidation=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"url",{get:function(){return this._url.get()},set:function(e){this._url.set(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"body",{get:function(){return this._body.get()},set:function(e){this._body.set(e)},enumerable:!1,configurable:!0}),t.urlProperty=new U(h.Versions.v1_0,"url"),t.bodyProperty=new U(h.Versions.v1_0,"body"),t.methodProperty=new h.StringProperty(h.Versions.v1_0,"method"),t.headersProperty=new h.SerializableObjectCollectionProperty(h.Versions.v1_0,"headers",G),t.ignoreInputValidationProperty=new h.BoolProperty(h.Versions.v1_3,"ignoreInputValidation",!1),t.JsonTypeName="Action.Http",o([h.property(t.urlProperty)],t.prototype,"_url",void 0),o([h.property(t.bodyProperty)],t.prototype,"_body",void 0),o([h.property(t.methodProperty)],t.prototype,"method",void 0),o([h.property(t.headersProperty)],t.prototype,"headers",void 0),o([h.property(t.ignoreInputValidationProperty)],t.prototype,"_ignoreInputValidation",void 0),t}(j);t.HttpAction=X;var K=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.card=new ye,t}return r(t,e),t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n);var i=t.card;i?this.card.parse(i,n):n.logParseEvent(this,a.ValidationEvent.PropertyCantBeNull,f.Strings.errors.showCardMustHaveCard())},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n),this.card&&n.serializeValue(t,"card",this.card.toJSON(n))},t.prototype.addCssClasses=function(t){e.prototype.addCssClasses.call(this,t),this.parent&&t.classList.add(this.parent.hostConfig.makeCssClassName("expandable"))},t.prototype.raiseExecuteActionEvent=function(){this.hostConfig.actions.showCard.actionMode===a.ShowCardActionMode.Popup&&e.prototype.raiseExecuteActionEvent.call(this)},t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this.card.internalValidateProperties(t)},t.prototype.updateActionButtonCssStyle=function(t,n){void 0===n&&(n=0),e.prototype.updateActionButtonCssStyle.call(this,t),this.parent&&(t.classList.add(this.parent.hostConfig.makeCssClassName("expandable")),t.setAttribute("aria-expanded",(1===n).toString()))},t.prototype.setParent=function(t){e.prototype.setParent.call(this,t),this.card.setParent(t)},t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),this.card.getAllInputs(e)},t.prototype.getResourceInformation=function(){return e.prototype.getResourceInformation.call(this).concat(this.card.getResourceInformation())},t.prototype.getActionById=function(t){var n=e.prototype.getActionById.call(this,t);return n||(n=this.card.getActionById(t)),n},Object.defineProperty(t.prototype,"shouldPromoteAsPrimaryOnExecute",{get:function(){return!0},enumerable:!1,configurable:!0}),t.JsonTypeName="Action.ShowCard",t}(j);t.ShowCardAction=K;var Y=function(e){function t(t){var n=e.call(this)||this;return n.actions=t,n.title=f.Strings.defaults.overflowButtonText(),n}return r(t,e),t.prototype.getActions=function(){return this.actions},t.prototype.getJsonTypeName=function(){return K.JsonTypeName},t.prototype.execute=function(){var e,t,n,i,r,o=this;if((t=this,n=this.renderedElement,i=t.parent?t.parent.getRootElement():void 0,!(void 0!==(r=i&&i.onDisplayOverflowActionMenu?i.onDisplayOverflowActionMenu:fe.onDisplayOverflowActionMenu)&&r(t.getActions(),n)))&&this.renderedElement){var a=new y.PopupMenu;a.hostConfig=this.hostConfig;for(var s=function(t){var n=new y.MenuItem(t.toString(),null!==(e=l.actions[t].title)&&void 0!==e?e:"");n.onClick=function(){var e=o.actions[t];if(e.shouldPromoteAsPrimaryOnExecute){var n=e.promoteAsPrimary();n&&(o.actions[t]=n)}a.closePopup(!1),e.execute()},a.items.add(n)},l=this,p=0;p<this.actions.length;p++)s(p);a.popup(this.renderedElement)}},t.JsonTypeName="Action.Overflow",t}(j),$=function(){function e(e){this._renderedActionCount=0,this._items=[],this._buttons=[],this._owner=e}return e.prototype.isActionAllowed=function(e){var t=this._owner.getForbiddenActionTypes();if(t)for(var n=0,i=t;n<i.length;n++){var r=i[n];if(e.constructor===r)return!1}return!0},e.prototype.refreshContainer=function(){if(this._actionCardContainer.innerHTML="",this._actionCard){this._actionCardContainer.style.marginTop=this._renderedActionCount>0?this._owner.hostConfig.actions.showCard.inlineTopMargin+"px":"0px";var e=this._owner.getEffectivePadding();this._owner.getImmediateSurroundingPadding(e);var t=this._owner.hostConfig.paddingDefinitionToSpacingDefinition(e);this._actionCard&&(this._actionCard.style.paddingLeft=t.left+"px",this._actionCard.style.paddingRight=t.right+"px",this._actionCard.style.marginLeft="-"+t.left+"px",this._actionCard.style.marginRight="-"+t.right+"px",0==t.bottom||this._owner.isDesignMode()||(this._actionCard.style.paddingBottom=t.bottom+"px",this._actionCard.style.marginBottom="-"+t.bottom+"px"),l.appendChild(this._actionCardContainer,this._actionCard))}else this._actionCardContainer.style.marginTop="0px"},e.prototype.layoutChanged=function(){this._owner.getRootElement().updateLayout()},e.prototype.showActionCard=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!0),e.card.suppressStyle=t;var i=e.card.renderedElement&&!this._owner.isDesignMode()?e.card.renderedElement:e.card.render();this._actionCard=i,this._expandedAction=e,this.refreshContainer(),n&&(this.layoutChanged(),ae(e,!0))},e.prototype.collapseExpandedAction=function(){for(var e=0,t=this._buttons;e<t.length;e++){t[e].state=0}var n=this._expandedAction;this._expandedAction=void 0,this._actionCard=void 0,this.refreshContainer(),n&&(this.layoutChanged(),ae(n,!1))},e.prototype.expandShowCardAction=function(e,t){for(var n=this,i=!1,r=0,o=this._buttons;r<o.length;r++){var a=o[r];i&&(a.focusable=!1),a.action!==e?a.state=2:(a.state=1,i=!0,a.onBlur=function(e){for(var t=0,i=n._buttons;t<i.length;t++){i[t].focusable=!0}})}this.showActionCard(e,!(this._owner.isAtTheVeryLeft()&&this._owner.isAtTheVeryRight()),t)},e.prototype.getParentContainer=function(){return this._owner instanceof te?this._owner:this._owner.getParentContainer()},e.prototype.promoteAsPrimary=function(e){if(this._buttons.length>1){var t=this._buttons[this._buttons.length-2],n=t.action;if(e.render(),n.renderedElement&&n.renderedElement.parentElement&&e.renderedElement)return t.action=e,n.renderedElement.parentElement.replaceChild(e.renderedElement,n.renderedElement),e.renderedElement.setAttribute("aria-posinset",(this._buttons.length-1).toString()),e.renderedElement.setAttribute("aria-setsize",this._buttons.length.toString()),e.renderedElement.setAttribute("role","menuitem"),n.renderedElement.removeAttribute("aria-posinset"),n.renderedElement.removeAttribute("aria-setsize"),n.renderedElement.removeAttribute("role"),n}},e.prototype.actionExecuted=function(e){e instanceof K?e===this._expandedAction?this.collapseExpandedAction():this.expandShowCardAction(e,!0):this.collapseExpandedAction()},e.prototype.parse=function(e,t){if(this.clear(),Array.isArray(e))for(var n=0,i=e;n<i.length;n++){var r=i[n],o=t.parseAction(this._owner,r,[],!this._owner.isDesignMode());o&&this.addAction(o)}},e.prototype.toJSON=function(e,t,n){n.serializeArray(e,t,this._items)},e.prototype.getActionAt=function(e){return this._items[e]},e.prototype.getActionCount=function(){return this._items.length},e.prototype.getActionById=function(e){for(var t=void 0,n=0,i=this._items;n<i.length;n++){if(t=i[n].getActionById(e))break}return t},e.prototype.validateProperties=function(e){this._owner.hostConfig.actions.maxActions&&this._items.length>this._owner.hostConfig.actions.maxActions&&e.addFailure(this._owner,a.ValidationEvent.TooManyActions,f.Strings.errors.tooManyActions(this._owner.hostConfig.actions.maxActions)),this._items.length>0&&!this._owner.hostConfig.supportsInteractivity&&e.addFailure(this._owner,a.ValidationEvent.InteractivityNotAllowed,f.Strings.errors.interactivityNotAllowed());for(var t=0,n=this._items;t<n.length;t++){var i=n[t];this.isActionAllowed(i)||e.addFailure(this._owner,a.ValidationEvent.ActionTypeNotAllowed,f.Strings.errors.actionTypeNotAllowed(i.getJsonTypeName())),i.internalValidateProperties(e)}},e.prototype.render=function(e,t){var n=this._owner.hostConfig;if(n.supportsInteractivity){var i,r,o,p,u=document.createElement("div"),c=n.actions.maxActions?Math.min(n.actions.maxActions,this._items.length):this._items.length;if(this._actionCardContainer=document.createElement("div"),this._renderedActionCount=0,n.actions.preExpandSingleShowCardAction&&1==c&&this._items[0]instanceof K&&this.isActionAllowed(this._items[0]))this.showActionCard(this._items[0],!0),this._renderedActionCount=1;else{var h=document.createElement("div");if(h.className=n.makeCssClassName("ac-actionSet"),h.style.display="flex",h.setAttribute("role","menubar"),e==a.Orientation.Horizontal)if(h.style.flexDirection="row",this._owner.horizontalAlignment&&n.actions.actionAlignment!=a.ActionAlignment.Stretch)switch(this._owner.horizontalAlignment){case a.HorizontalAlignment.Center:h.style.justifyContent="center";break;case a.HorizontalAlignment.Right:h.style.justifyContent="flex-end";break;default:h.style.justifyContent="flex-start"}else switch(n.actions.actionAlignment){case a.ActionAlignment.Center:h.style.justifyContent="center";break;case a.ActionAlignment.Right:h.style.justifyContent="flex-end";break;default:h.style.justifyContent="flex-start"}else if(h.style.flexDirection="column",this._owner.horizontalAlignment&&n.actions.actionAlignment!=a.ActionAlignment.Stretch)switch(this._owner.horizontalAlignment){case a.HorizontalAlignment.Center:h.style.alignItems="center";break;case a.HorizontalAlignment.Right:h.style.alignItems="flex-end";break;default:h.style.alignItems="flex-start"}else switch(n.actions.actionAlignment){case a.ActionAlignment.Center:h.style.alignItems="center";break;case a.ActionAlignment.Right:h.style.alignItems="flex-end";break;case a.ActionAlignment.Stretch:h.style.alignItems="stretch";break;default:h.style.alignItems="flex-start"}var d=this.getParentContainer();if(d){var f=d.getEffectiveStyle(),y=[],g=[],m=this._items.filter(this.isActionAllowed.bind(this));if(this._owner.isDesignMode())y=m;else{m.forEach((function(e){return e.mode===a.ActionMode.Secondary?g.push(e):y.push(e)}));var v=y.splice(n.actions.maxActions);s.GlobalSettings.allowMoreThanMaxActionsInOverflowMenu&&g.push.apply(g,v);var b=!0;if(g.length>0){this._overflowAction||(this._overflowAction=new Y(g),this._overflowAction.setParent(this._owner),this._overflowAction._actionCollection=this);var C=this._owner instanceof fe&&!this._owner.parent;i=this._overflowAction,r=C,o=i.parent?i.parent.getRootElement():void 0,b=!(void 0!==(p=o&&o.onRenderOverflowActions?o.onRenderOverflowActions:fe.onRenderOverflowActions)&&p(i.getActions(),r))}this._overflowAction&&b&&y.push(this._overflowAction)}for(var S=0;S<y.length;S++){var _=this.findActionButton(y[S]);if(_||((_=new M(y[S],f)).onClick=function(e){e.action.execute()},this._buttons.push(_)),_.render(),_.action.renderedElement&&(y.length>1&&(_.action.renderedElement.setAttribute("aria-posinset",(S+1).toString()),_.action.renderedElement.setAttribute("aria-setsize",y.length.toString()),_.action.renderedElement.setAttribute("role","menuitem")),n.actions.actionsOrientation==a.Orientation.Horizontal&&n.actions.actionAlignment==a.ActionAlignment.Stretch?_.action.renderedElement.style.flex="0 1 100%":_.action.renderedElement.style.flex="0 1 auto",h.appendChild(_.action.renderedElement),this._renderedActionCount++,S<y.length-1&&n.actions.buttonSpacing>0)){var P=document.createElement("div");e===a.Orientation.Horizontal?(P.style.flex="0 0 auto",P.style.width=n.actions.buttonSpacing+"px"):P.style.height=n.actions.buttonSpacing+"px",l.appendChild(h,P)}}}var A=document.createElement("div");A.style.overflow="hidden",A.appendChild(h),l.appendChild(u,A)}l.appendChild(u,this._actionCardContainer);for(var E=0,w=this._buttons;E<w.length;E++){var x=w[E];if(1==x.state){this.expandShowCardAction(x.action,!1);break}}return this._renderedActionCount>0?u:void 0}},e.prototype.addAction=function(e){if(!e)throw new Error("The action parameter cannot be null.");if(e.parent&&e.parent!==this._owner||!(this._items.indexOf(e)<0))throw new Error(f.Strings.errors.actionAlreadyParented());this._items.push(e),e.parent||e.setParent(this._owner),e._actionCollection=this},e.prototype.removeAction=function(e){this.expandedAction&&this._expandedAction==e&&this.collapseExpandedAction();var t=this._items.indexOf(e);if(t>=0){this._items.splice(t,1),e.setParent(void 0),e._actionCollection=void 0;for(var n=0;n<this._buttons.length;n++)if(this._buttons[n].action==e){this._buttons.splice(n,1);break}return!0}return!1},e.prototype.clear=function(){this._items=[],this._buttons=[],this._expandedAction=void 0,this._renderedActionCount=0},e.prototype.getAllInputs=function(e){void 0===e&&(e=!0);var t=[];if(e)for(var n=0,i=this._items;n<i.length;n++){var r=i[n];t=t.concat(r.getAllInputs())}return t},e.prototype.findActionButton=function(e){for(var t=0,n=this._buttons;t<n.length;t++){var i=n[t];if(i.action==e)return i}},e.prototype.getResourceInformation=function(){for(var e=[],t=0,n=this._items;t<n.length;t++){var i=n[t];e=e.concat(i.getResourceInformation())}return e},Object.defineProperty(e.prototype,"renderedActionCount",{get:function(){return this._renderedActionCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"expandedAction",{get:function(){return this._expandedAction},enumerable:!1,configurable:!0}),e}(),Z=function(e){function t(){var t=e.call(this)||this;return t._actionCollection=new $(t),t}return r(t,e),t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this._actionCollection.parse(t.actions,n)},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n),this._actionCollection.toJSON(t,"actions",n)},t.prototype.internalRender=function(){return this._actionCollection.render(void 0!==this.orientation?this.orientation:this.hostConfig.actions.actionsOrientation,this.isDesignMode())},t.prototype.isBleedingAtBottom=function(){return 0==this._actionCollection.renderedActionCount?e.prototype.isBleedingAtBottom.call(this):1==this._actionCollection.getActionCount()?void 0!==this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:void 0!==this._actionCollection.expandedAction},t.prototype.getJsonTypeName=function(){return"ActionSet"},t.prototype.getActionCount=function(){return this._actionCollection.getActionCount()},t.prototype.getActionAt=function(t){return t>=0&&t<this.getActionCount()?this._actionCollection.getActionAt(t):e.prototype.getActionAt.call(this,t)},t.prototype.getActionById=function(t){var n=this._actionCollection.getActionById(t);return n||e.prototype.getActionById.call(this,t)},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this._actionCollection.validateProperties(t)},t.prototype.addAction=function(e){this._actionCollection.addAction(e)},t.prototype.getAllInputs=function(e){return void 0===e&&(e=!0),e?this._actionCollection.getAllInputs():[]},t.prototype.getResourceInformation=function(){return this._actionCollection.getResourceInformation()},t.prototype.findDOMNodeOwner=function(t){for(var n=void 0,i=0;i<this.getActionCount();i++){var r=this.getActionAt(i);if(r&&(n=r.findDOMNodeOwner(t)))return n}return e.prototype.findDOMNodeOwner.call(this,t)},Object.defineProperty(t.prototype,"isInteractive",{get:function(){return!0},enumerable:!1,configurable:!0}),t.orientationProperty=new h.EnumProperty(h.Versions.v1_1,"orientation",a.Orientation),o([h.property(t.orientationProperty)],t.prototype,"orientation",void 0),t}(g);t.ActionSet=Z;var Q=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._bleed=!1,t}return r(t,e),Object.defineProperty(t.prototype,"style",{get:function(){if(this.allowCustomStyle){var e=this.getValue(t.styleProperty);if(e&&this.hostConfig.containerStyles.getStyleByName(e))return e}},set:function(e){this.setValue(t.styleProperty,e)},enumerable:!1,configurable:!0}),t.prototype.adjustRenderedElementSize=function(t){e.prototype.adjustRenderedElementSize.call(this,t),this.minPixelHeight&&(t.style.minHeight=this.minPixelHeight+"px")},t.prototype.applyBackground=function(){if(this.renderedElement){var e=this.hostConfig.containerStyles.getStyleByName(this.style,this.hostConfig.containerStyles.getStyleByName(this.defaultStyle));if(e.backgroundColor){var t=l.stringToCssColor(e.backgroundColor);this.renderedElement.style.backgroundColor=t,this.renderedElement.style.border="1px solid "+t}}},t.prototype.applyPadding=function(){if(e.prototype.applyPadding.call(this),this.renderedElement){var t=new s.SpacingDefinition;if(this.getEffectivePadding()&&(t=this.hostConfig.paddingDefinitionToSpacingDefinition(this.getEffectivePadding())),this.renderedElement.style.paddingTop=t.top+"px",this.renderedElement.style.paddingRight=t.right+"px",this.renderedElement.style.paddingBottom=t.bottom+"px",this.renderedElement.style.paddingLeft=t.left+"px",this.isBleeding()){var n=new s.PaddingDefinition;this.getImmediateSurroundingPadding(n);var i=this.hostConfig.paddingDefinitionToSpacingDefinition(n);this.renderedElement.style.marginRight="-"+i.right+"px",this.renderedElement.style.marginLeft="-"+i.left+"px",this.isDesignMode()||(this.renderedElement.style.marginTop="-"+i.top+"px",this.renderedElement.style.marginBottom="-"+i.bottom+"px"),this.separatorElement&&this.separatorOrientation==a.Orientation.Horizontal&&(this.separatorElement.style.marginLeft="-"+i.left+"px",this.separatorElement.style.marginRight="-"+i.right+"px")}else this.renderedElement.style.marginRight="0",this.renderedElement.style.marginLeft="0",this.renderedElement.style.marginTop="0",this.renderedElement.style.marginBottom="0",this.separatorElement&&this.separatorOrientation===a.Orientation.Horizontal&&(this.separatorElement.style.marginRight="0",this.separatorElement.style.marginLeft="0")}},t.prototype.getHasBackground=function(){for(var e=this.parent;e;){var n=e instanceof te&&e.backgroundImage.isValid();if(e instanceof t&&this.hasExplicitStyle&&(e.getEffectiveStyle()!=this.getEffectiveStyle()||n))return!0;e=e.parent}return!1},t.prototype.getDefaultPadding=function(){return this.getHasBackground()?new s.PaddingDefinition(a.Spacing.Padding,a.Spacing.Padding,a.Spacing.Padding,a.Spacing.Padding):e.prototype.getDefaultPadding.call(this)},t.prototype.getHasExpandedAction=function(){return!1},t.prototype.getBleed=function(){return this._bleed},t.prototype.setBleed=function(e){this._bleed=e},Object.defineProperty(t.prototype,"renderedActionCount",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasExplicitStyle",{get:function(){return void 0!==this.getValue(t.styleProperty)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowCustomStyle",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.isBleeding=function(){return(this.getHasBackground()||this.hostConfig.alwaysAllowBleed)&&this.getBleed()},t.prototype.internalValidateProperties=function(n){e.prototype.internalValidateProperties.call(this,n);var i=this.getValue(t.styleProperty);void 0!==i&&(this.hostConfig.containerStyles.getStyleByName(i)||n.addFailure(this,a.ValidationEvent.InvalidPropertyValue,f.Strings.errors.invalidPropertyValue(i,"style")))},t.prototype.render=function(){var t=e.prototype.render.call(this);return t&&this.getHasBackground()&&this.applyBackground(),t},t.prototype.getEffectiveStyle=function(){var t=this.style;return t||e.prototype.getEffectiveStyle.call(this)},t.styleProperty=new h.ValueSetProperty(h.Versions.v1_0,"style",[{value:a.ContainerStyle.Default},{value:a.ContainerStyle.Emphasis},{targetVersion:h.Versions.v1_2,value:a.ContainerStyle.Accent},{targetVersion:h.Versions.v1_2,value:a.ContainerStyle.Good},{targetVersion:h.Versions.v1_2,value:a.ContainerStyle.Attention},{targetVersion:h.Versions.v1_2,value:a.ContainerStyle.Warning}]),t.bleedProperty=new h.BoolProperty(h.Versions.v1_2,"bleed",!1),t.minHeightProperty=new h.PixelSizeProperty(h.Versions.v1_2,"minHeight"),o([h.property(t.styleProperty)],t.prototype,"style",null),o([h.property(t.bleedProperty)],t.prototype,"_bleed",void 0),o([h.property(t.minHeightProperty)],t.prototype,"minPixelHeight",void 0),t}(w);t.StylableCardElementContainer=Q;var ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getSchemaKey=function(){return"BackgroundImage"},t.prototype.internalParse=function(t,n){if("string"!=typeof t)return e.prototype.internalParse.call(this,t,n);this.resetDefaultValues(),this.url=t},t.prototype.apply=function(e){if(this.url&&e.renderedElement){switch(e.renderedElement.style.backgroundImage="url('"+e.preProcessPropertyValue(t.urlProperty,this.url)+"')",this.fillMode){case a.FillMode.Repeat:e.renderedElement.style.backgroundRepeat="repeat";break;case a.FillMode.RepeatHorizontally:e.renderedElement.style.backgroundRepeat="repeat-x";break;case a.FillMode.RepeatVertically:e.renderedElement.style.backgroundRepeat="repeat-y";break;case a.FillMode.Cover:default:e.renderedElement.style.backgroundRepeat="no-repeat",e.renderedElement.style.backgroundSize="cover"}switch(this.horizontalAlignment){case a.HorizontalAlignment.Center:e.renderedElement.style.backgroundPositionX="center";break;case a.HorizontalAlignment.Right:e.renderedElement.style.backgroundPositionX="right"}switch(this.verticalAlignment){case a.VerticalAlignment.Center:e.renderedElement.style.backgroundPositionY="center";break;case a.VerticalAlignment.Bottom:e.renderedElement.style.backgroundPositionY="bottom"}}},t.prototype.isValid=function(){return!!this.url},t.urlProperty=new h.StringProperty(h.Versions.v1_0,"url"),t.fillModeProperty=new h.EnumProperty(h.Versions.v1_2,"fillMode",a.FillMode,a.FillMode.Cover),t.horizontalAlignmentProperty=new h.EnumProperty(h.Versions.v1_2,"horizontalAlignment",a.HorizontalAlignment,a.HorizontalAlignment.Left),t.verticalAlignmentProperty=new h.EnumProperty(h.Versions.v1_2,"verticalAlignment",a.VerticalAlignment,a.VerticalAlignment.Top),o([h.property(t.urlProperty)],t.prototype,"url",void 0),o([h.property(t.fillModeProperty)],t.prototype,"fillMode",void 0),o([h.property(t.horizontalAlignmentProperty)],t.prototype,"horizontalAlignment",void 0),o([h.property(t.verticalAlignmentProperty)],t.prototype,"verticalAlignment",void 0),t}(h.SerializableObject);t.BackgroundImage=ee;var te=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.verticalContentAlignment=a.VerticalAlignment.Top,t._items=[],t._renderedItems=[],t}return r(t,e),Object.defineProperty(t.prototype,"backgroundImage",{get:function(){return this.getValue(t.backgroundImageProperty)},enumerable:!1,configurable:!0}),t.prototype.insertItemAt=function(e,t,n){if(e.parent&&!n)throw new Error(f.Strings.errors.elementAlreadyParented());if(!e.isStandalone)throw new Error(f.Strings.errors.elementTypeNotStandalone(e.getJsonTypeName()));t<0||t>=this._items.length?this._items.push(e):this._items.splice(t,0,e),e.setParent(this)},t.prototype.supportsExcplitiHeight=function(){return!0},t.prototype.getItemsCollectionPropertyName=function(){return"items"},t.prototype.applyBackground=function(){this.backgroundImage.isValid()&&this.renderedElement&&this.backgroundImage.apply(this),e.prototype.applyBackground.call(this)},t.prototype.internalRender=function(){this._renderedItems=[];var e=this.hostConfig,t=document.createElement("div");switch(void 0!==this.rtl&&(t.dir=this.rtl?"rtl":"ltr"),t.classList.add(e.makeCssClassName("ac-container")),t.style.display="flex",t.style.flexDirection="column",s.GlobalSettings.useAdvancedCardBottomTruncation&&(t.style.minHeight="-webkit-min-content"),this.verticalContentAlignment){case a.VerticalAlignment.Center:t.style.justifyContent="center";break;case a.VerticalAlignment.Bottom:t.style.justifyContent="flex-end";break;default:t.style.justifyContent="flex-start"}if(this._items.length>0)for(var n=0,i=this._items;n<i.length;n++){var r=i[n],o=this.isElementAllowed(r)?r.render():void 0;o&&(this._renderedItems.length>0&&r.separatorElement&&(r.separatorElement.style.flex="0 0 auto",l.appendChild(t,r.separatorElement)),l.appendChild(t,o),this._renderedItems.push(r))}else if(this.isDesignMode()){var p=this.createPlaceholderElement();p.style.width="100%",p.style.height="100%",t.appendChild(p)}return t},t.prototype.truncateOverflow=function(e){if(this.renderedElement){for(var t=this.renderedElement.offsetTop+e+1,n=function(e){var i=e.renderedElement;if(i)switch(l.getFitStatus(i,t)){case a.ContainerFitStatus.FullyInContainer:e.resetOverflow()&&n(e);break;case a.ContainerFitStatus.Overflowing:var r=t-i.offsetTop;e.handleOverflow(r);break;case a.ContainerFitStatus.FullyOutOfContainer:e.handleOverflow(0)}},i=0,r=this._items;i<r.length;i++){var o=r[i];n(o)}return!0}return!1},t.prototype.undoOverflowTruncation=function(){for(var e=0,t=this._items;e<t.length;e++){t[e].resetOverflow()}},t.prototype.getHasBackground=function(){return this.backgroundImage.isValid()||e.prototype.getHasBackground.call(this)},t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this.clear(),this.setShouldFallback(!1);var i=t[this.getItemsCollectionPropertyName()];if(Array.isArray(i))for(var r=0,o=i;r<o.length;r++){var a=o[r],s=n.parseElement(this,a,!this.isDesignMode());s&&this.insertItemAt(s,-1,!0)}},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n),n.serializeArray(t,this.getItemsCollectionPropertyName(),this._items)},Object.defineProperty(t.prototype,"isSelectable",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.getItemCount=function(){return this._items.length},t.prototype.getItemAt=function(e){return this._items[e]},t.prototype.getFirstVisibleRenderedItem=function(){if(this.renderedElement&&this._renderedItems&&this._renderedItems.length>0)for(var e=0,t=this._renderedItems;e<t.length;e++){var n=t[e];if(n.isVisible)return n}},t.prototype.getLastVisibleRenderedItem=function(){if(this.renderedElement&&this._renderedItems&&this._renderedItems.length>0)for(var e=this._renderedItems.length-1;e>=0;e--)if(this._renderedItems[e].isVisible)return this._renderedItems[e]},t.prototype.getJsonTypeName=function(){return"Container"},t.prototype.isFirstElement=function(e){for(var t=this.isDesignMode(),n=0,i=this._items;n<i.length;n++){var r=i[n];if(r.isVisible||t)return r==e}return!1},t.prototype.isLastElement=function(e){for(var t=this.isDesignMode(),n=this._items.length-1;n>=0;n--)if(this._items[n].isVisible||t)return this._items[n]==e;return!1},t.prototype.isRtl=function(){if(void 0!==this.rtl)return this.rtl;var e=this.getParentContainer();return!!e&&e.isRtl()},t.prototype.isBleedingAtTop=function(){var e=this.getFirstVisibleRenderedItem();return this.isBleeding()||!!e&&e.isBleedingAtTop()},t.prototype.isBleedingAtBottom=function(){var e=this.getLastVisibleRenderedItem();return this.isBleeding()||!!e&&(e.isBleedingAtBottom()&&e.getEffectiveStyle()==this.getEffectiveStyle())},t.prototype.indexOf=function(e){return this._items.indexOf(e)},t.prototype.addItem=function(e){this.insertItemAt(e,-1,!1)},t.prototype.insertItemBefore=function(e,t){this.insertItemAt(e,this._items.indexOf(t),!1)},t.prototype.insertItemAfter=function(e,t){this.insertItemAt(e,this._items.indexOf(t)+1,!1)},t.prototype.removeItem=function(e){var t=this._items.indexOf(e);return t>=0&&(this._items.splice(t,1),e.setParent(void 0),this.updateLayout(),!0)},t.prototype.clear=function(){this._items=[],this._renderedItems=[]},t.prototype.getResourceInformation=function(){var t=e.prototype.getResourceInformation.call(this);return this.backgroundImage.isValid()&&t.push({url:this.backgroundImage.url,mimeType:"image"}),t},t.prototype.getActionById=function(t){var n=e.prototype.getActionById.call(this,t);if(!n&&(this.selectAction&&(n=this.selectAction.getActionById(t)),!n))for(var i=0,r=this._items;i<r.length;i++){if(n=r[i].getActionById(t))break}return n},Object.defineProperty(t.prototype,"padding",{get:function(){return this.getPadding()},set:function(e){this.setPadding(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectAction",{get:function(){return this._selectAction},set:function(e){this._selectAction=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bleed",{get:function(){return this.getBleed()},set:function(e){this.setBleed(e)},enumerable:!1,configurable:!0}),t.backgroundImageProperty=new h.SerializableObjectProperty(h.Versions.v1_0,"backgroundImage",ee),t.verticalContentAlignmentProperty=new h.EnumProperty(h.Versions.v1_1,"verticalContentAlignment",a.VerticalAlignment,a.VerticalAlignment.Top),t.rtlProperty=new h.BoolProperty(h.Versions.v1_0,"rtl"),o([h.property(t.backgroundImageProperty)],t.prototype,"backgroundImage",null),o([h.property(t.verticalContentAlignmentProperty)],t.prototype,"verticalContentAlignment",void 0),o([h.property(t.rtlProperty)],t.prototype,"rtl",void 0),t}(Q);t.Container=te;var ne=function(e){function t(t){void 0===t&&(t="stretch");var n=e.call(this)||this;return n.width="stretch",n._computedWeight=0,n.width=t,n}return r(t,e),t.prototype.adjustRenderedElementSize=function(e){this.isDesignMode()?(e.style.minWidth="20px",e.style.minHeight=(this.minPixelHeight?Math.max(this.minPixelHeight,20):20)+"px"):(e.style.minWidth="0",this.minPixelHeight&&(e.style.minHeight=this.minPixelHeight+"px")),"auto"===this.width?e.style.flex="0 1 auto":"stretch"===this.width?e.style.flex="1 1 50px":this.width instanceof s.SizeAndUnit&&(this.width.unit==a.SizeUnit.Pixel?(e.style.flex="0 0 auto",e.style.width=this.width.physicalSize+"px"):e.style.flex="1 1 "+(this._computedWeight>0?this._computedWeight:this.width.physicalSize)+"%")},t.prototype.shouldSerialize=function(e){return!0},Object.defineProperty(t.prototype,"separatorOrientation",{get:function(){return a.Orientation.Vertical},enumerable:!1,configurable:!0}),t.prototype.getJsonTypeName=function(){return"Column"},Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){return!!(this.parent&&this.parent instanceof ie)&&(void 0!==this.separatorElement&&!this.parent.isLeftMostElement(this))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),t.widthProperty=new h.CustomProperty(h.Versions.v1_0,"width",(function(e,t,n,i){var r=t.defaultValue,o=n[t.name],l=!1;if("number"!=typeof o||isNaN(o))if("auto"===o||"stretch"===o)r=o;else if("string"==typeof o)try{(r=s.SizeAndUnit.parse(o)).unit===a.SizeUnit.Pixel&&t.targetVersion.compareTo(i.targetVersion)>0&&(l=!0)}catch(e){l=!0}else l=!0;else r=new s.SizeAndUnit(o,a.SizeUnit.Weight);return l&&(i.logParseEvent(e,a.ValidationEvent.InvalidPropertyValue,f.Strings.errors.invalidColumnWidth(o)),r="auto"),r}),(function(e,t,n,i,r){i instanceof s.SizeAndUnit?i.unit===a.SizeUnit.Pixel?r.serializeValue(n,"width",i.physicalSize+"px"):r.serializeNumber(n,"width",i.physicalSize):r.serializeValue(n,"width",i)}),"stretch"),o([h.property(t.widthProperty)],t.prototype,"width",void 0),t}(te);t.Column=ne;var ie=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._columns=[],t}return r(t,e),t.prototype.createColumnInstance=function(e,t){return t.parseCardObject(this,e,[],!this.isDesignMode(),(function(e){return e&&"Column"!==e?void 0:new ne}),(function(e,n){t.logParseEvent(void 0,a.ValidationEvent.ElementTypeNotAllowed,f.Strings.errors.elementTypeNotAllowed(e))}))},t.prototype.internalRender=function(){if(this._renderedColumns=[],this._columns.length>0){var e=this.hostConfig,t=document.createElement("div");switch(t.className=e.makeCssClassName("ac-columnSet"),t.style.display="flex",s.GlobalSettings.useAdvancedCardBottomTruncation&&(t.style.minHeight="-webkit-min-content"),this.horizontalAlignment){case a.HorizontalAlignment.Center:t.style.justifyContent="center";break;case a.HorizontalAlignment.Right:t.style.justifyContent="flex-end";break;default:t.style.justifyContent="flex-start"}for(var n=0,i=0,r=this._columns;i<r.length;i++){(u=r[i]).width instanceof s.SizeAndUnit&&u.width.unit==a.SizeUnit.Weight&&(n+=u.width.physicalSize)}for(var o=0,p=this._columns;o<p.length;o++){var u;if((u=p[o]).width instanceof s.SizeAndUnit&&u.width.unit==a.SizeUnit.Weight&&n>0){var c=100/n*u.width.physicalSize;u._computedWeight=c}var h=u.render();h&&(this._renderedColumns.length>0&&u.separatorElement&&(u.separatorElement.style.flex="0 0 auto",l.appendChild(t,u.separatorElement)),l.appendChild(t,h),this._renderedColumns.push(u))}return this._renderedColumns.length>0?t:void 0}},t.prototype.truncateOverflow=function(e){for(var t=0,n=this._columns;t<n.length;t++){n[t].handleOverflow(e)}return!0},t.prototype.undoOverflowTruncation=function(){for(var e=0,t=this._columns;e<t.length;e++){t[e].resetOverflow()}},Object.defineProperty(t.prototype,"isSelectable",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this._columns=[],this._renderedColumns=[];var i=t.columns;if(Array.isArray(i))for(var r=0,o=i;r<o.length;r++){var a=o[r],s=this.createColumnInstance(a,n);s&&this._columns.push(s)}},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n),n.serializeArray(t,"columns",this._columns)},t.prototype.isFirstElement=function(e){for(var t=0,n=this._columns;t<n.length;t++){var i=n[t];if(i.isVisible)return i==e}return!1},t.prototype.isBleedingAtTop=function(){if(this.isBleeding())return!0;if(this._renderedColumns&&this._renderedColumns.length>0)for(var e=0,t=this._columns;e<t.length;e++){if(t[e].isBleedingAtTop())return!0}return!1},t.prototype.isBleedingAtBottom=function(){if(this.isBleeding())return!0;if(this._renderedColumns&&this._renderedColumns.length>0)for(var e=0,t=this._columns;e<t.length;e++){if(t[e].isBleedingAtBottom())return!0}return!1},t.prototype.getItemCount=function(){return this._columns.length},t.prototype.getFirstVisibleRenderedItem=function(){return this.renderedElement&&this._renderedColumns&&this._renderedColumns.length>0?this._renderedColumns[0]:void 0},t.prototype.getLastVisibleRenderedItem=function(){return this.renderedElement&&this._renderedColumns&&this._renderedColumns.length>0?this._renderedColumns[this._renderedColumns.length-1]:void 0},t.prototype.getColumnAt=function(e){return this._columns[e]},t.prototype.getItemAt=function(e){return this.getColumnAt(e)},t.prototype.getJsonTypeName=function(){return"ColumnSet"},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t);for(var n=0,i=0,r=0,o=this._columns;r<o.length;r++){var s=o[r];"number"==typeof s.width?n++:"stretch"===s.width&&i++}n>0&&i>0&&t.addFailure(this,a.ValidationEvent.Hint,f.Strings.hints.dontUseWeightedAndStrecthedColumnsInSameSet())},t.prototype.addColumn=function(e){if(e.parent)throw new Error(f.Strings.errors.columnAlreadyBelongsToAnotherSet());this._columns.push(e),e.setParent(this)},t.prototype.removeItem=function(e){if(e instanceof ne){var t=this._columns.indexOf(e);if(t>=0)return this._columns.splice(t,1),e.setParent(void 0),this.updateLayout(),!0}return!1},t.prototype.indexOf=function(e){return e instanceof ne?this._columns.indexOf(e):-1},t.prototype.isLeftMostElement=function(e){return 0==this._columns.indexOf(e)},t.prototype.isRightMostElement=function(e){return this._columns.indexOf(e)==this._columns.length-1},t.prototype.isTopElement=function(e){return this._columns.indexOf(e)>=0},t.prototype.isBottomElement=function(e){return this._columns.indexOf(e)>=0},t.prototype.getActionById=function(e){for(var t=void 0,n=0,i=this._columns;n<i.length;n++){if(t=i[n].getActionById(e))break}return t},Object.defineProperty(t.prototype,"bleed",{get:function(){return this.getBleed()},set:function(e){this.setBleed(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"padding",{get:function(){return this.getPadding()},set:function(e){this.setPadding(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectAction",{get:function(){return this._selectAction},set:function(e){this._selectAction=e},enumerable:!1,configurable:!0}),t}(Q);function re(e){var t=e.getRootElement(),n=t&&t.onImageLoaded?t.onImageLoaded:fe.onImageLoaded;n&&n(e)}function oe(e,t,n){var i=e.getRootElement(),r=i&&i.onAnchorClicked?i.onAnchorClicked:fe.onAnchorClicked;return void 0!==r&&r(e,t,n)}function ae(e,t){var n=e.parent?e.parent.getRootElement():void 0,i=n&&n.onInlineCardExpanded?n.onInlineCardExpanded:fe.onInlineCardExpanded;i&&i(e,t)}function se(e,t){void 0===t&&(t=!0);var n=e.getRootElement();t&&n.updateLayout();var i=n,r=i&&i.onElementVisibilityChanged?i.onElementVisibilityChanged:fe.onElementVisibilityChanged;void 0!==r&&r(e)}t.ColumnSet=ie;var le=function(e){function t(){var t=e.call(this)||this;return t._actionCollection=new $(t),t}return r(t,e),t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n),this._actionCollection.parse(t.actions,n)},t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n),this._actionCollection.toJSON(t,"actions",n)},t.prototype.internalRender=function(){var t=e.prototype.internalRender.call(this);if(t){var n=this._actionCollection.render(this.hostConfig.actions.actionsOrientation,!1);return n&&(l.appendChild(t,l.renderSeparation(this.hostConfig,{spacing:this.hostConfig.getEffectiveSpacing(this.hostConfig.actions.spacing)},a.Orientation.Horizontal)),l.appendChild(t,n)),this.renderIfEmpty?t:t.children.length>0?t:void 0}},t.prototype.getHasExpandedAction=function(){return 0!=this.renderedActionCount&&(1==this.renderedActionCount?void 0!==this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:void 0!==this._actionCollection.expandedAction)},Object.defineProperty(t.prototype,"renderedActionCount",{get:function(){return this._actionCollection.renderedActionCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderIfEmpty",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.getActionCount=function(){return this._actionCollection.getActionCount()},t.prototype.getActionAt=function(t){return t>=0&&t<this.getActionCount()?this._actionCollection.getActionAt(t):e.prototype.getActionAt.call(this,t)},t.prototype.getActionById=function(t){var n=this._actionCollection.getActionById(t);return n||e.prototype.getActionById.call(this,t)},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this._actionCollection&&this._actionCollection.validateProperties(t)},t.prototype.isLastElement=function(t){return e.prototype.isLastElement.call(this,t)&&0==this._actionCollection.getActionCount()},t.prototype.addAction=function(e){this._actionCollection.addAction(e)},t.prototype.clear=function(){e.prototype.clear.call(this),this._actionCollection.clear()},t.prototype.getAllInputs=function(t){void 0===t&&(t=!0);var n=e.prototype.getAllInputs.call(this,t);return t&&(n=n.concat(this._actionCollection.getAllInputs(t))),n},t.prototype.getResourceInformation=function(){return e.prototype.getResourceInformation.call(this).concat(this._actionCollection.getResourceInformation())},t.prototype.isBleedingAtBottom=function(){return 0==this._actionCollection.renderedActionCount?e.prototype.isBleedingAtBottom.call(this):1==this._actionCollection.getActionCount()?void 0!==this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:void 0!==this._actionCollection.expandedAction},Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!1},enumerable:!1,configurable:!0}),t}(te);t.ContainerWithActions=le;var pe=function(e){function t(t,n){var i=e.call(this,t,n,void 0)||this;return i.targetVersion=t,i.name=n,i}return r(t,e),t.prototype.parse=function(e,t,n){var i=n.parseAction(e.parent,t[this.name],[],!1);if(void 0!==i){if(i instanceof W)return i;n.logParseEvent(e,a.ValidationEvent.ActionTypeNotAllowed,f.Strings.errors.actionTypeNotAllowed(i.getJsonTypeName()))}n.logParseEvent(e,a.ValidationEvent.PropertyCantBeNull,f.Strings.errors.propertyMustBeSet("action"))},t.prototype.toJSON=function(e,t,n,i){i.serializeValue(t,this.name,n?n.toJSON(i):void 0,void 0,!0)},t}(h.PropertyDefinition);t.RefreshActionProperty=pe;var ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),Object.defineProperty(t.prototype,"action",{get:function(){return this.getValue(t.actionProperty)},set:function(e){this.setValue(t.actionProperty,e),e&&e.setParent(this.parent)},enumerable:!1,configurable:!0}),t.prototype.getSchemaKey=function(){return"RefreshDefinition"},t.actionProperty=new pe(h.Versions.v1_4,"action"),t.userIdsProperty=new h.StringArrayProperty(h.Versions.v1_4,"userIds"),o([h.property(t.actionProperty)],t.prototype,"action",null),o([h.property(t.userIdsProperty)],t.prototype,"userIds",void 0),t}(h.SerializableObject);t.RefreshDefinition=ue;var ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getSchemaKey=function(){return"AuthCardButton"},t.typeProperty=new h.StringProperty(h.Versions.v1_4,"type"),t.titleProperty=new h.StringProperty(h.Versions.v1_4,"title"),t.imageProperty=new h.StringProperty(h.Versions.v1_4,"image"),t.valueProperty=new h.StringProperty(h.Versions.v1_4,"value"),o([h.property(t.typeProperty)],t.prototype,"type",void 0),o([h.property(t.titleProperty)],t.prototype,"title",void 0),o([h.property(t.imageProperty)],t.prototype,"image",void 0),o([h.property(t.valueProperty)],t.prototype,"value",void 0),t}(h.SerializableObject);t.AuthCardButton=ce;var he=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getSchemaKey=function(){return"TokenExchangeResource"},t.idProperty=new h.StringProperty(h.Versions.v1_4,"id"),t.uriProperty=new h.StringProperty(h.Versions.v1_4,"uri"),t.providerIdProperty=new h.StringProperty(h.Versions.v1_4,"providerId"),o([h.property(t.idProperty)],t.prototype,"id",void 0),o([h.property(t.uriProperty)],t.prototype,"uri",void 0),o([h.property(t.providerIdProperty)],t.prototype,"providerId",void 0),t}(h.SerializableObject);t.TokenExchangeResource=he;var de=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getSchemaKey=function(){return"Authentication"},t.textProperty=new h.StringProperty(h.Versions.v1_4,"text"),t.connectionNameProperty=new h.StringProperty(h.Versions.v1_4,"connectionName"),t.buttonsProperty=new h.SerializableObjectCollectionProperty(h.Versions.v1_4,"buttons",ce),t.tokenExchangeResourceProperty=new h.SerializableObjectProperty(h.Versions.v1_4,"tokenExchangeResource",he,!0),o([h.property(t.textProperty)],t.prototype,"text",void 0),o([h.property(t.connectionNameProperty)],t.prototype,"connectionName",void 0),o([h.property(t.buttonsProperty)],t.prototype,"buttons",void 0),o([h.property(t.tokenExchangeResourceProperty)],t.prototype,"tokenExchangeResource",void 0),t}(h.SerializableObject);t.Authentication=de;var fe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.designMode=!1,t}return r(t,e),Object.defineProperty(t.prototype,"refresh",{get:function(){return this.getValue(t.refreshProperty)},set:function(e){this.setValue(t.refreshProperty,e),e&&(e.parent=this)},enumerable:!1,configurable:!0}),Object.defineProperty(t,"processMarkdown",{get:function(){throw new Error(f.Strings.errors.processMarkdownEventRemoved())},set:function(e){throw new Error(f.Strings.errors.processMarkdownEventRemoved())},enumerable:!1,configurable:!0}),t.applyMarkdown=function(e){var n={didProcess:!1};if(t.onProcessMarkdown)t.onProcessMarkdown(e,n);else if(window.markdownit){var i=window.markdownit;n.outputHtml=i().render(e),n.didProcess=!0}return n},t.prototype.isVersionSupported=function(){return!!this.bypassVersionCheck||!(!this.version||!this.version.isValid||this.maxVersion.major<this.version.major||this.maxVersion.major==this.version.major&&this.maxVersion.minor<this.version.minor)},t.prototype.getDefaultSerializationContext=function(){return new me(this.version)},t.prototype.getItemsCollectionPropertyName=function(){return"body"},t.prototype.internalParse=function(n,i){this._fallbackCard=void 0;var r=i.parseElement(void 0,n.fallback,!this.isDesignMode());r&&(this._fallbackCard=new t,this._fallbackCard.addItem(r)),e.prototype.internalParse.call(this,n,i)},t.prototype.internalToJSON=function(n,i){this.setValue(t.versionProperty,i.targetVersion),e.prototype.internalToJSON.call(this,n,i)},t.prototype.internalRender=function(){var t=e.prototype.internalRender.call(this);return s.GlobalSettings.useAdvancedCardBottomTruncation&&t&&t.style.removeProperty("minHeight"),t},t.prototype.getHasBackground=function(){return!0},t.prototype.getDefaultPadding=function(){return new s.PaddingDefinition(a.Spacing.Padding,a.Spacing.Padding,a.Spacing.Padding,a.Spacing.Padding)},t.prototype.shouldSerialize=function(e){return!0},Object.defineProperty(t.prototype,"renderIfEmpty",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bypassVersionCheck",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"allowCustomStyle",{get:function(){return this.hostConfig.adaptiveCard&&this.hostConfig.adaptiveCard.allowCustomStyle},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasBackground",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.getJsonTypeName=function(){return"AdaptiveCard"},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),"AdaptiveCard"!==this.getValue(g.typeNameProperty)&&t.addFailure(this,a.ValidationEvent.MissingCardType,f.Strings.errors.invalidCardType()),this.bypassVersionCheck||this.version?this.isVersionSupported()||t.addFailure(this,a.ValidationEvent.UnsupportedCardVersion,f.Strings.errors.unsupportedCardVersion(this.version.toString(),this.maxVersion.toString())):t.addFailure(this,a.ValidationEvent.PropertyCantBeNull,f.Strings.errors.propertyMustBeSet("version"))},t.prototype.render=function(t){var n;return this.shouldFallback()&&this._fallbackCard?(this._fallbackCard.hostConfig=this.hostConfig,n=this._fallbackCard.render()):(n=e.prototype.render.call(this))&&(n.classList.add(this.hostConfig.makeCssClassName("ac-adaptiveCard")),s.GlobalSettings.setTabIndexAtCardRoot&&(n.tabIndex=0),this.speak&&n.setAttribute("aria-label",this.speak)),t&&(l.appendChild(t,n),this.updateLayout()),n},t.prototype.updateLayout=function(t){if(void 0===t&&(t=!0),e.prototype.updateLayout.call(this,t),s.GlobalSettings.useAdvancedCardBottomTruncation&&this.isDisplayed()){var n=this.hostConfig.getEffectiveSpacing(a.Spacing.Default);this.handleOverflow(this.renderedElement.offsetHeight-n)}},t.prototype.shouldFallback=function(){return e.prototype.shouldFallback.call(this)||!this.isVersionSupported()},Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){return!1},enumerable:!1,configurable:!0}),t.schemaUrl="http://adaptivecards.io/schemas/adaptive-card.json",t.$schemaProperty=new h.CustomProperty(h.Versions.v1_0,"$schema",(function(e,n,i,r){return t.schemaUrl}),(function(e,n,i,r,o){o.serializeValue(i,n.name,t.schemaUrl)})),t.versionProperty=new h.CustomProperty(h.Versions.v1_0,"version",(function(e,t,n,i){var r=h.Version.parse(n[t.name],i);return void 0===r&&(r=h.Versions.latest,i.logParseEvent(e,a.ValidationEvent.InvalidPropertyValue,f.Strings.errors.invalidCardVersion(r.toString()))),r}),(function(e,t,n,i,r){void 0!==i&&r.serializeValue(n,t.name,i.toString())}),h.Versions.v1_0),t.fallbackTextProperty=new h.StringProperty(h.Versions.v1_0,"fallbackText"),t.speakProperty=new h.StringProperty(h.Versions.v1_0,"speak"),t.refreshProperty=new h.SerializableObjectProperty(h.Versions.v1_4,"refresh",ue,!0),t.authenticationProperty=new h.SerializableObjectProperty(h.Versions.v1_4,"authentication",de,!0),o([h.property(t.versionProperty)],t.prototype,"version",void 0),o([h.property(t.fallbackTextProperty)],t.prototype,"fallbackText",void 0),o([h.property(t.speakProperty)],t.prototype,"speak",void 0),o([h.property(t.refreshProperty)],t.prototype,"refresh",null),o([h.property(t.authenticationProperty)],t.prototype,"authentication",void 0),t}(le);t.AdaptiveCard=fe;var ye=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.suppressStyle=!1,t}return r(t,e),t.prototype.getSchemaKey=function(){return"InlineAdaptiveCard"},t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t),t.remove(fe.$schemaProperty,fe.versionProperty)},t.prototype.getDefaultPadding=function(){return new s.PaddingDefinition(this.suppressStyle?a.Spacing.None:a.Spacing.Padding,a.Spacing.Padding,this.suppressStyle?a.Spacing.None:a.Spacing.Padding,a.Spacing.Padding)},Object.defineProperty(t.prototype,"bypassVersionCheck",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"defaultStyle",{get:function(){return this.suppressStyle?a.ContainerStyle.Default:this.hostConfig.actions.showCard.style?this.hostConfig.actions.showCard.style:a.ContainerStyle.Emphasis},enumerable:!1,configurable:!0}),t.prototype.render=function(t){var n=e.prototype.render.call(this,t);return n&&(n.setAttribute("aria-live","polite"),n.removeAttribute("tabindex")),n},t}(fe),ge=function(){function e(){}return e.populateWithDefaultElements=function(e){e.clear(),e.register("Container",te),e.register("TextBlock",b),e.register("RichTextBlock",S,h.Versions.v1_2),e.register("TextRun",C,h.Versions.v1_2),e.register("Image",E),e.register("ImageSet",x),e.register("Media",T,h.Versions.v1_1),e.register("FactSet",P),e.register("ColumnSet",ie),e.register("ActionSet",Z,h.Versions.v1_2),e.register("Input.Text",O),e.register("Input.Date",L),e.register("Input.Time",D),e.register("Input.Number",R),e.register("Input.ChoiceSet",z),e.register("Input.Toggle",k)},e.populateWithDefaultActions=function(e){e.clear(),e.register(J.JsonTypeName,J),e.register(H.JsonTypeName,H),e.register(K.JsonTypeName,K),e.register(q.JsonTypeName,q,h.Versions.v1_2),e.register(W.JsonTypeName,W,h.Versions.v1_4)},e.reset=function(){e.populateWithDefaultElements(e.elements),e.populateWithDefaultActions(e.actions)},e.elements=new d.CardObjectRegistry,e.actions=new d.CardObjectRegistry,e}();t.GlobalRegistry=ge,ge.reset();var me=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.internalParseCardObject=function(e,t,n,i,r,o){var a=void 0;if(t&&"object"==typeof t){var p=l.parseString(t.type);if(p)if(n.indexOf(p)>=0)o(p,1);else{var u=!1;if((a=r(p))?(a.setParent(e),a.parse(t,this),u=s.GlobalSettings.enableFallback&&i&&a.shouldFallback()):(u=s.GlobalSettings.enableFallback&&i,o(p,0)),u){var c=t.fallback;!c&&e&&e.setShouldFallback(!0),"string"==typeof c&&"drop"===c.toLowerCase()?a=void 0:"object"==typeof c&&(a=this.internalParseCardObject(e,c,n,!0,r,o))}}}return a},t.prototype.cardObjectParsed=function(e,t){e instanceof j&&this.onParseAction?this.onParseAction(e,t,this):e instanceof g&&this.onParseElement&&this.onParseElement(e,t,this)},t.prototype.shouldSerialize=function(e){return e instanceof j?void 0!==this.actionRegistry.findByName(e.getJsonTypeName()):!(e instanceof g)||void 0!==this.elementRegistry.findByName(e.getJsonTypeName())},t.prototype.parseCardObject=function(e,t,n,i,r,o){var a=this.internalParseCardObject(e,t,n,i,r,o);return void 0!==a&&this.cardObjectParsed(a,t),a},t.prototype.parseElement=function(e,t,n){var i=this;return this.parseCardObject(e,t,[],n,(function(e){return i.elementRegistry.createInstance(e,i.targetVersion)}),(function(e,t){0===t?i.logParseEvent(void 0,a.ValidationEvent.UnknownElementType,f.Strings.errors.unknownElementType(e)):i.logParseEvent(void 0,a.ValidationEvent.ElementTypeNotAllowed,f.Strings.errors.elementTypeNotAllowed(e))}))},t.prototype.parseAction=function(e,t,n,i){var r=this;return this.parseCardObject(e,t,n,i,(function(e){return r.actionRegistry.createInstance(e,r.targetVersion)}),(function(e,t){0==t?r.logParseEvent(void 0,a.ValidationEvent.UnknownActionType,f.Strings.errors.unknownActionType(e)):r.logParseEvent(void 0,a.ValidationEvent.ActionTypeNotAllowed,f.Strings.errors.actionTypeNotAllowed(e))}))},Object.defineProperty(t.prototype,"elementRegistry",{get:function(){return this._elementRegistry?this._elementRegistry:ge.elements},enumerable:!1,configurable:!0}),t.prototype.setElementRegistry=function(e){this._elementRegistry=e},Object.defineProperty(t.prototype,"actionRegistry",{get:function(){return this._actionRegistry?this._actionRegistry:ge.actions},enumerable:!1,configurable:!0}),t.prototype.setActionRegistry=function(e){this._actionRegistry=e},t}(h.BaseSerializationContext);t.SerializationContext=me},12950:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.LoginRequestResponse=t.ErrorResponse=t.SuccessResponse=t.ActivityResponse=t.ActivityRequestError=t.ActivityRequestTrigger=void 0,function(e){e.Automatic="automatic",e.Manual="manual"}(t.ActivityRequestTrigger||(t.ActivityRequestTrigger={}));var o=function(e,t){this.code=e,this.message=t};t.ActivityRequestError=o;var a=function(e){this.request=e};t.ActivityResponse=a;var s=function(e){function t(t,n){var i=e.call(this,t)||this;return i.request=t,i.rawContent=n,i}return r(t,e),t}(a);t.SuccessResponse=s;var l=function(e){function t(t,n){var i=e.call(this,t)||this;return i.request=t,i.error=n,i}return r(t,e),t}(a);t.ErrorResponse=l;var p=function(e){function t(t,n){var i=e.call(this,t)||this;i.request=t,i._auth=n;for(var r=0,o=i._auth.buttons;r<o.length;r++){var a=o[r];if("signin"===a.type&&void 0!==a.value)try{new URL(a.value),i.signinButton=a;break}catch(e){}}return i}return r(t,e),Object.defineProperty(t.prototype,"tokenExchangeResource",{get:function(){return this._auth.tokenExchangeResource},enumerable:!1,configurable:!0}),t}(a);t.LoginRequestResponse=p},17983:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.formatText=void 0;var o=function(){function e(e){this._regularExpression=e}return e.prototype.format=function(e,t){var n;if(t){for(var i=t;null!=(n=this._regularExpression.exec(t));)i=i.replace(n[0],this.internalFormat(e,n));return i}return t},e}(),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.internalFormat=function(e,t){var n=new Date(Date.parse(t[1])),i=null!=t[2]?t[2].toLowerCase():"compact";return"compact"!=i?n.toLocaleDateString(e,{day:"numeric",weekday:i,month:i,year:"numeric"}):n.toLocaleDateString()},t}(o),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.internalFormat=function(e,t){return new Date(Date.parse(t[1])).toLocaleTimeString(e,{hour:"numeric",minute:"2-digit"})},t}(o);t.formatText=function(e,t){for(var n=t,i=0,r=[new a(/\{{2}DATE\((\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|(?:(?:-|\+)\d{2}:\d{2})))(?:, ?(COMPACT|LONG|SHORT))?\)\}{2}/g),new s(/\{{2}TIME\((\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|(?:(?:-|\+)\d{2}:\d{2})))\)\}{2}/g)];i<r.length;i++){n=r[i].format(e,n)}return n}},17984:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(17985),t),r(n(17986),t)},17985:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MenuItem=void 0;var i=n(9705),r=n(11503),o=function(){function e(e,t){this.key=e,this._value=t}return e.prototype.click=function(){this.onClick&&this.onClick(this)},e.prototype.toString=function(){return this.value},e.prototype.render=function(e){var t=this;if(!this._element){var n=e||i.defaultHostConfig;this._element=document.createElement("span"),this._element.className=n.makeCssClassName("ac-ctrl ac-ctrl-dropdown-item"),this._element.innerText=this.value,this._element.setAttribute("role","menuitem"),this._element.setAttribute("aria-selected","false"),this._element.onmouseup=function(e){t.click()},this._element.onkeydown=function(e){e.key===r.Constants.keys.enter&&(t.click(),e.cancelBubble=!0)}}return this._element},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e,this._element&&(this._element.innerText=e)},enumerable:!1,configurable:!0}),e}();t.MenuItem=o},17986:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.PopupMenu=void 0;var o=n(11503),a=n(17987),s=function(e){function t(){var t=e.call(this)||this;return t._items=new a.Collection,t._renderedItems=[],t._selectedIndex=-1,t}return r(t,e),t.prototype.renderContent=function(){var e=document.createElement("div");e.className=this.hostConfig.makeCssClassName("ac-ctrl ac-popup"),e.setAttribute("role","listbox");for(var t=0;t<this._items.length;t++){var n=this._items.get(t).render(this.hostConfig);n.tabIndex=0,e.appendChild(n),t==this.selectedIndex&&n.focus(),this._renderedItems.push(n)}return e},t.prototype.keyDown=function(t){e.prototype.keyDown.call(this,t);var n=this._selectedIndex;switch(t.key){case o.Constants.keys.tab:this.closePopup(!0);break;case o.Constants.keys.up:n<=0?n=this._renderedItems.length-1:--n<0&&(n=this._renderedItems.length-1),this.selectedIndex=n,t.cancelBubble=!0;break;case o.Constants.keys.down:n<0?n=0:++n>=this._renderedItems.length&&(n=0),this.selectedIndex=n,t.cancelBubble=!0}},Object.defineProperty(t.prototype,"items",{get:function(){return this._items},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectedIndex",{get:function(){return this._selectedIndex},set:function(e){e>=0&&e<this._renderedItems.length&&(this._renderedItems[e].focus(),this._selectedIndex=e)},enumerable:!1,configurable:!0}),t}(n(17988).PopupControl);t.PopupMenu=s},17987:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Collection=void 0;var i=function(){function e(){this._items=[]}return e.prototype.get=function(e){return this._items[e]},e.prototype.add=function(e){this._items.push(e),this.onItemAdded&&this.onItemAdded(e)},e.prototype.remove=function(e){var t=this._items.indexOf(e);t>=0&&(this._items=this._items.splice(t,1),this.onItemRemoved&&this.onItemRemoved(e))},e.prototype.indexOf=function(e){return this._items.indexOf(e)},Object.defineProperty(e.prototype,"length",{get:function(){return this._items.length},enumerable:!1,configurable:!0}),e}();t.Collection=i},17988:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PopupControl=void 0;var i=n(11503),r=n(7871),o=n(9705),a=function(){function e(){this._isOpen=!1}return e.prototype.keyDown=function(e){switch(e.key){case i.Constants.keys.escape:this.closePopup(!0)}},e.prototype.render=function(e){var t=this,n=document.createElement("div");return n.tabIndex=0,n.className=this.hostConfig.makeCssClassName("ac-ctrl","ac-ctrl-popup-container"),n.setAttribute("role","dialog"),n.setAttribute("aria-modal","true"),n.onkeydown=function(e){return t.keyDown(e),!e.cancelBubble},n.appendChild(this.renderContent()),n},e.prototype.focus=function(){this._popupElement&&this._popupElement.firstElementChild.focus()},e.prototype.popup=function(e){var t,n,i,o,a,s=this;if(!this._isOpen){this._overlayElement=document.createElement("div"),this._overlayElement.className=this.hostConfig.makeCssClassName("ac-ctrl-overlay"),this._overlayElement.tabIndex=0,this._overlayElement.style.width=document.documentElement.scrollWidth+"px",this._overlayElement.style.height=document.documentElement.scrollHeight+"px",this._overlayElement.onfocus=function(e){s.closePopup(!0)},document.body.appendChild(this._overlayElement);var l=e.getBoundingClientRect();this._popupElement=this.render(l),(t=this._popupElement.classList).remove.apply(t,this.hostConfig.makeCssClassNames("ac-ctrl-slide","ac-ctrl-slideLeftToRight","ac-ctrl-slideRightToLeft","ac-ctrl-slideTopToBottom","ac-ctrl-slideRightToLeft")),window.addEventListener("resize",(function(e){s.closePopup(!0)}));var p=e.getAttribute("aria-label");p&&this._popupElement.setAttribute("aria-label",p),this._overlayElement.appendChild(this._popupElement);var u,c=this._popupElement.getBoundingClientRect(),h=window.innerHeight-l.bottom,d=l.top,f=(window.innerWidth,l.left),y=(f=window.innerWidth-l.right,l.left),g=l.left+r.getScrollX();if(d<c.height&&h<c.height){var m=Math.min(c.height,window.innerHeight);if(this._popupElement.style.maxHeight=m+"px",u=m<c.height?r.getScrollY():r.getScrollY()+l.top+(l.height-m)/2,y<c.width&&f<c.width){var v=Math.min(c.width,window.innerWidth);this._popupElement.style.maxWidth=v+"px",g=v<c.width?r.getScrollX():r.getScrollX()+l.left+(l.width-v)/2}else f>=c.width?(g=r.getScrollX()+l.right,(n=this._popupElement.classList).add.apply(n,this.hostConfig.makeCssClassNames("ac-ctrl-slide","ac-ctrl-slideLeftToRight"))):(g=r.getScrollX()+l.left-c.width,(i=this._popupElement.classList).add.apply(i,this.hostConfig.makeCssClassNames("ac-ctrl-slide","ac-ctrl-slideRightToLeft")))}else h>=c.height?(u=r.getScrollY()+l.bottom,(o=this._popupElement.classList).add.apply(o,this.hostConfig.makeCssClassNames("ac-ctrl-slide","ac-ctrl-slideTopToBottom"))):(u=r.getScrollY()+l.top-c.height,(a=this._popupElement.classList).add.apply(a,this.hostConfig.makeCssClassNames("ac-ctrl-slide","ac-ctrl-slideBottomToTop"))),f<c.width&&(g=r.getScrollX()+l.right-c.width);this._popupElement.style.left=g+"px",this._popupElement.style.top=u+"px",this._popupElement.focus(),this._isOpen=!0}},e.prototype.closePopup=function(e){this._isOpen&&(document.body.removeChild(this._overlayElement),this._isOpen=!1,this.onClose&&this.onClose(this,e))},Object.defineProperty(e.prototype,"hostConfig",{get:function(){return this._hostConfig?this._hostConfig:o.defaultHostConfig},set:function(e){this._hostConfig=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isOpen",{get:function(){return this._isOpen},enumerable:!1,configurable:!0}),e}();t.PopupControl=a},17989:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelAdapter=void 0;var i=function(){};t.ChannelAdapter=i},17990:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{l(i.next(e))}catch(e){o(e)}}function s(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((i=i.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.AdaptiveApplet=void 0;var o=n(6800),a=n(7871),s=n(7388),l=n(12950),p=n(8898),u=n(12949),c=n(7870);function h(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(s.GlobalSettings.applets.logEnabled)if(s.GlobalSettings.applets.onLogEvent)s.GlobalSettings.applets.onLogEvent(e,t,n);else switch(e){case o.LogLevel.Warning:case o.LogLevel.Error:}}var d=function(){function e(e,t,n){this.action=e,this.trigger=t,this.consecutiveRefreshes=n,this.attemptNumber=0}return e.prototype.retryAsync=function(){return i(this,void 0,void 0,(function(){return r(this,(function(e){return this.onSend&&this.onSend(this),[2]}))}))},e}(),f=function(){function e(){this._allowAutomaticCardUpdate=!1,this.renderedElement=document.createElement("div"),this.renderedElement.className="aaf-cardHost",this.renderedElement.style.position="relative",this.renderedElement.style.display="flex",this.renderedElement.style.flexDirection="column",this._cardHostElement=document.createElement("div"),this._refreshButtonHostElement=document.createElement("div"),this._refreshButtonHostElement.className="aaf-refreshButtonHost",this._refreshButtonHostElement.style.display="none",this.renderedElement.appendChild(this._cardHostElement),this.renderedElement.appendChild(this._refreshButtonHostElement)}return e.prototype.displayCard=function(e){if(!e.renderedElement)throw new Error("displayCard: undefined card.");a.clearElementChildren(this._cardHostElement),this._refreshButtonHostElement.style.display="none",this._cardHostElement.appendChild(e.renderedElement)},e.prototype.showManualRefreshButton=function(e){var t=this;if(!this.onShowManualRefreshButton||this.onShowManualRefreshButton(this)){this._refreshButtonHostElement.style.display="none";var n=void 0;if(this.onRenderManualRefreshButton)n=this.onRenderManualRefreshButton(this);else{var i=p.Strings.runtime.refreshThisCard();if(s.GlobalSettings.applets.refresh.mode===o.RefreshMode.Automatic){var r=p.Strings.runtime.automaticRefreshPaused();" "!==r[r.length-1]&&(r+=" "),i=p.Strings.runtime.clckToRestartAutomaticRefresh()}var h={type:"AdaptiveCard",version:"1.2",body:[{type:"RichTextBlock",horizontalAlignment:"right",inlines:[{type:"TextRun",text:i,selectAction:{type:"Action.Submit",id:"refreshCard"}}]}]},d=new u.AdaptiveCard;d.parse(h,new u.SerializationContext(c.Versions.v1_2)),d.onExecuteAction=function(n){"refreshCard"===n.id&&(a.clearElementChildren(t._refreshButtonHostElement),t.internalExecuteAction(e,l.ActivityRequestTrigger.Automatic,0))},n=d.render()}n&&(a.clearElementChildren(this._refreshButtonHostElement),this._refreshButtonHostElement.appendChild(n),this._refreshButtonHostElement.style.removeProperty("display"))}},e.prototype.createActivityRequest=function(e,t,n){var i=this;if(this.card){var r=new d(e,t,n);return r.onSend=function(e){e.attemptNumber++,i.internalSendActivityRequestAsync(r)},!!this.onPrepareActivityRequest&&!this.onPrepareActivityRequest(this,r,e)?void 0:r}throw new Error("createActivityRequest: no card has been set.")},e.prototype.createMagicCodeInputCard=function(t){var n={type:"AdaptiveCard",version:"1.0",body:[{type:"TextBlock",color:"attention",text:1===t?void 0:"That didn't work... let's try again.",wrap:!0,horizontalAlignment:"center"},{type:"TextBlock",text:'Please login in the popup. You will obtain a magic code. Paste that code below and select "Submit"',wrap:!0,horizontalAlignment:"center"},{type:"Input.Text",id:"magicCode",placeholder:"Enter magic code"},{type:"ActionSet",horizontalAlignment:"center",actions:[{type:"Action.Submit",id:e.submitMagicCodeActionId,title:"Submit"},{type:"Action.Submit",id:e.cancelMagicCodeAuthActionId,title:"Cancel"}]}]},i=new u.AdaptiveCard;return i.parse(n),i},e.prototype.cancelAutomaticRefresh=function(){this._allowAutomaticCardUpdate&&h(o.LogLevel.Warning,"Automatic card refresh has been cancelled as a result of the user interacting with the card."),this._allowAutomaticCardUpdate=!1},e.prototype.createSerializationContext=function(){return this.onCreateSerializationContext?this.onCreateSerializationContext(this):new u.SerializationContext},e.prototype.internalSetCard=function(e,t){var n=this;if("object"==typeof e&&"AdaptiveCard"===e.type&&(this._cardPayload=e),this._cardPayload)try{var i=new u.AdaptiveCard;this.hostConfig&&(i.hostConfig=this.hostConfig);var r=this.createSerializationContext();if(i.parse(this._cardPayload,r),(!this.onCardChanging||this.onCardChanging(this,this._cardPayload))&&(this._card=i,this._card.authentication&&this._card.authentication.tokenExchangeResource&&this.onPrefetchSSOToken&&this.onPrefetchSSOToken(this,this._card.authentication.tokenExchangeResource),this._card.onExecuteAction=function(e){n.cancelAutomaticRefresh(),n.internalExecuteAction(e,l.ActivityRequestTrigger.Manual,0)},this._card.onInputValueChanged=function(e){n.cancelAutomaticRefresh()},this._card.render(),this._card.renderedElement&&(this.displayCard(this._card),this.onCardChanged&&this.onCardChanged(this),this._card.refresh)))if(s.GlobalSettings.applets.refresh.mode===o.RefreshMode.Automatic&&t<s.GlobalSettings.applets.refresh.maximumConsecutiveAutomaticRefreshes)if(s.GlobalSettings.applets.refresh.timeBetweenAutomaticRefreshes<=0)h(o.LogLevel.Info,"Triggering automatic card refresh number "+(t+1)),this.internalExecuteAction(this._card.refresh.action,l.ActivityRequestTrigger.Automatic,t+1);else{h(o.LogLevel.Info,"Scheduling automatic card refresh number "+(t+1)+" in "+s.GlobalSettings.applets.refresh.timeBetweenAutomaticRefreshes+"ms");var a=this._card.refresh.action;this._allowAutomaticCardUpdate=!0,window.setTimeout((function(){n._allowAutomaticCardUpdate&&n.internalExecuteAction(a,l.ActivityRequestTrigger.Automatic,t+1)}),s.GlobalSettings.applets.refresh.timeBetweenAutomaticRefreshes)}else s.GlobalSettings.applets.refresh.mode!==o.RefreshMode.Disabled&&(h(o.LogLevel.Warning,t>0?"Stopping automatic refreshes after "+t+" consecutive refreshes.":"The card has a refresh section, but automatic refreshes are disabled."),(s.GlobalSettings.applets.refresh.allowManualRefreshesAfterAutomaticRefreshes||s.GlobalSettings.applets.refresh.mode===o.RefreshMode.Manual)&&(h(o.LogLevel.Info,"Showing manual refresh button."),this.showManualRefreshButton(this._card.refresh.action)))}catch(e){h(o.LogLevel.Error,"setCard: "+e)}},e.prototype.internalExecuteAction=function(e,t,n){if(e instanceof u.ExecuteAction){if(!this.channelAdapter)throw new Error("internalExecuteAction: No channel adapter set.");var i=this.createActivityRequest(e,t,n);i&&i.retryAsync()}this.onAction&&this.onAction(this,e)},e.prototype.createProgressOverlay=function(e){if(!this._progressOverlay)if(this.onCreateProgressOverlay)this._progressOverlay=this.onCreateProgressOverlay(this,e);else{this._progressOverlay=document.createElement("div"),this._progressOverlay.className="aaf-progress-overlay";var t=document.createElement("div");t.className="aaf-spinner",t.style.width="28px",t.style.height="28px",this._progressOverlay.appendChild(t)}return this._progressOverlay},e.prototype.removeProgressOverlay=function(e){this.onRemoveProgressOverlay&&this.onRemoveProgressOverlay(this,e),void 0!==this._progressOverlay&&(this.renderedElement.removeChild(this._progressOverlay),this._progressOverlay=void 0)},e.prototype.activityRequestSucceeded=function(e,t){this.onActivityRequestSucceeded&&this.onActivityRequestSucceeded(this,e,t)},e.prototype.activityRequestFailed=function(e){return this.onActivityRequestFailed?this.onActivityRequestFailed(this,e):s.GlobalSettings.applets.defaultTimeBetweenRetryAttempts},e.prototype.showAuthCodeInputDialog=function(t){var n=this;if(!this.onShowAuthCodeInputDialog||this.onShowAuthCodeInputDialog(this,t)){var i=this.createMagicCodeInputCard(t.attemptNumber);i.render(),i.onExecuteAction=function(i){if(n.card&&i instanceof u.SubmitAction)switch(i.id){case e.submitMagicCodeActionId:var r=void 0;i.data&&"string"==typeof i.data.magicCode&&(r=i.data.magicCode),r?(n.displayCard(n.card),t.authCode=r,t.retryAsync()):alert("Please enter the magic code you received.");break;case e.cancelMagicCodeAuthActionId:h(o.LogLevel.Warning,"Authentication cancelled by user."),n.displayCard(n.card);break;default:h(o.LogLevel.Error,"Unespected action taken from magic code input card (id = "+i.id+")"),alert(p.Strings.magicCodeInputCard.somethingWentWrong())}},this.displayCard(i)}},e.prototype.internalSendActivityRequestAsync=function(e){return i(this,void 0,void 0,(function(){var t,n,i,a;return r(this,(function(u){switch(u.label){case 0:if(!this.channelAdapter)throw new Error("internalSendActivityRequestAsync: channelAdapter is not set.");void 0!==(t=this.createProgressOverlay(e))&&this.renderedElement.appendChild(t),n=!1,i=function(){var t,i,u,c,d,f,y;return r(this,(function(r){switch(r.label){case 0:t=void 0,1===e.attemptNumber?h(o.LogLevel.Info,"Sending activity request to channel (attempt "+e.attemptNumber+")"):h(o.LogLevel.Info,"Re-sending activity request to channel (attempt "+e.attemptNumber+")"),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,a.channelAdapter.sendRequestAsync(e)];case 2:return t=r.sent(),[3,4];case 3:return i=r.sent(),h(o.LogLevel.Error,"Activity request failed: "+i),a.removeProgressOverlay(e),n=!0,[3,4];case 4:if(!t)return[3,10];if(!(t instanceof l.SuccessResponse))return[3,5];if(a.removeProgressOverlay(e),void 0===t.rawContent)throw new Error("internalSendActivityRequestAsync: Action.Execute result is undefined");u=t.rawContent;try{u=JSON.parse(t.rawContent)}catch(e){}if("string"==typeof u)h(o.LogLevel.Info,"The activity request returned a string after "+e.attemptNumber+" attempt(s)."),a.activityRequestSucceeded(t,u);else{if("object"!=typeof u||"AdaptiveCard"!==u.type)throw new Error("internalSendActivityRequestAsync: Action.Execute result is of unsupported type ("+typeof t.rawContent+")");h(o.LogLevel.Info,"The activity request returned an Adaptive Card after "+e.attemptNumber+" attempt(s)."),a.internalSetCard(u,e.consecutiveRefreshes),a.activityRequestSucceeded(t,a.card)}return n=!0,[3,10];case 5:return t instanceof l.ErrorResponse?(c=a.activityRequestFailed(t))>=0&&e.attemptNumber<s.GlobalSettings.applets.maximumRetryAttempts?(h(o.LogLevel.Warning,"Activity request failed: "+t.error.message+". Retrying in "+c+"ms"),e.attemptNumber++,[4,new Promise((function(e,t){window.setTimeout((function(){e()}),c)}))]):[3,7]:[3,9];case 6:return r.sent(),[3,8];case 7:h(o.LogLevel.Error,"Activity request failed: "+t.error.message+". Giving up after "+e.attemptNumber+" attempt(s)"),a.removeProgressOverlay(e),n=!0,r.label=8;case 8:return[3,10];case 9:if(t instanceof l.LoginRequestResponse){if(h(o.LogLevel.Info,"The activity request returned a LoginRequestResponse after "+e.attemptNumber+" attempt(s)."),e.attemptNumber<=s.GlobalSettings.applets.maximumRetryAttempts){if(d=!0,t.tokenExchangeResource&&a.onSSOTokenNeeded&&(d=!a.onSSOTokenNeeded(a,e,t.tokenExchangeResource)),d){if(a.removeProgressOverlay(e),void 0===t.signinButton)throw new Error("internalSendActivityRequestAsync: the login request doesn't contain a valid signin URL.");h(o.LogLevel.Info,"Login required at "+t.signinButton.value),a.onShowSigninPrompt?a.onShowSigninPrompt(a,e,t.signinButton):(a.showAuthCodeInputDialog(e),f=window.screenX+(window.outerWidth-s.GlobalSettings.applets.authPromptWidth)/2,y=window.screenY+(window.outerHeight-s.GlobalSettings.applets.authPromptHeight)/2,window.open(t.signinButton.value,t.signinButton.title?t.signinButton.title:"Sign in","width="+s.GlobalSettings.applets.authPromptWidth+",height="+s.GlobalSettings.applets.authPromptHeight+",left="+f+",top="+y))}}else h(o.LogLevel.Error,"Authentication failed. Giving up after "+e.attemptNumber+" attempt(s)"),alert(p.Strings.magicCodeInputCard.authenticationFailed());return[2,"break"]}throw new Error("Unhandled response type: "+t.toString());case 10:return[2]}}))},a=this,u.label=1;case 1:return n?[3,3]:[5,i()];case 2:return"break"===u.sent()?[3,3]:[3,1];case 3:return[2]}}))}))},e.prototype.refreshCard=function(){this._card&&this._card.refresh&&this.internalExecuteAction(this._card.refresh.action,l.ActivityRequestTrigger.Manual,0)},e.prototype.setCard=function(e){this.internalSetCard(e,0)},Object.defineProperty(e.prototype,"card",{get:function(){return this._card},enumerable:!1,configurable:!0}),e.submitMagicCodeActionId="submitMagicCode",e.cancelMagicCodeAuthActionId="cancelMagicCodeAuth",e}();t.AdaptiveApplet=f},3878:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(7870),t),r(n(12946),t),r(n(12947),t),r(n(12949),t),r(n(6800),t),r(n(9705),t),r(n(7388),t),r(n(7871),t),r(n(8898),t),r(n(17989),t),r(n(12950),t),r(n(17990),t)},6800:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogLevel=t.RefreshMode=t.ContainerFitStatus=t.ValidationEvent=t.ValidationPhase=t.TextStyles=t.ContainerStyle=t.InputTextStyle=t.ActionIconPlacement=t.FillMode=t.Orientation=t.ShowCardActionMode=t.ImageStyle=t.ActionAlignment=t.VerticalAlignment=t.HorizontalAlignment=t.TextColor=t.Spacing=t.FontType=t.TextWeight=t.TextSize=t.SizeUnit=t.ImageSize=t.Size=t.ActionMode=t.ActionStyle=void 0;var i=function(){function e(){}return e.Default="default",e.Positive="positive",e.Destructive="destructive",e}();t.ActionStyle=i;var r=function(){function e(){}return e.Primary="primary",e.Secondary="secondary",e}();t.ActionMode=r,function(e){e[e.Auto=0]="Auto",e[e.Stretch=1]="Stretch",e[e.Small=2]="Small",e[e.Medium=3]="Medium",e[e.Large=4]="Large"}(t.Size||(t.Size={})),function(e){e[e.Small=0]="Small",e[e.Medium=1]="Medium",e[e.Large=2]="Large"}(t.ImageSize||(t.ImageSize={})),function(e){e[e.Weight=0]="Weight",e[e.Pixel=1]="Pixel"}(t.SizeUnit||(t.SizeUnit={})),function(e){e[e.Small=0]="Small",e[e.Default=1]="Default",e[e.Medium=2]="Medium",e[e.Large=3]="Large",e[e.ExtraLarge=4]="ExtraLarge"}(t.TextSize||(t.TextSize={})),function(e){e[e.Lighter=0]="Lighter",e[e.Default=1]="Default",e[e.Bolder=2]="Bolder"}(t.TextWeight||(t.TextWeight={})),function(e){e[e.Default=0]="Default",e[e.Monospace=1]="Monospace"}(t.FontType||(t.FontType={})),function(e){e[e.None=0]="None",e[e.Small=1]="Small",e[e.Default=2]="Default",e[e.Medium=3]="Medium",e[e.Large=4]="Large",e[e.ExtraLarge=5]="ExtraLarge",e[e.Padding=6]="Padding"}(t.Spacing||(t.Spacing={})),function(e){e[e.Default=0]="Default",e[e.Dark=1]="Dark",e[e.Light=2]="Light",e[e.Accent=3]="Accent",e[e.Good=4]="Good",e[e.Warning=5]="Warning",e[e.Attention=6]="Attention"}(t.TextColor||(t.TextColor={})),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right"}(t.HorizontalAlignment||(t.HorizontalAlignment={})),function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Bottom=2]="Bottom"}(t.VerticalAlignment||(t.VerticalAlignment={})),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right",e[e.Stretch=3]="Stretch"}(t.ActionAlignment||(t.ActionAlignment={})),function(e){e[e.Default=0]="Default",e[e.Person=1]="Person"}(t.ImageStyle||(t.ImageStyle={})),function(e){e[e.Inline=0]="Inline",e[e.Popup=1]="Popup"}(t.ShowCardActionMode||(t.ShowCardActionMode={})),function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(t.Orientation||(t.Orientation={})),function(e){e[e.Cover=0]="Cover",e[e.RepeatHorizontally=1]="RepeatHorizontally",e[e.RepeatVertically=2]="RepeatVertically",e[e.Repeat=3]="Repeat"}(t.FillMode||(t.FillMode={})),function(e){e[e.LeftOfTitle=0]="LeftOfTitle",e[e.AboveTitle=1]="AboveTitle"}(t.ActionIconPlacement||(t.ActionIconPlacement={})),function(e){e[e.Text=0]="Text",e[e.Tel=1]="Tel",e[e.Url=2]="Url",e[e.Email=3]="Email"}(t.InputTextStyle||(t.InputTextStyle={}));var o=function(){function e(){}return e.Default="default",e.Emphasis="emphasis",e.Accent="accent",e.Good="good",e.Attention="attention",e.Warning="warning",e}();t.ContainerStyle=o;var a=function(){function e(){}return e.Default="default",e.Heading="heading",e}();t.TextStyles=a,function(e){e[e.Parse=0]="Parse",e[e.ToJSON=1]="ToJSON",e[e.Validation=2]="Validation"}(t.ValidationPhase||(t.ValidationPhase={})),function(e){e[e.Hint=0]="Hint",e[e.ActionTypeNotAllowed=1]="ActionTypeNotAllowed",e[e.CollectionCantBeEmpty=2]="CollectionCantBeEmpty",e[e.Deprecated=3]="Deprecated",e[e.ElementTypeNotAllowed=4]="ElementTypeNotAllowed",e[e.InteractivityNotAllowed=5]="InteractivityNotAllowed",e[e.InvalidPropertyValue=6]="InvalidPropertyValue",e[e.MissingCardType=7]="MissingCardType",e[e.PropertyCantBeNull=8]="PropertyCantBeNull",e[e.TooManyActions=9]="TooManyActions",e[e.UnknownActionType=10]="UnknownActionType",e[e.UnknownElementType=11]="UnknownElementType",e[e.UnsupportedCardVersion=12]="UnsupportedCardVersion",e[e.DuplicateId=13]="DuplicateId",e[e.UnsupportedProperty=14]="UnsupportedProperty",e[e.RequiredInputsShouldHaveLabel=15]="RequiredInputsShouldHaveLabel",e[e.RequiredInputsShouldHaveErrorMessage=16]="RequiredInputsShouldHaveErrorMessage",e[e.Other=17]="Other"}(t.ValidationEvent||(t.ValidationEvent={})),function(e){e[e.FullyInContainer=0]="FullyInContainer",e[e.Overflowing=1]="Overflowing",e[e.FullyOutOfContainer=2]="FullyOutOfContainer"}(t.ContainerFitStatus||(t.ContainerFitStatus={})),function(e){e[e.Disabled=0]="Disabled",e[e.Manual=1]="Manual",e[e.Automatic=2]="Automatic"}(t.RefreshMode||(t.RefreshMode={})),function(e){e[e.Info=0]="Info",e[e.Warning=1]="Warning",e[e.Error=2]="Error"}(t.LogLevel||(t.LogLevel={}))},7388:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UUID=t.SizeAndUnit=t.PaddingDefinition=t.SpacingDefinition=t.StringWithSubstitutions=t.ContentTypes=t.GlobalSettings=void 0;var i=n(6800),r=function(){function e(){}return e.useAdvancedTextBlockTruncation=!0,e.useAdvancedCardBottomTruncation=!1,e.useMarkdownInRadioButtonAndCheckbox=!0,e.allowMarkForTextHighlighting=!1,e.alwaysBleedSeparators=!1,e.enableFullJsonRoundTrip=!1,e.displayInputValidationErrors=!0,e.allowPreProcessingPropertyValues=!1,e.setTabIndexAtCardRoot=!0,e.enableFallback=!0,e.useWebkitLineClamp=!0,e.allowMoreThanMaxActionsInOverflowMenu=!1,e.applets={logEnabled:!0,logLevel:i.LogLevel.Error,maximumRetryAttempts:3,defaultTimeBetweenRetryAttempts:3e3,authPromptWidth:400,authPromptHeight:600,refresh:{mode:i.RefreshMode.Manual,timeBetweenAutomaticRefreshes:3e3,maximumConsecutiveAutomaticRefreshes:3,allowManualRefreshesAfterAutomaticRefreshes:!0}},e}();t.GlobalSettings=r,t.ContentTypes={applicationJson:"application/json",applicationXWwwFormUrlencoded:"application/x-www-form-urlencoded"};var o=function(){function e(){this._isProcessed=!1}return e.prototype.getReferencedInputs=function(e,t){if(!t)throw new Error("The referencedInputs parameter cannot be null.");for(var n=0,i=e;n<i.length;n++){var r=i[n];null!=new RegExp("\\{{2}("+r.id+").value\\}{2}","gi").exec(this._original)&&r.id&&(t[r.id]=r)}},e.prototype.substituteInputValues=function(e,n){if(this._processed=this._original,this._original)for(var i=/\{{2}([a-z0-9_$@]+).value\}{2}/gi,r=void 0;null!==(r=i.exec(this._original));)for(var o=0,a=Object.keys(e);o<a.length;o++){var s=a[o];if(s.toLowerCase()==r[1].toLowerCase()){var l=e[s],p="";l.value&&(p=l.value),n===t.ContentTypes.applicationJson?p=(p=JSON.stringify(p)).slice(1,-1):n===t.ContentTypes.applicationXWwwFormUrlencoded&&(p=encodeURIComponent(p)),this._processed=this._processed.replace(r[0],p);break}}this._isProcessed=!0},e.prototype.getOriginal=function(){return this._original},e.prototype.get=function(){return this._isProcessed?this._processed:this._original},e.prototype.set=function(e){this._original=e,this._isProcessed=!1},e}();t.StringWithSubstitutions=o;var a=function(e,t,n,i){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===i&&(i=0),this.left=0,this.top=0,this.right=0,this.bottom=0,this.top=e,this.right=t,this.bottom=n,this.left=i};t.SpacingDefinition=a;var s=function(e,t,n,r){void 0===e&&(e=i.Spacing.None),void 0===t&&(t=i.Spacing.None),void 0===n&&(n=i.Spacing.None),void 0===r&&(r=i.Spacing.None),this.top=i.Spacing.None,this.right=i.Spacing.None,this.bottom=i.Spacing.None,this.left=i.Spacing.None,this.top=e,this.right=t,this.bottom=n,this.left=r};t.PaddingDefinition=s;var l=function(){function e(e,t){this.physicalSize=e,this.unit=t}return e.parse=function(t,n){void 0===n&&(n=!1);var r=new e(0,i.SizeUnit.Weight);if("number"==typeof t)return r.physicalSize=t,r;if("string"==typeof t){var o=/^([0-9]+)(px|\*)?$/g.exec(t),a=n?3:2;if(o&&o.length>=a)return r.physicalSize=parseInt(o[1]),3==o.length&&"px"==o[2]&&(r.unit=i.SizeUnit.Pixel),r}throw new Error("Invalid size: "+t)},e}();t.SizeAndUnit=l;
/**
 * Fast UUID generator, RFC4122 version 4 compliant.
 * @author Jeff Ward (jcward.com).
 * @license MIT license
 * @link http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/21963136#21963136
 **/
var p=function(){function e(){}return e.generate=function(){var t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return e.lut[255&t]+e.lut[t>>8&255]+e.lut[t>>16&255]+e.lut[t>>24&255]+"-"+e.lut[255&n]+e.lut[n>>8&255]+"-"+e.lut[n>>16&15|64]+e.lut[n>>24&255]+"-"+e.lut[63&i|128]+e.lut[i>>8&255]+"-"+e.lut[i>>16&255]+e.lut[i>>24&255]+e.lut[255&r]+e.lut[r>>8&255]+e.lut[r>>16&255]+e.lut[r>>24&255]},e.initialize=function(){for(var t=0;t<256;t++)e.lut[t]=(t<16?"0":"")+t.toString(16)},e.lut=[],e}();t.UUID=p,p.initialize()},7870:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.SerializableObject=t.property=t.SerializableObjectSchema=t.CustomProperty=t.SerializableObjectCollectionProperty=t.SerializableObjectProperty=t.EnumProperty=t.ValueSetProperty=t.StringArrayProperty=t.PixelSizeProperty=t.NumProperty=t.BoolProperty=t.StringProperty=t.PropertyDefinition=t.BaseSerializationContext=t.isVersionLessOrEqual=t.Versions=t.Version=void 0;var o=n(7388),a=n(7871),s=n(6800),l=n(8898),p=function(){function e(e,t,n){void 0===e&&(e=1),void 0===t&&(t=1),this._isValid=!0,this._major=e,this._minor=t,this._label=n}return e.parse=function(t,n){if(t){var i=new e;i._versionString=t;var r=/(\d+).(\d+)/gi.exec(t);return null!=r&&3==r.length?(i._major=parseInt(r[1]),i._minor=parseInt(r[2])):i._isValid=!1,i._isValid||n.logParseEvent(void 0,s.ValidationEvent.InvalidPropertyValue,l.Strings.errors.invalidVersionString(i._versionString)),i}},e.prototype.toString=function(){return this._isValid?this._major+"."+this._minor:this._versionString},e.prototype.toJSON=function(){return this.toString()},e.prototype.compareTo=function(e){if(!this.isValid||!e.isValid)throw new Error("Cannot compare invalid version.");return this.major>e.major?1:this.major<e.major?-1:this.minor>e.minor?1:this.minor<e.minor?-1:0},Object.defineProperty(e.prototype,"label",{get:function(){return this._label?this._label:this.toString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"major",{get:function(){return this._major},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minor",{get:function(){return this._minor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isValid",{get:function(){return this._isValid},enumerable:!1,configurable:!0}),e}();t.Version=p;var u=function(){function e(){}return e.v1_0=new p(1,0),e.v1_1=new p(1,1),e.v1_2=new p(1,2),e.v1_3=new p(1,3),e.v1_4=new p(1,4),e.v1_5=new p(1,5,"1.5 (Preview)"),e.latest=e.v1_4,e}();t.Versions=u,t.isVersionLessOrEqual=function(e,t){return!(e instanceof p)||(!(t instanceof p)||t.compareTo(e)>=0)};var c=function(){function e(e){void 0===e&&(e=u.latest),this.targetVersion=e,this._validationEvents=[]}return e.prototype.serializeValue=function(e,t,n,i,r){void 0===i&&(i=void 0),void 0===r&&(r=!1),null==n||n===i?o.GlobalSettings.enableFullJsonRoundTrip&&!r||delete e[t]:n===i?delete e[t]:e[t]=n},e.prototype.serializeString=function(e,t,n,i){null==n||n===i?delete e[t]:e[t]=n},e.prototype.serializeBool=function(e,t,n,i){null==n||n===i?delete e[t]:e[t]=n},e.prototype.serializeNumber=function(e,t,n,i){null==n||n===i||isNaN(n)?delete e[t]:e[t]=n},e.prototype.serializeEnum=function(e,t,n,i,r){void 0===r&&(r=void 0),null==i||i===r?delete t[n]:t[n]=e[i]},e.prototype.serializeArray=function(e,t,n){var i=[];if(n)for(var r=0,o=n;r<o.length;r++){var a=o[r],s=void 0;void 0!==(s=a instanceof E?a.toJSON(this):a.toJSON?a.toJSON():a)&&i.push(s)}0==i.length?e.hasOwnProperty(t)&&Array.isArray(e[t])&&delete e[t]:this.serializeValue(e,t,i)},e.prototype.clearEvents=function(){this._validationEvents=[]},e.prototype.logEvent=function(e,t,n,i){this._validationEvents.push({source:e,phase:t,event:n,message:i})},e.prototype.logParseEvent=function(e,t,n){this.logEvent(e,s.ValidationPhase.Parse,t,n)},e.prototype.getEventAt=function(e){return this._validationEvents[e]},Object.defineProperty(e.prototype,"eventCount",{get:function(){return this._validationEvents.length},enumerable:!1,configurable:!0}),e}();t.BaseSerializationContext=c;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t}(c),d=function(){function e(t,n,i,r){this.targetVersion=t,this.name=n,this.defaultValue=i,this.onGetInitialValue=r,this.isSerializationEnabled=!0,this.sequentialNumber=e._sequentialNumber,e._sequentialNumber++}return e.prototype.getInternalName=function(){return this.name},e.prototype.parse=function(e,t,n){return t[this.name]},e.prototype.toJSON=function(e,t,n,i){i.serializeValue(t,this.name,n,this.defaultValue)},e._sequentialNumber=0,e}();t.PropertyDefinition=d;var f=function(e){function t(t,n,i,r,o,a){void 0===i&&(i=!0);var s=e.call(this,t,n,o,a)||this;return s.targetVersion=t,s.name=n,s.treatEmptyAsUndefined=i,s.regEx=r,s.defaultValue=o,s.onGetInitialValue=a,s}return r(t,e),t.prototype.parse=function(e,t,n){var i=a.parseString(t[this.name],this.defaultValue);if(!(void 0===i||""===i&&this.treatEmptyAsUndefined)&&void 0!==this.regEx&&!this.regEx.exec(i))return void n.logParseEvent(e,s.ValidationEvent.InvalidPropertyValue,l.Strings.errors.invalidPropertyValue(i,this.name));return i},t.prototype.toJSON=function(e,t,n,i){i.serializeString(t,this.name,""===n&&this.treatEmptyAsUndefined?void 0:n,this.defaultValue)},t}(d);t.StringProperty=f;var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.parse=function(e,t,n){return a.parseBool(t[this.name],this.defaultValue)},t.prototype.toJSON=function(e,t,n,i){i.serializeBool(t,this.name,n,this.defaultValue)},t}(d);t.BoolProperty=y;var g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.parse=function(e,t,n){return a.parseNumber(t[this.name],this.defaultValue)},t.prototype.toJSON=function(e,t,n,i){i.serializeNumber(t,this.name,n,this.defaultValue)},t}(d);t.NumProperty=g;var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.parse=function(e,t,n){var i=void 0,r=t[this.name];if("string"==typeof r){var a=!1;try{var p=o.SizeAndUnit.parse(r,!0);p.unit==s.SizeUnit.Pixel&&(i=p.physicalSize,a=!0)}catch(e){}a||n.logParseEvent(e,s.ValidationEvent.InvalidPropertyValue,l.Strings.errors.invalidPropertyValue(t[this.name],"minHeight"))}return i},t.prototype.toJSON=function(e,t,n,i){i.serializeValue(t,this.name,"number"!=typeof n||isNaN(n)?void 0:n+"px")},t}(d);t.PixelSizeProperty=m;var v=function(e){function t(t,n,i,r){var o=e.call(this,t,n,i,r)||this;return o.targetVersion=t,o.name=n,o.defaultValue=i,o.onGetInitialValue=r,o}return r(t,e),t.prototype.parse=function(e,t,n){var i=t[this.name];if(void 0===i||!Array.isArray(i))return this.defaultValue;for(var r=[],o=0,a=i;o<a.length;o++){var l=a[o];"string"==typeof l?r.push(l):n.logParseEvent(e,s.ValidationEvent.InvalidPropertyValue,'Invalid array value "'+l+'" of type "'+typeof l+'" ignored for "'+this.name+'".')}return r},t.prototype.toJSON=function(e,t,n,i){i.serializeArray(t,this.name,n)},t}(d);t.StringArrayProperty=v;var b=function(e){function t(t,n,i,r,o){var a=e.call(this,t,n,r,o)||this;return a.targetVersion=t,a.name=n,a.values=i,a.defaultValue=r,a.onGetInitialValue=o,a}return r(t,e),t.prototype.isValidValue=function(e,t){for(var n=0,i=this.values;n<i.length;n++){var r=i[n];if(e.toLowerCase()===r.value.toLowerCase())return(r.targetVersion?r.targetVersion:this.targetVersion).compareTo(t.targetVersion)<=0}return!1},t.prototype.parse=function(e,t,n){var i=t[this.name];if(void 0===i)return this.defaultValue;if("string"==typeof i)for(var r=0,o=this.values;r<o.length;r++){var a=o[r];if(i.toLowerCase()===a.value.toLowerCase()){var p=a.targetVersion?a.targetVersion:this.targetVersion;return p.compareTo(n.targetVersion)<=0?a.value:(n.logParseEvent(e,s.ValidationEvent.InvalidPropertyValue,l.Strings.errors.propertyValueNotSupported(i,this.name,p.toString(),n.targetVersion.toString())),this.defaultValue)}}return n.logParseEvent(e,s.ValidationEvent.InvalidPropertyValue,l.Strings.errors.invalidPropertyValue(i,this.name)),this.defaultValue},t.prototype.toJSON=function(e,t,n,i){var r=!1;if(void 0!==n){r=!0;for(var o=0,a=this.values;o<a.length;o++){var p=a[o];if(p.value===n){var u=p.targetVersion?p.targetVersion:this.targetVersion;if(u.compareTo(i.targetVersion)<=0){r=!1;break}i.logEvent(e,s.ValidationPhase.ToJSON,s.ValidationEvent.InvalidPropertyValue,l.Strings.errors.propertyValueNotSupported(n,this.name,u.toString(),i.targetVersion.toString()))}}}r||i.serializeValue(t,this.name,n,this.defaultValue,!0)},t}(d);t.ValueSetProperty=b;var C=function(e){function t(t,n,i,r,o,a){var s=e.call(this,t,n,r,a)||this;if(s.targetVersion=t,s.name=n,s.enumType=i,s.defaultValue=r,s.onGetInitialValue=a,s._values=[],o)s._values=o;else for(var l in i){var p=parseInt(l,10);p>=0&&s._values.push({value:p})}return s}return r(t,e),t.prototype.parse=function(e,t,n){var i=t[this.name];if("string"!=typeof i)return this.defaultValue;var r=a.getEnumValueByName(this.enumType,i);if(void 0!==r)for(var o=0,p=this.values;o<p.length;o++){var u=p[o];if(u.value===r){var c=u.targetVersion?u.targetVersion:this.targetVersion;return c.compareTo(n.targetVersion)<=0?r:(n.logParseEvent(e,s.ValidationEvent.InvalidPropertyValue,l.Strings.errors.propertyValueNotSupported(i,this.name,c.toString(),n.targetVersion.toString())),this.defaultValue)}}return n.logParseEvent(e,s.ValidationEvent.InvalidPropertyValue,l.Strings.errors.invalidPropertyValue(i,this.name)),this.defaultValue},t.prototype.toJSON=function(e,t,n,i){var r=!1;if(void 0!==n){r=!0;for(var o=0,a=this.values;o<a.length;o++){var p=a[o];if(p.value===n){if((p.targetVersion?p.targetVersion:this.targetVersion).compareTo(i.targetVersion)<=0){r=!1;break}i.logEvent(e,s.ValidationPhase.ToJSON,s.ValidationEvent.InvalidPropertyValue,l.Strings.errors.invalidPropertyValue(n,this.name))}}}r||i.serializeEnum(this.enumType,t,this.name,n,this.defaultValue)},Object.defineProperty(t.prototype,"values",{get:function(){return this._values},enumerable:!1,configurable:!0}),t}(d);t.EnumProperty=C;var S=function(e){function t(t,n,i,r,o){void 0===r&&(r=!1);var a=e.call(this,t,n,o,(function(e){return a.nullable?void 0:new a.objectType}))||this;return a.targetVersion=t,a.name=n,a.objectType=i,a.nullable=r,a}return r(t,e),t.prototype.parse=function(e,t,n){var i=t[this.name];if(void 0===i)return this.onGetInitialValue?this.onGetInitialValue(e):this.defaultValue;var r=new this.objectType;return r.parse(i,n),r},t.prototype.toJSON=function(e,t,n,i){var r=void 0;void 0===n||n.hasAllDefaultValues()||(r=n.toJSON(i)),"object"==typeof r&&0===Object.keys(r).length&&(r=void 0),i.serializeValue(t,this.name,r,this.defaultValue,!0)},t}(d);t.SerializableObjectProperty=S;var _=function(e){function t(t,n,i,r){var o=e.call(this,t,n,void 0,(function(e){return[]}))||this;return o.targetVersion=t,o.name=n,o.objectType=i,o.onItemAdded=r,o}return r(t,e),t.prototype.parse=function(e,t,n){var i=[],r=t[this.name];if(Array.isArray(r))for(var o=0,a=r;o<a.length;o++){var s=a[o],l=new this.objectType;l.parse(s,n),i.push(l),this.onItemAdded&&this.onItemAdded(e,l)}return i.length>0?i:this.onGetInitialValue?this.onGetInitialValue(e):void 0},t.prototype.toJSON=function(e,t,n,i){i.serializeArray(t,this.name,n)},t}(d);t.SerializableObjectCollectionProperty=_;var P=function(e){function t(t,n,i,r,o,a){var s=e.call(this,t,n,o,a)||this;if(s.targetVersion=t,s.name=n,s.onParse=i,s.onToJSON=r,s.defaultValue=o,s.onGetInitialValue=a,!s.onParse)throw new Error("CustomPropertyDefinition instances must have an onParse handler.");if(!s.onToJSON)throw new Error("CustomPropertyDefinition instances must have an onToJSON handler.");return s}return r(t,e),t.prototype.parse=function(e,t,n){return this.onParse(e,this,t,n)},t.prototype.toJSON=function(e,t,n,i){this.onToJSON(e,this,t,n,i)},t}(d);t.CustomProperty=P;var A=function(){function e(){this._properties=[]}return e.prototype.indexOf=function(e){for(var t=0;t<this._properties.length;t++)if(this._properties[t]===e)return t;return-1},e.prototype.add=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0;n<e.length;n++)-1===this.indexOf(e[n])&&this._properties.push(e[n])},e.prototype.remove=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0,i=e;n<i.length;n++)for(var r=i[n];;){var o=this.indexOf(r);if(!(o>=0))break;this._properties.splice(o,1)}},e.prototype.getItemAt=function(e){return this._properties[e]},e.prototype.getCount=function(){return this._properties.length},e}();t.SerializableObjectSchema=A,t.property=function(e){return function(t,n){var i=Object.getOwnPropertyDescriptor(t,n)||{};i.get||i.set||(i.get=function(){return this.getValue(e)},i.set=function(t){this.setValue(e,t)},Object.defineProperty(t,n,i))}};var E=function(){function e(){this._propertyBag={},this._rawProperties={},this.maxVersion=e.defaultMaxVersion;for(var t=this.getSchema(),n=0;n<t.getCount();n++){var i=t.getItemAt(n);i.onGetInitialValue&&this.setValue(i,i.onGetInitialValue(this))}}return e.prototype.getDefaultSerializationContext=function(){return new h},e.prototype.populateSchema=function(t){var n=this.constructor,i=[];for(var r in n)try{var o=n[r];o instanceof d&&i.push(o)}catch(e){}if(i.length>0){var a=i.sort((function(e,t){return e.sequentialNumber>t.sequentialNumber?1:e.sequentialNumber<t.sequentialNumber?-1:0}));t.add.apply(t,a)}e.onRegisterCustomProperties&&e.onRegisterCustomProperties(this,t)},e.prototype.getValue=function(e){return this._propertyBag.hasOwnProperty(e.getInternalName())?this._propertyBag[e.getInternalName()]:e.defaultValue},e.prototype.setValue=function(e,t){null==t?delete this._propertyBag[e.getInternalName()]:this._propertyBag[e.getInternalName()]=t},e.prototype.internalParse=function(e,t){if(this._propertyBag={},this._rawProperties=o.GlobalSettings.enableFullJsonRoundTrip&&e||{},e)for(var n=this.getSchema(),i=0;i<n.getCount();i++){var r=n.getItemAt(i);if(r.isSerializationEnabled){var a=r.onGetInitialValue?r.onGetInitialValue(this):void 0;e.hasOwnProperty(r.name)&&(r.targetVersion.compareTo(t.targetVersion)<=0?a=r.parse(this,e,t):t.logParseEvent(this,s.ValidationEvent.UnsupportedProperty,l.Strings.errors.propertyNotSupported(r.name,r.targetVersion.toString(),t.targetVersion.toString()))),this.setValue(r,a)}}else this.resetDefaultValues()},e.prototype.internalToJSON=function(e,t){for(var n=this.getSchema(),i=[],r=0;r<n.getCount();r++){var o=n.getItemAt(r);o.isSerializationEnabled&&o.targetVersion.compareTo(t.targetVersion)<=0&&-1===i.indexOf(o.name)&&(o.toJSON(this,e,this.getValue(o),t),i.push(o.name))}},e.prototype.shouldSerialize=function(e){return!0},e.prototype.parse=function(e,t){this.internalParse(e,t||new h)},e.prototype.toJSON=function(e){var t;if(e&&e instanceof c?t=e:(t=this.getDefaultSerializationContext()).toJSONOriginalParam=e,this.shouldSerialize(t)){var n=void 0;return n=o.GlobalSettings.enableFullJsonRoundTrip&&this._rawProperties&&"object"==typeof this._rawProperties?this._rawProperties:{},this.internalToJSON(n,t),n}},e.prototype.hasDefaultValue=function(e){return this.getValue(e)===e.defaultValue},e.prototype.hasAllDefaultValues=function(){for(var e=this.getSchema(),t=0;t<e.getCount();t++){var n=e.getItemAt(t);if(!this.hasDefaultValue(n))return!1}return!0},e.prototype.resetDefaultValues=function(){for(var e=this.getSchema(),t=0;t<e.getCount();t++){var n=e.getItemAt(t);this.setValue(n,n.defaultValue)}},e.prototype.setCustomProperty=function(e,t){"string"==typeof t&&!t||null==t?delete this._rawProperties[e]:this._rawProperties[e]=t},e.prototype.getCustomProperty=function(e){return this._rawProperties[e]},e.prototype.getSchema=function(){var t=e._schemaCache[this.getSchemaKey()];return t||(t=new A,this.populateSchema(t),e._schemaCache[this.getSchemaKey()]=t),t},e.defaultMaxVersion=u.latest,e._schemaCache={},e}();t.SerializableObject=E},7871:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clearElementChildren=t.getScrollY=t.getScrollX=t.getFitStatus=t.truncate=t.stringToCssColor=t.renderSeparation=t.parseEnum=t.getEnumValueByName=t.parseBool=t.parseNumber=t.parseString=t.appendChild=t.generateUniqueId=t.isMobileOS=t.isInternetExplorer=void 0;var i=n(6800),r=n(7388);function o(e,t){for(var n in e){var i=parseInt(n,10);if(i>=0){var r=e[n];if(r&&"string"==typeof r&&r.toLowerCase()===t.toLowerCase())return i}}}function a(e){if(e){var t=/#([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})?/gi.exec(e);if(t&&t[4]){var n=parseInt(t[1],16)/255;return"rgba("+parseInt(t[2],16)+","+parseInt(t[3],16)+","+parseInt(t[4],16)+","+n+")"}}return e}function s(e,t){for(t+=1;t<e.length&&"<"==e[t];)for(;t<e.length&&">"!=e[t++];);return t}t.isInternetExplorer=function(){return void 0!==window.document.documentMode},t.isMobileOS=function(){var e=window.navigator.userAgent;return!!e.match(/Android/i)||!!e.match(/iPad/i)||!!e.match(/iPhone/i)},t.generateUniqueId=function(){return"__ac-"+r.UUID.generate()},t.appendChild=function(e,t){t&&e.appendChild(t)},t.parseString=function(e,t){return"string"==typeof e?e:t},t.parseNumber=function(e,t){return"number"==typeof e?e:t},t.parseBool=function(e,t){if("boolean"==typeof e)return e;if("string"==typeof e)switch(e.toLowerCase()){case"true":return!0;case"false":return!1;default:return t}return t},t.getEnumValueByName=o,t.parseEnum=function(e,t,n){if(!t)return n;var i=o(e,t);return void 0!==i?i:n},t.renderSeparation=function(e,t,n){if(t.spacing>0||t.lineThickness&&t.lineThickness>0){var r=document.createElement("div");r.className=e.makeCssClassName("ac-"+(n==i.Orientation.Horizontal?"horizontal":"vertical")+"-separator"),r.setAttribute("aria-hidden","true");var o=t.lineColor?a(t.lineColor):"";return n==i.Orientation.Horizontal?t.lineThickness?(r.style.paddingTop=t.spacing/2+"px",r.style.marginBottom=t.spacing/2+"px",r.style.borderBottom=t.lineThickness+"px solid "+o):r.style.height=t.spacing+"px":t.lineThickness?(r.style.paddingLeft=t.spacing/2+"px",r.style.marginRight=t.spacing/2+"px",r.style.borderRight=t.lineThickness+"px solid "+o):r.style.width=t.spacing+"px",r.style.overflow="hidden",r.style.flex="0 0 auto",r}},t.stringToCssColor=a,t.truncate=function(e,t,n){var i=function(){return t-e.scrollHeight>=-1};if(!i()){for(var r=e.innerHTML,o=function(t){e.innerHTML=r.substring(0,t)+"..."},a=function(e){var t=[],n=s(e,-1);for(;n<e.length;)" "==e[n]&&t.push(n),n=s(e,n);return t}(r),l=0,p=a.length,u=0;l<p;){var c=Math.floor((l+p)/2);o(a[c]),i()?(u=a[c],l=c+1):p=c}if(o(u),n&&t-e.scrollHeight>=n-1){for(var h=s(r,u);h<r.length&&(o(h),i());)u=h,h=s(r,h);o(u)}}},t.getFitStatus=function(e,t){var n=e.offsetTop;return n+e.clientHeight<=t?i.ContainerFitStatus.FullyInContainer:n<t?i.ContainerFitStatus.Overflowing:i.ContainerFitStatus.FullyOutOfContainer},t.getScrollX=function(){return window.pageXOffset},t.getScrollY=function(){return window.pageYOffset},t.clearElementChildren=function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}},8898:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Strings=void 0;var i=function(){function e(){}return e.errors={unknownElementType:function(e){return'Unknown element type "'+e+'". Fallback will be used if present.'},unknownActionType:function(e){return'Unknown action type "'+e+'". Fallback will be used if present.'},elementTypeNotAllowed:function(e){return'Element type "'+e+'" is not allowed in this context.'},actionTypeNotAllowed:function(e){return'Action type "'+e+'" is not allowed in this context.'},invalidPropertyValue:function(e,t){return'Invalid value "'+e+'" for property "'+t+'".'},showCardMustHaveCard:function(){return'"An Action.ShowCard must have its "card" property set to a valid AdaptiveCard object.'},invalidColumnWidth:function(e){return'Invalid column width "'+e+'" - defaulting to "auto".'},invalidCardVersion:function(e){return'Invalid card version. Defaulting to "'+e+'".'},invalidVersionString:function(e){return'Invalid version string "'+e+'".'},propertyValueNotSupported:function(e,t,n,i){return'Value "'+e+'" for property "'+t+'" is supported in version '+n+", but you are using version "+i+"."},propertyNotSupported:function(e,t,n){return'Property "'+e+'" is supported in version '+t+", but you are using version "+n+"."},indexOutOfRange:function(e){return"Index out of range ("+e+")."},elementCannotBeUsedAsInline:function(){return"RichTextBlock.addInline: the specified card element cannot be used as a RichTextBlock inline."},inlineAlreadyParented:function(){return"RichTextBlock.addInline: the specified inline already belongs to another RichTextBlock."},interactivityNotAllowed:function(){return"Interactivity is not allowed."},inputsMustHaveUniqueId:function(){return"All inputs must have a unique Id."},choiceSetMustHaveAtLeastOneChoice:function(){return"An Input.ChoiceSet must have at least one choice defined."},choiceSetChoicesMustHaveTitleAndValue:function(){return"All choices in an Input.ChoiceSet must have their title and value properties set."},propertyMustBeSet:function(e){return'Property "'+e+'" must be set.'},actionHttpHeadersMustHaveNameAndValue:function(){return"All headers of an Action.Http must have their name and value properties set."},tooManyActions:function(e){return"Maximum number of actions exceeded ("+e+")."},columnAlreadyBelongsToAnotherSet:function(){return"This column already belongs to another ColumnSet."},invalidCardType:function(){return'Invalid or missing card type. Make sure the card\'s type property is set to "AdaptiveCard".'},unsupportedCardVersion:function(e,t){return"The specified card version ("+e+") is not supported. The maximum supported card version is "+t+"."},duplicateId:function(e){return'Duplicate Id "'+e+'".'},markdownProcessingNotEnabled:function(){return"Markdown processing isn't enabled. Please see https://www.npmjs.com/package/adaptivecards#supporting-markdown"},processMarkdownEventRemoved:function(){return"The processMarkdown event has been removed. Please update your code and set onProcessMarkdown instead."},elementAlreadyParented:function(){return"The element already belongs to another container."},actionAlreadyParented:function(){return"The action already belongs to another element."},elementTypeNotStandalone:function(e){return"Elements of type "+e+" cannot be used as standalone elements."}},e.magicCodeInputCard={tryAgain:function(){return"That didn't work... let's try again."},pleaseLogin:function(){return'Please login in the popup. You will obtain a magic code. Paste that code below and select "Submit"'},enterMagicCode:function(){return"Enter magic code"},pleaseEnterMagicCodeYouReceived:function(){return"Please enter the magic code you received."},submit:function(){return"Submit"},cancel:function(){return"Cancel"},somethingWentWrong:function(){return"Something went wrong. This action can't be handled."},authenticationFailed:function(){return"Authentication failed."}},e.runtime={automaticRefreshPaused:function(){return"Automatic refresh paused."},clckToRestartAutomaticRefresh:function(){return"Click to restart."},refreshThisCard:function(){return"Refresh this card"}},e.hints={dontUseWeightedAndStrecthedColumnsInSameSet:function(){return"It is not recommended to use weighted and stretched columns in the same ColumnSet, because in such a situation stretched columns will always get the minimum amount of space."}},e.defaults={inlineActionTitle:function(){return"Inline Action"},overflowButtonText:function(){return"..."},mediaPlayerAriaLabel:function(){return"Media content"},mediaPlayerPlayMedia:function(){return"Play media"}},e}();t.Strings=i},9705:function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.defaultHostConfig=t.HostConfig=t.FontTypeSet=t.FontTypeDefinition=t.ContainerStyleSet=t.ContainerStyleDefinition=t.ColorSetDefinition=t.ActionsConfig=t.ShowCardActionConfig=t.FactSetConfig=t.FactTitleDefinition=t.FactTextDefinition=t.InputConfig=t.InputLabelConfig=t.RequiredInputLabelTextDefinition=t.TextBlockConfig=t.TextStyleSet=t.TextStyleDefinition=t.BaseTextDefinition=t.MediaConfig=t.ImageSetConfig=t.AdaptiveCardConfig=t.TextColorDefinition=t.ColorDefinition=void 0;var o=n(6800),a=n(7871),s=n(7388),l=n(12948);function p(e,t,n){if("string"==typeof t){var i=a.parseEnum(e,t,n);return void 0!==i?i:n}return"number"==typeof t?t:n}var u=function(){function e(e,t){this.default="#000000",this.subtle="#666666",e&&(this.default=e),t&&(this.subtle=t)}return e.prototype.parse=function(e){e&&(this.default=e.default||this.default,this.subtle=e.subtle||this.subtle)},e}();t.ColorDefinition=u;var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.highlightColors=new u("#22000000","#11000000"),t}return r(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),t&&this.highlightColors.parse(t.highlightColors)},t}(u);t.TextColorDefinition=c;var h=function(e){this.allowCustomStyle=!1,e&&(this.allowCustomStyle=e.allowCustomStyle||this.allowCustomStyle)};t.AdaptiveCardConfig=h;var d=function(){function e(e){this.imageSize=o.Size.Medium,this.maxImageHeight=100,e&&(this.imageSize=null!=e.imageSize?e.imageSize:this.imageSize,this.maxImageHeight=a.parseNumber(e.maxImageHeight,100))}return e.prototype.toJSON=function(){return{imageSize:o.Size[this.imageSize],maxImageHeight:this.maxImageHeight}},e}();t.ImageSetConfig=d;var f=function(){function e(e){this.allowInlinePlayback=!0,e&&(this.defaultPoster=e.defaultPoster,this.allowInlinePlayback=e.allowInlinePlayback||this.allowInlinePlayback)}return e.prototype.toJSON=function(){return{defaultPoster:this.defaultPoster,allowInlinePlayback:this.allowInlinePlayback}},e}();t.MediaConfig=f;var y=function(){function e(e){this.size=o.TextSize.Default,this.color=o.TextColor.Default,this.isSubtle=!1,this.weight=o.TextWeight.Default,this.parse(e)}return e.prototype.parse=function(e){e&&(this.size=p(o.TextSize,e.size,this.size),this.color=p(o.TextColor,e.color,this.color),this.isSubtle=void 0!==e.isSubtle&&"boolean"==typeof e.isSubtle?e.isSubtle:this.isSubtle,this.weight=p(o.TextWeight,e.weight,this.getDefaultWeight()))},e.prototype.getDefaultWeight=function(){return o.TextWeight.Default},e.prototype.toJSON=function(){return{size:o.TextSize[this.size],color:o.TextColor[this.color],isSubtle:this.isSubtle,weight:o.TextWeight[this.weight]}},e}();t.BaseTextDefinition=y;var g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fontType=o.FontType.Default,t}return r(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),t&&(this.fontType=p(o.FontType,t.fontType,this.fontType))},t}(y);t.TextStyleDefinition=g;var m=function(){function e(e){this.default=new g,this.heading=new g({size:"Large",weight:"Bolder"}),e&&this.heading.parse(e.heading)}return e.prototype.getStyleByName=function(e){return"heading"===e.toLowerCase()?this.heading:this.default},e}();t.TextStyleSet=m;var v=function(e){e&&(this.headingLevel=a.parseNumber(e.headingLevel))};t.TextBlockConfig=v;var b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.suffix=" *",t.suffixColor=o.TextColor.Attention,t}return r(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),t&&(this.suffix=t.suffix||this.suffix,this.suffixColor=p(o.TextColor,t.suffixColor,this.suffixColor))},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.suffix=this.suffix,t.suffixColor=o.TextColor[this.suffixColor],t},t}(y);t.RequiredInputLabelTextDefinition=b;var C=function(e){this.inputSpacing=o.Spacing.Small,this.requiredInputs=new b,this.optionalInputs=new y,e&&(this.inputSpacing=p(o.Spacing,e.inputSpacing,this.inputSpacing),this.requiredInputs=new b(e.requiredInputs),this.optionalInputs=new y(e.optionalInputs))};t.InputLabelConfig=C;var S=function(e){this.label=new C,this.errorMessage=new y({color:o.TextColor.Attention}),e&&(this.label=new C(e.label),this.errorMessage=new y(e.errorMessage))};t.InputConfig=S;var _=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.wrap=!0,t}return r(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),t&&(this.wrap=null!=t.wrap?t.wrap:this.wrap)},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.wrap=this.wrap,t},t}(y);t.FactTextDefinition=_;var P=function(e){function t(t){var n=e.call(this,t)||this;return n.maxWidth=150,n.weight=o.TextWeight.Bolder,t&&(n.maxWidth=null!=t.maxWidth?t.maxWidth:n.maxWidth,n.weight=p(o.TextWeight,t.weight,o.TextWeight.Bolder)),n}return r(t,e),t.prototype.getDefaultWeight=function(){return o.TextWeight.Bolder},t}(_);t.FactTitleDefinition=P;var A=function(e){this.title=new P,this.value=new _,this.spacing=10,e&&(this.title=new P(e.title),this.value=new _(e.value),this.spacing=e.spacing&&null!=e.spacing?e.spacing&&e.spacing:this.spacing)};t.FactSetConfig=A;var E=function(){function e(e){this.actionMode=o.ShowCardActionMode.Inline,this.inlineTopMargin=16,this.style=o.ContainerStyle.Emphasis,e&&(this.actionMode=p(o.ShowCardActionMode,e.actionMode,o.ShowCardActionMode.Inline),this.inlineTopMargin=null!=e.inlineTopMargin?e.inlineTopMargin:this.inlineTopMargin,this.style=e.style&&"string"==typeof e.style?e.style:o.ContainerStyle.Emphasis)}return e.prototype.toJSON=function(){return{actionMode:o.ShowCardActionMode[this.actionMode],inlineTopMargin:this.inlineTopMargin,style:this.style}},e}();t.ShowCardActionConfig=E;var w=function(){function e(e){if(this.maxActions=5,this.spacing=o.Spacing.Default,this.buttonSpacing=20,this.showCard=new E,this.preExpandSingleShowCardAction=!1,this.actionsOrientation=o.Orientation.Horizontal,this.actionAlignment=o.ActionAlignment.Left,this.iconPlacement=o.ActionIconPlacement.LeftOfTitle,this.allowTitleToWrap=!1,this.iconSize=16,e){this.maxActions=null!=e.maxActions?e.maxActions:this.maxActions,this.spacing=p(o.Spacing,e.spacing&&e.spacing,o.Spacing.Default),this.buttonSpacing=null!=e.buttonSpacing?e.buttonSpacing:this.buttonSpacing,this.showCard=new E(e.showCard),this.preExpandSingleShowCardAction=a.parseBool(e.preExpandSingleShowCardAction,!1),this.actionsOrientation=p(o.Orientation,e.actionsOrientation,o.Orientation.Horizontal),this.actionAlignment=p(o.ActionAlignment,e.actionAlignment,o.ActionAlignment.Left),this.iconPlacement=p(o.ActionIconPlacement,e.iconPlacement,o.ActionIconPlacement.LeftOfTitle),this.allowTitleToWrap=null!=e.allowTitleToWrap?e.allowTitleToWrap:this.allowTitleToWrap;try{var t=s.SizeAndUnit.parse(e.iconSize);t.unit==o.SizeUnit.Pixel&&(this.iconSize=t.physicalSize)}catch(e){}}}return e.prototype.toJSON=function(){return{maxActions:this.maxActions,spacing:o.Spacing[this.spacing],buttonSpacing:this.buttonSpacing,showCard:this.showCard,preExpandSingleShowCardAction:this.preExpandSingleShowCardAction,actionsOrientation:o.Orientation[this.actionsOrientation],actionAlignment:o.ActionAlignment[this.actionAlignment]}},e}();t.ActionsConfig=w;var x=function(){function e(e){this.default=new c,this.dark=new c,this.light=new c,this.accent=new c,this.good=new c,this.warning=new c,this.attention=new c,this.parse(e)}return e.prototype.parseSingleColor=function(e,t){e&&this[t].parse(e[t])},e.prototype.parse=function(e){e&&(this.parseSingleColor(e,"default"),this.parseSingleColor(e,"dark"),this.parseSingleColor(e,"light"),this.parseSingleColor(e,"accent"),this.parseSingleColor(e,"good"),this.parseSingleColor(e,"warning"),this.parseSingleColor(e,"attention"))},e}();t.ColorSetDefinition=x;var I=function(){function e(e){this.foregroundColors=new x({default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#E69500",subtle:"#DDE69500"},attention:{default:"#CC3300",subtle:"#DDCC3300"}}),this.parse(e)}return e.prototype.parse=function(e){e&&(this.backgroundColor=e.backgroundColor,this.foregroundColors.parse(e.foregroundColors),this.highlightBackgroundColor=e.highlightBackgroundColor,this.highlightForegroundColor=e.highlightForegroundColor)},Object.defineProperty(e.prototype,"isBuiltIn",{get:function(){return!1},enumerable:!1,configurable:!0}),e}();t.ContainerStyleDefinition=I;var T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),Object.defineProperty(t.prototype,"isBuiltIn",{get:function(){return!0},enumerable:!1,configurable:!0}),t}(I),V=function(){function e(e){if(this._allStyles={},this._allStyles[o.ContainerStyle.Default]=new T,this._allStyles[o.ContainerStyle.Emphasis]=new T,this._allStyles[o.ContainerStyle.Accent]=new T,this._allStyles[o.ContainerStyle.Good]=new T,this._allStyles[o.ContainerStyle.Attention]=new T,this._allStyles[o.ContainerStyle.Warning]=new T,e){this._allStyles[o.ContainerStyle.Default].parse(e[o.ContainerStyle.Default]),this._allStyles[o.ContainerStyle.Emphasis].parse(e[o.ContainerStyle.Emphasis]),this._allStyles[o.ContainerStyle.Accent].parse(e[o.ContainerStyle.Accent]),this._allStyles[o.ContainerStyle.Good].parse(e[o.ContainerStyle.Good]),this._allStyles[o.ContainerStyle.Attention].parse(e[o.ContainerStyle.Attention]),this._allStyles[o.ContainerStyle.Warning].parse(e[o.ContainerStyle.Warning]);var t=e.customStyles;if(t&&Array.isArray(t))for(var n=0,i=t;n<i.length;n++){var r=i[n];if(r){var a=r.name;a&&"string"==typeof a&&(this._allStyles.hasOwnProperty(a)?this._allStyles[a].parse(r.style):this._allStyles[a]=new I(r.style))}}}}return e.prototype.toJSON=function(){var e=this,t=[];Object.keys(this._allStyles).forEach((function(n){e._allStyles[n].isBuiltIn||t.push({name:n,style:e._allStyles[n]})}));var n={default:this.default,emphasis:this.emphasis};return t.length>0&&(n.customStyles=t),n},e.prototype.getStyleByName=function(e,t){return e&&this._allStyles.hasOwnProperty(e)?this._allStyles[e]:t||this._allStyles[o.ContainerStyle.Default]},Object.defineProperty(e.prototype,"default",{get:function(){return this._allStyles[o.ContainerStyle.Default]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"emphasis",{get:function(){return this._allStyles[o.ContainerStyle.Emphasis]},enumerable:!1,configurable:!0}),e}();t.ContainerStyleSet=V;var O=function(){function e(e){this.fontFamily="Segoe UI,Segoe,Segoe WP,Helvetica Neue,Helvetica,sans-serif",this.fontSizes={small:12,default:14,medium:17,large:21,extraLarge:26},this.fontWeights={lighter:200,default:400,bolder:600},e&&(this.fontFamily=e)}return e.prototype.parse=function(e){this.fontFamily=e.fontFamily||this.fontFamily,this.fontSizes={small:e.fontSizes&&e.fontSizes.small||this.fontSizes.small,default:e.fontSizes&&e.fontSizes.default||this.fontSizes.default,medium:e.fontSizes&&e.fontSizes.medium||this.fontSizes.medium,large:e.fontSizes&&e.fontSizes.large||this.fontSizes.large,extraLarge:e.fontSizes&&e.fontSizes.extraLarge||this.fontSizes.extraLarge},this.fontWeights={lighter:e.fontWeights&&e.fontWeights.lighter||this.fontWeights.lighter,default:e.fontWeights&&e.fontWeights.default||this.fontWeights.default,bolder:e.fontWeights&&e.fontWeights.bolder||this.fontWeights.bolder}},e.monospace=new e("'Courier New', Courier, monospace"),e}();t.FontTypeDefinition=O;var k=function(){function e(e){this.default=new O,this.monospace=new O("'Courier New', Courier, monospace"),e&&(this.default.parse(e.default),this.monospace.parse(e.monospace))}return e.prototype.getStyleDefinition=function(e){switch(e){case o.FontType.Monospace:return this.monospace;case o.FontType.Default:default:return this.default}},e}();t.FontTypeSet=k;var N=function(){function e(e){this.hostCapabilities=new l.HostCapabilities,this.choiceSetInputValueSeparator=",",this.supportsInteractivity=!0,this.spacing={small:3,default:8,medium:20,large:30,extraLarge:40,padding:15},this.separator={lineThickness:1,lineColor:"#EEEEEE"},this.imageSizes={small:40,medium:80,large:160},this.containerStyles=new V,this.inputs=new S,this.actions=new w,this.adaptiveCard=new h,this.imageSet=new d,this.media=new f,this.factSet=new A,this.textStyles=new m,this.textBlock=new v,this.alwaysAllowBleed=!1,e&&(("string"==typeof e||e instanceof String)&&(e=JSON.parse(e)),this.choiceSetInputValueSeparator=e&&"string"==typeof e.choiceSetInputValueSeparator?e.choiceSetInputValueSeparator:this.choiceSetInputValueSeparator,this.supportsInteractivity=e&&"boolean"==typeof e.supportsInteractivity?e.supportsInteractivity:this.supportsInteractivity,this._legacyFontType=new O,this._legacyFontType.parse(e),e.fontTypes&&(this.fontTypes=new k(e.fontTypes)),e.lineHeights&&(this.lineHeights={small:e.lineHeights.small,default:e.lineHeights.default,medium:e.lineHeights.medium,large:e.lineHeights.large,extraLarge:e.lineHeights.extraLarge}),this.imageSizes={small:e.imageSizes&&e.imageSizes.small||this.imageSizes.small,medium:e.imageSizes&&e.imageSizes.medium||this.imageSizes.medium,large:e.imageSizes&&e.imageSizes.large||this.imageSizes.large},this.containerStyles=new V(e.containerStyles),this.spacing={small:e.spacing&&e.spacing.small||this.spacing.small,default:e.spacing&&e.spacing.default||this.spacing.default,medium:e.spacing&&e.spacing.medium||this.spacing.medium,large:e.spacing&&e.spacing.large||this.spacing.large,extraLarge:e.spacing&&e.spacing.extraLarge||this.spacing.extraLarge,padding:e.spacing&&e.spacing.padding||this.spacing.padding},this.separator={lineThickness:e.separator&&e.separator.lineThickness||this.separator.lineThickness,lineColor:e.separator&&e.separator.lineColor||this.separator.lineColor},this.inputs=new S(e.inputs||this.inputs),this.actions=new w(e.actions||this.actions),this.adaptiveCard=new h(e.adaptiveCard||this.adaptiveCard),this.imageSet=new d(e.imageSet),this.factSet=new A(e.factSet),this.textStyles=new m(e.textStyles),this.textBlock=new v(e.textBlock))}return e.prototype.getFontTypeDefinition=function(e){return this.fontTypes?this.fontTypes.getStyleDefinition(e):e==o.FontType.Monospace?O.monospace:this._legacyFontType},e.prototype.getEffectiveSpacing=function(e){switch(e){case o.Spacing.Small:return this.spacing.small;case o.Spacing.Default:return this.spacing.default;case o.Spacing.Medium:return this.spacing.medium;case o.Spacing.Large:return this.spacing.large;case o.Spacing.ExtraLarge:return this.spacing.extraLarge;case o.Spacing.Padding:return this.spacing.padding;default:return 0}},e.prototype.paddingDefinitionToSpacingDefinition=function(e){return new s.SpacingDefinition(this.getEffectiveSpacing(e.top),this.getEffectiveSpacing(e.right),this.getEffectiveSpacing(e.bottom),this.getEffectiveSpacing(e.left))},e.prototype.makeCssClassNames=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],i=0,r=e;i<r.length;i++){var o=r[i];n.push((this.cssClassNamePrefix?this.cssClassNamePrefix+"-":"")+o)}return n},e.prototype.makeCssClassName=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.makeCssClassNames.apply(this,e).join(" ");return n||""},Object.defineProperty(e.prototype,"fontFamily",{get:function(){return this._legacyFontType.fontFamily},set:function(e){this._legacyFontType.fontFamily=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSizes",{get:function(){return this._legacyFontType.fontSizes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontWeights",{get:function(){return this._legacyFontType.fontWeights},enumerable:!1,configurable:!0}),e}();t.HostConfig=N,t.defaultHostConfig=new N({supportsInteractivity:!0,spacing:{small:10,default:20,medium:30,large:40,extraLarge:50,padding:20},separator:{lineThickness:1,lineColor:"#EEEEEE"},fontTypes:{default:{fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}},monospace:{fontFamily:"'Courier New', Courier, monospace",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}}},imageSizes:{small:40,medium:80,large:160},containerStyles:{default:{backgroundColor:"#FFFFFF",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},emphasis:{backgroundColor:"#08000000",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},accent:{backgroundColor:"#C7DEF9",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},good:{backgroundColor:"#CCFFCC",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},attention:{backgroundColor:"#FFC5B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},warning:{backgroundColor:"#FFE2B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}}},inputs:{label:{requiredInputs:{color:o.TextColor.Accent,size:o.TextSize.ExtraLarge,weight:o.TextWeight.Bolder,isSubtle:!0,suffix:" (required)",suffixColor:o.TextColor.Good},optionalInputs:{color:o.TextColor.Warning,size:o.TextSize.Medium,weight:o.TextWeight.Lighter,isSubtle:!1}},errorMessage:{color:o.TextColor.Accent,size:o.TextSize.Small,weight:o.TextWeight.Bolder}},actions:{maxActions:5,spacing:o.Spacing.Default,buttonSpacing:10,showCard:{actionMode:o.ShowCardActionMode.Inline,inlineTopMargin:16},actionsOrientation:o.Orientation.Horizontal,actionAlignment:o.ActionAlignment.Left},adaptiveCard:{allowCustomStyle:!1},imageSet:{imageSize:o.Size.Medium,maxImageHeight:100},factSet:{title:{color:o.TextColor.Default,size:o.TextSize.Default,isSubtle:!1,weight:o.TextWeight.Bolder,wrap:!0,maxWidth:150},value:{color:o.TextColor.Default,size:o.TextSize.Default,isSubtle:!1,weight:o.TextWeight.Default,wrap:!0},spacing:10}})}}]);
//# sourceMappingURL=owa.124.js.map
self.scriptsLoaded['owa.124.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.124.js'] = (new Date()).getTime();