self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.748.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[748,2148],{11107:function(t){t.exports=JSON.parse('{"a":"hbb"}')},1427:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return o})),n.d(e,"e",(function(){return a})),n.d(e,"d",(function(){return c}));const r="FileAttachment:#Exchange",i="ItemAttachment:#Exchange",o="ItemIdAttachment:#Exchange",a="ReferenceAttachment:#Exchange",c="LinkAttachment:#Exchange"},180:function(t,e,n){"use strict";var r=n(22);let i;function o(){return null==i&&(i="undefined"!=typeof window&&null!=window.performance&&null!=window.performance.timing&&null!=window.performance.navigation&&null!=window.performance.getEntriesByName),i}const a=500,c=[],u=[],s=[],l=[];let f,d=!0;function m(t,e){Object(r.g)((t,e,n)=>{d&&(e==r.b.Error&&u.push({message:t,error:n}),c.push({message:t,level:e}))}),t(b),e(b),o()&&(window.performance.setResourceTimingBufferSize?window.performance.setResourceTimingBufferSize(a):window.performance.webkitSetResourceTimingBufferSize&&window.performance.webkitSetResourceTimingBufferSize(a))}function p(t,e,n){f?f(t,e,n):l.push({name:t,customData:e})}function h(t){return f=t,d=!1,{traces:c,errors:u,network:s,usage:l}}function b(){d&&s.push(arguments)}n.d(e,"a",(function(){return m})),n.d(e,"b",(function(){return h})),n.d(e,"d",(function(){return p})),n.d(e,"c",(function(){return o}))},181:function(t,e,n){"use strict";function r(){var t=Object.create(null),e=0,n=0,r=0,i=!1;function o(e){r--,delete t[e]}this.put=function(e,n,i,a){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==a&&"function"!=typeof a)throw new Error("Cache timeout callback must be a function");var c=t[e];c?clearTimeout(c.timeout):r++;var u={value:n,expire:i+Date.now()};return isNaN(u.expire)||(u.timeout=setTimeout(function(){o(e),a&&a(e,n)}.bind(this),i)),t[e]=u,n},this.del=function(e){var n=!0,r=t[e];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&o(e),n},this.clear=function(){for(var o in t)clearTimeout(t[o].timeout);r=0,t=Object.create(null),i&&(e=0,n=0)},this.get=function(o){var a=t[o];if(void 0!==a){if(isNaN(a.expire)||a.expire>=Date.now())return i&&e++,a.value;i&&n++,r--,delete t[o]}else i&&n++;return null},this.size=function(){return r},this.memsize=function(){var e,n=0;for(e in t)n++;return n},this.debug=function(t){i=t},this.hits=function(){return e},this.misses=function(){return n},this.keys=function(){return Object.keys(t)},this.exportJson=function(){var e={};for(var n in t){var r=t[n];e[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(e)},this.importJson=function(e,n){var r=JSON.parse(e),i=Date.now(),o=n&&n.skipDuplicates;for(var a in r)if(r.hasOwnProperty(a)){if(o)if(t[a])continue;var c=r[a],u=c.expire-i;if(u<=0){this.del(a);continue}u=u>0?u:void 0,this.put(a,c.value,u)}return this.size()}}t.exports=new r,t.exports.Cache=r},211:function(t,e,n){"use strict";var r=n(930);n.d(e,"a",(function(){return r.a}))},242:function(t,e,n){"use strict";function r(t){return null==t||0==t.trim().length}n.d(e,"a",(function(){return r}))},244:function(t,e,n){"use strict";e.decode=e.parse=n(492),e.encode=e.stringify=n(493)},2746:function(t,e,n){"use strict";function r(t){if(!t)return null;const e=t.lastIndexOf(".");return e>0?t.substr(e).toLowerCase():null}function i(t){const e=r(t);return e?e.replace(".",""):null}function o(t){var e;return(null===(e=i(t))||void 0===e?void 0:e.substring(0,4))||""}n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return o}))},2748:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.Base64InlineImage=0]="Base64InlineImage",t[t.Cloud=1]="Cloud",t[t.Local=2]="Local",t[t.MailItem=3]="MailItem",t[t.Uri=4]="Uri",t[t.AttachmentItem=5]="AttachmentItem",t[t.CloudSuggestion=6]="CloudSuggestion",t[t.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",t[t.Inline=8]="Inline",t[t.Smime=9]="Smime",t[t.FilesHub=10]="FilesHub",t[t.GroupFilesHub=11]="GroupFilesHub",t[t.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",t[t.Unknown=13]="Unknown",t[t.ContextualSuggestion=14]="ContextualSuggestion",t[t.ConsumerGroupFilesHub=15]="ConsumerGroupFilesHub",t[t.SmartDoc=16]="SmartDoc",t[t.ExpirableBase64InlineImage=17]="ExpirableBase64InlineImage"}(r||(r={}))},2767:function(t,e,n){"use strict";var r=n(2746),i=n(2941),o=n(6);function a(t){let e;return t>=1073741824?(t/=1073741824,e=Object(o.b)(i.b)):t>=1048576?(t/=1048576,e=Object(o.b)(i.d)):t>=1024?(t/=1024,e=Object(o.b)(i.c)):e=Object(o.b)(i.a),Object(o.c)(e,Math.round(t))}var c=n(2822),u=n(25);const s=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function l(t){if(!Object(u.k)("doc-attachment-documentThumbnail"))return!1;const e=Object(r.a)(t);return!!e&&s.indexOf(e.toLowerCase())>=0}var f;function d(t){switch(t){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return f.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return f.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return f.PowerPoint;default:return null}}!function(t){t[t.Word=0]="Word",t[t.Excel=1]="Excel",t[t.PowerPoint=2]="PowerPoint"}(f||(f={}));var m=n(2786);n.d(e,"b",(function(){return r.a})),n.d(e,"c",(function(){return r.b})),n.d(e,"d",(function(){return r.c})),n.d(e,"i",(function(){return a})),n.d(e,"g",(function(){return c.a})),n.d(e,"h",(function(){return l})),n.d(e,"f",(function(){return d})),n.d(e,"e",(function(){return m.b})),n.d(e,"a",(function(){return f}))},2773:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(360);function i(t){var e;return null===(e=Object(r.a)(t))||void 0===e?void 0:e.AttachmentPolicy}},2778:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(2961);function i(t){if(!t)return null;return Object(r.a)().attachments.get(t.Id)}},2786:function(t,e,n){"use strict";function r(t){return function(t){const e=o.exec(t);return e&&e.length>1&&i[e[1].toLowerCase()]}(t||"")}n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return a}));const i={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},o=/^\s*([^;\s]*)(?:;|\s|$)/;function a(t){let e="";return Object.entries(i).forEach(n=>{n[1]===t&&(e=n[0])}),e}},2822:function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return s}));var r=n(2746),i=n(2786),o=n(100);const a=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],c=[".tiff",".tif"];function u(t,e,n=!0){return s(Object(r.a)(t)||Object(i.a)(e),n)}function s(t,e=!0){return!!t&&(a.indexOf(t.toLowerCase())>=0||e&&c.indexOf(t.toLowerCase())>=0&&(Object(o.e)()||Object(o.d)()||Object(o.i)()||Object(o.g)()&&!Object(o.m)()))}},2826:function(t,e,n){"use strict";const r=new RegExp("^data:(image\\/\\w+);base64,([A-Za-z0-9+/=]+?)$","i");function i(t){let e=null;const n=r.exec(t);if(n){const t=n[1],r=n[2];let i=null;try{i=atob(r)}catch(t){}if(i){const n=new ArrayBuffer(i.length),r=new Uint8Array(n);for(let t=0;t<i.length;t++)r[t]=i.charCodeAt(t);e=new File([n],"image.png",{type:t})}}return e}var o=n(2748),a=n(2767);function c(t){return t.map(t=>({fileType:o.a.Uri,name:t.name,type:Object(a.b)(t.url)||"",size:0,uri:t.url}))}var u=n(22);function s(t,e,n){if(t.length!=e.length)return u.d("The sizes of subjects and latestItemIds are different"),null;const r=[];for(let i=0;i<t.length;i++){const a={fileType:o.a.MailItem,name:t[i],size:(null==n?void 0:n[i])||0,itemId:e[i]};r.push(a)}return r}function l(t,e,n){const r=[],i={fileType:o.a.MailItem,name:t,size:n||0,mimeContent:e};return r.push(i),r}function f(t){if(!t)return null;let e=[];for(var n=0;n<t.length;n++){const r=t[n],i={fileType:o.a.Local,name:r.name,size:r.size,type:r.type,fileObject:r};e.push(i)}return e}function d(t){if(!t)return null;const e=[];for(let n=0;n<t.length;n++){const r=t[n],i={fileType:r.fileType,name:r.name,size:r.size,type:r.type,dataUri:r.dataUri};e.push(i)}return e}function m(t){var e,n;if(null===t)return null;return{fileType:o.a.Cloud,name:t.Name,size:t.Size,providerId:t.AttachmentProviderId,providerType:t.ProviderType,location:t.Location,providerEndpointUrl:t.ProviderEndpointUrl,isFolder:1===t.Type,fileId:t.Id,fileParentId:t.ParentId,thumbnailUrl:(null===(e=t.Thumbnail)||void 0===e?void 0:e.Url)||"",previewUrl:(null===(n=t.Preview)||void 0===n?void 0:n.Url)||"",type:t.MimeType}}function p(t){if(null===t)return null;return{attachmentItemId:t.Id,name:t.Name,size:t.Size,fileType:o.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}var h=n(2893);function b(t){switch(t?t.toLowerCase():null){case h.d.ONE_DRIVE_PRO.toLowerCase():return 0;case h.d.GDRIVE.toLowerCase():return 5;case h.d.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case h.d.DROPBOX.toLowerCase():return 2;case h.d.BOX.toLowerCase():return 3;case h.d.WOPI_BOX.toLowerCase():return 7;case h.d.WOPI_EGNYTE.toLowerCase():return 8;case h.d.MAILBOX.toLowerCase():return 4;case h.d.FACEBOOK.toLowerCase():return 6;default:return null}}n.d(e,"f",(function(){return i})),n.d(e,"j",(function(){return c})),n.d(e,"i",(function(){return s})),n.d(e,"h",(function(){return l})),n.d(e,"g",(function(){return f})),n.d(e,"d",(function(){return d})),n.d(e,"e",(function(){return m})),n.d(e,"c",(function(){return p})),n.d(e,"b",(function(){return b})),n.d(e,"a",(function(){return o.a}))},2852:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(1427);function i(t){return(t.__type||t.OwsTypeName)===r.e}},2871:function(t,e,n){"use strict";var r=n(3278),i=n(358);const o=Object(i.action)("addInfoBarMessage")((function(t,e,n){if(t){-1==t.infoBarIds.indexOf(e)?t.infoBarIds.push(e):t.infoBarIds=[...t.infoBarIds];const i=t.infoBarHostKey;n&&(r.b[i]||(r.b[i]={}),r.b[i][e]=n)}}));e.a=o},2884:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(3278),i=n(2);const o=Object(i.mutatorAction)("removeInfoBarMessages",(t,e,n)=>{e>=0&&t.infoBarIds.splice(e,1);const i=t.infoBarHostKey;r.b[i]&&(delete r.b[i][n],0===Object.keys(r.b[i]).length&&delete r.b[i])});function a(t,e){if(t){const n=Array.isArray(e)?e:e?[e]:t.infoBarIds?[...t.infoBarIds]:[];for(const e of n){const n=t.infoBarIds&&t.infoBarIds.indexOf(e);o(t,n,e)}}}},2893:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return o})),n.d(e,"e",(function(){return a})),n.d(e,"f",(function(){return c})),n.d(e,"g",(function(){return u})),n.d(e,"h",(function(){return s})),n.d(e,"i",(function(){return l})),n.d(e,"j",(function(){return f})),n.d(e,"k",(function(){return d})),n.d(e,"l",(function(){return m})),n.d(e,"d",(function(){return p}));const r="Box",i="Dropbox",o="Facebook",a="GDrive",c="Mailbox",u="MailMessage",s="OneDriveConsumer",l="OneDrivePro",f="WopiBox",d="WopiDropbox",m="WopiEgnyte",p={BOX:r,DROPBOX:i,FACEBOOK:o,GDRIVE:a,MAILBOX:c,ONE_DRIVE_CONSUMER:s,ONE_DRIVE_PRO:l,RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:f,WOPI_EGNYTE:m}},2941:function(t){t.exports=JSON.parse('{"b":"uia","d":"via","c":"wia","a":"xia"}')},316:function(t,e,n){"use strict";n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return u}));var r=n(124),i=n(117),o=n(3);let a;function c(t){a=t}async function u(){var t,e;if(Object(o.P)())return i.f.importAndExecute(Object(r.a)());const n=a&&await a();if(n&&n.length>0){if("bearer"===(null===(t=null==n?void 0:n.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return n.split(" ")[1];if("msauth1.0"===(null===(e=null==n?void 0:n.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return n}}},3278:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i}));const r={};function i(t,e){var n;const i=t.infoBarHostKey;return null===(n=r[i])||void 0===n?void 0:n[e]}},3881:function(t,e,n){"use strict";n.r(e);var r=n(2881),i=n(2);function o(t,e){const n=t.indexOf(e);-1!==n&&t.splice(n,1)}function a(t,e){e&&!t.includes(e)&&t.push(e)}Object(i.mutator)(r.d,t=>{a(t.sharingLinkIds,t.linkId)}),Object(i.mutator)(r.T,t=>{o(t.sharingLinkIds,t.linkId)}),Object(i.mutator)(r.e,t=>{a(t.linkIdContainer,t.linkId)}),Object(i.mutator)(r.R,t=>{o(t.linkIdContainer,t.linkId)});var c=n(6285);Object(i.mutator)(c.a,t=>{const{attachmentWell:e,message:n}=t;e.announcedComponentMessage=n});const u=Object(i.action)("addInlineAttachment",(t,e)=>({attachmentWell:t,inlineAttachment:e}));Object(i.mutator)(u,t=>{const{attachmentWell:e,inlineAttachment:n}=t;e.inlineAttachments.push(n)});var s=n(11107),l=n(6);const f=Object(i.action)("REFRESH_SHARING_TIPS_ATTACHMENT_WELL",(t,e,n,r,i)=>({attachmentWellViewState:t,parentItemId:e,recipientInfo:n,infoBarIds:r,infoBar:i}));var d=n(4783),m=n(5097),p=n(2778);function h(t){const e=t.docViewAttachments.concat(t.imageViewAttachments);return(n=e,n.filter(t=>t.isCloudy).map(t=>(function(t,e){if(1!==t.type)return null;const n=t.model;return{id:t.id,name:n.Name,supportsDownsell:e,currentPermissionLevel:n.PermissionType,sharingInfo:t.info.sharingInfo,sharingRecipientsInfo:{recipientPermissionInfos:[]},sharingTipsIgnored:[],typeOfLink:"referenceAttachment"}})(Object(p.a)(t.attachmentId),t.strategy.isConvertCloudyToClassicSupported))).filter(t=>{var e;return null===(e=t.sharingInfo)||void 0===e?void 0:e.getSharingInfoSucceeded});var n}var b=n(68),g=n(2871),I=n(2884),O=n(2973),v=n(3164);function w(t,e,n,r){return A(t,h(e),n,[],null,r,!0,null)}function A(t,e,n,r,i,o,a,c){let u;for(let s=0;s<t.length;s++){const l=j(t[s],e,n,r,i,o,a,c);l&&(u=l)}if("function"==typeof u){const t=u(null);if((null==t?void 0:t.messageParts)&&t.messageParts.length>0&&"string"==typeof t.messageParts[0])return t.messageParts[0]}else if("object"==typeof u&&u.length>0)return u[0];return null}function j(t,e,n,r,i,o,a,c){const u=o(e,t,n,a,c);return Object(I.a)(i,[t]),u&&(Object(g.a)(i,t,u),r.push(t)),u}Object(i.orchestrator)(f,async t=>{const{attachmentWellViewState:e,parentItemId:n,recipientInfo:r,infoBarIds:i,infoBar:o}=t,a=h(e),c=new b.b("AttachmentRefreshSharingTips"),u=[];A(Object(v.d)(),a,r,u,o,await v.f.import(),!1,t=>{const r=Object(d.a)(e,t);if(r){const t=Object(p.a)(r.attachmentId);return{text:Object(l.b)(s.a),action:()=>{const i=t.model;Object(b.p)("SharingTipsConvertToClassic"),Object(O.f)(r,n.Id,i.AttachLongPathName,i.PermissionType,(t,n,r,i)=>{Object(m.a)(e,t,n,r,i)},1)}}}return null}),function(t,e){const n=Object(v.d)(),r=t.filter(t=>-1!==n.indexOf(t)),i=e.filter(t=>-1===r.indexOf(t)),o=r.filter(t=>-1===e.indexOf(t));0!==i.length&&Object(b.p)("AttachmentSharingTipAdded",i);0!==o.length&&Object(b.p)("AttachmentSharingTipsRemoved",o)}(i,u),Promise.resolve().then(()=>c.end())});Object(i.orchestrator)(c.a,t=>{const{attachmentWell:e,message:n}=t;null!==n&&setTimeout(()=>{Object(c.a)(e,null)},2e3)});var y=n(7334),C=n(3126),x=n(3098);var S=n(4632),T=n(4026),E=n(2852),R=n(4305);const M=Object(i.mutatorAction)("storeAndInitializeAttachment",(t,e,n)=>{const r=!!e.parentItemIdMap;t.IsInline&&!Object(E.a)(t)&&t.ContentId&&""!=t.ContentId&&"unknown"!=t.ContentId.toLowerCase()?e.inlineAttachments.push(Object(O.i)(t.AttachmentId,t.AttachmentId.Id,!0,4)):Object(S.a)(t)&&!r?e.imageViewAttachments.push(n):e.docViewAttachments.push(n)});var P=Object(b.s)({name:"AttachmentWellInitialization",customData:(t,e,n,r,i,o,a,c,u,s)=>({hasAttachments:t&&t.length>0,isCompose:i}),options:{sessionSampleRate:1}},(function(t,e,n,r,i,o,a,c,u,s){if(!t)return;const l=function(t){return t?Object(O.o)().filter(e=>!t.includes(e)):null}(o);n.isInitialized||t.forEach(t=>{!function(t,e,n,r,i,o,a,c){if("application/x-sharing-metadata-xml"===t.ContentType)return;if(a&&Object(T.a)(t))return;const u=Object(O.h)(Object.assign(Object.assign({},t.AttachmentId),{mailboxInfo:e}),t,n.isReadOnly,!0,r,a,c,null,i,!0);if(M(t,n,u),u.isCloudy){const t=Object(p.a)(u.attachmentId);t.requiresFetchingSharingInformation&&o&&Object(O.m)(t)}else Object(R.a)(n,t.Size)}(t,e,n,r,l,a,u,s)}),B(n,c,l)}));const B=Object(i.mutatorAction)("initializeAttachments",(t,e,n)=>{e&&t.docViewAttachments.forEach(t=>{(function(t){const e=Object(p.a)(t);if(null==e?void 0:e.model){return"IPM.Appointment"===e.model.EmbeddedItemClass}return!1})(t.attachmentId)&&function(t){t.previewMethod=x.a.Unsupported,t.supportedOpenActions=t.supportedOpenActions.filter(t=>t!==C.a.Preview)}(t.strategy)}),t.supportedMenuActions=n,t.isInitialized=!0});var N=n(358),z=Object(N.action)("reinitializeAttachments")((function(t,e,n,r,i,o,a,c,u){t&&(n.docViewAttachments=[],n.imageViewAttachments=[],n.inlineAttachments=[],n.isInitialized=!1,P(t,e,n,r,!1,i,o,a,c,u))})),L=n(4924);function V(t,e){const n=Object(L.a)(!1,void 0===e,t);if(e){const{attachments:t,mailboxInfo:r,parentItemId:i}=e;P(t,r,n,!0,!0,null,i)}return n}var W=n(4586);function k(t,e){const n=Object(L.a)(!0,!1,"");return Object.assign(Object.assign({},n),{parentItemIdMap:t,itemReceivedTimeMap:e,isVisible:!1,maxHeight:0})}var D=n(4743),U=n(3106),F=n(3548);var _=(t,e,n,r)=>{if(t){const{docViewAttachments:i,imageViewAttachments:o,inlineAttachments:a}=t,c=[...i,...o,...a.filter(t=>{const r=Object(p.a)(t.attachmentId);if((null==r?void 0:r.model)&&"HTML"===n){const t=e;return t&&!Object(F.l)(t,r.model)}return!1})];return r?c.filter(t=>Object(U.b)(t.attachmentId.Id)):c.filter(t=>!Object(U.b)(t.attachmentId.Id))}return[]},H=n(4910),G=n(4306),K=n(4405),X=n(6840),J=n(2826),$=n(2905);async function Q(t,e,n,r,i,o){const a=await $.c.import(),c=n.filter(t=>!function(t){return!Object(E.a)(t)&&t.IsInline}(t)).map(a),u=c.filter(t=>t.fileType===J.a.Cloud),s=c.filter(t=>t.fileType===J.a.AttachmentItem);s.length>0&&Y(e,t,s,r,!1,!1,i,o),u.length>0&&Y(e,t,u,r,!1,!0,i,o)}function Y(t,e,n,r,i,o,a,c){const u={isInline:i,isHiddenInline:!1},s=o?Object.assign(Object.assign({},u),{shouldShare:!0}):Object.assign(Object.assign({},u),{shouldShare:!1});$.f.import().then(i=>{i(t,e,n,r,s,null,a,c)})}var q=n(6765),Z=Object(i.mutatorAction)("mergeToConversationAttachmentWell",(function(t,e,n,r){t&&(t.docViewAttachments.forEach(t=>{tt(t,e,n,r)}),t.imageViewAttachments.forEach(t=>{tt(t,e,n,r)}))}));function tt(t,e,n,r){e.parentItemIdMap[t.attachmentId.Id]||(e.docViewAttachments.push(Object.assign({},t)),e.parentItemIdMap[t.attachmentId.Id]=n,e.itemReceivedTimeMap[t.attachmentId.Id]=r)}var et=Object(i.mutatorAction)("sortConversationAttachmentWell",(function(t,e){t.docViewAttachments=t.docViewAttachments.sort((n,r)=>(e?1:-1)*(new Date(t.itemReceivedTimeMap[n.attachmentId.Id]).getTime()-new Date(t.itemReceivedTimeMap[r.attachmentId.Id]).getTime()))})),nt=n(3403),rt=n(2851),it=n(5918),ot=n(3940);function at(t,e,n){if(Object(p.a)(e.attachmentId)&&t.imageViewAttachments.indexOf(e)>=0){Object(ot.a)(t,e,!1,!1),Object(rt.o)(e.attachmentId,n),Object(rt.p)(e.attachmentId,!0);const r=Object(nt.b)(e.attachmentId,1);Object(it.a)(e.attachmentId,r);const i=Object(O.i)(e.attachmentId,e.attachmentId.Id,!1);i.status=3,u(t,i)}}var ct=n(7335);n.d(e,"refreshSharingTipsAttachmentWell",(function(){return f})),n.d(e,"addAttachmentIntoWellBeforeUpload",(function(){return y.a})),n.d(e,"initializeAttachments",(function(){return P})),n.d(e,"reinitializeAttachments",(function(){return z})),n.d(e,"getAttachmentWellForCompose",(function(){return V})),n.d(e,"getAttachmentWellInitialValue",(function(){return L.a})),n.d(e,"getAvailableLocalAttachmentSize",(function(){return W.a})),n.d(e,"getConversationAttachmentWellInitialValue",(function(){return k})),n.d(e,"getMaxClassicAttachmentsSize",(function(){return D.a})),n.d(e,"getAllValidAttachments",(function(){return _})),n.d(e,"createAttachmentFullViewStateAndStoreBackingModel",(function(){return H.a})),n.d(e,"setInlineAttachmentStatus",(function(){return G.a})),n.d(e,"createAttachmentFullViewState",(function(){return K.a})),n.d(e,"createAttachmentsViaQueueManager",(function(){return X.a})),n.d(e,"deleteAttachmentViaQueueManager",(function(){return X.b})),n.d(e,"createAttachmentsFromRecentAttachments",(function(){return Q})),n.d(e,"createAttachmentFileFromExistingMailboxAttachment",(function(){return q.a})),n.d(e,"mergeToConversationAttachmentWell",(function(){return Z})),n.d(e,"sortConversationAttachmentWell",(function(){return et})),n.d(e,"convertImageViewAttachmentToInlineAttachment",(function(){return at})),n.d(e,"getLastCloudyAttachmentsSharingIssueForBlockOnSend",(function(){return w})),n.d(e,"uploadLocalFile",(function(){return ct.a}))},391:function(t,e,n){"use strict";function r(t,e){return t?Object.assign({mailboxInfo:t},e):null!=e?e:void 0}n.d(e,"a",(function(){return r}))},4026:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(2904);const i=(t,e)=>t.substring(0,e.length)===e,o=(t,e)=>t.substring(t.length-e.length)===e,a=t=>t.ContentType&&(i(t.ContentType,r.v)||i(t.ContentType,r.l)),c=t=>t.ContentType&&t.ContentType===r.j;function u(t){return(null==t?void 0:t.Name)&&o(t.Name,r.t)&&(a(t)||c(t))}},403:function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},4743:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(3814),i=n(13),o=n(30);const a=25*r.b;function c(){return u.get()}const u=Object(i.computed)(()=>{const t=Object(o.a)();return t&&t.SessionSettings?(t.SessionSettings.MaxMessageSizeInKb-2048)*r.a:a})},4783:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(168);function i(t,e){let n=t.docViewAttachments.filter(t=>Object(r.e)(t.attachmentId,e));return 0===n.length&&(n=t.imageViewAttachments.filter(t=>Object(r.e)(t.attachmentId,e))),0===n.length?null:n[0]}},492:function(t,e,n){"use strict";function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,n,o){e=e||"&",n=n||"=";var a={};if("string"!=typeof t||0===t.length)return a;var c=/\+/g;t=t.split(e);var u=1e3;o&&"number"==typeof o.maxKeys&&(u=o.maxKeys);var s=t.length;u>0&&s>u&&(s=u);for(var l=0;l<s;++l){var f,d,m,p,h=t[l].replace(c,"%20"),b=h.indexOf(n);b>=0?(f=h.substr(0,b),d=h.substr(b+1)):(f=h,d=""),m=decodeURIComponent(f),p=decodeURIComponent(d),r(a,m)?i(a[m])?a[m].push(p):a[m]=[a[m],p]:a[m]=p}return a};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},4924:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(4743);let i;function o(t,e,n){return i||(i=Object(r.a)()),{composeId:n,allowShowMultipleRows:!t,didViewOverflowOneRow:!1,canOverrideAllowShowMultipleRows:!0,docViewAttachments:[],imageViewAttachments:[],inlineAttachments:[],isInitialized:e,isReadOnly:t,groupId:null,maxTotalClassicAttachmentSize:i,totalClassicAttachmentSize:0,saveAllToCloudStatus:0,supportedMenuActions:null,sharingLinkIds:[],announcedComponentMessage:null}}},493:function(t,e,n){"use strict";var r=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,n,c){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?o(a(t),(function(a){var c=encodeURIComponent(r(a))+n;return i(t[a])?o(t[a],(function(t){return c+encodeURIComponent(r(t))})).join(e):c+encodeURIComponent(r(t[a]))})).join(e):c?encodeURIComponent(r(c))+n+encodeURIComponent(r(t)):""};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function o(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var a=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}},930:function(t,e,n){"use strict";function r(t){return t>=200&&t<300}n.d(e,"a",(function(){return r}))},937:function(t,e,n){"use strict";var r=n(20);var i={ChannelData:"ChannelData",SubscriptionAdded:"SubscriptionAdded",SubscriptionRemoved:"SubscriptionRemoved",SubscriptionUpdated:"SubscriptionUpdated",NotificationData:"NotificationData",TraceWarn:"TraceWarn",TraceError:"TraceError"};n.d(e,"j",(function(){return a})),n.d(e,"k",(function(){return c})),n.d(e,"b",(function(){return u})),n.d(e,"c",(function(){return s})),n.d(e,"g",(function(){return l})),n.d(e,"h",(function(){return f})),n.d(e,"e",(function(){return d})),n.d(e,"i",(function(){return m})),n.d(e,"f",(function(){return p})),n.d(e,"d",(function(){return h})),n.d(e,"a",(function(){return i}));const o=new r.c(()=>Promise.all([n.e(0),n.e(707)]).then(n.bind(null,19753))),a=new r.a(o,t=>t.subscribe),c=new r.a(o,t=>t.unsubscribe),u=new r.b(o,t=>t.getChannelId),s=new r.a(o,t=>t.getChannelReady),l=new r.a(o,t=>t.retryDisconnectionWithMinimumReconnectInterval),f=new r.a(o,t=>t.setup),d=new r.a(o,t=>t.handleNotification),m=new r.a(o,t=>t.stopConnection),p=new r.a(o,t=>t.initializeNotificationManager),h=new r.b(o,t=>t.getNotificationEmitter)}}]);
//# sourceMappingURL=owa.748.js.map
self.scriptsLoaded['owa.748.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.748.js'] = (new Date()).getTime();