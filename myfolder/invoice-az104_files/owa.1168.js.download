self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.1168.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[1168],{11757:function(e,t,n){"use strict";n.r(t);var i=n(3957);const o="resources/scripts/osefo.js",a="RXOWA",s={bottom:"0",left:"0",height:"100%",width:"100%",position:"absolute"},r="https://concierge.live.com",d="OsefoLoadWidget",c="OsefoDismissWidget",u="TicketCreated",p="N/A",l="MiniMavenDataPoint",m=3e4,g="Owa Mail",S="https://api.diagnostics.office.com/v1/diagnosticsession",f="OWAHelpshift",b=1048576;var v=n(30),O=n(220),I=n(6),w=n(3),T=n(52);function h(){let e,t,n=Object(v.a)();if(window.performance){let n=new Date;n.setTime(window.performance.timing.fetchStart),e=String(n),t=String(((new Date).getTime()-window.performance.timing.fetchStart)/6e4)}let i=p,o=p,a=p,s=p,r=p,d={},c={},u=window.performance.memory;return u&&(i=String(u.jsHeapSizeLimit/b|0),o=String(u.totalJSHeapSize/b|0),a=String(u.usedJSHeapSize/b|0),s=String(u.usedJSHeapSize/u.jsHeapSizeLimit),r=String(u.usedJSHeapSize%1e3!=0)),d.IsFocusedInboxEnabled=String(n.UserOptions.IsFocusedInboxEnabled),d.IsFocusedInboxCapable=String(n.UserOptions.IsFocusedInboxCapable),d.FocusedInboxServerOverride=String(n.UserOptions.FocusedInboxServerOverride),d.IsFocusedInboxOnAdminLastUpdateTime=n.UserOptions.IsFocusedInboxOnAdminLastUpdateTime,d.IsFocusedInboxOnLastUpdateTime=n.UserOptions.IsFocusedInboxOnLastUpdateTime,c.Name=n.SessionSettings.UserDisplayName,c.Country=n.UserOptions.TimeZone,c["Premium Consumer"]=String(Object(T.t)()),c["Memory usage ratio [0,1]"]=String(s),c["Memory.IsHighPrecision"]=r,c["Memory.JSHeapSizeLimit (MB)"]=i,c["Memory.TotalJSHeapSize (MB)"]=o,c["Memory.UsedJSHeapSize (MB)"]=a,c.Platform=window.navigator.platform,c["Browser language"]=window.navigator.language,c["Cookie enabled"]=String(window.navigator.cookieEnabled),c["User agent"]=window.navigator.userAgent,c["Document.Cookie"]=document.cookie,c["Mailbox culture"]=Object(I.e)(),c["OWA layout"]=Object(w.m)(),c["OWA UTC Start Time"]=e,c["Session length"]=t,c["Focused Inbox settings"]=JSON.stringify(d),c.Versioning=Object(w.u)(),c.Ring=Object(w.D)(),c.UserType=Object(O.a)()?"Consumer":"Business",JSON.stringify(c)}var D=n(22),j=n(6e3);function k(e){let t=[e.sessionId,e.eventId,e.loadTime,e.eventData,e.isDeeplinkScenario],n={Id:l,Consumers:1,Time:new Date(Date.now()).toString(),Keys:["mmsid","mmeid","mmlt","mmed","mmidl"],Values:t};return Object(j.a)({datapoints:[n]})}var y=n(151);var x=n(211);function M(e,t){let n=e.split("-");if(n.length>1){let e=Object(v.a)();(function(e){let t=new Headers;t.append("Content-Type","application/json"),t.append("Accept","text/plain"),t.append("X-MS-SARA-API-Version","schema-v1"),t.append("Host","api.diagnostics.office.com"),t.append("SaraSessionId",e.SessionId);let n={method:"POST",credentials:"same-origin"};return n.body=JSON.stringify(e),n.headers=t,fetch(S,n)})({TenantId:e.SessionSettings.TenantGuid,TicketId:n[1],TicketTier:f,UserPuid:e.SessionSettings.UserPuid,SessionId:t}).then(e=>{if(!Object(x.a)(e.status)){let t=`POST request to ${S} failed, http error:${e.status}`;throw new Error(t)}e.json().then(e=>{y.b.info(Object(I.c)("ODS SessionId {0} TicketId {1}",e.DiagnosticSessionId,e.TicketId))})}).catch(i=>{const o={Error:i.message,TenantId:e.SessionSettings.TenantGuid,TicketId:n[1],UserPuid:e.SessionSettings.UserPuid};k({sessionId:t,eventId:"ODSFailEvent",eventData:JSON.stringify(o),loadTime:"",isDeeplinkScenario:""})})}}var U=n(159);const H="InvokeFeedback",C="RequestMetadata";function A(e){let t=Object(T.r)()?"https://support.office.live.com":"https://support.office.com";if(e.origin==t)if(D.h.info("Soc post message event: "+e.data),e.data==H)i.d.importAndExecute();else if(e.data==C){let n=h();e.source.postMessage(n,t)}else"string"==typeof e.data&&e.data.indexOf(u)>-1&&M(e.data,Object(U.a)())}var F=n(14249),z=n(116),E=n(279),L=n(25);let P,J,W,N,B,$;function R(e,t){if(e){P=t,B=e,J=Object(U.a)(),$=document.createElement("script"),$.src=Object(E.b)(o);let n=!!Object(L.k)("help-disableTicketFlow"),i=h();$.onload=function(){var t={sessionId:J,appId:a,locale:Object(I.e)(),hideHeader:!0,disableTicketFlow:n,theme:_(),metadata:i},o={hostingDiv:e,baseUrl:r,clientContext:t,widgetStyle:s,widgetEventListenerCallback:V};N=window.setTimeout(q,m),k({sessionId:J,eventId:"LaunchWidget",eventData:g,loadTime:"",isDeeplinkScenario:""}),W=(new Date).getTime(),window.Osefo.CreateWidget(o)},document.head.appendChild($)}}function _(){let{themePrimary:e,themeDark:t}=Object(z.i)();return{button:{bgColor:{onActive:e,onHover:t},borderColor:{onActive:e,onHover:t}},link:{color:{onActive:e,onHover:t}}}}function V(e){e==c?(k({sessionId:J,eventId:"OnWidgetDismissEvent",eventData:g,loadTime:"",isDeeplinkScenario:""}),P()):e==d?(window.clearTimeout(N),k({sessionId:J,eventId:"OnWidgetLoadEvent",eventData:g,loadTime:String((new Date).getTime()-W),isDeeplinkScenario:""})):e.indexOf(u)>-1&&M(e,J)}function q(){B.innerText=Object(I.b)(F.a),k({sessionId:J,eventId:"OnWidgetLoadFailEvent",eventData:g,loadTime:String((new Date).getTime()-W),isDeeplinkScenario:""})}n.d(t,"handleSocPostMessageEvents",(function(){return A})),n.d(t,"loadMiniMavenHelpWidget",(function(){return R}))},14249:function(e){e.exports=JSON.parse('{"a":"uab"}')},159:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));const i=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function o(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function a(){return o()+o()+"-"+o()+"-"+o()+"-"+o()+"-"+o()+o()+o()}function s(e){return i.test(e)}},211:function(e,t,n){"use strict";var i=n(930);n.d(t,"a",(function(){return i.a}))},6e3:function(e,t,n){"use strict";var i=n(35);function o(e,t){if(void 0!==e.datapoints)for(var n=0;n<e.datapoints.length;n++)void 0===e.datapoints[n]||e.datapoints[n].__type||(e.datapoints[n]=(o=e.datapoints[n],Object.assign({__type:"Datapoint:#Exchange"},o)));var o;return Object(i.a)("LogDatapoint",e,t)}n.d(t,"a",(function(){return o}))},930:function(e,t,n){"use strict";function i(e){return e>=200&&e<300}n.d(t,"a",(function(){return i}))}}]);
//# sourceMappingURL=owa.1168.js.map
self.scriptsLoaded['owa.1168.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.1168.js'] = (new Date()).getTime();