self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.2171.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[2171],{20004:function(e,t,a){"use strict";a.r(t);var r=a(2742),d=a(2),s=a(4511),o=a(7800),c=a(7327),i=a(7328),n=a(6311);const h=Object(d.action)("loadCardDetailsForItemAction",(e,t)=>({itemIdList:e,prefetchErrorLogger:t}));Object(d.orchestrator)(h,async e=>{var t;const{itemIdList:a,prefetchErrorLogger:d}=e;d.addTraceRoute(n.b.PrefetchStart);const h=[],u=await Object(o.a)(a,h),g=[];for(let e=0;e<a.length;e++){let s=r.u.items.get(a[e]);null!==(t=null==s?void 0:s.AdaptiveCardData)&&void 0!==t&&t.cardDetails?d.addTraceRoute(n.b.CardAblInStore):s?(d.addTraceRoute(n.b.AddingPrefetchCardToStore),g.push(s),Object(c.a)(s,u?u[e]:[],h)):(d.addErrorMessage(n.a.MailStoreNotFound),d.addTraceRoute(n.b.CannotAddCardData))}d.addErrorMessageList(h),a.length!==g.length&&d.addErrorMessage(n.a.ItemArrayLengthMismatch),u?(d.addTraceRouteList([n.b.PrefetchSuccess,n.b.GciUpdateFetchStatus]),Object(i.a)(g,s.c.Loaded)):(d.addErrorMessage(n.a.NoCardAfterFetch),d.addTraceRouteList([n.b.PrefetchFailed,n.b.PrefetchUpdFetchStatusNotLoaded]),Object(i.a)(g,s.c.NotLoaded)),d.addTraceRoute(n.b.PrefetchFinish)});var u=h,g=a(9606),l=a(3656),b=a(5924);var T=(e,t)=>{const a=Object(l.a)(e,null,b.d);return a?Object(g.a)(a,t):[]},f=a(9174),j=a(7872),L=a(7873),M=a(22),p=a(25);class I{constructor(){this._errorMessage=[],this._stackTrace=[],this._warningList=[]}addErrorMessage(e){this._errorMessage.push(e)}addWarningMessage(e){this._warningList.push(e)}addTraceRoute(e){this._stackTrace.push(e)}addErrorMessageList(e){for(const[t,a]of e)a?this.addErrorMessage(t):this.addWarningMessage(t)}addTraceRouteList(e){this._stackTrace.push(...e)}logErrorData(){const e=this._errorMessage.join(),t=this._stackTrace.join(),a=this._warningList.join();M.h.warn(a),M.h.warn(`${e}:${t}`),Object(p.k)("rp-actionableMessagesDebug")&&this._errorMessage.length>0&&Object(f.a)(j.a.PrefetchError,L.a.Critical,e,t)}}var R=e=>{var t,a;const d=new I;d.addTraceRoute(n.b.Start);let o=[],h=[];const g=[];for(const s of e){const e=T(s,g),i=r.u.items.get(null===(t=s.ItemId)||void 0===t?void 0:t.Id);(null==e?void 0:e.length)?(d.addTraceRoute(n.b.AddingGciPayload),Object(c.a)(s,e,g),h.push(s),i&&(d.addTraceRoute(n.b.AddGciPayloadToStore),Object(c.a)(i,e,g),h.push(i)),d.addTraceRoute(n.b.AddedGciPayload)):(null===(a=s.ItemId)||void 0===a?void 0:a.Id)&&o.push(s.ItemId.Id)}d.addErrorMessageList(g),h.length&&(d.addTraceRoute(n.b.GciUpdateFetchStatus),Object(i.a)(h,s.c.Loaded)),o.length&&u(o,d),d.addTraceRoute(n.b.Finish),d.logErrorData()};a.d(t,"prefetchActionableMessageForItems",(function(){return R}))}}]);
//# sourceMappingURL=owa.2171.js.map
self.scriptsLoaded['owa.2171.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.2171.js'] = (new Date()).getTime();