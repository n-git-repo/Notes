self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.256.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[256],{11108:function(t){t.exports=JSON.parse('{"a":"qbb"}')},11109:function(t){t.exports=JSON.parse('{"b":"jbb","d":"kbb","e":"lbb","c":"mbb","f":"nbb","a":"obb"}')},2735:function(t,e,n){"use strict";var a=n(2837),r=n(2807),i=n(2);const c=Object(i.action)("INITIALIZE_SCENARIO_STORE",(t,e)=>({scenarioId:t,isUsing3S:e}));Object(i.mutator)(c,t=>{const e=Object(a.a)(t.scenarioId);Object(r.b)().scenarioStores.get(e)||(Object(r.b)().scenarioStores.set(e,Object.assign({},Object(r.a)())),Object(r.b)().scenarioStores.get(e).isUsing3S=t.isUsing3S)});var o=n(2854),s=n(2953);n.d(e,"a",(function(){return o.b})),n.d(e,"b",(function(){return r.a})),n.d(e,"c",(function(){return a.a})),n.d(e,"e",(function(){return c})),n.d(e,"d",(function(){return s.a}))},2738:function(t,e,n){"use strict";var a=n(2);const r=Object(a.action)("ADD_SUGGESTION_PILL",(t,e,n)=>({suggestionPill:t,suggestionSelected:e,scenarioId:n})),i=Object(a.action)("ADD_SUGGESTION_PILL_INTERNAL",(t,e)=>({suggestionPill:t,scenarioId:e})),c=Object(a.action)("CHANGE_SELECTED_SUGGESTION_VIA_KEYBOARD",(t,e,n)=>({indexToSelect:t,suggestionToSelect:e,scenarioId:n}));var o=n(3035);const s=Object(a.action)("DOWNLOAD_FILE_SUGGESTION",(t,e,n)=>({attachmentId:t,attachmentType:e,scenarioId:n})),u=Object(a.action)("END_SEARCH_CONVERSATION",t=>({scenarioId:t}));var d=n(3036);const l=Object(a.action)("EXIT_SEARCH",(t,e,n=!1)=>({actionSource:t,scenarioId:e,forceExit:n})),f=Object(a.action)("GET_FILE_SUGGESTION_IMMERSIVE_VIEW",t=>({suggestion:t}));var m=n(2944),h=n(2735);const b=Object(a.mutatorAction)("OVERWRITE_EXISTING_SUGGESTION_PILL",(t,e,n)=>{const a=Object(h.d)(n),r=t.ReferenceId;a.suggestionPills.delete(e),a.suggestionPills.set(r,t);const i=a.suggestionPillIds.indexOf(e);a.suggestionPillIds[i]=r});var I=n(3037),p=n(3038);const O=Object(a.action)("ON_ENTER_PRESSED_SEARCH_INPUT",(t,e)=>({selectedSuggestionIndex:t,scenarioId:e})),g=Object(a.action)("ON_ESCAPE_PRESSED_SEARCH_INPUT",t=>({scenarioId:t})),S=Object(a.action)("ON_KEY_DOWN_SEARCH_INPUT",(t,e)=>({evtKeyCode:t,scenarioId:e}));var j=n(3039);const A=Object(a.action)("ON_RESIZE_SUGGESTIONSCALLOUT",(t,e)=>({searchBoxWidth:t,scenarioId:e})),C=Object(a.action)("ON_Right_ARROW_PRESSED_SEARCH_INPUT",t=>({scenarioId:t}));var v=n(66);const E=Object(a.action)("ON_SEARCH_INPUT_FOCUSED",t=>Object(v.b)({name:"ON_SEARCH_INPUT_FOCUSED"},{scenarioId:t}));var y=n(3058),T=n(3059);const w=Object(a.action)("onSearchScopeUiDismissed",t=>({searchScenarioType:t})),_=Object(a.action)("ON_SEARCH_TEXT_CHANGED",(t,e)=>({searchText:t,scenarioId:e})),k=Object(a.action)("ON_SUGGESTIONS_CALLOUT_POSITIONED",t=>({scenarioId:t})),N=Object(a.action)("ON_SUGGESTIONS_CALLOUT_WILL_UNMOUNT",t=>({scenarioId:t}));var P=n(3040);const R=Object(a.action)("REGISTER_ADDITIONAL_QUICK_ACTIONS",(t,e)=>({scenarioId:t,callback:e}));var F=n(3041);const L=Object(a.action)("REMOVE_SUGGESTION_PILL_FROM_STORE",(t,e,n)=>({suggestionPillId:t,suggestionPillIndex:e,scenarioId:n})),U=Object(a.action)("RESET_CURRENT_SUGGESTIONS",t=>({scenarioId:t}));var D=n(3021);const x=Object(a.action)("SEARCH_BOX_BLURRED",t=>({scenarioId:t})),M=Object(a.action)("SEARCH_SESSION_ENDED",(t,e,n,a)=>({searchSessionGuid:t,scenarioId:e,latestTraceId:n,actionSource:a}));var G=n(2915);const W=Object(a.action)("SET_CURRENT_SUGGESTIONS",(t,e,n=null)=>({suggestionSet:t,scenarioId:e,qfRequestId:n})),z=Object(a.action)("SET_DISPLAYED_QF_REQUEST_TIME",(t,e)=>({displayedQFRequestTime:t,scenarioId:e}));var B=n(3042);const H=Object(a.action)("SET_LATEST_TRACE_ID",(t,e,n)=>({latestTraceId:t,scenarioId:e,isQFTraceId:n})),V=Object(a.action)("SET_SEARCH_TEXT",(t,e)=>({searchText:t,scenarioId:e})),K=Object(a.action)("SET_SELECTED_PILL_INDEX",(t,e)=>({selectedPillIndex:t,scenarioId:e})),q=Object(a.action)("SET_SEARCH_TEXT_FOR_SUGGESTION",(t,e)=>({searchTextForSuggestion:t,scenarioId:e})),Q=Object(a.action)("SET_SELECTED_SUGGESTION_INDEX",(t,e)=>({selectedSuggestionIndex:t,scenarioId:e}));var $=n(3043);const J=Object(a.action)("SET_SUGGESTION_PILL_IDS",(t,e)=>({suggestionPillIds:t,scenarioId:e})),X=Object(a.action)("SET_SUGGESTION_PILLS",(t,e)=>({suggestionPills:t,scenarioId:e})),Y=Object(a.action)("SHARE_FILE_SUGGESTION",(t,e,n)=>({attachmentId:t,attachmentType:e,scenarioId:n}));var Z=n(2945);const tt=Object(a.action)("START_SEARCH_SESSION",(t,e,n)=>({actionSource:t,shouldStartSearch:e,scenarioId:n})),et=Object(a.action)("SUGGESTION_SECONDARY_ACTION_SELECTED",(t,e,n,a,r,i)=>({suggestion:t,suggestionIndex:e,actionSource:n,scenarioId:a,suggestionSetTraceId:r,entityActionTakenType:i})),nt=Object(a.action)("SUGGESTION_SELECTED",(t,e,n,a,r)=>({suggestion:t,actionSource:e,scenarioId:n,suggestionSetTraceId:a,index:r}));var at=n(3044);const rt=Object(a.action)("UPDATE_IS_SUGGESTION_SET_COMPLETE_INTERNAL",(t,e)=>({isComplete:t,scenarioId:e})),it=Object(a.action)("COMPLETE_GHOST_TEXT",(t,e)=>({scenarioId:t,evt:e}));var ct=n(2749);n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return c})),n.d(e,"d",(function(){return o.a})),n.d(e,"f",(function(){return s})),n.d(e,"g",(function(){return u})),n.d(e,"h",(function(){return d.a})),n.d(e,"i",(function(){return l})),n.d(e,"j",(function(){return f})),n.d(e,"k",(function(){return m.a})),n.d(e,"K",(function(){return b})),n.d(e,"u",(function(){return I.a})),n.d(e,"v",(function(){return p.a})),n.d(e,"w",(function(){return O})),n.d(e,"x",(function(){return g})),n.d(e,"y",(function(){return S})),n.d(e,"z",(function(){return j.a})),n.d(e,"A",(function(){return A})),n.d(e,"B",(function(){return C})),n.d(e,"C",(function(){return E})),n.d(e,"D",(function(){return y.a})),n.d(e,"E",(function(){return T.a})),n.d(e,"F",(function(){return w})),n.d(e,"G",(function(){return _})),n.d(e,"H",(function(){return k})),n.d(e,"I",(function(){return N})),n.d(e,"J",(function(){return P.a})),n.d(e,"L",(function(){return R})),n.d(e,"M",(function(){return F.a})),n.d(e,"N",(function(){return L})),n.d(e,"O",(function(){return U})),n.d(e,"P",(function(){return D.a})),n.d(e,"Q",(function(){return x})),n.d(e,"R",(function(){return M})),n.d(e,"S",(function(){return G.a})),n.d(e,"T",(function(){return W})),n.d(e,"U",(function(){return z})),n.d(e,"V",(function(){return B.a})),n.d(e,"W",(function(){return H})),n.d(e,"X",(function(){return V})),n.d(e,"Z",(function(){return K})),n.d(e,"Y",(function(){return q})),n.d(e,"ab",(function(){return Q})),n.d(e,"bb",(function(){return $.a})),n.d(e,"cb",(function(){return J})),n.d(e,"db",(function(){return X})),n.d(e,"eb",(function(){return Y})),n.d(e,"fb",(function(){return Z.a})),n.d(e,"gb",(function(){return tt})),n.d(e,"hb",(function(){return et})),n.d(e,"ib",(function(){return nt})),n.d(e,"jb",(function(){return at.a})),n.d(e,"kb",(function(){return rt})),n.d(e,"e",(function(){return it})),n.d(e,"l",(function(){return ct.a})),n.d(e,"m",(function(){return ct.b})),n.d(e,"n",(function(){return ct.c})),n.d(e,"o",(function(){return ct.d})),n.d(e,"p",(function(){return ct.e})),n.d(e,"q",(function(){return ct.f})),n.d(e,"r",(function(){return ct.g})),n.d(e,"s",(function(){return ct.h})),n.d(e,"t",(function(){return ct.j}))},2759:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"i",(function(){return i})),n.d(e,"d",(function(){return c})),n.d(e,"c",(function(){return o})),n.d(e,"g",(function(){return s})),n.d(e,"b",(function(){return u})),n.d(e,"h",(function(){return d})),n.d(e,"f",(function(){return l})),n.d(e,"e",(function(){return f}));var a=n(2);const r=Object(a.action)("ADD_SHARING_LINK",(t,e,n,a,r,i,c,o,s,u,d,l,f)=>({linkId:t,url:e,sharingLinkIds:n,response:a,source:r,providerType:i,linksContainerId:c,unwrappedUrl:o,creationDateTime:s,thumbnailUrl:u,previewUrl:d,shareId:l,fromQuotedBody:f})),i=Object(a.action)("SHARING_LINK_REMOVED",(t,e,n,a,r)=>({linkId:t,sharingLinkIds:e,fileName:n,providerType:a,linksContainerId:r})),c=Object(a.action)("DELETE_LINK",(t,e)=>({linkId:t,targetWindow:e})),o=Object(a.action)("CREATE_ATTACHMENT_FROM_LINK",(t,e,n,a)=>({linkId:t,providerId:e,isTryAgain:n,targetWindow:a})),s=Object(a.action)("ON_LINK_HAS_CHANGED",(t,e,n,a)=>({linkId:t,recipientInfos:e,composeId:n,isCalendar:a})),u=Object(a.action)("ADD_SHARING_LINK_TO_CONTAINER",(t,e)=>({linkId:t,linkIdContainer:e})),d=Object(a.action)("REMOVE_SHARING_LINK_FROM_CONTAINER",(t,e)=>({linkId:t,linkIdContainer:e})),l=Object(a.action)("ON_FLUID_LINK_CREATED",(t,e,n,a,r)=>({linkId:t,containerId:e,owaSource:n,url:a,viewStateId:r})),f=Object(a.action)("ON_EXISTING_FLUID_LINK_PROCESSED",(t,e,n,a,r)=>({linkId:t,containerId:e,owaSource:n,url:a,viewStateId:r}))},2809:function(t,e,n){"use strict";n.d(e,"e",(function(){return r})),n.d(e,"f",(function(){return i})),n.d(e,"g",(function(){return c})),n.d(e,"c",(function(){return o})),n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return u})),n.d(e,"d",(function(){return d}));var a=n(2);const r=Object(a.action)("UPDATE_SHARING_LINK_FROM_SHARING_DIALOG",(t,e)=>({linkId:t,sharingDialogResponse:e})),i=Object(a.action)("UPDATE_SHAREPOINT_LINK_PERMISSION",(t,e)=>({linkId:t,newPermission:e})),c=Object(a.action)("UPDATE_SHAREPOINT_LINK_URL",(t,e,n,a)=>({linkId:t,newLinkUrl:e,oldLinkUrl:n,expirationDate:a})),o=Object(a.action)("SET_REFRESH_STATUS_FOR_LINK",(t,e)=>({linkId:t,actionStatus:e})),s=Object(a.action)("CREATE_OR_UPDATE_SHARING_LINK",(t,e,n,a,r,i,c,o,s)=>({linkId:t,sharingUrl:e,currentUrl:n,canonicalUrl:a,newPermissionLevel:r,providerType:i,composeId:c,recipientInfos:o,isCalendar:s})),u=Object(a.action)("ADD_SHARING_LINK_INFO",(t,e)=>({linkId:t,linkModel:e})),d=Object(a.action)("TOKEN_UNAVAILABLE",t=>({linkId:t}))},2835:function(t,e,n){"use strict";n.d(e,"l",(function(){return m})),n.d(e,"n",(function(){return h})),n.d(e,"k",(function(){return b})),n.d(e,"m",(function(){return I}));var a=n(20),r=n(3015);n.d(e,"b",(function(){return r.a}));var i=n(2997);n.d(e,"i",(function(){return i.a}));n(2840);var c=n(2841);n.d(e,"d",(function(){return c.a})),n.d(e,"e",(function(){return c.b})),n.d(e,"o",(function(){return c.c}));var o=n(2998);n.d(e,"a",(function(){return o.b}));var s=n(2894);n.d(e,"g",(function(){return s.a})),n.d(e,"h",(function(){return s.b}));var u=n(2994);n.d(e,"j",(function(){return u.a}));var d=n(2906);n.d(e,"c",(function(){return d.a}));var l=n(2985);n.d(e,"f",(function(){return l.b}));const f=new a.c(()=>Promise.all([n.e(0),n.e(839)]).then(n.bind(null,3947))),m=new a.b(f,t=>t.loadProviders),h=new a.b(f,t=>t.removeFileProvider),b=new a.b(f,t=>t.addFileProvider),I=new a.b(f,t=>t.removeAndAddFileProvider)},2840:function(t,e,n){"use strict";var a=n(2),r=n(13),i=n(2906);const c={providers:new r.ObservableMap,loadState:i.a.NotLoaded,removalPending:new r.ObservableMap},o=Object(a.createStore)("fileProviderStore",c);e.a=o},2841:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return r})),n.d(e,"c",(function(){return c}));var a=n(2);const r=Object(a.action)("FILE_PROVIDER_ADDED",t=>({providerViewState:t})),i=Object(a.action)("FILE_PROVIDER_REMOVED",t=>({providerType:t})),c=Object(a.action)("PROVIDERS_LOADED",t=>({providers:t}))},2848:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var a=n(3070),r=n(2849);function i(t){const e=Object(a.a)(),n=Object(r.b)(t);return e.sharingLinks.get(n)}},2849:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return c})),n.d(e,"a",(function(){return o}));var a=n(25);const r="_ODSPPSL";function i(t){return Object(a.k)("doc-link-savePermission")&&t&&-1!==t.indexOf(r)?t.substring(0,t.length-r.length):t}function c(t){return!!Object(a.k)("doc-link-savePermission")&&t.lastIndexOf(r)===t.length-r.length}function o(t,e){return!Object(a.k)("doc-link-savePermission")||2!==e&&1!==e?t:t+r}},2874:function(t,e,n){"use strict";var a,r,i;n.d(e,"c",(function(){return a})),n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i})),function(t){t[t.Keywords=0]="Keywords",t[t.People=1]="People",t[t.PrivateDistributionList=2]="PrivateDistributionList",t[t.File=3]="File",t[t.Category=4]="Category",t[t.Message=5]="Message",t[t.Event=6]="Event",t[t.TrySuggestion=7]="TrySuggestion",t[t.Setting=8]="Setting"}(a||(a={})),function(t){t.ODSPFile="ODSP file",t.CloudyAttachment="Cloudy attachment",t.ClassicAttachment="Classic attachment",t.LinkAttachment="Link attachment",t.Unknown="Unknown"}(r||(r={})),function(t){t[t.Unknown=0]="Unknown",t[t.Checking=1]="Checking",t[t.NotSupported=2]="NotSupported",t[t.Supported=3]="Supported"}(i||(i={}))},2881:function(t,e,n){"use strict";var a,r=n(20),i=n(2759),c=n(2809),o=n(3131);!function(t){t.PasteHtml="PasteHtml",t.InsertLinkFromToolbar="InsertLinkFromToolbar",t.InsertLinkFromAttachMenu="InsertLinkFromAttachMenu",t.AutoLink="AutoLink",t.ReplyOrForward="ReplyOrForward",t.LinkContextMenu="LinkContextMenu",t.Undo="Undo",t.EditorLoadedOrDraftOrReply="EditorLoadedOrDraftOrReply",t.RestoreCursor="RestoreCursor",t.ShareLinkCompose="ShareLinkCompose",t.NewFluidFile="NewFluidFile",t.Unknown="Unknown"}(a||(a={}));var s=n(2942),u=n(3140),d=n(3107),l=n(2849),f=n(2848);const m=[a.PasteHtml,a.InsertLinkFromToolbar,a.AutoLink,a.ShareLinkCompose,a.InsertLinkFromAttachMenu];function h(t){const e=Object(f.a)(t);return e&&-1!==m.indexOf(e.source)}var b=n(3092);function I(t){const e=Object(f.a)(t);return e?{id:e.linkId,name:e.fileName,supportsDownsell:!1,currentPermissionLevel:e.permissionLevel,sharingInfo:e.sharingInfo,sharingTipsIgnored:e.sharingTipsIgnored,sharingRecipientsInfo:e.sharingRecipientsInfo,typeOfLink:h(t)?"newLink":"oldLink"}:null}var p=n(3070);function O(){return Object(p.a)().sharingLinks.size}var g=n(3132);n.d(e,"t",(function(){return j})),n.d(e,"D",(function(){return A})),n.d(e,"K",(function(){return C})),n.d(e,"G",(function(){return v})),n.d(e,"E",(function(){return E})),n.d(e,"B",(function(){return y})),n.d(e,"H",(function(){return T})),n.d(e,"I",(function(){return w})),n.d(e,"J",(function(){return _})),n.d(e,"v",(function(){return k})),n.d(e,"s",(function(){return N})),n.d(e,"A",(function(){return P})),n.d(e,"u",(function(){return R})),n.d(e,"F",(function(){return F})),n.d(e,"C",(function(){return L})),n.d(e,"y",(function(){return U})),n.d(e,"x",(function(){return D})),n.d(e,"w",(function(){return x})),n.d(e,"z",(function(){return M})),n.d(e,"P",(function(){return S})),n.d(e,"d",(function(){return i.a})),n.d(e,"e",(function(){return i.b})),n.d(e,"f",(function(){return i.c})),n.d(e,"h",(function(){return i.d})),n.d(e,"R",(function(){return i.h})),n.d(e,"T",(function(){return i.i})),n.d(e,"M",(function(){return i.f})),n.d(e,"N",(function(){return i.g})),n.d(e,"L",(function(){return i.e})),n.d(e,"U",(function(){return c.e})),n.d(e,"V",(function(){return c.f})),n.d(e,"W",(function(){return c.g})),n.d(e,"S",(function(){return c.c})),n.d(e,"g",(function(){return c.b})),n.d(e,"Q",(function(){return o.b})),n.d(e,"a",(function(){return a})),n.d(e,"o",(function(){return s.a})),n.d(e,"q",(function(){return s.b})),n.d(e,"O",(function(){return u.a})),n.d(e,"c",(function(){return d.a})),n.d(e,"i",(function(){return l.a})),n.d(e,"j",(function(){return l.b})),n.d(e,"r",(function(){return l.c})),n.d(e,"p",(function(){return h})),n.d(e,"b",(function(){return b.a})),n.d(e,"m",(function(){return f.a})),n.d(e,"l",(function(){return I})),n.d(e,"k",(function(){return O})),n.d(e,"n",(function(){return g.a}));const S=new r.c(()=>Promise.all([n.e(0),n.e(29),n.e(87),n.e(687)]).then(n.bind(null,19718))),j=new r.b(S,t=>t.addRecipientsIntoLink),A=new r.b(S,t=>t.removeRecipientsFromLink),C=new r.b(S,t=>t.updateRecipientPermissionInfos),v=new r.b(S,t=>t.setGetPermissionInfoFailure),E=new r.b(S,t=>t.resetSharingRecipientsInfo),y=new r.b(S,t=>t.ignoreSharingTip),T=new r.b(S,t=>t.setLinkActionStatus),w=new r.b(S,t=>t.updateLinkContainerIdOfLink),_=new r.b(S,t=>t.updateLinkIds),k=new r.b(S,t=>t.createLinksIdContainer),N=new r.b(S,t=>t.addLinkIdToLinksIdContainer),P=new r.b(S,t=>t.getSharingTipRecipientInfo),R=new r.b(S,t=>t.createCloudFileFromSharingLink),F=new r.b(S,t=>t.retrieveImageUrlsForImageFile),L=new r.b(S,t=>t.imageLinkPreviewCondition),U=new r.b(S,t=>t.getLinksIdContainer),D=new r.b(S,t=>t.getAllLinksContainerIds),x=new r.b(S,t=>t.doesLinksIdContainerExist),M=new r.b(S,t=>t.getSharingLinkInfo)},2894:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i}));var a=n(2840);const r=()=>[...Object(a.a)().providers.values()],i=t=>Object(a.a)().providers.get(t)||null},2906:function(t,e,n){"use strict";var a;n.d(e,"a",(function(){return a})),function(t){t[t.Loaded=0]="Loaded",t[t.Loading=1]="Loading",t[t.NotLoaded=2]="NotLoaded",t[t.Throttled=3]="Throttled"}(a||(a={}))},2908:function(t,e,n){"use strict";n.d(e,"g",(function(){return i})),n.d(e,"j",(function(){return c})),n.d(e,"v",(function(){return o})),n.d(e,"l",(function(){return s})),n.d(e,"o",(function(){return u})),n.d(e,"r",(function(){return d})),n.d(e,"i",(function(){return l})),n.d(e,"b",(function(){return f})),n.d(e,"c",(function(){return m})),n.d(e,"h",(function(){return h})),n.d(e,"e",(function(){return b})),n.d(e,"d",(function(){return I})),n.d(e,"f",(function(){return p})),n.d(e,"k",(function(){return O})),n.d(e,"m",(function(){return g})),n.d(e,"p",(function(){return S})),n.d(e,"q",(function(){return j})),n.d(e,"n",(function(){return A})),n.d(e,"u",(function(){return C})),n.d(e,"a",(function(){return v})),n.d(e,"s",(function(){return E})),n.d(e,"t",(function(){return y}));var a=n(20);const r=new a.c(()=>n.e(1222).then(n.bind(null,3710)));let i=new a.a(r,t=>t.logEntityClicked);const c=new a.a(r,t=>t.logResponseReceived);let o=new a.a(r,t=>t.logSessionEnd),s=new a.a(r,t=>t.logResponseRendered);const u=new a.a(r,t=>t.logSearchBoxStateChanged);let d=new a.a(r,t=>t.logSearchResultInteraction),l=new a.a(r,t=>t.logResponseNeverRendered);const f=new a.a(r,t=>t.flushNonRenderedResponseReceivedItemsFromCache),m=new a.a(r,t=>t.logCachedContentRendered);let h=new a.a(r,t=>t.logFeedback);const b=new a.a(r,t=>t.logClientLayout),I=new a.a(r,t=>t.logClientDataSource),p=new a.a(r,t=>t.logEntitiesFromFilePicker),O=new a.a(r,t=>t.logResponseRecievedV2),g=new a.a(r,t=>t.logResultsRendered),S=new a.a(r,t=>t.logSearchEntityActions),j=new a.a(r,t=>t.logSearchFeedbackActions),A=new a.a(r,t=>t.logSearchActions);let C=new a.a(r,t=>t.logSecondaryEntityActionClicked);const v=new a.a(r,t=>t.clearProcessedTraceIds),E=new a.a(r,t=>t.logSearchSuggestionsClientLayoutEvent),y=new a.a(r,t=>t.logSearchSuggestionsResultsRenderedEvent)},2940:function(t,e,n){"use strict";function a(t){return Object.assign({},t)}function r(t){return Object.assign({},t)}function i(t){return Object.assign({},t)}function c(t){return Object.assign({},t)}function o(t){return Object.assign({},t)}n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return r})),n.d(e,"d",(function(){return i})),n.d(e,"e",(function(){return c})),n.d(e,"c",(function(){return o}))},2942:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return c}));var a=n(2746),r=n(25);function i(t){const e=(Object(a.a)(t)||"").toLowerCase();return!!t&&(Object(r.k)("cmp-prague")&&(".fluid"===e||".note"===e))}function c(t){const e=(Object(a.a)(t)||"").toLowerCase();return!!t&&(Object(r.k)("cmp-prague")&&".note"===e)}},2950:function(t,e,n){"use strict";function a(t){return Object.assign({__type:"UnifiedGroupIdentity:#Exchange"},t)}n.d(e,"a",(function(){return a}))},2954:function(t,e,n){"use strict";var a;n.d(e,"a",(function(){return a})),function(t){t.Mail="owa.react",t.MailCompose="owa.react.compose",t.Calendar="owa.react.calendar",t.FilesHub="owa.react.filesHub",t.MailSubject="owa.react.mail.subject",t.MailEmailAttachmentPicker="owa.react.mail.emailPicker",t.SuggestedAttachments="suggestedattachments",t.MeetingPrep="MeetingPrep",t.MeetingPrepPrefetch="MeetingPrep.Prefetch",t.MeetingPrepPeek="MeetingPrep.Peek",t.MeetingPrepReminder="MeetingPrep.Reminder",t.MeetingPrepAgenda="MeetingPrep.AgendaView",t.MeetingPrepMailCalendarCard="MeetingPrep.MailCalendarCard",t.MeetingPrepDesktop="OutlookDesktopOPX.MeetingPrep",t.MeetingPrepShell="ShellOPX.MeetingPrep",t.ContextualInsights="ContextualInsights",t.FileSuggestions="owa.react.filepicker",t.SonoraFilePicker="outlook.inlinefilepicker",t.SonoraHoneybee="owa.honeybee"}(a||(a={})),e.b=a},2985:function(t,e,n){"use strict";var a=n(35);function r(t){return Object.assign({__type:"GetNewAttachmentDataProviderCreationInfoRequest:#Exchange"},t)}function i(t){const e=r({ProviderType:t});return void 0===(n=e)||n.__type||(n=r(n)),Object(a.a)("GetNewAttachmentDataProviderCreationInfo",n,i);var n,i}function c(t){return Object.assign({__type:"GetAttachmentDataProviderCreatorRequest:#Exchange"},t)}function o(t){const e=c({ProviderType:t});return void 0===(n=e)||n.__type||(n=c(n)),Object(a.a)("GetAttachmentDataProviderCreator",n,r);var n,r}var s=n(3255),u=n(3212);n.d(e,"a",(function(){return p})),n.d(e,"b",(function(){return S}));const d="code",l="token",f=3e3,m=3;function h(t){return{state:t}}function b(t){return t.state}function I(t){return t.code}function p(t,e,n,a,r){const c={providerType:t,getAuthUrlInfo:null,getCSRFToken:b,getOAuthCode:I};return async function t(e,n,a,r,c,u,d){try{let t;if(7===e||9===e||8===e){const n=await o(e);t=n.AttachmentDataProviderCreator.ProviderAppKey,a=n.AttachmentDataProviderCreator.AuthorizationUri}else{t=(await i(e)).ProviderAppKey}n.getAuthUrlInfo=Object(s.d)(e,a,r,t,c,u)}catch(i){d>0&&setTimeout(()=>t(e,n,a,r,c,u,--d),f)}}(t,c,e,n,a,r,m),c}let O=null;function g(){if(!O){if(O={},Object(u.a)(3)&&(O[3]=p(3,"https://app.box.com/api/oauth2/authorize",Object(s.c)(3),d,h)),Object(u.a)(2)&&(O[2]=p(2,"https://www.dropbox.com/oauth2/authorize",Object(s.b)(2),d,h)),Object(u.a)(6)){const t=p(6,"https://www.facebook.com/dialog/oauth",Object(s.b)(6),l,t=>({state:t,scope:"user_photos,email"}));t.getCSRFToken=b,t.getOAuthCode=t=>t.access_token,O[6]=t}if(Object(u.a)(5)){const t=p(5,"https://accounts.google.com/o/oauth2/auth",`${s.a}/ADPRedirect.aspx`,d,t=>{const e={state:t,provider:5..toString(),url:Object(s.b)()};return{state:JSON.stringify(e),scope:"https://www.googleapis.com/auth/drive",access_type:"offline",prompt:"consent",include_granted_scopes:"true"}});t.getCSRFToken=t=>{return JSON.parse(t.state).state},O[5]=t}Object(u.a)(1)&&(O[1]=p(1,"https://login.live.com/oauth20_authorize.srf",Object(s.c)(1),d,t=>({state:t,scope:"wl.basic onedrive.readwrite wl.offline_access"}))),Object(u.a)(7)&&(O[7]=p(7,"",Object(s.c)(7),d,h)),Object(u.a)(8)&&(O[8]=p(8,"",Object(s.c)(8),d,h)),Object(u.a)(9)&&(O[9]=p(9,"",Object(s.c)(9),d,h))}return O}function S(t){const e=g();return t in e?e[t]:null}},2994:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var a=n(2840);function r(){return Object(a.a)().loadState}},2997:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var a=n(3279),r=n(3228),i=n(3265),c=n(6),o=n(72);function s(t,e=!1){if(e)return"";switch(t){case 0:return Object(c.b)(i.b);case 1:return Object(c.b)(i.a);case 2:case 9:return Object(c.b)(a.b);case 3:case 7:return Object(c.b)(a.a);case 5:return Object(c.b)(a.e);case 6:return Object(c.b)(a.d);case 4:return Object(c.b)(a.f);case 10:return Object(c.b)(r.b);case 8:return Object(c.b)(a.c);default:return Object(o.a)(t)}}},2998:function(t,e,n){"use strict";var a;n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return r})),n.d(e,"c",(function(){return i})),function(t){t[t.Groups=1e4]="Groups"}(a||(a={}));const r=Object.freeze([1,3,2,6,5,7,8,9]),i=Object.freeze([...r,0,4,10])},3015:function(t,e,n){"use strict";var a;!function(t){t[t.None=0]="None",t[t.Images=1]="Images"}(a||(a={})),e.a=a},3019:function(t,e,n){"use strict";var a=n(1431),r=n(710);function i(t){return Object.assign({__type:"SingleLargeArchiveSearchScopeType:#Exchange"},t)}function c(t){return Object.assign({__type:"SearchFolderScopeType:#Exchange"},t)}var o=n(2950),s=n(2751);var u=n(1084),d=n(2940),l=n(2741),f=n(2971);n.d(e,"a",(function(){return S})),n.d(e,"b",(function(){return j})),n.d(e,"c",(function(){return A}));const m={getKey:function(t){return t.kind+"-"+t.folderId},getSearchScopeList:function(){const t=[];t.push(Object(d.b)({folderId:Object(u.a)(l.k),kind:"PrimaryMailbox"}));const e=Object(f.b)("UserMailbox");for(let n of e)t.push(Object(d.b)({folderId:n,kind:"PrimaryMailbox"}));return t},getSearchScopeType:function(t){const e=Object(s.a)(t.folderId);let n;return n="none"!=e?Object(a.a)({Id:e}):Object(r.a)({Id:t.folderId}),[(i={FolderScope:c({BaseFolderId:n}),IsDeepTraversal:!0},Object.assign({__type:"PrimaryMailboxSearchScopeType:#Exchange"},i))];var i}},h={getKey:function(t){return t.kind+"-"+t.folderId},getSearchScopeList:function(){const t=[];return t.push(Object(d.a)({folderId:Object(u.a)(l.d),kind:"ArchiveMailbox"})),t.push(Object(d.a)({folderId:Object(u.a)(l.a),kind:"ArchiveMailbox"})),t},getSearchScopeType:function(t){const e=Object(s.a)(t.folderId);let n;return n="none"!=e?Object(a.a)({Id:e}):Object(r.a)({Id:t.folderId}),"archivemsgfolderroot"==e?[(o={ArchiveTypes:16777215},Object.assign({__type:"LargeArchiveSearchScopeType:#Exchange"},o))]:[i({FolderScope:c({BaseFolderId:n})})];var o}},b={getKey:function(t){return t.kind+"-"+t.folderId},getSearchScopeList:function(){return[]},getSearchScopeType:function(t){return null}},I={getKey:function(t){return t.kind+"-"+t.groupId.toLowerCase()},getSearchScopeList:function(){return[]},getSearchScopeType:function(t){return[(e={GroupIdentity:Object(o.a)({Type:0,Value:t.groupId})},Object.assign({__type:"SingleGroupSearchScopeType:#Exchange"},e))];var e}},p={getKey:function(t){return t.kind+"-"+t.calendarFolderId?t.calendarFolderId.toLowerCase():""},getSearchScopeList:function(){return[]},getSearchScopeType:function(t){return null}},O={getKey:function(t){return t.kind+"-"+t.folderId},getSearchScopeList:function(){return[]},getSearchScopeType:function(t){return null}},g=t=>{switch(t.kind){case"PrimaryMailbox":return m;case"ArchiveMailbox":return h;case"SharedFolders":return b;case"Group":return I;case"Calendar":return p;case"PublicFolder":return O;default:throw new Error("Unregistered search scope")}},S=t=>g(t).getKey(t),j=t=>g(t).getSearchScopeList(),A=t=>g(t).getSearchScopeType(t)},3021:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var a=n(2);const r=Object(a.action)("RESET_SEARCH_STORE",t=>({scenarioId:t}))},3035:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var a=n(2);const r=Object(a.action)("CLEAR_SEARCH_BOX",t=>({scenarioId:t}))},3036:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var a=n(2);const r=Object(a.action)("END_SEARCH_SESSION",(t,e)=>({scenarioId:t,actionSource:e}))},3037:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var a=n(2);const r=Object(a.action)("ON_BACKSPACE_PRESSED_SEARCH_INPUT",(t,e)=>({cursorPosition:t,scenarioId:e}))},3038:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var a=n(2);const r=Object(a.action)("ON_DOWN_ARROW_PRESSED_SEARCH_INPUT",t=>({scenarioId:t}))},3039:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var a=n(2);const r=Object(a.action)("ON_LEFT_ARROW_PRESSED_SEARCH_INPUT",(t,e)=>({cursorPosition:t,scenarioId:e}))},3040:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var a=n(2);const r=Object(a.action)("ON_UP_ARROW_PRESSED_SEARCH_INPUT",t=>({scenarioId:t}))},3041:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var a=n(2);const r=Object(a.action)("REMOVE_SUGGESTION_PILL_FROM_SEARCHBOX",(t,e,n)=>({suggestionPillId:t,scenarioId:e,actionSource:n}))},3042:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var a=n(2);const r=Object(a.action)("SET_IS_SUGGESTIONS_DROPDOWN_VISIBLE",(t,e)=>({isSuggestionsDropdownVisible:t,scenarioId:e}))},3043:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var a=n(2);const r=Object(a.action)("setShowSearchBoxInCompactMode",(function(t,e){return{scenarioId:t,showSearchBoxInCompactMode:e}}))},3044:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var a=n(2);const r=Object(a.action)("UPDATE_IS_SUGGESTION_SET_COMPLETE",(t,e)=>({isComplete:t,scenarioId:e}))},3058:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var a=n(2),r=n(66);const i=Object(a.action)("onSearchScopeButtonClicked",(t,e)=>Object(r.b)({name:"Search_ScopeButtonClicked",customData:{isFolderScopeVisible:t,searchScenarioType:e}},{isScopeVisible:t,searchScenarioType:e}))},3059:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var a=n(2);const r=Object(a.action)("onSearchScopeOptionSelected",(t,e)=>({selectedSearchScope:t,searchScenarioType:e}))},3070:function(t,e,n){"use strict";n.d(e,"b",(function(){return c}));var a=n(13),r=n(2);const i={sharingLinks:new a.ObservableMap({}),linksIdContainerMap:new a.ObservableMap({})},c=Object(r.createStore)("sharingLinkStore",i);e.a=c},3076:function(t,e,n){"use strict";n.d(e,"e",(function(){return i})),n.d(e,"f",(function(){return c})),n.d(e,"a",(function(){return o})),n.d(e,"d",(function(){return s})),n.d(e,"g",(function(){return u})),n.d(e,"b",(function(){return d})),n.d(e,"c",(function(){return l}));var a=n(20);const r=new a.c(()=>Promise.all([n.e(0),n.e(35),n.e(801)]).then(n.bind(null,3886)));let i=new a.a(r,t=>t.logLocalContentDataSource),c=new a.a(r,t=>t.logLocalContentLayout),o=new a.a(r,t=>t.clearLocalContentInstrumentationCache),s=new a.b(r,t=>t.getLocalContentId);const u=new a.b(r,t=>t.substrateSearchInitOperation),d=(new a.b(r,t=>t.substrateSearchPostSuggestionsService),new a.b(r,t=>t.deleteSubstrateSearchHistoryService)),l=new a.b(r,t=>t.exportSubstrateSearchHistoryService)},3092:function(t,e,n){"use strict";var a;n.d(e,"a",(function(){return a})),function(t){t[t.none=0]="none",t[t.refreshing=1]="refreshing",t[t.refreshFailed=2]="refreshFailed",t[t.refreshSucceeded=3]="refreshSucceeded",t[t.attachingAsACopy=4]="attachingAsACopy",t[t.pendingAttachAsACopy=5]="pendingAttachAsACopy"}(a||(a={}))},3107:function(t,e,n){"use strict";var a;n.d(e,"a",(function(){return a})),function(t){t[t.linkIds=0]="linkIds",t[t.quotedBodyLinkIds=1]="quotedBodyLinkIds"}(a||(a={}))},3131:function(t,e,n){"use strict";function a(t){return void 0!==t.recipients}function r(t){return void 0!==t.length}n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return r}))},3132:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var a=n(3146),r=n(242),i=n(244);async function c(t){return function(t){if(!Object(r.a)(null==t?void 0:t.nav)){const e={nav:t.nav};return Object(i.stringify)(e)}return null}((await a.b.import())(t))}},3140:function(t){t.exports=JSON.parse('{"a":"uVa"}')},3146:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return c})),n.d(e,"e",(function(){return o})),n.d(e,"f",(function(){return s})),n.d(e,"d",(function(){return u})),n.d(e,"b",(function(){return d}));var a=n(20);const r=new a.c(()=>n.e(1274).then(n.bind(null,3884))),i=new a.b(r,t=>t.extractFileUrlFromOfficeSharePointLink),c=new a.b(r,t=>t.isLinkPrefixedWithBaseUrl),o=new a.b(r,t=>t.isSharePointLink),s=new a.b(r,t=>t.isSharePointServiceGeneratedLink),u=new a.b(r,t=>t.isOfficeSharePointLink),d=new a.b(r,t=>t.getParsedQueryStringFromUrl)},3206:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var a=n(3019);function r(t,e){return!(!t||!e)&&Object(a.a)(t)===Object(a.a)(e)}},3212:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var a=n(2773),r=n(220),i=n(72),c=n(25);function o(t){const e=Object(a.a)();switch(t){case 5:return(null==e?void 0:e.GoogleDriveAttachmentsEnabled)&&(null==e?void 0:e.ThirdPartyAttachmentsEnabled)&&Object(c.k)("doc-fileProvider-gdrive");case 4:case 0:return!0;case 3:return(null==e?void 0:e.BoxAttachmentsEnabled)&&(null==e?void 0:e.ThirdPartyAttachmentsEnabled)&&Object(c.k)("doc-fileProvider-box");case 2:return(null==e?void 0:e.DropboxAttachmentsEnabled)&&(null==e?void 0:e.ThirdPartyAttachmentsEnabled)&&Object(c.k)("doc-fileProvider-dropbox");case 6:return(null==e?void 0:e.ThirdPartyAttachmentsEnabled)&&Object(c.k)("doc-fileProvider-facebook");case 1:return!!Object(r.a)()||(null==e?void 0:e.OnedriveAttachmentsEnabled)&&(null==e?void 0:e.ThirdPartyAttachmentsEnabled);case 10:return Object(c.k)("doc-filePicker-mailMessageAttachment");case 7:case 8:case 9:return(null==e?void 0:e.ThirdPartyAttachmentsEnabled)&&Object(c.k)("doc-fileProvider-wopiClient");default:return Object(i.a)(t)}}},3228:function(t){t.exports=JSON.parse('{"a":"Oja","b":"Pja"}')},3255:function(t,e,n){"use strict";var a=n(483),r=n(3);function i(t,e,n){if(!t||!e||!n)throw new Error("Key and Value parameters should not be null");return t.indexOf("?")>0?`${t}&${e}=${n}`:`${t}?${e}=${n}`}n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return s})),n.d(e,"d",(function(){return u}));const c=Object(r.R)()?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa";function o(t){const e=t?encodeURIComponent(`?provider=${t}`):"",n=t&&6===t?"AddFacebookFileProvider.html":"AddFileProvider.html";return`${Object(a.n)()}/mail/${n}${e}`}function s(t){const e=`${Object(a.n)()}/mail/AddFileProvider.html`,n=encodeURIComponent(`provider=${t}&url=${e}`);return`${c}/ADPRedirect.aspx?${n}`}function u(t,e,n,a,r,c){return()=>{const t=function(){const t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),e=t.length-1,n=[];for(let a=0;a<16;a++)n.push(t[Math.round(Math.random()*e)]);return"owa_csrf_token_"+n.join("")}();let o=i(e,"client_id",a);if(o=i(o,"redirect_uri",n),o=i(o,"response_type",r),c){const e=c(t);o=Object.keys(e).reduce((t,n)=>i(t,n,e[n]),o)}return{authUrl:o,redirectUrl:n,csrfToken:t}}}},3265:function(t){t.exports=JSON.parse('{"b":"Qja","a":"Rja"}')},3279:function(t){t.exports=JSON.parse('{"b":"Ija","a":"Jja","e":"Kja","d":"Lja","f":"Mja","c":"Nja"}')},3409:function(t,e,n){"use strict";var a=n(2735),r=n(2);e.a=Object(r.mutatorAction)("setNextSearchQueryId",(t,e)=>{Object(a.d)(e).nextSearchQueryId=t})},3548:function(t,e,n){"use strict";n.d(e,"n",(function(){return d})),n.d(e,"m",(function(){return l})),n.d(e,"j",(function(){return f})),n.d(e,"i",(function(){return m})),n.d(e,"k",(function(){return h})),n.d(e,"f",(function(){return b})),n.d(e,"a",(function(){return I})),n.d(e,"c",(function(){return p})),n.d(e,"g",(function(){return O})),n.d(e,"d",(function(){return g})),n.d(e,"h",(function(){return S})),n.d(e,"e",(function(){return A})),n.d(e,"l",(function(){return C})),n.d(e,"b",(function(){return v}));var a=n(3973),r=n(3732),i=n(107),c=n(2904),o=n(3032),s=n(3657),u=n(154);function d(){return Object(i.e)()||Object(i.f)()}function l(t){return function(t){if(t.length<2)return!1;const e=t[0]-parseInt(c.b),n=t[1]-parseInt(c.c);return 0==e&&n>=0}("string"==typeof t?t.split(".").map(t=>parseInt(t)):[])}function f(t){const e="string"==typeof t?t.split("."):[];return e.length&&e[0]!=c.b}function m(){return Object(i.s)()&&(Object(i.i)()&&Object(i.b)()[0]==c.i&&Object(r.a)()||Object(a.a)())&&Object(u.a)("smimeExtension")}function h(t){return 0!==t}function b(t){const e=[];e.push(t.UserEmailAddress),e.push(t.LogonEmailAddress),e.push(t.UserPrincipalName),e.push(t.UserLegacyExchangeDN);const n=t.UserProxyAddresses;return n&&n.length>0&&n.forEach((function(t){e.indexOf(t)>=0||e.push(t)})),e}function I(t){let e=65001;return t.UseGB18030?e=54936:t.UseISO885915&&(e=28605),e}function p(t){return{AllowUserChoiceOfSigningCertificate:t.AllowUserChoiceOfSigningCertificate,IncludeCertificateChainWithoutRootCertificate:t.IncludeCertificateChainWithoutRootCertificate,IncludeCertificateChainAndRootCertificate:t.IncludeCertificateChainAndRootCertificate,EncryptTemporaryBuffers:t.EncryptTemporaryBuffers,SignedEmailCertificateInclusion:t.SignedEmailCertificateInclusion,IncludeSmimeCapabilitiesInMessage:t.IncludeSMIMECapabilitiesInMessage,CopyRecipientHeaders:t.CopyRecipientHeaders,OnlyUseSmartCard:t.OnlyUseSmartCard,EncryptionAlgorithms:t.EncryptionAlgorithms,SigningAlgorithms:t.SigningAlgorithms}}function O(t,e){const n=Object(s.a)().ClearSign;return e||t&&!n?o.a:c.e}function g(t){return btoa(unescape(encodeURIComponent(t)))}function S(t,e){const n=Object(s.a)();return t&&e?n.TripleWrapSignedEncryptedMail?14:12:t?n.ClearSign?11:10:6}function j(){return(Math.floor(4026531839*Math.random())+268435456).toString(16)}function A(t){return c.m+(t||j()+j()+j()+j())}function C(t,e){return e.IsInline&&-1===t.indexOf(e.ContentId)}function v(){return c.d+j()+"@"+j()+"."+j()}},3657:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var a=n(58);function r(){var t;return null===(t=a.a.userConfiguration)||void 0===t?void 0:t.SmimeAdminSettings}},3732:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var a=n(107);function r(){if(Object(a.i)())try{return new ActiveXObject("htmlfile"),!0}catch(t){return!1}return!1}},3814:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return i}));const a=1024,r=1048576,i="Not support special characters"},3973:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var a=n(107),r=n(2904);function i(){return Object(a.e)()&&Object(a.p)([r.f])||Object(a.g)()&&Object(a.p)([r.h])||Object(a.f)()&&Object(a.p)([r.g])}},4586:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var a=n(68);function r(t){const e=t.maxTotalClassicAttachmentSize-t.totalClassicAttachmentSize;return e<0?(Object(a.p)("AttachmentSizeReachedMax",{},{isCore:!0}),0):e}},4820:function(t,e,n){"use strict";var a=n(2884);const r=["ErrorTooLargeForLocalAttachmentSingle","ErrorTooLargeForLocalAttachmentMultiple","WarningFilesCanNotBeAttachedGenericError","WarningEmptyFilesCanNotBeAttached","WarningFilesCanNotBeAttachedWithNamesGenericError","WarningFilesCannotBeAttachedFromOtherMailboxes","WarningSeveralFilesCanNotBeAttachedGenericError","WarningInlineImageTypeNotSupported","WarningAttachmentsCanNotBeDeleted","InfoIncludeMostRecentAttachmentsMessage","ErrorSmimeHasCloudOrUriAttachments","ErrorAttachmentDownloadFailed","ErrorAttachmentDownloadFailedMultipleFiles","WarningSpecialCharactersAreNotSupported"];function i(t){t&&Object(a.a)(t,r)}n.d(e,"a",(function(){return i}))},4943:function(t,e,n){"use strict";var a=n(2);const r={uploadFolders:new(n(13).ObservableMap)},i=Object(a.createStore)("attachmentsUploadFolderStore",r);var c,o=n(52);!function(t){t.User="User",t.Group="Group"}(c||(c={}));const s=Object(a.action)("preloadUploadFolder",(t=Object(o.g)().SessionSettings.UserEmailAddress,e=c.User)=>({mailboxId:t,uploadFolderMailboxType:e})),u=Object(a.action)("uploadFolderLoaded",(t,e)=>({mailboxId:t,uploadFolder:e}));Object(a.mutator)(u,t=>{const{mailboxId:e,uploadFolder:n}=t;i().uploadFolders.set(e,n)});var d=n(5405),l=n(6),f=n(72),m=n(242);const h="Email attachments";function b(t){switch(t){case c.Group:return h;case c.User:return Object(l.b)(d.a);default:return Object(f.a)(t)}}var I=n(35);var p=n(2815);function O(t,e){switch(e){case c.Group:const n=new Headers;return Object(p.f)(t,n),n;case c.User:return null;default:return Object(f.a)(e)}}function g(t=Object(o.g)().SessionSettings.UserEmailAddress){return i().uploadFolders.get(t)||null}var S=n(22);async function j(t=null,e=c.User){try{const r=g(t=t||Object(o.g)().SessionSettings.UserEmailAddress);if(r)return r;const i=function(t,e,n){return{mailboxId:t,folderId:n.FolderId,folderName:Object(m.a)(n.FolderName)?b(e):n.FolderName}}(t,e,await(n={},a={headers:O(t,e)},Object(I.a)("GetAttachmentDataProviderUploadFolderProps",n,a)));return u(t,i),i}catch(t){return S.h.warn("fetchUploadFolder got error: "+t.message),null}var n,a}Object(a.orchestrator)(s,async t=>{const{mailboxId:e,uploadFolderMailboxType:n}=t;g(e)||await j(e,n)}),n.d(e,"d",(function(){return s})),n.d(e,"b",(function(){return j})),n.d(e,"c",(function(){return g})),n.d(e,"a",(function(){return c}))},5097:function(t,e,n){"use strict";var a=n(4305),r=n(3940),i=n(2851),c=n(22),o=n(358),s=Object(o.action)("replaceAttachmentInWell")((function(t,e,n,o){let s=t.docViewAttachments.indexOf(e);s>-1?(Object(r.a)(t,e),t.docViewAttachments.splice(s,0,n)):(s=t.imageViewAttachments.indexOf(e))>-1?(Object(r.a)(t,e),t.imageViewAttachments.splice(s,0,n)):c.d("Can't find the oldAttachment when invoking replaceAttachmentInWell"),n.isCloudy||Object(a.a)(t,o),Object(i.n)(n.attachmentId)})),u=n(2973);function d(t,e,n,a,r){const i=Object(u.h)(Object.assign(Object.assign({},n.AttachmentId),{mailboxInfo:e.attachmentId.mailboxInfo}),n,a,r,!0,!1,!1,null,null,!1);s(t,e,i,n.Size)}n.d(e,"a",(function(){return d}))},5142:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var a=n(5143),r=n(6),i=n(22),c=n(3814),o=n(4586),s=n(2871);function u(t,e,n){let u=0;for(let e,n=0;e=t[n];n++)u+=e.size;const d=Object(o.a)(e);if(u>d){const e=Math.floor(d/c.b);let i,o;return t.length>1?(o="ErrorTooLargeForLocalAttachmentMultiple",i=Object(r.c)(Object(r.b)(a.a),e)):(o="ErrorTooLargeForLocalAttachmentSingle",i=Object(r.c)(Object(r.b)(a.b),e)),Object(s.a)(n,o,[i]),!0}return i.h.info("Attachment: TotalSize = "+Math.floor(e.totalClassicAttachmentSize/1048576)),!1}},5143:function(t){t.exports=JSON.parse('{"a":"sbb","b":"tbb"}')},5240:function(t,e,n){"use strict";e.a={AttachmentCreationClassicFromLocalFile:{name:"AttachmentCreationClassicFromLocalFile",customData:(t,e,n,a,r)=>a?[a.size]:[0]},AttachmentCreationFromRecentAttachment:{name:"AttachmentCreationFromRecentAttachment",customData:(t,e,n,a,r,i)=>[(null==a?void 0:a.size)||0,null==a?void 0:a.fileType]},AttachmentCreationCloudyFromLocalFile:{name:"AttachmentCreationCloudyFromLocalFile"},AttachmentDeletionAction:{name:"AttachmentDeletionAction",customData:(t,e,n,a)=>({generatedAttachmentId:e.attachmentId.Id}),cosmosOnlyData:(t,e,n,a)=>JSON.stringify({attachmentId:e.attachmentId.Id,fileType:a}),options:{isCore:!0}}}},5405:function(t){t.exports=JSON.parse('{"a":"rbb"}')},5620:function(t,e,n){"use strict";function a(t){return Object.assign({__type:"CreateAttachmentJsonRequest:#Exchange"},t)}n.d(e,"a",(function(){return a}))},5724:function(t,e,n){"use strict";var a=n(358);e.a=Object(a.action)("updateChangeKeyOnItemId")((function(t,e){t.ChangeKey=e}))},5877:function(t,e,n){"use strict";function a(t){return Object.assign({__type:"CreateAttachmentRequest:#Exchange"},t)}n.d(e,"a",(function(){return a}))},5919:function(t,e,n){"use strict";function a(t){return Object.assign({__type:"Item:#Exchange"},t)}n.d(e,"a",(function(){return a}))},6285:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var a=n(2);const r=Object(a.action)("setAnnouncedComponentMessage",(t,e)=>({attachmentWell:t,message:e}))},6296:function(t){t.exports=JSON.parse('{"a":"pbb"}')},6301:function(t,e,n){"use strict";function a(t){return Object.assign({__type:"ReferenceAttachment:#Exchange"},t)}n.d(e,"a",(function(){return a}))},6312:function(t,e,n){"use strict";function a(t){return Object.assign({__type:"ItemIdAttachment:#Exchange"},t)}n.d(e,"a",(function(){return a}))},6499:function(t,e,n){"use strict";var a=n(68),r=n(5240),i=n(3940),c=n(5724),o=n(595);const s={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DeleteAttachmentFromDraft"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"attachmentId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AttachmentIdInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteAttachmentFromDraft"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"AttachmentId"},value:{kind:"Variable",name:{kind:"Name",value:"attachmentId"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"RootItemId"}}]}}]}}]};n.d(e,"b",(function(){return d}));e.a=Object(a.s)(r.a.AttachmentDeletionAction,(async function(t,e,n,a){const r=await u(e.attachmentId,n);Object(i.a)(t,e),Object(c.a)(n,r.RootItemId.RootItemChangeKey)}));const u=async function(t,e,n){var a;const r=Object(o.a)(),i=await r.mutate({variables:{attachmentId:{Id:t.Id,mailboxInfo:t.mailboxInfo,RootItemId:t.RootItemId||e.Id,RootItemChangeKey:t.RootItemChangeKey}},context:{requestOptions:n},mutation:s});return null===(a=null==i?void 0:i.data)||void 0===a?void 0:a.deleteAttachmentFromDraft},d={invokeDeleteAttachmentFromDraftMutation:u}},6765:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var a=n(2826),r=n(2852),i=n(1427);function c(t){if(Object(r.a)(t)){const e=t;return{fileType:a.a.Cloud,name:e.Name,size:e.Size,providerId:"",providerType:4,location:e.AttachLongPathName,providerEndpointUrl:"",isFolder:!1,thumbnailUrl:e.AttachmentThumbnailUrl,previewUrl:e.AttachmentPreviewUrl,fileId:e.AttachmentId.Id,fileParentId:"",type:e.ContentType}}return{attachmentItemId:t.AttachmentId.Id,name:t.Name,size:t.Size,fileType:a.a.AttachmentItem,type:i.c,EmbeddedItemClass:t.EmbeddedItemClass,ContentType:t.ContentType}}},6772:function(t,e,n){"use strict";var a=n(2990),r=n(2778),i=n(5225),c=n(25),o=n(358);e.a=Object(o.action)("setAttachmentPermissionLevel")((function(t,e,n,o){const s=Object(r.a)(t),u=s.model;u.PermissionType=e,n&&(u.AttachLongPathName=n,s.openUrl=Object(i.a)(u)),Object(c.k)("doc-attachment-referenceAttachmentExpiration")&&s.info&&s.info.sharingInfo&&(s.info.sharingInfo.expirationDate=o),Object(a.a)(t)}))},6840:function(t,e,n){"use strict";var a=n(8710),r=n(6),i=n(3024),c=n(3025),o=n(4820),s=n(68),u=n(72),d=n(2778),l=n(2767),f=n(8711),m=n(5142);var h=n(7334),b=n(2973),I=n(22),p=n(358),O=n(937),g=n(2851),S=n(6772),j=n(3997);var A=n(3940),C=n(6285),v=n(5724),E=n(11108);function y(t,e,n,a,i,c,o){Object(C.a)(o,Object(r.b)(E.a)),Object(b.E)(t,e,n,a,c),Object(v.a)(i,a.AttachmentId.RootItemChangeKey),function(t,e,n){n&&0===n.ResultCode&&0===t.attachmentType&&(n.CanShareInternally||Object(j.f)(e.PermissionType)||(Object(s.p)("AttachmentsCanNotShareInternally"),Object(S.a)(t.attachmentId,0)),Object(g.n)(e.AttachmentId))}(t,n,c)}function T(t,e,n,a){let r=!0;1===t.attachmentType&&(Object(b.z)(t,2),r=!1),e&&Object(A.a)(e,t,r),n&&a&&O.k.importAndExecute(n,a)}var w=Object(p.action)("handleCreateAttachmentNotification")((function(t,e,n,a,r,i,c,o){const s=t;try{if(0!==s.ResultCode)throw new Error(`ResultCode:${s.ResultCode}, Id:${s.Id}, Exception: ${s.Exception}`);{const t=s.Response.ResponseMessages.Items[0];if(t&&t.Attachments.length>0)return Object(b.C)(r.attachmentId,!0),i(t.Attachments[0]),void y(r,n,a,t.Attachments[0],e,s.Response.SharingInformation,o.attachmentWellViewState)}}catch(t){I.d("Error handling the create attachment notification: "+t)}Object(b.C)(r.attachmentId,!1),c(new Error(s.Exception)),T(r,o.attachmentWellViewState,null,null)})),_=n(159);async function k(t,e){const n=Object(_.a)(),a={subscriptionId:n,requiresExplicitSubscribe:!1,subscriptionParameters:null},r=t=>{e(t),O.k.importAndExecute(a,r)};(await O.j.import())(a,r);const i=(await O.b.import())();t(n,a,i,r)}var N=n(35),P=n(381);var R=n(391);function F(t,e,n,a,r,i){const c=Object(R.a)(t.mailboxInfo)||{};return o={itemId:t,attachmentDataProviderId:n.providerId,location:n.location,attachmentId:n.fileId||"",subscriptionId:a,channelId:r,dataProviderParentItemId:n.fileParentId||"",providerEndpointUrl:n.providerEndpointUrl,cancellationId:e,isInline:i},s=c,void 0===o.itemId||o.itemId.__type||(o.itemId=Object(P.a)(o.itemId)),Object(N.a)("CreateAttachmentFromAttachmentDataProvider",o,s);var o,s}var L=n(3814),U=Object(p.action)("createAttachmentFromAttachmentDataProvider")((function(t,e,n,a,r,i,c,o,u){const d=new s.b("AttachmentCreationClassicFromAttachmentDataProvider");d.addCustomData([r.providerType]);const l=t=>{c(t),d.end()},f=t=>{o(),d.endWithError("ServerError",t)};k(async(e,n,c,s)=>{try{if(0===r.providerType){if(function(t){return-1!==t.indexOf("%")||-1!==t.indexOf("#")}(r.name))throw new Error(L.c)}if(0===i.attachmentType&&Object(b.B)(Object(b.k)(r.size),.05,t=>{Object(b.x)(i,t)},i.attachmentId),!await F(t,a,r,e,c,!1))throw new Error("Empty response for createAttachmentFromAttachmentDataProvider request")}catch(t){return Object(b.C)(i.attachmentId,!1),o(t),void T(i,u.attachmentWellViewState,n,s)}},a=>{w(a,t,e,n,i,l,f,u)})}));var D=n(5240),x=n(2815);function M(t,e,n,a,r,i){return new Promise(async(c,o)=>{const s=new XMLHttpRequest;s.onreadystatechange=function(){if(4===s.readyState)if(200===s.status){let t;try{t=JSON.parse(s.responseText)}catch(t){I.d("Attachment: Deserialize response failed with error: "+t.Message),I.d("Attachment: Deserialize response Failure Stack Trace: "+t.stack),o(t)}c(t)}else o(new Error("Request failed with status "+s.status+". Message: "+s.responseText))},s.ontimeout=function(){o(new Error("Request timed out"))},i&&(s.upload.onprogress=i),s.open("POST",t,!0),s.setRequestHeader("X-OWA-Action",n);const u=await Object(x.d)(a);u&&Object.keys(u).forEach(t=>{s.setRequestHeader(t,u[t])});const d=JSON.stringify(e);r?(s.setRequestHeader("X-OWA-UrlPostData",encodeURI(d)),s.send(r)):s.send(d)})}var G=n(12);function W(t){const e=Object(G.a)();return e.baseUrl?`${e.baseUrl}${t}`:`/owa${t}`}var z=n(5620),B=n(5877),H=n(167),V=n(595);const K={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AddAttachmentToDraft"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AddAttachmentToDraftOptions"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"addAttachmentToDraft"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"attachment"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"OwsTypeName"}},{kind:"Field",name:{kind:"Name",value:"AttachmentId"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"}},{kind:"Field",name:{kind:"Name",value:"RootItemId"}},{kind:"Field",name:{kind:"Name",value:"RootItemChangeKey"}}]}},{kind:"Field",name:{kind:"Name",value:"IsInline"}},{kind:"Field",name:{kind:"Name",value:"ContentId"}},{kind:"Field",name:{kind:"Name",value:"LastModifiedTime"}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ReferenceAttachment"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ProviderType"}},{kind:"Field",name:{kind:"Name",value:"WebUrl"}},{kind:"Field",name:{kind:"Name",value:"AttachLongPathName"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"isCancelled"}}]}}]}}]};var q=n(25);const Q=W("/service.svc/CreateAttachmentFromLocalFile");async function $(t,e,n,a,r,i){if(I.h.info(`Attachment: createAttachment Id: ${t.Id}, ChangeKey: ${t.ChangeKey}`),Object(q.k)("mon-cmp-graphQLAttachments")){const r=function(t){const e=Object.assign(Object.assign({},t),{OwsTypeName:t.__type});delete e.__type,e.AttachmentId&&delete e.AttachmentId.__typename;return e}(e),c=Object(V.a)(),o=(await c.mutate({variables:{options:{ParentItemId:t,Attachment:r,CancellationId:n,attachmentType:"LocalFile",fileBlob:a,mailboxInfo:t.mailboxInfo,isInline:e.IsInline,sliceInformation:i}},mutation:K})).data.addAttachmentToDraft;return{ResponseMessages:{Items:[{Attachments:[Object.assign(Object.assign({},o.attachment),{__type:o.attachment.OwsTypeName})],IsCancelled:o.isCancelled,ResponseClass:"Success",ResponseCode:"NoError"}]}}}{const c=Object(B.a)({ParentItemId:t,Attachments:[e],RequireImageType:e.IsInline,IncludeContentIdInResponse:e.IsInline,ClientSupportsIrm:!0,CancellationId:n});i&&(c.SliceNumber=i.sliceNumber,c.TotalSlices=i.totalSlices);const o=Object(z.a)({Header:Object(H.b)(),Body:c}),s=e;return(await M(Q,o,"CreateAttachmentFromLocalFile",t.mailboxInfo,s&&a?a:null,r)).Body}}function J(t,e){let n="Attachment: createAttachment failed",a=null!=e?e:"genericError";return(null==t?void 0:t.MessageText)&&(n+=` with MessageText: ${t.MessageText}`),I.h.warn(n),(null==t?void 0:t.ResponseCode)&&(a=t.ResponseCode),{errorMessage:n,errorCode:a}}function X(t){const e=Object.assign({},t);return Object.keys(e).forEach((function(t,n){null===e[t]&&(e[t]=void 0)})),e}var Y=Object(s.s)(D.a.AttachmentCreationClassicFromLocalFile,(async function(t,e,n,a,r){let i=null;0===r.attachmentType&&(i=function(t){const e=t.loaded/t.total;Object(b.x)(r,e)});const c=X(e),o=(await $(t,c,n,a,i)).ResponseMessages.Items[0];if(o&&o.Attachments.length>0&&o.Attachments[0]){return{attachment:o.Attachments[0],sharingInfo:null}}throw J(o)})),Z=n(6312),tt=Object(s.s)(D.a.AttachmentCreationFromRecentAttachment,(async function(t,e,n,a,r,i){let c=null;0===r.attachmentType&&(c=function(t){const e=t.loaded/t.total;Object(b.x)(r,e)});let o=X(e);if(i){o=function(t,e){return Object(Z.a)({AttachmentId:t.AttachmentId,AttachmentIdToAttach:e,ContentType:t.ContentType,Name:t.Name,Size:t.Size,Thumbnail:t.Thumbnail,ThumbnailMimeType:t.ThumbnailMimeType,CreateAttachmentInlineType:2})}(o,a.fileId)}const s=await $(t,o,n,null,c),u=s.ResponseMessages.Items[0];if(u&&u.Attachments.length>0&&u.Attachments[0]){return{attachment:u.Attachments[0],sharingInfo:s.SharingInformation}}throw J(u)}));function et(t,e,n,a,r,i){const c=Object(R.a)(t.mailboxInfo)||{};return s=c,void 0===(o={itemId:t,uri:e,name:n,subscriptionId:a,isInline:r,contentId:i}).itemId||o.itemId.__type||(o.itemId=Object(P.a)(o.itemId)),Object(N.a)("CreateAttachmentFromUri",o,s);var o,s}var nt=Object(p.action)("createAttachmentFromUri")((function(t,e,n,a,r,i,c,o,u){const d=new s.b("AttachmentCreationFromUri");d.addCustomData({size:r?r.size:0});const l=t=>{c(t),d.end()},f=t=>{o(),d.endWithError("ServerError",t)};k(async(e,a,c,s)=>{try{if(0===i.attachmentType&&Object(b.B)(Object(b.l)(r.size),.05,t=>{Object(b.x)(i,t)},i.attachmentId),!await et(t,r.uri,r.name,e,n.IsInline,null))throw new Error("Empty response for createAttachmentFromUriProvider request")}catch(t){Object(b.C)(i.attachmentId,!1),o(),T(i,u.attachmentWellViewState,a,s)}},a=>{w(a,t,e,n,i,l,f,u)})})),at=n(8713);function rt(t,e,n){const a=Object(R.a)(t.mailboxInfo)||{};return Object(at.a)({itemId:t,attachmentDataProviderId:n.providerId,location:n.location,attachmentId:n.fileId||"",dataProviderParentItemId:n.fileParentId||"",providerEndpointUrl:n.providerEndpointUrl,cancellationId:e,thumbnailUrl:n.thumbnailUrl,previewUrl:n.previewUrl,isFolder:n.isFolder,mimeType:n.type},a)}var it=n(4763),ct=Object(s.s)({name:"AttachmentCreationCloudyFromAttachmentDataProvider",customData:(t,e,n,a,r)=>[n.providerType,n.fileType]},(async function t(e,n,a,i,c){return 0===i.attachmentType&&Object(b.B)(4e3,.05,t=>{Object(b.x)(i,t)},i.attachmentId),rt(e,n,a).then(async o=>{const s=o.ResponseMessages.Items.length>0?o.ResponseMessages.Items[0]:null;if(s&&s.Attachments.length>0){return Object(b.C)(i.attachmentId,!0),{attachment:s.Attachments[0],sharingInfo:o.SharingInformation}}if(Object(b.C)(i.attachmentId,!1),Object(q.k)("doc-authContext")&&!c&&o.SharingInformation&&!Object(r.j)(o.SharingInformation.ClaimsChallenge)){const c=o.SharingInformation.ClaimsChallenge;if(!Object(r.j)(c)){try{const t=await it.a.import();await t(c)}catch(t){throw J(s,o.SharingInformation.ResultCode.toString())}return t(e,n,a,i,!0)}}throw J(s)})}));const ot=W("/service.svc/CreateReferenceAttachmentFromLocalFile");async function st(t,e,n,a,r,i,c,o,s,u){var d;const l={requestObject:(d={ParentItemId:t,FileName:e.Name,SubscriptionId:r,ChannelId:i,FileSizeInBytes:e.Size,SliceNumber:c,TotalSlices:o,CancellationId:n,FileContentToUpload:"",GroupSmtpAddress:s,UploadFolderId:u},Object.assign({__type:"CreateReferenceAttachmentFromLocalFileRequest:#Exchange"},d))};return await M(ot,l,"CreateReferenceAttachmentFromLocalFile",t.mailboxInfo,a,void 0)}var ut=n(4943);var dt=Object(s.s)(D.a.AttachmentCreationCloudyFromLocalFile,(function(t,e,n,a,r,i,c,o,s){k((e,c,u,d)=>{!async function(t,e,n,a,r,i,c,o,s,u,d,l){var f;const m=Math.ceil(a.size/u);Object(b.B)(Object(b.q)(a.size),.05,t=>{Object(b.x)(r,t)},r.attachmentId);let h=null;const I=null===(f=null==l?void 0:l.attachmentWellViewState)||void 0===f?void 0:f.groupId;if(I&&(h=Object(ut.c)(I)?Object(ut.c)(I).folderId:null,!h)){const t=await Object(ut.b)(I,ut.a.Group);t&&(h=t.folderId)}for(let f=0;f<m;f++){const p=0+f*u,O=Math.min(p+u,a.size),g=a.slice(p,O);try{if(!await st(t,e,n,g,i,o,f,m,I,h))throw new Error("Empty response for createReferenceAttachmentFromLocalFile request")}catch(t){return Object(b.C)(r.attachmentId,!1),d(),void T(r,l.attachmentWellViewState,c,s)}}}(t,n,a,r,i,e,c,u,d,10485760,o,s)},a=>{w(a,t,e,n,i,c,o,s)})}));var lt=n(2826),ft=n(5970),mt=n(333),ht=n(7335);function bt(t,e,n,a,r,i,c,o){const u=new s.b("UploadLocalFileAndCreateCloudyAttachment",{timeout:3e5}),[{uploadPromise:d,cancel:l},f]=Object(ht.a)(n.Name,i,r,({loaded:t,total:e})=>{const n=t/e;Object(b.x)(c,n)}),{model:{Id:m,EndPointUrl:h,Type:I}}=f;let p=!1;return{onCompletePromise:(async()=>{let r=null;try{const{errorResponse:i,result:l}=await d;if(i){const t=await i.text();throw new Error(`Unable to upload file with status code: ${i.status}; response: ${t}`)}const f=function(t,e,n,a){return{fileType:lt.a.Cloud,name:t.name,size:t.size,providerId:e,providerType:n,location:It(t,n),providerEndpointUrl:a,isFolder:!1,fileId:t.id,fileParentId:t.parentReference.id,thumbnailUrl:"",previewUrl:"",type:Object(ft.c)(t)}}(l,m,I,h),p=await rt(t,a,f),O=p.ResponseMessages.Items[0];if(O&&O.Attachments.length>0){Object(b.C)(c.attachmentId,!0);const a=O.Attachments[0];return y(c,e,n,a,t,p.SharingInformation,o.attachmentWellViewState),a}throw new Error(O.MessageText)}catch(t){if(Object(b.C)(c.attachmentId,!1),T(c,o.attachmentWellViewState),p)return null;throw r=t,t}finally{r?(new s.b("UploadLocalFileAndCreateCloudyAttachmentError",{isCore:!0}).endWithError(r),u.endWithError(r)):u.end()}})(),cancel:()=>{p=!0,l()}}}function It(t,e){return 1===e?`${t.parentReference.path}/${t.name}`:Object(mt.parse)(t.webUrl).path}var pt=n(11782);const Ot=14680064;function gt(t,e,n,a){t.addCustomData([e]),n?t.end():t.endWithError("ServerError",a)}function St(t,e,n,a,r,i={}){i.sliceSizeInBytes=i.sliceSizeInBytes||Ot;const c=new s.b("AttachmentCreationClassicFromLocalFileSliced",{timeout:3e5}),{action:o,getLastResponseMessage:d}=function(t,e,n,a,r){let i=null,c=null;return{action:async(o,s,u)=>{c||(c=function(t){const e=[];for(let n=0;n<t;n++)e[n]=0;return e}(u));let d=null;0===r.attachmentType&&(d=function(t){c[s]=t.loaded;const e=c.reduce((t,e)=>t+e,0)/a.size;Object(b.x)(r,e)});const l=X(e),f=await $(t,l,n,o,d,{sliceNumber:s,totalSlices:u});if(i=f.ResponseMessages.Items[0],!function(t){return t&&t.Attachments.length>0&&t.Attachments[0]}(i))throw J(i);e=Object.assign(Object.assign({},e),{AttachmentId:i.Attachments[0].AttachmentId})},getLastResponseMessage:()=>i}}(t,e,n,a,r),{onCompletePromise:l,cancel:f}=Object(pt.a)(a,o,{sliceSize:i.sliceSizeInBytes,numberOfSlicesToParallelize:1});let m=!1;return{onCompletePromise:l.then(t=>{switch(t){case 0:return gt(c,a.size,!0),{status:0,attachment:d().Attachments[0]};case 1:return{status:1};default:return Object(u.a)(t)}}).catch(t=>{if(m)return{status:1};throw gt(c,a.size,!1,t),t}),cancel:()=>{m=!0,f()}}}function jt(t,e,n,a,r,i,c={shouldShare:!1}){const o=a&&(a.fileType===lt.a.Cloud||a.fileType===lt.a.CloudSuggestion||a.fileType===lt.a.ContextualSuggestion);let s=null;const d=Object.assign(Object.assign({},e.AttachmentId),{mailboxInfo:t.mailboxInfo}),{shouldShare:l}=c;let f=()=>{};if((m=a).fileType===lt.a.AttachmentItem||m.fileType===lt.a.AttachmentItemSuggestion||(m.fileType===lt.a.Cloud||m.fileType===lt.a.CloudSuggestion||m.fileType===lt.a.ContextualSuggestion)&&4===m.providerType)s=tt(t,e,n,a,r,o).then(t=>t);else if(l||o){if(!l&&o){return{createAttachmentPromise:new Promise((c,o)=>{U(t,d,e,n,a,r,c,o,i)}),cancelCreateAttachment:f}}if(!l||!o){if(c.shouldShare&&c.shareProperties&&!c.shareProperties.groupMailboxId){const{onCompletePromise:o,cancel:s}=bt(t,d,e,n,c.shareProperties.folderInfo,a.fileObject,r,i);return{createAttachmentPromise:o,cancelCreateAttachment:s}}return{createAttachmentPromise:new Promise((c,o)=>(dt(t,d,e,n,a.fileObject,r,c,o,i),e)),cancelCreateAttachment:f}}s=ct(t,n,a,r)}else if(a&&a.fileType===lt.a.Local&&a.fileObject){const{onCompletePromise:i,cancel:c}=St(t,e,n,a.fileObject,r);f=c,s=i.then(t=>{switch(t.status){case 0:return{attachment:t.attachment,sharingInfo:null};case 1:return null;default:return Object(u.a)(t)}})}else{if(a&&a.fileType===lt.a.Uri){return{createAttachmentPromise:new Promise((c,o)=>{nt(t,d,e,n,a,r,c,o,i)}),cancelCreateAttachment:f}}s=Y(t,e,n,a&&a.fileType===lt.a.Local?a.fileObject:null,r)}var m;return function(t,e,n,a,r,i,c){return{createAttachmentPromise:i.then(i=>i?(y(a,e,n,i.attachment,t,i.sharingInfo,r.attachmentWellViewState),i.attachment):null).catch(t=>{throw T(a,r.attachmentWellViewState,null,null),t}),cancelCreateAttachment:c}}(t,d,e,r,i,s,f)}var At=n(6499);function Ct(t){return e={cancellationId:t},Object(N.a)("CancelAttachment",e,n);var e,n}const vt="ErrorNonExistentMailbox";var Et=n(2893);function yt(t){if(null==t)return null;switch(t){case 0:return Et.i;case 5:return Et.e;case 1:return Et.h;case 2:return Et.b;case 3:return Et.a;case 7:return Et.j;case 9:return Et.k;case 8:return Et.l;case 4:return Et.f;case 6:return Et.c;case 10:return Et.g;default:return Object(u.a)(t)}}var Tt=n(5047),wt=n(5919),_t=n(7802),kt=n(7803),Nt=n(6301),Pt=n(6296),Rt=n(2871);function Ft(t,e){const n=Object(d.a)(t.item.attachmentId);if(n){!function(t,e,n){Object(Rt.a)(n,t,[e])}("WarningAttachmentsCanNotBeDeleted",Object(r.c)(Object(r.b)(Pt.a),n.model.Name),e)}}var Lt=n(2823),Ut=n(11109);const Dt=4;function xt(t,e,n){Object(Rt.a)(n,t,[e])}function Mt(t,e){const n=(a=t=>t.reason,t.reduce((t,e)=>{const n=a(e);return t[n]?t[n].push(e):t[n]=[e],t},{}));var a;Object.keys(n).forEach(t=>{const a=n[t];switch(parseInt(t)){case 0:!function(t,e){let n=null,a=null;if(1===t.length&&null!==t[0].item.tryAgainCallback){const n=t[0],a=n.item.file.name,i=Object(r.c)(Object(r.b)(Ut.e),a),c={key:"WarningFilesCanNotBeAttachedWithNamesGenericError",source:Lt.c.Compose,rank:Lt.b.Info,message:i,messageParts:[i]},o={text:Object(r.b)(Ut.a),action:()=>n.item.tryAgainCallback()};return c.messageParts.push(o),void Object(Rt.a)(e,"WarningFilesCanNotBeAttachedWithNamesGenericError",t=>c)}if(t.length<Dt){const e=t.map(t=>t.item.file.name).join(", ");a="WarningFilesCanNotBeAttachedWithNamesGenericError",n=Object(r.c)(Object(r.b)(Ut.b),e)}else a="WarningSeveralFilesCanNotBeAttachedGenericError",n=Object(r.c)(Object(r.b)(Ut.d),t.length);xt(a,n,e)}(a,e);break;case 1:!function(t,e){xt("WarningFilesCannotBeAttachedFromOtherMailboxes",Object(r.b)(Ut.c),e)}(0,e);break;case 2:!function(t,e){xt("WarningSpecialCharactersAreNotSupported",Object(r.b)(Ut.f),e)}(0,e)}})}class Gt{constructor(t,e,n,a=null,r=null){this.attachmentWellViewState=t,this.parentItemId=e,this.infoBar=n,this.onAnyAttachmentCreatedInParentItemCallback=a,this.onAnyAttachmentDeletedInParentItemCallback=r,this.uploadQueue=[],this.deleteQueue=[],this.uploadFailures=[],this.onFinishPromise=new Promise((t,e)=>{this.onFinish=function(e){t(e)}})}enqueueAttachmentCreation(t,e,n=null,a=null,r=null){const{isInline:i,shouldShare:c,isHiddenInline:s,skipProcessInlineImage:u}=e;if(Object(o.a)(this.infoBar),!c&&Object(m.a)(t,this.attachmentWellViewState,this.infoBar))return[];t=Object(f.a)(t,i,this.infoBar);for(let o,d=0;o=t[d];d++){let t,d=null;const l={Name:null,ContentType:null,ContentId:null,ContentLocation:null,AttachmentOriginalUrl:null,Size:0,LastModifiedTime:null,IsInline:!1,IsInlineToUniqueBody:!1,IsInlineToNormalBody:!1,ThumbnailMimeType:null,Thumbnail:null};if(c){const e=o;t=Object(Nt.a)(Object.assign(Object.assign({},l),{Name:e.name,Size:e.size,ContentType:e.type,ProviderType:yt(e.providerType),AttachmentIsFolder:e.isFolder,IsInline:!1,PermissionType:0,AttachLongPathName:null,ProviderEndpointUrl:null,AttachmentThumbnailUrl:null,AttachmentPreviewUrl:null,OriginalPermissionType:0})),Object(q.k)("wvn-editOptionsMasterFlight")&&0===e.providerType&&(t.AttachmentOriginalUrl=e.location)}else if(o.fileType===lt.a.Base64InlineImage){const e=o;t=Object(Tt.a)(Object.assign(Object.assign({},l),{Name:e.name,Size:e.size,ContentType:e.type,IsInline:!0,Content:e.dataUri,IsContactPhoto:!1,ImageThumbnailSalientRegions:null,ImageThumbnailHeight:0,ImageThumbnailWidth:0})),d=e.tempId}else if(o.fileType===lt.a.MailItem){const e=o;if(e.mimeContent)t=Object(_t.a)(Object.assign(Object.assign({},l),{Name:o.name,Size:o.size,IsInline:!1,Item:Object(wt.a)({MimeContent:Object(kt.a)({Value:e.mimeContent})}),ContentType:"message/rfc822"}));else{const n=Object(P.a)({Id:e.itemId});t=Object(Z.a)(Object.assign(Object.assign({},l),{Name:o.name,IsInline:!1,ItemId:n,Size:o.size,AttachmentIdToAttach:null,CreateAttachmentInlineType:0}))}}else if(o.fileType===lt.a.AttachmentItem||o.fileType===lt.a.AttachmentItemSuggestion){const e=o;t=Object(Z.a)(Object.assign(Object.assign({},l),{Name:e.name,AttachmentIdToAttach:e.attachmentItemId,__type:e.type,Size:o.size,ItemId:null,CreateAttachmentInlineType:0}))}else o.fileType===lt.a.Uri?t=Object(Tt.a)(Object.assign(Object.assign({},l),{Name:o.name,AttachmentOriginalUrl:o.uri,Size:o.size,ContentType:o.type,IsInline:i,Content:"",IsContactPhoto:!1,ImageThumbnailSalientRegions:null,ImageThumbnailHeight:0,ImageThumbnailWidth:0})):(t=Object(Tt.a)(Object.assign(Object.assign({},l),{Name:o.name,Size:o.size,ContentType:o.type,IsInline:i,Content:"",IsContactPhoto:!1,ImageThumbnailSalientRegions:null,ImageThumbnailHeight:0,ImageThumbnailWidth:0})),d=o.tempId);const f={Id:d||Object(_.a)(),mailboxInfo:this.parentItemId.mailboxInfo};let m;i?m=Object(b.i)(f,f.Id,s,0,u):(m=Object(b.g)(f,!1,!1,c,o.fileType,!0),e.isAddedFromSmartDoc&&(m.fileType=lt.a.SmartDoc),this.attachmentWellViewState.supportedMenuActions&&(m.strategy.supportedMenuActions=this.attachmentWellViewState.supportedMenuActions),e.downsellFromLink&&Object(b.A)(m,6,11)),Object(h.a)(m,this.attachmentWellViewState,t,f);const p={attachmentState:m,file:o,attachment:t,shouldShareInfo:e,cancelPendingUpload:()=>{},onAttachmentCreatedCallback:n,onAttachmentCanceledOrFailedCallback:a,tryAgainCallback:r};I.h.info("Attachment: UploadQueue enqueue attachment: Name="+o.name),this.uploadQueue.push(p)}return this.startProcessIfNotStarted(),t}deleteAttachment(t,e=null){Object(o.a)(this.infoBar);const n=1===t.attachmentType,a=n?0===t.status:t.actionCompletePercent<=1;if(n||Object(b.A)(t,3,a?10:6),a&&this.currentUploadItem)if(this.currentUploadItem.attachmentState.attachmentId===t.attachmentId){I.h.info("Attachment: Cancelling attachment: TempId="+t.attachmentId);const n=this.currentUploadItem;if(n.cancelPendingUpload(),0===t.attachmentType&&t.isCloudy){if(I.h.info(`Attachment: Put attachment: Id= ${t.attachmentId} into deleteQueue`),0===this.deleteQueue.filter(e=>e.attachmentState.attachmentId===t.attachmentId).length){const n={attachmentState:t,onAttachmentDeletedCallback:e};this.deleteQueue.push(n)}this.startProcessIfNotStarted()}else this.isCancelling||(this.isCancelling=!0,Ct(t.attachmentId.Id).then(e=>{this.isCancelling=!1,e?(Object(A.a)(this.attachmentWellViewState,t),n.onAttachmentCanceledOrFailedCallback&&n.onAttachmentCanceledOrFailedCallback(!0)):this.onAttachmentDeleteFailure(t)}))}else I.h.info("Attachment: Removing attachment: TempId= "+t.attachmentId+" from queue"),function(t,e){for(let n=0;n<e.length;n++){const a=e[n];a.attachmentState.attachmentId===t.attachmentId&&(a.onAttachmentCanceledOrFailedCallback&&a.onAttachmentCanceledOrFailedCallback(!0),e.splice(n,1))}}(t,this.uploadQueue),Object(A.a)(this.attachmentWellViewState,t);else{if(I.h.info(`Attachment: Put attachment: Id= ${t.attachmentId} into deleteQueue`),0===this.deleteQueue.filter(e=>e.attachmentState.attachmentId===t.attachmentId).length){const n={attachmentState:t,onAttachmentDeletedCallback:e};this.deleteQueue.push(n)}this.startProcessIfNotStarted()}}onAttachmentDeleteFailure(t){var e,n;e={item:t,reason:0},n=this.infoBar,Object(o.a)(n),Ft(e,n),1!==t.attachmentType&&Object(b.A)(t,0,0),I.h.warn("Attachment: Failed to cancel attachment: TempId="+t.attachmentId)}startProcessIfNotStarted(){this.isInProgress||(this.datapoint=new s.b("AttachmentQueueManager"),this.isInProgress=!0,this.processNextAttachment("NewProcess"))}processNextAttachment(t){if(I.h.info("Attachment: Invoking processNextAttachment from: "+t),0!==this.deleteQueue.length){const{attachmentState:t,onAttachmentDeletedCallback:e}=this.deleteQueue[0],n=Object(d.a)(t.attachmentId);I.h.info("Attachment: Deleting attachment: Id= "+t.attachmentId),Object(At.a)(this.attachmentWellViewState,t,this.parentItemId,t.fileType).then(()=>{this.deleteQueue.shift(),Wt(e,this.parentItemId,t.attachmentId,n.model),Wt(this.onAnyAttachmentDeletedInParentItemCallback,this.parentItemId,t.attachmentId,n.model),this.processNextAttachment("DeleteAttachmentFinish")}).catch(e=>{this.deleteQueue.shift(),this.onAttachmentDeleteFailure(t),this.logDeletionFailure(e.message,t),this.processNextAttachment("DeleteAttachmentFinish")})}else if(0!==this.uploadQueue.length){this.currentUploadItem=this.uploadQueue.shift();const t=this.currentUploadItem.onAttachmentCreatedCallback,e={attachmentWellViewState:this.attachmentWellViewState,parentItemId:this.parentItemId,infoBar:this.infoBar},{createAttachmentPromise:n,cancelCreateAttachment:a}=jt(this.parentItemId,this.currentUploadItem.attachment,this.currentUploadItem.attachmentState.attachmentId.Id,this.currentUploadItem.file,this.currentUploadItem.attachmentState,e,this.currentUploadItem.shouldShareInfo);this.currentUploadItem.cancelPendingUpload=a,n.then(e=>{if(e){const n=Object.assign(Object.assign({},e.AttachmentId),{mailboxInfo:this.parentItemId.mailboxInfo});Wt(t,this.parentItemId,n,e),Wt(this.onAnyAttachmentCreatedInParentItemCallback,this.parentItemId,n,e)}this.processNextAttachment("CreateAttachmentFinish")}).catch(t=>{let e=0;(null==t?void 0:t.message)===L.c&&(e=2),t&&t.errorCode===vt&&(e=1),this.uploadFailures.push({item:this.currentUploadItem,reason:e}),this.currentUploadItem.onAttachmentCanceledOrFailedCallback&&this.currentUploadItem.onAttachmentCanceledOrFailedCallback(!1),this.logCreationFailure(),this.processNextAttachment("CreateAttachmentFinish")})}else this.finishProcess()}finishProcess(){I.h.info("Attachment: AttachmentQueueManager: finishProcess"),this.isInProgress=!1;const t=this.currentUploadItem&&this.currentUploadItem.attachmentState?this.currentUploadItem.attachmentState.attachmentId:null;this.currentUploadItem=null,this.onFinish(t),this.datapoint.end(),this.datapoint=null,Mt(this.uploadFailures,this.infoBar),this.uploadFailures=[]}logCreationFailure(){Object(s.p)("AttachmentCreationFailure")}logDeletionFailure(t,e){Object(s.p)("AttachmentDeletionFailure",[t],{cosmosOnlyData:JSON.stringify({attachmentId:e.attachmentId.Id})})}}function Wt(t,e,n,a){t&&t(e,n,a)}n.d(e,"a",(function(){return Bt})),n.d(e,"b",(function(){return Ht}));const zt={};function Bt(t,e,n,i,c={isInline:!1,isHiddenInline:!1,shouldShare:!1,skipProcessInlineImage:!1},u,d,f,m){if(!e)return Object(o.a)(i),Object(Rt.a)(i,"WarningFilesCanNotBeAttachedGenericError",[Object(r.b)(a.a)]),[];const h=Vt(t,e,i,u),{isInline:b,shouldShare:I}=c;return function(t,e,n){for(let a=0;a<t.length;a++){const r=t[a];Object(s.p)("AttachmentCreation",[e,n],{cosmosOnlyData:JSON.stringify({fileType:r.fileType,size:r.size,ext:Object(l.d)(r.name)||""})})}}(n,b,I),h.enqueueAttachmentCreation(n,c,d,f,m)}function Ht(t,e,n,a,r){const i=Vt(t,n,a);!function(t){const e=t.attachmentType;switch(e){case 1:Object(s.p)("AttachmentDeletion",[!0,!1,0]);break;case 0:const n=Object(d.a)(t.attachmentId);Object(s.p)("AttachmentDeletion",[!1,t.isCloudy],{cosmosOnlyData:JSON.stringify({size:n.model.Size})});break;default:Object(u.a)(e)}}(e),i.deleteAttachment(e,r)}function Vt(t,e,n,a){let r=zt[e.Id];return r||(r=function(t,e,n,a=null,r=null){return new Gt(t,e,n,a,r)}(t,e,n,i.a,c.a),zt[e.Id]=r,r.onFinishPromise.then(t=>{delete zt[e.Id],a&&a(t)})),r}},7334:function(t,e,n){"use strict";var a=n(4305),r=n(4430),i=n(4632),c=n(358),o=n(2973);e.a=Object(c.action)("addAttachmentIntoWellBeforeUpload")((function(t,e,n,c,s=null){let u;n.AttachmentId=c,Object(r.a)([{attachmentId:Object.assign(Object.assign({},n.AttachmentId),{mailboxInfo:c.mailboxInfo}),attachment:n,modelInitializationValues:s}],!1,!0,!0),Object(o.s)(t)?(e.inlineAttachments.push(t),u=!0):(t.isPlaceholderAttachment=!0,Object(i.a)(n)?e.imageViewAttachments.push(t):e.docViewAttachments.push(t)),!u&&t.isCloudy||Object(a.a)(e,n.Size)}))},7335:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var a=n(72),r=n(3758),i=n(2835),c=n(220);function o(t,e,n,a){const o=Object(c.a)()?1:0,u=Object(i.h)(),[d]=u.filter(t=>t.type===o);if(!d)throw new Error("Unable to upload file as couldnt find OneDrive provider");const{model:{EndPointUrl:l}}=d,f={fileToUpload:{fileName:t,fileBlob:e},conflictBehavior:"rename",folderInfo:s(n),onProgress:a};return[1===o?Object(r.w)(1,r.e,f):Object(r.w)(0,l,f),d]}function s(t){const{identifierType:e,identifier:n}=t;switch(e){case 0:return{type:0,identifier:n};case 1:return{type:1,identifier:n};default:return Object(a.a)(e)}}},765:function(t,e,n){"use strict";function a(t){if(!t)return t;let e=t.replace(/\+/g,"_");return e=e.replace(/\//g,"-"),e}function r(t){if(!t)return t;let e=t.replace(/_/g,"+");return e=e.replace(/-/g,"/"),e}n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return r}))},7802:function(t,e,n){"use strict";function a(t){return Object.assign({__type:"ItemAttachment:#Exchange"},t)}n.d(e,"a",(function(){return a}))},7803:function(t,e,n){"use strict";function a(t){return Object.assign({__type:"MimeContentType:#Exchange"},t)}n.d(e,"a",(function(){return a}))},8710:function(t){t.exports=JSON.parse('{"a":"ibb"}')},8711:function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var a=n(8712),r=n(2871),i=n(6),c=n(4820),o=n(2826),s=n(2767);function u(t,e,n,a){const i=[],c=[];if(t.forEach(t=>{n(t)?i.push(t):c.push(t)}),c.length>0){const t=c.map(t=>t.name).join(", "),{messageId:n,message:i}=a(t);Object(r.a)(e,n,[i])}return i}function d(t,e,n){Object(c.a)(n);let r=[];for(let e=0;e<t.length;e++)r.push(t[e]);return r=function(t,e){return u(t,e,t=>!(t.fileType===o.a.Local&&0===t.size),(function(t){return{messageId:"WarningEmptyFilesCanNotBeAttached",message:Object(i.c)(Object(i.b)(a.a),t)}}))}(r,n),e&&(r=function(t,e){return u(t,e,t=>Object(s.g)(t.name,t.type),(function(t){return{messageId:"WarningInlineImageTypeNotSupported",message:Object(i.c)(Object(i.b)(a.b),t)}}))}(r,n)),r}},8712:function(t){t.exports=JSON.parse('{"a":"ubb","b":"vbb"}')},8713:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var a=n(35),r=n(381);function i(t,e){return void 0===t.itemId||t.itemId.__type||(t.itemId=Object(r.a)(t.itemId)),Object(a.a)("CreateReferenceAttachmentFromAttachmentDataProvider",t,e)}}}]);
//# sourceMappingURL=owa.256.js.map
self.scriptsLoaded['owa.256.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.256.js'] = (new Date()).getTime();