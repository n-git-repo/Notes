self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.168.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[168,2148],{1096:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(35),i=n(1443);function o(e,t){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("GetPersona",e,t)}},1097:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"GetPersonaRequest:#Exchange"},e)}n.d(t,"a",(function(){return r}))},1098:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"GetNotesForPersonaRequest:#Exchange"},e)}n.d(t,"a",(function(){return r}))},1114:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"PersonaPropertyUpdate:#Exchange"},e)}n.d(t,"a",(function(){return r}))},1443:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"GetPersonaJsonRequest:#Exchange"},e)}n.d(t,"a",(function(){return r}))},1473:function(e,t,n){"use strict";var r=n(2);var i,o=Object(r.action)("initializeApplicationSettings",e=>({config:e}));!function(e){e[e.None=0]="None",e[e.Hx=1]="Hx",e[e.Web=2]="Web",e[e.Remote=4]="Remote",e[e.All=7]="All"}(i||(i={}));const c={Loki:{resourceUrl:"https://loki.delve.office.com/"},Analytics:{disabledDatapoints:[]},EnabledResolvers:{Query:{},Mutation:{markItemAsRead:i.Hx|i.Remote},Subscription:{}},CAPIv3:{isCAPIv3Enabled:!1}};var u=n(11);const s=()=>{const e=Object(u.a)(self,"applicationSettingOverrides");if(e)try{return JSON.parse(e)}catch(e){return{}}return{}};let a={settings:c,overrides:s(),configIDs:void 0,lastError:void 0,initialized:!1,report:void 0,searchKey:void 0};var d=Object(r.createStore)("applicationSettings",a);const f=(e,t,n)=>{const r={};let i=0;const{count:o,keys:c}=function e(t,n={}){let r=0,i=[];return Object.keys(t).forEach(o=>{const c=t[o];if("object"==typeof c&&null!==c&&!Array.isArray(c)){const{count:c,keys:u}=e(t[o],n[o]);c&&(r+=c,i.push({group:o,settings:u}))}else n.hasOwnProperty(o)||(r+=1,i.push(o))}),{count:r,keys:i}}(e,t);if(o&&(r.MissingSettings=c,i=o),i&&(r.MissingSettingsCount=i),n&&(r.LastError=n),i)return r};Object(r.mutator)(o,({config:e})=>{const t=d();if(t.initialized=!0,!e)return void(t.report={NoSettings:!0});if(!e.settings)return t.lastError=e.lastError,void(t.report={NoSettings:!0});const n={};Object.keys(c).forEach(t=>{n[t]={};const r=e.settings[t];Object.keys(c[t]).forEach(e=>{n[t][e]=r&&r.hasOwnProperty(e)?r[e]:c[t][e]})}),t.configIDs=e.configIDs,t.lastError=e.lastError,t.settings=n,t.report=f(c,e.settings,e.lastError)});var l=Object(r.action)("setApplicationSettingOverride",(e,t)=>({setting:e,value:t}));Object(r.mutator)(l,({setting:e,value:t})=>{const n=d();n.overrides=Object.assign(Object.assign({},n.overrides),{[e]:t})});var b=Object(r.action)("setApplicationSettingsSearchKey",e=>({key:e}));Object(r.mutator)(b,({key:e})=>{d().searchKey=e});var p=Object(r.action)("resetApplicationSettingOverrides");Object(r.mutator)(p,()=>{d().overrides={}});Object(r.orchestrator)(l,({setting:e,value:t})=>{((e,t)=>{const n=s();n[e]=t,Object(u.e)(window,"applicationSettingOverrides",JSON.stringify(n))})(e,t)});Object(r.orchestrator)(p,()=>{Object(u.d)(window,"applicationSettingOverrides")});var g=n(22),v=n(25);function m(e){const t=d();return t.initialized||g.d(`Attempted to read ${e} before application settings were initialized.`),Object(v.k)("fwk-devTools")?function e(t,n,r){let i={};return Object.keys(t).forEach(o=>{if("object"==typeof o&&null!==o&&!Array.isArray(o))i=Object.assign(Object.assign({},i),{[r.shift()]:e(t[o],n,r)});else{const e=[...r,o].join("."),c=n[e];i=Object.assign(Object.assign({},i),{[o]:void 0===c?t[o]:c})}}),i}(t.settings[e],t.overrides,[e]):t.settings[e]}function w(e){return d().overrides[e]}function h(){return d().report}function O(){return d().searchKey}function j(){const e=d();return e.initialized||g.d("Attempted to read settings before application settings were initialized."),e.settings}const y=new Map([["markItemAsRead","fwk-useoutlookgateway-markItemAsRead"]]);function S(e,t){return(k(e,t)&i.Hx)==i.Hx}function C(e,t){return(k(e,t)&i.Web)==i.Web}function E(e,t){return(k(e,t)&i.Remote)==i.Remote}function k(e,t){var n;const r=i.All;if(y.has(t)){let e=y.get(t);if(e)return Object(v.k)(e)?i.Hx|i.Remote:r}if(Object(v.k)("fwk-graphql-resolvers-config")&&Object(v.k)("fwk-application-settings")){const i=m("EnabledResolvers"),o=null===(n=null==i?void 0:i[e])||void 0===n?void 0:n[t];return null==o?r:o}return r}n.d(t,"f",(function(){return m})),n.d(t,"e",(function(){return w})),n.d(t,"g",(function(){return h})),n.d(t,"h",(function(){return O})),n.d(t,"d",(function(){return j})),n.d(t,"i",(function(){return o})),n.d(t,"k",(function(){return l})),n.d(t,"l",(function(){return b})),n.d(t,"j",(function(){return p})),n.d(t,"a",(function(){return S})),n.d(t,"c",(function(){return C})),n.d(t,"b",(function(){return E}))},1475:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return c}));let r=void 0;const i=new Promise(e=>{r=e});function o(e){null==r||r(e)}async function c(){return Promise.race([i,new Promise((e,t)=>{setTimeout(()=>t(),45e3)})])}},1477:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(1097),i=n(167),o=n(1096);function c(e){if(!e)return Promise.reject(new Error("GetPersonaByEmailAddress failed"));const t=Object(r.a)({EmailAddress:{EmailAddress:e}});return Object(o.a)({Header:Object(i.b)(),Body:t}).then(e=>{if(e.Body&&"NoError"===e.Body.ResponseCode)return e.Body.Persona;throw new Error("GetPersonaByEmailAddress failed")})}},1485:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(35),i=n(1098);function o(e,t){return void 0===e.getNotesForPersonaRequest||e.getNotesForPersonaRequest.__type||(e.getNotesForPersonaRequest=Object(i.a)(e.getNotesForPersonaRequest)),Object(r.a)("GetNotesForPersona",e,t)}},180:function(e,t,n){"use strict";var r=n(22);let i;function o(){return null==i&&(i="undefined"!=typeof window&&null!=window.performance&&null!=window.performance.timing&&null!=window.performance.navigation&&null!=window.performance.getEntriesByName),i}const c=500,u=[],s=[],a=[],d=[];let f,l=!0;function b(e,t){Object(r.g)((e,t,n)=>{l&&(t==r.b.Error&&s.push({message:e,error:n}),u.push({message:e,level:t}))}),e(v),t(v),o()&&(window.performance.setResourceTimingBufferSize?window.performance.setResourceTimingBufferSize(c):window.performance.webkitSetResourceTimingBufferSize&&window.performance.webkitSetResourceTimingBufferSize(c))}function p(e,t,n){f?f(e,t,n):d.push({name:e,customData:t})}function g(e){return f=e,l=!1,{traces:u,errors:s,network:a,usage:d}}function v(){l&&a.push(arguments)}n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return g})),n.d(t,"d",(function(){return p})),n.d(t,"c",(function(){return o}))},181:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,i=!1;function o(t){r--,delete e[t]}this.put=function(t,n,i,c){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==c&&"function"!=typeof c)throw new Error("Cache timeout callback must be a function");var u=e[t];u?clearTimeout(u.timeout):r++;var s={value:n,expire:i+Date.now()};return isNaN(s.expire)||(s.timeout=setTimeout(function(){o(t),c&&c(t,n)}.bind(this),i)),e[t]=s,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&o(t),n},this.clear=function(){for(var o in e)clearTimeout(e[o].timeout);r=0,e=Object.create(null),i&&(t=0,n=0)},this.get=function(o){var c=e[o];if(void 0!==c){if(isNaN(c.expire)||c.expire>=Date.now())return i&&t++,c.value;i&&n++,r--,delete e[o]}else i&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){i=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),i=Date.now(),o=n&&n.skipDuplicates;for(var c in r)if(r.hasOwnProperty(c)){if(o)if(e[c])continue;var u=r[c],s=u.expire-i;if(s<=0){this.del(c);continue}s=s>0?s:void 0,this.put(c,u.value,s)}return this.size()}}e.exports=new r,e.exports.Cache=r},211:function(e,t,n){"use strict";var r=n(930);n.d(t,"a",(function(){return r.a}))},242:function(e,t,n){"use strict";function r(e){return null==e||0==e.trim().length}n.d(t,"a",(function(){return r}))},2785:function(e,t,n){"use strict";n.d(t,"v",(function(){return o})),n.d(t,"E",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"z",(function(){return s})),n.d(t,"C",(function(){return a})),n.d(t,"D",(function(){return d})),n.d(t,"B",(function(){return f})),n.d(t,"A",(function(){return l})),n.d(t,"f",(function(){return b})),n.d(t,"i",(function(){return p})),n.d(t,"k",(function(){return g})),n.d(t,"r",(function(){return v})),n.d(t,"F",(function(){return m})),n.d(t,"w",(function(){return w})),n.d(t,"n",(function(){return h})),n.d(t,"y",(function(){return O})),n.d(t,"a",(function(){return j})),n.d(t,"q",(function(){return y})),n.d(t,"u",(function(){return S})),n.d(t,"l",(function(){return C})),n.d(t,"b",(function(){return E})),n.d(t,"s",(function(){return k})),n.d(t,"c",(function(){return A})),n.d(t,"j",(function(){return x})),n.d(t,"t",(function(){return P})),n.d(t,"o",(function(){return z})),n.d(t,"p",(function(){return R})),n.d(t,"e",(function(){return N})),n.d(t,"x",(function(){return T})),n.d(t,"h",(function(){return I})),n.d(t,"g",(function(){return B})),n.d(t,"m",(function(){return F}));var r=n(20);const i=new r.c(()=>Promise.all([n.e(0),n.e(4),n.e(5),n.e(6),n.e(15),n.e(18),n.e(19),n.e(25),n.e(36),n.e(39),n.e(73),n.e(102),n.e(128),n.e(228),n.e(250),n.e(237),n.e(317),n.e(387)]).then(n.bind(null,4417)));let o=new r.b(i,e=>e.removeExtensibilityNotification),c=new r.b(i,e=>e.updatePersistentNotifications),u=new r.b(i,e=>e.closeTaskPaneAddinCommand),s=new r.b(i,e=>e.triggerAppointmentTimeChangedEvent),a=new r.b(i,e=>e.triggerRecipientsChangedEvent),d=new r.b(i,e=>e.triggerRecurrenceChangedEvent),f=new r.b(i,e=>e.triggerLocationsChangedEvent),l=new r.b(i,e=>e.triggerAttachmentsChangedEvent),b=new r.b(i,e=>e.deinitializeAddinsForItem),p=new r.b(i,e=>e.initializeAddinsForItem),g=new r.a(i,e=>e.initializeExtensibilityContext),v=new r.b(i,e=>e.onHostItemChanged),m=new r.b(i,e=>e.whenItemHasContextualAddinKeywords),w=new r.b(i,e=>e.runContextualEvaluationAndUpdate),h=new r.b(i,e=>e.launchTranslateCommand),O=new r.b(i,e=>e.shouldForceOnSendCompliantBehavior),j=(Object(r.d)(i,e=>e.AddinBarView),Object(r.d)(i,e=>e.TaskPaneCollection)),y=new r.b(i,e=>e.onComposeClose),S=new r.b(i,e=>e.openContextualCallout),C=new r.b(i,e=>e.launchAddinCommand),E=new r.b(i,e=>e.observeAddinCommandSurfaceItems),k=new r.b(i,e=>e.onItemNavigation),A=new r.b(i,e=>e.allowItemSendEvent),x=new r.a(i,e=>e.ExecuteEntryPoint),P=new r.a(i,e=>e.onLaunchEventTriggered),z=new r.a(i,e=>e.logAppTeachingUICalloutTelemetry),R=new r.a(i,e=>e.logCustomizeActionButtonAction),N=new r.b(i,e=>e.convertRecurrenceToAddinFormat),T=new r.b(i,e=>e.seriesTimeJsonConverter);const I=new r.a(i,e=>e.highlightOverflowAddins),B=new r.a(i,e=>e.highlightCustomizeActionButton),F=new r.a(i,e=>e.launchThirdPartyOnlineMeetingProviderAddin)},2873:function(e,t,n){"use strict";var r=n(68),i=n(72),o=n(25),c=n(220),u=n(1198),s=n(107),a=n(2773),d=n(1436);function f(e){var t;const n=Object(u.g)(u.d.Bohemia);if(Object(c.a)()||!(null===(t=Object(a.a)())||void 0===t?void 0:t.AttachmentDataProviderAvailable)||!function(){switch(Object(s.a)().browser){case"Chrome":case"Firefox":case"Edge Anaheim":case"Opera":return!0;case"Safari":return"Windows"!==Object(s.c)().os&&Object(s.p)([13,1]);default:return!1}}()||!n.fluidEnabledForTenant||!n.bohemiaEnabled)return Object(u.h)().loadState!==u.b.OptionsLoaded&&Object(r.p)("FluidEnabledNotFetchedWhenChecked",{source:e},{isCore:!0}),!1;switch(e){case 0:case 1:case 5:case 7:return Object(o.k)("cmp-prague");case 2:case 6:return Object(o.k)("cmp-prague")&&Object(d.a)();case 3:return Object(o.k)("cmp-prague")&&Object(o.k)("cal-cmp-fluidCollaborativeSpace");case 4:return Object(o.k)("cmp-prague")&&Object(o.k)("outlookSpaces-fluid-asset");default:return Object(i.a)(e)}}const l="FluidCollaborativeSpace",b="fluid-agenda-downlevel-link";function p(e,t){const n=e.ownerDocument,r=null==n?void 0:n.getElementById(l),i=new URLSearchParams(t);return(null==r?void 0:r.contains(e))||"true"===(null==i?void 0:i.get(b))}function g(e){switch(e){case 1:case 5:case 0:case 4:case 7:return!1;case 3:case 6:case 2:return!0;default:return Object(i.a)(e)}}function v(e){switch(e){case 2:case 3:case 5:case 6:return!0;case 4:case 0:case 1:case 7:return!1;default:Object(i.a)(e)}}const m={0:"MailReadingPane",1:"MailCompose",5:"AgendaEditor",4:"Timestream",2:"CalendarReadingPane",3:"CalendarCompose",6:"MailCalendarCard",7:"None"};n.d(t,"e",(function(){return f})),n.d(t,"d",(function(){return p})),n.d(t,"b",(function(){return v})),n.d(t,"c",(function(){return g})),n.d(t,"a",(function(){return m}))},2975:function(e,t,n){"use strict";n.d(t,"b",(function(){return c}));var r=n(13),i=n(2);const o={signInState:0,presences:new r.ObservableMap({}),processingManualSignIn:!1,isRetrySignInAllowed:!0};let c=Object(i.createStore)("presenceStore",o);const u=c();t.a=u},3048:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2);let i=Object(r.createStore)("chatStore",{isChatCalloutShown:!1,chatProvider:0});i()},3108:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2975);function i(){return 3==r.a.signInState}},316:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return s}));var r=n(124),i=n(117),o=n(3);let c;function u(e){c=e}async function s(){var e,t;if(Object(o.P)())return i.f.importAndExecute(Object(r.a)());const n=c&&await c();if(n&&n.length>0){if("bearer"===(null===(e=null==n?void 0:n.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return n.split(" ")[1];if("msauth1.0"===(null===(t=null==n?void 0:n.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return n}}},3219:function(e,t,n){"use strict";var r=n(20),i=n(3108),o=n(3048);function c(){const e=Object(o.a)().chatProvider;return Object(i.a)()&&(3==e||4==e)}n.d(t,"c",(function(){return s})),n.d(t,"f",(function(){return a})),n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return f})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c}));const u=new r.c(()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(5),n.e(8),n.e(11),n.e(349),n.e(530)]).then(n.bind(null,19687))),s=new r.a(u,e=>e.initializeSkypeForBusiness);let a=new r.b(u,e=>e.tryRegisterForPresenceUpdates),d=new r.b(u,e=>e.startChat),f=new r.a(u,e=>e.setIsSkypeShown),l=Object(r.d)(u,e=>e.UcmaChatView)},6863:function(e,t,n){"use strict";var r=n(20),i=n(25),o=n(7774);var c=n(7775);function u(){if(Object(i.k)("me-search-global")){if(Object(i.k)("me-search-publicrelease"))return!0;if(Object(c.a)()&&o.a.isDeveloperLicense)return!0}return!1}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return u}));const s=new r.c(()=>n.e(2189).then(n.bind(null,19969))),a=new r.a(s,e=>e.initializeMessageExtension)},726:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return p}));var r=n(946),i=n(417),o=n(48),c=n(72),u=n(12);const s="email",a="personId",d="UA",f="size",l="/service.svc/s/GetPersonaPhoto";function b(e,t,n,o){if(Object(i.a)()&&Object(i.b)(t,e))return Object(r.a)(e,n);{let n=Object(u.a)().baseUrl,r="";return e&&(r=g(r,s,e&&e.toLowerCase())),t&&(r=g(r,a,t)),r=g(r,d,"0"),r=g(r,f,o?"HR96x96":"HR64x64"),`${n}${l}?${r}`}}function p(e,t,n){return Object(i.a)()?Object(r.a)(e,t):`https://cid-${e}.users.storage.live.com/users/0x${e}/myprofile/expressionprofile/profilephoto:${function(e){switch(e){case o.c.tiny:case o.c.extraExtraSmall:case o.c.extraSmall:case o.c.small:case o.c.regular:case o.c.large:case o.c.size10:case o.c.size8:case o.c.size16:case o.c.size24:case o.c.size28:case o.c.size32:return"UserTileStatic,UserTileSmall";case o.c.extraLarge:case o.c.size40:case o.c.size48:case o.c.size56:case o.c.size72:case o.c.size100:case o.c.size120:return"UserTileMedium,UserTileStatic,UserTileSmall";default:return Object(c.a)(e)}}(n)}/MeControlMediumUserTile?ck=1&ex=24&fofoff=1`}function g(e,t,n){n&&(n=encodeURIComponent(n));let r=`${t}=${n}`;return e&&(r=`${e}&${r}`),r}},7774:function(e,t,n){"use strict";t.a={isDeveloperLicense:!1}},7775:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3);function i(){return"WW"===Object(r.D)()}},930:function(e,t,n){"use strict";function r(e){return e>=200&&e<300}n.d(t,"a",(function(){return r}))},946:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(6);const i="/profile/v1.0/{0}/{1}/image/$value";function o(e,t){const n=e.indexOf("@")>-1,o="GroupMailbox"==t?"groups":"users";return Object(r.c)(i,o,n?e:`cid:${e}`)}}}]);
//# sourceMappingURL=owa.168.js.map
self.scriptsLoaded['owa.168.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.168.js'] = (new Date()).getTime();