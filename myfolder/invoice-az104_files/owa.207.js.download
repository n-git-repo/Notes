self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.207.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[207],{2768:function(t,e,o){"use strict";o.d(e,"a",(function(){return i}));var n=o(2),r=o(13);const i=Object(n.createStore)("groupsStore",{groups:new r.ObservableMap})},2794:function(t,e,o){"use strict";o.d(e,"a",(function(){return r}));var n=o(2768);function r(t){const e=Object(n.a)().groups.get(t.toLowerCase());return e?e.groupDetails:null}},2816:function(t,e,o){"use strict";var n;!function(t){t[t.None=0]="None",t[t.Executing=1]="Executing",t[t.Succeed=2]="Succeed",t[t.FailureNotice=3]="FailureNotice",t[t.FailureRetry=4]="FailureRetry"}(n||(n={})),e.a=n},2831:function(t,e,o){"use strict";o.d(e,"a",(function(){return i}));var n=o(2),r=o(13);const i=Object(n.createStore)("getGroupSiteStatusStore",{groupSiteStatus:new r.ObservableMap})},2853:function(t,e,o){"use strict";var n=o(2),r=o(13);Object(n.createStore)("personaPhotoStore",{personaPhotoUrls:new r.ObservableMap})();o(2924),o(2846);var i=o(2768),a=o(2800),s=o(2794);function u(t){const e=Object(i.a)().groups.get(t.toLowerCase());return!!e&&!e.groupDetailsError}var c=o(2867),d=o(2962),p=o(2831);const l=Object(n.mutatorAction)("updateGroupSiteAndDocumentUrl",(function(t,e,o,n){if(2==e){const e=Object(s.a)(t);Object(c.a)(e,"Site")[0].Url=o,Object(c.a)(e,"Files")[0].Url=n}}));var b=o(2956);function f(t){return t=t.toLocaleLowerCase(),Object(p.a)().groupSiteStatus.has(t)?Object(p.a)().groupSiteStatus.get(t):0}const h=t=>{const e="string"==typeof t?Object(s.a)(t):t;return e?e.ExternalDirectoryObjectId:null};o(2816),o(2946),o(2947),o(2957),o(2958);var m=o(3192),g=o(3193),O=o(3210),v=o(3179),S=o(3180),N=o(6);function C(t){const e=t.groupDetails?t.groupDetails.AccessType:t.basicInformation?t.basicInformation.AccessType:null;if(e){if(1===e)return Object(N.b)(v.a);if(3===e)return Object(N.b)(S.a)}return""}function j(t){const e=t.groupDetails?t.groupDetails.AccessType:t.basicInformation?t.basicInformation.AccessType:null;if(e){if(1===e)return Object(N.b)(O.b);if(3===e)return Object(N.b)(O.c)}return""}function w(t){let e=0;return t.members?e=t.members.totalCount:t.groupDetails&&(e=t.groupDetails.MemberCount),e?e>1?Object(N.c)(Object(N.b)(g.a),e.toString()):Object(N.c)(Object(N.b)(m.a),e.toString()):Object(N.b)(O.a)}o.d(e,"j",(function(){return i.a})),o.d(e,"l",(function(){return a.a})),o.d(e,"d",(function(){return s.a})),o.d(e,"m",(function(){return u})),o.d(e,"f",(function(){return c.a})),o.d(e,"g",(function(){return c.b})),o.d(e,"c",(function(){return d.a})),o.d(e,"i",(function(){return p.a})),o.d(e,"o",(function(){return l})),o.d(e,"n",(function(){return b.b})),o.d(e,"h",(function(){return f})),o.d(e,"e",(function(){return h})),o.d(e,"a",(function(){return C})),o.d(e,"b",(function(){return j})),o.d(e,"k",(function(){return w}))},2867:function(t,e,o){"use strict";o.d(e,"a",(function(){return r})),o.d(e,"b",(function(){return i}));var n=o(2794);const r=(t,e)=>{const o="string"==typeof t?Object(n.a)(t):t;if(!o||!o.GroupResources)return null;const r=o.GroupResources.filter(t=>t.Name===e);return!r||r.length<1?null:r},i=(t,e)=>{const o=r(t,e);return o&&0!=o.length?o[0].Url:null}},2946:function(t,e,o){"use strict";var n=o(2),r=o(2991);const i=Object(n.mutatorAction)("setFollowButtonState",(function(t,e){r.a.groupActionState.set(t.toLowerCase(),e)}));e.a=i},2947:function(t,e,o){"use strict";var n=o(2),r=o(2992);const i=Object(n.mutatorAction)("setJoinButtonState",(function(t,e){r.a.groupActionState.set(t.toLowerCase(),e)}));e.a=i},2956:function(t,e,o){"use strict";o.d(e,"b",(function(){return i}));var n=o(2),r=o(2831);const i=Object(n.mutatorAction)("setGroupSiteStatus",(function(t,e){t=t.toLocaleLowerCase(),Object(r.a)().groupSiteStatus.has(t)&&e==Object(r.a)().groupSiteStatus.get(t)||Object(r.a)().groupSiteStatus.set(t,e)}));e.a=i},2957:function(t,e,o){"use strict";o.d(e,"a",(function(){return i}));var n=o(2816),r=o(2991);function i(t){t=t.toLowerCase();const e=r.a.groupActionState;return e.has(t)?e.get(t):n.a.None}},2958:function(t,e,o){"use strict";o.d(e,"a",(function(){return i}));var n=o(2816),r=o(2992);function i(t){t=t.toLowerCase();const e=r.a.groupActionState;return e.has(t)?e.get(t):n.a.None}},2962:function(t,e,o){"use strict";o.d(e,"a",(function(){return r}));var n=o(2903);const r=()=>Object(n.a)().smtpAddress},2991:function(t,e,o){"use strict";var n=o(2),r=o(13);e.a=Object(n.createStore)("followButtonStore",{groupActionState:new r.ObservableMap})()},2992:function(t,e,o){"use strict";var n=o(2),r=o(13);e.a=Object(n.createStore)("joinButtonStore",{groupActionState:new r.ObservableMap})()},3179:function(t){t.exports=JSON.parse('{"a":"W0a"}')},3180:function(t){t.exports=JSON.parse('{"a":"V0a"}')},3192:function(t){t.exports=JSON.parse('{"a":"U0a"}')},3193:function(t){t.exports=JSON.parse('{"a":"_0a"}')},3210:function(t){t.exports=JSON.parse('{"b":"X0a","c":"Y0a","a":"Z0a"}')},3790:function(t,e,o){"use strict";var n=o(2955),r=o(2),i=Object(r.mutatorAction)("toggleIsShowingAllGroups",(function(){Object(n.b)().shouldShowAllGroups=!Object(n.b)().shouldShowAllGroups})),a=o(21),s=o(2784),u=o(68),Droppable=o(2847),c=o(1423),d=o(25),p=o(2853),l=o(154),b=o(6),f=o(3191),h=o(0),m=o(4308),g=o(4637),O=o(1),v=o(195),S=o(929),N=o(2765),C=o(2774),j=o(4526),w=o(4574);let k=class extends h.Component{constructor(){super(...arguments),this.onContextMenu=(t,e)=>{const{onContextMenu:o,groupId:n}=this.props;if(o){t.stopPropagation(),t.preventDefault();const e=n.toLowerCase(),r=Object(p.j)().groups;if(r.has(e)){o(t,r.get(e))}}},this.onDrop=t=>{this.props.onListNodeDrop&&this.props.onListNodeDrop(t,this.props.groupId)},this.renderGroupFolderChildren=()=>this.props.renderGroupFolderChildren?this.props.renderGroupFolderChildren(this.props.groupId):null,this.getChevronProps=()=>{if(this.props.groupListNodeChevronProps)return this.props.groupListNodeChevronProps(this.props.groupId)}}shouldComponentUpdate(t,e){return!Object(v.e)(this.props,t)}render(){const t=Object(j.a)(this.props.groupId);return h.createElement(Droppable.b,{dropViewState:t.drop,onDrop:this.onDrop,canDrop:this.props.canDropOnListNode},h.createElement(w.a,{selectGroup:this.props.selectGroup,isSelected:this.props.isSelected,renderRightCharm:this.props.renderRightCharm,renderRightCharmHover:this.props.renderRightCharmHover,chevronProps:Object(d.k)("grp-loadFolders")?this.getChevronProps():null,customIcon:Object(d.k)("grp-loadFolders")?"Group":null,displayName:this.props.displayName,groupId:this.props.groupId,isDroppedOver:t.drop.isDragOver,onContextMenu:this.onContextMenu,renderCustomTreeNodeDisplay:null,customData:this.props.customData,showHoverStateOnDroppedOver:t.drop.draggableItemType==N.a.MailListRow||t.drop.draggableItemType==N.a.MultiMailListMessageRows,isFavorited:Object(d.k)("nh-boot-acctmonaccounts")&&Object(l.a)("acctmonaccounts")&&Object(C.isGroupInFavorites)(this.props.groupId)}),Object(d.k)("grp-loadFolders")&&this.renderGroupFolderChildren())}};k=Object(O.__decorate)([S.observer],k);var D=k;const y=Object(p.j)(),G=Object(n.b)();var A=Object(a.a)((function(t){var e,o,r;const a=h.useRef(!1),p=e=>h.createElement(D,{selectGroup:t.selectGroup,isSelected:t.isSelected,renderRightCharm:t.renderRightCharm,renderRightCharmHover:t.renderRightCharmHover,displayName:e.DisplayName,groupId:e.SmtpAddress,key:e.SmtpAddress,onContextMenu:t.onChildNodeContextMenuOpened,customData:t.customData,onListNodeDrop:t.onListNodeDrop,canDropOnListNode:t.canDropOnListNode,renderGroupFolderChildren:t.renderGroupFolderChildren,groupListNodeChevronProps:t.groupListNodeChevronProps}),O=e=>{e.stopPropagation(),t.toggleGroupTreeExpansion()},v=!(Object(d.k)("nh-boot-acctmonaccounts")&&Object(l.a)("acctmonaccounts")),S=e=>{const{onRootNodeContextMenuOpened:o}=t;o&&(e.stopPropagation(),e.preventDefault(),o(e))},N=e=>!(G.shouldShowAllGroups||!t.canDropOnListNode)&&t.canDropOnListNode(e),C=t=>{a.current=!0,setTimeout(()=>{a.current&&!Object(n.b)().shouldShowAllGroups&&k()},1e3)},j=()=>{a.current=!1},w=t=>{t.stopPropagation(),k()},k=()=>{const e=G.myOrgGroups.length;Object(u.p)("GroupList_ToggleShouldShowAllGroups",{isShowMore:!G.shouldShowAllGroups,joinedGroupCount:e>=21?"21+":e}),t.onShowMoreEvent&&t.onShowMoreEvent(),i()},A=G.myOrgGroups,I={role:s.a.tree},R=t.isGroupsTreeCollapsed;return h.createElement("div",Object.assign({style:t.style,className:t.className},Object(s.b)(I)),(e=>{const o={isExpanded:!e,onClick:O};return h.createElement(f.a,{chevronProps:o,depth:0,displayName:Object(b.b)(g.a),isRootNode:v,key:"Groups_root",onClick:o.onClick,onContextMenu:S,renderRightCharm:t.renderRootNodeRightCharm,renderRightCharmHover:t.renderRootNodeRightCharmHover,setSize:t.setSize,positionInSet:t.positionInSet})})(R),((t,e)=>{const o=[];if(e)return o;if(G.shouldShowAllGroups){const e=[];t.forEach(t=>{const o=y.groups.get(t);e.push(o)}),e.sort((t,e)=>t.basicInformation.DisplayName.localeCompare(e.basicInformation.DisplayName)).forEach(t=>{o.push(p(t.basicInformation))})}else t.slice(0,m.a).forEach(t=>{const e=y.groups.get(t);o.push(p(e.basicInformation))});return o})(A,R),G.withContextMenuGroup&&(G.withContextMenuGroup.isRootNode?null===(e=t.renderRootNodeContextMenu)||void 0===e?void 0:e.call(t,G.withContextMenuGroup):null===(o=t.renderChildNodeContextMenu)||void 0===o?void 0:o.call(t,G.withContextMenuGroup)),A.length>m.a&&(e=>{if(e)return null;const o=G.shouldShowAllGroups?Object(b.b)(g.b):Object(b.b)(g.c),n=Object(c.a)();return h.createElement(Droppable.b,{dropViewState:n,onDrop:x,canDrop:N,onDragOver:C,onDragLeave:j},h.createElement(f.a,{displayName:o,isCustomActionNode:!0,isRootNode:!1,key:"groupsCollapseExpandNode",onClick:w,onContextMenu:M,onMouseEnter:t.onMouseEnterShowMoreButton}))})(R),null===(r=t.renderGroupListCustomNodes)||void 0===r?void 0:r.call(t))}));function x(){}function M(t){t.stopPropagation(),t.preventDefault()}o.d(e,"c",(function(){return n.a})),o.d(e,"b",(function(){return n.b})),o.d(e,"a",(function(){return A}))},4308:function(t,e,o){"use strict";o.d(e,"a",(function(){return n})),o.d(e,"b",(function(){return r}));const n=5,r=100},4526:function(t,e,o){"use strict";var n=o(2955),r=o(2929),i=o(1423),a=o(2),s=Object(a.mutatorAction)("setGroupNodeViewStateMutator",(function(t,e){Object(n.b)().groupNodeViewStates.set(t,e)}));function u(t){return Object(n.b)().groupNodeViewStates.has(t)||s(t,{drag:Object(r.a)(),drop:Object(i.a)(),isDroppingMessage:!1}),Object(n.b)().groupNodeViewStates.get(t)}o.d(e,"a",(function(){return u}))},4637:function(t){t.exports=JSON.parse('{"a":"a1a","b":"b1a","c":"c1a"}')},5056:function(t,e,o){"use strict";o.d(e,"a",(function(){return i})),o.d(e,"b",(function(){return a})),o.d(e,"c",(function(){return s}));var n=o(20);const r=new n.c(()=>o.e(1359).then(o.bind(null,9701)));let i=new n.b(r,t=>t.addMarkAsReadDiagnostics),a=new n.b(r,t=>t.addUnreadCountNotificationDiagnostics),s=new n.b(r,t=>t.addUnreadCountSubscriptionDiagnostics)},5370:function(t,e,o){"use strict";function n(t){return Object.assign({__type:"SubscriptionParameters:#Exchange"},t)}o.d(e,"a",(function(){return n}))},7768:function(t,e,o){"use strict";var n=o(2),r=o(2768);e.a=Object(n.mutatorAction)("UPDATE_GROUP_UNREAD_COUNT",(function(t,e){let o=Object(r.a)().groups.get(t.toLowerCase());o&&(o.unreadMessageCount=e)}))},7986:function(t,e,o){"use strict";var n=o(595);const r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"subscribeToUnreadCountNotifications"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subscriptionId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxSmtpAddress"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"subscribeToUnreadCountNotifications"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"subscriptionId"},value:{kind:"Variable",name:{kind:"Name",value:"subscriptionId"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxSmtpAddress"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxSmtpAddress"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"EventType"}},{kind:"Field",name:{kind:"Name",value:"NotificationId"}},{kind:"Field",name:{kind:"Name",value:"UnreadCount"}},{kind:"Field",name:{kind:"Name",value:"BrokerSubscriptionId"}}]}}]}}]};var i=o(7768),a=o(5056);var s=o(22),u=o(937),c=o(5370),d=o(68),p=o(25);o.d(e,"a",(function(){return f})),o.d(e,"b",(function(){return h}));const l={},b={};async function f(t){const e=(await u.b.import())(),o=Object(c.a)({NotificationType:"UnreadCountNotification",ChannelId:e,MailboxId:t}),f={subscriptionId:m(t),requiresExplicitSubscribe:!0,subscriptionParameters:o};if(function(t){return!l[t]}(t)){const e=Object(n.a)().subscribe({query:r,variables:{subscriptionId:m(t),mailboxSmtpAddress:t}}),o={notificationSubscription:f,firstNotificationReceived:!1,unreadCountDataPoint:new d.b("UnreadCountNotification",{logEvery:Object(p.k)("ring-dogfood")?1:20})};l[t]=o,a.c.import().then(e=>e(t,f,!1));const u=e.subscribe({next:t=>(function(t,e){if("QueryResultChanged"===t.EventType){const o=t.id.replace("UnreadCountNotification_","");Object(i.a)(o.toLowerCase(),t.UnreadCount),e&&(e.firstNotificationReceived||(e.unreadCountDataPoint.end(),e.unreadCountDataPoint=null,e.firstNotificationReceived=!0)),a.b.import().then(e=>e(o,t))}})(t.data.subscribeToUnreadCountNotifications,l[function(t){return t.replace("UnreadCountNotification_","")}(t.data.subscribeToUnreadCountNotifications.id)]),error:t=>{s.h.info(`unread count notification error ${t}`)}});return b[t]=u,u}return b[t]}function h(t){t=t.toLowerCase();const e=b[t];if(e){const o=l[t];e.unsubscribe(),delete b[t],delete l[t],a.c.import().then(e=>e(t,o.notificationSubscription,!0))}}function m(t){return"UnreadCountNotification_"+t}}}]);
//# sourceMappingURL=owa.207.js.map
self.scriptsLoaded['owa.207.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.207.js'] = (new Date()).getTime();