self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.1137.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[1137,2148],{11750:function(e,t,n){"use strict";n.r(t);var i=n(11);const o="ocpsfeedbackenabled",c="ocpsnpssurveyenabled",r="ocpsemailcollectionenabled",s="ocpspoliciesexpiration",a="ocpsscreenshotenabled",u="ocpslogcollectionenabled",l="ocpsoutlookrecommendationenabled",d="office16;L_SendFeedback",f="office16;L_EmailCollection",w="office16;L_SendSurvey",b="office16;L_Screenshot",h="office16;L_LogCollection",p="outlk16;L_RecommendOutlookExtension",O="CheckIn-Interval";var j=n(159),v=n(398);const k="https://clients.config.office.net/";const m="https://clients.config.office.net/user/v1.0/web/policies";async function y(){let e=await async function(){let[e,t]=Object(v.getAccessTokenforResourceAsLazy)(k,"OwaOcpsPolicy");return e||(e=await t),e}(),t=new Headers;t.append("Content-Type","application/json; charset=utf-8"),t.append("Authorization",`Bearer ${e}`),t.append("x-Cid",Object(j.a)());let n={method:"GET"};return n.headers=t,fetch(m,n)}var g=n(5);let T;const C=204;async function S(){return T||(T=async function(){var e,t;let n="";Object(i.b)(window,s)&&(n=Object(i.a)(window,s));if(!n||Object(g.Ub)("UTC")>Object(g.Ub)("UTC",new Date(n).toISOString())){let n;try{n=await y()}catch(e){return void x()}if(n.status===C)return void x();{let j=n.headers.has(O)?n.headers.get(O):"90",v=await n.json(),k=Object(g.Ub)("UTC",(new Date).toISOString());j&&Object(i.e)(window,s,Object(g.h)(k,parseInt(j)).toString()),(null===(t=null===(e=null==v?void 0:v.value)||void 0===e?void 0:e[0])||void 0===t?void 0:t.policiesPayload.length)>0&&v.value[0].policiesPayload.forEach(e=>{e.settingId==d&&Object(i.e)(window,o,e.value),e.settingId==f&&Object(i.e)(window,r,e.value),e.settingId==w&&Object(i.e)(window,c,e.value),e.settingId==b&&Object(i.e)(window,a,e.value),e.settingId==h&&Object(i.e)(window,u,e.value),e.settingId==p&&Object(i.e)(window,l,e.value)})}}return}()),T}function x(){Object(i.e)(window,o,"1"),Object(i.e)(window,r,"0"),Object(i.e)(window,c,"1"),Object(i.e)(window,a,"0"),Object(i.e)(window,l,"1")}var L=n(220),R=n(25);async function E(){return!(!Object(L.a)()&&Object(R.k)("ocps-policy-check"))||!(!Object(i.c)(window)||(await S(),!Object(i.b)(window,o)))&&"1"==Object(i.a)(window,o)}async function N(){return!(!Object(L.a)()&&Object(R.k)("ocps-policy-check"))||!(!Object(i.c)(window)||(await S(),!Object(i.b)(window,c)))&&"1"==Object(i.a)(window,c)}async function P(){return!(!Object(L.a)()&&Object(R.k)("ocps-policy-check"))||(!Object(i.c)(window)||(await S(),!Object(i.b)(window,l))||"1"==Object(i.a)(window,l))}async function I(){return!(!Object(L.a)()&&Object(R.k)("ocps-policy-check"))||!(!Object(i.c)(window)||(await S(),!Object(i.b)(window,a)))&&"1"==Object(i.a)(window,a)}async function D(){return!(!Object(L.a)()&&Object(R.k)("ocps-policy-check"))||!(!Object(i.c)(window)||(await S(),!Object(i.b)(window,r)))&&"1"==Object(i.a)(window,r)}async function z(){return!(!Object(L.a)()&&Object(R.k)("ocps-policy-check"))||!(!Object(i.c)(window)||(await S(),!Object(i.b)(window,u)))&&"1"==Object(i.a)(window,u)}n.d(t,"isFeedbackPolicyEnabled",(function(){return E})),n.d(t,"isNpsSurveyPolicyEnabled",(function(){return N})),n.d(t,"isOutlookRecommendationEnabled",(function(){return P})),n.d(t,"isScreenshotPolicyEnabled",(function(){return I})),n.d(t,"isContactPolicyEnabled",(function(){return D})),n.d(t,"isContentPolicyEnabled",(function(){return z}))},124:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c}));var i=n(46);function o(){let e=Object(i.b)(),t=e.origin;return t||(t=e.protocol+"//"+e.hostname+(e.port?":"+e.port:"")),t}function c(){return o()+"/"}},180:function(e,t,n){"use strict";var i=n(22);let o;function c(){return null==o&&(o="undefined"!=typeof window&&null!=window.performance&&null!=window.performance.timing&&null!=window.performance.navigation&&null!=window.performance.getEntriesByName),o}const r=500,s=[],a=[],u=[],l=[];let d,f=!0;function w(e,t){Object(i.g)((e,t,n)=>{f&&(t==i.b.Error&&a.push({message:e,error:n}),s.push({message:e,level:t}))}),e(p),t(p),c()&&(window.performance.setResourceTimingBufferSize?window.performance.setResourceTimingBufferSize(r):window.performance.webkitSetResourceTimingBufferSize&&window.performance.webkitSetResourceTimingBufferSize(r))}function b(e,t,n){d?d(e,t,n):l.push({name:e,customData:t})}function h(e){return d=e,f=!1,{traces:s,errors:a,network:u,usage:l}}function p(){f&&u.push(arguments)}n.d(t,"a",(function(){return w})),n.d(t,"b",(function(){return h})),n.d(t,"d",(function(){return b})),n.d(t,"c",(function(){return c}))},181:function(e,t,n){"use strict";function i(){var e=Object.create(null),t=0,n=0,i=0,o=!1;function c(t){i--,delete e[t]}this.put=function(t,n,o,r){if(void 0!==o&&("number"!=typeof o||isNaN(o)||o<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==r&&"function"!=typeof r)throw new Error("Cache timeout callback must be a function");var s=e[t];s?clearTimeout(s.timeout):i++;var a={value:n,expire:o+Date.now()};return isNaN(a.expire)||(a.timeout=setTimeout(function(){c(t),r&&r(t,n)}.bind(this),o)),e[t]=a,n},this.del=function(t){var n=!0,i=e[t];return i?(clearTimeout(i.timeout),!isNaN(i.expire)&&i.expire<Date.now()&&(n=!1)):n=!1,n&&c(t),n},this.clear=function(){for(var c in e)clearTimeout(e[c].timeout);i=0,e=Object.create(null),o&&(t=0,n=0)},this.get=function(c){var r=e[c];if(void 0!==r){if(isNaN(r.expire)||r.expire>=Date.now())return o&&t++,r.value;o&&n++,i--,delete e[c]}else o&&n++;return null},this.size=function(){return i},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){o=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var i=e[n];t[n]={value:i.value,expire:i.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var i=JSON.parse(t),o=Date.now(),c=n&&n.skipDuplicates;for(var r in i)if(i.hasOwnProperty(r)){if(c)if(e[r])continue;var s=i[r],a=s.expire-o;if(a<=0){this.del(r);continue}a=a>0?a:void 0,this.put(r,s.value,a)}return this.size()}}e.exports=new i,e.exports.Cache=i},316:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return a}));var i=n(124),o=n(117),c=n(3);let r;function s(e){r=e}async function a(){var e,t;if(Object(c.P)())return o.f.importAndExecute(Object(i.a)());const n=r&&await r();if(n&&n.length>0){if("bearer"===(null===(e=null==n?void 0:n.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return n.split(" ")[1];if("msauth1.0"===(null===(t=null==n?void 0:n.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return n}}},430:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(89);function o(e){return Object(i.a)(e,[i.c])}},462:function(e,t,n){"use strict";class i{constructor(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}add(e){this.taskList.unshift(e),this.scheduleTask()}clear(){this.taskList.splice(0,this.taskList.length)}canRunMoreTasks(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0}scheduleTask(){this.canRunMoreTasks()&&setTimeout(()=>{this.tryRunTask()},this.taskDelay)}onTaskComplete(){this.numberOfTasksRunning--,this.scheduleTask()}tryRunTask(){if(this.canRunMoreTasks()){let e=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(e).then(()=>{this.onTaskComplete()}).catch(()=>{this.onTaskComplete()}),this.scheduleTask()}}}n.d(t,"a",(function(){return i}))}}]);
//# sourceMappingURL=owa.1137.js.map
self.scriptsLoaded['owa.1137.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.1137.js'] = (new Date()).getTime();