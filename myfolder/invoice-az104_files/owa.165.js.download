self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.165.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[165],{3137:function(e,t,n){"use strict";var r;!function(e){e[e.Email=0]="Email",e[e.Files=1]="Files",e[e.Calendar=2]="Calendar",e[e.Members=3]="Members"}(r||(r={})),t.a=r},3138:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(3046),o=n(3288),c=n(2733),a=n(2751),i=n(3294);function s(e,t,n,s,u,l,d){const b=u||"All",f=d||Object(o.a)(e),O=null==s?function(e){if("inbox"!==Object(a.a)(e))return-1;if(!Object(i.a)())return-1;return 0}(e):s;let j;switch(t){case 0:j=Object(r.e)(e,Object(c.T)(n));break;case 1:j=Object(r.f)()}return{folderId:e,focusedViewFilter:O,listViewType:t,viewFilter:b,sortBy:f,requestShapeName:j,type:0,categoryName:l,scenarioType:n}}},3177:function(e,t,n){"use strict";n.d(t,"b",(function(){return s}));var r=n(3449),o=n(2733),c=n(2844),a=n(4173),i=n(358);t.a=Object(i.action)("onInitialTableLoadComplete")((function(e,t,n,i){if(e.isLoading=!1,e.isInitialLoadComplete=!0,!i)if(t){e.loadErrorStatus=0;const t=e.selectedRowKeys.size>0;0!=e.tableQuery.type&&2!=e.tableQuery.type||(t||e!=Object(o.I)()||Object(r.a)(e),a.b.importAndExecute(e,10)),Object(c.d)(e)}else s(e,n)}));let s=Object(i.action)("setTableViewErrorState")((function(e,t){switch(t){case"ErrorAccessDenied":e.loadErrorStatus=1;break;case"UnexpectedClientError":e.loadErrorStatus=2;break;default:e.loadErrorStatus=3}}))},3294:function(e,t,n){"use strict";var r=n(30);function o(){var e;return!!(null===(e=Object(r.a)().UserOptions)||void 0===e?void 0:e.IsFocusedInboxEnabled)}n.d(t,"a",(function(){return o}))},3317:function(e,t,n){"use strict";var r=n(2844),o=n(3177),c=n(3495),a=n(2790),i=n(3324),s=n(3137),u=n(4522),l=n(4087),d=n(68),b=n(3449),f=n(3509),O=n(4455),j=n(2733),w=n(2);function v(e,t,n,r,o){m(e),Object(b.a)(e,"FolderNodeClick"==n);const c=0==e.tableQuery.type;Object(O.a)(e);const a=e.tableQuery.scenarioType;if(c){const t=Object(d.r)(e=>"SwitchMailFolder"==e.eventName);t&&(t.addCustomProperty("isCached",e.isInitialLoadComplete),t.addCustomProperty("scenario",a))}if(c&&e.isInitialLoadComplete&&Object(j.V)(e.tableQuery.folderId))return Promise.resolve();const i="spotlight"===a?f.i.importAndExecute(n):Object(l.a)(e,!1,t,r,o);return e.isInitialLoadComplete?Promise.resolve():i}const m=Object(w.mutatorAction)("setCurrentLoadedIndex",e=>{e.currentLoadedIndex=Math.min(r.b,e.rowKeys.length)});var p=n(2920);var h=n(3450),y=n(2978),I=n(2742),g=n(4239),C=n(3261),T=n(3020);var S=n(2892),F=n(595);function E(e,t,n,l,b,f,O,j){const w=Object(y.a)(),m=Object(r.c)(e);e=m.tableQuery,V(m.id);let E,R=[];switch(w&&(R=[...w.selectedRowKeys.keys()],g.a.clear(),Object(S.i)(w,I.b.Reset,"FolderNodeClick"==n)),e.type){case 1:E=c.d.importAndExecute(m,o.a,h.a,n,t,void 0,f,O,j);break;case 2:E=function(e,t,n){const r=Object(d.r)(e=>e.eventName==p.j||e.eventName==p.k),o=i.a.navigationButtonSelected;if(r){r.addCustomProperty("GroupModule",s.a[o]);const t=Object(a.b)(e.tableQuery);if(Object(u.d)(t)){const e=Object(u.a)();r.addCustomProperty("TimeSinceWarmUp",Date.now()-e)}}let c=Promise.resolve();return o===s.a.Email&&(c=v(e,t,n)),c}(m,o.a,n);break;case 3:E=function(e,t,n){const r=i.a.navigationButtonSelected;let o=Promise.resolve();return r===s.a.Email&&(o=v(e,t,n)),o}(m,o.a,n);break;case 0:E=v(m,o.a,n,l,b||Object(F.c)("ltvftq"));break;default:throw new Error("UnsupportedTableQueryType")}return w&&async function(e,t,n){if(0===t.tableQuery.type&&T.a.clearMapForFolder(t.serverFolderId),(await C.e.import())(e,t,n),1===t.tableQuery.type&&t.id!==n.id){const e=Object(d.r)();Object(c.a)(t,e)}}(R,w,m),E}n.d(t,"a",(function(){return E}));const V=Object(w.mutatorAction)("setSelectedTableViewId",e=>{j.Z.selectedTableViewId=e})},3324:function(e,t,n){"use strict";var r=n(2),o=n(3137);t.a=Object(r.createStore)("commandBarStore",{navigationButtonSelected:o.a.Email,hidden:!1})()},3330:function(e,t,n){"use strict";var r=n(2);const o=Object(r.createStore)("focusedInboxRollupStore",{uniqueSenders:null,unseenCountToDisplay:null,viewType:0})();t.a=o},3449:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2);const o=Object(r.action)("INIT_TABLE_SELECTION_ON_LOAD",(e,t)=>({tableView:e,isUserNavigation:t}))},3450:function(e,t,n){"use strict";var r=n(2844),o=n(3012),c=n(2733),a=n(358),i=n(25);t.a=Object(a.action)("onLoadInitialRowsSucceeded")((function(e,t,n,a,s){(2==e.tableQuery.type||Object(i.k)("grp-loadFolders")&&3==e.tableQuery.type)&&s&&(e.serverFolderId=s.Id),a&&(e.serverFolderId=a.Id);const u=Object(c.f)(e);Object(o.h)(t,e,n,u,e.isInitialLoadComplete,"MergeOnInitialRowsFetch"),e.currentLoadedIndex=Math.min(r.b,e.rowKeys.length)}))},3495:function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return s}));var r=n(20);const o=new r.c(()=>Promise.all([n.e(15),n.e(35),n.e(63),n.e(118),n.e(592)]).then(n.bind(null,6460)));let c=new r.a(o,e=>e.loadSearchTable),a=new r.a(o,e=>e.cleanSearchTableState).importAndExecute,i=new r.b(o,e=>e.loadMoreFindItemSearch),s=new r.b(o,e=>e.loadMoreSubstrateSearch)},3653:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("REMOVE_ROWS_FROM_LISTVIEW_STORE",(e,t,n,r=!0)=>({rowKeys:e,tableView:t,actionType:n,shouldRemoveFromAllTables:r}))},3677:function(e,t,n){"use strict";var r=n(20),o=n(6),c=n(2988),a=n(2948),i=n(710),s=n(1089),u=n(30),l=n(22),d=n(358),b=n(35);function f(e,t){var n;return void 0===e||e.__type||(n=e,e=Object.assign({__type:"GetFolderChangeDigestRequest:#Exchange"},n)),Object(b.a)("GetFolderChangeDigest",e,t)}const O=10;var j=n(3330);const w=99;var v=Object(d.action)("getFolderChangeDigestAction")((function(e,t){const n=0==e.focusedViewFilter,r=n?1:2,d=Object(u.a)().ViewStateConfiguration,b=n?d.FocusedViewWatermark:d.ClutterViewWatermark;j.a.viewType=r,function(e,t,n,r){return f({Folders:[{FolderId:e,IsConversationView:r,ViewType:t,Watermark:n}],MaxSendersCount:O}).then(e=>e)}(Object(s.a)({BaseFolderId:Object(i.a)({Id:e.folderId})}),r,b,0==Object(a.b)(e.folderId)).then(e=>{t&&t!==Object(c.a)().selectedAccountSourceId||function(e){if(null==e.Folders||0==e.Folders.length)return void l.h.info("GetFolderChangeDigestResponse.Folders is null or empty");const t=e.Folders[0],n=t.RecentUniqueSenders||[];j.a.uniqueSenders=n.join("; ").toString(),j.a.unseenCountToDisplay=function(e){if(0===e)return null;if(e>w)return Object(o.c)("{0}+",w);return e.toString()}(t.UnseenCount)}(e)})}));var m=n(4573);function p(e,t){let n;const r=Object(a.b)(t);switch(e){case 1:n=0==r?Object(o.b)(m.a):Object(o.b)(m.b);break;case 2:n=0==r?Object(o.b)(m.c):Object(o.b)(m.d)}return n}var h=n(547),y=n(66),I=n(2);const g=Object(I.action)("updateWatermarksAndResetRollup",(e,t)=>Object(y.b)({name:"TnS_ResetFocusedOtherRollup",customData:[t,e]},{focusedViewFilterToSelect:e}));Object(I.orchestrator)(g,e=>{const t=new Date(Date.now()).toUTCString();Object(h.a)(e=>{e.ViewStateConfiguration.FocusedViewWatermark=t,e.ViewStateConfiguration.ClutterViewWatermark=t},[{key:"FocusedViewWatermark",valuetype:"String",value:[t]},{key:"ClutterViewWatermark",valuetype:"String",value:[t]}],"OWA.ViewStateConfiguration")}),Object(I.mutator)(g,()=>{j.a.uniqueSenders=null,j.a.unseenCountToDisplay=null,j.a.viewType=0});var C=g,T=n(3573);n.d(t,"b",(function(){return v})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return C})),n.d(t,"a",(function(){return j.a}));const S=new r.c(()=>n.e(931).then(n.bind(null,20156)));Object(r.f)(T.a,S,e=>e.resetFocusedInboxOrchestrator)},3726:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("DELETE_FOLDER_STORE_UPDATE",e=>({folderIds:e}))},3856:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(154);function o(){return Object(r.a)("multiSortTableCaching")}},3883:function(e,t,n){"use strict";var r=n(20);const o=new r.c(()=>n.e(816).then(n.bind(null,19853))),c=new r.a(o,e=>e.subscribeToRowNotifications),a=new r.a(o,e=>e.unsubscribeToRowNotifications);var i=n(3163),s=n(3726),u=n(3077),l=n(3117),d=n(4174),b=n(3285),f=n(4175),O=n(3275),j=n(4265),w=n(4456),v=n(3653),m=n(3545),p=n(2),h=n(2733);Object(p.orchestrator)(v.a,e=>{const{rowKeys:t,tableView:n,actionType:r,shouldRemoveFromAllTables:o}=e,c=n.id,a=t.filter(e=>n.rowKeys.indexOf(e)>=0);if(0==a.length)return;const i=Object(h.D)(a,c);if(Object(w.a)(a,n,r),"All"==Object(h.Q)(n)&&o){const e=Object(m.a)(n.tableQuery.folderId,!1),t=Object(h.n)(n);e.forEach(e=>{if(c==e.id||t!==Object(h.n)(e))return;const n=Object(h.F)(i,e);0!=n.length&&Object(w.a)(n,e,r)})}});function y(e,t){if(!t||0==t.length)return e;const n=[];return t.forEach(e=>{n.push(e)}),e.forEach(e=>{-1===t.indexOf(e)&&n.push(e)}),n}function I(e,t){return t&&0!=t.length?(e.forEach(e=>{const n=t.indexOf(e);-1!==n&&t.splice(n,1)}),0===t.length&&(t=void 0),t):t}var g=n(4571),C=n(2742);Object(p.mutator)(g.a,e=>{const{conversationRowKeys:t,tableViewId:n,categoriesToAdd:r,categoriesToRemove:o,clearCategories:c}=e;t.forEach(e=>{r&&function(e,t,n){const r=Object(h.M)(e,t);r.categories=y(n,r.categories);const o=Object(h.L)().tableViews.get(t);h.b.getItemIds(e,o).forEach(e=>{const t=Object(C.v)(e);t&&(t.Categories=y(n,t.Categories))})}(e,n,r),o&&function(e,t,n){const r=Object(h.M)(e,t);r.categories=I(n,r.categories);const o=Object(h.L)().tableViews.get(t);h.b.getItemIds(e,o).forEach(e=>{const t=Object(C.v)(e);t&&(t.Categories=I(n,t.Categories))})}(e,n,o),c&&function(e,t){Object(h.M)(e,t).categories=void 0;const n=Object(h.L)().tableViews.get(t);h.b.getItemIds(e,n).forEach(e=>{const t=Object(C.v)(e);t&&(t.Categories=void 0)})}(e,n)})});var T=n(4572);Object(p.mutator)(T.a,e=>{const{itemIds:t,categoriesToAdd:n,categoriesToRemove:r,clearCategories:o}=e;t.forEach(e=>{const t=Object(C.v)(e);n&&(t.Categories=y(n,t.Categories),function(e,t){const n=Object(m.a)(e.ParentFolderId.Id,!0);for(const r of n)if(Object(h.R)(r)){const n=e.ConversationId.Id,o=Object(h.F)([n],r);if(0===o.length)continue;o.forEach(e=>{const n=Object(h.M)(e,r.id);n.categories=y(t,n.categories)})}}(t,n)),r&&(t.Categories=I(r,t.Categories),t.Categories||(t.Categories=[])),o&&(t.Categories=[])})});const S=new r.c(()=>n.e(1181).then(n.bind(null,19790)));Object(r.f)(O.a,S,e=>e.markItemsAsReadStoreUpdateOrchestrator),Object(r.f)(f.a,S,e=>e.markItemsAsPinnedStoreUpdateOrchestrator),Object(r.f)(b.a,S,e=>e.markConversationsAsReadStoreUpdateOrchestrator),Object(r.f)(d.a,S,e=>e.markConversationsAsPinnedStoreUpdateOrchestrator),Object(r.f)(u.a,S,e=>e.deleteItemsStoreUpdateOrchestrator),Object(r.f)(i.a,S,e=>e.deleteConversationStoreUpdateOrchestrator),Object(r.f)(s.a,S,e=>e.deleteFolderStoreUpdateOrchestrator),Object(r.f)(l.a,S,e=>e.markAllAsReadOrchestrator),Object(r.f)(j.a,S,e=>e.updateCategoriesInViewOrchestrator);const F=new r.a(S,e=>e.removeTableFromStore);function E(e){c.importAndExecute(e)}function V(e){a.importAndExecute(e),F.importAndExecute(e)}n.d(t,"a",(function(){return E})),n.d(t,"b",(function(){return V}))},3885:function(e,t,n){"use strict";var r=n(3317),o=n(3177),c=n(4457),a=n(2866),i=n(2);Object(i.orchestrator)(a.d,async e=>{const{searchTableQuery:t,searchEndToEndPerformanceDatapoint:n,actionSource:o,onAnswerResponseReceived:a,substrateAnswerRequest:i,substrateAnswersClientFlights:s}=e;await Object(r.a)(t,n,o,void 0,void 0,a,i,s),n.end(),Object(c.a)(t)});var s=n(2740);var u=n(2844),l=n(3399),d=n(4454),b=n(2742),f=n(2892);const O=e=>{const t=e.actionSource,n=e.row,o=e.searchTableQuery,c=e.referenceId,a=e.traceId,i=e.itemPartId,O=Object(u.c)(o);l.a.clear(O),l.a.addRow(0,n,O),Object(r.a)(o,null,t);const j={referenceKey:c,index:0,traceId:a};if(Object(d.a)(n.InstanceKey,O,j),Object(f.q)(O,O.rowKeys[0],!1,b.b.SearchSuggestionClick),0==o.listViewType&&i){const e=function(e,t){if(s.a.conversations.has(e)){const n=s.a.conversations.get(e);for(const e of n.conversationNodeIds){const n=s.a.conversationNodes.get(e);for(const r of n.itemIds)if(r==t)return e}}return null}(n.ConversationId.Id,i),t=Object(s.b)().conversations.get(n.ConversationId.Id),r=t?t.conversationNodeIds:[];Object(f.a)(e,i,r,O,b.b.MailListItemExpansion)}};Object(i.orchestrator)(a.c,e=>{O(e)});var j=n(3138),w=n(2978),v=n(3677),m=n(2819);Object(i.orchestrator)(u.e,async e=>{const t=e.focusedViewFilter,n=Object(w.a)();Object(v.d)(t,"NonUserAction");const o=Object(j.a)(n.tableQuery.folderId,n.tableQuery.listViewType,"mail",t,null,null,null),c=await Object(r.a)(o);return m.b.importAndExecute(),c});var p=n(3495),h=n(2915);Object(i.orchestrator)(h.a,()=>{p.d.import()});var y=n(4176),I=n(20);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return o.b}));const g=new I.c(()=>n.e(857).then(n.bind(null,20180)));Object(I.f)(y.a,g,e=>e.onListViewTypeOptionSavedOrchestrator)},4029:function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return d}));var r=n(3288),o=n(3138),c=n(2948),a=n(1084),i=n(3294);function s(){const e=Object(a.a)("inbox"),t=Object(c.b)(e),n=Object(r.a)(e);return Object(o.a)(e,t,"mail",-1,null,null,n)}function u(){let e=s();return e.focusedViewFilter=0,e}function l(){let e=s();return e.focusedViewFilter=1,e}function d(){return Object(i.a)()?u():s()}},4087:function(e,t,n){"use strict";var r=n(3450),o=n(2733),c=n(2827),a=n(3012),i=n(2844),s=n(3046),u=n(710),l=n(3451);var d=n(25),b=n(3919);var f=n(22),O=n(2),j=n(595);function w(e,t,n,O,w){switch(v(e),w=w||Object(j.c)("linrfs"),e.tableQuery.listViewType){case 0:return function(e,t,n,d,b){var f;const O=e.tableQuery,j=null===(f=Object(o.l)(e,!0))||void 0===f?void 0:f.Id,w=O.viewFilter&&"All"!==O.viewFilter,{sortColumn:v,sortDirection:m}=o.c.getDefaultSortBy(),p=O.sortBy&&(O.sortBy.sortColumn!==v||O.sortBy.sortDirection!==m);return Object(s.d)(O.folderId,i.a,O.viewFilter,O.sortBy,Object(a.l)(O),O.focusedViewFilter,O.requestShapeName,Object(c.d)(O),void 0,O.categoryName,j,{datapoint:{customData:{scenarioType:O.scenarioType,isPrefetch:t,isFilter:w,isSort:p}}},d,t,b).then(o=>{let c=[];o.edges&&(c=o.edges.map(e=>e.node)),Object(r.a)(e,c,o.totalConversationRowsInView,o.searchFolderId?Object(u.a)({Id:o.searchFolderId}):null,o.folderId?Object(u.a)({Id:o.folderId}):null),n(e,!0,"200",t)}).catch(r=>{const o=Object(l.a)(r);return n(e,!1,o,t),Promise.reject(r)})}(e,t,n,O,w);case 1:return function(e,t,n,f,O){const j=e.tableQuery;return Object(d.k)("mon-messageList-useGqlForFindItem")?Object(s.h)(Object(o.k)(j),i.a,j.viewFilter,j.sortBy,Object(a.l)(j),j.focusedViewFilter,j.requestShapeName,Object(c.d)(j),f,Object(c.e)(j),j.categoryName,Object(o.l)(e,!0),null,t,O).then(o=>{let c=[];o.edges&&(c=o.edges.map(e=>e.node)),Object(r.a)(e,c,o.totalItemRowsInView,o.searchFolderId?Object(u.a)({Id:o.searchFolderId}):null,null),n(e,!0,"200",t)}).catch(r=>{const o=Object(l.a)(r);return n(e,!1,o,t),Promise.reject(r)}):Object(s.c)(Object(o.k)(j),0,i.a,j.viewFilter,Object(b.a)(j),j.focusedViewFilter,j.requestShapeName,f,Object(c.e)(j),j.categoryName,Object(o.l)(e,!0)).then(o=>{var c;let a=Promise.resolve();const i="Success"==o.ResponseClass;if(i)Object(r.a)(e,null===(c=o.RootFolder.Items)||void 0===c?void 0:c.map(e=>e),o.RootFolder.TotalItemsInView,o.SearchFolderId,null);else{const e=new Error(`ResponseCode=${o.ResponseCode}, Stacktrace=${o.StackTrace}`);e.fetchErrorType="ServerFailure",a=Promise.reject(e)}return n(e,i,o.ResponseCode,t),a},r=>{var o;const c=(null===(o=null==r?void 0:r.response)||void 0===o?void 0:o.status)||"";return n(e,!1,c,t),Promise.reject(r)})}(e,t,n,O,w);default:return f.h.warn("listViewType: "+e.tableQuery.listViewType+" is not supported."),Promise.resolve()}}n.d(t,"a",(function(){return w}));const v=Object(O.mutatorAction)("setTableViewLoading",e=>{e.isLoading=!0,e.loadErrorStatus=0})},4173:function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return s}));var r=n(20);const o=new r.c(()=>n.e(1219).then(n.bind(null,6477)));let c=new r.a(o,e=>e.prefetchRowInCache),a=new r.a(o,e=>e.prefetchSingleRow),i=new r.a(o,e=>e.prefetchFirstN),s=new r.a(o,e=>e.prefetchAdjacentRowsOnDelay)},4176:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2);let o=Object(r.action)("ON_LIST_VIEW_TYPE_OPTION_SAVED",e=>({newListViewType:e}))},4239:function(e,t,n){"use strict";var r=n(462),o=n(20);const c=new o.c(()=>Promise.all([n.e(0),n.e(9),n.e(13),n.e(25),n.e(305),n.e(1040)]).then(n.bind(null,7794)));let a=new o.a(c,e=>e.downloadPersonaPhoto);var i=n(198),s=n(1434);let u=new r.a(1,(function(e){let t=Object(s.a)(e.emailAddress,e.personaId,e.size,e.mailboxType,e.name),n=i.a.viewStates.get(t);return a.importAndExecute(n,!1,e.skipLoadingPhoto)}),500);t.a=u},4265:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("updateCategoriesInView",(e,t)=>({modifiedCategoryName:e,newCategoryName:t}))},4266:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("UPDATE_TABLE_CURRENT_LOADED_INDEX",(e,t)=>({tableViewId:e,currentLoadedIndexToSet:t}))},4327:function(e,t,n){"use strict";var r=n(20),o=n(4353),c=n(3572),a=n(3020),i=n(3085);function s(e){var t;if(Object(i.c)(e.serverFolderId,i.b.Running))return!1;if(e.currentLoadedIndex<e.rowKeys.length)return!0;if("spotlight"===(null===(t=null==e?void 0:e.tableQuery)||void 0===t?void 0:t.scenarioType))return!1;const n=a.a.getCount(e.serverFolderId,3);return e.rowKeys.length>0&&e.rowKeys.length<e.totalRowsInView-n}var u=n(2844);function l(e){(function(e){return e.rowKeys.length<u.a&&!e.isLoading&&s(e)})(e)&&f.importAndExecute(e)}var d=n(2);Object(d.orchestrator)(u.d,e=>{const t=e.tableView;t&&s(t)&&f.import().then(e=>{s(t)&&e(t)})}),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return O})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return l}));const b=new r.c(()=>n.e(1102).then(n.bind(null,19882)));Object(r.f)(o.a,b,e=>e.reloadTableOnTriageActionFailOrchestrator),Object(r.f)(c.a,b,e=>e.reloadTableUponUndoWithoutNotificaitonChannel);const f=new r.a(b,e=>e.loadMoreInTable),O=new r.a(b,e=>e.reloadInboxPostBoot)},4329:function(e,t,n){"use strict";var r=n(3883),o=n(2844);const c=new Map;function a(e,t,n=!1){if(c.has(e)&&n&&Object(r.b)(c.get(e)),!c.has(e)||n){const n=Object(o.c)(t);c.set(e,n.id),Object(r.a)(n)}}function i(e){const t=c.get(e);t&&c.delete(e)&&Object(r.b)(t)}var s=n(3856),u=n(3677),l=n(3294),d=n(4029),b=n(2733),f=n(1084),O=n(3288);n.d(t,"a",(function(){return y})),n.d(t,"b",(function(){return I}));const j="FOCUSED",w="OTHER",v="ALL";let m,p,h;function y(){g(m,h)}function I(e){const t=e.tableQuery;if(e.tableQuery.folderId===Object(f.a)("inbox")&&"All"===Object(b.Q)(e)&&"spotlight"!==t.scenarioType){let n=t.sortBy;if(!Object(s.a)())return g(n,e.tableQuery.listViewType),!0;{const t=Object(O.a)(e.tableQuery.folderId);if(n.sortColumn===t.sortColumn&&n.sortDirection===t.sortDirection)return g(void 0,e.tableQuery.listViewType),!0}}return!1}function g(e,t){const n=Object(l.a)();e&&m&&e.sortDirection===m.sortDirection&&e.sortColumn===m.sortColumn&&p==n&&h===t||(!function(e,t){const n=!Object(s.a)();if(e){const e=Object(d.b)(),r=Object(d.d)();void 0!==t&&(e.sortBy=t,r.sortBy=t),a(j,e,n),a(w,r,n),i(v),Object(u.b)(r)}else{const e=Object(d.c)();void 0!==t&&(e.sortBy=t),i(j),i(w),a(v,e,n)}}(n,e),m=e,p=n,h=t)}},4352:function(e,t,n){"use strict";n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return f}));var r=n(3883),o=n(4453),c=n(3856);const a=5;let i=[];function s(e){return Object(o.a)(e.tableQuery,!Object(c.a)())}function u(e){for(let t=0;t<i.length;++t)if(i[t].key===e)return t;return-1}function l(e,t){i.unshift(e),Object(r.a)(t),function(){for(let e=a;e<i.length;e++)Object(r.b)(i[e].tableViewId),i.splice(e,1)}()}function d(e,t=!0){const n=e.tableQuery,o=s(e),a=function(e,t,n){return{tableViewId:e.id,key:t,sortBy:n}}(e,o,n.sortBy),d=u(o);if(-1==d)t?l(a,e):function(e,t){f()&&(i.push(e),Object(r.a)(t))}(a,e);else{const t=i[d];!function(e,t){i.splice(e,1),i.unshift(t)}(d,a),Object(c.a)()||(b=a.sortBy,O=t.sortBy,b.sortDirection===O.sortDirection&&b.sortColumn===O.sortColumn)||(Object(r.b)(t.tableViewId),Object(r.a)(e))}var b,O;return d}function b(e){const t=u(s(e));if(-1==t)throw new Error("Table Key should be present in the mru list when remove is called");Object(r.b)(e.id),i.splice(t,1)}function f(){return i.length<a}},4455:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(4352),o=n(4329);function c(e,t=!0){if(1==e.tableQuery.type)throw new Error("updateTablesInCache should never be called for Search table");return Object(o.b)(e)?0:r.c(e,t)}},4456:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n(4327),o=n(2892),c=n(2733),a=n(3399),i=n(1084),s=n(4266),u=n(3491),l=n(3304),d=n(3078);function b(e,t,n="LocalUpdate"){let b=-1,f=!1,O=!1;for(const r of e)t.selectedRowKeys.has(r)&&(b=t.rowKeys.indexOf(r),O=!0,b>-1&&(f=c.b.getIsPinned(t.rowKeys[b],t))),a.a.removeRow(r,t,n);Object(s.a)(t.id,Math.min(t.currentLoadedIndex,t.rowKeys.length)),t.id===Object(u.a)()&&(Object(r.d)(t),b>-1&&t.tableQuery.folderId!=Object(i.a)("junkemail")&&t.rowKeys.length>0?Object(o.k)(t,b,f):Object(d.a)()&&O&&Object(l.a)())}},4457:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2);let o=Object(r.action)("ON_MAIL_SEARCH_COMPLETE",e=>({searchTableQuery:e}))},4522:function(e,t,n){"use strict";let r={warmedUpGroups:null,warmUpTime:0};function o(e){r.warmUpTime=e}function c(){return r.warmUpTime}function a(e){r.warmedUpGroups=e}function i(e){const t=e.toLowerCase();if(!r.warmedUpGroups)return!1;for(let e=0;e<r.warmedUpGroups.length;++e){if(r.warmedUpGroups[e].toLowerCase()==t)return!0}return!1}n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return i}))},4573:function(e){e.exports=JSON.parse('{"a":"Atc","c":"Btc","b":"Ctc","d":"Dtc"}')}}]);
//# sourceMappingURL=owa.165.js.map
self.scriptsLoaded['owa.165.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.165.js'] = (new Date()).getTime();