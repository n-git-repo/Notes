self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.1095.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[1095],{11874:function(e,n,t){"use strict";var o=t(8382),i=t(710),s=t(9125),a=t(391),r=t(474),c=t(2805);const d=e=>{var n;return{__typename:"Recipient",emailAddress:e.EmailAddress,emailAddressIndex:e.EmailAddressIndex,id:null===(n=e.ItemId)||void 0===n?void 0:n.Id,isDomainInOrganization:e.IsDomainInOrganization,isExternalSmtpAddress:e.IsExternalSmtpAddress,mailboxType:e.MailboxType,name:e.Name,originalDisplayName:e.OriginalDisplayName,relevanceScore:e.RelevanceScore,routingType:e.RoutingType,sipUri:e.SipUri,submitted:e.Submitted}},u=async(e,n,t)=>{var u,l,v,p;const f=void 0===n.first||null===n.first?20:n.first,m=parseInt(n.after||"")||0,I=f+m,g=await Object(o.a)(e,n.options.responseShape,n.options.syncState||"",I,n.options.conversationSortOrder,n.options.shouldUseEmptySyncState||!1,n.options.action||"Default",(n.options.folderIdsToIgnore||[]).map(e=>Object(i.a)({Id:e})),Object(a.a)(n.options.mailboxInfo,t.requestOptions));await Object(c.a)(g);const C=g.Conversation,O=C.ConversationNodes||[];return{__typename:"Conversation",canDelete:C.CanDelete,ccRecipients:null===(l=null===(u=C.CcRecipients)||void 0===u?void 0:u.map)||void 0===l?void 0:l.call(u,d),conversationNodes:{__typename:"ConversationToConversationNodesConnection",pageInfo:{__typename:"PageInfo",hasNextPage:g.Conversation.TotalConversationNodesCount>O.length,hasPreviousPage:!1,endCursor:((null==O?void 0:O.length)||1)-1+"",startCursor:"0"},edges:(O.slice(m)||[]).map((e,n)=>({__typename:"ConversationConversationNodesEdge",cursor:n+"",node:Object.assign(Object.assign({__typename:"ConversationNode"},e),{id:e.InternetMessageId,Items:e.Items.map(s.a),DiffingInformation:Object(r.a)(e.DiffingInformation,"DiffingInformation")})}))},id:C.ConversationId.Id,isLocked:C.IsLocked,lastModifiedTime:C.LastModifiedTime,syncState:C.SyncState,toRecipients:(null===(p=null===(v=C.ToRecipients)||void 0===v?void 0:v.map)||void 0===p?void 0:p.call(v,d))||null,totalConversationNodesCount:C.TotalConversationNodesCount,conversationDiagnosticsInfo:C.ConversationDiagnosticsInfo}};t.d(n,"a",(function(){return u}))},19430:function(e,n,t){"use strict";t.r(n),t.d(n,"conversationNodesWebResolver",(function(){return i}));var o=t(11874);const i=async(e,n,t,i)=>{if(e.conversationNodes)return e.conversationNodes;return(await Object(o.a)({Id:e.id},n,t)).conversationNodes||null}},4881:function(e,n,t){"use strict";function o(e){return Object.assign({__type:"GetConversationItemsJsonRequest:#Exchange"},e)}t.d(n,"a",(function(){return o}))},5618:function(e,n,t){"use strict";t.d(n,"a",(function(){return s}));var o=t(35),i=t(4881);function s(e,n){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(o.a)("GetConversationItems",e,n)}},710:function(e,n,t){"use strict";function o(e){return Object.assign({__type:"FolderId:#Exchange"},e)}t.d(n,"a",(function(){return o}))},7150:function(e,n,t){"use strict";function o(e){return Object.assign({__type:"ConversationRequestType:#Exchange"},e)}t.d(n,"a",(function(){return o}))},7151:function(e,n,t){"use strict";function o(e){return Object.assign({__type:"GetConversationItemsRequest:#Exchange"},e)}t.d(n,"a",(function(){return o}))},8382:function(e,n,t){"use strict";t.d(n,"a",(function(){return u}));var o=t(7150),i=t(4881),s=t(7151),a=t(381),r=t(5618),c=t(167);function d(e){return"ChronologicalNewestOnBottom"==e?"DateOrderAscending":"DateOrderDescending"}function u(e,n,t,u,l,v,p="Default",f,m){const I=Object(o.a)({ConversationId:Object(a.a)({Id:e.Id})});I.SyncState=v?"":t;const g=function(e,n,t,o,i,a,r){var c,u;return Object(s.a)({Conversations:[e],ItemShape:n,ShapeName:"CreateConversationRelationMap"==(null===(u=null===(c=null==r?void 0:r.datapoint)||void 0===c?void 0:c.customData)||void 0===u?void 0:u.actionSource)?void 0:"ItemPart",SortOrder:d(t),MaxItemsToReturn:o,Action:i,FoldersToIgnore:a,ReturnSubmittedItems:!0})}(I,n,l,u,p,f,m),C=Object(c.b)();return C.RequestServerVersion="V2017_08_18",Object(r.a)(Object(i.a)({Header:C,Body:g}),m).then(e=>{var n,t,o;return null===(o=null===(t=null===(n=null==e?void 0:e.Body)||void 0===n?void 0:n.ResponseMessages)||void 0===t?void 0:t.Items)||void 0===o?void 0:o[0]})}}}]);
//# sourceMappingURL=owa.1095.js.map
self.scriptsLoaded['owa.1095.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.1095.js'] = (new Date()).getTime();