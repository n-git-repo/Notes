self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.156.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[156],{10958:function(e,t,n){"use strict";var a=n(2);t.a=Object(a.action)("initializeExtendedCardForConversationReadingPane",(e,t)=>({conversationViewState:e,loadedItemParts:t}))},10961:function(e,t,n){"use strict";var a=n(2);t.a=Object(a.action)("tryInitializeShouldShowCLPLabel",e=>({conversationViewState:e}))},10962:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(12457);function o(e,t){const n=t?t.Value:"",o=Object(a.a)(e);return o||n}},10963:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return u}));var a=n(2829),o=n(2),i=n(2817),r=n(3571);const c=Object(o.mutatorAction)("addLoadedConversationReadingPaneViewState",(function(e){const t=e.conversationId.Id,{loadedConversationReadingPaneViewStates:n}=Object(a.b)();n.has(t)||n.set(t,e)})),s=Object(o.mutatorAction)("releaseOrphanedLoadedConversationViewStates",(function(){const{loadedConversationReadingPaneViewStates:e}=Object(a.b)();e.forEach((t,n)=>{Object(i.o)(n)||n==Object(r.a)()||e.delete(n)})})),u=Object(o.mutatorAction)("releaseLoadedConversationViewState",(function(e){Object(a.b)().loadedConversationReadingPaneViewStates.delete(e)}))},11794:function(e,t,n){"use strict";var a=n(11823),o=n(10958),i=n(6993),r=n(5764),c=n(4578),s=n(4922),u=n(3815),d=n(68),l=n(358),f=n(2740),m=n(3202),b=n(6759),g=n(4921);const I=5,O=3;var p=Object(l.action)("markConversationCollapsedItemsRollUp")((function(e,t,n){Object(b.b)(e,g.a.CalendarCard)?function(e,t){const{length:n}=t,a=[],o=Object(u.a)()?0:n-1,i=Object(u.a)()?1:-1;for(let e=o;e<=n-1&&e>=0&&!t[e].isExpanded;e+=i)v(t[e])&&a.push(t[e].conversationNodeId);a.length>1&&(e.conversationNodeIdsInCollapsedItemsRollUp=a)}(e,t):function(e,t,n){const{length:a}=t;if(a<I)return;const o=[];let i=Object(u.a)()?1:a-2;const r=Object(u.a)()?1:-1;n&&(i-=r);for(let e=i;e<=a-1&&e>=0&&!t[e].isExpanded;e+=r)o.push(t[e].conversationNodeId);if(o.length>=O){if(o.pop(),e.conversationNodeIdsInCollapsedItemsRollUp=o,!n){const n=Object(u.a)()?0:a-1;e.nodeIdBundledWithSeeMoreMessages=t[n].conversationNodeId}Object(d.p)("RPCountRenderCollItemsRollUp",[Object(c.b)(Object(s.a)(e))])}}(e,t,n)}));function v(e){let t=f.a.items.get(e.itemId);return!(!t||!Object(m.m)(t))&&t.IsOutOfDate}var h=n(12455),j=n(10961),S=n(5238),C=n(2913),P=n(10962),w=n(2733);var A=n(6);var R=n(6994),M=n(3587),E=n(3499),x=n(3569);function y(e,t,n,a){const c=[],{itemPartsMap:s,itemIdToScrollTo:u}=t;let d=null;if(e.conversationNodeIds){e.conversationNodeIds.forEach(t=>{let[n]=Object(r.a)({mailboxInfo:e.conversationId.mailboxInfo,Id:t});n&&s.set(t,n)}),Object(E.a)()&&Object(j.a)(t),Object(h.a)(s,n,e.conversationNodeIds,!1);let l=!1;e.conversationNodeIds.forEach(e=>{const t=s.get(e);if(t&&!t.isInRollUp){c.push(t);const e=a.get(t.itemId);(function(e){const t=Object(w.I)();if(null==t?void 0:t.highlightTerms){const n=Object(P.a)(e.RightsManagementLicenseData,e.UniqueBody),a=document.createElement("div");return a.innerHTML=n,t.highlightTerms.some((function(e){return a.innerText.toLowerCase().indexOf(e)>=0}))}return!1})(e)&&(t.isExpanded=!0),l=l||t.isExpanded&&!e.IsDraft}});const I="ChronologicalNewestOnBottom"==e.conversationSortOrder;if(function(e,t,n,a){const o=n.length;if(0==o||t)return;let i=null;const r=e?o-1:0;let c=r;const s=e?-1:1,u=e=>{const t=a.get(e);return Object(x.a)(t)[1]};for(;c>=0&&c<o;){const e=n[c],t=e.oofRollUpViewState.oofReplyNodeIds.some(u);if(!e.isExpanded&&(e.isLocal||t)){i=e;break}c+=s}i||(i=n[r]),i.isExpanded=!0,i.isFossilizedTextExpanded=!0}(I,l,c,n),d=function(e,t){const n=e.length;for(let a=0;a<n;a++){const n=e[a],o=n.itemId;if(t){if(o==t)return n.isExpanded=!0,{itemPart:n,focusedItemArea:S.a.Item}}else{if(n.isExpanded)return{itemPart:n,focusedItemArea:S.a.Item};if(n.oofRollUpViewState.isOofRollUpExpanded)return{itemPart:n,focusedItemArea:S.a.Oof}}}return null}(c,u),c.forEach(e=>{e.isExpanded&&Object(i.a)(e)}),Object(o.a)(t,c),Object(b.b)(t,g.a.CalendarCard)&&function(e){var t;const n=e.length;if(0!=n)for(let a=0;a<n;a++){const n=e[a],o=n?n.itemId:null,i=f.a.items.get(o),r=Object(w.I)();if(i&&Object(m.m)(i)&&(null==r||!r.highlightTerms))if(i.IsRead||i.IsOutOfDate)n.isExpanded=!1,n.isFossilizedTextExpanded=!1;else if(Object(m.q)(i.ItemClass)){const e=i;"NewMeetingRequest"==e.MeetingRequestType&&!Object(A.j)(e.Preview)||(null===(t=e.ChangeHighlights)||void 0===t?void 0:t.HasBodyChanged)?n.isExpanded=!0:(n.isExpanded=!1,n.isFossilizedTextExpanded=!1)}else!Object(m.r)(i.ItemClass)&&!Object(m.l)(i.ItemClass)||Object(A.j)(i.Preview)?(n.isExpanded=!1,n.isFossilizedTextExpanded=!1):n.isExpanded=!0}}(c),c.length){const n=I?0:e.conversationNodeIds.length-1,a=e.conversationNodeIds[n],o=s.has(a);e.canLoadMore&&(t.nodeIdBundledWithSeeMoreMessages=a),Object(M.a)(t.conversationId.Id)||p(t,c,e.canLoadMore&&!o)}}return d}t.a=Object(l.action)("firstLoadConversationReadingPane")((function(e,t={loadedConversation:f.a.conversations.get(e),conversationNodes:f.a.conversationNodes,conversationReadingPaneState:Object(C.a)(e),items:f.a.items}){if(t.conversationReadingPaneState.conversationId.Id!=e)return;const n=t.conversationReadingPaneState;if(n.loadingState.isLoading=!1,n.loadingState.hasLoadFailed=t.loadedConversation.loadingState.hasLoadFailed,!n.loadingState.hasLoadFailed){const o=Object(R.c)(e);if(n.unsupportedItemId=o,!o){const e=y(t.loadedConversation,n,t.conversationNodes,t.items);n.initiallySelectedItemPart=n.focusedItemPart=e,Object(a.a)(n,!0)}}}))},11823:function(e,t,n){"use strict";var a=n(9949),o=n(2740);var i=n(6064),r=n(25);function c(e,t){const n=Object(i.a)(e.conversationId.Id);if(null==n?void 0:n.hasSharepointLink)return!0;if(e.itemPartsMap.size>0){if(function(e){if(!e)return!1;const t=o.a.conversations.get(e.conversationId.Id);return null==t?void 0:t.canLoadMore}(e))return!0;const n=[...e.itemPartsMap.keys()];for(let a=0;a<n.length;a++){const o=e.itemPartsMap.get(n[a]);if(!o)continue;const i=t.get(o.itemId);if(i&&(i.Attachments||Object(r.k)("doc-linkDiscovery-useNewProperty")&&i.HasProcessedSharepointLink))return!0}}return!1}var s=n(3815),u=n(2905),d=n(3539),l=n(2);async function f(e,t){const n=Object(o.b)().items;if(c(e,n)){if(!(null==e?void 0:e.attachmentWell)){const[t,n,a]=await d.c.importAndExecute(e.conversationId),o=await u.l.import();m(e,o(n,a)),await u.n.importAndExecute(t,e.conversationId.mailboxInfo,e.attachmentWell,!0,!1)}const o=[...e.itemPartsMap.keys()];for(let i=0;i<o.length;i++){const r=e.itemPartsMap.get(o[i]);if(!r)continue;const c=n.get(r.itemId);c&&(await Object(a.a)(r,c,t),await u.o.importAndExecute(r.attachmentWell,e.attachmentWell,Object.assign(Object.assign({},c.ItemId),{mailboxInfo:c.MailboxInfo}),c.DateTimeReceived))}await u.r.importAndExecute(e.attachmentWell,Object(s.a)())}}n.d(t,"a",(function(){return f}));const m=Object(l.mutatorAction)("setAttachmentWellForConversation",(e,t)=>{e.attachmentWell=t})},12455:function(e,t,n){"use strict";var a=n(12456),o=n(358);t.a=Object(o.action)("tryAddOofNodesInRollUp")((function(e,t,n,o){o&&e.forEach(e=>{e.oofRollUpViewState.oofReplyNodeIds=[]}),n.forEach(n=>{const o=e.get(n);if(!o||!o.oofRollUpViewState.isOofItem)return;o.isInRollUp=!1;const i=Object(a.a)(n,e,t);i&&!i.isInRollUp&&(o.isInRollUp=!0,i.oofRollUpViewState.oofReplyNodeIds.push(n))})}))},12456:function(e,t,n){"use strict";function a(e,t,n){const a=n.get(e);return a?t.get(a.parentInternetMessageId):null}n.d(t,"a",(function(){return a}))},12457:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(15519),o=n(6);function i(e){let t;if((null==e?void 0:e.RightsManagedMessageDecryptionStatus)&&0!=e.RightsManagedMessageDecryptionStatus)switch(e.RightsManagedMessageDecryptionStatus){case-2147160052:case-2147160012:case-2147160011:t=Object(o.c)(Object(o.b)(a.d),r());break;case-2147160010:t=Object(o.b)(a.a);break;case-2147168507:t=Object(o.c)(Object(o.b)(a.l),r());break;case-2147160014:t=Object(o.b)(a.j);break;case-2147160054:case-2147160055:t=Object(o.b)(a.h);break;case-2147160064:case-2147160013:t=Object(o.b)(a.g);break;case-2147160051:t=Object(o.b)(a.c);break;case-2147160060:t=Object(o.b)(a.k);break;case-2147160009:default:t=Object(o.c)(Object(o.b)(a.i),e.RightsManagedMessageDecryptionStatus)}return t}function r(){const e=Object(o.c)('<a href="{0}" target="_blank">{1}</a>',Object(o.b)(a.f),Object(o.b)(a.e));return Object(o.c)(Object(o.b)(a.b),e)}},1427:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return r})),n.d(t,"d",(function(){return c}));const a="FileAttachment:#Exchange",o="ItemAttachment:#Exchange",i="ItemIdAttachment:#Exchange",r="ReferenceAttachment:#Exchange",c="LinkAttachment:#Exchange"},15519:function(e){e.exports=JSON.parse('{"d":"Brc","a":"Crc","l":"Drc","j":"Erc","h":"Frc","g":"Grc","c":"Hrc","k":"Irc","i":"Jrc","f":"Krc","e":"Lrc","b":"Mrc"}')},2773:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(360);function o(e){var t;return null===(t=Object(a.a)(e))||void 0===t?void 0:t.AttachmentPolicy}},2823:function(e,t,n){"use strict";var a,o,i;n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i})),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp",e[e.Peek=5]="Peek",e[e.CalendarCard=6]="CalendarCard"}(a||(a={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity",e[e.InsightMessage=7]="InsightMessage",e[e.External=8]="External",e[e.Spotlight=9]="Spotlight"}(o||(o={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(i||(i={}))},2852:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(1427);function o(e){return(e.__type||e.OwsTypeName)===a.e}},2871:function(e,t,n){"use strict";var a=n(3278),o=n(358);const i=Object(o.action)("addInfoBarMessage")((function(e,t,n){if(e){-1==e.infoBarIds.indexOf(t)?e.infoBarIds.push(t):e.infoBarIds=[...e.infoBarIds];const o=e.infoBarHostKey;n&&(a.b[o]||(a.b[o]={}),a.b[o][t]=n)}}));t.a=i},2905:function(e,t,n){"use strict";n.d(t,"n",(function(){return c})),n.d(t,"q",(function(){return s})),n.d(t,"a",(function(){return u})),n.d(t,"p",(function(){return d})),n.d(t,"f",(function(){return l})),n.d(t,"t",(function(){return f})),n.d(t,"g",(function(){return m})),n.d(t,"d",(function(){return b})),n.d(t,"e",(function(){return g})),n.d(t,"j",(function(){return I})),n.d(t,"i",(function(){return O})),n.d(t,"l",(function(){return p})),n.d(t,"k",(function(){return v})),n.d(t,"c",(function(){return h})),n.d(t,"o",(function(){return j})),n.d(t,"r",(function(){return S})),n.d(t,"b",(function(){return C})),n.d(t,"m",(function(){return P})),n.d(t,"h",(function(){return w})),n.d(t,"s",(function(){return A}));var a=n(20),o=n(3024);n.d(t,"u",(function(){return o.a}));var i=n(3025);n.d(t,"v",(function(){return i.a}));const r=new a.c(()=>Promise.all([n.e(0),n.e(21),n.e(24),n.e(25),n.e(29),n.e(35),n.e(50),n.e(57),n.e(60),n.e(116),n.e(153),n.e(256),n.e(748),n.e(539)]).then(n.bind(null,3881))),c=new a.a(r,e=>e.initializeAttachments),s=new a.a(r,e=>e.reinitializeAttachments),u=(new a.a(r,e=>e.setInlineAttachmentStatus),new a.a(r,e=>e.addAttachmentIntoWellBeforeUpload)),d=new a.b(r,e=>e.refreshSharingTipsAttachmentWell),l=new a.b(r,e=>e.createAttachmentsViaQueueManager),f=new a.b(r,e=>e.createAttachmentsFromRecentAttachments),m=new a.a(r,e=>e.deleteAttachmentViaQueueManager),b=new a.b(r,e=>e.createAttachmentFullViewStateAndStoreBackingModel),g=new a.b(r,e=>e.createAttachmentFullViewState),I=new a.b(r,e=>e.getAttachmentWellInitialValue),O=new a.b(r,e=>e.getAttachmentWellForCompose),p=new a.b(r,e=>e.getConversationAttachmentWellInitialValue),v=(new a.b(r,e=>e.getMaxClassicAttachmentsSize),new a.b(r,e=>e.getAvailableLocalAttachmentSize)),h=new a.b(r,e=>e.createAttachmentFileFromExistingMailboxAttachment),j=new a.a(r,e=>e.mergeToConversationAttachmentWell),S=new a.a(r,e=>e.sortConversationAttachmentWell),C=new a.a(r,e=>e.convertImageViewAttachmentToInlineAttachment),P=new a.b(r,e=>e.getLastCloudyAttachmentsSharingIssueForBlockOnSend),w=new a.b(r,e=>e.getAllValidAttachments),A=new a.b(r,e=>e.uploadLocalFile)},2972:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(72);function o(e){switch(e){case 0:return"ReadOnlyAccess";case 1:return"ReadOnlyPlusAttachmentsBlockedAccess";case 2:return null;default:return Object(a.a)(e)}}},2993:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return c}));var a=n(13),o=n(2);const i={clpLabels:[],learnMoreUrl:"",hasMandatoryLabel:!1,rmsTemplates:new a.ObservableMap,messageClassifications:new a.ObservableMap},r=Object(o.createStore)("protection",i),c=r()},3024:function(e,t,n){"use strict";var a=n(2);t.a=Object(a.action)("ON_ATTACHMENT_CREATED",(e,t,n,a=!0)=>({parentItemId:e,attachmentId:t,attachment:n,shouldTriggerAddInAttachmentsChangedCallback:a}))},3025:function(e,t,n){"use strict";var a=n(2);t.a=Object(a.action)("ON_ATTACHMENT_DELETED",(e,t,n,a=!0)=>({parentItemId:e,attachmentId:t,attachment:n,shouldTriggerAddInAttachmentsChangedCallback:a}))},3102:function(e,t,n){"use strict";var a=n(2773);function o(){const e=Object(a.a)();return e.ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||e.ConditionalAccessDirectFileAccessOnPublicComputersBlocked?e.ConditionalAccessWacViewingOnPrivateComputersBlocked||e.ConditionalAccessWacViewingOnPublicComputersBlocked?[1]:[0]:[]}var i=n(2972),r=n(2852);function c(){return o()}function s(e){return(e&&e.length>0&&function(e){return e.some(e=>!function(e){return e.IsInline&&!Object(r.a)(e)}(e))}(e)?o():[]).map(i.a)}n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return s}))},3278:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}));const a={};function o(e,t){var n;const o=e.infoBarHostKey;return null===(n=a[o])||void 0===n?void 0:n[t]}},3309:function(e,t,n){"use strict";n.d(t,"m",(function(){return i})),n.d(t,"l",(function(){return r})),n.d(t,"o",(function(){return c})),n.d(t,"q",(function(){return s})),n.d(t,"p",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"e",(function(){return l})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return m})),n.d(t,"k",(function(){return b})),n.d(t,"n",(function(){return g})),n.d(t,"r",(function(){return I})),n.d(t,"c",(function(){return O})),n.d(t,"d",(function(){return p})),n.d(t,"j",(function(){return v})),n.d(t,"f",(function(){return h})),n.d(t,"i",(function(){return j})),n.d(t,"a",(function(){return S}));var a=n(20);const o=new a.c(()=>Promise.all([n.e(0),n.e(15),n.e(23),n.e(25),n.e(29),n.e(31),n.e(50),n.e(57),n.e(60),n.e(116),n.e(341),n.e(511)]).then(n.bind(null,4938))),i=new a.a(o,e=>e.onSmimeItemAttachmentOpened),r=new a.a(o,e=>e.mergeSmimeDecodedMessageProperties),c=(new a.b(o,e=>e.fetchAndDecodeSmimeMessage),new a.b(o,e=>e.setSmimePropertiesInDraftMessage)),s=new a.b(o,e=>e.trySetSmimeProperties),u=new a.b(o,e=>e.tryAddSmimeProperties),d=new a.b(o,e=>e.createMailResponseBodyContent),l=new a.b(o,e=>e.downloadSmimeAttachment),f=new a.b(o,e=>e.getMergedSmimeViewState),m=new a.b(o,e=>e.getMergedSmimeViewStateForDraft),b=new a.b(o,e=>e.isSmimeItemDecoding),g=new a.b(o,e=>e.previewSmimeAttachment),I=new a.b(o,e=>e.updateSmimeAttachmentIds),O=new a.b(o,e=>e.createSmimeAttachmentsFromFiles),p=new a.b(o,e=>e.createSmimeAttachmentsViaSmimeQueueManager),v=new a.b(o,e=>e.initializeAttachmentStateForSmimeAttachments),h=new a.b(o,e=>e.getAttachmentsForSmimeResponse),j=new a.b(o,e=>e.getSmimeAttachmentsForRequest),S=Object(a.d)(o,e=>e.SignatureDetails)},3318:function(e,t,n){"use strict";var a=n(20);const o=[0,1];var i=n(3392),r=n(3378),c=n(6),s=n(72),u=n(2823);function d(e){switch(e){case"ReadOnlyPlusAttachmentsBlockedAccess":return{key:"access_control_info_bar",source:u.c.Compose,rank:u.b.Error,message:Object(c.b)(r.a),messageParts:[Object(c.b)(r.a),l()],color:u.a.Red};case"ReadOnlyAccess":return{key:"access_control_info_bar_check",source:u.c.Compose,rank:u.b.Error,message:Object(c.b)(i.b),messageParts:[Object(c.b)(i.b),l()],color:u.a.Red};default:return Object(s.a)(e)}}function l(){return{text:Object(c.b)(i.a),action:()=>{window.open("https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done","_blank")}}}var f=n(3102),m=n(2972),b=n(25),g=n(2773);function I(){const e=Object(g.a)();if(Object(b.k)("fwk-devTools")){if(Object(b.k)("doc-attachment-CA-readOnlyAccessIssues"))return Object.assign(Object.assign({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!0,WacViewingOnPublicComputersEnabled:!0});if(Object(b.k)("doc-attachment-CA-readOnlyPlusAttachmentsBlocked"))return Object.assign(Object.assign({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!1,WacViewingOnPublicComputersEnabled:!1})}return e}function O(){const e=I();return e.DirectFileAccessOnPrivateComputersEnabled&&e.DirectFileAccessOnPublicComputersEnabled?2:e.WacViewingOnPrivateComputersEnabled&&e.WacViewingOnPublicComputersEnabled?0:1}n.d(t,"g",(function(){return v})),n.d(t,"a",(function(){return o})),n.d(t,"f",(function(){return d})),n.d(t,"b",(function(){return f.a})),n.d(t,"e",(function(){return m.a})),n.d(t,"d",(function(){return O})),n.d(t,"c",(function(){return I}));const p=new a.c(()=>n.e(2151).then(n.bind(null,19527))),v=new a.b(p,e=>e.getAccessIssuesForAttachments)},3378:function(e){e.exports=JSON.parse('{"a":"bma"}')},3392:function(e){e.exports=JSON.parse('{"a":"$la","b":"ama"}')},3499:function(e,t,n){"use strict";var a=n(25),o=n(2993),i=n(220);t.a=function(){const{clpLabels:e}=o.b;return Object(a.k)("cmp-clp")&&e.length>0&&e.some(e=>e.isLabelEnabled)&&!Object(i.a)()}},3528:function(e,t,n){"use strict";n.d(t,"b",(function(){return r}));var a=n(2),o=n(3732);let i={installationStatus:0,isBrowserSupportActiveX:Object(o.a)(),version:""};const r=Object(a.createStore)("SmimeStore",i),c=r();t.a=c},3548:function(e,t,n){"use strict";n.d(t,"n",(function(){return d})),n.d(t,"m",(function(){return l})),n.d(t,"j",(function(){return f})),n.d(t,"i",(function(){return m})),n.d(t,"k",(function(){return b})),n.d(t,"f",(function(){return g})),n.d(t,"a",(function(){return I})),n.d(t,"c",(function(){return O})),n.d(t,"g",(function(){return p})),n.d(t,"d",(function(){return v})),n.d(t,"h",(function(){return h})),n.d(t,"e",(function(){return S})),n.d(t,"l",(function(){return C})),n.d(t,"b",(function(){return P}));var a=n(3973),o=n(3732),i=n(107),r=n(2904),c=n(3032),s=n(3657),u=n(154);function d(){return Object(i.e)()||Object(i.f)()}function l(e){return function(e){if(e.length<2)return!1;const t=e[0]-parseInt(r.b),n=e[1]-parseInt(r.c);return 0==t&&n>=0}("string"==typeof e?e.split(".").map(e=>parseInt(e)):[])}function f(e){const t="string"==typeof e?e.split("."):[];return t.length&&t[0]!=r.b}function m(){return Object(i.s)()&&(Object(i.i)()&&Object(i.b)()[0]==r.i&&Object(o.a)()||Object(a.a)())&&Object(u.a)("smimeExtension")}function b(e){return 0!==e}function g(e){const t=[];t.push(e.UserEmailAddress),t.push(e.LogonEmailAddress),t.push(e.UserPrincipalName),t.push(e.UserLegacyExchangeDN);const n=e.UserProxyAddresses;return n&&n.length>0&&n.forEach((function(e){t.indexOf(e)>=0||t.push(e)})),t}function I(e){let t=65001;return e.UseGB18030?t=54936:e.UseISO885915&&(t=28605),t}function O(e){return{AllowUserChoiceOfSigningCertificate:e.AllowUserChoiceOfSigningCertificate,IncludeCertificateChainWithoutRootCertificate:e.IncludeCertificateChainWithoutRootCertificate,IncludeCertificateChainAndRootCertificate:e.IncludeCertificateChainAndRootCertificate,EncryptTemporaryBuffers:e.EncryptTemporaryBuffers,SignedEmailCertificateInclusion:e.SignedEmailCertificateInclusion,IncludeSmimeCapabilitiesInMessage:e.IncludeSMIMECapabilitiesInMessage,CopyRecipientHeaders:e.CopyRecipientHeaders,OnlyUseSmartCard:e.OnlyUseSmartCard,EncryptionAlgorithms:e.EncryptionAlgorithms,SigningAlgorithms:e.SigningAlgorithms}}function p(e,t){const n=Object(s.a)().ClearSign;return t||e&&!n?c.a:r.e}function v(e){return btoa(unescape(encodeURIComponent(e)))}function h(e,t){const n=Object(s.a)();return e&&t?n.TripleWrapSignedEncryptedMail?14:12:e?n.ClearSign?11:10:6}function j(){return(Math.floor(4026531839*Math.random())+268435456).toString(16)}function S(e){return r.m+(e||j()+j()+j()+j())}function C(e,t){return t.IsInline&&-1===e.indexOf(t.ContentId)}function P(){return r.d+j()+"@"+j()+"."+j()}},3587:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2817),o=n(2750),i=n(2850),r=n(72);function c(e,t=0,n,c){const l=function(e){switch(e){case 0:return s;case 1:return u;case 2:return d;default:return Object(r.a)(e)}}(t),f=Object(i.c)();for(const t of Object(o.a)().tabs)if(t.type==a.a.MailCompose&&0==t.state){const a=f.viewStates.get(t.data);if((null==a?void 0:a.isInlineCompose)&&l(a,e)&&(0==a.asyncSendState||n&&6==a.asyncSendState)&&(!c&&!t.projectionRPTabId||t.projectionRPTabId==c))return a}return null}function s(e,t){return e.conversationId===t}function u(e,t){return e.referenceItemId.Id===t}function d(e,t){return!1}},3656:function(e,t,n){"use strict";function a(e,t,n,a){const i=o(e,t,n,a);return i?i.Value:null}function o(e,t,n,a){if(!e||!e.ExtendedProperty)return null;for(let o=0;o<e.ExtendedProperty.length;o++){const i=e.ExtendedProperty[o];let r=null,c=null,s=null;if((null==i?void 0:i.ExtendedFieldURI)&&(r=i.ExtendedFieldURI.PropertyTag,c=i.ExtendedFieldURI.PropertyName,s=i.ExtendedFieldURI.PropertyId),t&&r==t)return i;if(n&&c==n)return i;if(a&&s==a)return i}return null}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}))},3657:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(58);function o(){var e;return null===(e=a.a.userConfiguration)||void 0===e?void 0:e.SmimeAdminSettings}},3730:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"f",(function(){return r})),n.d(t,"d",(function(){return c})),n.d(t,"h",(function(){return s})),n.d(t,"e",(function(){return u})),n.d(t,"g",(function(){return d})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return f}));var a=n(20);const o=new a.c(()=>Promise.all([n.e(4),n.e(8),n.e(15),n.e(21),n.e(24),n.e(330),n.e(550)]).then(n.bind(null,5975))),i=new a.a(o,e=>e.loadCLPUserLabels),r=(new a.a(o,e=>e.addAuditActionToViewState),new a.b(o,e=>e.showJustificationModal)),c=new a.a(o,e=>e.loadItemCLPInfo),s=new a.b(o,e=>e.updateItemCLPInfo),u=new a.b(o,e=>e.logReadCLPLabel),d=new a.b(o,e=>e.triggerCLPAutoLabeling),l=(new a.b(o,e=>e.constructCLPAuditAction),Object(a.d)(o,e=>e.CLPSubjectHeaderLabel)),f=Object(a.d)(o,e=>e.CLPMandatoryLabelModal)},3731:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(20);const o=new a.c(()=>n.e(809).then(n.bind(null,6466))),i=new a.b(o,e=>e.SmimeAdapter)},3732:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(107);function o(){if(Object(a.i)())try{return new ActiveXObject("htmlfile"),!0}catch(e){return!1}return!1}},3772:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(3528);function o(){const e=Object(a.b)();return 9==e.installationStatus||6==e.installationStatus}},3815:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(30);function o(){const e=Object(a.a)();return"ChronologicalNewestOnBottom"==(e.UserOptions?e.UserOptions.ConversationSortOrderReact:"ChronologicalNewestOnBottom")}},3973:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(107),o=n(2904);function i(){return Object(a.e)()&&Object(a.p)([o.f])||Object(a.g)()&&Object(a.p)([o.h])||Object(a.f)()&&Object(a.p)([o.g])}},4578:function(e,t,n){"use strict";function a(e){return Math.min(Math.floor(e/2),24)}n.d(t,"b",(function(){return a})),t.a={RPPerfLoadConversationReadingPane:{name:"RPPerfLoadConversationReadingPane"},RPPerfLoadItemReadingPane:{name:"RPPerfLoadItemReadingPane"},RPCountExpCollQuotedText:{name:"RPCountExpCollQuotedText",customData:(e,t,n)=>[n?1:0,!e.isExpanded]},RPCountLoadMore:{name:"RPCountLoadMore"},RPCountExpCollAllItemParts:{name:"RPCountExpCollAllItemParts",customData:(e,t,n)=>[t,n]},PrintItem:{name:"PrintItem",actionSource:(e,t,n)=>t},ReplyByMeeting:{name:"ReplyByMeeting",actionSource:(e,t,n,a)=>a}}},4744:function(e,t,n){"use strict";t.a=e=>{var t;return null===(t=null==e?void 0:e.Smime)||void 0===t?void 0:t.isDecoded}},4745:function(e,t,n){"use strict";t.a=(e,t=!0)=>{const n=t?23:24;return e>=n?n:e}},4921:function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e[e.TXP=0]="TXP",e[e.CalendarCard=1]="CalendarCard",e[e.MeetingPoll=2]="MeetingPoll",e[e.Voting=3]="Voting",e[e.Yammer=4]="Yammer",e[e.SharePointPage=5]="SharePointPage"}(a||(a={}))},4922:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return c}));var a=n(2740);function o(e){return(null==e?void 0:e.conversationNodeIdsInCollapsedItemsRollUp)&&e.conversationNodeIdsInCollapsedItemsRollUp.length>0}function i(e){const t=a.a.conversations.get(e.conversationId.Id);return o(e)||(null==t?void 0:t.canLoadMore)}function r(e,t){return(null==e?void 0:e.conversationNodeIdsInCollapsedItemsRollUp)&&t&&e.conversationNodeIdsInCollapsedItemsRollUp.includes(t.conversationNodeId)}function c(e){if(!o(e))return 0;const{conversationNodeIdsInCollapsedItemsRollUp:t,itemPartsMap:n}=e;let a=t.length;return t.forEach(e=>{const t=n.get(e);t.oofRollUpViewState.oofReplyNodeIds&&(a+=t.oofRollUpViewState.oofReplyNodeIds.length)}),a}},4990:function(e,t,n){"use strict";function a(e,t){return{infoBarIds:t||[],infoBarHostKey:e||"0"}}n.d(t,"a",(function(){return a}))},5238:function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e[e.Item=0]="Item",e[e.Oof=1]="Oof",e[e.FossilizedText=2]="FossilizedText",e[e.SeeMore=3]="SeeMore"}(a||(a={}))},5469:function(e,t,n){"use strict";var a=n(3570),o=n(6993),i=n(6105),r=n(4578),c=n(9282),s=n(6106),u=n(9283),d=n(2829),l=n(3173),f=n(9284),m=n(9285),b=n(6994),g=n(25),I=n(4990),O=n(9286),p=n(2782),v=n(3730),h=n(9934),j=n(3203),S=n(2740),C=n(3309),P=n(3731),w=n(3528),A=n(6107),R=n(3772),M=n(7496),E=n(6997);var x=e=>{var t;return(null===(t=null==e?void 0:e.Smime)||void 0===t?void 0:t.ErrorState)||0},y=n(5832),L=n(4744),V=n(2989),N=n(22),k=n(2),F=n(68);const U=(e,t)=>{N.h.info("S/MIME: processing S/MIME message. isSmimeAdapterAlreadyUsable: "+Object(R.a)());const n=new F.b("RPProcessSmimeItem",{isCore:!0});return C.q.import().then(t=>t(e)).then(()=>{z(e,n,t)}).catch(()=>{z(e,n,t)})};function D(e,t,n,i,r,c){if(e.itemId!=t.Id)return;const s=(null==t?void 0:t.Id)&&Object(S.b)().items.get(t.Id);T(e,t,s,n),s&&(i.addCustomData(Object(f.b)(s,c,r)),v.h.import().then(e=>{e(s)}),Object(b.d)(s)?B(e):(Object(o.a)(e.itemViewState,!1,{item:s}),Object(a.a)(e,s)))}const T=Object(k.mutatorAction)("setReadpingPaneItemState",(e,t,n,a)=>{e.itemViewState=function(e,t){return Object.assign(Object.assign({},Object(I.a)(e.Id,Object(c.a)())),{itemId:e.Id,isConversationItemPart:!1,attachmentWell:null,meetingRequestViewState:null,loadingState:{isLoading:!1,hasLoadFailed:!1},actionableMessageCardInItemViewState:{showBodyWithMessageCard:!1,showCardLoading:!0},undoDarkMode:!1,isLoadingFullBody:!1,smartPillViewState:{smartPillBlockVisible:!1},hideSmartReplyFeedbackDialog:!0,ampViewState:Object(O.a)(t),hasMeetingPoll:Object(m.a)(t),omeMessageState:Object(h.a)(t)})}(t,n),e.loadingState.isLoading=!1,e.loadingState.hasLoadFailed=!n,e.instrumentationContext=a}),B=Object(k.mutatorAction)("setReadpingPaneUnuspportedItem",e=>{e.isUnsupportedItem=!0}),W=(e,t,n,a,o,i)=>a?a(e):j.f.importAndExecute(e,n?"LoadItemPreviewPane":"LoadItemReadingPane",t,Object(R.a)(),o,i),_=(e,t,n,a,o,i)=>{if(Object(V.a)(n)){let r;return P.a.import().then(()=>Object(R.a)()&&Object(M.a)(n)?(r=!0,W(e,t,a,o,null,i)):n).then(()=>U(e,r))}return Promise.resolve()};function z(e,t,n){const a=Object(S.b)().items.get(null==e?void 0:e.Id);t.addCustomData({smimeInstallationStatus:w.a.installationStatus,smimeType:Object(y.a)(a),numAttachments:q(a),wasReloaded:n}),Object(L.a)(a)?t.end():t.endWithError("ClientError",new Error(x(a).toString()))}function q(e){var t;return null===(t=null==e?void 0:e.Attachments)||void 0===t?void 0:t.length}const H=Object(k.mutatorAction)("setItemReadingPaneOnError",e=>{e&&(e.loadingState.isLoading=!1,e.loadingState.hasLoadFailed=!0)});t.a=Object(F.s)(r.a.RPPerfLoadItemReadingPane,(function(e,t,n,a,o,c){let f=function(e,t,n,a){return{itemId:e.Id,itemViewState:null,isPrint:t,loadingState:{isLoading:!0,hasLoadFailed:!1},currentSelectedFolderId:Object(p.b)(),isUnsupportedItem:!1,instrumentationContext:null,extendedCardViewState:null,isReadonly:n}}(e,null==a?void 0:a.isPrint,!!(null==a?void 0:a.isReadOnly),null==a||a.isProjection);(null==a?void 0:a.isProjection)&&Object(u.a)(e.Id),Object(s.c)(),Object(i.a)(f),n&&n(f),f=(null==a?void 0:a.isPrint)?Object(d.b)().itemPrintPaneViewState:Object(l.a)(e.Id);const m=Object(F.r)(e=>e.eventName==r.a.RPPerfLoadItemReadingPane.name),b=Object(S.b)().items.get(e.Id),I=!(null==a?void 0:a.isPrint)&&!(null==a?void 0:a.isPreviewPane);Object(g.k)("ring-dogfood")&&I&&Object(F.p)("RPMailStoreItemsCount",{count:Object(S.b)().items.size});const O=Object(M.a)(b),v=Object(V.a)(b);if(v&&b.Smime&&!Object(L.a)(b)&&(b.Smime.ErrorState=0),b&&(b.NormalizedBody&&!O||Object(E.a)(b))){if(v&&!Object(L.a)(b)){return new F.b("RPProcessSmimeItem").addCustomData({wasItemReloaded:!1}),U(e,!1).then(()=>{var n,o;return null===(o=null===(n=null==t?void 0:t.dp)||void 0===n?void 0:n.addCheckpoint)||void 0===o||o.call(n,"LIRP_SMIME"),D(f,e,t,m,null==a?void 0:a.isPrint,null==a?void 0:a.isPreviewPane)})}return D(f,e,t,m,null==a?void 0:a.isPrint,null==a?void 0:a.isPreviewPane),Promise.resolve()}return new Promise(e=>v&&O&&!Object(A.a)()?P.a.import().then(e):e(void 0)).then(()=>{var n,i;return null===(i=null===(n=null==t?void 0:t.dp)||void 0===n?void 0:n.addCheckpoint)||void 0===i||i.call(n,"LIRP_THEN"),function(e,t,n,a,o,i,r){return W(t,a,null==o?void 0:o.isPreviewPane,i,null==o?void 0:o.isDiscovery,r).then(e=>{var c,s;return null===(s=null===(c=null==n?void 0:n.dp)||void 0===c?void 0:c.addCheckpoint)||void 0===s||s.call(c,"LI_THEN"),_(t,a,e,null==o?void 0:o.isPreviewPane,i,r)}).then(()=>{var i,r;return null===(r=null===(i=null==n?void 0:n.dp)||void 0===i?void 0:i.addCheckpoint)||void 0===r||r.call(i,"LI_SMIME_THEN"),D(e,t,n,a,null==o?void 0:o.isPrint,null==o?void 0:o.isPreviewPane)}).catch(t=>(H(e),Promise.reject(t)))}(f,e,t,m,a,c,o)})}))},5764:function(e,t,n){"use strict";var a=n(11794),o=n(4578),i=n(9282),r=n(10963),c=n(9284),s=n(9285),u=n(8647),d=n(6287);var l=n(13),f=n(68),m=n(25),b=n(4990),g=n(9286),I=n(2883),O=n(2740);function p(e){const t=I.a.conversationItems.get(e);if(t){const n=function(e){const t={unreadItemCount:0,totalItemCount:0},n=O.a.conversations.get(e);for(const e of n.conversationNodeIds){const n=O.a.conversationNodes.get(e);if(!n){t.totalItemCount=0;break}t.totalItemCount+=n.itemIds.length;for(const e of n.itemIds){const n=O.a.items.get(e);if(!n){t.totalItemCount=0;break}t.unreadItemCount+=n.IsRead?0:1}}return t}(e);return t.globalItemIds.length!=n.totalItemCount||t.globalUnreadCount!=n.unreadItemCount}return!1}var v=n(2782),h=n(2742),j=n(3203),S=n(3569);n.d(t,"a",(function(){return P}));const C=[];let P=function(e){if(!e||!e.Id)return[null,null];const t=h.u.conversationNodes.get(e.Id),[n,a,o]=Object(S.a)(t);if(!Object(S.c)(n,o,a))return[null,null];const r={isExpanded:!1,loadingState:{isLoading:!1,hasLoadFailed:!1}},c=function(e,t,n){return!e.IsRead&&t||e.IsDraft&&!n}(n,a,o),u={mailboxInfo:e.mailboxInfo,Id:n.ItemId.Id};var l;return[Object.assign(Object.assign({},Object(b.a)(u.Id,Object(i.a)())),{conversationNodeId:e.Id,itemId:u.Id,isConversationItemPart:!0,isExpanded:c,isLocal:a,isDeleted:o,attachmentWell:null,quotedBodyViewState:r,isFossilizedTextExpanded:c,hideSmartReplyFeedbackDialog:!0,meetingRequestViewState:null,loadingState:{isLoading:!1,hasLoadFailed:!1},actionableMessageCardInItemViewState:{showBodyWithMessageCard:!1,showCardLoading:!0},undoDarkMode:!1,isLoadingFullBody:!1,oofRollUpViewState:(l=n.ItemClass,{isOofItem:d.a.test(l),oofReplyNodeIds:[],isOofRollUpExpanded:!1}),isInRollUp:!1,smartPillViewState:{smartPillBlockVisible:!1},ampViewState:Object(g.a)(n),hasMeetingPoll:Object(s.a)(n),omeMessageState:null}),n]};t.b=Object(f.s)(o.a.RPPerfLoadConversationReadingPane,(function(e,t,n,i,s){let d,b=Promise.resolve(),g=function(e,t,n,a,o){return{conversationId:e,conversationSubject:t,conversationCategories:n,initiallySelectedItemPart:null,itemIdToScrollTo:o,itemPartsMap:new l.ObservableMap({}),loadingState:{isLoading:!0,hasLoadFailed:!1},currentSelectedFolderId:Object(v.b)(),unsupportedItemId:null,instrumentationContext:a,attachmentWell:null,calendarInlineComposeViewState:null,focusedItemPart:null,conversationNodeIdsInCollapsedItemsRollUp:[],nodeIdBundledWithSeeMoreMessages:null,extendedCardViewState:null}}(e,n,i,t,s);const I=Object(h.q)(e.Id),O=Object(f.r)(e=>e.eventName==o.a.RPPerfLoadConversationReadingPane.name);if(Object(m.k)("ring-dogfood")){let t=!1;C.includes(e.Id)?t=!0:C.push(e.Id),Object(f.p)("RPCacheStatus",{hasValidConversationCache:I,hasOpened:t,OpenedCount:C.length})}return Object(r.c)(),I&&(d="Valid",h.c.getAndTouch(e.Id),Object(u.a)(e.Id)||(Object(r.a)(g),Object(a.a)(e.Id))),I&&!p(e.Id)||(Object(r.a)(g),d=I?"Stale":"Not",b=j.e.importAndExecute(e,"LoadConversationReadingPane",O)),b.then(()=>{var n,a;null===(a=null===(n=null==t?void 0:t.dp)||void 0===n?void 0:n.addCheckpoint)||void 0===a||a.call(n,"LCRP_POST"),O&&O.addCustomData(Object(c.a)(e.Id,d))})}))},6105:function(e,t,n){"use strict";var a=n(6106),o=n(358);t.a=Object(o.action)("setItemReadingPaneViewState")((function(e){Object(a.a)(e)}))},6106:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return u}));var a=n(2829),o=n(2),i=n(2817),r=n(3571);const c=Object(o.mutatorAction)("addLoadedItemReadingPaneViewState",(function(e){const t=e.itemId,{loadedItemReadingPaneViewStates:n}=Object(a.b)();n.has(t)||n.set(t,e)})),s=Object(o.mutatorAction)("releaseOrphanedLoadedItemViewStates",(function(){const{loadedItemReadingPaneViewStates:e,loadingProjectionIds:t,itemPreviewPaneViewState:n,itemPrintPaneViewState:o}=Object(a.b)();e.forEach((a,c)=>{c==Object(r.a)()||Object(i.o)(c)||-1!=(null==t?void 0:t.indexOf(c))||c==(null==n?void 0:n.itemId)||c==(null==o?void 0:o.itemId)||e.delete(c)})})),u=Object(o.mutatorAction)("releaseLoadedItemViewState",(function(e){Object(a.b)().loadedItemReadingPaneViewStates.delete(e)}))},6107:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(3528),o=n(3548);function i(){const e=Object(a.b)();return Object(o.k)(e.installationStatus)}},6287:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=/ipm.note.rules.ooftemplate.microsoft/i},6759:function(e,t,n){"use strict";function a(e,t){return(null==e?void 0:e.extendedCardViewState)&&e.extendedCardViewState.cardType==t}function o(e){var t;return null===(t=null==e?void 0:e.extendedCardViewState)||void 0===t?void 0:t.coverOriginalContent}function i(e,t){return a(e,t)?e.extendedCardViewState.cardViewState:null}n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return i}))},6993:function(e,t,n){"use strict";var a=n(9949),o=n(2740),i=n(3202),r=n(358);t.a=Object(r.action)("initializeExtendedStateForItemViewState")((async function(e,t=!1,n={item:o.a.items.get(e.itemId)}){await Object(a.a)(e,n.item,t),n.item&&Object(i.q)(n.item.ItemClass)&&i.t.importAndExecute(e)}))},6994:function(e,t,n){"use strict";n.d(t,"d",(function(){return b})),n.d(t,"c",(function(){return g})),n.d(t,"a",(function(){return I})),n.d(t,"b",(function(){return O}));var a=n(2737),o=n(2740),i=n(1084);const r="IPM.Appointment",c="IPM.Contact",s="IPM.DistList",u="IPM.Task",d="calendar",l="contacts",f="tasks",m="inbox";function b(e){return e&&(p(e.ItemClass)||v(e.ItemClass)||h(e.ItemClass)||j(e.ItemClass))}function g(e){const t=o.a.conversations.get(e),n=o.a.conversationNodes.get(t&&t.conversationNodeIds[0]);if(n){const e=n.itemIds[0];if(b(o.a.items.get(e)))return e}return null}function I(e){const t=o.a.items.get(e);return p(t.ItemClass)?Object(i.a)(d):v(t.ItemClass)||h(t.ItemClass)?Object(i.a)(l):j(t.ItemClass)?Object(i.a)(f):Object(i.a)(m)}function O(e){let t="";const n=a.d.folderTable.get(e);return n&&(t=Object(a.h)(n)),t}function p(e){return 0==e.indexOf(r)}function v(e){return 0==e.indexOf(c)}function h(e){return 0==e.indexOf(s)}function j(e){return 0==e.indexOf(u)}},6995:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(1198),o=n(25),i=n(220);function r(){const e=Object(a.g)(a.d.AmpDeveloper);return Object(i.a)()&&Object(o.k)("rp-amp")&&e.enabled}},6996:function(e,t,n){"use strict";var a,o;n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o})),function(e){e[e.None=0]="None",e[e.Revocable=1]="Revocable",e[e.Expirable=2]="Expirable"}(a||(a={})),function(e){e[e.None=0]="None",e[e.SuccessOrNoChange=1]="SuccessOrNoChange",e[e.FailedOrMessageNotFound=2]="FailedOrMessageNotFound",e[e.PartialFailed=3]="PartialFailed"}(o||(o={}))},6997:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2904);function o(e){return(null==e?void 0:e.ItemId)&&0===e.ItemId.Id.indexOf(a.m)}},7496:function(e,t,n){"use strict";var a=n(3808),o=n(4744),i=n(2989),r=n(6107),c=n(3772);var s=()=>!!Object(r.a)()&&!Object(c.a)();t.a=e=>!Object(o.a)(e)&&!s()&&Object(i.a)(e)&&!Object(a.a)(e)},8168:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(22);let o=null;const i={register:e=>{o=e},available:()=>!!o,run:(e,t)=>o?o(e,t):(a.d("getAttachmentWellViewStateByItemIdHelper is not registered."),null)}},8169:function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e.None="none",e.AmpDisabled="ampDisabled",e.MessageUnsafe="messageUnsafe",e.SenderNotAllowed="sendNotAllowed",e.BrowserNotSupported="browserNotSupported",e.AmpNotValidated="ampNotValidated",e.AmpValidationFailed="ampValidationFailed",e.AmpValidated="ampValidated"}(a||(a={}))},8647:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2829);function o(e){return Object(a.b)().loadedConversationReadingPaneViewStates.has(e)}},9282:function(e,t,n){"use strict";function a(){return["unsubscribeInfoBar","safetyBar","infoImportance","infoSensitivity","infoFlagStatus","irmInfoBar","infoMessageSubmitted","agendaMailFeedback","unauthenticatedSender","infoDelegate","infoMeetingAttendeeDoNotForward","infoSMIME","infoSmimeDecodeError","infoSmimeSigned","infoItemPartLoadFailure","infoLastUserAction","infoReadReceiptRequested","translateInfoBar","infoResend","infoPolicyTag","infoMessageApprovalAndVoting","nudged","nudgeFeedback","infoMessageClassification","infoCLPLabel","infoRevocation","externalMessage","spotlight","spotlightFeedback"]}n.d(t,"a",(function(){return a}))},9283:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(2829),o=n(2);const i=Object(o.mutatorAction)("addLoadingProjectionMutatorId",(function(e){const{loadingProjectionIds:t}=Object(a.b)();t.push(e)})),r=Object(o.mutatorAction)("removeLoadingProjectionMutatorId",(function(e){const{loadingProjectionIds:t}=Object(a.b)();t.remove(e)}))},9284:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return m}));var a=n(3815),o=n(2913),i=n(2740),r=n(4745),c=n(3202),s=n(30),u=n(2989);const d="Meeting",l="Message";function f(e,t){let n=0,s=0,u=0,d=0,l=0;const f=Object(o.a)(e);if(f){const e=f.itemPartsMap;e.forEach(e=>{e.isExpanded&&d++;const t=i.a.items.get(e.itemId);t&&(t.IsRead||n++,t.IsDraft&&s++,Object(c.m)(t)&&u++)}),l=e.size}return{owa_1:g(),owa_2:Object(a.a)(),owa_3:Object(r.a)(l),owa_4:Object(r.a)(d),owa_5:Object(r.a)(n),owa_6:Object(r.a)(u),owa_7:Object(r.a)(s),owa_8:t}}function m(e,t,n){return{owa_1:g(),owa_2:b(e),owa_3:t,owa_4:n,owa_5:Object(u.a)(e)}}function b(e){return Object(c.m)(e)?d:l}function g(){return Object(s.a)().UserOptions.GlobalReadingPanePositionReact}},9285:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(6),o=n(25);const i="findtime/vote?getrequesturl=";function r(e){if(!Object(o.k)("cal-mf-meetingPollCard")||!e)return!1;let t=null;return e.UniqueBody?t=e.UniqueBody.Value:e.NormalizedBody&&(t=e.NormalizedBody.Value),!Object(a.j)(t)&&t.indexOf(i)>-1}},9286:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(9903);function o(e){return{preferAmp:!0,ampAvailability:Object(a.a)(e)}}},9287:function(e,t,n){"use strict";function a(e){var t;return(null===(t=e.From)||void 0===t?void 0:t.Mailbox)?e.From.Mailbox.EmailAddress:null}n.d(t,"a",(function(){return a}))},9288:function(e,t,n){"use strict";var a=n(2);const o=Object(a.createStore)("ampstore",{allowedSenders:[]});t.a=o()},9903:function(e,t,n){"use strict";var a=n(6);var o=n(9287),i=n(6995),r=n(100),c=n(8169),s=n(9288),u=n(1198);function d(e){if(!function(e){return e&&!Object(a.j)(e.AmpHtmlBody)}(e))return c.a.None;if(!Object(i.a)())return c.a.AmpDisabled;if(!function(e){return e&&!e.BlockStatus&&(!e.MessageSafety||!e.MessageSafety.MessageSafetyLevel||e.MessageSafety.MessageSafetyLevel<=2)}(e))return c.a.MessageUnsafe;const t=Object(o.a)(e);return null==t||!function(e){const t=Object(u.g)(u.d.AmpDeveloper);return t.enabled&&t.allowedSender.some(t=>l(t,e))}(t)&&!function(e){return s.a.allowedSenders&&s.a.allowedSenders.some(t=>l(t,e))}(t)?c.a.SenderNotAllowed:Object(r.e)()||Object(r.g)()?c.a.BrowserNotSupported:c.a.AmpNotValidated}function l(e,t){return e.toLowerCase()==t.toLowerCase()}n.d(t,"a",(function(){return d}))},9934:function(e,t,n){"use strict";var a=n(6996),o=n(5);var i=n(3656),r=n(1084);n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return u}));const c="x-ms-exchange-organization-ome-messagestate",s="sentitems";function u(e){if((null==e?void 0:e.ParentFolderId)&&e.ParentFolderId.Id!==Object(r.a)(s))return null;return function(e){if(e){let t={permissions:a.b.None,revoked:!1,expired:!1,revocationDate:null,revokedBy:null,responseState:a.a.None};try{const n=JSON.parse(e);if(1==n.Permissions&&(t.permissions=a.b.Revocable),2==n.Permissions&&(t.permissions=a.b.Expirable),t.revoked=n.IsRevoked,t.expired=n.IsExpired,n.RevocationDate){const e=Object(o.Ub)("UTC",n.RevocationDate);t.revocationDate=new Date(Object(o.Cb)(e))}t.revokedBy=n.RevokedBy}catch(e){return null}return t}return null}(Object(i.a)(e,null,c))}},9949:function(e,t,n){"use strict";var a=n(3318),o=n(2905),i=n(3808),r=n(4744),c=n(2989),s=n(2),u=n(2913),d=n(2740),l=n(8168);function f(e,t){var n;const a=d.a.items.get(t);if(a){const t=a.InternetMessageId,o=null===(n=Object(u.a)(e))||void 0===n?void 0:n.itemPartsMap.get(t);return o?o.attachmentWell:null}return null}var m=n(2871);async function b(e,t,n=!1){if(!t||Object(c.a)(t)&&!function(e,t){if(!Object(i.a)(t))return!0;if(!e.isConversationItemPart&&Object(r.a)(t))return!0;return!1}(e,t)||!t.Attachments)return;if(!e.attachmentWell){const t=await o.j.import();g(e,t(!0,!1,""))}l.a.register(f),n?await o.q.importAndExecute(t.Attachments,t.MailboxInfo,e.attachmentWell,!0,null,null,!!t.RightsManagementLicenseData,Object(c.a)(t),I(t.ItemClass)):await o.n.importAndExecute(t.Attachments,t.MailboxInfo,e.attachmentWell,!0,!1,null,null,!!t.RightsManagementLicenseData,Object(c.a)(t),I(t.ItemClass)),(await a.g.import())(t.Attachments).forEach(t=>Object(m.a)(e,t))}n.d(t,"a",(function(){return b}));const g=Object(s.mutatorAction)("setAttachmentWellForItem",(e,t)=>{e.attachmentWell=t});function I(e){switch(e){case"IPM.Note.rpmsg.Microsoft.Voicemail.UM.CA":case"IPM.Note.rpmsg.Microsoft.Voicemail.UM":return!0;default:return!1}}}}]);
//# sourceMappingURL=owa.156.js.map
self.scriptsLoaded['owa.156.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.156.js'] = (new Date()).getTime();