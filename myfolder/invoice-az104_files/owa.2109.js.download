self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.2109.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[2109],{2682:function(e,t,n){window,e.exports=function(e){function t(t){for(var n,o,i=t[0],a=t[1],s=0,u=[];s<i.length;s++)o=i[s],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&u.push(r[o][0]),r[o]=0;for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n]);for(c&&c(t);u.length;)u.shift()()}var n={},r={1:0};function o(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.e=function(e){var t=[],n=r[e];if(0!==n)if(n)t.push(n[2]);else{var i=new Promise((function(t,o){n=r[e]=[t,o]}));t.push(n[2]=i);var a,s=document.createElement("script");s.charset="utf-8",s.timeout=120,o.nc&&s.setAttribute("nonce",o.nc),s.src=function(e){return o.p+""+({0:"loggingdependencies",2:"vendors~loggingdependencies"}[e]||e)+"_"+{0:"1ce2ea2bbd5eceb043b3",2:"58a9bd5d70dd9db494af"}[e]+".js"}(e),0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous");var c=new Error;a=function(t){s.onerror=s.onload=null,clearTimeout(u);var n=r[e];if(0!==n){if(n){var o=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+o+": "+i+")",c.name="ChunkLoadError",c.type=o,c.request=i,n[1](c)}r[e]=void 0}};var u=setTimeout((function(){a({type:"timeout",target:s})}),12e4);s.onerror=s.onload=a,document.head.appendChild(s)}return Promise.all(t)},o.m=e,o.c=n,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="https://res-1.cdn.office.net/midgard/versionless/",o.oe=function(e){throw e};var i=window.webpackJsonpMidgardBootstrapper=window.webpackJsonpMidgardBootstrapper||[],a=i.push.bind(i);i.push=t,i=i.slice();for(var s=0;s<i.length;s++)t(i[s]);var c=a;return o(o.s=13)}([function(e,t,n){"use strict";t.a={START:"Start",SUCCESS:"Success",EXPECTED_FAILURE:"ExpectedFailure",UNEXPECTED_FAILURE:"UnexpectedFailure",MONITOR_IN_INVALID_STATE:"MonitorInInvalidState"}},function(e,t,n){"use strict";var r=n(2),o="object"==typeof self&&self&&self.Object===Object&&self,i=r.a||o||Function("return this")();t.a=i},function(e,t,n){"use strict";(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.a=n}).call(this,n(12))},function(e,t,n){"use strict";function r(e){return e}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=["Network","RESTAuthToken","TTLCacheUtils","BundleDownload","OfficeFeedIsReadyStatus","OfficeFeedVerbose"],o=["Stikkontakt","DataLoadStartAction","NoLogging","None"];function i(e){return r.indexOf(e)>-1}function a(e){return-1===o.indexOf(e)}},function(e,t,n){"use strict";t.a={CLIENT_TIMESTAMP:"ClientTimeStamp",TRANSACTION_ID:"QoSTransactionId",SOURCE_CORRELATION_ID:"SourceCorrelationId"}},function(e,n,r){"use strict";(function(e){var o=r(2),i=t&&!t.nodeType&&t,a=i&&"object"==typeof e&&e&&!e.nodeType&&e,s=a&&a.exports===i&&o.a.process,c=function(){try{return a&&a.require&&a.require("util").types||s&&s.binding&&s.binding("util")}catch(e){}}();n.a=c}).call(this,r(9)(e))},function(e,t,n){"use strict";n.d(t,"a",(function(){return ce}));var r,o=n(1),i=o.a.Symbol,a=Object.prototype,s=a.hasOwnProperty,c=a.toString,u=i?i.toStringTag:void 0,l=Object.prototype.toString,f=i?i.toStringTag:void 0,p=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":f&&f in Object(e)?function(e){var t=s.call(e,u),n=e[u];try{e[u]=void 0;var r=!0}catch(e){}var o=c.call(e);return r&&(t?e[u]=n:delete e[u]),o}(e):function(e){return l.call(e)}(e)},d=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},h=function(e){if(!d(e))return!1;var t=p(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},g=o.a["__core-js_shared__"],v=(r=/[^.]+$/.exec(g&&g.keys&&g.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"",m=Function.prototype.toString,b=/^\[object .+?Constructor\]$/,y=Function.prototype,w=Object.prototype,C=y.toString,T=w.hasOwnProperty,k=RegExp("^"+C.call(T).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),L=function(e){return!(!d(e)||function(e){return!!v&&v in e}(e))&&(h(e)?k:b).test(function(e){if(null!=e){try{return m.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e))},x=function(){try{var e=function(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return L(n)?n:void 0}(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),A=function(e,t,n){"__proto__"==t&&x?x(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n},P=function(e,t){return e===t||e!=e&&t!=t},S=Object.prototype.hasOwnProperty,O=function(e,t,n){var r=e[t];S.call(e,t)&&P(r,n)&&(void 0!==n||t in e)||A(e,t,n)},E=function(e){return e},I=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},j=Math.max,R=function(e){return function(){return e}},D=x?function(e,t){return x(e,"toString",{configurable:!0,enumerable:!1,value:R(t),writable:!0})}:E,F=Date.now,M=function(e){var t=0,n=0;return function(){var r=F(),o=16-(r-n);if(n=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(D),G=function(e,t){return M(function(e,t,n){return t=j(void 0===t?e.length-1:t,0),function(){for(var r=arguments,o=-1,i=j(r.length-t,0),a=Array(i);++o<i;)a[o]=r[t+o];o=-1;for(var s=Array(t+1);++o<t;)s[o]=r[o];return s[t]=n(a),I(e,this,s)}}(e,t,E),e+"")},_=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},N=function(e){return null!=e&&_(e.length)&&!h(e)},U=/^(?:0|[1-9]\d*)$/,B=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&U.test(e))&&e>-1&&e%1==0&&e<t},z=Object.prototype,H=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||z)},q=function(e){return null!=e&&"object"==typeof e},W=function(e){return q(e)&&"[object Arguments]"==p(e)},V=Object.prototype,X=V.hasOwnProperty,$=V.propertyIsEnumerable,J=W(function(){return arguments}())?W:function(e){return q(e)&&X.call(e,"callee")&&!$.call(e,"callee")},Q=Array.isArray,K=n(10),Y={};Y["[object Float32Array]"]=Y["[object Float64Array]"]=Y["[object Int8Array]"]=Y["[object Int16Array]"]=Y["[object Int32Array]"]=Y["[object Uint8Array]"]=Y["[object Uint8ClampedArray]"]=Y["[object Uint16Array]"]=Y["[object Uint32Array]"]=!0,Y["[object Arguments]"]=Y["[object Array]"]=Y["[object ArrayBuffer]"]=Y["[object Boolean]"]=Y["[object DataView]"]=Y["[object Date]"]=Y["[object Error]"]=Y["[object Function]"]=Y["[object Map]"]=Y["[object Number]"]=Y["[object Object]"]=Y["[object RegExp]"]=Y["[object Set]"]=Y["[object String]"]=Y["[object WeakMap]"]=!1;var Z=n(6),ee=Z.a&&Z.a.isTypedArray,te=ee?function(e){return function(t){return e(t)}}(ee):function(e){return q(e)&&_(e.length)&&!!Y[p(e)]},ne=Object.prototype.hasOwnProperty,re=function(e,t){var n=Q(e),r=!n&&J(e),o=!n&&!r&&Object(K.a)(e),i=!n&&!r&&!o&&te(e),a=n||r||o||i,s=a?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],c=s.length;for(var u in e)!t&&!ne.call(e,u)||a&&("length"==u||o&&("offset"==u||"parent"==u)||i&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||B(u,c))||s.push(u);return s},oe=function(e,t){return function(n){return e(t(n))}}(Object.keys,Object),ie=Object.prototype.hasOwnProperty,ae=function(e){return N(e)?re(e):function(e){if(!H(e))return oe(e);var t=[];for(var n in Object(e))ie.call(e,n)&&"constructor"!=n&&t.push(n);return t}(e)},se=Object.prototype.hasOwnProperty;function ce(e,t){return e.hasOwnProperty(t)}!function(e){G((function(t,n){var r=-1,o=n.length,i=o>1?n[o-1]:void 0,a=o>2?n[2]:void 0;for(i=e.length>3&&"function"==typeof i?(o--,i):void 0,a&&function(e,t,n){if(!d(n))return!1;var r=typeof t;return!!("number"==r?N(n)&&B(t,n.length):"string"==r&&t in n)&&P(n[t],e)}(n[0],n[1],a)&&(i=o<3?void 0:i,o=1),t=Object(t);++r<o;){var s=n[r];s&&e(t,s,r,i)}return t}))}((function(e,t){if(H(t)||N(t))!function(e,t,n,r){var o=!n;n||(n={});for(var i=-1,a=t.length;++i<a;){var s=t[i],c=r?r(n[s],e[s],s,n,e):void 0;void 0===c&&(c=e[s]),o?A(n,s,c):O(n,s,c)}}(t,ae(t),e);else for(var n in t)se.call(t,n)&&O(e,n,t[n])}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="Unknown"},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,n,r){"use strict";(function(e){var o=r(1),i=r(11),a=t&&!t.nodeType&&t,s=a&&"object"==typeof e&&e&&!e.nodeType&&e,c=s&&s.exports===a?o.a.Buffer:void 0,u=(c?c.isBuffer:void 0)||i.a;n.a=u}).call(this,r(9)(e))},function(e,t,n){"use strict";t.a=function(){return!1}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";n.r(t),n.d(t,"initializeLivePersonaEditorAsync",(function(){return Ie})),n.d(t,"initializeLivePersonaCardAsync",(function(){return Ge})),n.d(t,"freeBootstrapperMemory",(function(){return _e})),n.d(t,"fetchLokiConfigAsync",(function(){return Ne}));var r=3e5,o=function(e,t,n,r,o,i){this.name=e,this.message=t,this.rootCorrelationId=n,this.isExpected=r,this.statusCode=o,this.numberOfRetries=i};function i(e,t,n){try{n.sessionStorage&&n.sessionStorage.setItem&&n.sessionStorage.setItem(e,t)}catch(e){}}var a="LokiAuthToken";function s(e,t,n){return new Promise((function(r,s){e?(i(a,e,n),r(e)):t((function(e,t){e?(i(a,e,n),r(e)):s(new o("GetAuthTokenError","Auth token is undefined",t))}),(function(e,t,n){var r=function(e,t){var n=/^AADSTS\d+?:/.test(e),r=function(e,t){if(t&&e){if(e.indexOf("3399942148"))return!0;if(e.indexOf("3399942154"))return!0;if(e.indexOf("nativeWam:3"))return!0}return!1}(e,t);return n||r}(e,n)?e:"";s(new o("GetAuthTokenError",r,t,n))}))}))}var c,u=n(3);function l(e,t){var n=function(e){return"df"===e?c.Dogfood:"msit"===e?c.MSIT:void 0}(e);return n||(n=function(e){switch(e){case"Df":return c.Dogfood;case"Msit":return c.MSIT;case"Blackforest":return c.Blackforest;case"GccModerate":return c.GccModerate;case"GccHigh":return c.GccHigh;case"DoD":return c.DOD;case"Gallatin":return c.Gallatin;case"Prod":return c.TopLevel;case"AG08":return c.AG08;case"AG09":return c.AG09;case"Unknown":throw new Error("'Unknown' is not an expected environment type in Loki");default:return Object(u.a)(e)}}(t)),n}!function(e){e.TopLevel="https://loki.delve.office.com",e.Blackforest="https://loki.delve.office.de",e.GccModerate="https://gcc.loki.delve.office.com",e.GccHigh="https://gcchigh.loki.office365.us",e.DOD="https://dod.loki.office365.us",e.Gallatin="https://loki.office365.cn",e.Dogfood="https://df.loki.delve.office.com",e.LegacyDogfood="https://sfdf.loki.delve.office.com",e.MSIT="https://msit.loki.delve.office.com",e.LegacyMSIT="https://sfmsit.loki.delve.office.com",e.AG08="https://loki.officenet.eaglex.ic.gov",e.AG09="https://loki.officenet.microsoft.scloud"}(c||(c={}));var f="{0}/api/v1/livepersonacard/configuration?cultureName={1}",p="{0}/api/v1/livepersonaeditor/configuration?cultureName={1}",d="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";function h(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t.location.search),r=t.decodeURIComponent||window.decodeURIComponent;return null===n?"":r&&r(n[1].replace(/\+/g," "))||""}var g=function(){return(g=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},v=6e4,m="LivePersonaCardVersionOverride",b="LivePersonaCardCultureOverride",y="MidgardVersion",w="MidgardBranch",C="HostAppConfiguration",T="LivePersonaEditorCultureOverride",k="LivePersonaEditorVersionOverride",L="ClientTypeOverride";function x(e,t,n){return P(function(e,t){var n=t||e.culture,r=l(e.region,e.complianceEnvironment);return f.replace("{0}",r).replace("{1}",n)}(t,h(b,n)),e,g(g({},t),{clientFeature:"LivePersonaCard"}),n)}function A(e,t,n){return P(function(e,t){var n=t||e.culture,r=l(e.region,e.complianceEnvironment);return p.replace("{0}",r).replace("{1}",n)}(t,h(T,n)),e,g(g({},t),{clientFeature:"LivePersonaEditor"}),n)}function P(e,t,n,r){return new Promise((function(i,a){var s=new XMLHttpRequest;s.open("GET",e,!0),s.setRequestHeader("Authorization","Bearer "+t),s.setRequestHeader("Accept","application/json");var c=d.replace(/[xy]/g,(function(e){var t;if(window.crypto){var n=new Uint8Array(1);window.crypto.getRandomValues(n),t=n[0]}else t=Math.floor(16*Math.random());return("x"===e?t%16:t%4+8).toString(16)}));s.setRequestHeader("X-RootCorrelationId",c),s.setRequestHeader("X-CorrelationId",c),s.setRequestHeader("X-ClientCorrelationId",n.clientCorrelationId),s.setRequestHeader("X-ClientFeature",n.clientFeature);var u=h(L,r)||n.clientType;u&&s.setRequestHeader("X-ClientType",u),n.hostAppRing&&s.setRequestHeader("X-HostAppRing",n.hostAppRing),n.hostAppVersion&&s.setRequestHeader("X-HostAppVersion",n.hostAppVersion),n.hostAppConfiguration&&s.setRequestHeader("X-HostAppConfiguration",JSON.stringify(n.hostAppConfiguration));var l=h(C,r);if(l){var f={};l.split(";").forEach((function(e){var t=e.split(":"),n=t[0],r=t[1];f[n]=r})),s.setRequestHeader(C,JSON.stringify(f))}r&&r.React&&r.React.version&&r.ReactDOM&&s.setRequestHeader("X-HostAppReactVersion",r.React.version);var p=h(y,r)||h(m,r);p&&(s.setRequestHeader(m,p),s.setRequestHeader(y,p));var g=h(k,r);g&&s.setRequestHeader("X-"+k,g);var b=h(w,r);b&&(s.setRequestHeader(w,b),s.setRequestHeader("X-"+w,b)),s.addEventListener("load",(function(){if(200===s.status)try{var e=JSON.parse(s.response);e.RootCorrelationId=c,e.LokiVersion=s.getResponseHeader("x-serverversion")||"",i(e)}catch(e){a(new o("GetLokiConfigError","Failed to parse initialization config.",c))}else a(new o("GetLokiConfigError","Couldn't retrieve initialization config. Status code is "+s.status,c,!1,s.status))})),s.addEventListener("error",(function(){a(new o("GetLokiConfigError","Couldn't retrieve initialization config, request failed to complete.",c))})),s.addEventListener("timeout",(function(){a(new o("GetLokiConfigError","Loki config request timed out after "+v+" ms.",c))})),s.timeout=v,s.send()}))}n(17);var S=function(){return Promise.all([n.e(2),n.e(0)]).then(n.bind(null,52))},O=function(){return S().then((function(e){return e.AWTLogManager}))},E=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},I=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},j=function(){function e(e){this.bootstrapperConfig=e,this.loggers=new Map}return e.prototype.logEventAsync=function(e,t){return E(this,void 0,void 0,(function(){return I(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,this.getLoggerAsync(t)];case 1:return n.sent().logEvent(e),[4,O()];case 2:return n.sent().flush(this.noOp),[3,4];case 3:return n.sent(),[3,4];case 4:return[2]}}))}))},e.prototype.updateContextWithLokiDataAsync=function(e,t){return E(this,void 0,void 0,(function(){var n;return I(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.getLoggerAsync(t)];case 1:return(n=r.sent()).setContext("LokiUrl",e.LokiUrl),n.setContext("tenantAadObjectId",e.TenantAadObjectId),n.setContext("userAadObjectId",e.UserAadObjectId),n.setContext("userPuid",e.UserPuid),n.setContext("flights",e.Flights.join(",")),n.setContext("settings",JSON.stringify(e.Settings)),[3,3];case 2:throw r.sent(),new Error("Live Persona Card ERROR: Failed to update Aria's context");case 3:return[2]}}))}))},e.prototype.getLoggerAsync=function(e){return E(this,void 0,void 0,(function(){var t,n,r;return I(this,(function(o){switch(o.label){case 0:return(t=this.loggers.get(e))?[3,3]:[4,O()];case 1:return n=o.sent(),[4,this.getCollectorUrlAsync()];case 2:r=o.sent(),(t=n.initialize(e,{collectorUri:r,disableCookiesUsage:!0}))||(t=n.getLogger(e)),this.loggers.set(e,t),t.setContext("culture",this.bootstrapperConfig.culture),t.setContext("region",this.bootstrapperConfig.region),t.setContext("clientType",this.bootstrapperConfig.clientType),t.setContext("clientContextType",this.bootstrapperConfig.clientContextType),t.setContext("clientCorrelationId",this.bootstrapperConfig.clientCorrelationId),t.setContext("bootstrapperVersion","1.20210903.14.0"),t.setContext("complianceEnvironment",this.bootstrapperConfig.complianceEnvironment),o.label=3;case 3:return[2,t]}}))}))},e.prototype.getCollectorUrlAsync=function(){return E(this,void 0,void 0,(function(){return I(this,(function(e){switch(this.bootstrapperConfig.complianceEnvironment){case"Blackforest":return[2,"https://de.pipe.aria.microsoft.com/Collector/3.0/"];case"GccHigh":return[2,"https://tb.pipe.aria.microsoft.com/Collector/3.0"];case"DoD":return[2,"https://pf.pipe.aria.microsoft.com/Collector/3.0"];case"AG08":case"AG09":return[2,""];case"Gallatin":case"GccModerate":case"Prod":default:return[2,void 0]}return[2]}))}))},e.prototype.noOp=function(){},e}(),R=function(){return(R=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},D=new Map;function F(e){var t=e.targetWindow||window,n=D.get(t);return n?n.bootstrapperConfig=R(R({},n.bootstrapperConfig),e):n={bootstrapperConfig:R(R({},e),{targetWindow:t}),ariaLogger:new j(e),initializationPromise:void 0,lpeInitializationPromise:void 0,forceRefreshInitializationPromise:!1,forceRefreshLpeInitializationPromise:!1,forceRefreshInitializationTimeout:void 0},D.set(t,n),n}var M=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},G=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},_=2,N=0;function U(e,t,n){return M(this,void 0,void 0,(function(){var r,o;return G(this,(function(i){switch(i.label){case 0:return(o=F(t)).lpcConfig?(r=o.lpcConfig,[3,3]):[3,1];case 1:return[4,B(e,t,n)];case 2:r=i.sent(),o.lpcConfig=r,i.label=3;case 3:return[2,r]}}))}))}function B(e,t,n){return M(this,void 0,void 0,(function(){var r,o;return G(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,8]),[4,x(e,t,n)];case 1:return r=i.sent(),[3,8];case 2:return(o=i.sent()).statusCode&&401===o.statusCode?[4,s(void 0,t.getAuthToken,n)]:[3,4];case 3:e=i.sent(),i.label=4;case 4:return N<_?(N++,[4,B(e,t,n)]):[3,6];case 5:return r=i.sent(),[3,7];case 6:throw o.numberOfRetries=N,o;case 7:return[3,8];case 8:return[2,r]}}))}))}var z=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},H=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},q=2;function W(e,t){var n=this,r=0,o=function(e,t){return z(n,void 0,void 0,(function(){var n;return H(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,6]),[4,V(e,t)];case 1:return i.sent(),[3,6];case 2:return n=i.sent(),r<q?(r++,[4,o(e,t)]):[3,4];case 3:return i.sent(),[3,5];case 4:throw n.numberOfRetries=r,n;case 5:return[3,6];case 6:return[2]}}))}))};return o(e,t)}function V(e,t){return new Promise((function(n,r){var i=t.document.createElement("script");i.type="text/javascript",i.charset="utf-8",i.crossOrigin="anonymous",i.src=e,i.addEventListener("load",(function(){n()})),i.addEventListener("error",(function(){r(new o("LoadScriptError","Unexpected error while loading script on page."))})),t.document.body.appendChild(i)}))}var X="livepersonacard_with-react",$="livepersonacard_without-react",J="livepersonacardstrings";function Q(e,t){var n=e.ResourceUrls||[];if(0===n.length){var r=e.Resources[J],o=e.Resources[X];"OwaPeopleHub"===e.Workload&&(o=e.Resources[$]),n=[r,o]}return Promise.all(n.map((function(e){return W(e,t)}))).then((function(){return n}))}function K(e,t){var n=t.targetWindow;return new Promise((function(r,i){setTimeout((function(){try{n.LPC||i(new o("StartLivePersonaCardError","targetWindow.LPC is undefined.")),n.LivePersonaCardStrings&&n.LivePersonaCardStrings.strings||n.LivePersonaCardStringsLpcMini&&n.LivePersonaCardStringsLpcMini.strings||i(new o("StartLivePersonaCardError","targetWindow.LivePersonaCardStrings is undefined."));var a=function(e,t){var n=t.targetWindow;return{refreshAuthToken:Y(t),logToExternalApplication:t.logMessage,contextType:t.clientContextType,strings:n.LivePersonaCardStringsLpcMini&&n.LivePersonaCardStringsLpcMini.strings||n.LivePersonaCardStrings&&n.LivePersonaCardStrings.strings,source:t.clientType,consumerCorrelationId:t.clientCorrelationId,activeFlights:e.Flights,isDebug:!1,culture:t.culture,dataCallbacks:t.dataCallbacks,actionCallbacks:t.actionCallbacks,telemetryCallbacks:t.telemetryCallbacks,dataUpdateBroadcaster:t.dataUpdateBroadcaster,privateDataCallbacks:t.privateDataCallbacks,options:t.options?t.options:{hideDocumentFilter:!1},theme:t.theme,lokiUrl:e.LokiUrl,lokiVersion:e.LokiVersion,tenantAadObjectId:e.TenantAadObjectId,userAadObjectId:e.UserAadObjectId,userPuid:e.UserPuid,ecsConfigIds:e.EcsConfigIds,ecsETag:e.EcsEtag,loggedInUserUpn:e.Upn,loggedInUserTeamsMri:t.loggedInUserTeamsMri,complianceEnvironment:t.complianceEnvironment,userDisplayName:e.UserDisplayName}}(e,t);n.LPC.start(a),r()}catch(e){i(new o("StartLivePersonaCardError",e.name))}}),0)}))}function Y(e){return function(t){e.getAuthToken((function(e,n){t(e,"",n,void 0)}),(function(e,n){t("",e,n,void 0)}))}}var Z,ee="e5ad760145754ffc9704e67c800087f2-dc72ff20-3e8a-401a-b9a8-ec72e4dd3e22-7257",te="e5ad760145754ffc9704e67c800087f2-fe4f92a6-9453-4f06-a3f9-52484ba9c6a1-7193",ne="e5ad760145754ffc9704e67c800087f2-5eda57b1-3b30-42c8-a461-bf3c6ee769d8-7057",re="e5ad760145754ffc9704e67c800087f2-e57f210b-942a-4f32-aaa3-2fd7b8d44a62-7359",oe="e5ad760145754ffc9704e67c800087f2-e2685720-0f91-4c64-acd6-32359f3b1c29-6998",ie="",ae="";function se(e){switch(e.complianceEnvironment){case"Blackforest":return te;case"GccHigh":return ne;case"DoD":return re;case"Gallatin":return oe;case"AG08":return ie;case"AG09":return ae;case"GccModerate":case"Prod":default:return ee}}function ce(e){return{ErrorType:e.name,ErrorMessage:e.message||"",RootCorrelationId:e.rootCorrelationId||"",IsExpected:e.isExpected||!1,IsClientOnline:navigator&&void 0!==typeof navigator.onLine?navigator.onLine:""}}function ue(e){var t={};return Object.keys(e).forEach((function(n){t["Perf_"+n]=e[n].toString()})),t}!function(e){e.getAuthToken="GetAuthTokenDuration",e.getAuthTokenFromStart="GetAuthTokenFromStartDuration",e.getLokiConfig="GetLokiConfigDuration",e.getLokiConfigFromStart="GetLokiConfigFromStartDuration",e.getLpcBundles="GetLpcBundlesDuration",e.getLpcBundlesFromStart="GetLpcBundlesFromStartDuration",e.startLpc="StartLpcDuration",e.startLpcFromStart="StartLpcFromStartDuration",e.getLpeBundles="GetLpeBundlesDuration",e.getLpeBundlesFromStart="GetLpeBundlesFromStartDuration"}(Z||(Z={}));var le=function(){function e(e){this.targetWindow=e,this.start=this.getCurrentTime(),this.timings={}}return e.prototype.measureFromStart=function(e){this.timings[e]=Math.round(this.getCurrentTime()-this.start)},e.prototype.startCustomTiming=function(e){try{this.targetWindow.performance.mark(e+"-start")}catch(e){}},e.prototype.endCustomTiming=function(e){try{this.targetWindow.performance.mark(e+"-end"),this.targetWindow.performance.measure(e,e+"-start",e+"-end");var t=this.targetWindow.performance.getEntriesByName(e)[0];this.timings[e]=Math.round(t.duration)}catch(e){}},e.prototype.getAllTimings=function(){var e=this;try{var t=this.targetWindow.performance.getEntriesByType("resource");t&&t.forEach((function(t){if(t&&t.name){var n=t.name.toLowerCase(),r=!1;-1!==n.indexOf("authtoken/loki")?(n="AuthRequestDuration",r=!0):-1!==n.indexOf("service.svc?action=getclientaccesstoken&ep=1&app=mail")?(n="AuthRequestDuration",r=!0):-1!==n.indexOf("/lpc/versionless/livepersonacard_")?(n="LpcBundleRequestDuration",r=!0):-1!==n.indexOf("/lpc/versionless/livepersonacardstrings")?(n="LpcStringsRequestDuration",r=!0):-1!==n.indexOf("/api/v1/configuration/")&&(n="InitConfigRequestDuration",r=!0),r&&(e.timings[n]=Math.round(t.duration))}}))}catch(e){}return this.timings},e.prototype.getCurrentTime=function(){return this.targetWindow.performance&&"function"==typeof this.targetWindow.performance.now?performance.now():Date.now()},e}();function fe(e){return void 0===e||"string"!=typeof e||""===e||null===e}function pe(e){return void 0===e||"function"!=typeof e}var de=["msit","df","ppe"],he=["Prod","Blackforest","GccModerate","GccHigh","DoD","Gallatin","AG08","AG09"];function ge(e){var t="";if(e){var n=[];fe(e.culture)&&n.push("culture"),fe(e.clientType)&&n.push("clientType"),fe(e.clientContextType)&&n.push("clientContextType"),fe(e.clientCorrelationId)&&n.push("clientCorrelationId"),pe(e.logMessage)&&n.push("logMessage"),pe(e.getAuthToken)&&n.push("getAuthToken"),n.length>0&&(t="Invalid required parameter(s): "+n.join(", ")+". Check the values and types you're passing. "),e.region&&-1===de.indexOf(e.region.toLowerCase().trim())&&(t+="Invalid region value. Allowed values are: empty string for production environments, and "+de.join(", ")+" for pre-production environments. "),-1===he.indexOf(e.complianceEnvironment)&&(t+="Environment is missing or wrong. Allowed values are: "+he.join(", ")+". We currently don't support other Sovereign Clouds.")}else t="Config must be defined.";if(t)throw new o("ValidateBootstrapperConfigError",t)}var ve=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},me=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},be=2,ye=0;function we(e,t,n){return ve(this,void 0,void 0,(function(){var r,o;return me(this,(function(i){switch(i.label){case 0:return(o=F(t)).lpeConfig?(r=o.lpeConfig,[3,3]):[3,1];case 1:return[4,Ce(e,t,n)];case 2:r=i.sent(),o.lpeConfig=r,i.label=3;case 3:return[2,r]}}))}))}function Ce(e,t,n){return ve(this,void 0,void 0,(function(){var r,o;return me(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,8]),[4,A(e,t,n)];case 1:return r=i.sent(),[3,8];case 2:return(o=i.sent()).statusCode&&401===o.statusCode?[4,s(void 0,t.getAuthToken,n)]:[3,4];case 3:e=i.sent(),i.label=4;case 4:return ye<be?(ye++,[4,we(e,t,n)]):[3,6];case 5:return r=i.sent(),[3,7];case 6:throw o.numberOfRetries=ye,o;case 7:return[3,8];case 8:return[2,r]}}))}))}var Te="livepersonaeditor_with-react",ke="livepersonaeditor_without-react",Le="livepersonaeditorstrings",xe="iscapiv3enabled",Ae="withreact";function Pe(e,t){if(-1===e.Flights.indexOf(xe))return Promise.reject(new o("LoadLivePersonaEditorScriptError","LPE not enabled",e.RootCorrelationId));var n=[e.Resources[Le],e.Flights.indexOf(Ae)>-1?e.Resources[Te]:e.Resources[ke]];return Promise.all(n.map((function(e){return W(e,t)}))).then((function(){return n}))}var Se=function(){return(Se=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Oe=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Ee=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};function Ie(e){return Oe(this,void 0,void 0,(function(){var t,n,o,i=this;return Ee(this,(function(a){return t=new le(window),n=F(e),o=function(){return F(e).ariaLogger},!n.forceRefreshLpeInitializationPromise&&n.lpeInitializationPromise?[2,n.lpeInitializationPromise]:(n.lpeInitializationPromise=new Promise((function(n,r){return Oe(i,void 0,void 0,(function(){var i,a,c,u,l,f;return Ee(this,(function(p){switch(p.label){case 0:i=se(e),p.label=1;case 1:return p.trys.push([1,6,,7]),ge(e),t.startCustomTiming(Z.getAuthToken),[4,s(e.authToken,e.getAuthToken,window)];case 2:return a=p.sent(),t.endCustomTiming(Z.getAuthToken),t.measureFromStart(Z.getAuthTokenFromStart),t.startCustomTiming(Z.getLokiConfig),[4,we(a,e,window)];case 3:return c=p.sent(),t.endCustomTiming(Z.getLokiConfig),t.measureFromStart(Z.getLokiConfigFromStart),t.startCustomTiming(Z.getLpeBundles),[4,Pe(c,window)];case 4:return p.sent(),t.endCustomTiming(Z.getLpeBundles),t.measureFromStart(Z.getLpeBundlesFromStart),[4,o().updateContextWithLokiDataAsync(c,i).catch((function(){}))];case 5:return p.sent(),(u=ue(t.getAllTimings())).RootCorrelationId=c.RootCorrelationId,u.isConsumer=e.isConsumer,o().logEventAsync({name:"initializeLivePersonaEditor_success",properties:u},i),n(c),[3,7];case 6:return l=p.sent(),f=ue(t.getAllTimings()),o().logEventAsync({name:"initializeLivePersonaEditor_failure",properties:Se(Se(Se({},ce(l)),f),{isConsumer:e.isConsumer})},i),r("Failed to initialize Live Persona Editor: "+l.name+" "+l.message),[3,7];case 7:return[2]}}))}))})),n.lpeInitializationPromise.catch((function(){setTimeout((function(){n.forceRefreshLpeInitializationPromise=!0}),r)})),[2,n.lpeInitializationPromise])}))}))}var je=function(){return(je=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Re=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},De=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};try{var Fe=window.document.createElement("link"),Me=Boolean("onmscontentzoom"in window.document);Fe.rel=Me?"dns-prefetch":"preconnect",Fe.href="https://res-1.cdn.office.net/",window.document.head.appendChild(Fe)}catch(e){}function Ge(e){return Re(this,void 0,void 0,(function(){var t,n,o,i,a=this;return De(this,(function(c){return t=F(e),n=function(){return F(e).ariaLogger},!t.forceRefreshInitializationPromise&&t.initializationPromise?[2,t.initializationPromise]:(o=t.bootstrapperConfig.targetWindow,i=new le(o),t.forceRefreshInitializationPromise=!1,t.initializationPromise=new Promise((function(r,c){return Re(a,void 0,void 0,(function(){var a,u,l,f,p,d;return De(this,(function(h){switch(h.label){case 0:a=se(e),h.label=1;case 1:return h.trys.push([1,7,,8]),ge(e),i.startCustomTiming(Z.getAuthToken),[4,s(e.authToken,e.getAuthToken,o)];case 2:return u=h.sent(),i.endCustomTiming(Z.getAuthToken),i.measureFromStart(Z.getAuthTokenFromStart),i.startCustomTiming(Z.getLokiConfig),[4,U(u,e,o)];case 3:return l=h.sent(),i.endCustomTiming(Z.getLokiConfig),i.measureFromStart(Z.getLokiConfigFromStart),i.startCustomTiming(Z.getLpcBundles),[4,Q(l,o)];case 4:return h.sent(),i.endCustomTiming(Z.getLpcBundles),i.measureFromStart(Z.getLpcBundlesFromStart),i.startCustomTiming(Z.startLpc),[4,K(l,t.bootstrapperConfig)];case 5:return h.sent(),i.endCustomTiming(Z.startLpc),i.measureFromStart(Z.startLpcFromStart),[4,n().updateContextWithLokiDataAsync(l,a).catch((function(){}))];case 6:return h.sent(),(f=ue(i.getAllTimings())).RootCorrelationId=l.RootCorrelationId,f.isConsumer=e.isConsumer,n().logEventAsync({name:"initializeLivePersonaCard_success",properties:f},a),r(),[3,8];case 7:return p=h.sent(),d=ue(i.getAllTimings()),n().logEventAsync({name:"initializeLivePersonaCard_failure",properties:je(je(je({},ce(p)),d),{isConsumer:e.isConsumer})},a),c("Failed to initialize Live Persona Card: "+p.name+" "+p.message),[3,8];case 8:return[2]}}))}))})),t.initializationPromise.catch((function(){t.forceRefreshInitializationTimeout=window.setTimeout((function(){t&&(t.forceRefreshInitializationPromise=!0)}),r)})),[2,t.initializationPromise])}))}))}function _e(e){!function(e){var t=D.get(e);if(t){var n=t.bootstrapperConfig.targetWindow;n&&(delete n.LPC,delete n.LivePersonaCardHoverTarget,delete n.LivePersonaCardHoverTargetV2,delete n.LivePersonaCardStrings,delete n.LivePersonaCardStringsLpcMini,delete n.MeetingInsightsV2,delete n.MidgardBootstrapper,delete n.PersonaInsightRing,delete n.LPE),delete t.bootstrapperConfig.targetWindow,delete t.ariaLogger,delete t.initializationPromise,delete t.bootstrapperConfig,clearTimeout(t.forceRefreshInitializationTimeout)}D.delete(e)}(e)}function Ne(e){return Re(this,void 0,void 0,(function(){var t;return De(this,(function(n){switch(n.label){case 0:return t=F(e),[4,s(e.authToken,e.getAuthToken,t.bootstrapperConfig.targetWindow)];case 1:return[2,U(n.sent(),e,t.bootstrapperConfig.targetWindow)]}}))}))}},,,,function(e,t,n){"use strict";var r=n(20),o=n(8),i=n(5),a=n(0),s=n(4),c=function(){return(c=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},u=function(){function e(e,t,n,r,o,i,s){this.eventHubPromise=e,this.monitoringData=t,this.scenarioName=n,this.featureName=r,this.staticProperties=o,this.lookupError=i,this.isVerboseLoggingEnabled=s,this.isFinished=!1,this.isInvalid=!1,this.lastScenarioState=a.a.MONITOR_IN_INVALID_STATE,this.transactionId=function(){for(var e=function(){return"object"==typeof window&&window.crypto&&(e=new Uint8Array(31),window.crypto.getRandomValues(e),e)||function(){for(var e=new Array(31),t=0;t<31;t++)e[t]=Math.floor(16*Math.random());return e}();var e}(),t=0,n="",r=0;r<36;r++)switch(r){case 8:case 13:case 18:case 23:t+=1,n+="-";break;case 14:t+=1,n+="4";break;case 19:n+=(e[r-t]%4+8).toString(16);break;default:n+=(e[r-t]%16).toString(16)}return n}(),this.start()}return e.prototype.flush=function(){return this.eventHubPromise.then((function(e){return e.broadcastFlush()}))},e.prototype.success=function(e,t){this.endEvent(e,a.a.SUCCESS,t)},e.prototype.expectedFailure=function(e,t){this.endEvent(e,a.a.EXPECTED_FAILURE,t)},e.prototype.unexpectedFailure=function(e,t){this.endEvent(e,a.a.UNEXPECTED_FAILURE,t)},e.prototype.dispose=function(){this.isInvalid||!this.isFinished?this.broadcastEvent(void 0,a.a.MONITOR_IN_INVALID_STATE):this.broadcastEvent(this.lastTag,this.lastScenarioState,this.lastProperties)},e.prototype.start=function(){this.startTime=(new Date).getTime()},e.prototype.endEvent=function(e,t,n){this.isFinished&&(this.isInvalid=!0),this.startTime?(this.duration=(new Date).getTime()-this.startTime,this.lastScenarioState=t):this.lastScenarioState=a.a.MONITOR_IN_INVALID_STATE,this.lastTag=e,this.lastProperties=n,this.isFinished=!0,this.dispose()},e.prototype.broadcastEvent=function(e,t,n){return function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))}(this,void 0,void 0,(function(){var i,a,c,u,l,f;return function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}(this,(function(p){switch(p.label){case 0:return!Object(s.a)(this.featureName)||Object(s.b)(this.featureName)&&!this.isVerboseLoggingEnabled?[2]:this.scenarioName&&this.monitoringData.source&&this.monitoringData.clientCorrelationId?(i=e?this.scenarioName+"_"+t+"_"+e:this.scenarioName+"_"+t,[4,this.eventHubPromise]):[3,5];case 1:return a=p.sent(),u=(c=a).broadcastEvent,f={eventId:i,version:this.monitoringData.version?this.monitoringData.version:o.a,type:"QoS"},n&&Object(r.a)(n.midgardError)?[4,this.lookupError(n.midgardError)]:[3,3];case 2:return l=p.sent(),[3,4];case 3:l=void 0,p.label=4;case 4:u.apply(c,[(f.midgardError=l,f.source=this.monitoringData.source,f.featureName=this.featureName,f.clientCorrelationid=this.monitoringData.clientCorrelationId,f.qosScenarioName=this.scenarioName,f.qosEventType=t,f.qosTagId=null===e?void 0:e,f.duration=this.duration,f.properties=this.getProperties(n),f)]),p.label=5;case 5:return[2]}}))}))},e.prototype.getProperties=function(e){var t;return c(c(c(c({},e),((t={})[i.a.CLIENT_TIMESTAMP]=(new Date).getTime().toString(),t[i.a.TRANSACTION_ID]=this.transactionId,t)),this.monitoringData.properties),this.staticProperties())},e}();t.a=u},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(7);function o(e){return"object"==typeof e&&!!e&&Object(r.a)(e,"family")&&Object(r.a)(e,"code")&&"string"==typeof e.family&&"number"==typeof e.code}}])}}]);
//# sourceMappingURL=owa.2109.js.map
self.scriptsLoaded['owa.2109.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.2109.js'] = (new Date()).getTime();