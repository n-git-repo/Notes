self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.847.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[847],{1091:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(315);function o(e){if(i.b.unseenItems){let t=i.b.unseenItems.get(e);if(null==t?void 0:t.visible)return!0}return!1}},1092:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(20);const o=new i.c(()=>n.e(1360).then(n.bind(null,2651))),r=new i.a(o,e=>e.endLightningImp)},1204:function(e,t,n){"use strict";var i=n(21),o=n(875),r=n(0),a=n.n(r),s=n(1091);function c(e,t){const n=(t,n)=>a.a.createElement(l,Object.assign({},t),a.a.createElement(e,Object.assign({},t)));return n.displayName=e.displayName,t?a.a.forwardRef(n):n}const l=Object(i.a)((function(e){const{lid:t,when:n,series:i,children:r,disposeOnUnmount:c=!0}=e;return a.a.useEffect(()=>(Object(o.b)(t,n,i),()=>{c&&o.c.importAndExecute(t)}),[]),r&&Object(s.a)(t)?a.a.createElement(a.a.Fragment,null,r):null}));var d=n(1445);n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return l})),n.d(t,"e",(function(){return s.a})),n.d(t,"d",(function(){return d.a})),n.d(t,"b",(function(){return o.a}))},1445:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(1092);function o(e,t){i.a.importAndExecute(e,t)}},1467:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(68),o=n(942);function r(e,t){Object.keys(o.a).some(n=>o.a[n]==t&&(Object(i.p)(e,{key:n,id:t},{isCore:!0}),!0))}},1471:function(e,t,n){"use strict";var i=n(798),o=n(1),r=n(0),a=n(412),s=n(471),c=n(532),l=Object(s.a)(),d=function(e,t){r.useImperativeHandle(e.componentRef,(function(){return{focus:function(){t.current&&t.current.focus()}}}),[t])},u=function(e,t){t.as;var n=t.disabled,i=t.target,r=t.href,a=(t.theme,t.getStyles,t.styles,t.componentRef,t.underline,Object(o.__rest)(t,["as","disabled","target","href","theme","getStyles","styles","componentRef","underline"]));return"string"==typeof e?"a"===e?Object(o.__assign)({target:i,href:n?void 0:r},a):"button"===e?Object(o.__assign)({type:"button",disabled:n},a):Object(o.__assign)(Object(o.__assign)({},a),{disabled:n}):Object(o.__assign)({target:i,href:r,disabled:n},a)},m=r.forwardRef((function(e,t){var n=function(e,t){var n=e.as,i=e.className,s=e.disabled,m=e.href,b=e.onClick,p=e.styles,f=e.theme,g=e.underline,h=r.useRef(null),O=Object(a.a)(h,t);d(e,h),Object(c.b)(h);var v=l(p,{className:i,isButton:!m,isDisabled:s,isUnderlined:g,theme:f}),j=n||(m?"a":"button");return{state:{},slots:{root:j},slotProps:{root:Object(o.__assign)(Object(o.__assign)({},u(j,e)),{"aria-disabled":s,className:v.root,onClick:function(e){s?e.preventDefault():b&&b(e)},ref:O})}}}(e,t),i=n.slots,s=n.slotProps;return r.createElement(i.root,Object(o.__assign)({},s.root))}));m.displayName="LinkBase";var b=n(8),p={root:"ms-Link"};n.d(t,"a",(function(){return f}));var f=Object(i.a)(m,(function(e){var t,n,i,o,r,a,s=e.className,c=e.isButton,l=e.isDisabled,d=e.isUnderlined,u=e.theme,m=u.semanticColors,f=m.link,g=m.linkHovered,h=m.disabledText,O=m.focusBorder,v=Object(b.getGlobalClassNames)(p,u);return{root:[v.root,u.fonts.medium,{color:f,outline:"none",fontSize:"inherit",fontWeight:"inherit",textDecoration:d?"underline":"none",selectors:(t={".ms-Fabric--isFocusVisible &:focus":{boxShadow:"0 0 0 1px "+O+" inset",outline:"1px auto "+O,selectors:(n={},n[b.HighContrastSelector]={outline:"1px solid WindowText"},n)}},t[b.HighContrastSelector]={borderBottom:"none"},t)},c&&{background:"none",backgroundColor:"transparent",border:"none",cursor:"pointer",display:"inline",margin:0,overflow:"inherit",padding:0,textAlign:"left",textOverflow:"inherit",userSelect:"text",borderBottom:"1px solid transparent",selectors:(i={},i[b.HighContrastSelector]={color:"LinkText",forcedColorAdjust:"none"},i)},!c&&{selectors:(o={},o[b.HighContrastSelector]={MsHighContrastAdjust:"auto",forcedColorAdjust:"auto"},o)},l&&["is-disabled",{color:h,cursor:"default"},{selectors:{"&:link, &:visited":{pointerEvents:"none"}}}],!l&&{selectors:{"&:active, &:hover, &:active:hover":{color:g,textDecoration:"underline",selectors:(r={},r[b.HighContrastSelector]={color:"LinkText"},r)},"&:focus":{color:f,selectors:(a={},a[b.HighContrastSelector]={color:"LinkText"},a)}}},v.root,s]}}),void 0,{scope:"Link"})},18271:function(e){e.exports=JSON.parse('{"b":"nRc","d":"oRc","e":"pRc","a":"xRc","c":"HRc"}')},18272:function(e,t,n){var i=n(18273);"string"==typeof i&&(i=[[e.i,i,""]]);var o={transform:void 0};n(84)(i,o);i.locals&&(e.exports=i.locals)},18273:function(e,t,n){(t=e.exports=n(83)(!1)).push([e.i,".DeeFmJXwyjSgV0TVaQ5DL{min-width:730px;overflow:hidden}html[dir] ._2eluIqXlD8vKG35lh86pS9{background-color:var(--white)}.rV9-g445Skki_DH5rxkza{max-width:730px;width:100%;display:block;height:125px}html[dir] .rV9-g445Skki_DH5rxkza{margin-top:35px;margin-bottom:25px}html[dir] ._3rDZhSBKBfo7Mbncw0UWAO{padding:15px 30px 25px}html[dir=ltr] ._1bMGCpUJCHAqckQYYaqse{right:0}html[dir=rtl] ._1bMGCpUJCHAqckQYYaqse{left:0}._1PgroKaoqm2ob7Dd1RGcWM{max-width:250px}html[dir=ltr] ._2NrS9LsCUzHKFddAMoDux_{margin-right:200px}html[dir=rtl] ._2NrS9LsCUzHKFddAMoDux_{margin-left:200px}._1IWevY4_W_EK3Gnrk0-J3a{font-size:14px;color:var(--themePrimary);font-weight:100}html[dir] ._1IWevY4_W_EK3Gnrk0-J3a{background-color:var(--white);border:none}._1IWevY4_W_EK3Gnrk0-J3a:hover{color:var(--themeDarker)}._2pD57GxfrmlgYO_d7aYYDk{max-width:670px}",""]),t.locals={content:"DeeFmJXwyjSgV0TVaQ5DL",imageWrapper:"_2eluIqXlD8vKG35lh86pS9",image:"rV9-g445Skki_DH5rxkza",textAndButtons:"_3rDZhSBKBfo7Mbncw0UWAO",dialogFooter:"_1bMGCpUJCHAqckQYYaqse",maxWidthButton:"_1PgroKaoqm2ob7Dd1RGcWM",posManageButtonExp:"_2NrS9LsCUzHKFddAMoDux_",linkButton:"_1IWevY4_W_EK3Gnrk0-J3a",textSection:"_2pD57GxfrmlgYO_d7aYYDk"}},18274:function(e){e.exports=JSON.parse('{"b":"IRc","d":"JRc","c":"KRc","a":"LRc"}')},18275:function(e,t,n){var i=n(18276);"string"==typeof i&&(i=[[e.i,i,""]]);var o={transform:void 0};n(84)(i,o);i.locals&&(e.exports=i.locals)},18276:function(e,t,n){(t=e.exports=n(83)(!1)).push([e.i,"._3Pj48UcrMcgKl7HbJtu3iP{min-width:730px;overflow:hidden}html[dir] ._1UwR95iKtGbSI295AH5TKC{background-color:var(--white)}._3V7Bu5RlQHuhnIm2aH9VB9{max-width:730px;width:100%;display:block;height:125px}html[dir] ._3V7Bu5RlQHuhnIm2aH9VB9{margin-top:35px;margin-bottom:25px}html[dir] ._3WUbCDecXB91oGRX_GVfMa{padding:15px 30px 25px}html[dir=ltr] ._3XApHoN3aFxqt0zYvV4FCF{right:0}html[dir=rtl] ._3XApHoN3aFxqt0zYvV4FCF{left:0}.rwQ3nOYV0Fnf1BfG0YqHt{max-width:250px}html[dir=ltr] ._2tC2W0DXg5abnJy08gqu5Q{margin-right:200px}html[dir=rtl] ._2tC2W0DXg5abnJy08gqu5Q{margin-left:200px}.dHHamxS8jcGA4kILCBj46{font-size:14px;color:var(--themePrimary);font-weight:100}html[dir] .dHHamxS8jcGA4kILCBj46{background-color:var(--white);border:none}.dHHamxS8jcGA4kILCBj46:hover{color:var(--themeDarker)}._1ljLu5eEp58h9s10hLtnhe{max-width:670px}",""]),t.locals={content:"_3Pj48UcrMcgKl7HbJtu3iP",imageWrapper:"_1UwR95iKtGbSI295AH5TKC",image:"_3V7Bu5RlQHuhnIm2aH9VB9",textAndButtons:"_3WUbCDecXB91oGRX_GVfMa",dialogFooter:"_3XApHoN3aFxqt0zYvV4FCF",maxWidthButton:"rwQ3nOYV0Fnf1BfG0YqHt",posManageButtonExp:"_2tC2W0DXg5abnJy08gqu5Q",linkButton:"dHHamxS8jcGA4kILCBj46",textSection:"_1ljLu5eEp58h9s10hLtnhe"}},18277:function(e){e.exports=JSON.parse('{"c":"kRc","b":"lRc","a":"mRc"}')},19763:function(e,t,n){"use strict";n.r(t);var i=n(21),o=n(1204),r=n(3957),a=n(0),s=Object(o.c)(Object(i.a)((function(e){const t=a.useCallback(()=>Object(o.d)(e.lid),[e.lid]);return a.createElement(r.c,{invokedBy:"",isFirstSurvey:e.isFirstSurvey,isOutlookNps:!0,onClose:t})}))),c=n(25),l=n(30),d=n(2);const u=Object(d.action)("ACCEPT_TARGETED_ADS"),m=Object(d.action)("ACCEPT_FIRSTPARTYCOOKIE"),b=Object(d.action)("MANAGE_ADS_OPTIONS",e=>({showGdprPartnerListViewV3:e}));var p=n(5207),f=n(4806),g=n(4811),h=n(3420);var O=n(711),v=n(1441),j=n(1432),S=n(1471),w=n(2721),A=n(68),C=n(3),E=n(6),x=n(18271),P=n(18272),k=n.n(P),y=n(209),_=n.n(y);const F=_.a.bind(k.a);function I(){const e=o.b.GdprAdsV3ClearNull;return a.createElement(D,{lid:e,when:R})}const D=Object(o.c)(Object(i.a)((function(e){const t=F(k.a.linkButton,k.a.maxWidthButton,"displayNone"),n=F(k.a.maxWidthButton,k.a.linkButton,k.a.posManageButtonExp),i=F(k.a.maxWidthButton),r=`https:${Object(C.s)()}assets/mail/pwa/v1/svgs/Outlook_64x.svg`;return a.createElement(w.a,{isOpen:!0},a.createElement("div",{className:k.a.content},a.createElement("div",{className:k.a.imageWrapper},a.createElement("img",{className:k.a.image,src:r})),a.createElement("div",{className:k.a.textAndButtons},a.createElement("div",{className:k.a.textSection},a.createElement("div",null,Object(E.b)(x.b)," ",a.createElement(S.a,{href:"https://privacy.microsoft.com/privacystatement",target:"_blank"},Object(E.b)(x.d)))),a.createElement(j.a,{className:k.a.dialogFooter},a.createElement(O.a,{className:t,onClick:()=>{Object(o.d)(e.lid),b(!0),Object(A.p)("gdprAdV3TcfPromptSeeVendorClickE0",{},{isCore:!0})},text:Object(E.b)(x.e)}),a.createElement(O.a,{className:n,onClick:()=>{Object(o.d)(e.lid),b(!1),Object(A.p)("gdprAdV3TcfPromptManageClickE10",{},{isCore:!0})},text:Object(E.b)(x.c)}),a.createElement(v.a,{className:i,onClick:()=>{Object(o.d)(e.lid),u(),Object(A.p)("gdprAdV3TcfPromptAcceptClickE10",{},{isCore:!0})},text:Object(E.b)(x.a)})))))})));async function R(e){await async function(){var e;if(!Object(g.a)()||!Object(h.m)())return!1;let t,n,i=await Object(f.e)();if(null==i||""==i)return!0;try{t=p.TCString.decode(i)}catch(e){return!0}if(168==t.cmpId){let i=await Object(f.d)();if(Object(c.k)("fwk-gdprAds-TestSkipFirstCookieCheck")&&(i=-1),-1==i){if(!(10==(null===(e=null==t?void 0:t.purposeConsents)||void 0===e?void 0:e.size)))return!0;m()}n=Object(c.k)("fwk-gdprAds-TestSkipTcfCheck")}else n=!0;return n}()&&e()}var N=n(1198);Object(d.orchestrator)(m,async()=>{let e;const t=Object(N.g)(N.d.GdprAdsV3);null==t.selectedVendorId?e=[2]:(e=t.selectedVendorId,e=e.filter(e=>3!=e),e.push(2));const n=Object.assign(Object.assign({},t),{selectedVendorId:e});return N.i.importAndExecute(N.d.GdprAdsV3,n)});Object(d.orchestrator)(u,async()=>{const e=await Object(f.c)({allStoreAndAccessDevice:!0,allowPersonalisedAdsSelectBasicAd:!0,allowPersonalisedAdsCreatePersonalisedAdsProfile:!0,allowPersonalisedAdsSelectPersonalisedAds:!0,allowPersonalisedAdsCreatePersonalisedContentProfile:!0,allowPersonalisedAdsSelectPersonalisedContent:!0,allowPersonalisedAdsMeasureAdPerf:!0,allowPersonalisedAdsMeasureContentPerformance:!0,allowPersonalisedAdsApplyMarketResearch:!0,allowDevelopAndImproveProduct:!0,allowPreciseGeoDataAndIdentifyDeviceGeoData:!0,allowPreciseGeoDataAndIdentifyDeviceScanDevice:!0},!0,[]),t=Object(N.g)(N.d.GdprAdsV3),n=Object.assign(Object.assign(Object.assign({},t),{allStoreAndAccessDevice:!0,allowDevelopAndImproveProduct:!0,allowPersonalisedAds:!0,allowPersonalisedAdsSelectBasicAd:!0,allowPersonalisedAdsApplyMarketResearch:!0,allowPersonalisedAdsMeasureContentPerformance:!0,allowPersonalisedAdsSelectPersonalisedAds:!0,allowPersonalisedAdsMeasureAdPerf:!0,allowPersonalisedAdsSelectPersonalisedContent:!0,allowPersonalisedAdsCreatePersonalisedContentProfile:!0,allowPersonalisedAdsCreatePersonalisedAdsProfile:!0,allowPreciseGeoDataAndIdentifyDevice:!0,allowPreciseGeoDataAndIdentifyDeviceScanDevice:!0,allowPreciseGeoDataAndIdentifyDeviceGeoData:!0,disselectedVendorId:[],selectedVendorId:[2]}),e?{encodedTCString:e.encodedTCString,vendorListVersion:e.vendorListVersion}:null);return Object(f.g)(e.encodedTCString),Object(f.f)(2),N.i.importAndExecute(N.d.GdprAdsV3,n)});var T=n(2939);Object(d.orchestrator)(b,e=>{e.showGdprPartnerListViewV3?T.f.importAndExecute("general","advertisement","showpartnerlist"):T.f.importAndExecute("general","advertisement")});const V=Object(d.action)("ACCEPT_LGPD_OPTIN"),B=Object(d.action)("MANAGE_LGPD_ADS_OPTIONS");async function G(){if(!Object(g.a)()||!Object(h.n)())return!1;if(0==await async function(){const e=await N.j.import(),t=await e(N.d.LgpdAds);return null==t||null==t.optInBit?0:t.optInBit}())return!0;return Object(c.k)("fwk-lgdpAds-TestSkipOptInCheck")}var M=n(18274),L=n(18275),U=n.n(L);const H=_.a.bind(U.a);function W(){const e=o.b.LgpdAds;return a.createElement(Y,{lid:e,when:K})}const Y=Object(o.c)(Object(i.a)((function(e){const t=H(U.a.maxWidthButton,U.a.linkButton,U.a.posManageButtonExp),n=H(U.a.maxWidthButton),i=`https:${Object(C.s)()}assets/mail/pwa/v1/svgs/Outlook_64x.svg`;return a.createElement(w.a,{isOpen:!0},a.createElement("div",{className:U.a.content},a.createElement("div",{className:U.a.imageWrapper},a.createElement("img",{className:U.a.image,src:i})),a.createElement("div",{className:U.a.textAndButtons},a.createElement("div",{className:U.a.textSection},a.createElement("div",null,Object(E.b)(M.b)," ",a.createElement(S.a,{href:"https://privacy.microsoft.com/privacystatement",target:"_blank"},Object(E.b)(M.d)))),a.createElement(j.a,{className:U.a.dialogFooter},a.createElement(O.a,{className:t,onClick:()=>{Object(o.d)(e.lid),B(),Object(A.p)("lgpdAdsManageClick3",{},{isCore:!0})},text:M.c}),a.createElement(v.a,{className:n,onClick:()=>{Object(o.d)(e.lid),V(),Object(A.p)("lgpdAdsAcceptClick3",{},{isCore:!0})},text:M.a})))))})));async function K(e){await G()&&e()}var q=n(5276);Object(d.orchestrator)(V,async()=>{const e=Object(N.g)(N.d.LgpdAds),t=Object.assign(Object.assign({},e),{optInBit:2});return Object(q.d)(2),Object(q.a)(),N.i.importAndExecute(N.d.LgpdAds,t)});Object(d.orchestrator)(B,e=>{T.f.importAndExecute("general","advertisementlgpd")});var z=n(199),J=n(18277),Q=Object(o.c)(Object(i.a)((function(e){const t=a.useCallback(()=>Object(o.d)(e.lid),[e.lid]);return a.createElement(r.c,{isFirstSurvey:e.isFirstSurvey,isOutlookNps:!1,onClose:t,ratingsHeader:Object(E.b)(J.c),negativeLabel:Object(E.b)(J.b),positiveLabel:Object(E.b)(J.a),invokedBy:"SuiteNps"})})));const X=Object(o.c)(Object(i.a)((function(e){return a.useEffect(()=>{window.O365Shell.FlexPane.OpenFlexPaneForProvider("OwaSettings"),Object(o.d)(e.lid)},[]),a.createElement(a.Fragment,null)})));var $=n(5),Z=n(7684);const ee=document.createElement("div");function te(e){const t=t=>{const{PolicySettings:n,UserOptions:i,IsConsumerChild:o}=Object(l.a)();let r=!0;(null==i?void 0:i.FirstOWAReactMailLogon)&&!isNaN(Date.parse(i.FirstOWAReactMailLogon))&&Object($.Ub)()<=Object($.e)(Object($.Ub)("UTC",new Date(i.FirstOWAReactMailLogon).toISOString()),7)&&(r=!1),Object(c.k)("usv-nps")&&(null==n?void 0:n.NpsSurveysEnabled)&&r&&e.isOcpsNpsPolicyEnabled&&!o&&setTimeout(()=>t(),1e3)};return a.createElement(a.Fragment,null,a.createElement(W,null),a.createElement(I,null),a.createElement(s,{lid:o.b.UserVoiceSatisfactionFirstRun,when:t,isFirstSurvey:!0}),a.createElement(s,{lid:o.b.UserVoiceSatisfactionSecondRun,when:t,isFirstSurvey:!1}),a.createElement(Q,{isFirstSurvey:!0,lid:o.b.SuiteNps,when:t=>{const{PolicySettings:n,IsConsumerChild:i}=Object(l.a)();Object(c.k)("office-suite-nps")&&(null==n?void 0:n.NpsSurveysEnabled)&&e.isOcpsNpsPolicyEnabled&&!i&&t()}}),a.createElement(X,{lid:o.b.OptionsPaneLaunch,when:e=>{var t;const n=Object(l.a)();Object(c.k)("fwk-edgeEnabledThemes")&&!Object(c.k)("fwk-suiteThemes")&&n.UserOptions&&-1==(null===(t=n.UserOptions.ThemeStorageId)||void 0===t?void 0:t.indexOf("edge"))&&!n.UserOptions.IsDarkModeTheme&&e()},series:[o.b.OptionsPaneLaunch,o.b.ThemeOfTheDay]}))}async function ne(){const e=await Z.d.importAndExecute();document.body.appendChild(ee),z.render(a.createElement(a.StrictMode,null,a.createElement(te,{isOcpsNpsPolicyEnabled:e})),ee)}ee.id="lpv",n.d(t,"loadLightningPrimaryView",(function(){return ne}))},315:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var i=n(2),o=n(13);let r=Object(i.createStore)("lightningState",{unseenItems:new o.ObservableMap,lightedCount:0,lastShownId:null}),a=r()},3599:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const i=4e3},3957:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"g",(function(){return u}));var i=n(20),o=n(3599);n.d(t,"a",(function(){return o.a}));const r=new i.c(()=>Promise.all([n.e(1),n.e(2),n.e(3),n.e(4),n.e(6),n.e(7),n.e(8),n.e(11),n.e(16),n.e(354),n.e(563)]).then(n.bind(null,5968)));let a=new i.a(r,e=>e.launchInAppFeedback),s=new i.b(r,e=>e.postSuggestionAndSendLogDatapoint),c=new i.b(r,e=>e.showUserVoiceSuggestionDialog),l=Object(i.d)(r,e=>e.UserVoiceNps),d=Object(i.d)(r,e=>e.UserVoiceIdeasPane),u=new i.b(r,e=>e.userVoiceSuggestionStore)},7684:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return d}));var i=n(20);const o=new i.c(()=>Promise.all([n.e(0),n.e(1137)]).then(n.bind(null,11750)));let r=new i.a(o,e=>e.isFeedbackPolicyEnabled),a=new i.a(o,e=>e.isNpsSurveyPolicyEnabled),s=new i.a(o,e=>e.isOutlookRecommendationEnabled),c=new i.a(o,e=>e.isScreenshotPolicyEnabled),l=new i.a(o,e=>e.isContactPolicyEnabled),d=new i.a(o,e=>e.isContentPolicyEnabled)},875:function(e,t,n){"use strict";var i=n(315),o=n(22),r=n(7),a=n(13),s=n(2),c=Object(s.mutatorAction)("initializeLightning",(function(e){if(o.h.info("initialize lightning store"),Object(i.a)().lastShownId=null,Object(i.a)().lightedCount=0,Object(i.a)().unseenItems=new a.ObservableMap,e)for(let t of e)Object(i.a)().unseenItems.set(t.identity,t)}));var l=n(155);const d="ows/v1.0/lightning/items/unseen";function u(){return o.h.info("initialize lightning from server"),Object(l.b)(d).then(e=>{let t=e.map(m);c(t)})}function m(e){return e.category?{identity:e.id,visible:!1,category:e.category}:{identity:e,visible:!1}}var b=n(30);let p;const f="lightning",g="UnseenLightening";function h(){if(!p){const t=Object(r.c)(f);if(t)p=function(e){o.h.info("initialize lightning from override query parameter");let t=e.split(",").map(e=>({identity:e,visible:!1}));return c(t),Promise.resolve()}(t);else{let t=Object(b.a)().PrimeSettings;if(null==t?void 0:t.Items)for(let n of t.Items)if(n.Id===g&&n.Value){e=n.Value,o.h.info("initialize lightning from session data"),c(e.map(e=>({identity:e.id,visible:!1,category:e.category}))),p=Promise.resolve();break}p||(p=u())}}var e;return p}var O=n(1467);let v=Object(s.action)("lightup",e=>({id:e}));var j=v;Object(s.mutator)(v,e=>{o.h.info(`lightup - id:${e.id}`),Object(i.a)().lastShownId=e.id,Object(i.a)().lightedCount++;const t=Object(i.a)().unseenItems.get(e.id);t&&(t.visible=!0)}),Object(s.orchestrator)(v,(function(e){Object(O.a)("LIGHTUP",e.id)}));var S,w=n(483);function A(e,t){if(o.h.info(`lightupOrReject - id:${e}, recurrenceCount:${t}, lightedCount:${Object(i.a)().lightedCount}, lastShown:${Object(i.a)().lastShownId}`),Object(w.w)())return void o.h.info("lightning is disabled for deeplink");if(!Object(i.a)().unseenItems.has(e))return;(!Object(i.a)().lastShownId||function(e,t){let n=!1;const{lastShownId:o}=Object(i.a)();if(o&&t&&!function(){const{lastShownId:e,unseenItems:t}=Object(i.a)();return e&&t.has(e)&&t.get(e).visible}()){let i=t.indexOf(o),r=t.indexOf(e);i>=0&&i+1==r&&(n=!0)}return n}(e,t)||function(e){const t=Object(i.a)().unseenItems.get(e);return!!t&&t.category==S.UIFeatureDiscovery}(e)||function(e){const t=Object(i.a)().unseenItems.get(e);return!!t&&t.category==S.Compliance}(e))&&j(e)}function C(e,t,n){o.h.info(`beginLightning - id:${e}`),t(()=>{h().then(()=>A(e,n)).catch(t=>{o.h.warn(`something is wrong, lightning id:${e}, reason:${t}`)})})}!function(e){e.None="0",e.UpSell="1",e.FeatureDiscovery="2",e.TeachingMoment="3",e.UITeachingMoment="4",e.UIFeatureDiscovery="5",e.UIUpSell="6",e.JITNewUser="7",e.Compliance="8",e.SatCoreMetric="9",e.UpSellExperiment="10"}(S||(S={}));var E=n(942),x=n(1092);n.d(t,"d",(function(){return i.b})),n.d(t,"b",(function(){return C})),n.d(t,"a",(function(){return E.a})),n.d(t,"c",(function(){return x.a}))},942:function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e.UserVoiceSatisfactionFirstRun="0",e.UserVoiceSatisfactionSecondRun="1",e.ConsumerRefreshFRE="2",e.AnimatedConsumerRefreshFRE="3",e.AnimatedConsumerRefreshFRE2="4",e.SettingPanelFirstRunCallout="5",e.SettingIconFirstRunCallout="6",e.AddStorageAccountCallout="7",e.PremiumDomainConnectModal="8",e.WhatsNewFlexPane="10",e.FocusOtherOff="12",e.TargetedAdsGdprPrompt="13",e.WebPushPromotion="14",e.MailGraduatedNewFeatureCarousel="15",e.EdgePromotion="20",e.ActionableMessageTeachingUiTeachingBubblePolicy="21",e.GetStartedFlexPane="22",e.CalendarSurvey="23",e.MiniUserSurveyV1="25",e.TodoCalendarFRE="26",e.TodoMailFRE="27",e.GroupFilesHubFRE="28",e.AddCloudCacheAccountCallout="29",e.NewConsumerRecruitmentCampaign="30",e.InboxPlusFRE="31",e.BusinessCutoverCarousel="32",e.SuiteNps="33",e.InboxPlusEasyOn="34",e.InboxRulesFromDL="35",e.GdprAdsV2="36",e.TimePanelCombinedDndFRE="47",e.UaeEduPrivacyNotification="48",e.OutlookSpacesFRE="49",e.TodoFlaggedEmailList="50",e.DynamicLayoutFolderPaneCollapse="51",e.EdgeUpsell="56",e.OutlookSpacesCapturedPaneFRE="57",e.ProofingTeachingFreeUserFRE="58",e.ProofingTeachingPremiumUserFRE="59",e.OutlookSpacesNotePaneFRE="60",e.OutlookSpacesTasksPaneFRE="61",e.OutlookSpacesGoalsPaneFRE="62",e.DefaultOnlineMeetingSetting="63",e.QuickUseFRE="64",e.GdprAdsV3="65",e.SpeedyMeetingsEndEarlySetting="66",e.InboxPlusEasyOff="67",e.ShortenEventsDurationSetting="70",e.HoneybeeClipboard="71",e.AttachmentSaveToCloudOpenAndEdit="72",e.GdprAdsEPrivacy="73",e.AdminInstalledNewAddinsFRE="75",e.InsertLinkFREOpenCompose="76",e.InsertLinkFREAfterAttach="77",e.SpotlightFre="78",e.OverlayFolderPaneFre="79",e.SpotlightPropertyIcon="80",e.GdprAdsV3ClearNull="81",e.OptionsPaneLaunch="82",e.ThemeOfTheDay="83",e.SpeedyMeetingsTenant="84",e.MailtoProtocolHandler="85",e.UnpinnedAdminAddinsFRE="86",e.LgpdAds="87",e.CommercialBizBar="88",e.CollabSpaceCreate="89",e.CollabSpaceView="90",e.AddSignature="91",e.BoardViewMultipleBoards="92",e.DefaultOnlineMeetingSettingOn="94",e.YammerPostTeachingMoment="95",e.OnboardingExperienceTeamsCallout="96",e.TopicRollupFRE="97",e.OutlookDesktopToMonarchPreferenceMigration="98",e.StartChatTeachingMoment="99",e.NewOutlookToggle="100"}(i||(i={}))}}]);
//# sourceMappingURL=owa.847.js.map
self.scriptsLoaded['owa.847.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.847.js'] = (new Date()).getTime();