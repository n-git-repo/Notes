self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.1181.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[1181],{10952:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(2737);function r(e){return Object(o.C)(e,"ArchiveMailbox")||Object(o.C)(e,"SharedMailbox")}},11015:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var o=n(2892),r=n(2808);function a(e,t){const n=e[e.length-1],a=t.rowKeys.indexOf(n);a<t.rowKeys.length-1?Object(o.q)(t,t.rowKeys[a+1],!1,r.a.RowRemoval):Object(o.i)(t,r.a.Reset)}},19790:function(e,t,n){"use strict";n.r(t);var o=n(2733),r=n(6064),a=n(2883),i=n(3411),c=n(2),s=Object(c.mutatorAction)("removeSingleItemFromConversation",(function(e,t){const n=a.a.tableViews.get(t),r=Object(o.F)([e.itemConversationId.Id],n);for(const n of r)d(n,e,t)}));function d(e,t,n){const o=Object(r.a)(t.itemConversationId.Id),a=Object(i.a)(e,n);let c=a.itemIds.indexOf(t.itemId);c>=0&&(a.itemIds.splice(c,1),t.isRead||a.unreadCount--),c=o.globalItemIds.indexOf(t.itemId),c>=0&&(o.globalItemIds.splice(c,1),t.isRead||o.globalUnreadCount--),c=a.draftItemIds.indexOf(t.itemId),c>=0&&a.draftItemIds.splice(c,1)}var l=n(7998),u=n(3020),b=n(3077),f=n(20),O=n(4456),m=n(3607),j=Object(f.e)(b.a,"clone_deleteItemsStoreUpdate",e=>{const t=e.itemContexts[0],n=Object(l.a)(null==t?void 0:t.mailboxInfo,e.parentFolderId,!0);for(const t of n)Object(o.R)(t)?w(e.itemContexts,t):1==t.tableQuery.listViewType&&I(e.itemContexts,t)});function I(e,t){const n=e.map(e=>e.itemId),r=Object(o.F)(n,t),a=r.filter(e=>t.rowKeys.indexOf(e)>=0);0!=a.length&&(v(t,r),Object(O.a)(a,t))}function w(e,t){for(const n of e){const e=Object(o.F)([n.itemConversationId.Id],t);for(const r of e){const e=Object(o.M)(r,t.id);if(!e)continue;const a=Object(m.a)(r);a&&1==o.Z.expandedConversationViewState.forks.length&&o.Z.expandedConversationViewState.forks[0].id==n.itemId||!a&&1==e.itemIds.length&&e.itemIds[0]==n.itemId?(v(t,[r]),Object(O.a)([r],t)):s(n,t.id)}}}function v(e,t){0!==e.tableQuery.type&&2!==e.tableQuery.type||u.a.add(t,e,3)}var p=n(3163),y=n(3653),h=n(3344);function g(e,t,n){const r=t.id,a=Object(o.F)(e,t);if(0==a.length)return;const c=function(e,t){let n=0,o=0;const r=new Map;for(let a=0;a<e.length;a++){const c=e[a],s=Object(i.a)(c,t);r.get(s.id)||(r.set(s.id,!0),n-=s.unreadCount,o-=s.itemIds.length)}return[n,o]}(a,r);Object(h.a)(c[0],c[1],t.serverFolderId,!0),0!=t.tableQuery.type&&2!=t.tableQuery.type||u.a.add(a,t,3),Object(y.a)(a,t,n)}const C=Object(f.e)(p.a,"deleteConversationStoreUpdateClone",e=>{const{conversationIds:t,tableView:n,actionType:o}=e;g(t,n,o)});var R=n(3545),S=n(4352);var V=n(3726);const T=Object(f.e)(V.a,"deleteFolderStoreUpdateClone",e=>{const{folderIds:t}=e;t.forEach(e=>{!function(e){Object(R.a)(e,!1).forEach(e=>S.b(e))}(e)})});var A=n(7793),x=n(8673),k=n(3399),F=n(11015);function D(e,t,n,r,a={tableViews:o.Z.tableViews}){const i=a.tableViews.get(t);0===i.tableQuery.type&&(u.a.add(e,i,1),Object(F.a)(e,i)),Object(o.D)(e,t).forEach(e=>{a.tableViews.forEach(a=>{if(a.tableQuery.folderId!=i.tableQuery.folderId)return;Object(o.F)([e],a).forEach(e=>{if(r(e,a.id,n),0===a.tableQuery.type){Object(o.bb)(a,2),function(e,t,n,o,r){const a=Object(A.a)(o,n);if(a<0)throw new Error("Row being pinned / unpinnned must exist in the list");let i;const c=r?0:a+1;return i=Object(x.a)(e,t,n,c),a<i&&i--,-1==i?(Object(y.a)([o],n,"Pin"),!1):(k.a.updateRowPosition(i,o,n),!0)}(o.b.getLastDeliveryOrRenewTimeStamp(e,a),o.b.getLastDeliveryTimeStamp(e,a),a,e,n)||a.id!=t||u.a.add([e],i,3)}})})})}var E=n(4174),Q=n(5122),U=Object(f.e)(E.a,"clone_markConversationsAsPinnedStoreUpdate",e=>{const{rowKeys:t,tableViewId:n,shouldMarkAsPinned:o}=e;D(t,n,o,M)});const M=Object(c.mutatorAction)("updateRenewTimeOnConversation",(e,t,n)=>{const o=Object(i.a)(e,t);if(!o)return;if(!n)return void(o.lastDeliveryOrRenewTimeStamp=o.lastDeliveryTimeStamp);const r=Object(Q.d)();r&&(o.lastDeliveryOrRenewTimeStamp=r)});var K=n(4175),P=n(2742),Z=Object(f.e)(K.a,"clone_markItemsAsPinnedStoreUpdate",e=>{const{rowKeys:t,tableViewId:n,shouldMarkAsPinned:o}=e;D(t,n,o,_)});const _=Object(c.mutatorAction)("updateRenewTimeOnItem",(e,t,n)=>{const r=Object(o.N)(e,t);if(!r)return;const a=P.u.items.get(r.clientId.Id);if(!n)return void(a.ReceivedOrRenewTime=a.DateTimeReceived);const i=Object(Q.d)();i&&(a.ReceivedOrRenewTime=i)});var L=n(2740),N=n(358),G=n(10952);var $=Object(N.action)("MarkItemsReadInListViewStore")((function(e,t,n,r={items:L.a.items,conversationItems:o.Z.conversationItems}){const a=n?-1*t.length:t.length,c=e.tableQuery.folderId;Object(G.a)(c)&&Object(h.a)(a,0,c,!0),0==e.tableQuery.listViewType&&t.forEach(e=>{var t;const a=r.items.get(e);if(a){const e=null===(t=a.ConversationId)||void 0===t?void 0:t.Id;Object(l.a)(a.MailboxInfo,a.ParentFolderId.Id,!0).forEach(t=>(function(e,t,n,r){const a=Object(o.F)([e],t),c=t.id;a.forEach(t=>{const o=Object(i.a)(t,c),a=r.get(e);o&&(n?(o.unreadCount--,a.globalUnreadCount--):(o.unreadCount++,a.globalUnreadCount++))})})(e,t,n,r.conversationItems))}})})),q=n(3275),z=Object(f.e)(q.a,"clone_markItemsAsReadStoreUpdateOrchestrator",e=>{const{itemIds:t,isReadValue:n,isExplicit:r,tableViewId:a}=e,i=o.Z.tableViews.get(a);if(!i)return;$(i,t,n);var c=[];const s=Object(o.cb)(i,n,r);1==i.tableQuery.listViewType?c=Object(o.F)(t,i):t.forEach(e=>{var t;const n=P.u.items.get(e);if(n){const e=null===(t=n.ConversationId)||void 0===t?void 0:t.Id,r=Object(o.F)([e],i);r.forEach(e=>{const t=Object(o.M)(e,a);s&&0!=t.unreadCount||r.push(e)})}}),0!=c.length&&(s?(u.a.add(c,i,3),Object(y.a)(c,i,"MarkAsRead")):u.a.add(c,i,2))}),B=Object(N.action)("MarkConversationReadInListViewStore")((function(e,t,n,r,a={conversationItems:o.Z.conversationItems}){let i=0;const c={};e.forEach(e=>{if(n.virtualSelectAllExclusionList.indexOf(e)>=0)return;const r=Object(o.M)(e,n.id),s=H(r,t);r.unreadCount+=s;const d=r.id;a.conversationItems.get(d).globalUnreadCount+=s,c[d]||(c[d]=!0,i+=s),function(e,t,n){Object(R.a)(n.tableQuery.folderId,!1).forEach(r=>{if(r.id===n.id)return;const a=Object(o.M)(e,r.id);if(a){const e=H(a,t);a.unreadCount+=e}})}(e,t,n)}),r&&Object(h.a)(i,0,n.tableQuery.folderId,!0)}));function H(e,t){const n=e.unreadCount;return t?-1*n:e.itemIds.length-n}var J=n(3285),W=Object(f.e)(J.a,"clone_markConversationAsReadStoreUpdate",e=>{const{conversationIds:t,tableViewId:n,isReadValue:r,isExplicit:a}=e,i=o.Z.tableViews.get(n);if(!i)return;const c=Object(o.F)(t,i);B(c,r,i,!0),Object(o.cb)(i,r,a)?(u.a.add(c,i,3),Object(y.a)(c,i,"MarkAsRead")):u.a.add(c,i,2)}),X=n(3117);const Y=Object(f.e)(X.a,"markAllAsReadOrchestratorClone",e=>{const{tableView:t,markAsRead:n}=e;if(t)switch(t.tableQuery.listViewType){case 0:B(t.rowKeys,n,t,!1);break;case 1:const e=Object(o.D)(t.rowKeys,t.id);$(t,e,n)}});var ee=n(3491),te=Object(N.action)("removeTableFromStore")((function(e,t={tableViews:a.a.tableViews}){const{tableViews:n}=t,o=n.get(e);if(o){if(Object(ee.a)()==e)return;k.a.clear(o,null),n.delete(e),0==Object(R.a)(o.tableQuery.folderId,!1).length&&u.a.clearMapForFolder(o.serverFolderId)}})),ne=n(4265),oe=n(4571),re=n(4572),ae=n(68),ie=Object(f.e)(ne.a,"clone_updateCategoriesInView",e=>{const t=Object(o.I)();if(!t)return;const{modifiedCategoryName:n,newCategoryName:r}=e,a=[];for(const e of t.rowKeys){const r=o.b.getCategories(e,t);(null==r?void 0:r.includes(n))&&a.push(e)}if(Object(ae.p)("UpdateCategoriesInViewMail",[a.length]),a.length>0){const e=r?[r]:null;Object(o.R)(t)?Object(oe.a)(a,t.id,e,[n],!1):Object(re.a)(Object(o.D)(a,t.id),e,[n],!1),u.a.add(a,t,0)}});n.d(t,"deleteItemsStoreUpdateOrchestrator",(function(){return j})),n.d(t,"deleteConversationStoreUpdateOrchestrator",(function(){return C})),n.d(t,"deleteFolderStoreUpdateOrchestrator",(function(){return T})),n.d(t,"markConversationsAsPinnedStoreUpdateOrchestrator",(function(){return U})),n.d(t,"markItemsAsPinnedStoreUpdateOrchestrator",(function(){return Z})),n.d(t,"markItemsAsReadStoreUpdateOrchestrator",(function(){return z})),n.d(t,"markConversationsAsReadStoreUpdateOrchestrator",(function(){return W})),n.d(t,"markAllAsReadOrchestrator",(function(){return Y})),n.d(t,"removeTableFromStore",(function(){return te})),n.d(t,"updateCategoriesInViewOrchestrator",(function(){return ie}))},7793:function(e,t,n){"use strict";function o(e,t){return t.rowKeys.indexOf(e)}n.d(t,"a",(function(){return o}))},7998:function(e,t,n){"use strict";var o=n(3545),r=n(2790),a=n(2733);function i(e,t,n){let i=[];return i=e&&"GroupMailbox"==e.type?function(e,t,n={tableViews:a.Z.tableViews}){const{tableViews:o}=n,i=[];return o.forEach(n=>{(Object(r.b)(n.tableQuery)==e||t&&1==n.tableQuery.type)&&i.push(n)}),i}(e.mailboxSmtpAddress,n):Object(o.a)(t,n),i}n.d(t,"a",(function(){return i}))},8673:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return s}));var o=n(3441),r=n(2733),a=n(3012);function i(e,t,n,o){const i=new Date(r.b.getLastDeliveryTimeStamp(n,o)).getTime()-new Date(t).getTime();if(Object(a.l)(o.tableQuery)){const t=new Date(r.b.getLastDeliveryOrRenewTimeStamp(n,o)).getTime()-new Date(e).getTime();return 0!=t?t:i}return i}function c(e,t,n,r,i){return Object(o.a)(i,n.id,e)?Object(a.f)(n,0):s(e,t,n,r)}function s(e,t,n,a){const c=n.rowKeys.length;if(0==c)return 0;const s=Object(r.K)(n).sortDirection==r.c.DESCENDING_SORT_DIR;let d;for(d=a;d<c;d++){const r=n.rowKeys[d];if(Object(o.a)(r,n.id,e))continue;const a=i(e,t,r,n);if(s?a<=0:a>0)return d}return c==n.totalRowsInView?c:-1}}}]);
//# sourceMappingURL=owa.1181.js.map
self.scriptsLoaded['owa.1181.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.1181.js'] = (new Date()).getTime();