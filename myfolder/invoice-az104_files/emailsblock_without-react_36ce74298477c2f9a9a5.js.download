/*! Version: 2.19.35; Third Party Notices: https://res-1.cdn.office.net/midgard/versionless/tpn-7067c8ff8e07b742b312264f9db7b5b4ca111ce48829507ba781b1943c43fc9077b33b7bad875d9cc30613f1a8e36c3a667ae2ce7cce48c813d6df0988feec04.txt */
(window.webpackJsonpLpc=window.webpackJsonpLpc||[]).push([[99],{1056:function(e,n,t){"use strict";t.r(n),t.d(n,"EmailsBlockView",function(){return w});var r=t(43),i=t(44),o=t(81),a=t(82),c=t(83),s=t(827),u=t(599),p=t(2523),l=t(175),d=t(1155),f=t(1213),b=t(1),g=t(158),m=t(1586),h=t(36),j=t(84),O=t(604),v=t(379),w=function(e){function n(){var e;return Object(r.a)(this,n),(e=Object(o.a)(this,Object(a.a)(n).apply(this,arguments))).getConvertedEmails=Object(l.a)(function(n){return n.map(function(n){return e.getEmailFromIEmail(n)})}),e}return Object(c.a)(n,e),Object(i.a)(n,[{key:"render",value:function(){var e=this,n=this.props.persona;if(!n||Object(h.b)(n))return null;var t=this.getConvertedEmails(this.props.emails);return b.createElement(p.a,{persona:n,messageEntities:t,isLoading:this.props.isLoading,isMePersona:this.props.isMePersona,showError:this.props.hasFailed,onTitleClick:function(){return m.d(n,e.lpcAppContext,e.props.renderingContext)},onFooterClick:function(){return m.b(n,e.lpcAppContext,e.props.renderingContext)},onRetryClick:function(){return m.c(n,e.lpcAppContext)},onMessageEntityClick:function(r,i){return m.a(e.props.emails[t.indexOf(r,0)],n.lpcKey,e.lpcAppContext,i)}})}},{key:"getEmailFromIEmail",value:function(e){return{subject:e.Subject,preview:e.Preview,emailFrom:e.From,fromName:e.FromName,received:Object(s.a)(Object(u.i)(e.Received)||Object(u.h)(),new Date,Object(v.b)(this.lpcAppContext),this.lpcAppContext.logger),isRead:e.IsRead,hasAttachments:e.HasAttachments,isAtMentioned:e.IsAtMentioned,flagStatus:e.FlagStatus,importance:e.Importance,kind:"Email"}}}]),n}(t(176).a);var C=Object(f.a)(w,function(e){var n=e.persona,t=e.hasFailed,r=e.isLoading,i=e.emails,o=e.isMePersona;return{componentName:"EmailsBlock",identifier:n&&n.lpcKey.key||"",logProperties:{hasFailed:t,isLoading:r,emailsCount:i.length.toString(),isMePersona:o}}}),y=Object(g.c)(function(e,n){var t=Boolean(Object(O.a)(e,n.persona));if(!n.persona)return{emails:[],isLoading:!1,hasFailed:!1,isMePersona:t};var r=Object(j.d)(e,n.persona.lpcKey);return{emails:r.emails,isLoading:r.isLoading,hasFailed:r.hasError,isMePersona:t}})(Object(d.a)(C));n.default=y},1202:function(e,n,t){"use strict";t.d(n,"a",function(){return s});var r=t(9),i=t(213),o=t(1),a=t(610),c=t(1242);function s(e){var n=Object(a.c)(),t=Object(a.d)(),s=e.identifier,u=e.logProperties,p=t+e.componentName,l=Object(o.useRef)(null),d=Object(o.useRef)(null),f=Object(o.useRef)(null),b=Object(o.useRef)(0);Object(o.useEffect)(function(){return null===l.current&&(l.current=c()),function(){d.current||(d.current=c());var e=l.current&&d.current?d.current-l.current:void 0,t=void 0!==e&&Math.round(e).toString()||"";if(n){var i=Object(r.__assign)({component:p,duration:t,renderCount:b.current.toString()},f.current);n(p,i)}l.current=null,f.current=null,d.current=null,b.current=0}},[s,p]),Object(o.useEffect)(function(){Object(i.a)(u,f.current)||(b.current++,d.current=c(),f.current=u)},[p,u])}},1213:function(e,n,t){"use strict";t.d(n,"a",function(){return a});var r=t(9),i=t(1),o=t(1202);function a(e,n){return function(t){var a=n(t);return Object(o.a)(a),i.createElement(e,Object(r.__assign)({},t))}}},1242:function(e,n,t){(function(n){(function(){var t,r,i,o,a,c;"undefined"!=typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:null!=n&&n.hrtime?(e.exports=function(){return(t()-a)/1e6},r=n.hrtime,o=(t=function(){var e;return 1e9*(e=r())[0]+e[1]})(),c=1e9*n.uptime(),a=o-c):Date.now?(e.exports=function(){return Date.now()-i},i=Date.now()):(e.exports=function(){return(new Date).getTime()-i},i=(new Date).getTime())}).call(this)}).call(this,t(829))},1586:function(e,n,t){"use strict";t.d(n,"c",function(){return m}),t.d(n,"d",function(){return h}),t.d(n,"b",function(){return j}),t.d(n,"a",function(){return v}),t.d(n,"e",function(){return w});var r=t(8),i=t.n(r),o=t(5),a=t.n(o),c=t(523),s=t(98),u=t(170),p=t(295),l=t(147),d=t(616),f=t(420),b=t(539),g=function(e,n,t,r){return new(t||(t=a.a))(function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function c(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(a,c)}s((r=r.apply(e,n||[])).next())})};function m(e,n){return g(this,void 0,void 0,i.a.mark(function t(){var r,o;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n.dispatch(Object(u.c)({personaLpcKey:e.lpcKey})),r=n.getState(),o=d.a.getSelectors(r).getCardTemplateFailed(e.lpcKey),t.next=5,Object(b.b)(e,"",o,n,n.logger,void 0,void 0);case 5:case"end":return t.stop()}},t)}))}function h(e,n,t){var r=O(e,n),i=Object(p.b)(n);r&&i?(Object(s.k)(e,{applicationContext:n,renderingContext:t,cardCorrelationId:n.cardCorrelationId||"",logger:n.logger}),n.dispatch(Object(u.d)({personaLpcKey:e.lpcKey,isExpandedViewEnabled:!0,section:"Conversations",windowId:t.windowId,navigationStartCheckpoint:Object(c.a)(),shouldResetHistory:!1,personaCorrelationId:n.getPersonaCorrelationId(e.lpcKey)})),i.renderExpandedView(n,"Conversations")):n.dispatch(Object(u.d)({personaLpcKey:e.lpcKey,isExpandedViewEnabled:!1}))}function j(e,n,t){var r=O(e,n),i=Object(p.b)(n);r&&i?(Object(s.k)(e,{applicationContext:n,renderingContext:t,cardCorrelationId:n.cardCorrelationId||"",logger:n.logger}),n.dispatch(Object(u.b)({personaLpcKey:e.lpcKey,isExpandedViewEnabled:!0,section:"Conversations",windowId:t.windowId,navigationStartCheckpoint:Object(c.a)(),shouldResetHistory:!1,personaCorrelationId:n.getPersonaCorrelationId(e.lpcKey)})),i.renderExpandedView(n,"Conversations")):n.dispatch(Object(u.b)({personaLpcKey:e.lpcKey,isExpandedViewEnabled:!1}))}function O(e,n){var t=Object(p.b)(n);return n.settings.isImmersiveProfileEnabled&&!!t&&!Object(l.a)(e)}function v(e,n,t,r,i){t.dispatch(Object(u.a)({email:e,indexClicked:r,personaLpcKey:n})),Object(f.h)(t,t.logger)(e,n,i)}function w(e,n,t,r){t.dispatch(Object(u.f)({email:e,personaLpcKey:n})),Object(f.h)(t,t.logger)(e,n,r)}}}]);