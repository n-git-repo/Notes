self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.658.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[658],{10265:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.aliasFromEmailAddress=t.getUserNameMetastream=t.getNameMetastream=void 0;const i=r(7103),a=100,n=80,s=70,o=75,u=60,c=10,l=5;function d(e,t,r,a,n,s,o){let u=i.normalizeString(t);if(!u)return;e.set(u,r);let c=i.tokenize(u,!1);for(var l=0;l<c.length;l++){let t=c[l];h(e,t,a),f(e,t,s,o,n)}}function f(e,t,r,i,a){for(var n=r,s=1;s<=t.length-1;s++)h(e,t.substring(0,s).trim(),n),a<(n+=i)&&(n=a)}function h(e,t,r){e.has(t)?e[t]<r&&(e[t]=r):e.set(t,r)}t.getNameMetastream=function(e){let t=new Map;return e?(d(t,e,a,n,o,c,l),t):t},t.getUserNameMetastream=function(e,t){let r=new Map;if(e){let n=i.normalizeString(e);n&&r.set(n,100),t&&d(r,t,a,s,u,c,l)}return r},t.aliasFromEmailAddress=function(e){if(!e)return"";let t=e.lastIndexOf("@");return t<0?e:e.substring(0,t)}},10266:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rankSuggestions=t.RankableSuggestion=t.featureStores=t.setDynamicSuggestionModel=void 0;const i=r(12183);let a,n,s,o;t.setDynamicSuggestionModel=function(e,t,r,i){a=e,n=t,o=r,s=i},t.featureStores=new Map;t.RankableSuggestion=class{constructor(e,t,r,i){this.originalSuggestion=e,this.id=t,this.matchedField=r,this.fuzzyCount=i}},t.rankSuggestions=function(e,r,u){let c=[...r],l=a;if(l)for(let r=0;r<c.length;r++){let a=c[r].id?t.featureStores.get(c[r].id):{};try{i.calculateAndAppendDynamicFeatures(a,c[r],e,s,n,o,u)}catch(e){return[]}let d=l.rank(a);c[r].rankingScore=d,c[r].featureStore=a}return c.sort((e,t)=>t.rankingScore-e.rankingScore),c}},12183:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.calculateAndAppendDynamicFeatures=void 0;const a=r(12184),n=r(12185),s=r(12186),o=r(9355),u=r(12188),c=r(13875),l=r(7645),d=r(10265),f=i(r(12189)),h=r(12190);function m(e,t,r){switch(r.setFeatureInStore("PropertyHit_GivenName",0,e),r.setFeatureInStore("PropertyHit_Surname",0,e),r.setFeatureInStore("PropertyHit_EmailAddress",0,e),r.setFeatureInStore("PropertyHit_DisplayName",0,e),r.setFeatureInStore("PropertyHit_Alias",0,e),r.setFeatureInStore("PropertyHit_AdditionalName",0,e),t){case l.MatchedField.GivenName:r.setFeatureInStore("PropertyHit_GivenName",1,e);break;case l.MatchedField.Surname:r.setFeatureInStore("PropertyHit_Surname",1,e);break;case l.MatchedField.EmailAddresses:case l.MatchedField.Alias:r.setFeatureInStore("PropertyHit_EmailAddress",1,e);break;case l.MatchedField.DisplayName:r.setFeatureInStore("PropertyHit_DisplayName",1,e);break;case l.MatchedField.AdditionalNames:r.setFeatureInStore("PropertyHit_AdditionalName",1,e)}}function g(e){var t;switch(e.matchedField){case l.MatchedField.EmailAddresses:return null===(t=e.originalSuggestion.EmailAddress)||void 0===t?void 0:t.EmailAddress;case l.MatchedField.DisplayName:return e.originalSuggestion.DisplayName;case l.MatchedField.GivenName:return e.originalSuggestion.GivenName;case l.MatchedField.Surname:return e.originalSuggestion.Surname;case l.MatchedField.Alias:return e.originalSuggestion.Alias;default:return""}}t.calculateAndAppendDynamicFeatures=function(e,t,r,i,l,p,S){var F;let y=new Map,b=t.originalSuggestion.DisplayName,M=t.originalSuggestion.EmailAddress,O=null!==(F=null==M?void 0:M.EmailAddress)&&void 0!==F?F:"";for(let c of i)switch(c){case"QueryLevel":a.computeQueryLevelFeatures(r,y,p);break;case"PrefixFound":n.computePrefixMatchFeatures(r,b,"Name",y,p),n.computePrefixMatchFeatures(r,O,"Alias",y,p),n.computePrefixMatchFeatures(r,O,"UserName",y,p);break;case"Match":s.computeMatchFeatures(r,d.getNameMetastream(b),"Name",y,p),s.computeMatchFeatures(r,d.getUserNameMetastream(O,d.aliasFromEmailAddress(O)),"UserName",y,p),m(e,t.matchedField,p),o.computeLexicalSimilarityFeatures(r,g(t),t.fuzzyCount>0,t.matchedField,t.originalSuggestion.DisplayName,y,p),u.computePersonPropertyLexicalMatches(r,t,y,p);break;case"EntryPoint":p.setFeatureInStore("compose",1,e);break;case"UserType":p.setFeatureInStore("office365category.consumer",S?1:0,e),p.setFeatureInStore("office365category.commercial",S?0:1,e);break;case"NormalizedCdfFeatures":f.default(e,p);break;default:if(h.getNonActionableFeaturizers().includes(c))break;throw new Error("Ranker uses a featurizer which has not been implemented: "+c)}y.forEach((t,r)=>{e[r]=t}),c.computeEntrypointSpecificFastRankScores(l,e,p)}},12184:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.computeQueryLevelFeatures=void 0;const i=r(7103),a=r(7103);t.computeQueryLevelFeatures=function(e,t,r){var n=i.normalizeString(e);r.setFeature("QueryLevelFeature_Query_Length",e.length,t),r.setFeature("QueryLevelFeature_Query_NumberOfTokens",a.getNumberOfTokens(e),t),r.setFeature("QueryLevelFeature_Query_NumberOfNormalizedTokens",a.getNumberOfTokens(n),t)}},12185:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.computePrefixMatchFeatures=void 0;const i=r(7103);t.computePrefixMatchFeatures=function(e,t,r,a,n){t||(t="");let s=e.toLowerCase();n.setFeature(`PrefixFound_Query_${r}_UseFull`,t.toLowerCase().substring(0,s.length)==s?1:0,a);let o=i.tokenize(t,!1);n.setFeature(`PrefixFound_Query_${r}_UseTokens`,o.some(e=>e.toLowerCase().substring(0,s.length)==s)?1:0,a)}},12186:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.match=t.buildWordIndex=t.computeMatchFeatures=void 0;const i=r(7103),a=r(13872),n=r(13873),s="__",o=10;function u(e,t,r){let a=0,n=new Array;t.set(s,n),e.forEach((e,n)=>{let o=n,u=e;if(o.indexOf(" ")>=0){let e=i.tokenize(o,!1);for(let i=0;i<e.length;i++){if(!t.has(e[i])){let r=new Array;t.set(e[i],r)}r.push(u),t.get(e[i]).push(a++)}}else{if(!t.has(o)){let e=new Array;t.set(o,e)}r.push(u),t.get(o).push(a++)}r.push(u),t.get(s).push(a++)})}function c(e,t,r,i){let u=0,c=0,l=new a.CompleteMatchEngine(t.get(s),r),d=new n.PerfectMatchEngine(t.get(s),r);for(let a=0;a<e.length&&a<o;a++)if(t.has(e[a])){let n=t.get(e[a]),s=0;for(let e=0;e<n.length;e++)s+=r[n[e]];i.push(s),l.update(a,n),d.update(n)}else i.push(0),l.update(a,[]),d.update([]);return c+=d.finalize(),u+=l.finalize(),{complete:u,perfect:c}}t.computeMatchFeatures=function(e,t,r,a,n){let s=new Map,l=new Array;u(t,s,l);let d=new Array,f=c(i.tokenize(e,!1),s,l,d),h=f.complete,m=f.perfect,g=0,p="";for(let e=0;e<o&&(p=`Match_${r}_NumberOfOccurrences_${e}`,n.hasFeature(p));e++)e<d.length?(g+=d[e],n.setFeature(p,d[e],a)):n.setFeature(p,0,a);n.setFeature(`Match_${r}_NumberOfTotalOccurrences`,g,a),n.setFeature(`Match_${r}_NumberOfPerfectMatches`,m,a),n.setFeature(`Match_${r}_NumberOfCompleteMatches`,h,a)},t.buildWordIndex=u,t.match=c},12187:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.computePhoneticSimilarity=void 0;const a=i(r(13874)),n=r(9355);t.computePhoneticSimilarity=function(e,t,r=null){if(!e||!t)return 0;if(e==t)return 1;if(4!=(r=null!=r?r:[1,.5,.5,.25]).length)throw new Error("Require exactly 4 weights");var i=a.default(e),s=a.default(t);const o=(e,t)=>e||t?n.computeLexicalSimilarity(e,t):0;var u=[r[0]*o(i[0],s[0]),r[1]*o(i[0],s[1]),r[2]*o(i[1],s[0]),r[3]*o(i[1],s[1])];return Math.max(...u)}},12188:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.computePersonPropertyLexicalMatches=void 0,t.computePersonPropertyLexicalMatches=function(e,t,r,i){if(i.setFeature("ExactMatchOn_GivenName",0,r),i.setFeature("ExactMatchOn_DisplayName",0,r),i.setFeature("ExactMatchOn_Surname",0,r),i.setFeature("ExactMatchOn_AdditionalName",0,r),t.originalSuggestion.DisplayName&&0==t.originalSuggestion.DisplayName.localeCompare(e,"en",{sensitivity:"base"}))i.setFeature("ExactMatchOn_DisplayName",1,r);else if(t.originalSuggestion.GivenName&&0==t.originalSuggestion.GivenName.localeCompare(e,"en",{sensitivity:"base"}))i.setFeature("ExactMatchOn_GivenName",1,r);else if(t.originalSuggestion.Surname&&0==t.originalSuggestion.Surname.localeCompare(e,"en",{sensitivity:"base"}))i.setFeature("ExactMatchOn_Surname",1,r);else if(t.originalSuggestion.AdditionalNames)for(let a of t.originalSuggestion.AdditionalNames)if(0==a.localeCompare(e,"en",{sensitivity:"base"}))return void i.setFeature("ExactMatchOn_AdditionalName",1,r)}},12189:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=[["31","124","InboxCdfFreshness1WeekNormalized"],["32","15","InboxCdfAllNormalized"],["33","116","SentCdfCdfFreshness1WeekNormalized"],["34","5","SentCdfCdfAllNormalized"],["37","30","Chat7DayCountNormalized"],["38","136","ChatCdfAllNormalized"],["36","10","CalCdfAllNormalized"]];t.default=function(e,t){i.forEach(r=>{if(!t.hasFeature(r[2]))return;let i=t.getFeatureIndex(r[1]),a=t.getFeatureIndex(r[0]);a in e&&i in e&&t.setFeatureInStore(r[2],e[a]>0?100*e[i]/e[a]:0,e)})}},12190:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getNonActionableFeaturizers=t.getL2Features=void 0;const a=i(r(13876));let n=[];t.getL2Features=function(){return 0==n.length&&Object.values(a.default.ClientFeatures).forEach(e=>n.push(...e)),n},t.getNonActionableFeaturizers=function(){return a.default.NonActionableFeaturizers}},12191:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLexicalSimilarityThreshold=void 0;const i=[1,1,1,.5,.4,.333,.429,.375,.333,.3,.273,.25];t.getLexicalSimilarityThreshold=function(e){let t=i.length;if(e>0){let r=e-1;return r<t?i[r]:i[t-1]}return 0}},12192:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rankPeople=void 0;const i=r(10266);t.rankPeople=function(e,t,r,a){let n=e.map(e=>new i.RankableSuggestion(e.suggestion,e.suggestionKey,e.matchedFieldInfo,e.fuzzyCount)),s=i.rankSuggestions(t,n,r).map(e=>{let t=e.originalSuggestion;return t.FeatureData=e.featureStore?JSON.stringify(e.featureStore):"",t});return null==a||a.addCacheFeatureValues(s),s}},12193:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Aggregator=void 0;t.Aggregator=class{constructor(e,t,r=1,i=0){this.ranker=e,this.aggregate=t,this.weight=r,this.bias=i}rank(e){if(this.aggregate){let t=this.bias+this.weight*this.ranker.evaluate(e);return 1/(1+Math.exp(-t))}return this.ranker.evaluate(e)}}},12194:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Ranker=void 0;const i=r(12195);t.Ranker=class{constructor(e){this.evaluators=e}evaluate(e){let t=0;for(let r of this.evaluators){let a=0;for(;a>=0;){a=i.getFeatureStoreValue(e,r.SplitFeatures[a]-1)<=r.Threshold[a]?r.LteChildren[a]:r.GreaterThanChildren[a]}t+=r.Output[~a]}return t}}},12195:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFeatureStoreValue=void 0,t.getFeatureStoreValue=function(e,t){return e[t]||0}},12196:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(12197);t.default=class{constructor(e){this.rankerFeatureIndexMap=null!=e?e:{}}isL1feature(e){return Number.isInteger(+e)}getFeatureIndex(e){let t=this.isL1feature(e)?i.APF_PREFIX+e:e;if(t in this.rankerFeatureIndexMap)return this.rankerFeatureIndexMap[t];if(Number.isInteger(+e))return i.FEATURE_INDEX_BUFFER+Number(e);throw new Error(e+" does not exist in feature index map")}hasFeature(e){return(e=this.isL1feature(e)?i.APF_PREFIX+e:e)in this.rankerFeatureIndexMap}getFeatureIndexMap(){return this.rankerFeatureIndexMap}setFeature(e,t,r){return!!this.hasFeature(e)&&(r.set(this.getFeatureIndex(e),t),!0)}setFeatureInStore(e,t,r){return!!this.hasFeature(e)&&(r[this.getFeatureIndex(e)]=t,!0)}}},12197:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FEATURE_INDEX_BUFFER=t.APF_PREFIX=void 0,t.APF_PREFIX="AdvancedPreferFeature_",t.FEATURE_INDEX_BUFFER=500},12198:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SuggestionTrie=void 0;const i=r(13879),a=r(13880),n=r(12191),s=r(9355),o=r(7645),u=1e3,c=3,l=.25,d=3;t.SuggestionTrie=class{constructor(e,t){this.root={indices:[]},this.trieData={},this.trieDataArray=[],this.matchQueries={},this.statistics={numberOfNodes:0,numberOfIndices:0},this.keySelector=e,this.isMaskSelector=t}getSuggestions(e,t=!1){const r=[];return a.searchTrie(e,this.root,r,!1,t),e.length>d&&a.searchTrie(e,this.root,r,!0,t),this.filterCandidates(r,e)}resolveIndex(e){if(e<this.trieDataArray.length)return this.trieDataArray[e]}build(e){if(e)for(const t of e)if(t.suggestion&&t.keywords.length>0)for(const e of t.keywords)this.addKeyword(e,t.suggestion)}isEmpty(){return!this.trieDataArray||0==this.trieDataArray.length}reset(){this.root={indices:[]},this.trieData={},this.trieDataArray=[]}getRoot(){return this.root}getDataLookup(){return this.trieData}getData(){return this.trieDataArray}getStatistics(){return this.statistics}filterCandidates(e,t){let r=[];return e.forEach(e=>{let i=e.indices;e.indices=i.filter(r=>!this.isSuggestionMasked(r)&&(e.score<=u||this.shouldKeepSuggestionCandidate(r,e.query,t))),e.indices.length>0&&r.push(e)}),r}isSuggestionMasked(e){let t=this.resolveIndex(e.id).EmailAddress;return t.EmailAddress&&this.isMaskSelector(t.EmailAddress)||t.Name&&this.isMaskSelector(t.Name)}shouldKeepSuggestionCandidate(e,t,r){let i=this.matchQueries[e.id][e.matchQueryIndex[0]].slice(0,e.matchQueryIndex[1]+1).join(" ");if(s.computeLexicalSimilarity(i,t,c)<l)return!1;var a=n.getLexicalSimilarityThreshold(i.length),o=i.split(" "),u=r.toLocaleLowerCase(),d=1==u.split(" ").length&&o.length>0?o[0]:i;return!(s.computeLexicalSimilarity(d,u,c)<a)}addKeyword(e,t){let r=this.root,{trieDataArrayIndex:i,keywordIndex:a}=this.addDataToArrays(t,e.keyword),n=0,s=0,u=this.matchQueries[i][a][s].length;for(let t=0;t<e.keyword.length;++t){let c=e.keyword[t];if(e.matchField==o.MatchedField.EmailAddresses)s=this.matchQueries[i].length-1;else{" "==c&&(n+=1);let e=t-n;for(;e>=u;)s+=1,u+=this.matchQueries[i][a][s].length+n}r=this.addCharacterToNode(r,c,i,e.matchField,[a,s])}}addDataToArrays(e,t){const r=this.keySelector(e);let i,a=t.split(" "),n=-1;return void 0===this.trieData[r]?(n=this.trieDataArray.length,this.trieDataArray.push(e),this.trieData[r]=n,this.matchQueries[n]=[a],i=0):(n=this.trieData[r],this.matchQueries[n].push(a),i=this.matchQueries[n].length-1),{trieDataArrayIndex:n,keywordIndex:i}}addCharacterToNode(e,t,r,a,n){return e[t]?i.itemInSet(e[t].indices.map(e=>e.id),r)||(e[t].indices.push({id:r,matchField:a,matchQueryIndex:n}),this.statistics.numberOfIndices+=1):(e[t]={indices:[{id:r,matchField:a,matchQueryIndex:n}]},this.statistics.numberOfNodes+=1,this.statistics.numberOfIndices+=1),e[t]}}},12199:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFuzzyCharSwapsData=t.getFuzzyMatchingRatio=t.setFuzzyCharSwapsData=t.fuzzyCharSwapsData=void 0;const i=[{charCount:0,fuzzyCount:1},{charCount:8,fuzzyCount:2}];t.setFuzzyCharSwapsData=function(e){t.fuzzyCharSwapsData={};for(let r of Object.keys(e)){let i=[];for(let t of e[r]){let e=t.split(" , ");e.length<2||i.push({char:e[0],score:Number(e[1])})}i.length>0&&(t.fuzzyCharSwapsData[r]=i)}},t.getFuzzyMatchingRatio=function(e){let t=null;for(const r of i){if(!(e.length>=r.charCount))break;t=r}return t},t.getFuzzyCharSwapsData=function(e){var r;return null!==(r=t.fuzzyCharSwapsData[e])&&void 0!==r?r:[]}},12200:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeQuery=void 0;const i=/[&*-/[\]()_|:{}.,?!]+/gi,a=/[\s]+/gi;t.normalizeQuery=function(e){return e?e.toLowerCase().replace(a," ").replace(i," ").trim():""}},13872:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompleteMatchEngine=void 0;t.CompleteMatchEngine=class{constructor(e,t){this.boundaryLocations=e,this.scores=t,this.bookKeeping=new Array}update(e,t){if(0==e){for(let e=0;e<t.length;e++){let i=t[e],a=0;for(var r=0;r<this.boundaryLocations.length;r++){if(this.boundaryLocations[r]>i){this.bookKeeping.push({offset:a,length:this.boundaryLocations[r]-a});break}if(!(this.boundaryLocations[r]<i))throw new Error("CompleteMatchEngine: this cannot happen");a=this.boundaryLocations[r]+1}}this.bookKeeping=function(e){let t=new Array,r=new Map;for(const i of e)r.has(JSON.stringify(i))||(r.set(JSON.stringify(i),!0),t.push({offset:i.offset,length:i.length}));return t}(this.bookKeeping)}else for(let e=this.bookKeeping.length-1;e>=0;e--){let r=!1;for(var i=0;i<t.length;i++){let a=t[i];if(a>=this.bookKeeping[e].offset&&a<=this.bookKeeping[e].offset+this.bookKeeping[e].length-1){r=!0;break}}r||this.bookKeeping.splice(e,1)}}finalize(){let e=0;for(let t=0;t<this.bookKeeping.length;t++)e+=this.scores[this.bookKeeping[t].offset];return e}}},13873:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PerfectMatchEngine=void 0;t.PerfectMatchEngine=class{constructor(e,t){this.boundaryLocations=e,this.scores=t,this.expectedMatchLocations=new Map,this.expectedMatchLocations.set(0,!0);for(let e=0;e<this.boundaryLocations.length;e++)this.expectedMatchLocations.set(this.boundaryLocations[e]+1,!0)}update(e){let t=[];this.expectedMatchLocations.forEach((r,i)=>{-1==e.indexOf(i)&&t.push(i)});for(let e=0;e<t.length;e++)this.expectedMatchLocations.delete(t[e]);if(this.expectedMatchLocations.size>0){let e=new Map;this.expectedMatchLocations.forEach((t,r)=>{e.set(++r,!0)}),this.expectedMatchLocations=e}}finalize(){let e=[];this.expectedMatchLocations.forEach((t,r)=>{-1==this.boundaryLocations.indexOf(r)&&e.push(r)});for(let t=0;t<e.length;t++)this.expectedMatchLocations.delete(e[t]);let t=0;return this.expectedMatchLocations.forEach((e,r)=>{t+=this.scores[r]}),t}}},13874:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=
/*! --------------------------------------------------------------------------------------------------------------------
   * @copyright Copyright (c) 2014 Titus Wormer <tituswormer@gmail.com>
   * @license licensed under the MIT License:
   *          https://github.com/words/double-metaphone/blob/master/license
   * @version 1.0.5
  -------------------------------------------------------------------------------------------------------------------- */
function(e){const t=/[AEIOUY]/,r=/^CH(IA|EM|OR([^E])|YM|ARAC|ARIS)/,i=/ORCHES|ARCHIT|ORCHID/,a=/[ BFHLMNRVW]/,n=/[CGLRT]/,s=/Y[\s\S]|E[BILPRSY]|I[BELN]/,o=/^[DMR]ANGER/,u=/[EGIR]/,c=/[LTKSNMBZ]/,l=/AS|OS/,d=/EIM|OEK|OLM|OLZ/,f=/E[DMNR]|UY|OO/;let h,m,g,p,S,F,y,b="",M="",O=0;const _=e.length,k=_-1;for(e=String(e).toUpperCase()+"     ",h=/W|K|CZ|WITZ/.test(e),m=/^(VAN |VON |SCH)/.test(e),y=e.split(""),/^(GN|KN|PN|WR|PS)/.test(e)&&O++,"X"===y[0]&&(b+="S",M+="S",O++);(b.length<4||M.length<4)&&!(O>=_);)switch(S=y[O-1],p=y[O+1],F=y[O+2],y[O]){case"A":case"E":case"I":case"O":case"U":case"Y":0===O&&(b+="A",M+="A"),O++;break;case"B":b+="P",M+="P","B"===p&&O++,O++;break;case"Ç":b+="S",M+="S",O++;break;case"C":if("A"===S&&"H"===p&&"I"!==F&&!t.test(y[O-2])&&("E"!==F||e.slice(O-2,O+4)&&("BACHER"===g||"MACHER"===g))){b+="K",M+="K",O+=2;break}if(0===O&&"AESAR"===e.slice(O+1,O+6)){b+="S",M+="S",O+=2;break}if("HIA"===e.slice(O+1,O+4)){b+="K",M+="K",O+=2;break}if("H"===p){if(O>0&&"A"===F&&"E"===y[O+3]){b+="K",M+="X",O+=2;break}if(0===O&&r.test(e)){b+="K",M+="K",O+=2;break}m||i.test(e.slice(O-2,O+4))||"T"===F||"S"===F||(0===O||"A"===S||"E"===S||"O"===S||"U"===S)&&a.test(F)?(b+="K",M+="K"):0===O?(b+="X",M+="X"):"MC"===e.slice(0,2)?(b+="K",M+="K"):(b+="X",M+="K"),O+=2;break}if("Z"===p&&"WI"!==e.slice(O-2,O)){b+="S",M+="X",O+=2;break}if("CIA"===e.slice(O+1,O+4)){b+="X",M+="X",O+=3;break}if("C"===p&&(1!==O||"M"!==y[0])){if("I"!==F&&"E"!==F&&"H"!==F||"HU"===e.slice(O+2,O+4)){b+="K",M+="K",O+=2;break}g=e.slice(O-1,O+4),1===O&&"A"===S||"UCCEE"===g||"UCCES"===g?(b+="KS",M+="KS"):(b+="X",M+="X"),O+=3;break}if("G"===p||"K"===p||"Q"===p){b+="K",M+="K",O+=2;break}if("I"===p&&("E"===F||"O"===F)){b+="S",M+="X",O+=2;break}if("I"===p||"E"===p||"Y"===p){b+="S",M+="S",O+=2;break}if(b+="K",M+="K"," "===p&&("C"===F||"G"===F||"Q"===F)){O+=3;break}O++;break;case"D":if("G"===p){"E"===F||"I"===F||"Y"===F?(b+="J",M+="J",O+=3):(b+="TK",M+="TK",O+=2);break}if("T"===p||"D"===p){b+="T",M+="T",O+=2;break}b+="T",M+="T",O++;break;case"F":"F"===p&&O++,O++,b+="F",M+="F";break;case"G":if("H"===p){if(O>0&&!t.test(S)){b+="K",M+="K",O+=2;break}if(0===O){"I"===F?(b+="J",M+="J"):(b+="K",M+="K"),O+=2;break}if(g=y[O-2],"B"===g||"H"===g||"D"===g||(g=y[O-3],"B"===g||"H"===g||"D"===g)||(g=y[O-4],"B"===g||"H"===g)){O+=2;break}O>2&&"U"===S&&n.test(y[O-3])?(b+="F",M+="F"):O>0&&"I"!==S&&(b+="K",M+="K"),O+=2;break}if("N"===p){1===O&&t.test(y[0])&&!h?(b+="KN",M+="N"):"EY"===e.slice(O+2,O+4)||"Y"===e.slice(O+1)||h?(b+="KN",M+="KN"):(b+="N",M+="KN"),O+=2;break}if("LI"===e.slice(O+1,O+3)&&!h){b+="KL",M+="L",O+=2;break}if(0===O&&s.test(e.slice(1,3))){b+="K",M+="J",O+=2;break}if("ER"===e.slice(O+1,O+3)&&"I"!==S&&"E"!==S&&!o.test(e.slice(0,6))||"Y"===p&&!u.test(S)){b+="K",M+="J",O+=2;break}if("E"===p||"I"===p||"Y"===p||("A"===S||"O"===S)&&"G"===p&&"I"===F){"ET"===e.slice(O+1,O+3)||m?(b+="K",M+="K"):(b+="J","IER "===e.slice(O+1,O+5)?M+="J":M+="K"),O+=2;break}"G"===p&&O++,O++,b+="K",M+="K";break;case"H":t.test(p)&&(0===O||t.test(S))&&(b+="H",M+="H",O++),O++;break;case"J":if("JOSE"===e.slice(O,O+4)||"SAN "===e.slice(0,4)){"SAN "===e.slice(0,4)||0===O&&" "===y[O+4]?(b+="H",M+="H"):(b+="J",M+="H"),O++;break}0===O?(b+="J",M+="A"):h||"A"!==p&&"O"!==p||!t.test(S)?O===k?b+="J":"S"===S||"K"===S||"L"===S||c.test(p)?"J"===p&&O++:(b+="J",M+="J"):(b+="J",M+="H"),O++;break;case"K":"K"===p&&O++,b+="K",M+="K",O++;break;case"L":if("L"===p){if(O===_-3&&("A"===S&&"E"===F||"I"===S&&("O"===F||"A"===F))||"A"===S&&"E"===F&&("A"===y[k]||"O"===y[k]||l.test(e.slice(k-1,_)))){b+="L",O+=2;break}O++}b+="L",M+="L",O++;break;case"M":"M"!==p&&("U"!==S||"B"!==p||O+1!==k&&"ER"!==e.slice(O+2,O+4))||O++,O++,b+="M",M+="M";break;case"N":"N"===p&&O++,O++,b+="N",M+="N";break;case"Ñ":O++,b+="N",M+="N";break;case"P":if("H"===p){b+="F",M+="F",O+=2;break}g=p,"P"!==g&&"B"!==g||O++,O++,b+="P",M+="P";break;case"Q":"Q"===p&&O++,O++,b+="K",M+="K";break;case"R":O!==k||h||"E"!==S||"I"!==y[O-2]||"M"===y[O-4]||"E"===y[O-3]||"A"===y[O-3]?(b+="R",M+="R"):M+="R","R"===p&&O++,O++;break;case"S":if("L"===p&&("I"===S||"Y"===S)){O++;break}if(0===O&&"UGAR"===e.slice(1,5)){b+="X",M+="S",O++;break}if("H"===p){d.test(e.slice(O+1,O+5))?(b+="S",M+="S"):(b+="X",M+="X"),O+=2;break}if("I"===p&&("O"===F||"A"===F)){h?(b+="S",M+="S"):(b+="S",M+="X"),O+=3;break}if("Z"===p||0===O&&("L"===p||"M"===p||"N"===p||"W"===p)){b+="S",M+="X","Z"===p&&O++,O++;break}if("C"===p){if("H"===F){if(g=e.slice(O+3,O+5),f.test(g)){"ER"===g||"EN"===g?(b+="X",M+="SK"):(b+="SK",M+="SK"),O+=3;break}0!==O||t.test(y[3])||"W"===y[3]?(b+="X",M+="X"):(b+="X",M+="S"),O+=3;break}if("I"===F||"E"===F||"Y"===F){b+="S",M+="S",O+=3;break}b+="SK",M+="SK",O+=3;break}g=e.slice(O-2,O),O!==k||"AI"!==g&&"OI"!==g?(b+="S",M+="S"):M+="S","S"===p&&O++,O++;break;case"T":if("I"===p&&"O"===F&&"N"===y[O+3]){b+="X",M+="X",O+=3;break}if(g=e.slice(O+1,O+3),"I"===p&&"A"===F||"C"===p&&"H"===F){b+="X",M+="X",O+=3;break}if("H"===p||"T"===p&&"H"===F){m||("O"===F||"A"===F)&&"M"===y[O+3]?(b+="T",M+="T"):(b+="0",M+="T"),O+=2;break}"T"!==p&&"D"!==p||O++,O++,b+="T",M+="T";break;case"V":"V"===p&&O++,b+="F",M+="F",O++;break;case"W":if("R"===p){b+="R",M+="R",O+=2;break}if(0===O&&(t.test(p)?(b+="A",M+="F"):"H"===p&&(b+="A",M+="A")),("E"===S||"O"===S)&&"S"===p&&"K"===F&&("I"===y[O+3]||"Y"===y[O+3])||"SCH"===e.slice(0,3)||O===k&&t.test(S)){M+="F",O++;break}if("I"===p&&("C"===F||"T"===F)&&"Z"===y[O+3]){b+="TS",M+="FX",O+=4;break}O++;break;case"X":(O!==k||"U"!==S||"A"!==y[O-2]&&"O"!==y[O-2])&&(b+="KS",M+="KS"),"C"!==p&&"X"!==p||O++,O++;break;case"Z":if("H"===p){b+="J",M+="J",O+=2;break}"Z"===p&&("A"===F||"I"===F||"O"===F)||h&&O>0&&"T"!==S?(b+="S",M+="TS"):(b+="S",M+="S"),"Z"===p&&O++,O++;break;default:O++}return[b,M]}},13875:function(e,t,r){"use strict";function i(e,t,r,i){let a=e.rank(t);r.setFeatureInStore(i,a,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.computeEntrypointSpecificFastRankScores=void 0,t.computeEntrypointSpecificFastRankScores=function(e,t,r){for(let a of e)-1!=a.guid.indexOf("ComposeRanker")?i(a,t,r,"ComposeRankerScore"):-1!=a.guid.indexOf("TeamsRanker")?i(a,t,r,"TeamsRankerScore"):-1!=a.guid.indexOf("DesktopQfRanker")?i(a,t,r,"DesktopQfRankerScore"):-1!=a.guid.indexOf("ReactRanker")&&i(a,t,r,"ReactQfRankerScore")}},13876:function(e){e.exports=JSON.parse('{"IncompatibleRankers":[],"Featurizers":["QueryLevel","PrefixFound","Match","EntryPoint","UserType","NormalizedCdfFeatures"],"NonActionableFeaturizers":["EntrypointFastRankFeaturizerScores20072020","EntrypointFastRankFeaturizerScores03082020","EntrypointFastRankContextFeaturizerScores04032021","EntrypointFastRankChatContextFeaturizerScores060621","EntrypointFastRankContextFeaturizerScores060621","FileContextMixtureModelEntrypointFeaturizers082021","MinQueryLenMixtureModelEntrypointFeaturizers082021","EntrypointFastRankFeaturizerScores20210903"],"ClientFeatures":{"NormalizedCdfFeatures":["CalCdfAllNormalized","Chat7DayCountNormalized","ChatCdfAllNormalized","InboxCdfAllNormalized","InboxCdfFreshness1WeekNormalized","SentCdfCdfAllNormalized","SentCdfCdfFreshness1WeekNormalized"],"EntryPoint":["ComposeRankerScore","DesktopQfRankerScore","ReactQfRankerScore","TeamsRankerScore","compose","office365category.commercial","office365category.consumer"],"Match":["ExactMatchOn_AdditionalName","ExactMatchOn_GivenName","Match_Name_NumberOfCompleteMatches","Match_Name_NumberOfOccurrences_0","Match_Name_NumberOfOccurrences_1","Match_Name_NumberOfOccurrences_2","Match_Name_NumberOfOccurrences_3","Match_Name_NumberOfOccurrences_4","Match_Name_NumberOfOccurrences_5","Match_Name_NumberOfOccurrences_6","Match_Name_NumberOfOccurrences_7","Match_Name_NumberOfOccurrences_8","Match_Name_NumberOfOccurrences_9","Match_Name_NumberOfPerfectMatches","Match_Name_NumberOfTotalOccurrences","Match_UserName_NumberOfCompleteMatches","Match_UserName_NumberOfOccurrences_0","Match_UserName_NumberOfOccurrences_1","Match_UserName_NumberOfOccurrences_2","Match_UserName_NumberOfOccurrences_3","Match_UserName_NumberOfOccurrences_4","Match_UserName_NumberOfOccurrences_5","Match_UserName_NumberOfOccurrences_6","Match_UserName_NumberOfOccurrences_7","Match_UserName_NumberOfOccurrences_8","Match_UserName_NumberOfOccurrences_9","Match_UserName_NumberOfPerfectMatches","Match_UserName_NumberOfTotalOccurrences"],"PrefixFound":["PrefixFound_Query_Alias_UseFull","PrefixFound_Query_Alias_UseTokens","PrefixFound_Query_Name_UseFull","PrefixFound_Query_Name_UseTokens","PrefixFound_Query_UserName_UseFull","PrefixFound_Query_UserName_UseTokens","PrefixSuggestion_LexSim","PrefixSuggestion_LexSim_ConfidenceClassifier","PrefixSuggestion_PhoneticSim","PrefixSuggestion_PhoneticSim_ConfidenceClassifier","PrefixSuggestion_SuggestionStartsWithPrefix"],"PropertyHit":["PropertyHit_AdditionalName","PropertyHit_Alias","PropertyHit_DisplayName","PropertyHit_EmailAddress","PropertyHit_GivenName","PropertyHit_Surname"],"QueryLevel":["QueryLevelFeature_Query_Length","QueryLevelFeature_Query_NumberOfNormalizedTokens","QueryLevelFeature_Query_NumberOfTokens"]},"UnavailableFeatures":["ContextAwareScore","NonOverlaping_NicknameMatch","PropertyHit_Department","PropertyHit_JobTitle","PropertyHit_Nickname","PropertyHit_OfficeLocation","PropertyHit_Project","PropertyHit_Skill","PropertyHit_Topic","PropertyHit_UPN","Skills_JaccardSimilarity","Topics_JaccardSimilarity","outlookdesktop","teams","owa.react"],"ServerFeatures":["ChatGroupSentInLast30Min","ChatGroupSentInLast5Min","ChatGroupSentInLast60Min","ChatGroupViewedInLast30Min","ChatGroupViewedInLast5Min","ChatGroupViewedInLast60Min","ChatOneOnOneSentInLast30Min","ChatOneOnOneSentInLast5Min","ChatOneOnOneSentInLast60Min","ChatOneOnOneViewedInLast30Min","ChatOneOnOneViewedInLast5Min","ChatOneOnOneViewedInLast60Min","CompanyName_LexSimSelfToSuggestion","Department_LexSimSelfToSuggestion","DisplayNameShareLast_SelfToSuggestion","EmailSentInLast30Min","EmailSentInLast5Min","EmailSentInLast60Min","EmailShareHost_SelfToSuggestion","EmailViewedInLast30Min","EmailViewedInLast5Min","EmailViewedInLast60Min","FastRankRelevanceScore","FirstClickTimeStampQF","FirstClickTimeStampQFOMAndroidEmail","FirstClickTimeStampQFOMIosEmail","FirstClickTimeStampQFOutlookDesktop","FirstClickTimeStampQFOutlookMobile","FirstClickTimeStampQFOutlookUniversalEmail","FirstClickTimeStampQFOwaReact","FirstClickTimeStampQFSharePoint","HasManager","HitCountAllDaysOutlookDesktop","HitCountAllDaysOwaReact","HitCountAllDaysQFOMAndroidEmail","HitCountAllDaysQFOMIosEmail","HitCountAllDaysQFOutlookMobile","HitCountAllDaysQFOutlookUniversalEmail","HitCountAllDaysQFSharePoint","HitCountLast1DaysOutlookDesktop","HitCountLast1DaysOwaReact","HitCountLast1DaysQFOMAndroidEmail","HitCountLast1DaysQFOMIosEmail","HitCountLast1DaysQFOutlookMobile","HitCountLast1DaysQFOutlookUniversalEmail","HitCountLast3DaysOutlookDesktop","HitCountLast3DaysOwaReact","HitCountLast3DaysQFOMAndroidEmail","HitCountLast3DaysQFOMIosEmail","HitCountLast3DaysQFOutlookMobile","HitCountLast3DaysQFOutlookUniversalEmail","HitCountLast3DaysQFSharePoint","HitCountLast7DaysOutlookDesktop","HitCountLast7DaysOwaReact","HitCountLast7DaysQFOMAndroidEmail","HitCountLast7DaysQFOMIosEmail","HitCountLast7DaysQFOutlookMobile","HitCountLast7DaysQFOutlookUniversalEmail","HitCountLast7DaysQFSharePoint","HitCountOM","HitCountQF","HitCountQFOMAndroidEmail","HitCountQFOutlookDesktop","HitCountQFOutlookUniversalEmail","HitCountQFOwaReact","IsSelf","JobTitle_LexSimSelfToSuggestion","LastClickTimeStampQF","LastClickTimeStampQFOMAndroidEmail","LastClickTimeStampQFOMIosEmail","LastClickTimeStampQFOutlookDesktop","LastClickTimeStampQFOutlookMobile","LastClickTimeStampQFOutlookUniversalEmail","LastClickTimeStampQFOwaReact","LastClickTimeStampQFSharePoint","OfficeLocation_LexSimSelfToSuggestion","PeopleSource","PeopleSubtype","PeopleType","HitCountLast1DaysQFSharePoint","FileViewedInLast60Min","FileViewedInLast5Min","FileModifiedInLast5Min","FileViewedInLast30Min","FileModifiedInLast60Min","LastClickTimeStampQFTeamsPowerbar","HitCountLast3DaysQFTeamsPowerbar","HitCountLast1DaysQFTeamsPowerbar","FirstClickTimeStampQFTeamsPowerbar","LastClickTimeStampQFOutlookMobileV2","FirstClickTimeStampQFOutlookMobileV2","HitCountLast7DaysQFTeamsPowerbar","HitCountQFTeamsPowerbar","FirstClickTimeStampQFSharePointV2","LastClickTimeStampQFSharePointV2","HitCountAllDaysQFTeamsPowerbar","FileModifiedInLast30Min"]}')},13877:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.setDynamicModel=t.dynamicFeatureIndexMap=void 0;const a=r(12193),n=r(10266),s=r(12194),o=i(r(12196));t.setDynamicModel=function(e){if(null==e||null==e.Model)return t.dynamicFeatureIndexMap=new o.default({}),"";let r=e.Model;t.dynamicFeatureIndexMap=new o.default(r.FeatureIndexMap);let i=new s.Ranker(r.Evaluators),u=new a.Aggregator(i,!0,null!=r.ScoreCalibratorInputs?r.ScoreCalibratorInputs.Weight:1,null!=r.ScoreCalibratorInputs?r.ScoreCalibratorInputs.Bias:0),c=[];if(null!=r.Dependencies&&r.Dependencies.length>0)for(let e of r.Dependencies){let t=new s.Ranker(e.Evaluators),r=new a.Aggregator(t,!1);c.push({guid:e.ModelName,rank:e=>r.rank(e)})}return n.setDynamicSuggestionModel({guid:r.ModelName,rank:e=>u.rank(e)},c,t.dynamicFeatureIndexMap,r.Featurizers),r.ModelName}},13878:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=r(12198),a=r(7645),n=r(12200);t.default=function(e,t,r){let s=[];e.forEach(e=>s.push(function(e){var t,r;if(!e)return;let i=[];if(e.DisplayName){let t=n.normalizeQuery(e.DisplayName);i.push({keyword:t,matchField:a.MatchedField.DisplayName})}if(e.GivenName){let r=n.normalizeQuery(e.GivenName),s=null!==(t=e.Surname)&&void 0!==t?t:"";(e.GivenName+" "+s).trim()==e.DisplayName?i.push({keyword:r,matchField:a.MatchedField.DisplayName}):i.push({keyword:r,matchField:a.MatchedField.GivenName})}if(e.Surname){let t=n.normalizeQuery(e.Surname);i.push({keyword:t,matchField:a.MatchedField.Surname})}e.Alias&&i.push({keyword:e.Alias,matchField:a.MatchedField.Alias});(null===(r=e.EmailAddress)||void 0===r?void 0:r.EmailAddress)&&i.push({keyword:e.EmailAddress.EmailAddress.toLowerCase(),matchField:a.MatchedField.EmailAddresses});if(e.AdditionalNames)for(let t of e.AdditionalNames)i.push({keyword:t.toLowerCase(),matchField:a.MatchedField.AdditionalNames});return{keywords:i,suggestion:e}}(e)));let o=new i.SuggestionTrie(t,r);return o.build(s),o}},13879:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNodeForQuery=t.itemInSet=void 0,t.itemInSet=function(e,t){for(let r=0;r<e.length;r++)if(e[r]===t)return!0;return!1},t.getNodeForQuery=function e(t,r){const i=r[t[0]],a=t.substr(1);if(i)return a?e(a,i):i}},13880:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.searchTrie=void 0;const i=r(12199);function a(e,t,r,a,n,o,u,c,l,d){for(;r&&e<t.length;){const f=t[e],h=t[e+1];if(c){const h=i.getFuzzyMatchingRatio(t);h&&0!=e&&n<h.fuzzyCount&&s(f,r,e,t,a,n,o,u,c,l,d)}if(r[f])r=r[f],u+=f;else{if(!r[h]||!d){r=null;break}if(r=r[h],u+=h,e<t.length-1)break}e++}r&&(!c||c&&0!==n)&&(void 0===l[u]||l[u]<a)&&(!function(e,t,r,i,a){const n={score:e,fuzzyCount:t,indices:r.indices,query:i};a.push(n)}(a,n,r,u,o),l[u]=a)}function n(e,t,r){if(1===t.length&&e[t])return e[t];{let i=e,a=0;for(;a<t.length&&null!==i;){let e=t[a];if(!r||!i[e]){i=null;break}i=i[e],a++}return i}}function s(e,t,r,s,o,u,c,l,d,f,h){const m=i.getFuzzyCharSwapsData(e);for(let e=0;e<m.length;e++){const i=m[e],g=n(t,i.char,h);g?a(r+1,s,g,o+i.score,u+1,c,l+i.char,d,f,h):""===i.char&&a(r+1,s,t,o+i.score,u+1,c,l+i.char,d,f,h)}const g=i.getFuzzyCharSwapsData("");for(let e=0;e<g.length;e++){const i=g[e],m=n(t,i.char,h);m&&a(r,s,m,o+i.score,u+1,c,l+i.char,d,f,h)}}t.searchTrie=function(e,t,r,i,n=!1){a(0,e,t,0,0,r,"",i,{},n)}},13881:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.searchCacheTrie=void 0;const i=r(12200),a=r(12192),n=r(7645),s=10,o=25;t.searchCacheTrie=function(e,t,r,u,c,l,d){if(!e)return[];let f=e.keySelector,h=i.normalizeQuery(t),m=e.getSuggestions(h,l),g=[].concat(...m.map(e=>e.indices.map(t=>({index:t.id,fuzzyCount:e.fuzzyCount,score:e.score+t.id,matchField:t.matchField})))).sort((e,t)=>e.score-t.score).map(t=>(function(e,t,r){let i=e.resolveIndex(t.index);return{suggestion:i,suggestionKey:r(i),matchedFieldInfo:t.matchField,fuzzyCount:t.fuzzyCount}})(e,t,f)),p={},S=[],F=function(e){return e?o:s}(d);for(var y=0;y<g.length;++y){if(u(g[y].suggestion.EmailAddress))continue;let e=f(g[y].suggestion);if(e in p)0==g[y].fuzzyCount&&g[y].matchedFieldInfo==n.MatchedField.DisplayName&&(S[p[e]].matchedFieldInfo=g[y].matchedFieldInfo);else if(S.push(g[y]),p[e]=S.length-1,S.length==F)break}return 0==S.length?[]:a.rankPeople(S,h,c,d).slice(0,r)}},13882:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i="suggestionId";t.default=class{constructor(e,t){this.cacheFeatureValues=[],this.serverFeatureValues=[],this.maxCacheSuggestions=e,this.keySelector=t}addCacheFeatureValues(e){e.forEach(e=>{var t;let r=e.FeatureData?Object.assign({},JSON.parse(e.FeatureData)):{};r[i]=null!==(t=e.PersonId)&&void 0!==t?t:"",this.cacheFeatureValues.push([this.keySelector(e),JSON.stringify(r)])})}addServerFeatureValues(e){e.forEach(e=>{var t,r;let a=null!==(t=e.FeatureData)&&void 0!==t?t:{};a[i]=null!==(r=e.PersonId)&&void 0!==r?r:"",this.serverFeatureValues.push([this.keySelector(e),JSON.stringify(a)])})}buildFeatureValueEntries(){var e;let t=this.cacheFeatureValues.map(e=>{var t;return null!==(t=e[1])&&void 0!==t?t:""}),r=new Set;if(this.cacheFeatureValues.forEach(e=>r.add(e[0])),this.cacheFeatureValues.length<this.maxCacheSuggestions)for(let i=0;i<this.serverFeatureValues.length;i++)r.has(this.serverFeatureValues[i][0])||t.push(null!==(e=this.serverFeatureValues[i][1])&&void 0!==e?e:"");return t}}},13883:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPersonId=void 0;const i="MkU4MDBGNDUtMEY3OS00MzM4LTg3RUUtNENFOTFBRURCODcx";t.getPersonId=function(e){return e&&function(e){return-1==(null==e?void 0:e.indexOf("@"))&&(t=e,!(0==(null==t?void 0:t.indexOf(i))));var t}(e)?e:void 0}},159:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return s}));const i=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function n(){return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}function s(e){return i.test(e)}},211:function(e,t,r){"use strict";var i=r(930);r.d(t,"a",(function(){return i.a}))},2356:function(e,t,r){"use strict";r.r(t);var i=r(2),a=Object(i.createStore)("peoplesuggestiontriestore",{recipientTrie:null})(),n=r(9354),s=r(4596),o=r(68);var u=r(159),c=r(211),l=r(155),d=r(3684),f=r(22);const h="/search/api/v2/modelserve/people?",m="CSRClientEnabled";async function g(){return Object(l.b)(h+function(e){const t=Object.assign({cvid:e,scenario:"owa.react.compose",setflight:m},Object(d.a)());return Object.keys(t).map(e=>`${e}=${t[e]}`).join("&")}(Object(u.a)()),void 0,!0,null,!0,!1).then(e=>Object(c.a)(e.status)?e.json():(f.h.warn("ModelServe People response failed with response code: "+e.status),null)).catch(e=>(f.h.warn("ModelServe People response failed with error: "+e),null))}var p=r(4281),S=Object(o.s)({name:"RecipientTrieInitialization"},(async function(e,t={store:a}){if(!e||0==e.length)return!1;let r=await g();if(null==r)return Object(o.p)("setDynamicModel_RankerModelVersion",[""]),!1;let i=Object(n.setDynamicModel)(r);Object(o.p)("setDynamicModel_RankerModelVersion",[i]),Object(n.setFuzzyCharSwapsData)(r.Mispellings),function(e,t){if(!e||0==e.length)return;let r=0,i=0;e.forEach(e=>{let a=Object(s.a)(e);if(!a||n.featureStores.has(a))return;let o={};if(e.FeatureData){let a=e.FeatureData,n=Object.keys(a);n.forEach((function(e){(t.isL1feature(e)||t.hasFeature(e))&&(o[t.getFeatureIndex(e)]=a[e])})),i+=n.length,++r}n.featureStores.set(a,o)}),Object(o.p)("CreateFeatureStore",[e.length,r,i])}(e,n.dynamicFeatureIndexMap),F(t.store,e);let u=t.store.recipientTrie.getStatistics();return Object(o.p)("RecipientSuggestionTrie",[u.numberOfNodes,u.numberOfIndices]),!0}));const F=Object(i.mutatorAction)("setRecipientTrie",(e,t)=>{e.recipientTrie=Object(n.constructSuggestionTrie)(function(e){return e.sort((e,t)=>y(t)-y(e)),e}(t),s.a,p.a)});function y(e){let t=Object(s.a)(e);return n.featureStores.get(t)[n.dynamicFeatureIndexMap.getFeatureIndex("173")]}var b=r(25),M=r(220);const O="RecipientTrieSearch";function _(e,t,r){const i=Object(b.k)("rp-peopleSuggestionTrieSpellCorrection"),s=new o.b(O);let u=Object(n.searchCacheTrie)(a.recipientTrie,e,t,r,Object(M.a)(),i);return s.end(),u}var k=r(4380);function C(e,t){let r=new Map;if(!t)return v(r,!0,!1),"";if(!t.Groups)return v(r,!1,!0),"";try{let a=e.map(e=>Object(s.a)(e)),u=new Map;var i=new Array;let c=new Map,l=new Map,d=Object(n.getL2Features)();for(const e of t.Groups)if("People"===e.Type){e.Suggestions.forEach(e=>{var n;const o=Object(k.a)(e,null===(n=t.Instrumentation)||void 0===n?void 0:n.TraceId,!0);let l=Object(s.a)(o);u.set(l,o),i.push(o);let f=a.includes(l);if(!f){let e=o.FeatureData.PeopleSource;c[e]=c[e]?c[e]+1:1}r.set(l,N(l,o.FeatureData,f,d))});break}for(let t of e){let e=Object(s.a)(t),r=u.get(e),i=n.featureStores.get(e);if(!r){let e=i[n.dynamicFeatureIndexMap.getFeatureIndex("PeopleSource")];l[e]=l[e]?l[e]+1:1}}return v(r,!1,!1),function(e,t){for(var r=[0,0,0,0,0],i=0,a=0;a<r.length&&(e[a]&&t[a]);a++){let n=Object(s.a)(e[a]),o=Object(s.a)(t[a]);n==o?r[a]=1:i+=1}Object(o.p)("SuggestionsTrie_RankingQuality_CorrectMatches",r),Object(o.p)("SuggestionsTrie_RankingQuality_NumberOfOrderMismatches",[i])}(e,i),Object(o.p)("SuggestionsTrie_missingSuggestions",[JSON.stringify(c),JSON.stringify(l)]),function(e){let t="";if(e.forEach((e,r,i)=>{let a="";for(let t=0;t<e.length;t++)a+=" Feature: "+e[t].featureName+" ClientVal: "+e[t].clientSideFeatureValue+" ServerVal: "+e[t].serversideFeatureValue;""!=a&&(t+=" [ "+r+": "+a+" ] ")}),""!=t)return" { Detected Feature Value Differences: "+t+" }";return"{ No feature value difference detected. }"}(r)}catch(e){let t=" { compareFeatureData failed: "+e.toString()+" } ";return Object(o.p)("SuggestionsTrie_compareFeatureData",[0,0,0,0,!1,!1,t]),t}}function N(e,t,r,i){var a,s;let o=new Array,u=n.featureStores.get(e);if(!u)return o;const c=n.dynamicFeatureIndexMap.getFeatureIndexMap();for(let[e,n]of Object.entries(c)){let c=null!==(a=u[n])&&void 0!==a?a:0,l=null!==(s=P(t,e))&&void 0!==s?s:0;if(c!=l){if(r){let t={featureName:e,clientSideFeatureId:n,clientSideFeatureValue:c||0==c?c.toString():"",serversideFeatureValue:l||0==l?l.toString():""};o.push(t)}-1==i.indexOf(e)&&(u[n]=l)}}return o}function v(e,t,r){let i=0,a=0,s=0,u=0,c="",l=0;e.forEach((e,t,r)=>{e.length>0&&i++,a+=e.length;let o="";for(let t=0;t<e.length;t++)if(""==e[t].clientSideFeatureValue&&""!=e[t].serversideFeatureValue?s++:""==e[t].serversideFeatureValue&&""!=e[t].clientSideFeatureValue&&u++,e[t].clientSideFeatureValue!=e[t].serversideFeatureValue){o+=" [ F: "+e[t].featureName+" C: "+e[t].clientSideFeatureValue+" S: "+e[t].serversideFeatureValue+" ] ",e[t].featureName.substring(0,n.APF_PREFIX.length)!=n.APF_PREFIX&&l++}""!=o&&(c+=" { "+o+" } ")}),""==c&&(c="{ No fv diff detected.}"),Object(o.p)("SuggestionsTrie_compareFeatureData",[i,a,l,s,u,t,r,c])}function P(e,t){let r;return t.substring(0,n.APF_PREFIX.length)===n.APF_PREFIX&&(r=t.substring(n.APF_PREFIX.length)),e[null!=r?r:t]}function I(){return null==a.recipientTrie}r.d(t,"initializeSuggestionTrie",(function(){return S})),r.d(t,"searchCacheTrie",(function(){return _})),r.d(t,"compareFeatureData",(function(){return C})),r.d(t,"isSuggestionTrieEmpty",(function(){return I}))},3663:function(e,t,r){"use strict";r.d(t,"b",(function(){return a}));var i=r(2);const a=Object(i.createStore)("substratepeoplesuggestions",{sessionMaskedRecipients:[]}),n=a();t.a=n},3684:function(e,t,r){"use strict";var i=r(154);var a=r(25),n=r(7);r.d(t,"a",(function(){return o}));const s="searchtesthook";function o(e={}){const t=function(e,...t){const r={};for(const i of t)for(const t of Object.keys(i))e.includes(t)&&r.hasOwnProperty(t)?r[t]=r[t]+","+i[t]:r[t]=i[t];return r}(["setflight"],e,function(){let e={};const t=Object(n.c)(s),r=decodeURIComponent(t||"").trim();if(Object(a.k)("sea-debugHook")&&r.length>0){e=r.split("&").reduce((e,t)=>{const[r,i]=t.split("=");return e[r]=i,e},{})}return e}(),Object(i.a)("includePartnerIn3SRequest")?{partner:"exchangeshared"}:{});return Object.keys(t).filter(e=>null!==t[e]).reduce((e,r)=>Object.assign(Object.assign({},e),{[r]:t[r]}),{})}},4281:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var i=r(3663);function a(e){return!!Object(i.b)().sessionMaskedRecipients[e]}},4380:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var i=r(6),a=r(4281);const n="MkU4MDBGNDUtMEY3OS00MzM4LTg3RUUtNENFOTFBRURCODcx",s=e=>e?{Id:e,__type:"ItemId:#Exchange"}:void 0;function o(e,t,r,n){const{EmailAddresses:o,DisplayName:h,Text:m,PDLItemId:g,ADObjectId:p,PersonaId:S,FeatureData:F,Id:y,ReferenceId:b,ImAddress:M,JobTitle:O,PeopleType:_,PeopleSubtype:k,GivenName:C,Surname:N,Alias:v,Phones:P,Department:I,OfficeLocation:A,AdditionalNames:L,PersonId:E}=e,x=o?o[0]:void 0;if(!r&&x&&Object(a.a)(x))return null;const D={EmailAddress:x,Name:Object(i.j)(h)?m:h,MailboxType:l(k),RoutingType:u(k),ItemId:s(g)};var T;return{DisplayName:h,ADObjectId:p,FeatureData:F,Id:y,ImAddress:M,EmailAddress:D,EmailAddresses:[D],PersonaTypeString:c(k),PersonaId:s(S),Title:O,ReferenceId:b,PeopleType:_,PeopleSubtype:k,GivenName:C,Surname:N,TransactionId:t,LogicalId:n,Alias:v,PhoneNumber:d(P),Department:I,Location:A,AdditionalNames:L,PersonId:(T=E,T&&f(T)?T:void 0)}}function u(e){return"PersonalDistributionList"==e?"MAPIPDL":"SMTP"}function c(e){switch(e){case"PublicDistributionList":case"PersonalDistributionList":return"DistributionList";case"UnifiedGroup":return"ModernGroup";case"OrganizationUser":case"PersonalContact":case"ImplicitContact":case"OrganizationContact":return"Person";case"LinkedIn":return"LinkedIn";case"ImplicitGroup":return"ImplicitGroup";default:return"Unknown"}}function l(e){switch(e){case"PublicDistributionList":return"PublicDL";case"PersonalDistributionList":return"PrivateDL";case"UnifiedGroup":return"GroupMailbox";case"ImplicitGroup":return"RecommendedGroup";case"OrganizationUser":return"InternalMailbox";case"LinkedIn":return"LinkedIn";case"PersonalContact":case"OrganizationContact":case"ImplicitContact":case"Guest":case"Unknown":return"ExternalMailbox";default:return e}}function d(e){return(null==e?void 0:e.length)?{Number:e[0].Number,Type:e[0].Type}:{Number:""}}function f(e){return-1==(null==e?void 0:e.indexOf("@"))&&!(0==(null==(t=e)?void 0:t.indexOf(n)));var t}},4596:function(e,t,r){"use strict";function i(e){var t,r;return e?(null===(t=e.EmailAddress)||void 0===t?void 0:t.EmailAddress)||(null===(r=e.PersonaId)||void 0===r?void 0:r.Id):null}r.d(t,"a",(function(){return i}))},7103:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.splitWithSeparators=t.tokenize=t.getNumberOfTokens=t.normalizeString=void 0;const i=128,a=function(e){let t=new Array(i);for(let e=0;e<i;e++)t[e]=0;t[9]=9,t[10]=10,t[13]=13;for(var r=20;r<i;r++)t[r]=r;let a="A";for(;a!=d("Z",1);)t[a.charCodeAt(0)]=a.charCodeAt(0)+32,a=d(a,1);for(let r=0;r<e.length;r++){if(!(e[r].charCodeAt(0)<i))throw new Error(`The char ${e[r]} is not supported to build lookup table`);t[e[r].charCodeAt(0)]=0}return t}(" \t,'\"-.;:)(][\n\r+@!&?\\/^%$#&*_=|}{<>~".split("")),n=56320,s=57343,o=55296,u=56319;function c(e){let t=[];t.length=e.length+1;let r=!1,n=0;for(var s=0;s<e.length;s++){let u=e.charAt(s);if(u.charCodeAt(0)<i){var o=a[u.charCodeAt(0)];0!=o?(t[n++]=String.fromCharCode(o),r=!0):(r&&(t[n++]=" "),r=!1)}else l(u)?(r&&(t[n++]=" "),r=!1):(r=!0,t[n++]=u.toLowerCase())}return!r&&n>0&&--n,t.join("").substring(0,n)}function l(e){return e.charCodeAt(0)>=n&&e.charCodeAt(0)<=s||e.charCodeAt(0)>=o&&e.charCodeAt(0)<=u}function d(e,t){return String.fromCharCode(e.charCodeAt(0)+t)}t.normalizeString=c,t.getNumberOfTokens=function(e){let t=0,r=!0;for(var i=0;i<e.length;i++){let a=e.charAt(i);" "==a||"\t"==a||"\n"==a?r=!0:1==r&&(t++,r=!1)}return t},t.tokenize=function(e,t){return t&&(e=c(e)),e.split(" ")},t.splitWithSeparators=function(e,t){for(var r=e,i=0;i<t.length;i++)r=r.split(t[i]).join(",");return r.split(",")}},7645:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MatchedField=void 0,function(e){e[e.DisplayName=0]="DisplayName",e[e.GivenName=1]="GivenName",e[e.Surname=2]="Surname",e[e.EmailAddresses=3]="EmailAddresses",e[e.Alias=4]="Alias",e[e.AdditionalNames=5]="AdditionalNames"}(t.MatchedField||(t.MatchedField={}))},930:function(e,t,r){"use strict";function i(e){return e>=200&&e<300}r.d(t,"a",(function(){return i}))},9354:function(e,t,r){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),a(r(12183),t),a(r(12189),t),a(r(12187),t),a(r(12186),t),a(r(12188),t),a(r(12185),t),a(r(12184),t),a(r(9355),t);var n=r(12191);Object.defineProperty(t,"getLexicalSimilarityThreshold",{enumerable:!0,get:function(){return n.getLexicalSimilarityThreshold}}),a(r(10265),t),a(r(12192),t),a(r(13877),t),a(r(7103),t),a(r(7645),t);var s=r(13878);Object.defineProperty(t,"constructSuggestionTrie",{enumerable:!0,get:function(){return s.default}}),a(r(13881),t),a(r(12198),t),a(r(12195),t);var o=r(12196);Object.defineProperty(t,"FeatureIndexMap",{enumerable:!0,get:function(){return o.default}}),a(r(12197),t),a(r(12193),t);var u=r(12194);Object.defineProperty(t,"Ranker",{enumerable:!0,get:function(){return u.Ranker}}),a(r(12199),t),a(r(10266),t);var c=r(13882);Object.defineProperty(t,"FeatureValueLoggingStore",{enumerable:!0,get:function(){return c.default}});var l=r(13883);Object.defineProperty(t,"getPersonId",{enumerable:!0,get:function(){return l.getPersonId}});var d=r(12190);Object.defineProperty(t,"getL2Features",{enumerable:!0,get:function(){return d.getL2Features}})},9355:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.computeLexicalSimilarity=t.calculateLexicalSimilarityFeatures=t.computeUnnormalisedTokenBasedLexicalSimilarity=t.computeLexicalSimilarityFeatures=void 0;const i=r(10265),a=r(7103),n=r(7645),s=r(12187),o=[" ","/","-",",","_"];function u(e,t,r){let i=0,a=t.slice();for(let t=0;t<e.length;t++){let n=e[t],o=0,u=-1;for(let e=0;e<a.length;e++){let i=r?s.computePhoneticSimilarity(n,a[e]):l(n,a[e]);i>o&&(o=i,u=t)}u>=0&&(a.splice(u,1),i+=o)}return i}function c(e,t,r){r=r.replace(/ *\([^)]*\) */g," ").trim();let i=e+" ",n=t.length>1,s=a.splitWithSeparators(r,o),c=r.length>0&&e.indexOf(r)>=0,l=u(t,s,!1),d=c?1:l/t.length,f=c?1:l/s.length,h=n?r.toLowerCase().substring(0,e.length)==e.toLowerCase()?1:0:r.toLowerCase().substring(0,i.length)==i.toLowerCase()?1:0,m=u(t,s,!0);return{lexSim:d,lexSimConfidenceClassifier:f,phoneticSimilarity:c?1:m/t.length,phoneticSimilarityClassifier:c?1:m/s.length,suggestionStartsWithPrefix:h}}function l(e,t,r=0){let i=e.length,a=t.length;if(0==i||0==a)return 0;if(0==i&&0==a)return 1;i<a&&([e,t]=[t,e],i=e.length,a=t.length);let n=new Array(a+1);for(let e=0;e<=a;++e)n[e]=e;let s=new Array(a+1);for(let o=1;o<=i;++o){s[0]=o;for(let i=1;i<=a;++i){let a,u=t[i-1]!=e[o-1];if(1==o&&1==i&&u&&r>0)a=r;else{let e=n[i]+1,t=s[i-1]+1,r=n[i-1]+(u?1:0);a=Math.min(e,Math.min(t,r))}s[i]=a}let i=n;n=s,s=i}return 1-n[a]/Math.max(i,a)}t.computeLexicalSimilarityFeatures=function(e,t,r,s,l,d,f){let h=e.toLowerCase().trim();t=t.toLowerCase(),l=l?l.toLowerCase():"";let m=a.splitWithSeparators(h,o);var g={lexSim:0,lexSimConfidenceClassifier:0,suggestionStartsWithPrefix:0,phoneticSimilarity:0,phoneticSimilarityClassifier:0};if(r){let t=l.split(" "),r=u(m,t,!1),i=e+" ";g.lexSim=r/m.length,g.lexSimConfidenceClassifier=r/t.length,g.suggestionStartsWithPrefix=l.toLowerCase().substring(0,i.length)==i.toLowerCase()?1:0;let a=u(m,t,!0);g.phoneticSimilarity=a/m.length,g.phoneticSimilarityClassifier=a/t.length}else switch(s){case n.MatchedField.DisplayName:case n.MatchedField.GivenName:case n.MatchedField.Surname:case n.MatchedField.AdditionalNames:g=c(h,m,l);break;case n.MatchedField.EmailAddresses:g=c(h,m,i.aliasFromEmailAddress(t));break;case n.MatchedField.Alias:g=c(h,m,t)}f.setFeature("PrefixSuggestion_LexSim",g.lexSim,d),f.setFeature("PrefixSuggestion_LexSim_ConfidenceClassifier",g.lexSimConfidenceClassifier,d),f.setFeature("PrefixSuggestion_PhoneticSim",g.phoneticSimilarity,d),f.setFeature("PrefixSuggestion_PhoneticSim_ConfidenceClassifier",g.phoneticSimilarityClassifier,d),f.setFeature("PrefixSuggestion_SuggestionStartsWithPrefix",g.suggestionStartsWithPrefix,d)},t.computeUnnormalisedTokenBasedLexicalSimilarity=u,t.calculateLexicalSimilarityFeatures=c,t.computeLexicalSimilarity=l}}]);
//# sourceMappingURL=owa.658.js.map
self.scriptsLoaded['owa.658.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.658.js'] = (new Date()).getTime();