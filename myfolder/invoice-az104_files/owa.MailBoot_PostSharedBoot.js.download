self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~PostSharedBoot.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[416],{114:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c}));var r=n(11);const o="sdmp";function c(){try{const e=Object(r.a)(window,o);return e?JSON.parse(e).InboxReadingPanePosition:void 0}finally{return}}},124:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c}));var r=n(46);function o(){let e=Object(r.b)(),t=e.origin;return t||(t=e.protocol+"//"+e.hostname+(e.port?":"+e.port:"")),t}function c(){return o()+"/"}},2295:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));const r={bo:1,authredirect:1,layout:1,animation:1,allow:1,offline:1,ispopout:1,debugjs:1,cvero:1,ae:1,gulp:1,branch:1,features:1,livepersonacardversionoverride:1,midgardtestendpoint:1,cspoff:1,bootflights:1,login_hint:1,prompt:1,jitexp:1};function o(e){if(!e||0==e.length||"?"!=e.charAt(0))return;const t=e.substr(1).split("&").map(e=>e.split("=")[0].toLowerCase());return t.includes("offlineboot")?t.includes("bo")?"bo":void 0:t.filter(e=>r[e])[0]}},235:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const r=250,o=65,c=29;function a(e,t,n,a){if(e.append("X-Js-Experiment","5"),t&&0!=t.toLowerCase().indexOf("/mail")){e.append("X-Folder-Count","0"),e.append("X-Message-Count","0");const n=t.toLowerCase();0!=n.indexOf("/calendar")&&0!=n.indexOf("/opx")||e.append("X-Calendar-Folders","1")}else if(n){const t=a?o:c;e.append("X-Message-Count",`${Math.floor((n-r)/t)}`)}}},347:function(e,t,n){"use strict";var r,o,c,a,i,s;!function(e){e[e.Install=0]="Install",e[e.UnInstall=1]="UnInstall",e[e.Tracing=2]="Tracing"}(r||(r={})),function(e){e.Updates="Updates",e.Resources="Resources"}(o||(o={})),function(e){e.None="0",e.Logging="1",e.Telemetry="2",e.All="3"}(c||(c={})),function(e){e[e.Checking=0]="Checking",e[e.Downloading=1]="Downloading",e[e.Progress=2]="Progress",e[e.Error=3]="Error",e[e.Cached=4]="Cached",e[e.NoUpdate=5]="NoUpdate",e[e.Obsolete=6]="Obsolete",e[e.UpdateReady=7]="UpdateReady",e[e.Idle=8]="Idle",e[e.UnCached=9]="UnCached",e[e.CleanupError=10]="CleanupError",e[e.CleanupSuceeded=11]="CleanupSuceeded",e[e.ManifestDate=12]="ManifestDate"}(a||(a={})),function(e){e[e.CacheProgress=0]="CacheProgress",e[e.Error=1]="Error",e[e.OnCacheInstall=2]="OnCacheInstall"}(i||(i={})),function(e){e[e.CacheInstalled=0]="CacheInstalled",e[e.CacheFailed=1]="CacheFailed",e[e.CacheCleared=2]="CacheCleared"}(s||(s={}));var u=s,l=n(235);n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return a})),n.d(t,"f",(function(){return i})),n.d(t,"d",(function(){return u})),n.d(t,"g",(function(){return l.a}))},3596:function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r=n(20);const o=new r.c(()=>n.e(1214).then(n.bind(null,5373))),c=new r.a(o,e=>e.tti),a=new r.a(o,e=>e.govern),i=new r.a(o,e=>e.enableGovernReport)},4092:function(e,t,n){"use strict";var r=n(20),o=n(2),c=n(68);const a=(e,t,n)=>{let r=null;return{init:a=>{try{if(!r)return r=Object(o.createStore)(e,t),n(r()),Object.assign(Object.assign({},a),{[e]:r})}catch(t){Object(c.p)("DeclareDiagnosticFailed",{n_1:e,er:t.message})}return a},getIfInitialized:()=>r?r():null}};n.d(t,"b",(function(){return s})),n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return l})),n.d(t,"g",(function(){return d})),n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return a}));const i=new r.c(()=>Promise.all([n.e(1),n.e(2),n.e(3),n.e(6),n.e(11),n.e(16),n.e(20),n.e(51),n.e(69),n.e(83),n.e(133),n.e(158),n.e(633)]).then(n.bind(null,19767))),s=Object(r.d)(i,e=>e.DiagnosticsPanel),u=new r.a(i,e=>e.registerDiagnostics),l=(new r.b(i,e=>e.setSelectedPivot),new r.b(i,e=>e.getDiagnosticsLogState)),d=new r.b(i,e=>e.initializeDefaultDiagnostics),f=Object(r.d)(i,e=>e.DiagnosticsHost),h=(Object(r.d)(i,e=>e.DiagnosticsInspector),Object(r.d)(i,e=>e.TwoColumnInspector))},430:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(89);function o(e){return Object(r.a)(e,[r.c])}},462:function(e,t,n){"use strict";class r{constructor(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}add(e){this.taskList.unshift(e),this.scheduleTask()}clear(){this.taskList.splice(0,this.taskList.length)}canRunMoreTasks(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0}scheduleTask(){this.canRunMoreTasks()&&setTimeout(()=>{this.tryRunTask()},this.taskDelay)}onTaskComplete(){this.numberOfTasksRunning--,this.scheduleTask()}tryRunTask(){if(this.canRunMoreTasks()){let e=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(e).then(()=>{this.onTaskComplete()}).catch(()=>{this.onTaskComplete()}),this.scheduleTask()}}}n.d(t,"a",(function(){return r}))},483:function(e,t,n){"use strict";var r=n(430),o=n(36),c=n(89);function a(e){return Object(c.a)(e,[c.b])}var i=n(40),s=n(73);function u(e){return Object(i.b)(Object(i.c)(Object(i.a)(Object(s.a)()||"",e)))}var l=n(600),d=n(763),f=n(223);let h,b,p;function g(){return h||(h=Object(o.a)("/calendar")+"/"),h}function v(){return b||(b=Object(o.a)("/mail")+"/"),b}function O(){return p||(p=Object(o.a)("/files")+"/"),p}var j=n(945);let m,w,C;function k(e){return m&&w===e||(w=e,m=e?Object(o.a)("/people/group/owner")+"/":Object(o.a)("/people/group/member")+"/"),m}function y(){return C||(C=Object(o.a)("/people/group/deleted")+"/"),C}function T(e){return window.location.origin+g()+"showPeek/item/"+encodeURIComponent(e)}var E=n(724),R=n(7),S=n(629);const N=Object(E.a)().split("/").slice(1).join("/")+"deeplink/";function x(e,t,n,r){n&&((r=r||{}).minus="");let o="";if(r){const e=Object(R.d)();Object(S.a)(e),Object.keys(r).filter(e=>e).forEach(t=>e[t]=r[t]),o="?"+Object(R.i)(e)}return`${`/${e}/${N}`}${t}${o}`}var I=n(224),P=n(30);const U="https://to-do.microsoft.com";function M(e,t){var n,r;const o=Object(P.a)(),c=o.UserOptions,a=null===(n=o.SessionSettings)||void 0===n?void 0:n.UserPrincipalName;let i=U,s={};if(null===(r=null==c?void 0:c.ReactOptinSettings)||void 0===r?void 0:r.TasksRedirectUrl){let e="";[i,e]=c.ReactOptinSettings.TasksRedirectUrl.split("?"),s=Object(R.g)(e),a&&(s.auth_upn=a)}return e&&(s.utm_source=e),t&&delete s.fromOwa,Object.keys(s).length>0?Object(f.a)(i,s):i}let W;function D(){return W||(W=Object(o.a)("/eventify")+"?entryPoint=owa"),W}var A=n(124);let $;function L(){return $||($=Object(o.a)("/host")+"/"),$}n(46);n.d(t,"k",(function(){return r.a})),n.d(t,"t",(function(){return o.a})),n.d(t,"g",(function(){return a})),n.d(t,"m",(function(){return u})),n.d(t,"s",(function(){return l.a})),n.d(t,"x",(function(){return i.a})),n.d(t,"a",(function(){return i.b})),n.d(t,"b",(function(){return i.c})),n.d(t,"o",(function(){return d.a})),n.d(t,"v",(function(){return f.a})),n.d(t,"e",(function(){return g})),n.d(t,"l",(function(){return v})),n.d(t,"h",(function(){return O})),n.d(t,"p",(function(){return j.a})),n.d(t,"j",(function(){return k})),n.d(t,"i",(function(){return y})),n.d(t,"d",(function(){return T})),n.d(t,"q",(function(){return x})),n.d(t,"w",(function(){return I.a})),n.d(t,"u",(function(){return M})),n.d(t,"f",(function(){return D})),n.d(t,"n",(function(){return A.a})),n.d(t,"r",(function(){return s.a})),n.d(t,"c",(function(){return L}))},600:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(7),o=n(629);function c(){const e=Object(r.d)();Object(o.a)(e);const t=Object(r.i)(e);return t.length>0?"?"+t:""}},629:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));const r=["hostApp","isanonymous","cspoff","frameName","opxInstanceId","hxVersion"];function o(e){e&&Object.keys(e).forEach(t=>{r.includes(t)&&delete e[t]})}},724:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(73),o=n(36);function c(e){return(Object(o.a)("/"+(e||Object(r.a)()))+"/").replace(/^\//,"")}},763:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(46),o=n(36),c=n(124);function a(e){let t=Object(r.b)(),n=Object(c.a)()+Object(o.a)("/owa")+"/",a=t.search&&t.search.length>0;n+=a?t.search:"?";let i=Object.keys(e),s=a;for(let t=0;t<i.length;t++)s?n+="&":s=!0,n+=i[t]+"="+e[i[t]];return n}},9053:function(e,t,n){"use strict";n.r(t);var r=n(25),o=n(3);async function c(){const e=Object(o.H)()+"scripts/ThirdPartyNotices.txt";try{const t=await fetch(e,{credentials:"same-origin"}),n=await t.text(),r=document.createComment("\nTHIRD-PARTY SOFTWARE NOTICES\nThis file is based on or incorporates material from the projects listed below (Third Party Code). The original copyright notice and the license under which Microsoft received such Third Party Code, are set forth below. Such licenses and notices are provided for informational purposes only. Microsoft licenses the Third Party Code to you under the licensing terms for the Microsoft product. Microsoft reserves all other rights not expressly granted under this agreement, whether by implication, estoppel or otherwise.\n\nYou may find a copy of the Corresponding Source code, if and as required under the Third Party Code License, either bundled with the Microsoft product or at http://3rdpartysource.microsoft.com. If not bundled with the product, you may also obtain a copy of the source code for a period of one year after our last shipment of this product.\n\n=============\n\n"+n);document.head.appendChild(r)}catch(e){}}var a=n(20);const i=new a.c(()=>n.e(1347).then(n.bind(null,20078))),s=new a.a(i,e=>e.setupDevTools);var u=n(244),l=n(7),d=n(483),f=n(154);var h=n(4092),b=n(4827),p=n(68),g=n(9120),v=n(9404),O=n(22),j=n(9857),m=n(107),w=n(6);const C="activated";let k=null;function y(e,t,n,o){var c;const a=e.navigator.serviceWorker;k={serviceWorkerContainer:a,appName:t,userLanguage:null===(c=Object(w.f)())||void 0===c?void 0:c.toLowerCase(),expectedXAppNameHeader:o};let i=Object(d.k)("mail")+"/sw.js",s=[];Object(r.k)("fwk-sw-proxyFetchAlways")&&function(){const{browser:e,browserVersion:t}=Object(m.a)();return("Chrome"==e||"Edge Anaheim"==e)&&t&&t.length>0}()&&s.push("fa=1"),Object(r.k)("fwk-sw-preload")&&s.push("presd=1"),(Object(r.k)("fwk-sw-mini-v2")||Object(l.f)("swMiniV2"))&&s.push("swMiniVersion=2");const u=Object(v.a)(e,s);return u&&(i+="?"+u),n.addCustomData({url:i}),a.register(i,{scope:"/"}).then(()=>a.ready.then(T).catch(()=>"SWReadyError"))}function T(e){return O.h.info("[SW Client] ready fired, state: "+e.active.state),k.serviceWorkerRegistration=e,e.active?E():new Promise(e=>{k.serviceWorkerContainer.oncontrollerchange=()=>{E(),e()}})}function E(){const e=k.serviceWorkerRegistration;return e.active.state==C?(R(),Promise.resolve()):new Promise(t=>{e.active.onstatechange=()=>{e.active.state==C&&(e.active.onstatechange=null,R(),t())}})}function R(){Object(j.b)(k),Object(j.a)()}var S=n(2295);async function N(e,t,n){var c,a;const i=new p.b("RegisterServiceWorker"),s=null===(c=e.navigator)||void 0===c?void 0:c.serviceWorker;let u,d;const h={bt:await Object(o.p)(),sisp:Object(S.a)(null===(a=e.location)||void 0===a?void 0:a.search),ivm:Object(l.f)("version")&&Object(l.f)("popoutv2")};if(s){const o=s.getRegistrations?await s.getRegistrations():[];if(h.swr=function(e){if(!e||e.length<1)return"NoReg";if(e.filter(e=>e.active).length<1)return"NoActive";if(e.filter(e=>e.active.scriptURL&&e.active.scriptURL.indexOf("/sw.js")>-1).length<1)return"NoRel";return"Success"}(o),u=function(){const{browser:e}=Object(m.a)();let t;Object(r.k)("fwk-prefetch-code-off")?t="Error_PrefetchDisabled":"Chrome"==e||"Edge Anaheim"==e?Object(r.k)("fwk-prefetch-code-off-chromium")&&!Object(m.p)([77])&&(t="Error_ChromeMinVersion"):"Edge"==e?Object(m.p)([17,17134])||(t="EdgeMinVersion"):"Safari"==e?Object(m.p)([11,1])||(t="SafariMinVersion"):"Firefox"!=e?t="UnsupportedBrowser:"+e:Object(f.a)("disableServiceWorker")&&(t="NativeTempDisabled");return t}(),u){if(o.length>0)for(let e=0;e<o.length;++e)o[e].unregister()}else try{u=await y(e,t,i,n)}catch(e){d=e,u="RegError"}}else u="SWNotAvailable";h.owa_1=u||"success",i.addCustomData(h),d?i.endWithError("ClientError",d):u?i.endWithError("ServerError"):i.end()}function x(e,t,n){Object(g.b)({condition:!!((null===window||void 0===window?void 0:window.location)&&window.history),task:()=>(function(e,t){const n=["bO","bR","anonRetry","native"];Object(f.a)("nativeQsp")||n.push("sessionId");let r=Object(l.d)(e),o=!1;for(var c=0;c<n.length;c++){const e=n[c];r[e]&&(delete r[e],o=!0)}if(o){let n=Object(u.stringify)(r);n&&(n=`?${n}`);const o=`${Object(d.n)()}${e.pathname}${n}${e.hash}`;t.replaceState(null,null,o)}})(window.location,window.history)},b.a,()=>p.j.importAndExecute(e),{condition:Object(r.k)("fwk-devTools"),task:()=>{s.importAndExecute(),h.g.import().then(e=>{e()})}},{task:()=>N(window,t,n),idle:!0,condition:!!t},{idle:!0,task:c})}n.d(t,"setupSharedPostBoot",(function(){return x}))},9120:function(e,t,n){"use strict";var r=n(462);var o=n(25),c=n(180),a=n(7),i=n(70),s=n(3596);n.d(t,"b",(function(){return y})),n.d(t,"a",(function(){return T}));const u={concurrency:3,delay:1,pulse:1},l="ttiConcurrency",d="ttiDelay",f="ttiPulse",h="ttiMonkey",b=45e3,p=6e4,g=-1;let v=null,O=null,j=null,m=0,w=!1,C=g,k=g;async function y(...e){for(let t=0;t<e.length;++t){const n=e[t],r="function"==typeof n?n:n.task,o=!("function"!=typeof n&&"condition"in n&&!n.condition),c="function"!=typeof n&&!!n.idle;if(o){m++,(await E(c)).add(r)}}}function T(){w=!0,Object(o.k)("fwk-tti-governor-monkey")&&(k=S(h,Math.floor(Math.random()*m)))}function E(e){return e?(O||(O=R(Promise.race([s.c.importAndExecute(),Object(i.a)(b)]))),O):(v||(v=R()),v)}function R(e){const t=function(){j||(j={concurrency:S(l,u.concurrency),pulse:S(f,u.pulse),delay:S(d,u.delay)});return j}();return(e||Object(i.a)(t.delay)).then(()=>(function(e,t,n){return new r.a(e,t,n)})(t.concurrency,N,t.pulse))}function S(e,t){let n=t;return Object(o.k)("fwk-devTools")&&(n=parseInt(Object(a.c)(e))||t),n}function N(e){return C++,C==k?setTimeout(e,p):e(),w&&C==m-1&&(Object(c.d)("ttiGovernEnd",Object.assign(Object.assign({},j),{monkey:k})),w=!1),Promise.resolve()}},9404:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(7);function o(e,t){return["branch","swver"].some(n=>!!Object(r.f)(n,e.location)&&(t.push(`${n}=${Object(r.c)(n,e.location)}`),!0)),t.join("&")}},945:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(36);let o;function c(){return o||(o=Object(r.a)("/people")+"/"),o}},9857:function(e,t,n){"use strict";var r=n(347),o=n(22),c=n(68);const a={[r.b.Error]:"ER",[r.b.Cached]:"C",[r.b.NoUpdate]:"NU",[r.b.Obsolete]:"OB",[r.b.UpdateReady]:"UR"};var i=n(11);function s(e,t){return e+"_"+t}const u="SWCacheErrorCount";function l(e){let t=parseInt(Object(i.a)(window,s(e,u)));return isNaN(t)?0:t}function d(e,t){!function(e,t){let n=s(e,u);0==t?Object(i.d)(window,n):Object(i.e)(window,n,""+t)}(e,t==r.d.CacheFailed?l(e)+1:0)}var f;!function(e){e[e.Normal=0]="Normal",e[e.CacheCorrupt=1]="CacheCorrupt",e[e.TooManyInstallError=2]="TooManyInstallError"}(f||(f={}));var h=f;function b(e,t){if(t.cacheMessage&&(t.targetClient==e.appName||"global"==t.targetClient)){let n=t.cacheMessage;o.h.info("[SW Client] Cache Event: "+n.cacheEvent);let i=null;switch(n.cacheEvent){case r.b.Progress:e.resourcesCached++;break;case r.b.Error:i=r.d.CacheFailed;break;case r.b.Cached:case r.b.NoUpdate:case r.b.UpdateReady:i=r.d.CacheInstalled;break;case r.b.Obsolete:i=r.d.CacheCleared;break;case r.b.CleanupError:e.cacheCleanupStatus=1;break;case r.b.CleanupSuceeded:e.cacheCleanupStatus=2,e.numberOfCachesCleaned=n.cachesCleaned?n.cachesCleaned.length:0}const s=n.cacheEvent==r.b.Obsolete;null!=i&&(d(e.appName,i),function(e,t){Object(c.p)("SWCache",{ev:a[t.cacheEvent],cv:t.cacheVersion,e:t.error,r:t.resource,st:t.status,stk:t.stack,rc:e.resourcesCached,ccs:e.cacheCleanupStatus,ncc:e.numberOfCachesCleaned,ch:e.cacheHealth,app:e.appName}),e.resourcesCached=0,e.cacheCleanupStatus=0,e.numberOfCachesCleaned=0}(e,n)),s&&e.cacheHealth>h.Normal&&(e.cacheHealth=h.Normal,P())}}var p=n(25),g=n(73),v=n(430),O=n(9404),j=n(154),m=n(30),w=n(3),C=n(7);function k(){var e;return y(Object(C.c)("swTracing"))||y(null===(e=Object(w.x)())||void 0===e?void 0:e.swTracing)||r.e.None}function y(e){return Object.values(r.e).indexOf(e)>-1?e:void 0}var T=n(114),E=n(10);n.d(t,"b",(function(){return I})),n.d(t,"a",(function(){return P}));const R=5,S=216e5;let N,x=null;function I(e){x||(x=e,x.serviceWorkerContainer.onmessage=W),Object(j.a)("nativeServiceWorker")&&!N&&(N=setInterval(P,S))}function P(e){var t,n;if(!x)return;const o=Object(v.a)("/"+Object(g.a)())+"/",c=Object(j.a)("nativeServiceWorker"),a=`${o}${c?"native":x.appName}cache.manifest?${Object(O.a)(window,["manifestVersion=2"])}`,i={},s=null===(n=null===(t=Object(m.a)())||void 0===t?void 0:t.SessionSettings)||void 0===n?void 0:n.LogonEmailAddress;s&&(i["X-AnchorMailbox"]=s),c&&(i["x-native-host"]="true");const u={source:x.appName,action:e||(l(x.appName)>R?r.a.UnInstall:r.a.Install),language:x.userLanguage,manifestUrl:a,proxyFetchAlways:Object(p.k)("fwk-sw-proxyFetchAlways"),rootUrl:o,dynamicRequestHeaders:i,expectedXAppNameHeader:x.expectedXAppNameHeader,priorityStrategy:c?r.c.Resources:r.c.Updates,clientId:Object(w.t)(),tracingEnabled:k(),windowHeight:Object(w.q)(),readingPanePosition:Object(T.b)(),dynamicQueryString:M()};x.serviceWorkerRegistration.active.postMessage(u)}const U="bf-";function M(){const e=[...Object(E.d)()];for(const t of Object(p.g)(U)){const n=t.split(U)[1];-1==(null==e?void 0:e.indexOf(n))&&e.push(n)}return e.length>0?`bootflights=${e.join(",")}`:void 0}function W(e){if(e.data){const t=e.data;switch(t.messageType){case r.f.CacheProgress:b(x,t);break;case r.f.Error:!function(e){null!=e.error&&o.d("[SW Client] ServiceWorker Unhandled Exception",e.error)}(t);break;case r.f.OnCacheInstall:const e=t.cacheMessage;if(e){const t=e.status;d(x.appName,"number"==typeof t?t:r.d.CacheFailed)}}}}}}]);
//# sourceMappingURL=owa.MailBoot~PostSharedBoot.js.map
self.scriptsLoaded['owa.MailBoot~PostSharedBoot.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~PostSharedBoot.js'] = (new Date()).getTime();