self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.44.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[44],{2675:function(e,t,o){"use strict";var n,r,i,s,l=o(1),a=o(0),d=o(2650),c=o(195),u=o(650),p=o(297),h=o(514),g=o(359),_=o(225),f=o(50),b=o(1042),m=o(1043),v=o(401),C=o(296),x=o(130),O=o(510),S=o(243),y=o(54),I=o(591),P=o(389),k=o(1251),V=o(57),w=o(2355),j=o(8),T=o(125),H=Object(T.c)((function(e){var t,o=e.semanticColors;return{backgroundColor:o.disabledBackground,color:o.disabledText,cursor:"default",selectors:(t={":after":{borderColor:o.disabledBackground}},t[j.HighContrastSelector]={color:"GrayText",selectors:{":after":{borderColor:"GrayText"}}},t)}})),B={selectors:(n={},n[j.HighContrastSelector]=Object(l.__assign)({backgroundColor:"Highlight",borderColor:"Highlight",color:"HighlightText"},Object(j.getHighContrastNoAdjustStyle)()),n)},F={selectors:(r={},r[j.HighContrastSelector]=Object(l.__assign)({color:"WindowText",backgroundColor:"Window"},Object(j.getHighContrastNoAdjustStyle)()),r)},A=Object(T.c)((function(e,t,o,n,r,i){var s,l=e.palette,a=e.semanticColors,d={textHoveredColor:a.menuItemTextHovered,textSelectedColor:l.neutralDark,textDisabledColor:a.disabledText,backgroundHoveredColor:a.menuItemBackgroundHovered,backgroundPressedColor:a.menuItemBackgroundPressed},c={root:[e.fonts.medium,{backgroundColor:n?d.backgroundHoveredColor:"transparent",boxSizing:"border-box",cursor:"pointer",display:r?"none":"block",width:"100%",height:"auto",minHeight:36,lineHeight:"20px",padding:"0 8px",position:"relative",borderWidth:"1px",borderStyle:"solid",borderColor:"transparent",borderRadius:0,wordWrap:"break-word",overflowWrap:"break-word",textAlign:"left",selectors:(s={},s[j.HighContrastSelector]={border:"none",borderColor:"Background"},s["&.ms-Checkbox"]={display:"flex",alignItems:"center"},s["&.ms-Button--command:hover:active"]={backgroundColor:d.backgroundPressedColor},s[".ms-Checkbox-label"]={width:"100%"},s)},i?[{backgroundColor:"transparent",color:d.textSelectedColor,selectors:{":hover":[{backgroundColor:d.backgroundHoveredColor},B]}},Object(j.getFocusStyle)(e,{inset:-1,isFocusedOnly:!1}),B]:[]],rootHovered:{backgroundColor:d.backgroundHoveredColor,color:d.textHoveredColor},rootFocused:{backgroundColor:d.backgroundHoveredColor},rootDisabled:{color:d.textDisabledColor,cursor:"default"},optionText:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",minWidth:"0px",maxWidth:"100%",wordWrap:"break-word",overflowWrap:"break-word",display:"inline-block"},optionTextWrapper:{maxWidth:"100%",display:"flex",alignItems:"center"}};return Object(j.concatStyleSets)(c,t,o)})),D=Object(T.c)((function(e,t){var o,n,r=e.semanticColors,i=e.fonts,s={buttonTextColor:r.bodySubtext,buttonTextHoveredCheckedColor:r.buttonTextChecked,buttonBackgroundHoveredColor:r.listItemBackgroundHovered,buttonBackgroundCheckedColor:r.listItemBackgroundChecked,buttonBackgroundCheckedHoveredColor:r.listItemBackgroundCheckedHovered},a={selectors:(o={},o[j.HighContrastSelector]=Object(l.__assign)({backgroundColor:"Highlight",borderColor:"Highlight",color:"HighlightText"},Object(j.getHighContrastNoAdjustStyle)()),o)},d={root:{color:s.buttonTextColor,fontSize:i.small.fontSize,position:"absolute",top:0,height:"100%",lineHeight:30,width:32,textAlign:"center",cursor:"default",selectors:(n={},n[j.HighContrastSelector]=Object(l.__assign)({backgroundColor:"ButtonFace",borderColor:"ButtonText",color:"ButtonText"},Object(j.getHighContrastNoAdjustStyle)()),n)},icon:{fontSize:i.small.fontSize},rootHovered:[{backgroundColor:s.buttonBackgroundHoveredColor,color:s.buttonTextHoveredCheckedColor,cursor:"pointer"},a],rootPressed:[{backgroundColor:s.buttonBackgroundCheckedColor,color:s.buttonTextHoveredCheckedColor},a],rootChecked:[{backgroundColor:s.buttonBackgroundCheckedColor,color:s.buttonTextHoveredCheckedColor},a],rootCheckedHovered:[{backgroundColor:s.buttonBackgroundCheckedHoveredColor,color:s.buttonTextHoveredCheckedColor},a],rootDisabled:[H(e),{position:"absolute"}]};return Object(j.concatStyleSets)(d,t)})),M=Object(T.c)((function(e,t,o){var n,r,i,s,a,d,c=e.semanticColors,u=e.fonts,p=e.effects,h={textColor:c.inputText,borderColor:c.inputBorder,borderHoveredColor:c.inputBorderHovered,borderPressedColor:c.inputFocusBorderAlt,borderFocusedColor:c.inputFocusBorderAlt,backgroundColor:c.inputBackground,erroredColor:c.errorText},g={headerTextColor:c.menuHeader,dividerBorderColor:c.bodyDivider},_={selectors:(n={},n[j.HighContrastSelector]={color:"GrayText"},n)},f=[{color:c.inputPlaceholderText},_],b=[{color:c.inputTextHovered},_],m=[{color:c.disabledText},_],v=Object(l.__assign)(Object(l.__assign)({color:"HighlightText",backgroundColor:"Window"},Object(j.getHighContrastNoAdjustStyle)()),{selectors:{":after":{borderColor:"Highlight"}}}),C=Object(j.getInputFocusStyle)(h.borderPressedColor,p.roundedCorner2,"border",0),x={container:{},label:{},labelDisabled:{},root:[e.fonts.medium,{boxShadow:"none",marginLeft:"0",paddingRight:32,paddingLeft:9,color:h.textColor,position:"relative",outline:"0",userSelect:"none",backgroundColor:h.backgroundColor,cursor:"text",display:"block",height:32,whiteSpace:"nowrap",textOverflow:"ellipsis",boxSizing:"border-box",selectors:{".ms-Label":{display:"inline-block",marginBottom:"8px"},"&.is-open":{selectors:(r={},r[j.HighContrastSelector]=v,r)},":after":{pointerEvents:"none",content:"''",position:"absolute",left:0,top:0,bottom:0,right:0,borderWidth:"1px",borderStyle:"solid",borderColor:h.borderColor,borderRadius:p.roundedCorner2}}}],rootHovered:{selectors:(i={":after":{borderColor:h.borderHoveredColor},".ms-ComboBox-Input":[{color:c.inputTextHovered},Object(j.getPlaceholderStyles)(b),F]},i[j.HighContrastSelector]=Object(l.__assign)(Object(l.__assign)({color:"HighlightText",backgroundColor:"Window"},Object(j.getHighContrastNoAdjustStyle)()),{selectors:{":after":{borderColor:"Highlight"}}}),i)},rootPressed:[{position:"relative",selectors:(s={},s[j.HighContrastSelector]=v,s)}],rootFocused:[{selectors:(a={".ms-ComboBox-Input":[{color:c.inputTextHovered},F]},a[j.HighContrastSelector]=v,a)},C],rootDisabled:H(e),rootError:{selectors:{":after":{borderColor:h.erroredColor},":hover:after":{borderColor:c.inputBorderHovered}}},rootDisallowFreeForm:{},input:[Object(j.getPlaceholderStyles)(f),{backgroundColor:h.backgroundColor,color:h.textColor,boxSizing:"border-box",width:"100%",height:"100%",borderStyle:"none",outline:"none",font:"inherit",textOverflow:"ellipsis",padding:"0",selectors:{"::-ms-clear":{display:"none"}}},F],inputDisabled:[H(e),Object(j.getPlaceholderStyles)(m)],errorMessage:[e.fonts.small,{color:h.erroredColor,marginTop:"5px"}],callout:{boxShadow:p.elevation8},optionsContainerWrapper:{width:o},optionsContainer:{display:"block"},screenReaderText:j.hiddenContentStyle,header:[u.medium,{fontWeight:j.FontWeights.semibold,color:g.headerTextColor,backgroundColor:"none",borderStyle:"none",height:36,lineHeight:36,cursor:"default",padding:"0 8px",userSelect:"none",textAlign:"left",selectors:(d={},d[j.HighContrastSelector]=Object(l.__assign)({color:"GrayText"},Object(j.getHighContrastNoAdjustStyle)()),d)}],divider:{height:1,backgroundColor:g.dividerBorderColor}};return Object(j.concatStyleSets)(x,t)})),R=Object(T.c)((function(e,t,o,n,r,i,s,l){return{container:Object(j.mergeStyles)("ms-ComboBox-container",t,e.container),label:Object(j.mergeStyles)(e.label,n&&e.labelDisabled),root:Object(j.mergeStyles)("ms-ComboBox",l?e.rootError:o&&"is-open",r&&"is-required",e.root,!s&&e.rootDisallowFreeForm,l&&!i?e.rootError:!n&&i&&e.rootFocused,!n&&{selectors:{":hover":l?e.rootError:!o&&!i&&e.rootHovered,":active":l?e.rootError:e.rootPressed,":focus":l?e.rootError:e.rootFocused}},n&&["is-disabled",e.rootDisabled]),input:Object(j.mergeStyles)("ms-ComboBox-Input",e.input,n&&e.inputDisabled),errorMessage:Object(j.mergeStyles)(e.errorMessage),callout:Object(j.mergeStyles)("ms-ComboBox-callout",e.callout),optionsContainerWrapper:Object(j.mergeStyles)("ms-ComboBox-optionsContainerWrapper",e.optionsContainerWrapper),optionsContainer:Object(j.mergeStyles)("ms-ComboBox-optionsContainer",e.optionsContainer),header:Object(j.mergeStyles)("ms-ComboBox-header",e.header),divider:Object(j.mergeStyles)("ms-ComboBox-divider",e.divider),screenReaderText:Object(j.mergeStyles)(e.screenReaderText)}})),L=Object(T.c)((function(e){return{optionText:Object(j.mergeStyles)("ms-ComboBox-optionText",e.optionText),root:Object(j.mergeStyles)("ms-ComboBox-option",e.root,{selectors:{":hover":e.rootHovered,":focus":e.rootFocused,":active":e.rootPressed}}),optionTextWrapper:Object(j.mergeStyles)(e.optionTextWrapper)}})),W=o(759),E=o(2662),N=o(2663),K=o(1444),U=o(2351),z=o(412);o.d(t,"a",(function(){return X})),function(e){e[e.backward=-1]="backward",e[e.none=0]="none",e[e.forward=1]="forward"}(i||(i={})),function(e){e[e.clearAll=-2]="clearAll",e[e.default=-1]="default"}(s||(s={}));var q=250,G=a.memo((function(e){return(0,e.render)()}),(function(e,t){e.render;var o=Object(l.__rest)(e,["render"]),n=(t.render,Object(l.__rest)(t,["render"]));return Object(c.e)(o,n)})),$="ComboBox",J={options:[],allowFreeform:!1,autoComplete:"on",buttonIconProps:{iconName:"ChevronDown"}};function Q(e){var t=e.options,o=e.defaultSelectedKey,n=e.selectedKey,r=a.useState((function(){return Z(t,function(e,t){var o=ee(e);if(o.length)return o;return ee(t)}(o,n))})),i=r[0],s=r[1],l=a.useState(t),d=l[0],c=l[1],u=a.useState(),p=u[0],h=u[1];return a.useEffect((function(){if(void 0!==n){var e=ee(n),o=Z(t,e);s(o)}c(t)}),[t,n]),a.useEffect((function(){null===n&&h(void 0)}),[n]),[i,s,d,c,p,h]}var X=a.forwardRef((function(e,t){var o=Object(u.a)(J,e),n=(o.ref,Object(l.__rest)(o,["ref"])),r=a.useRef(null),i=Object(z.a)(r,t),s=Q(n),d=s[0],c=s[1],p=s[2],h=s[3],g=s[4],_=s[5];return a.createElement(Y,Object(l.__assign)({},n,{hoisted:{mergedRootRef:i,rootRef:r,selectedIndices:d,setSelectedIndices:c,currentOptions:p,setCurrentOptions:h,suggestedDisplayValue:g,setSuggestedDisplayValue:_}}))}));X.displayName=$;var Y=function(e){function t(t){var o=e.call(this,t)||this;return o._autofill=a.createRef(),o._comboBoxWrapper=a.createRef(),o._comboBoxMenu=a.createRef(),o._selectedElement=a.createRef(),o.focus=function(e,t){o._autofill.current&&(t?Object(p.b)(o._autofill.current):o._autofill.current.focus(),e&&o.setState({isOpen:!0})),o._hasFocus()||o.setState({focusState:"focused"})},o.dismissMenu=function(){o.state.isOpen&&o.setState({isOpen:!1})},o._onUpdateValueInAutofillWillReceiveProps=function(){var e=o._autofill.current;if(!e)return null;if(null===e.value||void 0===e.value)return null;var t=te(o._currentVisibleValue);return e.value!==t?t:e.value},o._renderComboBoxWrapper=function(e,t){var n=o.props,r=n.label,i=n.disabled,s=n.ariaLabel,c=n.ariaDescribedBy,u=n.required,p=n.errorMessage,g=n.buttonIconProps,_=n.isButtonAriaHidden,f=void 0===_||_,b=n.title,m=n.placeholder,v=n.tabIndex,C=n.autofill,x=n.iconButtonProps,O=n.hoisted.suggestedDisplayValue,S=o.state.isOpen,y=o._hasFocus()&&o.props.multiSelect&&e?e:m;return a.createElement("div",{"data-ktp-target":!0,ref:o._comboBoxWrapper,id:o._id+"wrapper",className:o._classNames.root,"aria-owns":S?o._id+"-list":void 0},a.createElement(d.a,Object(l.__assign)({"data-ktp-execute-target":!0,"data-is-interactable":!i,componentRef:o._autofill,id:o._id+"-input",className:o._classNames.input,type:"text",onFocus:o._onFocus,onBlur:o._onBlur,onKeyDown:o._onInputKeyDown,onKeyUp:o._onInputKeyUp,onClick:o._onAutofillClick,onTouchStart:o._onTouchStart,onInputValueChange:o._onInputChange,"aria-expanded":S,"aria-autocomplete":o._getAriaAutoCompleteValue(),role:"combobox",readOnly:i,"aria-labelledby":r&&o._id+"-label","aria-label":s&&!r?s:void 0,"aria-describedby":void 0!==p?Object(h.a)(c,t):c,"aria-activedescendant":o._getAriaActiveDescendantValue(),"aria-required":u,"aria-disabled":i,"aria-controls":S?o._id+"-list":void 0,spellCheck:!1,defaultVisibleValue:o._currentVisibleValue,suggestedDisplayValue:O,updateValueInWillReceiveProps:o._onUpdateValueInAutofillWillReceiveProps,shouldSelectFullInputValueInComponentDidUpdate:o._onShouldSelectFullInputValueInAutofillComponentDidUpdate,title:b,preventValueSelection:!o._hasFocus(),placeholder:y,tabIndex:i?-1:v},C)),a.createElement(K.a,Object(l.__assign)({className:"ms-ComboBox-CaretDown-button",styles:o._getCaretButtonStyles(),role:"presentation","aria-hidden":f,"data-is-focusable":!1,tabIndex:-1,onClick:o._onComboBoxClick,onBlur:o._onBlur,iconProps:g,disabled:i,checked:S},x)))},o._onShouldSelectFullInputValueInAutofillComponentDidUpdate=function(){return o._currentVisibleValue===o.props.hoisted.suggestedDisplayValue},o._getVisibleValue=function(){var e=o.props,t=e.text,n=e.allowFreeform,r=e.autoComplete,i=e.hoisted,s=i.suggestedDisplayValue,l=i.selectedIndices,a=i.currentOptions,d=o.state,c=d.currentPendingValueValidIndex,u=d.currentPendingValue,p=d.isOpen,h=oe(a,c);if((!p||!h)&&t&&null==u)return t;if(o.props.multiSelect){if(o._hasFocus()){var g=-1;return"on"===r&&h&&(g=c),o._getPendingString(u,a,g)}return o._getMultiselectDisplayString(l,a,s)}g=o._getFirstSelectedIndex();return n?("on"===r&&h&&(g=c),o._getPendingString(u,a,g)):h&&"on"===r?(g=c,te(u)):!o.state.isOpen&&u?oe(a,g)?u:te(s):oe(a,g)?ie(a[g]):te(s)},o._onInputChange=function(e){o.props.disabled?o._handleInputWhenDisabled(null):o.props.allowFreeform?o._processInputChangeWithFreeform(e):o._processInputChangeWithoutFreeform(e)},o._onFocus=function(){var e,t;null===(t=null===(e=o._autofill.current)||void 0===e?void 0:e.inputElement)||void 0===t||t.select(),o._hasFocus()||o.setState({focusState:"focusing"})},o._onResolveOptions=function(){if(o.props.onResolveOptions){var e=o.props.onResolveOptions(Object(l.__spreadArrays)(o.props.hoisted.currentOptions));if(Array.isArray(e))o.props.hoisted.setCurrentOptions(e);else if(e&&e.then){var t=o._currentPromise=e;t.then((function(e){t===o._currentPromise&&o.props.hoisted.setCurrentOptions(e)}))}}},o._onBlur=function(e){var t,n,r=e.relatedTarget;if(null===e.relatedTarget&&(r=document.activeElement),r){var i=null===(t=o.props.hoisted.rootRef.current)||void 0===t?void 0:t.contains(r),s=null===(n=o._comboBoxMenu.current)||void 0===n?void 0:n.contains(r),l=o._comboBoxMenu.current&&Object(g.a)(o._comboBoxMenu.current,(function(e){return e===r}));if(i||s||l)return l&&o._hasFocus()&&(!o.props.multiSelect||o.props.allowFreeform)&&o._submitPendingValue(e),e.preventDefault(),void e.stopPropagation()}o._hasFocus()&&(o.setState({focusState:"none"}),o.props.multiSelect&&!o.props.allowFreeform||o._submitPendingValue(e))},o._onRenderContainer=function(e,t){var n=e.onRenderList,r=e.calloutProps,i=e.dropdownWidth,s=e.dropdownMaxWidth,d=e.onRenderUpperContent,c=void 0===d?o._onRenderUpperContent:d,u=e.onRenderLowerContent,p=void 0===u?o._onRenderLowerContent:u,h=e.useComboBoxAsMenuWidth,g=e.persistMenu,f=e.shouldRestoreFocus,b=void 0===f||f,m=o.state.isOpen,v=o._id,C=h&&o._comboBoxWrapper.current?o._comboBoxWrapper.current.clientWidth+2:void 0;return a.createElement(k.a,Object(l.__assign)({isBeakVisible:!1,gapSpace:0,doNotLayer:!1,directionalHint:V.a.bottomLeftEdge,directionalHintFixed:!1},r,{onLayerMounted:o._onLayerMounted,className:Object(_.a)(o._classNames.callout,null==r?void 0:r.className),target:o._comboBoxWrapper.current,onDismiss:o._onDismiss,onMouseDown:o._onCalloutMouseDown,onScroll:o._onScroll,setInitialFocus:!1,calloutWidth:h&&o._comboBoxWrapper.current?C&&C:i,calloutMaxWidth:s||C,hidden:g?!m:void 0,shouldRestoreFocus:b}),c(o.props,o._onRenderUpperContent),a.createElement("div",{className:o._classNames.optionsContainerWrapper,ref:o._comboBoxMenu},null==n?void 0:n(Object(l.__assign)(Object(l.__assign)({},e),{id:v}),o._onRenderList)),p(o.props,o._onRenderLowerContent))},o._onLayerMounted=function(){o._onCalloutLayerMounted(),o._async.setTimeout((function(){o._scrollIntoView()}),0),o.props.calloutProps&&o.props.calloutProps.onLayerMounted&&o.props.calloutProps.onLayerMounted()},o._onRenderLabel=function(e){var t=e.props,n=t.label,r=t.disabled,i=t.required;return n?a.createElement(W.a,{id:o._id+"-label",disabled:r,required:i,className:o._classNames.label},n,e.multiselectAccessibleText&&a.createElement("span",{className:o._classNames.screenReaderText},e.multiselectAccessibleText)):null},o._onRenderList=function(e){var t=e.onRenderItem,n=e.options,r=e.label,i=e.ariaLabel,s=o._id;return a.createElement("div",{id:s+"-list",className:o._classNames.optionsContainer,"aria-labelledby":r&&s+"-label","aria-label":i&&!r?i:void 0,role:"listbox"},n.map((function(e){return null==t?void 0:t(e,o._onRenderItem)})))},o._onRenderItem=function(e){switch(e.itemType){case E.a.Divider:return o._renderSeparator(e);case E.a.Header:return o._renderHeader(e);default:return o._renderOption(e)}},o._onRenderLowerContent=function(){return null},o._onRenderUpperContent=function(){return null},o._renderOption=function(e){var t,n=o.props.onRenderOption,r=void 0===n?o._onRenderOptionContent:n,i=o._id,s=o._isOptionSelected(e.index),d=o._isOptionChecked(e.index),c=o._isOptionIndeterminate(e.index),u=o._getCurrentOptionStyles(e),p=L(o._getCurrentOptionStyles(e)),h=null!==(t=e.title)&&void 0!==t?t:ie(e),g=function(){return r(e,o._onRenderOptionContent)};return a.createElement(G,{key:e.key,index:e.index,disabled:e.disabled,isSelected:s,isChecked:d,isIndeterminate:c,text:e.text,render:function(){return o.props.multiSelect?a.createElement(w.a,{id:i+"-list"+e.index,ariaLabel:e.ariaLabel,key:e.key,styles:u,className:"ms-ComboBox-option",onChange:o._onItemClick(e),label:e.text,checked:d,indeterminate:c,title:h,disabled:e.disabled,onRenderLabel:g,inputProps:Object(l.__assign)({"aria-selected":d?"true":"false",role:"option"},{"data-index":e.index,"data-is-focusable":!0})}):a.createElement(U.a,{id:i+"-list"+e.index,key:e.key,"data-index":e.index,styles:u,checked:s,className:"ms-ComboBox-option",onClick:o._onItemClick(e),onMouseEnter:o._onOptionMouseEnter.bind(o,e.index),onMouseMove:o._onOptionMouseMove.bind(o,e.index),onMouseLeave:o._onOptionMouseLeave,role:"option","aria-selected":s?"true":"false",ariaLabel:e.ariaLabel,disabled:e.disabled,title:h},a.createElement("span",{className:p.optionTextWrapper,ref:s?o._selectedElement:void 0},r(e,o._onRenderOptionContent)))},data:e.data})},o._onCalloutMouseDown=function(e){e.preventDefault()},o._onScroll=function(){o._isScrollIdle||void 0===o._scrollIdleTimeoutId?o._isScrollIdle=!1:(o._async.clearTimeout(o._scrollIdleTimeoutId),o._scrollIdleTimeoutId=void 0),o._scrollIdleTimeoutId=o._async.setTimeout((function(){o._isScrollIdle=!0}),q)},o._onRenderOptionContent=function(e){var t=L(o._getCurrentOptionStyles(e));return a.createElement("span",{className:t.optionText},e.text)},o._onDismiss=function(){var e=o.props.onMenuDismiss;e&&e(),o.props.persistMenu&&o._onCalloutLayerMounted(),o._setOpenStateAndFocusOnClose(!1,!1),o._resetSelectedIndex()},o._onAfterClearPendingInfo=function(){o._processingClearPendingInfo=!1},o._onInputKeyDown=function(e){var t=o.props,n=t.disabled,r=t.allowFreeform,l=t.autoComplete,a=t.hoisted.currentOptions,d=o.state,c=d.isOpen,u=d.currentPendingValueValidIndexOnHover;if(o._lastKeyDownWasAltOrMeta=se(e),n)o._handleInputWhenDisabled(e);else{var p=o._getPendingSelectedIndex(!1);switch(e.which){case f.a.enter:o._autofill.current&&o._autofill.current.inputElement&&o._autofill.current.inputElement.select(),o._submitPendingValue(e),o.props.multiSelect&&c?o.setState({currentPendingValueValidIndex:p}):(c||(!r||void 0===o.state.currentPendingValue||null===o.state.currentPendingValue||o.state.currentPendingValue.length<=0)&&o.state.currentPendingValueValidIndex<0)&&o.setState({isOpen:!c});break;case f.a.tab:return o.props.multiSelect||o._submitPendingValue(e),void(c&&o._setOpenStateAndFocusOnClose(!c,!1));case f.a.escape:if(o._resetSelectedIndex(),!c)return;o.setState({isOpen:!1});break;case f.a.up:if(u===s.clearAll&&(p=o.props.hoisted.currentOptions.length),e.altKey||e.metaKey){if(c){o._setOpenStateAndFocusOnClose(!c,!0);break}return}o._setPendingInfoFromIndexAndDirection(p,i.backward);break;case f.a.down:e.altKey||e.metaKey?o._setOpenStateAndFocusOnClose(!0,!0):(u===s.clearAll&&(p=-1),o._setPendingInfoFromIndexAndDirection(p,i.forward));break;case f.a.home:case f.a.end:if(r)return;p=-1;var h=i.forward;e.which===f.a.end&&(p=a.length,h=i.backward),o._setPendingInfoFromIndexAndDirection(p,h);break;case f.a.space:if(!r&&"off"===l)break;default:if(e.which>=112&&e.which<=123)return;if(e.keyCode===f.a.alt||"Meta"===e.key)return;if(!r&&"on"===l){o._onInputChange(e.key);break}return}e.stopPropagation(),e.preventDefault()}},o._onInputKeyUp=function(e){var t=o.props,n=t.disabled,r=t.allowFreeform,i=t.autoComplete,s=o.state.isOpen,l=o._lastKeyDownWasAltOrMeta&&se(e);o._lastKeyDownWasAltOrMeta=!1;var a=l&&!(Object(b.a)()||Object(m.a)());if(n)o._handleInputWhenDisabled(e);else switch(e.which){case f.a.space:return void(r||"off"!==i||o._setOpenStateAndFocusOnClose(!s,!!s));default:return void(a&&s?o._setOpenStateAndFocusOnClose(!s,!0):("focusing"===o.state.focusState&&o.props.openOnKeyboardFocus&&o.setState({isOpen:!0}),"focused"!==o.state.focusState&&o.setState({focusState:"focused"})))}},o._onOptionMouseLeave=function(){o._shouldIgnoreMouseEvent()||o.props.persistMenu&&!o.state.isOpen||o.setState({currentPendingValueValidIndexOnHover:s.clearAll})},o._onComboBoxClick=function(){var e=o.props.disabled,t=o.state.isOpen;e||(o._setOpenStateAndFocusOnClose(!t,!1),o.setState({focusState:"focused"}))},o._onAutofillClick=function(){var e=o.props,t=e.disabled;e.allowFreeform&&!t?o.focus(o.state.isOpen||o._processingTouch):o._onComboBoxClick()},o._onTouchStart=function(){!o._comboBoxWrapper.current||"onpointerdown"in o._comboBoxWrapper||o._handleTouchAndPointerEvent()},o._onPointerDown=function(e){"touch"===e.pointerType&&(o._handleTouchAndPointerEvent(),e.preventDefault(),e.stopImmediatePropagation())},Object(v.a)(o),o._async=new C.a(o),o._events=new x.a(o),Object(O.a)($,t,{defaultSelectedKey:"selectedKey",text:"defaultSelectedKey",selectedKey:"value",dropdownWidth:"useComboBoxAsMenuWidth",ariaLabel:"label"}),o._id=t.id||Object(S.a)("ComboBox"),o._isScrollIdle=!0,o._processingTouch=!1,o._gotMouseMove=!1,o._processingClearPendingInfo=!1,o.state={isOpen:!1,focusState:"none",currentPendingValueValidIndex:-1,currentPendingValue:void 0,currentPendingValueValidIndexOnHover:s.default},o}return Object(l.__extends)(t,e),Object.defineProperty(t.prototype,"selectedOptions",{get:function(){var e=this.props.hoisted,t=e.currentOptions,o=e.selectedIndices;return Object(N.a)(t,o)},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){this._comboBoxWrapper.current&&!this.props.disabled&&(this._events.on(this._comboBoxWrapper.current,"focus",this._onResolveOptions,!0),"onpointerdown"in this._comboBoxWrapper.current&&this._events.on(this._comboBoxWrapper.current,"pointerdown",this._onPointerDown,!0))},t.prototype.componentDidUpdate=function(e,t){var o=this,n=this.props,r=n.allowFreeform,i=n.text,s=n.onMenuOpen,l=n.onMenuDismissed,a=n.hoisted.selectedIndices,d=this.state,c=d.isOpen,u=d.currentPendingValueValidIndex;!c||t.isOpen&&t.currentPendingValueValidIndex===u||this._async.setTimeout((function(){return o._scrollIntoView()}),0),this._hasFocus()&&(c||t.isOpen&&!c&&this._focusInputAfterClose&&this._autofill.current&&document.activeElement!==this._autofill.current.inputElement)&&this.focus(void 0,!0),this._focusInputAfterClose&&(t.isOpen&&!c||this._hasFocus()&&(!c&&!this.props.multiSelect&&e.hoisted.selectedIndices&&a&&e.hoisted.selectedIndices[0]!==a[0]||!r||i!==e.text))&&this._onFocus(),this._notifyPendingValueChanged(t),c&&!t.isOpen&&s&&s(),!c&&t.isOpen&&l&&l()},t.prototype.componentWillUnmount=function(){this._async.dispose(),this._events.dispose()},t.prototype.render=function(){var e=this._id+"-error",t=this.props,o=t.className,n=t.disabled,r=t.required,i=t.errorMessage,s=t.onRenderContainer,d=void 0===s?this._onRenderContainer:s,c=t.onRenderLabel,u=void 0===c?this._onRenderLabel:c,p=t.onRenderList,h=void 0===p?this._onRenderList:p,g=t.onRenderItem,_=void 0===g?this._onRenderItem:g,f=t.onRenderOption,b=void 0===f?this._onRenderOptionContent:f,m=t.allowFreeform,v=t.styles,C=t.theme,x=t.persistMenu,O=t.multiSelect,S=t.hoisted,I=S.suggestedDisplayValue,P=S.selectedIndices,k=S.currentOptions,V=this.state.isOpen;this._currentVisibleValue=this._getVisibleValue();var w=O?this._getMultiselectDisplayString(P,k,I):void 0,j=Object(y.j)(this.props,y.h,["onChange","value"]),T=!!(i&&i.length>0);this._classNames=this.props.getClassNames?this.props.getClassNames(C,!!V,!!n,!!r,!!this._hasFocus(),!!m,!!T,o):R(M(C,v),o,!!V,!!n,!!r,!!this._hasFocus(),!!m,!!T);var H=this._renderComboBoxWrapper(w,e);return a.createElement("div",Object(l.__assign)({},j,{ref:this.props.hoisted.mergedRootRef,className:this._classNames.container}),u({props:this.props,multiselectAccessibleText:w},this._onRenderLabel),H,(x||V)&&d(Object(l.__assign)(Object(l.__assign)({},this.props),{onRenderList:h,onRenderItem:_,onRenderOption:b,options:k.map((function(e,t){return Object(l.__assign)(Object(l.__assign)({},e),{index:t})})),onDismiss:this._onDismiss}),this._onRenderContainer),a.createElement("div",Object(l.__assign)({role:"region","aria-live":"polite","aria-atomic":"true",id:e},T?{className:this._classNames.errorMessage}:{"aria-hidden":!0}),void 0!==i?i:""))},t.prototype._getPendingString=function(e,t,o){return null!=e?e:oe(t,o)?t[o].text:""},t.prototype._getMultiselectDisplayString=function(e,t,o){for(var n=[],r=0;e&&r<e.length;r++){var i=e[r];t[i].itemType!==E.a.SelectAll&&n.push(oe(t,i)?t[i].text:te(o))}var s=this.props.multiSelectDelimiter,l=void 0===s?", ":s;return n.join(l)},t.prototype._processInputChangeWithFreeform=function(e){var t=this.props.hoisted.currentOptions,o=-1;if(""===e)return 1===(r=t.map((function(e,t){return Object(l.__assign)(Object(l.__assign)({},e),{index:t})})).filter((function(t){return ne(t)&&ie(t)===e}))).length&&(o=r[0].index),void this._setPendingInfo(e,o,e);var n=e;e=e.toLocaleLowerCase();var r,i="";if("on"===this.props.autoComplete){if((r=t.map((function(e,t){return Object(l.__assign)(Object(l.__assign)({},e),{index:t})})).filter((function(t){return ne(t)&&0===ie(t).toLocaleLowerCase().indexOf(e)}))).length>0){var s=ie(r[0]);i=s.toLocaleLowerCase()!==e?s:"",o=r[0].index}}else 1===(r=t.map((function(e,t){return Object(l.__assign)(Object(l.__assign)({},e),{index:t})})).filter((function(t){return ne(t)&&ie(t).toLocaleLowerCase()===e}))).length&&(o=r[0].index);this._setPendingInfo(n,o,i)},t.prototype._processInputChangeWithoutFreeform=function(e){var t=this,o=this.props.hoisted.currentOptions,n=this.state,r=n.currentPendingValue,i=n.currentPendingValueValidIndex;if("on"===this.props.autoComplete&&""!==e){this._autoCompleteTimeout&&(this._async.clearTimeout(this._autoCompleteTimeout),this._autoCompleteTimeout=void 0,e=te(r)+e);var s=e;e=e.toLocaleLowerCase();var a=o.map((function(e,t){return Object(l.__assign)(Object(l.__assign)({},e),{index:t})})).filter((function(t){return ne(t)&&0===t.text.toLocaleLowerCase().indexOf(e)}));return a.length>0&&this._setPendingInfo(s,a[0].index,ie(a[0])),void(this._autoCompleteTimeout=this._async.setTimeout((function(){t._autoCompleteTimeout=void 0}),1e3))}var d=i>=0?i:this._getFirstSelectedIndex();this._setPendingInfoFromIndex(d)},t.prototype._getFirstSelectedIndex=function(){var e=this.props.hoisted.selectedIndices;return(null==e?void 0:e.length)?e[0]:-1},t.prototype._getNextSelectableIndex=function(e,t){var o=this.props.hoisted.currentOptions,n=e+t;if(!oe(o,n=Math.max(0,Math.min(o.length-1,n))))return-1;var r=o[n];if(!re(r)||!0===r.hidden){if(t===i.none||!(n>0&&t<i.none||n>=0&&n<o.length&&t>i.none))return e;n=this._getNextSelectableIndex(n,t)}return n},t.prototype._setSelectedIndex=function(e,t,o){void 0===o&&(o=i.none);var n=this.props,r=n.onChange,s=n.onPendingValueChanged,a=n.hoisted,d=a.selectedIndices,c=a.currentOptions,u=d?d.slice():[],p=c.slice();if(oe(c,e=this._getNextSelectableIndex(e,o))){if(this.props.multiSelect||u.length<1||1===u.length&&u[0]!==e){var h=Object(l.__assign)({},c[e]);if(!h||h.disabled)return;if(this.props.multiSelect)if(h.selected=void 0!==h.selected?!h.selected:u.indexOf(e)<0,h.itemType===E.a.SelectAll)u=[],h.selected?c.forEach((function(e,t){!e.disabled&&re(e)&&(u.push(t),p[t]=Object(l.__assign)(Object(l.__assign)({},e),{selected:!0}))})):p=c.map((function(e){return Object(l.__assign)(Object(l.__assign)({},e),{selected:!1})}));else{h.selected&&u.indexOf(e)<0?u.push(e):!h.selected&&u.indexOf(e)>=0&&(u=u.filter((function(t){return t!==e}))),p[e]=h;var g=p.filter((function(e){return e.itemType===E.a.SelectAll}))[0];if(g){var _=this._isSelectAllChecked(u),f=p.indexOf(g);_?(u.push(f),p[f]=Object(l.__assign)(Object(l.__assign)({},g),{selected:!0})):(u=u.filter((function(e){return e!==f})),p[f]=Object(l.__assign)(Object(l.__assign)({},g),{selected:!1}))}}else u[0]=e;t.persist(),this.props.selectedKey||null===this.props.selectedKey?this._hasPendingValue&&s&&(s(),this._hasPendingValue=!1):(this.props.hoisted.setSelectedIndices(u),this.props.hoisted.setCurrentOptions(p),this._hasPendingValue&&s&&(s(),this._hasPendingValue=!1)),r&&r(t,h,e,void 0)}this.props.multiSelect&&this.state.isOpen||this._clearPendingInfo()}},t.prototype._submitPendingValue=function(e){var t,o=this.props,n=o.onChange,r=o.allowFreeform,i=o.autoComplete,s=o.multiSelect,l=o.hoisted,a=l.currentOptions,d=this.state,c=d.currentPendingValue,u=d.currentPendingValueValidIndex,p=d.currentPendingValueValidIndexOnHover,h=this.props.hoisted.selectedIndices;if(!this._processingClearPendingInfo){if(r){if(null==c)return void(p>=0&&(this._setSelectedIndex(p,e),this._clearPendingInfo()));if(oe(a,u)){var g=ie(a[u]).toLocaleLowerCase(),_=this._autofill.current;if(c.toLocaleLowerCase()===g||i&&0===g.indexOf(c.toLocaleLowerCase())&&(null==_?void 0:_.isValueSelected)&&c.length+(_.selectionEnd-_.selectionStart)===g.length||(null===(t=null==_?void 0:_.inputElement)||void 0===t?void 0:t.value.toLocaleLowerCase())===g){if(this._setSelectedIndex(u,e),s&&this.state.isOpen)return;return void this._clearPendingInfo()}}if(n)n&&n(e,void 0,void 0,c);else{var f={key:c||Object(S.a)(),text:te(c)};s&&(f.selected=!0);var b=a.concat([f]);h&&(s||(h=[]),h.push(b.length-1)),l.setCurrentOptions(b),l.setSelectedIndices(h)}}else u>=0?this._setSelectedIndex(u,e):p>=0&&this._setSelectedIndex(p,e);this._clearPendingInfo()}},t.prototype._onCalloutLayerMounted=function(){this._gotMouseMove=!1},t.prototype._renderSeparator=function(e){var t=e.index,o=e.key;return t&&t>0?a.createElement("div",{role:"separator",key:o,className:this._classNames.divider}):null},t.prototype._renderHeader=function(e){var t=this.props.onRenderOption,o=void 0===t?this._onRenderOptionContent:t;return a.createElement("div",{key:e.key,className:this._classNames.header},o(e,this._onRenderOptionContent))},t.prototype._isOptionHighlighted=function(e){var t=this.state.currentPendingValueValidIndexOnHover;return t!==s.clearAll&&(t>=0?t===e:this._isOptionSelected(e))},t.prototype._isOptionSelected=function(e){return this._getPendingSelectedIndex(!0)===e},t.prototype._isOptionChecked=function(e){if(this.props.multiSelect&&void 0!==e&&this.props.hoisted.selectedIndices){return this.props.hoisted.selectedIndices.indexOf(e)>=0}return!1},t.prototype._isOptionIndeterminate=function(e){var t=this.props,o=t.multiSelect,n=t.hoisted;if(o&&void 0!==e&&n.selectedIndices&&n.currentOptions){var r=n.currentOptions[e];if(r&&r.itemType===E.a.SelectAll)return n.selectedIndices.length>0&&!this._isSelectAllChecked()}return!1},t.prototype._isSelectAllChecked=function(e){var t=this.props,o=t.multiSelect,n=t.hoisted,r=n.currentOptions.find((function(e){return e.itemType===E.a.SelectAll})),i=e||n.selectedIndices;if(!o||!i||!r)return!1;var s=n.currentOptions.indexOf(r),l=i.filter((function(e){return e!==s})),a=n.currentOptions.filter((function(e){return!e.disabled&&e.itemType!==E.a.SelectAll&&re(e)}));return l.length===a.length},t.prototype._getPendingSelectedIndex=function(e){var t=this.state,o=t.currentPendingValueValidIndex,n=t.currentPendingValue;return o>=0||e&&null!=n?o:this.props.multiSelect?0:this._getFirstSelectedIndex()},t.prototype._scrollIntoView=function(){var e=this.props,t=e.onScrollToItem,o=e.scrollSelectedToTop,n=this.state,r=n.currentPendingValueValidIndex,i=n.currentPendingValue;if(t)t(r>=0||""!==i?r:this._getFirstSelectedIndex());else if(this._selectedElement.current&&this._selectedElement.current.offsetParent)if(o)this._selectedElement.current.offsetParent.scrollIntoView(!0);else{var s=!0;if(this._comboBoxMenu.current&&this._comboBoxMenu.current.offsetParent){var l=this._comboBoxMenu.current.offsetParent.getBoundingClientRect(),a=this._selectedElement.current.offsetParent.getBoundingClientRect();if(l.top<=a.top&&l.top+l.height>=a.top+a.height)return;l.top+l.height<=a.top+a.height&&(s=!1)}this._selectedElement.current.offsetParent.scrollIntoView(s)}},t.prototype._onItemClick=function(e){var t=this,o=this.props.onItemClick,n=e.index;return function(r){t.props.multiSelect||(t._autofill.current&&t._autofill.current.focus(),t.setState({isOpen:!1})),o&&o(r,e,n),t._setSelectedIndex(n,r)}},t.prototype._resetSelectedIndex=function(){var e=this.props.hoisted.currentOptions;this._clearPendingInfo();var t=this._getFirstSelectedIndex();t>0&&t<e.length?this.props.hoisted.setSuggestedDisplayValue(e[t].text):this.props.text&&this.props.hoisted.setSuggestedDisplayValue(this.props.text)},t.prototype._clearPendingInfo=function(){this._processingClearPendingInfo=!0,this.props.hoisted.setSuggestedDisplayValue(void 0),this.setState({currentPendingValue:void 0,currentPendingValueValidIndex:-1,currentPendingValueValidIndexOnHover:s.default},this._onAfterClearPendingInfo)},t.prototype._setPendingInfo=function(e,t,o){void 0===t&&(t=-1),this._processingClearPendingInfo||(this.props.hoisted.setSuggestedDisplayValue(o),this.setState({currentPendingValue:te(e),currentPendingValueValidIndex:t,currentPendingValueValidIndexOnHover:s.default}))},t.prototype._setPendingInfoFromIndex=function(e){var t=this.props.hoisted.currentOptions;if(e>=0&&e<t.length){var o=t[e];this._setPendingInfo(ie(o),e,ie(o))}else this._clearPendingInfo()},t.prototype._setPendingInfoFromIndexAndDirection=function(e,t){var o=this.props.hoisted.currentOptions;t===i.forward&&e>=o.length-1?e=-1:t===i.backward&&e<=0&&(e=o.length);var n=this._getNextSelectableIndex(e,t);e===n?t===i.forward?e=this._getNextSelectableIndex(-1,t):t===i.backward&&(e=this._getNextSelectableIndex(o.length,t)):e=n,oe(o,e)&&this._setPendingInfoFromIndex(e)},t.prototype._notifyPendingValueChanged=function(e){var t=this.props.onPendingValueChanged;if(t){var o=this.props.hoisted.currentOptions,n=this.state,r=n.currentPendingValue,i=n.currentPendingValueValidIndex,s=n.currentPendingValueValidIndexOnHover,l=void 0,a=void 0;s!==e.currentPendingValueValidIndexOnHover&&oe(o,s)?l=s:i!==e.currentPendingValueValidIndex&&oe(o,i)?l=i:r!==e.currentPendingValue&&(a=r),(void 0!==l||void 0!==a||this._hasPendingValue)&&(t(void 0!==l?o[l]:void 0,l,a),this._hasPendingValue=void 0!==l||void 0!==a)}},t.prototype._setOpenStateAndFocusOnClose=function(e,t){this._focusInputAfterClose=t,this.setState({isOpen:e})},t.prototype._onOptionMouseEnter=function(e){this._shouldIgnoreMouseEvent()||this.setState({currentPendingValueValidIndexOnHover:e})},t.prototype._onOptionMouseMove=function(e){this._gotMouseMove=!0,this._isScrollIdle&&this.state.currentPendingValueValidIndexOnHover!==e&&this.setState({currentPendingValueValidIndexOnHover:e})},t.prototype._shouldIgnoreMouseEvent=function(){return!this._isScrollIdle||!this._gotMouseMove},t.prototype._handleInputWhenDisabled=function(e){this.props.disabled&&(this.state.isOpen&&this.setState({isOpen:!1}),null!==e&&e.which!==f.a.tab&&e.which!==f.a.escape&&(e.which<112||e.which>123)&&(e.stopPropagation(),e.preventDefault()))},t.prototype._handleTouchAndPointerEvent=function(){var e=this;void 0!==this._lastTouchTimeoutId&&(this._async.clearTimeout(this._lastTouchTimeoutId),this._lastTouchTimeoutId=void 0),this._processingTouch=!0,this._lastTouchTimeoutId=this._async.setTimeout((function(){e._processingTouch=!1,e._lastTouchTimeoutId=void 0}),500)},t.prototype._getCaretButtonStyles=function(){var e=this.props.caretDownButtonStyles;return D(this.props.theme,e)},t.prototype._getCurrentOptionStyles=function(e){var t=this.props.comboBoxOptionStyles,o=e.styles;return A(this.props.theme,t,o,this._isPendingOption(e),e.hidden,this._isOptionHighlighted(e.index))},t.prototype._getAriaActiveDescendantValue=function(){var e=this.props.hoisted.selectedIndices,t=this.state,o=t.isOpen,n=t.currentPendingValueValidIndex,r=o&&(null==e?void 0:e.length)?this._id+"-list"+e[0]:void 0;return o&&this._hasFocus()&&-1!==n&&(r=this._id+"-list"+n),r},t.prototype._getAriaAutoCompleteValue=function(){return!this.props.disabled&&"on"===this.props.autoComplete?this.props.allowFreeform?"inline":"both":"none"},t.prototype._isPendingOption=function(e){return e&&e.index===this.state.currentPendingValueValidIndex},t.prototype._hasFocus=function(){return"none"!==this.state.focusState},t=Object(l.__decorate)([Object(I.a)("ComboBox",["theme","styles"],!0)],t)}(a.Component);function Z(e,t){if(!e||!t)return[];var o={};e.forEach((function(e,t){e.selected&&(o[t]=!0)}));for(var n=function(t){var n=Object(P.e)(e,(function(e){return e.key===t}));n>-1&&(o[n]=!0)},r=0,i=t;r<i.length;r++){n(i[r])}return Object.keys(o).map(Number).sort()}function ee(e){return void 0===e?[]:e instanceof Array?e:[e]}function te(e){return e||""}function oe(e,t){return!!e&&t>=0&&t<e.length}function ne(e){return e.itemType!==E.a.Header&&e.itemType!==E.a.Divider&&e.itemType!==E.a.SelectAll}function re(e){return e.itemType!==E.a.Header&&e.itemType!==E.a.Divider}function ie(e){return e.useAriaLabelAsText&&e.ariaLabel?e.ariaLabel:e.text}function se(e){return e.which===f.a.alt||"Meta"===e.key}}}]);
//# sourceMappingURL=owa.44.js.map
self.scriptsLoaded['owa.44.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.44.js'] = (new Date()).getTime();