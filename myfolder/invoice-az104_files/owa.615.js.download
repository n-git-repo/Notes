self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.615.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[615],{11833:function(e,n,t){"use strict";var a=t(5083),i=t(4499),o=t(2742),r=t(2);const d=Object(r.mutatorAction)("addForkItemToMailStore",(e,n)=>{const t=e.id;if(!o.u.items.has(t)){const a={ItemId:{Id:t},Categories:e.Categories,ConversationId:e.ConversationId,DateTimeReceived:e.DateTimeReceived,DateTimeSent:e.DateTimeSent,DisplayTo:e.DisplayTo,Flag:e.Flag,From:e.From,HasAttachments:e.HasAttachments,IconIndex:e.IconIndex,Importance:e.Importance,InstanceKey:e.InstanceKey,IsDraft:e.IsDraft,IsRead:e.IsRead,IsExternalSender:e.IsExternalSender,ItemClass:e.ItemClass,MentionedMe:e.MentionedMe,ParentFolderId:e.ParentFolderId,Preview:e.Preview,ReceivedOrRenewTime:e.ReceivedOrRenewTime,Size:e.Size,Subject:e.Subject},i=Object.assign(Object.assign({},a),{MailboxInfo:n});o.u.items.set(t,i)}}),c={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetConversationForksById"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"conversationForks"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"forks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"displayNames"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"forkId"}},{kind:"Field",name:{kind:"Name",value:"ancestorIds"}},{kind:"Field",name:{kind:"Name",value:"Categories"}},{kind:"Field",name:{kind:"Name",value:"ConversationId"}},{kind:"Field",name:{kind:"Name",value:"DateTimeReceived"}},{kind:"Field",name:{kind:"Name",value:"DateTimeSent"}},{kind:"Field",name:{kind:"Name",value:"DisplayTo"}},{kind:"Field",name:{kind:"Name",value:"Flag"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"FlagStatus"}},{kind:"Field",name:{kind:"Name",value:"StartDate"}},{kind:"Field",name:{kind:"Name",value:"DueDate"}},{kind:"Field",name:{kind:"Name",value:"CompleteDate"}}]}},{kind:"Field",name:{kind:"Name",value:"From"}},{kind:"Field",name:{kind:"Name",value:"HasAttachments"}},{kind:"Field",name:{kind:"Name",value:"IconIndex"}},{kind:"Field",name:{kind:"Name",value:"Importance"}},{kind:"Field",name:{kind:"Name",value:"InstanceKey"}},{kind:"Field",name:{kind:"Name",value:"IsDraft"}},{kind:"Field",name:{kind:"Name",value:"IsRead"}},{kind:"Field",name:{kind:"Name",value:"IsExternalSender"}},{kind:"Field",name:{kind:"Name",value:"ItemClass"}},{kind:"Field",name:{kind:"Name",value:"MentionedMe"}},{kind:"Field",name:{kind:"Name",value:"ParentFolderId"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"}},{kind:"Field",name:{kind:"Name",value:"ChangeKey"}}]}},{kind:"Field",name:{kind:"Name",value:"Preview"}},{kind:"Field",name:{kind:"Name",value:"ReceivedOrRenewTime"}},{kind:"Field",name:{kind:"Name",value:"Size"}},{kind:"Field",name:{kind:"Name",value:"Subject"}}]}}]}}]}}]};var s=t(595);n.a=async function(e,n,t){let r=[];if(Object(i.a)())try{r=await async function(e,n,t){var a,i;const o=Object(s.a)(),r=await(null==o?void 0:o.query({query:c,variables:{id:e,folderId:n},context:{suppressFallbackAlert:!0}}));if((null===(i=null===(a=null==r?void 0:r.data)||void 0===a?void 0:a.conversationForks)||void 0===i?void 0:i.forks)&&r.data.conversationForks.forks.length>0){let e=[];return r.data.conversationForks.forks.forEach(n=>{e.push(n),d(n,t)}),e}return[]}(e,n,t)}catch(e){r=[]}else r=await async function(e,n){const t=await Object(a.a)(e,n);if(t.length>1){const e=[];return t.forEach(n=>{const t=[];n.forEach(e=>{var n,a;const i=o.u.items.get(e),r=null===(a=null===(n=null==i?void 0:i.From)||void 0===n?void 0:n.Mailbox)||void 0===a?void 0:a.Name;r&&!t.includes(r)&&t.push(r)}),e.push({id:n[0],displayNames:t,forkId:"",ancestorIds:n})}),e}return[]}(e,n);return r}},1199:function(e,n,t){"use strict";t.d(n,"a",(function(){return o})),t.d(n,"b",(function(){return r}));var a=t(13),i=t(0);function o(e){return{get:e}}function r(e,n){return Object(i.useMemo)(()=>Object(a.computed)(e),n).get()}},1219:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var a=t(46),i=t(73);function o(){var e;const n=null===(e=Object(a.b)())||void 0===e?void 0:e.pathname;if(n){const e=n.split("/"+Object(i.a)()+"/")[1];if(e){const n=e.split("/")[0];if(n&&!isNaN(parseInt(n)))return!0}}return!1}},15524:function(e){e.exports=JSON.parse('{"a":"vtc","b":"wtc","c":"xtc","d":"ytc"}')},15525:function(e){e.exports=JSON.parse('{"a":"rtc","b":"stc","c":"ttc","d":"utc"}')},15526:function(e){e.exports=JSON.parse('{"a":"itc","b":"jtc","c":"ktc","d":"ltc"}')},2792:function(e,n,t){"use strict";var a;!function(e){e[e.Auto=0]="Auto",e[e.Init=1]="Init",e[e.LeftNavResizeExpand=2]="LeftNavResizeExpand",e[e.ToggleExpand=3]="ToggleExpand",e[e.ToggleCollapse=4]="ToggleCollapse",e[e.WindowResize=5]="WindowResize",e[e.ToggleFolderPane=6]="ToggleFolderPane",e[e.DateRangeTypeChange=7]="DateRangeTypeChange",e[e.CalendarViewTypeChange=8]="CalendarViewTypeChange",e[e.OwaSuiteHeaderFlexPane=9]="OwaSuiteHeaderFlexPane"}(a||(a={}));var i=a,o=t(2);let r=Object(o.createStore)("OwaLayout",{browserWidthBucket:null,areDisplayAdsEnabled:!1});var d=Object(o.mutatorAction)("setBrowserWidthBucket",e=>{r().browserWidthBucket=e}),c=t(3),s=t(25);function u(e,n,t){let a=Object(c.r)(e);if(n&&(a>1900?a-=305:a>990&&(a-=165)),t&&(a-=320),Object(s.k)("mon-tri-slvWithRightReadingPane")){if(a>=3001)return 3001;if(a>=2801)return 3e3;if(a>=2601)return 2800;if(a>=2401)return 2600;if(a>=2201)return 2400;if(a>=2001)return 2200;if(a>=1801)return 2e3;if(a>=1601)return 1800}return a>=1600?1600:a>=1400?1599:a>=1366?1399:a>=1301?1365:a>=1239?1300:a>=1200?1238:a>=1080?1199:a>=1e3?1079:a>=919?999:a>=900?918:a>=866?899:a>=769?865:a>=692?768:a>=686?691:a>=580?685:a>=555?579:a>=542?554:a>=500?541:a>=419?499:418}const l=Object(o.action)("onAvailableWidthBucketChanged",(e,n)=>({availableWidthBucket:e,source:n}));var b=Object(o.mutatorAction)("setAreDisplayAdsEnabled",e=>{r().areDisplayAdsEnabled=e});function m(){return r().areDisplayAdsEnabled}var f=t(2843);function k(e){window.addEventListener("resize",v),b(e),O(i.Init)}function v(){O(i.WindowResize)}function O(e){const n=u(e!=i.Init,m(),Object(f.a)());r().browserWidthBucket!=n&&(d(n),n<=418?p():j(),l(n,e))}function p(){var e;(null===(e=window.document)||void 0===e?void 0:e.body)&&(document.body.style.overflowX="auto")}function j(){var e;(null===(e=window.document)||void 0===e?void 0:e.body)&&(document.body.style.overflow="hidden")}var N=t(107);function I(){return Object(N.m)()||Object(N.d)()}function y(){const e=r().browserWidthBucket;return e||void 0}Object(o.orchestrator)(f.d,e=>{const n=u(!1,m(),e.isShown);d(n),l(n,i.OwaSuiteHeaderFlexPane)}),t.d(n,"b",(function(){return i})),t.d(n,"g",(function(){return k})),t.d(n,"c",(function(){return p})),t.d(n,"f",(function(){return j})),t.d(n,"e",(function(){return I})),t.d(n,"a",(function(){return 48})),t.d(n,"h",(function(){return l})),t.d(n,"d",(function(){return y}))},2795:function(e,n,t){"use strict";t.d(n,"k",(function(){return c})),t.d(n,"d",(function(){return s})),t.d(n,"b",(function(){return b})),t.d(n,"a",(function(){return m})),t.d(n,"c",(function(){return f})),t.d(n,"e",(function(){return k})),t.d(n,"i",(function(){return v})),t.d(n,"h",(function(){return O})),t.d(n,"f",(function(){return p})),t.d(n,"j",(function(){return j})),t.d(n,"g",(function(){return N}));var a,i=t(3),o=t(6),r=t(52),d=t(25);const c=["ar-sa","da-dk","de-at","de-ch","de-de","el-gr","en-ar","en-at","en-au","en-br","en-ca","en-ch","en-cl","en-co","en-de","en-dk","en-fi","en-gb","en-gr","en-hk","en-ie","en-in","en-mx","en-my","en-nl","en-no","en-nz","en-pe","en-pt","en-sa","en-se","en-sg","en-th","en-tr","en-us","en-za","es-ar","es-cl","es-co","es-ec","es-es","es-mx","es-pe","es-us","es-ve","fi-fi","fr-be","fr-ca","fr-ch","fr-fr","it-it","ja-jp","ko-kr","ms-my","nb-no","nl-be","nl-nl","pt-br","pt-pt","sv-se","th-th","tr-tr","zh-cn","zh-hk","zh-sg","zh-tw"],s=["ar-ir","es-cu","ko-kp","ar-sy","en-su","uk-ua"],u={ae:"ar-ae",ar:"es-ar",at:"de-at",au:"en-au",be:"fr-be",br:"pt-br",ca:"en-ca",ch:"de-ch",cl:"es-cl",cn:"zh-cn",co:"es-co",cr:"es-cr",cu:"es-cu",de:"de-de",dk:"da-dk",do:"es-do",ec:"es-ec",eg:"ar-eg",es:"es-es",fi:"fi-fi",fr:"fr-fr",gb:"en-gb",uk:"en-gb",gr:"el-gr",gt:"es-gt",hk:"zh-hk",id:"id-id",ie:"en-ie",in:"en-in",ir:"ar-ir",it:"it-it",jp:"ja-jp",kp:"ko-kp",kr:"ko-kr",mx:"es-mx",my:"ms-my",nl:"nl-nl",no:"nb-no",nz:"en-nz",pe:"es-pe",ph:"fil-ph",pl:"pl-pl",pt:"pt-pt",ru:"ru-ru",sa:"ar-sa",se:"sv-se",sg:"en-sg",su:"en-su",th:"th-th",tr:"tr-tr",tw:"zh-tw",ua:"uk-ua",us:"en-us",ve:"es-ve",vn:"vi-vn",za:"en-za"};var l;function b(){return Object(r.t)()}function m(){return Object(r.g)().IsConsumerChild}function f(){return Object(r.g)().SessionSettings.IsShadowMailbox}function k(){return void 0!==l?l:l=function(){const e=Object(r.g)(),n=Object(o.e)();if(!e.AdMarket||!/^[a-zA-z\-]*$/.test(e.AdMarket))return n?n.toLowerCase():"en-us";const t=e.AdMarket.toLowerCase();return c.indexOf(t)>-1?t:u[t.split("-")[1]]||t}()}function v(e){return null!=e?e.toUpperCase().split("-"):[]}function O(e){return v(e)[1]||"US"}function p(){return Object(i.v)("ANON")}function j(){return Object(i.v)("MUID")}function N(){return a||(a=Object(d.k)("adsexp-adAstupgrade-037")?"https://acdn.adnxs.com/ast/static/0.37.0/ast.js":"https://acdn.adnxs.com/ast/static/0.36.0/ast.js")}},2827:function(e,n,t){"use strict";var a=t(2858),i=t(2733);function o(){return Object(a.a)(Object(i.I)())}t.d(n,"b",(function(){return a.a})),t.d(n,"d",(function(){return a.c})),t.d(n,"c",(function(){return a.b})),t.d(n,"e",(function(){return a.d})),t.d(n,"a",(function(){return o}))},2858:function(e,n,t){"use strict";var a=t(168),i=t(2737);const o=new Map;var r=t(2878),d=t(2790),c=t(3401);function s(e){return e?u(e.tableQuery):Object(a.d)()}function u(e){const n=Object(d.b)(e),t=null==e?void 0:e.folderId;return null!=n?Object(r.a)(n):l(t)}function l(e){return Object(i.G)(e)?Object(c.a)(e):function(e){if(!e)return Object(a.d)();if(!o.has(e)){let n=Object(i.t)(e,!0);o.set(e,n)}return o.get(e)}(e)}function b(e){return{mailboxInfo:u(e)}}t.d(n,"a",(function(){return s})),t.d(n,"c",(function(){return u})),t.d(n,"b",(function(){return l})),t.d(n,"d",(function(){return b}))},2878:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var a=t(168);const i={};function o(e){const n=e.toLocaleLowerCase();if(!i[n]){const t={type:"GroupMailbox",userIdentity:Object(a.d)().userIdentity,mailboxSmtpAddress:e};i[n]=t}return i[n]}},2948:function(e,n,t){"use strict";var a=t(3190),i=t(3809),o=t(4264),r=t(20),d=t(3966),c=t(3117),s=t(596);function u(e,n){return Object(s.b)(e,n,!1,{hideCancelButton:!0})}var l=t(3480),b=t(3288),m=t(2929),f=t(1423),k=t(3360),v=t(30),O=t(1084),p=t(2737),j=t(220);function N(e,n){var t;if(n==Object(O.a)("msgfolderroot"))return!(null===(t=Object(v.a)().UserOptions)||void 0===t?void 0:t.IsMailRootFolderTreeCollapsed);{const t=e[n];return!t||t.IsExpanded}}async function I(e){var n;await Object(p.v)(void 0,void 0,e),Object(j.a)()||((null===(n=Object(v.a)().SessionSettings)||void 0===n?void 0:n.HasArchive)&&Object(p.z)(),Object(p.B)()),function(){const e=Object(l.c)();Object.keys(e).forEach(n=>{const{sortColumn:t,sortDirection:a}=Object(b.a)(n),i={isExpanded:N(e,n),sortColumn:t,sortOrder:a,drag:Object(m.a)(),drop:Object(f.a)()};Object(k.a)(n,i)})}()}var y=t(3494),S=t(3575),R=t(3345),h=t(2),w=t(4172),g=(Object(h.orchestrator)(w.a,e=>{I()}),t(4028));Object(h.orchestrator)(a.b,()=>{Object(g.a)(y.a)});t.d(n,"d",(function(){return F})),t.d(n,"i",(function(){return u})),t.d(n,"g",(function(){return a.b})),t.d(n,"f",(function(){return a.a})),t.d(n,"e",(function(){return I})),t.d(n,"a",(function(){return y.a})),t.d(n,"b",(function(){return R.a})),t.d(n,"c",(function(){return R.b})),t.d(n,"h",(function(){return i.a}));const T=new r.c(()=>t.e(993).then(t.bind(null,19866)));Object(r.f)(o.a,T,e=>e.onNewFolderSuccessOrchestrator),Object(r.f)(a.a,T,e=>e.onFilesFolderShownOrchestrator),Object(r.f)(S.a,T,e=>e.onNewFolderRowNotificationOrchestrator),Object(r.f)(c.a,T,e=>e.markAllAsReadOrchestrator),Object(r.f)(d.a,T,e=>e.emptyFolderStoreUpdateOrchestrator),Object(r.f)(i.a,T,e=>e.setFolderSortByOrchestrator);let F=new r.a(T,e=>e.dismissMailFolderTextField)},2980:function(e,n,t){"use strict";var a=t(13),i=t(2);let o={folderTable:new a.ObservableMap,rootFolder:null},r=Object(i.createStore)("publicFolderFavoriteStore",o)();n.a=r},3020:function(e,n,t){"use strict";var a={};t.r(a),t.d(a,"add",(function(){return c})),t.d(a,"remove",(function(){return s})),t.d(a,"removeAll",(function(){return u})),t.d(a,"getCount",(function(){return l})),t.d(a,"getTombstonedReasons",(function(){return b})),t.d(a,"clearMapForFolder",(function(){return m})),t.d(a,"removeRowsFromTombstone",(function(){return f}));var i=t(2);let o=Object(i.createStore)("tombstone",{folderTombstoneMap:{}});o();var r=t(68),d=t(358);let c=Object(d.action)("tombstoneOperations.add")((function(e,n,t){if(1==n.tableQuery.type||"spotlight"===n.tableQuery.scenarioType)return;const a=n.serverFolderId,i=o().folderTombstoneMap;a in i||(i[a]={});const r=i[a];e.forEach(e=>{let n=r[e];n?3!=t?n.indexOf(3)>-1||-1==n.indexOf(t)&&n.push(t):r[e]=[3]:r[e]=[t]})})),s=Object(d.action)("tombstoneOperations.remove")((function(e,n,t){const a=o().folderTombstoneMap;if(!(n in a))return;const i=a[n],r=i[e],d=r?r.indexOf(t):-1;if(-1==d)throw new Error("tombstone.remove given reason does not exist when trying to remove entry from it");r.splice(d,1),0==r.length&&delete i[e],0==Object.keys(i).length&&delete a[n]})),u=Object(d.action)("tombstoneOperations.removeAll")((function(){o().folderTombstoneMap={},Object(r.q)("TnS_RemoveAllFromTombstone")})),l=function(e,n){const t=o().folderTombstoneMap;if(!(e in t))return 0;let a=0;const i=t[e];return Object.values(i).forEach(e=>{e==n&&a++}),a},b=function(e,n){const t=o().folderTombstoneMap;if(n in t){const a=t[n][e];if(a)return a}return[]},m=Object(d.action)("tombstoneOperations.clearMapForFolder")((function(e){const n=o().folderTombstoneMap;n[e]&&(Object(r.q)("TnS_ClearFolderMapInTombstone",[Object.keys(n[e]).length]),delete n[e])})),f=Object(d.action)("tombstoneOperations.removeRowsFromTombstone")((function(e,n){const t=o().folderTombstoneMap;if(!(n in t))return;const a=t[n];for(const n of e)n in a&&delete a[n];0==Object.keys(a).length&&delete t[n]}));n.a=a},3027:function(e,n,t){"use strict";var a=t(2);const i=Object(a.createStore)("undo",{hasUndoableAction:!1,undoableActionFolderId:null});var o=i(),r=t(3020),d=t(68),c=t(595);const s={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DismissUndo"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dismissUndo"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"undoRequestId"},value:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"}}]}}]}}]};var u=t(3962),l=t(3572);let b,m;t.d(n,"a",(function(){return k})),t.d(n,"b",(function(){return v})),t.d(n,"c",(function(){return O})),t.d(n,"d",(function(){return j})),t.d(n,"e",(function(){return N}));const f=Object(a.mutatorAction)("setUndoableAction",(e,n)=>{const t=i();t.hasUndoableAction=e,t.undoableActionFolderId=n});function k(e,n,t){null!==e&&(b=e,m=t||null,f(!0,n))}async function v(){await O(),b=null,f(!1,null)}async function O(){if(m){try{const e=await m;if(e.success){const n=e.undoRequestId;if(n){let e={undoRequestId:n};await p.invokeDismissUndoMutation(e)}}}catch(e){}m=null}}const p={invokeDismissUndoMutation:async function(e){const n=Object(c.a)();n&&await n.mutate({variables:e,mutation:s})}};function j(){return i().hasUndoableAction}function N(e){const n=new d.b("TnS_Undo");n.addCustomData([e]),o.undoableActionFolderId?r.a.clearMapForFolder(o.undoableActionFolderId):r.a.removeAll();return null!==b&&(b().then(()=>{Object(u.a)()||Object(l.a)()}),v()),n.end(),Promise.resolve()}},3066:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var a=t(25),i=t(625);function o(e){return Object(a.k)("tri-officeRail")&&(e===i.a.Mail||e===i.a.Calendar||e===i.a.AppHost||e===i.a.People||e===i.a.FilesHub)}},3101:function(e,n,t){"use strict";var a=t(20),i=t(3027),o=t(2733),r=t(2742),d=t(1084),c=t(2737);function s(e,n){return!(!e||Object(o.y)()||!n||"UserMailbox"!==n.type||Object(r.m)(e)||e==Object(d.a)("recoverableitemsdeletions")||Object(c.C)(e,"SharedMailbox"))}t.d(n,"f",(function(){return l})),t.d(n,"a",(function(){return i.a})),t.d(n,"b",(function(){return i.b})),t.d(n,"e",(function(){return i.d})),t.d(n,"c",(function(){return i.c})),t.d(n,"d",(function(){return s}));const u=new a.c(()=>t.e(2188).then(t.bind(null,19509)));let l=new a.a(u,e=>e.undo)},3118:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var a=t(2);const i=Object(a.action)("setShowFolderPane",(function(e){return{showFolderPane:e}}))},3119:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var a=t(168);function i(e){return{type:"PublicMailbox",userIdentity:Object(a.d)().userIdentity,mailboxSmtpAddress:e}}},3125:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var a=t(25),i=t(52);function o(){return Object(a.k)("mail-oneView")&&Object(i.q)()}},3150:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var a=t(3125),i=t(3151),o=t(3066);function r(e){return Object(i.a)()||Object(a.a)()||Object(o.a)(e)}},3151:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var a=t(25),i=t(2795),o=t(1219);function r(){return Object(a.k)("auth-cloudCache")&&(Object(i.b)()||Object(i.c)())&&Object(o.a)()}},3174:function(e,n,t){"use strict";t.d(n,"b",(function(){return a})),t.d(n,"a",(function(){return i}));const a=350,i=270},3176:function(e,n,t){"use strict";t.d(n,"a",(function(){return l}));var a=t(3360),i=t(3236),o=t(2929),r=t(1423),d=t(2733),c=t(3345),s=t(154),u=t(25);function l(e){const n=d.c.getDefaultSortBy();i.a.folderNodeViewStates.has(e)||Object(a.a)(e,{isExpanded:!1,sortColumn:n.sortColumn,sortOrder:n.sortDirection,drag:Object(o.a)(),drop:Object(r.a)()});const t=i.a.folderNodeViewStates.get(e);return Object(s.a)("native")&&Object(u.k)("mon-conv-useHx")&&0===Object(c.a)(e)?Object.assign(Object.assign({},t),{sortColumn:n.sortColumn,sortOrder:n.sortDirection}):t}},3189:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var a=t(2792),i=t(2788);function o(){const e=Object(a.d)();return Object(i.b)()?e<=541:e<=918}},3190:function(e,n,t){"use strict";t.d(n,"a",(function(){return i})),t.d(n,"b",(function(){return o}));var a=t(2);const i=Object(a.action)("ON_FILES_FOLDER_SHOWN",e=>({isExpanded:e})),o=Object(a.action)("FILES_TREE_ROOT_NODE_CLICKED",e=>({isExpanded:e}))},3236:function(e,n,t){"use strict";var a=t(2),i=t(13),o=t(2737),r=t(3344),d=t(3575),c=t(2782);Object(a.mutator)(r.a,e=>{s(e.unreadCount,e.totalCount,e.folderId,e.isDeltaChange)});Object(a.mutator)(d.b,e=>{s(e.unreadCount,e.totalCount,e.folderId,!1)});function s(e,n,t,a){const i=o.d.folderTable.get(t);i&&(a?(i.UnreadCount+=e,i.TotalCount+=n):(i.UnreadCount=e,i.TotalCount=n),i.pausedTotalCount&&Object(c.b)()===t&&(i.pausedTotalCount=i.TotalCount),i.UnreadCount=Math.max(i.UnreadCount,0),i.TotalCount=Math.max(i.TotalCount,0))}t.d(n,"b",(function(){return l}));const u={folderNodeViewStates:new i.ObservableMap({}),contextMenuState:null,folderTextFieldViewState:null,isDraggedOver:!1,withContextMenuFolderId:null},l=Object(a.createStore)("folderViewState",u),b=l();n.a=b},3262:function(e,n,t){"use strict";var a=t(2);n.a=Object(a.action)("TRY_REMOVE_FROM_MAIL_STORE_ITEMS",(e,n)=>({itemIdToRemove:e,removeItemSource:n}))},3277:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var a=t(2781);function i(){return Object(a.a)().showFolderPane}},3286:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var a=t(2);const i=Object(a.action)("setShowReadingPane",(function(e){return{showReadingPane:e}}))},3288:function(e,n,t){"use strict";t.d(n,"a",(function(){return d}));var a=t(3480),i=t(2733),o=t(4259),r=t(68);function d(e){const n=Object(a.c)()[e];if(n){const t=Object(o.getSupportedSortColumns)(e),{SortColumn:a,SortOrder:d}=n;if(t.includes(a)){let e=d;return(!d||d!=i.c.DESCENDING_SORT_DIR&&d!=i.c.ASCENDING_SORT_DIR)&&(e=i.c.getDefaultSortDirectionForSortColumn(a),Object(r.p)("getSortByFolderId_invalidSortOrder",{sortColumn:a,sortOrder:d})),{sortColumn:a,sortDirection:e}}}return i.c.getDefaultSortBy()}},3313:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var a=t(2);let i=Object(a.action)("USERMAIL_INTERACTION",(e,n,t)=>({interactionType:e,instrumentationContexts:n,triageContext:t}))},3323:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var a=t(2);const i=Object(a.action)("setShowListPane",(function(e){return{showListPane:e}}))},3344:function(e,n,t){"use strict";var a=t(2);n.a=Object(a.action)("UPDATE_FOLDER_COUNTS",(e,n,t,a)=>({unreadCount:e,totalCount:n,folderId:t,isDeltaChange:a}))},3345:function(e,n,t){"use strict";t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return d}));var a=t(30),i=t(2737);const o=["drafts","junkemail","recoverableitemsdeletions"];function r(e){let n;return e&&(n=Object(i.m)().get(e)),d(n)}function d(e){var n,t;return e&&(e.DistinguishedFolderId&&-1!=o.indexOf(e.DistinguishedFolderId)||"ArchiveMailbox"===e.mailboxInfo.type||"SharedMailbox"===e.mailboxInfo.type)||Object(i.G)(null==e?void 0:e.FolderId.Id)?1:(null===(t=null===(n=Object(a.a)())||void 0===n?void 0:n.UserOptions)||void 0===t?void 0:t.GlobalListViewTypeReact)||0}},3360:function(e,n,t){"use strict";var a=t(3236),i=t(2);n.a=Object(i.mutatorAction)("setFolderViewState",(function(e,n){a.a.folderNodeViewStates.set(e,n)}))},3401:function(e,n,t){"use strict";var a=t(2733),i=t(2737);function o(){const e=Object(a.I)();return e&&0==e.tableQuery.type&&Object(i.G)(e.tableQuery.folderId)}function r(){const e=Object(a.I)();return e&&0==e.tableQuery.type&&Object(i.G)(e.tableQuery.folderId)?e.tableQuery.folderId:null}var d=t(2),c=t(2980),s=t(3119),u=t(13);var l=Object(d.createStore)("publicFolderUtilsStore",new u.ObservableMap),b=t(52);function m(e){if(!l().has(e)){const n=c.a.folderTable.get(e),t=null!=n.replicaList?n.replicaList[0]:Object(b.g)().SessionSettings.DefaultPublicFolderMailbox,a=Object(s.a)(t);f(e,a)}return l().get(e)}const f=Object(d.mutatorAction)("addPublicFolderMailboxInfoToStore",(e,n)=>{l().set(e,n)});t.d(n,"b",(function(){return r})),t.d(n,"c",(function(){return o})),t.d(n,"a",(function(){return m}))},3447:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var a=t(2);const i=Object(a.action)("onClientReadingPanePositionChange")},3475:function(e,n,t){"use strict";t.d(n,"b",(function(){return r})),t.d(n,"c",(function(){return d})),t.d(n,"a",(function(){return c}));var a=t(20),i=t(3313);t.d(n,"d",(function(){return i.a}));const o=new a.c(()=>t.e(1278).then(t.bind(null,5424)));let r=new a.a(o,e=>e.onKeyboardUpDown),d=new a.a(o,e=>e.onOpenEmail),c=new a.a(o,e=>e.onKeyboardToggleSelect)},3480:function(e,n,t){"use strict";var a=t(3176),i=t(30),o=t(52),r=t(2751),d=t(3448);function c(e){return"inbox"!=Object(r.a)(e)||Object(d.a)(e)?O.SearchRefinerScopeCurrentFolder:O.SearchRefinerScopeAll}var s=t(2733),u=t(3174),l=t(2737),b=t(2742);function m(e){const n=Object(r.a)(e);return Object(d.a)(e)||Object(l.G)(e)?p.DateViewOnly:"drafts"==n||"junkemail"==n||"outbox"==n||"notes"==n?p.DateViewOnly:"deleteditems"==n||Object(b.k)(e)?p.DateView:p.ConversationView}var f=t(1448),k=t(68);const v=Object(f.a)(e=>{Object(k.p)("UpdateFolderViewState",{},{isCore:!0}),o.u.importAndExecute([{key:"FolderViewState",valuetype:"StringArray",value:e}],"OWA.ViewStateConfiguration")},3e4,{leading:!1,trailing:!0});var O,p,j=t(361);function N(e){return JSON.parse(e,(function(e,n){return"SortOrder"!==e||1!==n&&0!==n?n:1===n?s.c.DESCENDING_SORT_DIR:s.c.ASCENDING_SORT_DIR}))}function I(){var e;const n=(null===(e=Object(i.a)().ViewStateConfiguration)||void 0===e?void 0:e.FolderViewState)||[],t={};for(let e=0;e<n.length;e++){const a=N(n[e]);t[a.FolderId.Id]=a}return t}function y(e){return JSON.stringify(e,(function(e,n){return"SortOrder"!==e||n!==s.c.DESCENDING_SORT_DIR&&n!==s.c.ASCENDING_SORT_DIR?n:n===s.c.DESCENDING_SORT_DIR?1:0}))}function S(e){let n=!1;Object(j.a)(t=>{var o;const r=(null===(o=t.ViewStateConfiguration)||void 0===o?void 0:o.FolderViewState)||[],d=Object(a.a)(e);let s=null,b=-1;for(let n=0;n<r.length;n++){const t=N(r[n]);if(t.FolderId.Id===e){s=t,b=n;break}}const f=function(e,n,t){var a;const o=t?t.sortOrder:"Ascending",r=t?t.sortColumn:1,d=!!t&&t.isExpanded;if(n)return Object.assign(Object.assign({},n),{SortOrder:o,SortColumn:r,IsExpanded:d});const s=l.d.folderTable.get(e);return s?{FolderId:s.FolderId,View:m(s.FolderId.Id),Width:u.b,SortOrder:o,SortColumn:r,IsExpanded:d,ReadingPanePosition:null===(a=Object(i.a)().UserOptions)||void 0===a?void 0:a.GlobalReadingPanePositionReact,SearchScope:c(s.FolderId.Id)}:null}(e,s,d);f&&(-1!==b?(n=s!==f,n&&(r[b]=y(f))):(n=!0,r.push(y(f))))}),n&&function(){var e,n;const t=null===(e=Object(i.a)().ViewStateConfiguration)||void 0===e?void 0:e.FolderViewState;if(t){const e=[],a=s.c.getDefaultSortBy();for(let o=0;o<t.length;o++){const r=N(t[o]),d=Object(l.m)().get(r.FolderId.Id);(!(!d||d.childFolderCount>0)||!r.IsExpanded)&&r.SearchScope===c(r.FolderId.Id)&&r.SortColumn===a.sortColumn&&r.SortOrder===a.sortDirection&&r.Width===u.b&&r.ReadingPanePosition===(null===(n=Object(i.a)().UserOptions)||void 0===n?void 0:n.GlobalReadingPanePositionReact)&&r.View===m(r.FolderId.Id)||e.push(t[o])}v(e)}}()}t.d(n,"b",(function(){return O})),t.d(n,"a",(function(){return p})),t.d(n,"d",(function(){return N})),t.d(n,"c",(function(){return I})),t.d(n,"e",(function(){return S})),function(e){e[e.SearchRefinerScopeAll=0]="SearchRefinerScopeAll",e[e.SearchRefinerScopePrimaryMailbox=1]="SearchRefinerScopePrimaryMailbox",e[e.SearchRefinerScopeCurrentFolder=2]="SearchRefinerScopeCurrentFolder",e[e.SearchRefinerScopeCurrentFolderAndSubfolders=3]="SearchRefinerScopeCurrentFolderAndSubfolders"}(O||(O={})),function(e){e[e.ConversationView=1]="ConversationView",e[e.DateView=2]="DateView",e[e.DateViewOnly=3]="DateViewOnly",e[e.ItemGroupView=4]="ItemGroupView",e[e.BundledView=5]="BundledView"}(p||(p={}))},3494:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));const a="filesFolderId"},3572:function(e,n,t){"use strict";var a=t(2);n.a=Object(a.action)("RESTORE_ROW_FAIL")},3575:function(e,n,t){"use strict";t.d(n,"a",(function(){return i})),t.d(n,"b",(function(){return o}));var a=t(2);const i=Object(a.action)("onNewFolderNotification",(e,n,t,a=0,i=0,o)=>({folderId:e,parentFolderId:n,displayName:t,unreadCount:a,totalCount:i,mailboxInfo:o})),o=Object(a.action)("onUpdateFolderNotification",(e,n,t,a,i)=>({unreadCount:e,totalCount:n,folderId:t,displayName:a,parentFolderId:i}))},3809:function(e,n,t){"use strict";var a=t(2);const i=Object(a.action)("setFolderSortBy",(e,n,t)=>({folderId:e,sortColumn:n,sortDirection:t}));n.a=i},3962:function(e,n,t){"use strict";let a;function i(){a=!0}function o(){return a}t.d(n,"b",(function(){return i})),t.d(n,"a",(function(){return o}))},3966:function(e,n,t){"use strict";var a=t(2);n.a=Object(a.action)("EMPTY_FOLDER_STORE_UPDATE",(e,n,t,a,i,o)=>({folderId:e,clientLastSyncTime:n,deletedItemsFolderId:t,disposalType:a,deleteSubFolders:i,rowKeysToExclude:o}))},4022:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var a=t(2740),i=t(3569);function o(e,n){return n?a.a.items.get(e):Object(i.b)(e)}},4028:function(e,n,t){"use strict";var a=t(358),i=t(3480),o=t(3176),r=t(3360);n.a=Object(a.action)("toggleFolderNodeExpansion")((function(e,n){const t=Object(o.a)(e);t&&(t.isExpanded=!t.isExpanded,Object(r.a)(e,t)),n||Object(i.e)(e)}))},4109:function(e){e.exports=JSON.parse('{"a":"LGa","c":"MGa","e":"NGa","b":"OGa","d":"PGa"}')},4172:function(e,n,t){"use strict";var a=t(2);n.a=Object(a.action)("SELECT_CATEGORIES_OPTIONS")},4264:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var a=t(2);const i=Object(a.action)("onNewFolderSuccess",(e,n,t,a)=>({folderId:e,parentFolderId:n,displayName:t,mailboxInfo:a}))},4353:function(e,n,t){"use strict";var a=t(2);n.a=Object(a.action)("RELOAD_TABLE_ON_TRIAGE_ACTION_FAIL",e=>({tableView:e}))},4515:function(e,n,t){"use strict";var a=t(3020);function i(e,n,t){t&&a.a.removeRowsFromTombstone(e,n)}var o=t(4353);function r(e){e&&Object(o.a)(e)}var d=t(2805),c=t(68);function s(e,n,t,a,o,s){const u=Object(c.r)();return e.then(e=>(u&&u.addCheckpoint("PAPCARM"),i(n,t,o),s?void 0:Object(d.a)(e))).catch(e=>(i(n,t,o),r(a),Promise.reject(e)))}function u(e,n,t,a,o){return e.then(e=>{if(i(n,t,o),e.ResponseMessages){const n=function(e,n){for(const t of e)if(t&&"Success"!=t.ResponseClass){r(n);const e=new Error(`ResponseCode=${t.ResponseCode}, Stacktrace=${t.StackTrace}`);return e.fetchErrorType="ServerFailure",e}return null}(e.ResponseMessages.Items,a);return n?Promise.reject(n):Promise.resolve()}return Promise.reject(new Error("processCopyItemActionResponseMessage empty response"))}).catch(e=>(i(n,t,o),r(a),Promise.reject(e)))}function l(e,n,t,a,o){let d=!1;return e.then(e=>(i(n,t,o),e.success&&e.movedItemIdsResults.forEach((function(e){if(e.successForMovedItems)return d=!1,Promise.resolve();{r(a);const e=new Error("Error happened in moving items");return e.fetchErrorType="ServerFailure",d=!0,Promise.reject(e)}})),d?Promise.reject(new Error("processMoveItemActionResponseMessage empty response")):Promise.resolve())).catch(e=>(i(n,t,o),r(a),Promise.reject(e)))}t.d(n,"c",(function(){return s})),t.d(n,"e",(function(){return u})),t.d(n,"a",(function(){return i})),t.d(n,"b",(function(){return r})),t.d(n,"d",(function(){return l}))},4842:function(e){e.exports=JSON.parse('{"a":"ztc"}')},5056:function(e,n,t){"use strict";t.d(n,"a",(function(){return o})),t.d(n,"b",(function(){return r})),t.d(n,"c",(function(){return d}));var a=t(20);const i=new a.c(()=>t.e(1359).then(t.bind(null,9701)));let o=new a.b(i,e=>e.addMarkAsReadDiagnostics),r=new a.b(i,e=>e.addUnreadCountNotificationDiagnostics),d=new a.b(i,e=>e.addUnreadCountSubscriptionDiagnostics)},5270:function(e,n,t){"use strict";t.r(n);var a=t(2733),i={markConversationAsRead:{name:(e,n,t,a,i,o,r)=>{let d="TnS_MarkConversation";return d+=t?"Read":"Unread",a||(d+="Background"),d},options:(e,n,t,a,i,o,r)=>a?{isCore:!0}:{sessionSampleRate:10},customData:(e,n,t,i,o,r,d)=>[o,e.length,Object(a.n)(n),Object(a.Q)(n)],cosmosOnlyData:(e,n,t,i,o,r,d)=>{const c=[],s=Object(a.F)(e,n);for(const e of s)c.push(a.b.getItemIds(e,n));return JSON.stringify({itemIds:c,conversationIds:e})}},markItemReadUnread:{name:(e,n,t,a,i,o)=>{let r="TnS_MarkItem";return r+=t?"Read":"Unread",a||(r+="Background"),r},options:(e,n,t,a,i,o)=>a?{isCore:!0}:{},customData:(e,n,t,i,o,r)=>{const d=e?e.tableQuery.type:null,c=e?Object(a.n)(e):null,s=e?Object(a.Q)(e):null;return[d,n.length,c,s]},cosmosOnlyData:(e,n,t,a,i,o)=>JSON.stringify({itemIds:n}),actionSource:(e,n,t,a,i)=>i}},o=t(358),r=t(2);var d=Object(r.createStore)("markread",{markAsReadTimerTask:null,suppressedItemIdsMap:{}})();let c=Object(o.action)("AddMarkReadSuppressedItemIds")((function(e,n={store:d}){e.forEach(e=>n.store.suppressedItemIdsMap[e]=!0)})),s=Object(o.action)("RemoveMarkReadSuppressedItemIds")((function(e,n={store:d}){e.forEach(e=>delete n.store.suppressedItemIdsMap[e])})),u=Object(o.action)("ClearMarkReadSuppressedMap")((function(e={store:d}){e.store.suppressedItemIdsMap={}}));function l(e){for(let n=0;n<e.length;n++)if(!d.suppressedItemIdsMap[e[n]])return!1;return!0}var b=t(5056),m=t(3475),f=t(3285),k=t(6962),v=t(2827),O=t(22),p=t(68),j=t(4515);var N=t(2740);var I=t(3275),y=t(6490),S=t(595);const R={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"MarkItemAsRead"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ids"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isRead"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"suppressReadReceipts"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isUserInitiated"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"markItemAsRead"},arguments:[{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"ids"},value:{kind:"Variable",name:{kind:"Name",value:"ids"}}},{kind:"ObjectField",name:{kind:"Name",value:"isRead"},value:{kind:"Variable",name:{kind:"Name",value:"isRead"}}},{kind:"ObjectField",name:{kind:"Name",value:"suppressReadReceipts"},value:{kind:"Variable",name:{kind:"Name",value:"suppressReadReceipts"}}},{kind:"ObjectField",name:{kind:"Name",value:"isUserInitiated"},value:{kind:"Variable",name:{kind:"Name",value:"isUserInitiated"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"}}]}}]}}]};var h=t(30),w=Object(p.s)(i.markItemReadUnread,(async function(e,n,t,i,o,r){const d=function(e,n){const t=[];return e.forEach(e=>{const i=N.a.items.get(e);Object(a.X)(i)&&i&&i.IsRead!=n&&t.push(e)}),t}(n,t);if(0==d.length)return Promise.resolve();t?s(d):i?c(d):O.h.warn("Invalid scenario to implicitly mark item as unread.");const u=e?e.id:null;Object(I.a)(d,t,i,u),b.a.import().then(n=>{n(e?e.tableQuery:null,!1,t,o,d)});const l={itemIds:d};t?i?Object(m.d)("MarkAsRead",r,l):Object(m.d)("MarkAsReadImplicit",r,l):Object(m.d)("MarkAsUnread",r,l);const{mailboxInfo:f}=Object(v.e)(e.tableQuery),k=e?Object(a.F)(d,e):[];return g(e,k,d,t,i,f)}));async function g(e,n,t,i,o,r){var d;const c=(await y.c.import())(t,null===(d=a.Z.expandedConversationViewState)||void 0===d?void 0:d.forks),s="AlwaysSend"!=Object(h.a)().UserOptions.ReadReceipt;try{return void await T.invokeMarkItemAsReadMutation(c,i,s,o,r)}catch(t){const a=e?e.serverFolderId:null;return Object(j.a)(n,a,!0),Promise.reject(t)}}const T={invokeMarkItemAsReadMutation:async function(e,n,t,a,i){var o;const r=Object(S.a)(),d=await r.mutate({variables:{ids:e,isRead:n,suppressReadReceipts:t,isUserInitiated:a,mailboxInfo:i},mutation:R});return null===(o=null==d?void 0:d.data)||void 0===o?void 0:o.markItemAsRead}},F={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"MarkConversationAsRead"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversations"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationSnapshot"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isRead"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isUserInitiated"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"markConversationAsRead"},arguments:[{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"isRead"},value:{kind:"Variable",name:{kind:"Name",value:"isRead"}}},{kind:"ObjectField",name:{kind:"Name",value:"isUserInitiated"},value:{kind:"Variable",name:{kind:"Name",value:"isUserInitiated"}}},{kind:"ObjectField",name:{kind:"Name",value:"actionOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"conversations"},value:{kind:"Variable",name:{kind:"Name",value:"conversations"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"}}]}}]}}]};var A=t(6286),V=Object(p.s)(i.markConversationAsRead,(function(e,n,t,i,o,r,d){const s=function(e,n,t){const i=[];return e.forEach(e=>{const o=Object(a.M)(e,n);if(o){const n=0==o.unreadCount,a=o.itemIds.length,r=o.unreadCount==a;n&&t||r&&!t||i.push(e)}}),i}(d,n.id,t);if(0==s.length)return Promise.resolve();if(1==e.length&&1==n.selectedRowKeys.size){const e=a.b.getRowIdString(s[0],n),o=Object(a.M)([...n.selectedRowKeys.keys()][0],n.id);if(e==o.id){const e=o.itemIds;t?u():i?c(e):O.h.warn("Invalid scenario to implicitly mark conversation as unread.")}}Object(f.a)(e,n.id,t,i),b.a.import().then(a=>{a(n.tableQuery,!1,t,o,e)});const l={conversationIds:e};t?i?Object(m.d)("MarkAsRead",r,l):Object(m.d)("MarkAsReadImplicit",r,l):Object(m.d)("MarkAsUnread",r,l);const{mailboxInfo:p}=Object(v.e)(n.tableQuery);return Object(a.f)(n)?function(e,n,t,i,o){const r=[];return n.forEach(n=>{r.push(...a.b.getItemIds(n,e))}),g(e,n,r,t,i,o)}(n,s,t,i,p):function(e,n,t,i,o){const r=Object(k.a)(e),d=n.map(n=>Object(a.j)(n,e.id)),c=C.invokeMarkConversationAsReadMutation(d,t,i,r,o),s=Object(a.cb)(e,t,i);return Object(j.c)(c,n,r,e,s,!0)}(n,s,t,i,p)}));const C={invokeMarkConversationAsReadMutation:async function(e,n,t,a,i){var o;const r=e.map(e=>({id:e.conversationId,messagesAsOf:Object(A.a)(e.conversationLastSyncTimeStamp)})),d=Object(S.a)(),c=await d.mutate({variables:{conversations:r,isRead:n,isUserInitiated:t,folderId:a,mailboxInfo:i},mutation:F});return null===(o=null==c?void 0:c.data)||void 0===o?void 0:o.markConversationAsRead}};var D=t(3411),M=Object(o.action)("autoMarkConversationAsRead")((async function(e,n,t={items:N.a.items}){const i=Object(a.F)([e],n),o=Object(D.a)(i[0],n.id);if(!o)return;if(!Object(a.h)(n))return;const r=o.itemIds;if(!l(r)){if(0==Object.keys(d.suppressedItemIdsMap).length)await V([e],n,!0,!1,null,[],i);else for(const e of r)!l([e])&&t.items.get(e)&&await w(n,[e],!0,!1,null,[]);u()}}));const x={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"MarkForkAsRead"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"forks"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ConversationForkInput"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isRead"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isUserInitiated"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"markForkAsRead"},arguments:[{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"forks"},value:{kind:"Variable",name:{kind:"Name",value:"forks"}}},{kind:"ObjectField",name:{kind:"Name",value:"isRead"},value:{kind:"Variable",name:{kind:"Name",value:"isRead"}}},{kind:"ObjectField",name:{kind:"Name",value:"isUserInitiated"},value:{kind:"Variable",name:{kind:"Name",value:"isUserInitiated"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"}}]}}]}}]};function E(e,n,t,i,o){return b.a.import().then(a=>{a(n.tableQuery,!1,t,o,e.map(e=>e.id))}),function(e,n,t,i){const o=Object(k.a)(e),r=P.invokeMarkForkAsReadMutation(n,t,i),d=Object(a.cb)(e,t,i);return Object(j.c)(r,n.map(e=>e.id),o,e,d,!0)}(n,e,t,i)}const P={invokeMarkForkAsReadMutation:async function(e,n,t){var a;const i=Object(S.a)(),o=await i.mutate({variables:{forks:e.map(e=>({id:e.id,forkId:e.forkId,ancestorIds:e.ancestorIds})),isRead:n,isUserInitiated:t},mutation:x});return null===(a=null==o?void 0:o.data)||void 0===a?void 0:a.markForkAsRead}};var U=t(11833),_=t(5083),L=t(4499);var B=t(2948),Q=t(2869),z=t(2791),G=Object(o.action)("autoMarkItemAsRead")((async function(e,n,t){if(!Object(a.h)(n))return;if(l([e]))return;const i=Object(Q.a)(e);let o;if(i){o=1==Object(B.b)(i.ParentFolderId.Id)}Object(z.a)()&&!o?async function(e,n,t,i){if(!n)return;const o=t||[...e.selectedRowKeys.keys()][0],r=a.b.getRowClientItemId(o,e),d=null==r?void 0:r.Id;if(d)if(Object(L.a)()){const t=a.b.getParentFolderId(o,e);let r=[];if(t){const e=a.Z.expandedConversationViewState;r=(null==e?void 0:e.expandedRowKey)==o&&(null==e?void 0:e.forks)&&e.forks.length>0?e.forks:await Object(U.a)(d,t,null)}if(r.length>0){Object(I.a)([n],i,!1,e.id);const t=function(e,n){for(let t=0;t<n.length;t++)if(n[t].id==e)return n[t];return null}(n,r);t&&E([t],e,i,!1,null)}else await M(d,e)}else Object(_.a)(d,e.tableQuery.folderId).then(t=>{for(let a=0;a<t.length;a++)if(t[a][0]===n){w(e,t[a],i,!1,null,[]);break}})}(n,e,t,!0):await w(n,[e],!0,!1,null,[]),u()}));async function K(e,n){var t;if("OnSelectionChange"!==Object(h.a)().UserOptions.PreviewMarkAsRead)return;const i=a.b.getRowIdString(e,n);switch(n.tableQuery.listViewType){case 0:if(Object(z.a)()){const i=null===(t=a.b.getRowIdToShowInReadingPane(e,n))||void 0===t?void 0:t.Id;await G(i,n,e)}else await M(i,n);break;case 1:await G(i,n)}}var W=t(2863),q=Object(o.action)("onReadingPaneClosed")((function(e,n){Object(W.s)()||O.d("onReadingPaneClosed should only be called in single line view."),K(e,n)}));async function H(e,n,t){Object(W.s)()||t&&await K(e,n)}function J(e,n,t){0==e.length||Object(W.s)()||1!==e.length||"Unread"===Object(a.Q)(t)||K(e[0],n)}var Z=Object(r.action)("MARK_ITEMS_READ_BASED_ON_NODE_IDS",(e,n,t,a,i)=>({nodeIds:e,tableViewId:n,isReadValueToSet:t,isExplicit:a,actionSource:i})),$=Object(o.action)("markItemAsReadFromReadingPane")((function(e,n,t,i,o){let r=[],d=null;if(n){if(Object(a.R)(n)){const t=N.a.items.get(e).ConversationId.Id;r=Object(a.F)([t],n)}else r=Object(a.F)([e],n);d=Object(a.m)(n)}w(n,[e],t,!0,o,i).then(()=>{n&&Object(j.a)(r,d)}).catch(e=>{n&&(Object(j.a)(r,d),Object(j.b)(n))})})),X=t(3468),Y=Object(o.action)("markConversationsAsReadFromTable")((function(e,n,t,i){const o=Object(a.D)(e,n.id),r=Object(X.a)(e,n);return V(o,n,t,!0,i,r,e)})),ee=Object(o.action)("markItemsReadFromTable")((function(e,n,t,i,o){const r=Object(a.D)(e,n.id),d=Object(X.a)(e,n),c=w(n,r,t,i,o,d),s=Object(a.m)(n),u=Object(a.cb)(n,t,i);c.then(n=>{Object(j.a)(e,s,u)}).catch(t=>{Object(j.a)(e,s,u),Object(j.b)(n)})})),ne=t(3577),te=Object(o.action)("toggleRowReadState")((function(e,n,t){const i=a.Z.tableViews.get(n),o=a.b.getUnreadCount(e,i)>0;switch(i.tableQuery.listViewType){case 0:Y([e],i,o,t);break;case 1:ee([e],i,o,!0,t)}Object(ne.b)()})),ae=Object(o.action)("onNavigateAwayViaUpDown")((function(e,n){K(e,n)})),ie=Object(r.action)("onKeyboardMarkAsRead",(e,n,t,a,i,o)=>({tableView:e,selectedNodeIds:n,isInVirtualSelectAllMode:t,rowKeysToActOn:a,exclusionList:i,isReadValueToSet:o})),oe=t(6063),re=t(4109),de=t(4842),ce=t(15524),se=t(6),ue=t(7780),le=t(15525),be=t(15526);var me=t(1205),fe=t(596),ke=t(5),ve=t(2737),Oe=t(3379),pe=t(3117),je=t(12448),Ne=t(5920),Ie=t(3448),ye=t(3101);const Se={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"MarkViewAsRead"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"focusedViewFilter"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"FocusedViewFilter"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"viewFilter"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ViewFilter"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"markAsRead"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"clientLastSyncTime"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationIdsToExclude"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"itemIdsToExclude"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"suppressReadReceipt"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"markViewAsRead"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"ObjectField",name:{kind:"Name",value:"focusedViewFilter"},value:{kind:"Variable",name:{kind:"Name",value:"focusedViewFilter"}}},{kind:"ObjectField",name:{kind:"Name",value:"viewFilter"},value:{kind:"Variable",name:{kind:"Name",value:"viewFilter"}}},{kind:"ObjectField",name:{kind:"Name",value:"markAsRead"},value:{kind:"Variable",name:{kind:"Name",value:"markAsRead"}}},{kind:"ObjectField",name:{kind:"Name",value:"clientLastSyncTime"},value:{kind:"Variable",name:{kind:"Name",value:"clientLastSyncTime"}}},{kind:"ObjectField",name:{kind:"Name",value:"conversationIdsToExclude"},value:{kind:"Variable",name:{kind:"Name",value:"conversationIdsToExclude"}}},{kind:"ObjectField",name:{kind:"Name",value:"itemIdsToExclude"},value:{kind:"Variable",name:{kind:"Name",value:"itemIdsToExclude"}}},{kind:"ObjectField",name:{kind:"Name",value:"suppressReadReceipt"},value:{kind:"Variable",name:{kind:"Name",value:"suppressReadReceipt"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"folder"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"FolderId"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"}}]}}]}}]}}]}}]};var Re=Object(o.action)("markAsReadInTable")((function(e,n,t,i,o,r,d){if(o.length&&t)throw new Error("If in virtual select all mode, rowKeysToActOn should be empty.");if(n.length&&!t)throw new Error("If not in virtual select all mode, exclusionList should be empty.");const c=r.tableQuery.folderId,s=ve.d.folderTable.get(c),u=r.isInVirtualSelectAllMode&&n.length>0,l=Object(a.Q)(r),m="ContextFolder"===e||function(e){return"CommandBar"===e||"SimplifiedRibbon"===e||"MultiLineRibbon"===e||"CommandBarRibbon"===e}(e)&&t&&!r.isInCheckedMode&&!Object(a.U)(r,l),f=o.length>0&&!t,k=t&&s&&s.UnreadCount>=ue.b,j=function(e,n,t,i,o,r,d,c){if(e){const e=Object(a.P)(r);return e?Object(me.n)(e):null==t?void 0:t.UnreadCount}if(Object(a.w)(r)||n||Object(a.U)(r,d)&&c)return r.totalRowsInView-i;return o}(m,u,s,n.length,o.length,r,l,t),N=k||j>=ue.b;let I={headerText:"",bodyText:""};if(N){const e=Object(a.q)(r.tableQuery.type,r,s&&Object(ve.h)(s));I=function(e,n,t,a,i,o,r,d){let c="",s="";const u=1===n,l=e||u;let b;return t<0&&(O.h.warn("totalCount in getMarkAsReadUnreadAllConfirmText should not be negative."),c=l?i?Object(se.b)(oe.e):Object(se.b)(re.e):i?Object(se.b)(oe.c):Object(se.b)(re.c)),1==t&&(c=i?Object(se.b)(de.a):Object(se.b)(re.a)),b=t<ue.a?t:"10000+",c=l?i?Object(se.c)(Object(se.b)(oe.d),b):Object(se.c)(Object(se.b)(re.d),b):i?Object(se.c)(Object(se.b)(oe.b),b):Object(se.c)(Object(se.b)(re.b),b),s=e?i?Object(se.c)(Object(se.b)(le.b),a):Object(se.c)(Object(se.b)(be.b),a):o||r?u?i?Object(se.c)(Object(se.b)(le.d),a):Object(se.c)(Object(se.b)(be.d),a):i?Object(se.c)(Object(se.b)(le.c),a):Object(se.c)(Object(se.b)(be.c),a):u?i?Object(se.c)(Object(se.b)(le.b),a):Object(se.c)(Object(se.b)(be.b),a):i?Object(se.c)(Object(se.b)(le.a),a):Object(se.c)(Object(se.b)(be.a),a),d&&(s=u?i?Object(se.b)(ce.b):Object(se.b)(ce.d):i?Object(se.b)(ce.a):Object(se.b)(ce.c)),{headerText:c,bodyText:s}}(m,r.tableQuery.listViewType,j,e,i,u,f,2===r.tableQuery.type)}Object(fe.b)(I.headerText,I.bodyText,!N,{delayCallbackAfterAnimation:!0,okText:Object(se.b)(Oe.a)}).then(async d=>{var s,u;if(d===fe.a.ok)if(await ye.b(),t){const t=Object(h.a)().UserOptions.ReadReceipt,o="DoNotAutomaticallySend"==t||"NeverSend"==t||Object(Ie.a)(c),d=Object(a.V)(c)?a.Z.inboxPausedDateTime:null;!function(e,n,t){let i="TnS_MarkAllAs";i+=n?"Read":"Unread",Object(p.p)(i,[e,Object(a.n)(t),t.isInCheckedMode])}(e,i,r),b.a.import().then(n=>{n(r.tableQuery,!0,i,e)});let l=[];0===r.tableQuery.listViewType&&(l=Object(je.a)(n,r.id));let m=[];switch(r.tableQuery.listViewType){case 0:m=Object(Ne.a)(n,r.id);break;case 1:m=Object(a.D)(n,r.id)}Object(pe.a)(r,i,m);let f=Object(a.l)(r),k=null===(s=f)||void 0===s?void 0:s.Id;k||(k=null===(u=f)||void 0===u?void 0:u.Id);const O=r.tableQuery;let j={id:k,focusedViewFilter:Object(a.r)(O.focusedViewFilter),viewFilter:Object(a.v)(O.viewFilter),markAsRead:i,clientLastSyncTime:d&&Object(ke.vb)(d),conversationIdsToExclude:l,itemIdsToExclude:m,suppressReadReceipt:o,mailboxInfo:Object(v.b)(r)};he.invokeMarkViewAsReadMutation(j)}else switch(r.tableQuery.listViewType){case 0:Y(o,r,i,e);break;case 1:ee(o,r,i,!0,e)}})}));const he={invokeMarkViewAsReadMutation:async function(e){var n;const t=Object(S.a)(),a=await t.mutate({variables:e,mutation:Se});return null===(n=null==a?void 0:a.data)||void 0===n?void 0:n.markViewAsRead}};var we=t(2978);let ge=Object(o.action)("setAutoMarkAsReadTimer")((function(e,n,t={store:d}){const i=Object(h.a)().UserOptions;if("Delayed"==i.PreviewMarkAsRead){const o=Object(we.a)();if(!o||!Object(a.h)(o))return;t.store.markAsReadTimerTask=setTimeout(()=>{Fe(e,o,n)},1e3*i.MarkAsReadDelaytime)}})),Te=Object(o.action)("clearAutoMarkAsReadTimer")((function(e={store:d}){e.store.markAsReadTimerTask&&(clearTimeout(e.store.markAsReadTimerTask),e.store.markAsReadTimerTask=null)}));const Fe=Object(o.action)("setMarkAsReadTimer:timeout")((e,n,t)=>{Te(),t?G(e,n):1===n.tableQuery.listViewType||Object(z.a)()?G(e,n):M(e,n)});var Ae=t(3544),Ve=t(20);const Ce=Object(Ve.e)(Ae.b,"CLONE_ON_ITEM_PART_DESELECTED",e=>{const{itemId:n,tableView:t}=e;t&&"OnSelectionChange"==Object(h.a)().UserOptions.PreviewMarkAsRead&&G(n,t)});var De=t(4845),Me=t(3607),xe=(Object(r.orchestrator)(Z,e=>{const n=a.Z.tableViews.get(e.tableViewId),t=[...n.selectedRowKeys.keys()],i=Object(De.a)(e.nodeIds,Object(Me.a)(t[0]));w(n,i,e.isReadValueToSet,e.isExplicit,e.actionSource,null)}),t(2892)),Ee=t(7568);Object(r.orchestrator)(xe.p,e=>{const{tableViewId:n,currentSelectedNodeIds:t,rowKey:i}=e;if("OnSelectionChange"==Object(h.a)().UserOptions.PreviewMarkAsRead&&Object(z.a)()&&1===(null==t?void 0:t.length)){const e=a.Z.tableViews.get(n);G(Object(Ee.a)(t[0],Object(Me.a)(i)),e)}});Object(r.orchestrator)(ie,e=>{const{tableView:n,selectedNodeIds:t,isInVirtualSelectAllMode:a,rowKeysToActOn:i,exclusionList:o,isReadValueToSet:r}=e;t.length>0?Z(t,n.id,r,!0,"Keyboard"):Re("Keyboard",o,a,r,i,n)});t.d(n,"onReadingPaneClosed",(function(){return q})),t.d(n,"onSingleSelectionChanged",(function(){return H})),t.d(n,"markReadOnTableViewChange",(function(){return J})),t.d(n,"markItemsAsReadBasedOnNodeIds",(function(){return Z})),t.d(n,"markItemAsReadFromReadingPane",(function(){return $})),t.d(n,"toggleRowReadState",(function(){return te})),t.d(n,"onNavigateAwayViaUpDown",(function(){return ae})),t.d(n,"onKeyboardMarkAsRead",(function(){return ie})),t.d(n,"markAsReadInTable",(function(){return Re})),t.d(n,"clearAutoMarkAsReadTimer",(function(){return Te})),t.d(n,"setAutoMarkAsReadTimer",(function(){return ge})),t.d(n,"onItemPartDeselectedOrchestrator",(function(){return Ce}))},6063:function(e){e.exports=JSON.parse('{"a":"mtc","c":"ntc","e":"otc","b":"ptc","d":"qtc"}')},6286:function(e,n,t){"use strict";function a(e){return e?new Date(e).toISOString():null}t.d(n,"a",(function(){return a}))},7780:function(e,n,t){"use strict";t.d(n,"a",(function(){return a})),t.d(n,"b",(function(){return i}));const a=1e4,i=25}}]);
//# sourceMappingURL=owa.615.js.map
self.scriptsLoaded['owa.615.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.615.js'] = (new Date()).getTime();