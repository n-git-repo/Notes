self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~MailFunctionalBoot.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[407],{102:function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,a){function r(e){try{c(o.next(e))}catch(e){a(e)}}function s(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}c((o=o.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,o,i,a,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=2&a[0]?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!(i=(i=r.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){r=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(6===a[0]&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(e){a=[6,e],o=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.throwIfVersionIsNotSupported=t.IsVersonSupportedByHost=t.isPIEHostPresent=t.HostBridge=void 0;var a=function(){function e(){this.nextHandlerId=1,this.registeredHandlers=new Map}return e.prototype.registerHandler=function(e){var t=this,n=this.nextHandlerId;return this.nextHandlerId=this.nextHandlerId+1,this.registeredHandlers.set(n,e),function(){t.unregisterHandler(n)}},e.prototype.RaiseEvent=function(e){this.registeredHandlers.forEach((function(t){t(e)}))},e.prototype.HasHandlers=function(){return 0!==this.registeredHandlers.size},e.prototype.unregisterHandler=function(e){this.registeredHandlers.has(e)&&this.registeredHandlers.delete(e)},e}(),r=function(){function e(){this.nextMessageId=1,this.pendingMessages=new Map,this.eventHandlers=new Map,this.abandonedCallHandlers=new a,this.namespaceVersionChangeHandlers=new a,this.hostNotificationHandlers=new a,this.firstSyncIdCall=!0,this.nextSyncId=1,this.maxMessageId=2147483647}return e.prototype.isNamespaceVersionChange=function(e){return e.isIdRequest&&"version-change"===e.messageName&&-3===e.messageId},e.prototype.onMessageFromHost=function(e){if("app/pie"===e.contentType)if(this.raiseMessageInfoIfNeeded(e,!1),e.isEvent){var t=e.messageName;this.eventHandlers.has(t)&&this.eventHandlers.get(t).RaiseEvent(e.args)}else{var n=e.messageId;if(this.pendingMessages.has(n)){var o=this.pendingMessages.get(n);this.pendingMessages.delete(n),e.abandoned?this.abandonedCallHandlers.RaiseEvent(e.messageName):e.wasSuccessful?o.resolve(o.postProcessing?o.postProcessing(e.message):e.message):o.reject(new Error(e.messageName+":"+e.errorMessage))}else this.isNamespaceVersionChange(e)&&this.namespaceVersionChangeHandlers.RaiseEvent(e.message)}},e.prototype.addMessageToPendingMessages=function(e,t,n){var o=this.nextMessageId;this.nextMessageId=this.nextMessageId===this.maxMessageId?1:this.nextMessageId+1;var i={resolve:e,reject:t,postProcessing:n};return this.pendingMessages.set(o,i),o},e.prototype.invokeIdRequest=function(e,t,n,o,i){var a={contentType:"app/pie",messageName:t,isIdRequest:!0,messageId:this.addMessageToPendingMessages(o,i),message:n};this.raiseMessageInfoIfNeeded(a,!0,!0),e.sendMessageToHost(a)},e.throwPieSyncNotSupported=function(){throw new Error("Synchronous bridge not supported")},e.prototype.getNextSyncId=function(e){this.firstSyncIdCall&&(this.nextSyncId=e.getStartingSyncId(),this.firstSyncIdCall=!1);var t=this.nextSyncId;return this.nextSyncId=this.nextSyncId===Number.MAX_SAFE_INTEGER?1:this.nextSyncId+1,t},e.prototype.invokeOnHostSync=function(t,n,o,i,a,r){if(t.sendMessageToHostSync){var s=this.addMessageToPendingMessages(i,a,r),c={contentType:"app/pie",messageName:n,syncId:this.getNextSyncId(t),messageId:s,message:o};this.raiseMessageInfoIfNeeded(c,!0,!1),t.sendMessageToHostSync(c)}else e.throwPieSyncNotSupported()},e.prototype.invokeOnHost=function(e,t,n,o,i,a){var r={contentType:"app/pie",messageName:t,messageId:this.addMessageToPendingMessages(o,i,a),message:n};this.raiseMessageInfoIfNeeded(r,!0,!0),e.sendMessageToHost(r)},e.prototype.registerForEvent=function(e,t){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new a),this.eventHandlers.get(e).registerHandler(t)},e.prototype.registerForAbandonedCalls=function(e){return this.abandonedCallHandlers.registerHandler(e)},e.prototype.registerForNamespaceVersionChange=function(e){return this.namespaceVersionChangeHandlers.registerHandler(e)},e.prototype.registerForHostMessageNotification=function(e){return this.hostNotificationHandlers.registerHandler(e)},e.prototype.raiseMessageInfoIfNeeded=function(e,t,n){if(this.hostNotificationHandlers.HasHandlers()){var o={isToHost:t,isAsync:n,messageName:e.messageName,isIdRequest:e.isIdRequest,syncId:e.syncId,messageId:e.messageId,isEvent:e.isEvent,wasSuccessful:e.wasSuccessful,abandoned:e.abandoned};this.hostNotificationHandlers.RaiseEvent(o)}},e}(),s=function(){function e(e){this.bridge=e,this.processor=new r,this.instanceId=null,this.namespaceVersions=new Map;var t=function(e){this.namespaceVersions.has(e)&&this.namespaceVersions.delete(e)}.bind(this);this.processor.registerForNamespaceVersionChange(t);var n=function(e){this.processor.onMessageFromHost(e)}.bind(this);this.bridge.addHostMessageHandler(n)}return e.prototype.isUsingBridge=function(e){return this.bridge===e},e.prototype.invokeHost=function(e,t,n){var o=this;return new Promise((function(i,a){o.processor.invokeOnHost(o.bridge,e,t,i,a,n)}))},e.prototype.invokeHostSync=function(e,t,n){var o;return this.processor.invokeOnHostSync(this.bridge,e,t,(function(e){o=e}),(function(e){throw e}),n),o},e.prototype.invokeIdRequestOnHost=function(e,t){var n=this;return new Promise((function(o,i){n.processor.invokeIdRequest(n.bridge,e,t,o,i)}))},e.prototype.registerForEvent=function(e,t){return this.processor.registerForEvent(e,t)},e.prototype.registerForAbandonedCalls=function(e){return this.processor.registerForAbandonedCalls(e)},e.prototype.registerForHostMessageNotification=function(e){return this.processor.registerForHostMessageNotification(e)},e.prototype.getInstanceId=function(){var e=this;return new Promise((function(t,n){e.instanceId?t(e.instanceId):e.invokeIdRequestOnHost("instance","id").then((function(n){e.instanceId=n,t(e.instanceId)})).catch((function(e){n(e)}))}))},e.prototype.getNamespaceVersion=function(e){var t=this;return new Promise((function(n,o){t.namespaceVersions.has(e)?n(t.namespaceVersions.get(e)):t.invokeIdRequestOnHost("version",e).then((function(i){var a=parseFloat(i);isNaN(a)?o("Non numeric version returned"):(t.namespaceVersions.set(e,a),n(a))})).catch((function(e){o(e)}))}))},e}(),c=function(){function e(){}return e.setGlobalPreprocessCheck=function(t){e._globalPreprocessCheck=t},e.isInitializationNeeded=function(t){return!e._implInstance||!e._implInstance.isUsingBridge(t)},e.initialize=function(t){e.isInitializationNeeded(t)&&(e._implInstance=new s(t))},e.resetBridgeForUnitTests=function(){e._implInstance=null},e.reloadBridgeForUnitTests=function(){if(e._implInstance){var t=e._implInstance.bridge;e._implInstance=new s(t)}},e.failBridgeNotInitialized=function(){return new Promise((function(e,t){t(new Error("HostBridge not initialized"))}))},e.invokeHost=function(t,n,a){return o(this,void 0,void 0,(function(){return i(this,(function(o){switch(o.label){case 0:return e._implInstance?e._globalPreprocessCheck?[4,e._globalPreprocessCheck(t)]:[3,2]:[3,3];case 1:o.sent(),o.label=2;case 2:return[2,e._implInstance.invokeHost(t,n,a)];case 3:return[2,e.failBridgeNotInitialized()]}}))}))},e.invokeHostSync=function(t,n,o){if(e._implInstance)return e._implInstance.invokeHostSync(t,n,o);throw new Error("HostBridge not initialized")},e.getInstanceId=function(){return o(this,void 0,void 0,(function(){return i(this,(function(t){return e._implInstance?[2,e._implInstance.getInstanceId()]:[2,e.failBridgeNotInitialized()]}))}))},e.getNamespaceVersion=function(t){return o(this,void 0,void 0,(function(){return i(this,(function(n){return e._implInstance?[2,e._implInstance.getNamespaceVersion(t)]:[2,e.failBridgeNotInitialized()]}))}))},e.registerForEvent=function(t,n){return e._implInstance?e._implInstance.registerForEvent(t,n):null},e.registerForAbandonedCalls=function(t){return e._implInstance?e._implInstance.registerForAbandonedCalls(t):null},e.registerForHostMessageNotification=function(t){return e._implInstance?e._implInstance.registerForHostMessageNotification(t):null},e.throwPieSyncNotSupported=function(){r.throwPieSyncNotSupported()},e._implInstance=null,e._globalPreprocessCheck=null,e}();function d(){return o(this,void 0,void 0,(function(){return i(this,(function(e){return[2,new Promise((function(e){c.getInstanceId().then((function(t){e(!!t)})).catch((function(){e(!1)}))}))]}))}))}function u(e,t,n){return o(this,void 0,void 0,(function(){var o;return i(this,(function(i){switch(i.label){case 0:return[4,d()];case 1:return i.sent()?[4,c.getNamespaceVersion(e)]:[3,3];case 2:if((o=i.sent())>=t&&(!n||o<n))return[2,!0];i.label=3;case 3:return[2,!1]}}))}))}t.HostBridge=c,t.isPIEHostPresent=d,t.IsVersonSupportedByHost=u,t.throwIfVersionIsNotSupported=function(e,t,n){return o(this,void 0,void 0,(function(){return i(this,(function(o){switch(o.label){case 0:return[4,u(e,t,n)];case 1:if(!o.sent())throw new Error("VersionNotSupported for "+e+": "+t+", "+n);return[2]}}))}))}},10890:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));var o=n(20);const i=new o.c(()=>Promise.all([n.e(1),n.e(291)]).then(n.bind(null,13283))),a=new o.a(i,e=>e.subscribeToBulkActionNotification),r=new o.a(i,e=>e.findBulkActionItemAction)},10942:function(e,t,n){"use strict";var o=n(2);t.a=Object(o.action)("loadSignatureEditorWizard",(e,t)=>({target:e,viewState:t}))},10968:function(e,t,n){"use strict";var o=n(2);t.a=Object(o.action)("ON_ITEM_PART_SELECTED",(e,t)=>({conversationNodeId:e,conversationId:t}))},11051:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(2);let i=Object(o.action)("CONFIRM_TIMEZONE")},11052:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var o=n(2),i=n(5927),a=n(6),r=n(30);let s=Object(o.action)("SEND_AN_EMAIL",()=>({taskSendEmailSubject:Object(a.c)(Object(a.b)(i.C),Object(r.a)().SessionSettings.UserEmailAddress),taskSendEmailBody:Object(a.c)(Object(a.b)(i.B),Object(r.a)().SessionSettings.UserEmailAddress)}))},11053:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(2);let i=Object(o.action)("ADD_STORAGE_ACCOUNT")},11054:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(2);let i=Object(o.action)("SETUP_SIGNATURE")},11055:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(2);let i=Object(o.action)("SHOW_PERSONALIZATION_MODAL")},11056:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(2);let i=Object(o.action)("COMPLETE_SEND_AN_EMAIL")},11057:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(2);let i=Object(o.action)("COMPLETE_PERSONALIZATION")},11067:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return r}));const o="mailtoHandlerIgnoredCount",i=14,a=6048e5,r={"https://outlook-sdf.office.com":"AoxP1SeWYDYaKSqgQMEvcNV6+kiHTEA8E7F9FjDjLwt7H0aRzgY65MUDyudqsVVEU4fc3e3gWdo0W2cPQO6iAKYAAAB6eyJvcmlnaW4iOiJodHRwczovL291dGxvb2stc2RmLm9mZmljZS5jb206NDQzIiwiaXNTdWJkb21haW4iOnRydWUsImZlYXR1cmUiOiJQYXJzZVVybFByb3RvY29sSGFuZGxlciIsImV4cGlyeSI6MTYyODcxMDg1NX0=","https://outlook.office.com":"ArohrU+3nrD+36RWgvyIVASpPMV5qmL2aBKg/vdjAPsb74oW+ljPFdkdIMWDND2sIN67kbxraiSt5lnF+SyovEMAAAB2eyJvcmlnaW4iOiJodHRwczovL291dGxvb2sub2ZmaWNlLmNvbTo0NDMiLCJpc1N1YmRvbWFpbiI6dHJ1ZSwiZmVhdHVyZSI6IlBhcnNlVXJsUHJvdG9jb2xIYW5kbGVyIiwiZXhwaXJ5IjoxNjI4NzEwODgxfQ==","https://outlook-sdf.live.com":"AuUoPvZX8c3JfzbLy7x7DfhA112kexySjZL3RNuqj+tiOK9dItPzWZENDwOa8vH0W0YvqCu1XsmKAGqbhVGLBakAAAB4eyJvcmlnaW4iOiJodHRwczovL291dGxvb2stc2RmLmxpdmUuY29tOjQ0MyIsImlzU3ViZG9tYWluIjp0cnVlLCJmZWF0dXJlIjoiUGFyc2VVcmxQcm90b2NvbEhhbmRsZXIiLCJleHBpcnkiOjE2Mjg3MTI3MTV9","https://outlook.live.com":"AuLB2GUe2LClDSVyaFtvIFySHIjhldxQuohbvtoqo1W8RQTQRTDuyE0y8lwoDKsUj50ta4qmsIpdjcgPzluIzIUAAAB0eyJvcmlnaW4iOiJodHRwczovL291dGxvb2subGl2ZS5jb206NDQzIiwiaXNTdWJkb21haW4iOnRydWUsImZlYXR1cmUiOiJQYXJzZVVybFByb3RvY29sSGFuZGxlciIsImV4cGlyeSI6MTYyODcxMjczMn0="}},11068:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var o=n(6999),i=n(7323);function a(e,t){Object(o.a)(e),Object(i.a)(t)}},11072:function(e,t,n){"use strict";var o=n(2);const i=Object(o.action)("ON_CONVERSATION_OPTION_SAVED");t.a=i},11073:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return d}));var o=n(68),i=n(11),a=n(11074),r=n(483),s=n(6);function c(){var e;(null===(e=null===window||void 0===window?void 0:window.navigator)||void 0===e?void 0:e.registerProtocolHandler)&&window.navigator.registerProtocolHandler("mailto",`${Object(r.n)()}${Object(r.l)()}deeplink/compose?mailtouri=%s`,Object(s.b)(a.a))}function d(e){Object(i.c)(window)&&Object(i.e)(window,e,(new Date).getTime().toString()),"MailToBannerTryItNow"===e&&c(),Object(o.p)("mailToHandlerEvent",{UserAction:e})}},11074:function(e){e.exports=JSON.parse('{"a":"uFc"}')},11833:function(e,t,n){"use strict";var o=n(5083),i=n(4499),a=n(2742),r=n(2);const s=Object(r.mutatorAction)("addForkItemToMailStore",(e,t)=>{const n=e.id;if(!a.u.items.has(n)){const o={ItemId:{Id:n},Categories:e.Categories,ConversationId:e.ConversationId,DateTimeReceived:e.DateTimeReceived,DateTimeSent:e.DateTimeSent,DisplayTo:e.DisplayTo,Flag:e.Flag,From:e.From,HasAttachments:e.HasAttachments,IconIndex:e.IconIndex,Importance:e.Importance,InstanceKey:e.InstanceKey,IsDraft:e.IsDraft,IsRead:e.IsRead,IsExternalSender:e.IsExternalSender,ItemClass:e.ItemClass,MentionedMe:e.MentionedMe,ParentFolderId:e.ParentFolderId,Preview:e.Preview,ReceivedOrRenewTime:e.ReceivedOrRenewTime,Size:e.Size,Subject:e.Subject},i=Object.assign(Object.assign({},o),{MailboxInfo:t});a.u.items.set(n,i)}}),c={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetConversationForksById"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"conversationForks"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"forks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"displayNames"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"forkId"}},{kind:"Field",name:{kind:"Name",value:"ancestorIds"}},{kind:"Field",name:{kind:"Name",value:"Categories"}},{kind:"Field",name:{kind:"Name",value:"ConversationId"}},{kind:"Field",name:{kind:"Name",value:"DateTimeReceived"}},{kind:"Field",name:{kind:"Name",value:"DateTimeSent"}},{kind:"Field",name:{kind:"Name",value:"DisplayTo"}},{kind:"Field",name:{kind:"Name",value:"Flag"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"FlagStatus"}},{kind:"Field",name:{kind:"Name",value:"StartDate"}},{kind:"Field",name:{kind:"Name",value:"DueDate"}},{kind:"Field",name:{kind:"Name",value:"CompleteDate"}}]}},{kind:"Field",name:{kind:"Name",value:"From"}},{kind:"Field",name:{kind:"Name",value:"HasAttachments"}},{kind:"Field",name:{kind:"Name",value:"IconIndex"}},{kind:"Field",name:{kind:"Name",value:"Importance"}},{kind:"Field",name:{kind:"Name",value:"InstanceKey"}},{kind:"Field",name:{kind:"Name",value:"IsDraft"}},{kind:"Field",name:{kind:"Name",value:"IsRead"}},{kind:"Field",name:{kind:"Name",value:"IsExternalSender"}},{kind:"Field",name:{kind:"Name",value:"ItemClass"}},{kind:"Field",name:{kind:"Name",value:"MentionedMe"}},{kind:"Field",name:{kind:"Name",value:"ParentFolderId"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"}},{kind:"Field",name:{kind:"Name",value:"ChangeKey"}}]}},{kind:"Field",name:{kind:"Name",value:"Preview"}},{kind:"Field",name:{kind:"Name",value:"ReceivedOrRenewTime"}},{kind:"Field",name:{kind:"Name",value:"Size"}},{kind:"Field",name:{kind:"Name",value:"Subject"}}]}}]}}]}}]};var d=n(595);t.a=async function(e,t,n){let r=[];if(Object(i.a)())try{r=await async function(e,t,n){var o,i;const a=Object(d.a)(),r=await(null==a?void 0:a.query({query:c,variables:{id:e,folderId:t},context:{suppressFallbackAlert:!0}}));if((null===(i=null===(o=null==r?void 0:r.data)||void 0===o?void 0:o.conversationForks)||void 0===i?void 0:i.forks)&&r.data.conversationForks.forks.length>0){let e=[];return r.data.conversationForks.forks.forEach(t=>{e.push(t),s(t,n)}),e}return[]}(e,t,n)}catch(e){r=[]}else r=await async function(e,t){const n=await Object(o.a)(e,t);if(n.length>1){const e=[];return n.forEach(t=>{const n=[];t.forEach(e=>{var t,o;const i=a.u.items.get(e),r=null===(o=null===(t=null==i?void 0:i.From)||void 0===t?void 0:t.Mailbox)||void 0===o?void 0:o.Name;r&&!n.includes(r)&&n.push(r)}),e.push({id:t[0],displayNames:n,forkId:"",ancestorIds:t})}),e}return[]}(e,t);return r}},19727:function(e,t,n){"use strict";n.r(t);var o=n(1084),i=n(6481),a=n(2733),r=n(25);function s(e){return Object(a.V)(Object(o.a)("inbox"))||Object(r.k)("rp-reactions")}var c=n(2774);function d(e){const t=Object(o.a)("inbox");return Object(a.V)(t)&&!Object(c.isPersonaInFavorites)(null,e.SenderSmtpEmailAddress)}function u(){return Object(a.V)(Object(o.a)("inbox"))||!Object(r.k)("auth-reactionNotifications")||!Object(r.k)("rp-reactions")}var l=n(11768),f=n(4532),b=n(5535),p=n(6574),v=n(2),m=n(3902),I=n(9601);Object(v.orchestrator)(I.a,e=>{let t={Subject:e.taskNewEventTitle,IsAllDayEvent:!0};m.g.importAndExecute("GetStarted","GetStarted",t)});var O=n(2939),g=n(11053);Object(v.orchestrator)(g.a,()=>{O.f.importAndExecute("mail","attachments")});var h=n(11054);Object(v.orchestrator)(h.a,()=>{O.f.importAndExecute("mail","messageContent")});var w=n(11051);Object(v.orchestrator)(w.a,()=>{O.f.importAndExecute("general","timeAndLanguage")});var j=n(3253),y=n(11052),S=n(11056),k=n(3703);Object(v.orchestrator)(y.a,e=>{j.c.importAndExecute("GetStarted",void 0,void 0,e.taskSendEmailSubject,e.taskSendEmailBody)}),Object(v.orchestrator)(k.a,e=>{1==e.event&&Object(S.a)()});var N=n(11055),x=n(11057),M=n(20);const E=new M.c(()=>Promise.all([n.e(12),n.e(14),n.e(17),n.e(223),n.e(618)]).then(n.bind(null,19890)));let A=new M.a(E,e=>e.showPersonalizationCard);Object(v.orchestrator)(N.a,()=>{A.importAndExecute(x.a)});var R=n(10942);const C=new M.c(()=>n.e(1050).then(n.bind(null,19932)));let T=new M.a(C,e=>e.loadSignatureEditorWizardUtil);Object(v.orchestrator)(R.a,e=>{T.importAndExecute(e.target,e.viewState)}),Object(b.a)()&&p.d.importAndExecute();var P=n(5458);const F=new M.c(()=>n.e(2172).then(n.bind(null,20089)));let V=new M.a(F,e=>e.loadSenders);var D=n(9248),H=n(3575);const _=new M.c(()=>n.e(1098).then(n.bind(null,19920))),L=new M.a(_,e=>e.subscribeToHierarchyNotification);Object(M.f)(H.a,_,e=>e.onNewFolderNotificationOrchestrator),Object(M.f)(H.b,_,e=>e.onUpdateFolderNotificationOrchestrator);var U=n(6),W=n(13),K=n(2740),Z=n(3569),B=n(22);function G(e,t){const n=function(e){const t={};let n=K.a.conversationNodes.get(e);for(;n;){if(t[n.internetMessageId]){B.d("Invalid loop found in ParentInternetMessageId pointers");break}if(Object(Z.b)(n.internetMessageId)&&(t[n.internetMessageId]=!0),Object(U.j)(n.parentInternetMessageId))break;n=K.a.conversationNodes.get(n.parentInternetMessageId)}return t}(e);if(1===Object.keys(n).length)return function(e,t){const n=new W.ObservableMap({});return t.forEach(t=>{const o=K.a.conversationNodes.get(t),i=t===e?a.a.CheckMark:a.a.None;n.set(o.internetMessageId,i)}),n}(e,t);const o=new W.ObservableMap({});let i=!1,r=!1,s=0;for(let e=0;e<t.length;e++){const c=K.a.conversationNodes.get(t[e]);c&&(n[c.internetMessageId]?(i?s+1===Object.keys(n).length?(o.set(c.internetMessageId,a.a.BusEnd),r=!0):o.set(c.internetMessageId,a.a.BusStop):(o.set(c.internetMessageId,a.a.BusStart),i=!0),s++):!i||r?o.set(c.internetMessageId,a.a.None):o.set(c.internetMessageId,a.a.NoStop))}return o}var z=Object(v.action)("FOCUS_ITEM_PART",(e,t)=>({nodeId:e,mailListItemSelectionSource:t})),J=n(2892),q=n(3967),Y=n(6757),X=n(9574),Q=n(2742),$=n(3607),ee=n(2791);function te(e,t){const n=a.Z.expandedConversationViewState;n.expandedRowKey!=e?Object(ee.a)()?(n.shouldBeExpanded=!0,n.expandedRowKey=e,n.forks=[]):t===Q.b.MailListItemTwisty&&(n.shouldBeExpanded=!0,n.expandedRowKey=e,n.forks=null):t===Q.b.MailListItemTwisty&&Object($.a)(e)&&(Object(Y.a)(),n.shouldBeExpanded=!0,n.expandedRowKey=e)}Object(v.mutator)(J.s,e=>{const{nodeId:t}=e,{selectedNodeIds:n,allNodeIds:o}=a.Z.expandedConversationViewState;a.Z.expandedConversationViewState.focusedNodeId=t,n.indexOf(t)>-1?n.splice(n.indexOf(t),1):n.push(t),1===n.length&&(a.Z.expandedConversationViewState.busStopStateMap=G(n[0],o))}),Object(v.mutator)(J.g,e=>{a.Z.expandedConversationViewState.busStopStateMap=new W.ObservableMap({})}),Object(v.mutator)(z,e=>{a.Z.expandedConversationViewState.focusedNodeId=e.nodeId}),Object(v.mutator)(J.p,e=>{const{rowKey:t,nodeIdToSelect:n,allNodeIds:o}=e,i=a.Z.expandedConversationViewState;i.selectedNodeIds=[n],i.busStopStateMap=G(n,o),i.expandedRowKey=t,i.focusedNodeId=n,i.allNodeIds=o}),Object(v.mutator)(J.t,e=>{e.mailListItemSelectionSource===Q.b.MailListItemCheckbox&&Object(Y.a)()}),Object(v.mutator)(q.a,e=>{Object(Y.a)()}),Object(v.mutator)(J.h,e=>{Object(Y.a)()}),Object(v.mutator)(J.j,e=>{Object(Y.a)()}),Object(v.mutator)(J.q,e=>{const{rowKey:t,mailListItemSelectionSource:n}=e;te(t,n)}),Object(v.mutator)(J.n,e=>{const{rowKey:t,mailListItemSelectionSource:n}=e;te(t,n)}),Object(v.mutator)(J.o,e=>{Object(Y.a)(),a.Z.expandedConversationViewState.expandedRowKey=e.rowKey}),Object(v.mutator)(X.a,e=>{if(1===a.Z.expandedConversationViewState.selectedNodeIds.length){const t=a.Z.expandedConversationViewState.selectedNodeIds[0],n=Q.u.conversations.get(e.conversationId).conversationNodeIds;a.Z.expandedConversationViewState.busStopStateMap=G(t,n)}});var ne=n(5326),oe=n(9250),ie=n(3078),ae=n(2788),re=n(11833),se=n(2827),ce=n(3203),de=n(6490),ue=n(4022),le=n(7326),fe=n(3184),be=n(4499);Object(v.orchestrator)(J.a,e=>{Ie(e.itemId,e.tableView,e.nodeId,e.allNodeIds,e.mailListItemSelectionSource)});let pe;Object(v.orchestrator)(J.d,e=>{if(1==e.listViewType)return;const t=a.Z.expandedConversationViewState,n=e.mailListItemSelectionSource==Q.b.MailListItemTwisty;Object(ee.a)()&&t.expandedRowKey!=e.rowKey?je(e.rowKey,e.tableView,n):t.expandedRowKey==e.rowKey&&(t.shouldBeExpanded?t.forks?je(e.rowKey,e.tableView,n):he(e.rowKey,e.tableView):!t.forks&&n&&we())}),Object(v.orchestrator)(J.b,e=>{(Object($.a)(e.rowKey)||Object($.c)(e.rowKey))&&we()}),Object(v.orchestrator)(J.l,e=>{var t,n;let o=null,i=null,r=null;if(Object($.a)(e.rowKey)){const e=a.Z.expandedConversationViewState.forks,s=e.map(e=>e.id);if(r=s,e.length>1){const r=s.indexOf(a.Z.expandedConversationViewState.selectedNodeIds[0]);-1!=r&&(i=e.length-1>r?null===(t=e[r+1])||void 0===t?void 0:t.id:null===(n=e[r-1])||void 0===n?void 0:n.id,o=i)}}else{const t=a.b.getConversationId(e.rowKey,e.tableView),n=Q.u.conversations.get(t),s=n.conversationNodeIds.indexOf(a.Z.expandedConversationViewState.selectedNodeIds[0]);r=n.conversationNodeIds;for(let e=s+1;e<n.conversationNodeIds.length;e++){const t=n.conversationNodeIds[e],a=Object(ue.a)(t,!1);if(a){i=a.ItemId.Id,o=t;break}}}o?Ie(i,e.tableView,o,r,Q.b.RowRemoval):ge(e.rowKey,e.tableView)});let ve=0,me=!0;function Ie(e,t,n,o,i){if(pe&&(clearTimeout(pe),pe=null),Object(oe.a)(t,!0,i,void 0),i!==Q.b.KeyboardUpDown||Object(ae.d)())Oe(e,t);else{const n=Date.now(),o=n-ve;ve=n,(me||o<=500)&&(me=!1,pe=setTimeout(()=>{pe=null,me=!0,Oe(e,t)},250))}const r=a.Z.expandedConversationViewState;J.p(r.expandedRowKey,n,o,t.id,r.selectedNodeIds)}function Oe(e,t){if(Object(ee.a)()){if(t.focusedRowKey!==a.Z.expandedConversationViewState.expandedRowKey)return;fe.o.importAndExecute({Id:e,mailboxInfo:Object(se.b)(t)},!0,null,!1)}else{const n=a.b.getRowClientItemId(a.Z.expandedConversationViewState.expandedRowKey,t);fe.s.importAndExecute(null==n?void 0:n.Id,e,!0)}}function ge(e,t,n,o){let i=null==n?void 0:n.map(e=>e.id);if(!i||0==i.length){const n=a.b.getConversationId(e,t),o=Q.u.conversations.get(n);i=null==o?void 0:o.conversationNodeIds}const r=o?a.b.getRowIdToShowInReadingPane(e,t):null;if(i)for(const n of i){const o=Object(ue.a)(n,Object($.a)(e));if(o&&(!r||o.ItemId.Id==r.Id)){Ie(o.ItemId.Id,t,n,i,Object(ee.a)()&&Object(ie.a)()&&Object(ae.d)()?Q.b.MailListItemExpansion:Q.b.RowRemoval);break}}}async function he(e,t){const n=a.b.getRowClientItemId(e,t);n&&!Object(le.a)(n.Id)&&await ce.e.importAndExecute(n,"PrefetchSingleRow"),J.o(e),Object(ne.a)(t,!1),Object(ee.a)()?ge(e,t,null,!0):ge(e,t)}function we(){J.h()}async function je(e,t,n){const o=a.b.getRowClientItemId(e,t);if(o){const i=o.Id;Object(be.a)()||Object(le.a)(i)||await ce.e.importAndExecute(o,"CreateConversationRelationMap");const r=a.b.getParentFolderId(e,t);if(r){const a=await Object(re.a)(i,r,o.mailboxInfo);a.length>1?(Object(de.a)(e,a),ge(e,t,a)):n?he(e,t):Object(de.a)(e,a)}}}var ye=n(9577),Se=n(11072),ke=(Object(v.orchestrator)(Se.a,e=>{Object(ye.a)(),1===Object(a.L)().expandedConversationViewState.selectedNodeIds.length&&J.g()}),n(10968)),Ne=n(3491),xe=(Object(v.orchestrator)(ke.a,e=>{if(!a.Z.expandedConversationViewState.expandedRowKey)return;const t=Q.u.conversations.get(e.conversationId);J.p(a.Z.expandedConversationViewState.expandedRowKey,e.conversationNodeId,t.conversationNodeIds,Object(Ne.a)())}),n(9603)),Me=n(6291),Ee=n(7783),Ae=n(3815),Re=Object(v.action)("FOCUS_ROW_IN_DIRECTION",(e,t,n)=>({tableView:e,selectionDirection:t,mailListItemSelectionSource:n}));function Ce(e,t,n){return Object(Ae.a)()?1===e&&n===a.d.Next||0===e&&n===a.d.Previous:e===t-1&&n===a.d.Next||e===t-2&&n===a.d.Previous}Object(v.orchestrator)(xe.a,e=>{var t;const{selectionDirection:n,tableView:o,mailListItemSelectionSource:i,shouldSelect:r}=e,[s,c]=function(e,t){const{focusedNodeId:n,allNodeIds:o}=a.Z.expandedConversationViewState;if(!n)return[null,null];let i,r,s=o.indexOf(n);e===a.d.Next?(i=o.length-1,r=1):(i=0,r=-1);const c=Object(a.M)(t.focusedRowKey,t.id).id,d=a.Z.conversationItems.get(c);for(;s!==i;){if(s+=r,Object(Me.a)(d.id)&&Ce(s,o.length,e))return Object(Ee.a)(d.clientId),["loading",null];let n=o[s],i=Object(ue.a)(n,Object($.a)(t.focusedRowKey));if(i)return[n,i]}return[null,null]}(n,o);"loading"!==s&&(s?r?J.a(s,c.ItemId.Id,a.Z.expandedConversationViewState.allNodeIds,o,i):z(s,i):a.Z.expandedConversationViewState.expandedRowKey&&(!Object(ee.a)()||(null===(t=a.Z.expandedConversationViewState.forks)||void 0===t?void 0:t.length)>1||Object($.c)(a.Z.expandedConversationViewState.expandedRowKey))&&n===a.d.Previous?J.b(a.Z.expandedConversationViewState.expandedRowKey):r?J.m(o,n,i):Re(o,n,i))});var Te=n(9251),Pe=n(4983),Fe=n(4741),Ve=n(4740),De=(Object(v.orchestrator)(Re,e=>{const{tableView:t,selectionDirection:n}=e,o=Object(Te.a)(t,n);if(null===o)return;const i=t.rowKeys[o];Object(Pe.a)(t,i),Object(Ve.a)(t,i),Object(Fe.a)(t,null),J.h()}),n(9604));Object(v.orchestrator)(De.a,e=>{const{tableView:t,mailListItemSelectionSource:n}=e,o=a.Z.expandedConversationViewState.focusedNodeId;o?J.s(o):J.t(t,t.focusedRowKey,!0,n)});var He=n(2808),_e=n(7568),Le=n(9605);Object(v.orchestrator)(Le.a,e=>{const{tableView:t,selectedNodeIds:n,selectedRowKeys:o,mailListItemSelectionSource:i}=e;if(n.length>0&&i===He.a.KeyboardEnter){if(1!==n.length)return;J.a(n[0],Object(_e.a)(n[0],Object($.a)(o[0])),a.Z.expandedConversationViewState.allNodeIds,t,i)}else{if(1!==o.length)return;J.q(t,o[0],!0,i)}});var Ue=n(35);var We=n(220),Ke=n(3509),Ze=n(4241),Be=n(10890),Ge=n(3596),ze=n(3916);const Je=new M.c(()=>Promise.all([n.e(288),n.e(1350)]).then(n.bind(null,19800))),qe=new M.a(Je,e=>e.evaluatePlaywrightMailActions);var Ye=n(30),Xe=n(3269),Qe=n(3489),$e=n(11073),et=n(11067),tt=n(483),nt=n(107),ot=n(154),it=n(3325),at=n(3177);function rt(){var e;if(Object(Ye.a)().IsMonitoring&&qe.importAndExecute(),L.importAndExecute(),Object(l.a)(!0),Object(r.k)("fwk-mailtoProtocolHandler")&&Object(ot.a)("showOWAMailtoBanner")&&(Object($e.b)(),Object(nt.f)())){const e=Object(tt.n)();if(e in et.d){const t=et.d[e],n=document.createElement("meta");n.httpEquiv="origin-trial",n.content=t,document.head.appendChild(n)}}Ge.b.importAndExecute({task:()=>it.e.import(),idle:!0},{condition:Object(r.k)("fwk-devTools")||Object(r.k)("sea-contextFeedback"),task:()=>D.b.importAndExecute()},{condition:Object(r.k)("fwk-nlqsFloodgateSurvey")&&Object(ot.a)("floodgate")&&"en-us"!==(null===(e=Object(U.e)())||void 0===e?void 0:e.toLowerCase()),task:()=>Qe.a.importAndExecute(null,!0)},st,{condition:Object(Xe.h)(),task:()=>Xe.l.importAndExecute()},{condition:Object(r.k)("tri-spotlight2"),task:()=>Ke.c.importAndExecute(at.a)},{condition:Object(We.a)(),task:()=>V.importAndExecute()},()=>Be.b.importAndExecute(),()=>Be.a.importAndExecute(),{condition:Object(r.k)("mc-personalization"),task:()=>{Ze.b.importAndExecute()},idle:!0},{condition:Object(fe.f)(),task:()=>P.a.importAndExecute(),idle:!0},{task:()=>ze.a.importAndExecute(),idle:!0},{condition:Object(r.k)("auth-activityFeed")&&Object(r.k)("auth-activityFeedWeveSignal"),task:()=>f.e.importAndExecute(),idle:!0},{condition:Object(r.k)("mail-popout-projection"),task:()=>fe.h.importAndExecute(),idle:!0}).then(()=>{Ge.a.importAndExecute()})}function st(){var e,t;Object(i.g)(d),Object(i.f)(s),Object(i.h)(u),Object(We.a)()&&(e={isOWALogon:!0},Object(Ue.a)("ConnectedAccountsNotification",e,t))}Object(v.orchestrator)(i.b,async e=>{const t=e.notification;if(Object(a.R)(Object(a.I)())){const e=Object(Q.g)().conversations.get(t.conversationId),n={Id:t.conversationId,mailboxInfo:Object(se.a)()};e||await ce.e.importAndExecute(n,"LoadLikedConversation"),ct(n,t.subject)}else{const e=Object(Q.g)().items.get(t.itemId),n={Id:t.itemId,mailboxInfo:Object(se.a)()};if(null==e?void 0:e.NormalizedBody)ct(n,t.subject);else{const e={Id:t.itemId,mailboxInfo:Object(se.a)()};await ce.f.importAndExecute(e,"LoadLikedItem"),ct(e,t.subject)}}});function ct(e,t){fe.p.importAndExecute(e,t,[],!0,null)}var dt=n(11068),ut=n(52);Object(v.orchestrator)(i.c,e=>{const t=e.notification,n=1===Object(ut.g)().UserOptions.GlobalListViewTypeReact?t.ItemId:t.ConversationId;Object(dt.a)("inbox",n)}),Object(v.orchestrator)(i.d,async e=>{const t=e.notification;if(Object(a.R)(Object(a.I)())){const e=Object(Q.g)().conversations.get(t.conversationId),n={Id:t.conversationId,mailboxInfo:Object(se.a)()};e||await ce.e.importAndExecute(n,"LoadReactedConversation"),lt(n,t.subject)}else{const e=Object(Q.g)().items.get(t.itemId),n={Id:t.itemId,mailboxInfo:Object(se.a)()};if(null==e?void 0:e.NormalizedBody)lt(n,t.subject);else{const e={Id:t.itemId,mailboxInfo:Object(se.a)()};await ce.f.importAndExecute(e,"LoadReactedItem"),lt(e,t.subject)}}});function lt(e,t){fe.p.importAndExecute(e,t,[],!0,null)}n.d(t,"setupMailModulePostRender",(function(){return rt}))},2761:function(e,t,n){"use strict";function o(e,t){Object.keys(t).forEach(n=>e.set(n,t[n]))}function i(e){let t=null!=e?e:{headers:new Headers};return t.datapoint=t.datapoint||{},t.datapoint.mailbox="Default",t}n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}))},2762:function(e,t,n){"use strict";var o=n(2820),i=n(284),a=n(753),r=n(68),s=n(5),c=n(22);const d="X-AnchorMailbox",u="Authorization",l="X-OwaWebSessionType",f="X-OWA-ExplicitLogonUser";async function b(e,t){const n={},b=Object(i.k)(e);if(b){if(b.accountState==i.b.AccessRevoked)return null;if(b.accountState==i.b.AccountDeprovisioned||b.accountState==i.b.AccountNotFound)return Object(i.d)(b.accountState,b.accountProviderType),null}if(t?(n[d]=t,n[f]=t):b&&(n[d]=b.anchorMailbox),b){let t,i=b.token,d=Object(a.g)(b.tokenExpiry);!d&&i||(Object(r.p)("getAndUpdateAccessToken",{tokenExpiry:Object(s.y)(b.tokenExpiry,Object(s.Tb)()),isTokenExpired_1:d,isTokenInvalid_2:!i},{isCore:!0}),i=await o.a.importAndExecute(b.accountId,e,i),c.h.info("[AccountLoadRecovery] getConnectedAccountHeaders: finished GetAndUpdateAccessToken for "+e+i),i||(i="")),"Outlook"==b.accountProviderType?(t=`MSAuth1.0 usertoken="${i}", type="MSACT"`,n[l]=1..toString()):"Google"!=b.accountProviderType&&"ICloud"!=b.accountProviderType&&"Yahoo"!=b.accountProviderType||(t=`Bearer ${i}`,n[l]=2..toString()),n[u]=t}return n}var p=n(2761);async function v(e,t){const n=Object(p.a)();return n.headers=await async function(e,t){var n;const o=t&&(null===(n=e.headers)||void 0===n?void 0:n.set)?new Headers(e.headers):new Headers,i=await b(e.mailboxInfo.userIdentity,m(e.mailboxInfo.type,e.mailboxInfo.mailboxSmtpAddress)?e.mailboxInfo.mailboxSmtpAddress:null);return Object(p.b)(o,i),o}(e,t),n.authNeededOnUnAuthorized=!1,n.datapoint=n.datapoint||{},n.datapoint.mailbox="Connected",n}function m(e,t){const n="GroupMailbox"==e||"TeamsMailbox"==e||"SharedMailbox"==e||"PublicMailbox"==e;return n&&null==t&&c.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return v})),n.d(t,"c",(function(){return m}))},2763:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(2);const i=Object(o.action)("triggerReInitializeAccount",e=>({userIdentity:e}))},2768:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var o=n(2),i=n(13);const a=Object(o.createStore)("groupsStore",{groups:new i.ObservableMap})},2783:function(e,t,n){"use strict";var o;n.d(t,"a",(function(){return o})),function(e){e[e.NotStarted=0]="NotStarted",e[e.Loading=1]="Loading",e[e.Ready=2]="Ready"}(o||(o={}))},2794:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(2768);function i(e){const t=Object(o.a)().groups.get(e.toLowerCase());return t?t.groupDetails:null}},2802:function(e,t,n){"use strict";var o=n(20),i=n(3002),a=n(2882),r=n(21),s=n(0),c=n(2897),d=n(2803),u=n(25),l=n(2783),f=n(1461),b=n(3237),p=n.n(b),v=Object(r.a)((function(e){s.useEffect(()=>{Object(u.k)("rp-popoutsDebug")||m()},[]);return s.createElement("div",{className:p.a.view},Object(d.a)().state==l.a.Loading?(()=>s.createElement("span",null,s.createElement(f.a,null),e.loadingString))():s.createElement("button",{onClick:m},"Get Data"))}));function m(){Object(c.a)()}function I(e,t,n,o){let i="";if(o)i="readimid/",i+=encodeURIComponent(btoa(o));else{if(i=n?"readconv/":"read/",e&&"GroupMailbox"==e.type){i+="group/";const t=e.mailboxSmtpAddress.split("@");i+=`${t[1]}/${t[0]}/`}i+=encodeURIComponent(n||t)}return i}var O=n(2976);n(3e3);n.d(t,"h",(function(){return h})),n.d(t,"c",(function(){return i.a})),n.d(t,"i",(function(){return a.a})),n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return l.a})),n.d(t,"f",(function(){return d.a})),n.d(t,"d",(function(){return c.b})),n.d(t,"e",(function(){return I})),n.d(t,"g",(function(){return O.a}));const g=new o.c(()=>n.e(808).then(n.bind(null,19794))),h=new o.b(g,e=>e.bootPopout)},2803:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var o=n(2783),i=n(2),a=n(2970),r=n(7);const s={state:o.a.NotStarted,isPopoutV2:Object(r.c)(a.a)==a.b},c=Object(i.createStore)("popoutChild",s);c()},2815:function(e,t,n){"use strict";var o=n(2761);function i(e,t){return{"X-OWA-ExplicitLogonUser":e,"X-AnchorMailbox":t||e}}function a(e,t,n){t&&(e||n)&&Object(o.b)(t,i(e,n))}function r(e,t){var n;const o=null!=t?t:{},i=(null===(n=o.headers)||void 0===n?void 0:n.set)?new Headers(o.headers):new Headers;return o.datapoint=o.datapoint||{},o.datapoint.mailbox=o.datapoint.mailbox||"Explicit",a(e,i),Object.assign(Object.assign({},o),{headers:i})}var s=n(284),c=n(2762),d=n(74),u=n(251),l=n.n(u);async function f(e){return Object(d.b)().then(async t=>{if(e)if(Object(s.r)(e.userIdentity)){const n=await Object(c.a)(e.userIdentity,"GroupMailbox"==e.type||"TeamsMailbox"==e.type?e.mailboxSmtpAddress:null);l()(t,n)}else if("GroupMailbox"==e.type||"TeamsMailbox"==e.type){const n=i(e.mailboxSmtpAddress);l()(t,n)}return t})}function b(){return Object(d.b)().then(e=>(e.prefer='exchange.Behavior="CalendarInternal"',e))}function p(e=null){return Object(s.r)(e)?b().then(t=>{return Object(c.a)(e).then(e=>(Object.keys(e).forEach(n=>t[n]=e[n]),t))}):Promise.resolve({})}var v=n(69);function m(e,t,n,o){let i=new Headers;return n&&i.set("X-OWA-CANARY",Object(v.a)()),t&&i.set("X-OWA-ActionName",t),(e||o)&&(o?a(e,i,o):a(e,i)),i}n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return b})),n.d(t,"f",(function(){return a})),n.d(t,"e",(function(){return m}))},2820:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(20),i=n(2763);n.d(t,"b",(function(){return i.a}));const a=new o.c(()=>n.e(1069).then(n.bind(null,3034))),r=new o.a(a,e=>e.getAndUpdateAccessToken)},2833:function(e,t,n){"use strict";n.d(t,"b",(function(){return i}));var o=n(2);const i=Object(o.createStore)("popoutParent",{projections:[],isAvailable:!1}),a=i();t.a=a},2882:function(e,t,n){"use strict";var o=n(2803),i=n(2),a=n(2783),r=n(2966);t.a=Object(i.mutatorAction)("setPopoutChildState",e=>{const t=Object(o.a)();t.state=e,e==a.a.Ready&&t.isPopoutV2&&window.opener&&Object(r.c)(window.opener,r.a.DeeplinkReady,null)})},2897:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return u}));var o=n(2882),i=n(2966),a=n(2783),r=n(2803);let s,c=!1;function d(){Object(o.a)(a.a.Loading),s?s():c=!0}async function u(e){return c||await new Promise(e=>{s=()=>{e()}}),Object(r.a)().isPopoutV2?new Promise((t,n)=>{let o=n=>{let a=Object(i.b)(n);if(a&&a.type==i.a.SetData){let n;window.removeEventListener("message",o);try{n=e?e(a.serializedData):JSON.parse(a.serializedData)}catch(e){}t(n)}};window.addEventListener("message",o);try{let e=window.opener;Object(i.c)(e,i.a.PopoutReady,null)}catch(e){t(null)}}):Promise.resolve(null)}},2938:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(2815);function i(e,t){return{headers:Object(o.e)(e,"GroupMailbox",!1,t)}}},2962:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(2903);const i=()=>Object(o.a)().smtpAddress},2966:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return s}));const o=2,i=[window.location.origin];var a;function r(e,t,n){let i={version:o,type:t,serializedData:JSON.stringify(n)};e.postMessage(JSON.stringify(i),"*")}function s(e){if(i.indexOf(e.origin)>=0){let t;try{t=JSON.parse(e.data)}catch(e){return null}if(t&&o==t.version)return t}return null}!function(e){e[e.Unknown=0]="Unknown",e[e.PopoutReady=1]="PopoutReady",e[e.SetData=2]="SetData",e[e.CloseWindow=3]="CloseWindow",e[e.DeeplinkReady=4]="DeeplinkReady"}(a||(a={}))},2970:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a}));const o="popoutv2",i="1",a="_owa_projection_root"},2976:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(483);function i(e){const t=e&&e!==window;return Object(o.w)()||t}},2984:function(e,t,n){"use strict";n(2938);var o=n(2878);function i(e){let t=void 0;switch(e){case"None":t=0;break;case"Private":t=1;break;case"Secret":t=2;break;case"Public":t=3}return t}var a=n(2),r=Object(a.action)("EDIT_GROUP_SUCCESS",(e,t)=>({groupSmtp:e,photoUrl:t})),s=Object(a.action)("ADD_GROUP_MEMBER_SUCCESS",e=>({groupSmtp:e})),c=Object(a.action)("MEMBER_MANAGEMENT_SUCCESS",e=>({groupSmtp:e})),d=Object(a.action)("POPUP_OPENED",()=>({isOpen:!0})),u=Object(a.action)("POPUP_CLOSED",()=>({isOpen:!1})),l=Object(a.action)("DELETE_GROUP_SUCCESS",e=>({groupSmtp:e})),f=Object(a.action)("EDIT_GROUP_SMTP_SUCCESS",(e,t,n,o)=>({aadObjectId:e,groupSmtp:t,photoUrl:n,oldGroupSmtp:o})),b=n(2920);n.d(t,"n",(function(){return o.a})),n.d(t,"o",(function(){return i})),n.d(t,"m",(function(){return r})),n.d(t,"j",(function(){return s})),n.d(t,"p",(function(){return c})),n.d(t,"r",(function(){return d})),n.d(t,"q",(function(){return u})),n.d(t,"k",(function(){return l})),n.d(t,"l",(function(){return f})),n.d(t,"g",(function(){return b.g})),n.d(t,"c",(function(){return b.c})),n.d(t,"d",(function(){return b.d})),n.d(t,"a",(function(){return b.a})),n.d(t,"e",(function(){return b.e})),n.d(t,"f",(function(){return b.f})),n.d(t,"i",(function(){return b.i})),n.d(t,"b",(function(){return b.b})),n.d(t,"h",(function(){return b.h}))},3e3:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(2833);function i(e){return Object(o.b)().projections.filter(t=>t.tabId==e)[0]}},3002:function(e,t,n){"use strict";var o=n(107);const i=600,a=800,r=8,s=25,c={location:!1,menubar:!1,resizable:!0,scrollbars:!1,status:!1,toolbar:!1};let d=-1;function u(e,t,n){try{t=function(e){const t=(d=(d+1)%r,s*(d+1)),n={left:window.screenX+t,top:window.screenY+t,height:Math.max(25*Math.pow(window.innerHeight,.5),i),width:Math.max(8*Math.pow(window.innerWidth,2/3),a)};return Object.assign(Object.assign(Object.assign({},c),n),e)}(t);const u=(n||window).open(e,"_blank",function(e){return Object.getOwnPropertyNames(e).map(t=>`${t}=${function(e){return"boolean"==typeof e?e?"1":"0":e?String(e):void 0}(e[t])}`).join(",")}(t));return(Object(o.e)()||Object(o.f)())&&u.moveTo(t.left,t.top),u}catch(e){return null}}var l=n(2833);var f=n(3162),b=n(154);const p="about:blank";var v=n(3205),m=n(2802),I=n(68);t.a=Object(I.s)({name:"PopoutAddPopout",customData:(e,t,n,o,i,a)=>[(t||"").split("/")[0],a]},(function(e,t,n,o,i,a,r){const{deeplinkCallback:s,projectionTabId:c,projectionTargetWindow:d,projectionParentWindow:O}=function(e){let t=null,n=void 0,o=null,i=null;return e&&(!function(e){return void 0!==e.deeplinkData||!!e.projectionTabId}(e)?n=e:(n=e.deeplinkData,Object(l.b)().isAvailable&&(t=e.projectionTabId||null),o=e.projectionTargetWindow,i=e.projectionParentWindow)),{deeplinkCallback:void 0===n?()=>Promise.resolve(null):"function"==typeof n?n:()=>Promise.resolve(n),projectionTabId:t,projectionTargetWindow:o,projectionParentWindow:i}}(n),g=!!c,h=new I.b(g?"PopoutProjectionPerf":"PopoutDeeplinkPerf"),w=g?function(e){return Object(b.a)("projectionCustomTitlebar")?`${p}?windowId=${e}`:p}(c):Object(f.a)(e,t,{skipOptinCheck:i,urlParameters:r}),j=d||u(w,o,O);g&&Object(v.a)(c),j&&m.h.import().then(t=>t(e,j,c,s,h))}))},3154:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(2833);function i(e){var t;return null===(t=o.a.projections)||void 0===t?void 0:t.filter(t=>t.tabId==e||t.window==e)[0]}},3162:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var o=n(3),i=n(483),a=n(2970);const r="version";function s(e,t,n={}){const s=n.isStandalone?{}:{[a.a]:a.b,[r]:Object(o.u)()},c=n.urlParameters||{};return Object.keys(c).map(e=>{s[e]=c[e]}),Object(i.q)(e,t,n.skipOptinCheck,s)}},3205:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));const o=[],i=e=>{for(const t of o)t(e)},a=e=>{o.push(e)}},3237:function(e,t,n){var o=n(3238);"string"==typeof o&&(o=[[e.i,o,""]]);var i={transform:void 0};n(84)(o,i);o.locals&&(e.exports=o.locals)},3238:function(e,t,n){(t=e.exports=n(83)(!1)).push([e.i,"._1tEqC8ReEuQpGl5mN4N5V6{width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}",""]),t.locals={view:"_1tEqC8ReEuQpGl5mN4N5V6"}},3325:function(e,t,n){"use strict";var o=n(20);function i(e,t){const n=new o.b(e,e=>e[t]);return(...e)=>n.import().then(t=>t(...e))}n.d(t,"e",(function(){return a})),n.d(t,"i",(function(){return r})),n.d(t,"h",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"k",(function(){return d})),n.d(t,"c",(function(){return u})),n.d(t,"l",(function(){return l})),n.d(t,"d",(function(){return f})),n.d(t,"f",(function(){return b})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return v})),n.d(t,"j",(function(){return m}));const a=new o.c(()=>Promise.all([n.e(0),n.e(4),n.e(5),n.e(6),n.e(7),n.e(9),n.e(13),n.e(15),n.e(23),n.e(19),n.e(26),n.e(29),n.e(31),n.e(36),n.e(35),n.e(41),n.e(50),n.e(57),n.e(59),n.e(60),n.e(62),n.e(73),n.e(90),n.e(116),n.e(484)]).then(n.bind(null,19797))),r=i(a,"send"),s=i(a,"save"),c=i(a,"runPostOpenTasks"),d=i(a,"switchBodyType"),u=i(a,"discard"),l=i(a,"upConvert"),f=i(a,"insertSignature"),b=i(a,"popoutCompose"),p=i(a,"createAttachments"),v=i(a,"clickAttachButton"),m=i(a,"showMessageOptionsDialog")},3489:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));var o=n(20);const i=new o.c(()=>Promise.all([n.e(25),n.e(27),n.e(37),n.e(737)]).then(n.bind(null,5081))),a=new o.a(i,e=>e.loadAndInitializeFloodgateEngine),r=new o.b(i,e=>e.logFloodgateActivity)},3498:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var o=n(30),i=n(25);function a(){var e;return(null===(e=Object(o.a)().UserOptions)||void 0===e?void 0:e.SendFromAliasEnabled)&&Object(i.k)("cmp-proxy-address")}},3600:function(e,t,n){"use strict";var o,i;n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i})),function(e){e.Unknown="Unknown",e.Like="Like",e.AtMention="AtMention",e.GroupMention="GroupMention",e.MeMention="MeMention",e.FileMention="FileMention",e.GroupAtAllMention="GroupAtAllMention",e.TxpRentalCarReservation="TxpRentalCarReservation",e.TxpFlightReservation="TxpFlightReservation",e.TxpLodgingReservation="TxpLodgingReservation",e.TxpFoodEstablishmentReservation="TxpFoodEstablishmentReservation",e.TxpEventReservation="TxpEventReservation",e.TxpParcelDelivery="TxpParcelDelivery",e.TxpInvoice="TxpInvoice",e.TxpServiceReservation="TxpServiceReservation",e.UserAtMentioned="UserAtMentioned",e.TaskNotificationInsight="TaskNotificationInsight",e.FollowUpNotificationInsight="FollowUpNotificationInsight",e.OutOfRoutineNotificationInsight="OutOfRoutineNotificationInsight",e.RealTimeFlightUpdate="RealTimeFlightUpdate",e.YammerLiveEventNotification="YammerLiveEventNotification",e.Reactions="Reactions",e.CommentCreated="CommentCreated",e.TaskCreated="TaskCreated",e.TaskCompleted="TaskCompleted",e.TaskReassigned="TaskReassigned",e.TaskReopened="TaskReopened",e.PromptAction="PromptAction"}(o||(o={})),function(e){e[e.None=0]="None",e[e.IsDismissed=1]="IsDismissed",e[e.IsSeen=2]="IsSeen",e[e.IsRead=4]="IsRead",e[e.IsCompleted=8]="IsCompleted",e[e.IsFlagged=16]="IsFlagged"}(i||(i={}))},3703:function(e,t,n){"use strict";var o=n(2);const i=Object(o.action)("OnComposeLifecycleEvent",(e,t)=>({viewState:e,event:t}));t.a=i},3902:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"f",(function(){return d})),n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return l})),n.d(t,"e",(function(){return f})),n.d(t,"c",(function(){return b})),n.d(t,"g",(function(){return p}));var o=n(3217),i=n(20);const a=new i.c(()=>Promise.all([n.e(1),n.e(2),n.e(3),n.e(5),n.e(11),n.e(15),n.e(28),n.e(34),n.e(39),n.e(51),n.e(58),n.e(66),n.e(190),n.e(247),n.e(443)]).then(n.bind(null,5268)));Object(i.f)(o.d,a,e=>e.openTimePanelOrchestrator);const r=Object(i.d)(a,e=>e.TimePanel),s=Object(i.d)(a,e=>e.TimePanelHeaderBar),c=new i.a(a,e=>e.loadTimePanelData),d=new i.a(a,e=>e.openEventDetailsView),u=(new i.a(a,e=>e.openAttendeeTrackingView),new i.a(a,e=>e.closeAttendeeTrackingView),new i.a(a,e=>e.openTasksView)),l=new i.a(a,e=>e.openCalendarView),f=new i.a(a,e=>e.openConflictsView),b=new i.a(a,e=>e.closeConflictsView),p=new i.a(a,e=>e.openEventQuickComposeView)},4241:function(e,t,n){"use strict";var o=n(20),i=n(4781);function a(e){var t;return null===(t=i.a.usageSuggestions)||void 0===t?void 0:t.get(e)}n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return a}));const r=new o.c(()=>n.e(1367).then(n.bind(null,19854)));let s=new o.a(r,e=>e.initializePersonalizationSuggestions),c=(new o.a(r,e=>e.postPersonalizationSuggestionFeedback),new o.a(r,e=>e.postPersonalizationUsageSignals))},4273:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(2);let i=Object(o.action)("saveReadingPanePositionOption")},4499:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var o=n(154),i=n(25);function a(){return Object(i.k)("mon-rp-unstackedConversation")&&Object(i.k)("mon-conv-useHx")&&Object(o.a)("native")}},4532:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"e",(function(){return d})),n.d(t,"f",(function(){return u}));var o=n(20),i=n(3600);n.d(t,"c",(function(){return i.b}));const a=new o.c(()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(5),n.e(9),n.e(11),n.e(13),n.e(149),n.e(176),n.e(192),n.e(198),n.e(301),n.e(885)]).then(n.bind(null,6459)));let r=Object(o.d)(a,e=>e.ActivityFeed),s=new o.a(a,e=>e.initializeActivityFeed),c=Object(o.d)(a,e=>e.ActivityFeedTitle),d=new o.a(a,e=>e.postWeveSignal),u=new o.a(a,e=>e.loadActivityFeed)},4781:function(e,t,n){"use strict";var o=n(13),i=n(2);const a={usageSuggestions:new o.ObservableMap},r=Object(i.createStore)("personalization",a)();t.a=r},4810:function(e,t,n){"use strict";var o=n(20),i=n(2),a=n(4273);const r=new o.c(()=>n.e(1220).then(n.bind(null,19528)));new o.a(r,e=>e.saveReadingPaneOptionQuick);var s=n(3447),c=n(3304),d=n(3323),u=n(3286),l=n(358),f=n(2788),b=Object(l.action)("onPrintRow")((function(){Object(f.d)()&&(Object(u.a)(!0),Object(d.a)(!1))})),p=Object(l.action)("onNewMessage")((function(e){e||(Object(u.a)(!0),Object(d.a)(!Object(f.d)()))})),v=n(4854);n.d(t,"b",(function(){return I})),n.d(t,"c",(function(){return g})),n.d(t,"f",(function(){return h})),n.d(t,"e",(function(){return b})),n.d(t,"d",(function(){return p})),n.d(t,"a",(function(){return v.a}));const m=new o.c(()=>Promise.all([n.e(63),n.e(62),n.e(764)]).then(n.bind(null,19879)));let I=new o.a(m,e=>e.onReplyOrReplyAllOrForwardMessage),O=(new o.b(m,e=>e.onSxSPreviewPaneClose),new o.a(m,e=>e.onReadingPanePositionOptionSaved)),g=new o.a(m,e=>e.onSelectMessageAd);function h(){Object(i.orchestrator)(a.a,()=>{O.importAndExecute()})}Object(o.f)(s.a,m,e=>e.onClientReadingPanePositionChangeOrchestrator),Object(o.f)(c.a,m,e=>e.closeImmersiveReadingPaneOrchestrator)},4854:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(2);let i=Object(o.action)("exitSearch",e=>({actionSource:e}))},5083:function(e,t,n){"use strict";var o=n(2742),i=n(6287);function a(e,t){if(!t||!e)return;const n=t.internetMessageId,a=t.parentInternetMessageId,r=o.u.items.get(t.itemIds[0]),s=null==r?void 0:r.ItemClass,c=!!s&&i.a.test(s);e.set(n,{itemIds:t.itemIds,parentImId:c?void 0:a,visited:!1})}function r(e,t){var n;if(e)for(let i=0;i<e.length;i++)if(t){const a=Object(o.v)(e[i]);if((null===(n=null==a?void 0:a.ParentFolderId)||void 0===n?void 0:n.Id)==t)return e[i]}return null}var s=n(22);var c=n(3203),d=n(168);let u,l,f,b;function p(){return l}async function v(e,t){return f!=e?(l=null,u=[],f=e,b=async function(e,t){var n;await async function(e){var t,n,i;let a=null===(t=o.u.conversations)||void 0===t?void 0:t.get(e);for(;(!a||0==(null===(n=null==a?void 0:a.conversationNodeIds)||void 0===n?void 0:n.length)||(null==a?void 0:a.canLoadMoreForRelationMap))&&(a&&(a.isLoadMoreInProgress=!0,a.maxItemsToReturn=c.b,a.syncState=""),await c.e.importAndExecute({Id:e,mailboxInfo:Object(d.d)()},"CreateConversationRelationMap"),a||(a=null===(i=o.u.conversations)||void 0===i?void 0:i.get(e),a)););}(e);const i=null===(n=o.u.conversations)||void 0===n?void 0:n.get(e);if(!i)return s.h.warn("getForksList: conversation not found in mailStore. ConversationId: "+e),f="",Promise.reject([]);const b=i?i.conversationNodeIds:[],p=null==b?void 0:b.length;if(!p||0==p)return s.h.warn("getForksList: No nodeIds found in conversation. ConversationId: "+e),f="",Promise.reject([]);const v=[...b],m="ChronologicalNewestOnBottom"===(null==i?void 0:i.conversationSortOrder),I=[];[...b].forEach(e=>{const t=o.u.conversationNodes.get(e);t&&I.push(t.internetMessageId)}),m?I.reverse():v.reverse();return l=function(e){const t=o.u.conversationNodes.get(e[0]),n=new Map;t&&n.set(t.internetMessageId,{itemIds:t.itemIds,visited:!1});let i=1;const r=e.length;for(;i<r;){a(n,o.u.conversationNodes.get(e[i])),i+=1}return n}(v),u=function(e,t,n){const o=[];if(!t)return s.h.warn("getForksFromConversationRelationMap: conversationRelationMap not found"),[];for(;e.length>0;){const i=e.shift(),a=[],s=i?t.get(i):void 0;if(s){const i=r(s.itemIds,n);i&&a.push(i),s.visited=!0;let c=s.parentImId;for(;c;){const o=e.indexOf(c);o>-1&&e.splice(o,1);const i=t.get(c);if(i){if(i.visited)break;let e=r(i.itemIds,n);e&&a.push(e),i.visited=!0,c=i.parentImId}else c=void 0}a.length>0&&o.push(a)}}return o}(I,l,t),Promise.resolve(u)}(e,t).then(()=>Promise.resolve(u),()=>Promise.resolve(u)),b):null==l?b:Promise.resolve(u)}n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return v}))},5237:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(25);function i(){return Object(o.k)("mon-rp-unstackedConversation")}},5927:function(e){e.exports=JSON.parse('{"e":"v6a","a":"w6a","s":"y6a","u":"z6a","H":"B6a","A":"C6a","r":"D6a","l":"E6a","C":"F6a","B":"G6a","h":"H6a","t":"I6a","m":"J6a","D":"K6a","k":"L6a","g":"M6a","q":"N6a","f":"O6a","d":"P6a","b":"Q6a","c":"R6a","y":"S6a","z":"T6a","w":"U6a","x":"V6a","v":"W6a","p":"X6a","o":"Y6a","n":"Z6a","G":"_6a","F":"$6a","E":"a7a","j":"b7a","i":"c7a"}')},62:function(e,t,n){"use strict";var o,i,a,r;n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s})),function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday"}(o||(o={})),function(e){e[e.January=0]="January",e[e.February=1]="February",e[e.March=2]="March",e[e.April=3]="April",e[e.May=4]="May",e[e.June=5]="June",e[e.July=6]="July",e[e.August=7]="August",e[e.September=8]="September",e[e.October=9]="October",e[e.November=10]="November",e[e.December=11]="December"}(i||(i={})),function(e){e[e.FirstDay=0]="FirstDay",e[e.FirstFullWeek=1]="FirstFullWeek",e[e.FirstFourDayWeek=2]="FirstFourDayWeek"}(a||(a={})),function(e){e[e.Day=0]="Day",e[e.Week=1]="Week",e[e.Month=2]="Month",e[e.WorkWeek=3]="WorkWeek"}(r||(r={}));var s=7},6291:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(2740);function i(e){const t=o.a.conversations.get(e);return null==t?void 0:t.canLoadMore}},6490:function(e,t,n){"use strict";var o=n(2);const i=Object(o.action)("EXPAND_ROW_FIRST_LEVEL",(e,t)=>({rowKey:e,forks:t})),a=Object(o.action)("REMOVE_FORKS_STORE_UPDATE",(e,t)=>({forks:e,itemIdsToRemove:t}));var r=n(2733),s=n(6757);Object(o.mutator)(i,e=>{Object(s.a)();const t=r.Z.expandedConversationViewState;t.forks=e.forks,t.expandedRowKey=e.rowKey}),Object(o.mutator)(a,e=>{const{itemIdsToRemove:t,forks:n}=e;if(n){const e=n.map(e=>e.id);for(const o of t){const t=e.indexOf(o);e.splice(t,1),n.splice(t,1)}r.Z.expandedConversationViewState.forks=[...n]}});var c=n(20),d=n(5083);n(4499),n(5237);n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return d.b}));const u=new c.c(()=>n.e(2185).then(n.bind(null,20205))),l=new c.a(u,e=>e.getIdsForTriageActions)},6523:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));var o=n(20);const i=new o.c(()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(5),n.e(11),n.e(18),n.e(21),n.e(19),n.e(24),n.e(27),n.e(28),n.e(34),n.e(39),n.e(37),n.e(56),n.e(55),n.e(48),n.e(58),n.e(66),n.e(94),n.e(176),n.e(169),n.e(198),n.e(497)]).then(n.bind(null,9016))),a=Object(o.d)(i,e=>e.NotificationPane),r=new o.b(i,e=>e.onDismissAutomaticReplyNotification)},6757:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var o=n(2733),i=n(13);function a(){const e=o.Z.expandedConversationViewState;e.expandedRowKey=null,e.focusedNodeId=null,e.selectedNodeIds=[],e.allNodeIds=[],e.shouldBeExpanded=!1,e.busStopStateMap=new i.ObservableMap({}),e.forks=null}},6761:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var o=n(4578),i=n(66),a=n(2),r=n(4922);const s=Object(a.action)("expandCollapsedItemsRollUp",(e,t=!1)=>Object(i.b)({name:"RPCountExpCollItemsRollUp",customData:[Object(o.b)(Object(r.a)(e)),t]},{viewState:e}));Object(a.mutator)(s,({viewState:e})=>{e.conversationNodeIdsInCollapsedItemsRollUp=[]})},6999:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(3083);function i(e){e?Object(o.q)(e,"Route"):Object(o.o)("Route")}},7323:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var o=n(2892),i=n(2733),a=n(2978),r=n(2808);function s(e){const t=Object(a.a)(),n=Object(i.F)([e],t)[0];t.rowKeys.includes(n)&&Object(o.q)(t,n,!0,r.a.RouteHandler)}},7326:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(2740);function i(e){var t,n;const i=null===(n=null===(t=o.a.conversations)||void 0===t?void 0:t.get(e))||void 0===n?void 0:n.conversationNodeIds;return(null==i?void 0:i.length)>0}},7783:function(e,t,n){"use strict";var o=n(6761),i=n(4578),a=n(2913),r=n(4922),s=n(68),c=n(3203),d=n(2740),u=n(4745),l=n(2);t.a=Object(s.s)(i.a.RPCountLoadMore,(function(e){if(e&&d.a.conversations.has(e.Id)){f(e);const t=Object(s.r)();t&&t.addCustomData([b(d.a.conversations.get(e.Id).maxItemsToReturn)]);const n=Object(a.a)(e.Id);return Object(r.b)(n)&&Object(o.a)(n,!0),c.e.importAndExecute(e,"LoadMore")}return Promise.resolve()}));const f=Object(l.mutatorAction)("updateConversationItemParts",e=>{const t=d.a.conversations.get(e.Id);t.isLoadMoreInProgress=!0,t.maxItemsToReturn=t.maxItemsToReturn+c.a,t.syncState=""});function b(e){const t=Math.ceil((e-20)/10);return Object(u.a)(t)}},91:function(e,t,n){"use strict";var o=n(62);let i={MillisecondsInOneDay:864e5,MillisecondsIn1Sec:1e3,MillisecondsIn1Min:6e4,MillisecondsIn15Mins:9e5,MillisecondsIn20Mins:12e5,MillisecondsIn22Mins:132e4,MillisecondsIn24Mins:144e4,MillisecondsIn30Mins:18e5,MillisecondsIn1Hour:36e5,MinutesInOneDay:1440,MinutesInOneHour:60,SecondsInOneMinute:60,DaysInOneWeek:7,AllDaysOfWeek:[o.c.Sunday,o.c.Monday,o.c.Tuesday,o.c.Wednesday,o.c.Thursday,o.c.Friday,o.c.Saturday]};t.a=i},9574:function(e,t,n){"use strict";var o=n(2);t.a=Object(o.action)("UPDATE_LOADED_CONVERSATION_READING_PANE",(e,t)=>({conversationId:e,nodeIdCollectionChanged:t}))},9577:function(e,t,n){"use strict";var o=n(5764),i=n(5469),a=n(6105),r=n(2919),s=n(2850),c=n(3468),d=n(2791),u=n(358),l=n(2733);t.a=Object(u.action)("reloadReadingPane")((function(e={composeViewState:s.a.viewStates.get(s.a.primaryComposeId),conversationItems:l.Z.conversationItems}){var t,n;const u=Object(l.I)(),f=u?[...u.selectedRowKeys.keys()]:[];if(1==f.length){const s=l.b.getRowIdToShowInReadingPane(f[0],u),b=Object(c.a)(f,u)[0],p=u.tableQuery.listViewType;if(1===p||Object(d.a)())(null===(t=e.composeViewState)||void 0===t?void 0:t.isInlineCompose)?r.p.importAndExecute(e.composeViewState).then(()=>{Object(i.a)(s,b,a.a)}):Object(i.a)(s,b,a.a);else if(0===p){const t=e.conversationItems.get(s.Id);(null===(n=e.composeViewState)||void 0===n?void 0:n.isInlineCompose)?r.p.importAndExecute(e.composeViewState).then(()=>{Object(o.b)(s,b,t.subject)}):Object(o.b)(s,b,t.subject)}}}))},9601:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(2),i=n(5927),a=n(6);let r=Object(o.action)("ADD_FIRST_EVENT",()=>({taskNewEventTitle:Object(a.b)(i.q)}))},9603:function(e,t,n){"use strict";var o=n(2);t.a=Object(o.action)("ON_KEYBOARD_UP_DOWN",(e,t,n,o)=>({selectionDirection:e,tableView:t,mailListItemSelectionSource:n,shouldSelect:o}))},9604:function(e,t,n){"use strict";var o=n(2);t.a=Object(o.action)("ON_KEYBOARD_TOGGLE_SELECT",(e,t)=>({tableView:e,mailListItemSelectionSource:t}))},9605:function(e,t,n){"use strict";var o=n(2);t.a=Object(o.action)("ON_KEYBOARD_UP_DOWN",(e,t,n,o)=>({tableView:e,selectedNodeIds:t,selectedRowKeys:n,mailListItemSelectionSource:o}))}}]);
//# sourceMappingURL=owa.MailBoot~MailFunctionalBoot.js.map
self.scriptsLoaded['owa.MailBoot~MailFunctionalBoot.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~MailFunctionalBoot.js'] = (new Date()).getTime();