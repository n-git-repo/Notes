self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.39.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[39],{1130:function(r,c,t){"use strict";t.d(c,"a",(function(){return a})),t.d(c,"d",(function(){return _})),t.d(c,"b",(function(){return n})),t.d(c,"c",(function(){return s}));var e=t(943);function a(r){var c;let t=!1;return r.DisplayName&&(t=(null===(c=n(r.DisplayName))||void 0===c?void 0:c.length)>0),!Object(e.r)(r.PostalAddress)&&t}function _(r){return function(){const c=/^http*/i.test(r)?r:"//"+r;window.open(c,"_blank")}}function n(r){var c;return null===(c=r.match(/\S+/g))||void 0===c?void 0:c.filter(r=>s(r))}function s(r){return/^((http[s]?:\/\/)|(www\.)?){1}[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,6}\b([-a-zA-Z0-9@:*%_\+.~#?&//=]*)/i.test(r)}},1134:function(r,c,t){"use strict";function e(r){return!!r&&(!!r.LocationUri||!(!r.Latitude||!r.Longitude))}t.d(c,"a",(function(){return e}))},607:function(r,c,t){"use strict";t.d(c,"a",(function(){return a}));var e=t(1134);function a(r){return Object(e.a)(r)&&"Resource"===r.LocationSource}},727:function(r,c,t){"use strict";var e=t(6),a=t(242);const _="en-us",n={"am-et":"a_c_pc_pr_ctry","ar-dz":"a_pc_c_pr_ctry","ar-bh":"a_pc_c_pr_ctry","ar-eg":"a_ctry_c_pr_pc","ar-iq":"a_pc_c_pr_ctry","ar-jo":"a_c_pc_pr_ctry","ar-kw":"a_pc_c_pr_ctry","ar-lb":"a_c_pc_pr_ctry","ar-ly":"a_pc_c_pr_ctry","ar-ma":"a_pc_c_pr_ctry","ar-om":"a_c_pr_ctry_pc","ar-qa":"a_pc_c_pr_ctry","ar-sa":"a_c_pc_pr_ctry","ar-sy":"a_pc_c_pr_ctry","ar-tn":"a_pc_c_pr_ctry","ar-ae":"a_pc_c_pr_ctry","ar-ye":"a_pc_c_pr_ctry","eu-es":"a_pc_c_pr_ctry","bn-in":"a_c_pc_pr_ctry","bg-bg":"a_pc_c_pr_ctry","ca-es":"a_pc_c_pr_ctry","zh-cn":"pc_ctry_pr_c_a","zh-sg":"a_c_pc_pr_ctry","zh-hk":"ctry_pc_pr_c_a","zh-mo":"ctry_pr_c_pc_a","zh-tw":"pc_ctry_pr_c_a","hr-hr":"a_pc_c_pr_ctry","cs-cz":"a_pc_c_pr_ctry","da-dk":"a_pc_c_pr_ctry","nl-be":"a_pc_c_pr_ctry","nl-nl":"a_pc_c_pr_ctry","en-au":"a_c_pc_pr_ctry","en-bz":"a_pc_c_pr_ctry","en-ca":"a_c_pc_pr_ctry","en-ie":"a_c_pc_pr_ctry","en-jm":"a_pc_c_pr_ctry","en-nz":"a_c_pc_pr_ctry","en-ph":"a_pc_pr_c_ctry","en-za":"a_c_pc_pr_ctry","en-tt":"a_pc_c_pr_ctry","en-gb":"a_c_pc_pr_ctry","en-us":"a_c_pr_pc_ctry","en-zw":"a_pc_c_pr_ctry","et-ee":"a_pc_c_pr_ctry","fil-ph":"a_pc_pr_c_ctry","fi-fi":"a_pc_c_pr_ctry","fr-be":"a_pc_c_pr_ctry","fr-ca":"a_c_pc_pr_ctry","fr-fr":"a_pc_c_pr_ctry","fr-lu":"a_pc_c_pr_ctry","fr-mc":"a_pc_c_pr_ctry","fr-ch":"a_pc_c_pr_ctry","gl-es":"a_pc_c_pr_ctry","de-at":"a_pc_c_pr_ctry","de-de":"a_pc_c_pr_ctry","de-li":"a_pc_c_pr_ctry","de-lu":"a_pc_c_pr_ctry","de-ch":"a_pc_c_pr_ctry","el-gr":"a_pc_c_pr_ctry","gu-in":"a_c_pc_pr_ctry","he-il":"a_pc_c_pr_ctry","hi-in":"a_c_pc_pr_ctry","hu-hu":"c_a_pc_pr_ctry","is-is":"a_pc_c_pr_ctry","id-id":"a_c_pc_pr_ctry","it-it":"a_pc_c_pr_ctry","it-ch":"a_pc_c_pr_ctry","ja-jp":"pc_pr_c_a_ctry","kn-in":"a_c_pc_pr_ctry","kk-kz":"ctry_pr_c_pc_a","ko-kr":"pc_pr_c_a_ctry","lv-lv":"a_c_pc_pr_ctry","lt-lt":"a_c_pc_pr_ctry","ms-bn":"a_c_pc_pr_ctry","ms-my":"a_pc_c_pr_ctry","ml-in":"a_c_pc_pr_ctry","mr-in":"a_c_pc_pr_ctry","nb-no":"a_pc_c_pr_ctry","or-in":"a_c_pc_pr_ctry","fa-ir":"a_c_pc_pr_ctry","pl-pl":"a_pc_c_pr_ctry","pt-br":"a_pc_c_pr_ctry","pt-pt":"a_pc_c_pr_ctry","ro-ro":"a_pc_c_pr_ctry","ru-ru":"ctry_pc_pr_c_a","sr-cyrl-cs":"a_pc_c_pr_ctry","sk-sk":"a_pc_c_pr_ctry","sl-si":"a_pc_c_pr_ctry","es-ar":"a_pc_c_pr_ctry","es-bo":"a_pc_c_pr_ctry","es-cl":"a_pc_c_pr_ctry","es-co":"a_pc_c_pr_ctry","es-cr":"a_pc_c_pr_ctry","es-do":"a_pc_c_pr_ctry","es-ec":"a_pc_c_pr_ctry","es-sv":"a_c_pc_pr_ctry","es-gt":"a_pc_c_pr_ctry","es-hn":"a_pc_c_pr_ctry","es-mx":"a_pc_c_pr_ctry","es-ni":"a_c_pc_pr_ctry","es-pa":"a_pc_c_pr_ctry","es-py":"a_pc_c_pr_ctry","es-pe":"a_pc_c_pr_ctry","es-pr":"a_c_pc_pr_ctry","es-es":"a_pc_c_pr_ctry","es-us":"a_c_pc_pr_ctry","es-uy":"a_pc_c_pr_ctry","es-ve":"a_pc_c_pr_ctry","sv-fi":"a_pc_c_pr_ctry","sv-se":"a_pc_c_pr_ctry","ta-in":"a_c_pc_pr_ctry","te-in":"a_c_pc_pr_ctry","th-th":"a_c_pc_pr_ctry","tr-tr":"a_pc_pr_c_ctry","uk-ua":"ctry_pc_pr_c_a","ur-pk":"a_c_pc_pr_ctry","cy-gb":"a_c_pc_pr_ctry"};const s=", ";function o(r,c,t,e,_,n){let s=[];Object(a.a)(r)||(s[s.length]=r);let o="";return Object(a.a)(c)||(o=c),Object(a.a)(t)||(o=Object(a.a)(o)?t:o+n+t),Object(a.a)(e)||(o=Object(a.a)(o)?e:o+n+e),Object(a.a)(o)||(s[s.length]=o),Object(a.a)(_)||(s[s.length]=_),s}function p(r,c,t,p,i){let l="",u=function(){let r="";Object(a.a)(Object(e.e)())||(r=Object(e.e)());let c=n[r];return null==c&&(c=n[_]),c}(),d=[],y=s;switch(u){case"a_c_pc_pr_ctry":d=o(r,c,t,p,i,y);break;case"a_c_pr_ctry_pc":d=o(r,c,p,i,t,y);break;case"a_c_pr_pc_ctry":d=o(r,c,p,t,i,y);break;case"a_ctry_c_pr_pc":d=o(r,i,c,p,t,y);break;case"a_pc_c_pr_ctry":d=o(r,t,c,p,i,y);break;case"a_pc_pr_c_ctry":d=o(r,t,p,c,i,y);break;case"c_a_pc_pr_ctry":d=o(c,r,t,p,i,y);break;case"ctry_pc_pr_c_a":d=o(i,t,p,c,r,y);break;case"ctry_pr_c_pc_a":d=o(i,p,c,t,r,y);break;case"pc_ctry_pr_c_a":d=o(t,i,p,c,r,y);break;case"pc_pr_c_a_ctry":d=o(t,p,c,r,i,y)}return l=d.join(y),l}function i(r){return r?p(r.Street,r.City,r.PostalCode,r.State,r.Country):""}function l(r,c){return Object(a.a)(r)?i(c):r}function u(r,c,t){const _=i(c);return Object(a.a)(r)?_:""==_||t?r:Object(e.c)("{0} ({1})",r,_)}t.d(c,"a",(function(){return i})),t.d(c,"b",(function(){return p})),t.d(c,"c",(function(){return l})),t.d(c,"d",(function(){return u}))},894:function(r,c,t){"use strict";t.d(c,"d",(function(){return a})),t.d(c,"a",(function(){return n})),t.d(c,"c",(function(){return s})),t.d(c,"b",(function(){return o}));var e=t(607);function a(r,c){if(null==r&&null!=c||null!=r&&null==c)return!1;if(null==r&&null==c)return!0;if(0==r.length&&0==c.length)return!0;if(r.length!=c.length)return!1;let t=0;for(;t<r.length;){if(!_(r[t],c[t]))return!1;t++}return!0}function _(r,c){return!(!r&&c||r&&!c)&&(r.Id===c.Id||Object(e.a)(r.PostalAddress)&&Object(e.a)(c.PostalAddress)&&r.PostalAddress.LocationUri.toLowerCase()===c.PostalAddress.LocationUri.toLowerCase())}function n(r,c){return r&&Object(e.a)(c.PostalAddress)?s(r,c.PostalAddress.LocationUri):o(r,c.Id)}function s(r,c){return!!(c&&r&&r.some(r=>Object(e.a)(r.PostalAddress)&&r.PostalAddress.LocationUri.toLowerCase()===c.toLowerCase()))}function o(r,c){return r&&r.some(r=>r.Id===c)}},943:function(r,c,t){"use strict";var e=t(0),a=t(21),_=Object(a.a)((function(r){return e.createElement(e.Fragment,null,r.location)}));const n=/\(([^)]*)\)/gi,s=/\([^)]*\)|[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/gi,o=/\s+/gi;function p(r){let c="";if(!r)return c;let t=(r=(r=(r=(r=r.replace(n,"")).replace(s,"")).replace(o," ")).trim()).split(" ");return t.length>=2?(c+=t[0].charAt(0).toUpperCase(),c+=t[t.length-1].charAt(0).toUpperCase()):0!=t.length&&(c+=t[0].charAt(0).toUpperCase()),c}var i=t(48);const l=Object.keys(i.a).length/2;function u(r){if(!r)return null;let c=0;for(let e=r.length-1;e>=0;e--){let a=r.charCodeAt(e);var t=e%8;c^=(a<<t)+(a>>8-t)}return c%l}function d(r){return{personaId:r,displayName:r,postalAddress:{Type:"Business",LocationSource:"None"},displayAddress:"",initials:p(r),textBoyColor:u(r),selectionSource:"ExplicitTyping",personaType:"Unknown",personaControlId:r}}var y=t(727);var f=t(242);function b(r){var c;if(r){let t=function(r){return r?null!=r.HomeAddressesArray&&r.HomeAddressesArray.length>0?r.HomeAddressesArray[0].Value:null!=r.BusinessAddressesArray&&r.BusinessAddressesArray.length>0?r.BusinessAddressesArray[0].Value:null!=r.OtherAddressesArray&&r.OtherAddressesArray.length>0?r.OtherAddressesArray[0].Value:null:null}(r),e=Object(y.c)(r.DisplayName,t);return"Room"==r.PersonaTypeString&&(t.LocationUri=r.EmailAddress.EmailAddress),{personaId:null===(c=r.PersonaId)||void 0===c?void 0:c.Id,feedbackId:r.FeedbackId,displayName:e,postalAddress:t,emailAddress:r.EmailAddress,displayAddress:Object(y.a)(t),initials:p(e),textBoyColor:u(e),selectionSource:"LocationWell",personaType:Object(f.a)(r.PersonaTypeString)?"Unknown":r.PersonaTypeString,personaControlId:null==r.PersonaId?r.FeedbackId:r.PersonaId.Id,availability:r.Availability,numberOfAvailableTimeSlots:r.NumberOfAvailableTimeSlots,totalNumberOfTimeSlots:r.TotalNumberOfTimeSlots,isPartialAvailability:r.IsPartialAvailability,capacity:r.Capacity,entityType:r.EntityType,audioDeviceName:r.AudioDeviceName,displayDeviceName:r.DisplayDeviceName,videoDeviceName:r.VideoDeviceName,isWheelChairAccessible:r.IsWheelChairAccessible}}return null}var m=t(607);function A(r){if((null==r?void 0:r.DisplayName)&&r.PostalAddress){let c=Object(y.c)(r.DisplayName,r.PostalAddress),t=Object(m.a)(r.PostalAddress)&&!Object(f.a)(r.PostalAddress.LocationUri)?{EmailAddress:r.PostalAddress.LocationUri}:null;return{personaId:r.Id,displayName:r.DisplayName,postalAddress:r.PostalAddress,emailAddress:t,displayAddress:Object(y.a)(r.PostalAddress),initials:p(c),textBoyColor:u(c),personaType:Object(m.a)(r.PostalAddress)?"Room":"Unknown",personaControlId:r.DisplayName}}return null}var h=t(6),g=t(30),v=t(155),O=t(211);const j=290,P=135;function L(r,c,t,e,a,_){a=a||j,_=_||P;const n=Object(g.a)();if((!Object(f.a)(t)||r&&c)&&n.PolicySettings.PlacesEnabled){var s=Object(h.c)("/OWS/beta/Location/locationmap?Latitude={0}&Longitude={1}&Address={2}&Culture={3}&Width={4}&Height={5}",r&&r.toString(),c&&c.toString(),encodeURIComponent(t),Object(h.e)(),a,_);Object(v.b)(s,void 0,!0).then(r=>{Object(O.a)(r.status)?r.json().then(r=>{e(`data:image/png;base64,${r.ib}`)}):e("")})}else e("")}var w=t(2635),N=t(22),k=t(251),C=t.n(k);const I=Object(a.a)((function(r){var c,t;const a=e.useRef(),[_,n]=e.useState(null);e.useEffect(()=>{var c;let t=!0;return(null===(c=r.locationPersona)||void 0===c?void 0:c.postalAddress)&&r.locationPersona.postalAddress.Latitude&&r.locationPersona.postalAddress.Longitude&&!Object(f.a)(r.locationPersona.displayName)&&!_&&"pending"!=a.current&&"failed"!=a.current&&(a.current="pending",L(r.locationPersona.postalAddress.Latitude,r.locationPersona.postalAddress.Longitude,null,(function(r){t&&(n(r),r?a.current="success":(a.current="failed",N.h.warn("getLocationPhoto.downloadLocationPhoto failed")))}),64,64)),()=>t=!1},[null===(c=r.locationPersona.postalAddress)||void 0===c?void 0:c.Latitude,null===(t=r.locationPersona.postalAddress)||void 0===t?void 0:t.Longitude,r.locationPersona.displayName]);let{locationPersona:s,className:o,size:p,showPersonaDetails:l}=r;if(s){let r={};return Object(f.a)(_)?C()(r,{imageInitials:s.initials,initialsColor:s.textBoyColor}):C()(r,{imageUrl:_,imageShouldFadeIn:!1}),e.createElement(w.a,Object.assign({className:o,presence:i.b.none,hidePersonaDetails:!l,size:p,text:s.displayName,secondaryText:s.displayAddress},r))}return null})),S="https://www.bing.com/maps?v=2&rtp=~pos.{0}_{1}_{2}_{3}&FORM=CalLoc",D="https://www.bing.com/maps?v=2&rtp=~adr.{0}_{1}&FORM=CalLoc";function T(r,c,t,e){return r&&c?Object(h.c)(S,r.toString(),c.toString(),t,e):t?Object(h.c)(D,t,e):null}var U=t(1134),z=t(20);function F(r,c){return{Id:c,DisplayName:r,PostalAddress:{LocationSource:"Resource",LocationUri:c,Type:"Business"}}}var B=t(894);function x(r){return{EmailAddress:r.PostalAddress.LocationUri,Name:r.DisplayName}}function E(r){return{Id:r,DisplayName:r,PostalAddress:{Type:"Business",LocationSource:"None"}}}function R(r,c,t,e){return r?{PostalAddress:{LocationUri:t,LocationSource:e,Type:c,Street:r.streetAddress,City:r.addressLocality,State:r.addressRegion,Country:r.addressCountry,PostalCode:r.postalCode,PostOfficeBox:r.postOfficeBoxNumber,Longitude:r.longitude,Latitude:r.latitude}}:null}var W=t(1130);function H(r){let c=[];return r&&"string"!=typeof r&&c.push({Id:r.personaId,DisplayName:r.displayName,PostalAddress:r.postalAddress}),c}t.d(c,"t",(function(){return q})),t.d(c,"b",(function(){return $})),t.d(c,"m",(function(){return d})),t.d(c,"l",(function(){return b})),t.d(c,"k",(function(){return A})),t.d(c,"a",(function(){return I})),t.d(c,"n",(function(){return T})),t.d(c,"o",(function(){return L})),t.d(c,"r",(function(){return U.a})),t.d(c,"s",(function(){return m.a})),t.d(c,"g",(function(){return F})),t.d(c,"c",(function(){return B.a})),t.d(c,"d",(function(){return B.b})),t.d(c,"e",(function(){return B.c})),t.d(c,"p",(function(){return x})),t.d(c,"h",(function(){return E})),t.d(c,"i",(function(){return R})),t.d(c,"f",(function(){return W.a})),t.d(c,"u",(function(){return W.d})),t.d(c,"q",(function(){return W.b})),t.d(c,"j",(function(){return H}));const V=new z.c(()=>Promise.all([t.e(25),t.e(27),t.e(30),t.e(37),t.e(820)]).then(t.bind(null,20079)));let q=new z.b(V,r=>r.createTxpPostalAddressFromLocationPersona);const $=Object(z.d)(V,r=>r.WebUrlLocation,_)}}]);
//# sourceMappingURL=owa.39.js.map
self.scriptsLoaded['owa.39.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.39.js'] = (new Date()).getTime();