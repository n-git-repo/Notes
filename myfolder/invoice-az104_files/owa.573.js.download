self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.573.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[573],{1101:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1110),i=n(714);function o(){return Object(r.a)()===i.a.StartLate}},1102:function(t,e,n){"use strict";var r=n(1110),i=n(418),o=n(523);const a=!1;function c(){const t=function(){const t=Object(o.a)().settings.get(i.a.ShouldEventsEndEarly.toLowerCase());return null!=t?!!t.value:void 0}();return null!=t?t:a}var l=n(714);function s(){const t=Object(r.a)();return t?t===l.a.EndEarly:c()}n.d(e,"a",(function(){return s}))},1103:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(418),i=n(523);function o(){const t=Object(i.a)().settings.get(r.a.EnableOnlineMeetingsByDefault.toLowerCase());return null!=t?!!t.value:void 0}},1104:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(418),i=n(523);function o(){const t=Object(i.a)().settings.get(r.a.ShortenEventScope.toLowerCase());return null!=t?t.value:void 0}},1110:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1104);const i=n(714).a.None;function o(){const t=Object(r.a)();return null!=t?t:i}},1117:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t.TenantDefault="TenantDefault",t.UserOverride="UserOverride"}(r||(r={}))},11496:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(20);const i=new r.c(()=>n.e(1007).then(n.bind(null,13345))),o=(Object(r.d)(i,t=>t.SmartPill),Object(r.d)(i,t=>t.SmartPillBlock))},12970:function(t){t.exports=JSON.parse('{"a":"RLc","b":"SLc","c":"TLc"}')},12971:function(t){t.exports=JSON.parse('{"d":"XLc","e":"YLc","c":"ZLc","a":"_Lc","b":"$Lc"}')},1463:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1102),i=n(1101);function o(){return Object(i.a)()||Object(r.a)()}},1464:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(1103);const i=!1;function o(){const t=Object(r.a)();return null!=t?t:i}},1465:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(1491),i=n(1117),o=n(418);function a(){const t=Object(r.a)(),e=t.get(o.a.ShortenEventScope.toLowerCase()),n=t.get(o.a.EndShortEventsBy.toLowerCase()),a=t.get(o.a.EndLongEventsBy.toLowerCase());return(null==e?void 0:e.source)===i.a.TenantDefault&&(null==n?void 0:n.source)===i.a.TenantDefault&&(null==a?void 0:a.source)===i.a.TenantDefault}},1491:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(523);function i(){return Object(r.a)().settings}},152:function(t,e,n){"use strict";var r=n(20),i=n(1104),o=n(418),a=n(523);function c(){const t=Object(a.a)().settings.get(o.a.EndShortEventsBy.toLowerCase());return null!=t?+t.value:void 0}function l(){const t=Object(a.a)().settings.get(o.a.EndLongEventsBy.toLowerCase());return null!=t?+t.value:void 0}var s=n(1103),u=n(1463),d=n(1102),m=n(1101);const g=5;function f(){const t=c();return null!=t?t:g}const p=10;function b(){const t=l();return null!=t?t:p}var S=n(1464),h=n(1465),O=n(714);n.d(e,"n",(function(){return y})),n.d(e,"m",(function(){return v})),n.d(e,"k",(function(){return i.a})),n.d(e,"j",(function(){return c})),n.d(e,"i",(function(){return l})),n.d(e,"h",(function(){return s.a})),n.d(e,"e",(function(){return u.a})),n.d(e,"f",(function(){return d.a})),n.d(e,"g",(function(){return m.a})),n.d(e,"c",(function(){return f})),n.d(e,"b",(function(){return b})),n.d(e,"d",(function(){return S.a})),n.d(e,"l",(function(){return h.a})),n.d(e,"a",(function(){return O.a}));const j=new r.c(()=>n.e(832).then(n.bind(null,19823))),y=new r.a(j,t=>t.saveCalendarCloudSettings),v=new r.a(j,t=>t.initCalendarCloudSettings)},1539:function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return l}));var r=n(12),i=n(80),o=n(753),a=n(30);function c(t){var e;const n=null===(e=Object(a.a)())||void 0===e?void 0:e.UserOptions;Object(r.b)({timezone:null==n?void 0:n.TimeZone});const c=Object(i.j)(n,t);return Object(o.d)(),c}function l(t){const e=null==t?void 0:t.UserOptions;Object(r.b)({timezone:null==e?void 0:e.TimeZone}),Object(i.n)(e),Object(o.d)()}},18171:function(t){t.exports=JSON.parse('{"b":"ULc","c":"VLc","a":"WLc"}')},18172:function(t,e,n){var r=n(18173);"string"==typeof r&&(r=[[t.i,r,""]]);var i={transform:void 0};n(84)(r,i);r.locals&&(t.exports=r.locals)},18173:function(t,e,n){(e=t.exports=n(83)(!1)).push([t.i,"._1U1SeD7B16u2U4zHCa2Go0{position:relative;-webkit-font-smoothing:antialiased;font-size:14px;font-weight:400;color:inherit;width:100%;height:48px;line-height:32px;display:block;cursor:pointer;outline:transparent}html[dir] ._1U1SeD7B16u2U4zHCa2Go0{background-color:transparent;padding-top:0;padding-bottom:0;border-width:initial;border-style:none;border-color:initial;-o-border-image:initial;border-image:initial}html[dir=ltr] ._1U1SeD7B16u2U4zHCa2Go0{padding-right:12px;padding-left:12px;text-align:left}html[dir=rtl] ._1U1SeD7B16u2U4zHCa2Go0{padding-left:12px;padding-right:12px;text-align:right}html[dir] ._1U1SeD7B16u2U4zHCa2Go0:hover{background-color:var(--neutralLighter)}html[dir] ._1U1SeD7B16u2U4zHCa2Go0:active{background-color:var(--neutralLight)}.OZFBOZDij89oqk5qHhU5Z{white-space:nowrap;height:inherit;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;max-width:100%}._1vE3bD405vMMux036JQfSR{display:inline-block;color:var(--themePrimary);height:32px;width:32px;vertical-align:middle;-ms-flex-negative:0;flex-shrink:0;overflow:hidden}html[dir=ltr] ._1vE3bD405vMMux036JQfSR{margin-right:8px}html[dir=rtl] ._1vE3bD405vMMux036JQfSR{margin-left:8px}._2keAiI_fztUeCMPiMXWSnp{max-width:216px;width:100%;height:100%}._1qqydZ9K2MtghNKRjxsL3s{font-size:14px;color:var(--neutralPrimary);line-height:19px;max-width:100%}._1qqydZ9K2MtghNKRjxsL3s,.hG0rRVZf_88k7xZyfnF21{font-weight:400;display:block;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.hG0rRVZf_88k7xZyfnF21{font-size:11px;color:var(--neutralSecondary);line-height:15px;width:216px}html[dir] .hG0rRVZf_88k7xZyfnF21{padding-top:1px}.U2jEwfWu8Ip5clvXd4c-d{position:absolute;top:20px}html[dir=ltr] .U2jEwfWu8Ip5clvXd4c-d{left:24px}html[dir=rtl] .U2jEwfWu8Ip5clvXd4c-d{right:24px}html[dir] .ATTkhvEAloDqjzW7ypc8Y{margin:0}",""]),e.locals={attachmentSuggestionButton:"_1U1SeD7B16u2U4zHCa2Go0",attachmentSuggestionButtonContent:"OZFBOZDij89oqk5qHhU5Z",attachmentSuggestionButtonImageContainer:"_1vE3bD405vMMux036JQfSR",attachmentSuggestionButtonTextContainer:"_2keAiI_fztUeCMPiMXWSnp",attachmentSuggestionPrimaryText:"_1qqydZ9K2MtghNKRjxsL3s",attachmentSuggestionSecondaryText:"hG0rRVZf_88k7xZyfnF21",fileIcon:"U2jEwfWu8Ip5clvXd4c-d",cloudyIcon:"ATTkhvEAloDqjzW7ypc8Y"}},18174:function(t,e,n){var r=n(18175);"string"==typeof r&&(r=[[t.i,r,""]]);var i={transform:void 0};n(84)(r,i);r.locals&&(t.exports=r.locals)},18175:function(t,e,n){(e=t.exports=n(83)(!1)).push([t.i,".Y5dFr2x0NpqwfbG5Oviij{position:relative;-webkit-font-smoothing:antialiased;font-size:14px;font-weight:400;color:inherit;width:100%;height:48px;line-height:32px;display:block;cursor:pointer;outline:transparent}html[dir] .Y5dFr2x0NpqwfbG5Oviij{background-color:transparent;padding-top:0;padding-bottom:0;border-width:initial;border-style:none;border-color:initial;-o-border-image:initial;border-image:initial}html[dir=ltr] .Y5dFr2x0NpqwfbG5Oviij{padding-right:12px;padding-left:12px;text-align:left}html[dir=rtl] .Y5dFr2x0NpqwfbG5Oviij{padding-left:12px;padding-right:12px;text-align:right}html[dir] .Y5dFr2x0NpqwfbG5Oviij:hover{background-color:var(--neutralLighter)}html[dir] .Y5dFr2x0NpqwfbG5Oviij:active{background-color:var(--neutralLight)}._1WZuMQ9FxqhnVssAqMAxo{width:280px}._3NGlKWY26Xz0pCQUr9Ecyl{font-size:12px;font-weight:400;font-weight:600;color:var(--themePrimary);max-width:280px}html[dir=ltr] ._3NGlKWY26Xz0pCQUr9Ecyl{margin-left:1px}html[dir=rtl] ._3NGlKWY26Xz0pCQUr9Ecyl{margin-right:1px}._1k-l7cwOml3YeFDzK_YXa1{font-size:16px;height:16px;line-height:31px;width:16px;color:var(--neutralSecondary)!important}html[dir=ltr] ._1k-l7cwOml3YeFDzK_YXa1{margin-left:16px;margin-right:12px}html[dir=rtl] ._1k-l7cwOml3YeFDzK_YXa1{margin-right:16px;margin-left:12px}html[dir] .beD5wfT9nKlvcUu1Zadxl{padding-bottom:16px}html[dir] .ctnBkSVZRcg6YHaFyFMPx{padding-bottom:14px}html[dir] ._384qPkGUpAypLOEjHCtj6y{padding-bottom:16px}html[dir] ._3YUg1yOpS0QpH34aEm5g8f{margin-bottom:3px;margin-top:3px}html[dir=ltr] ._3YUg1yOpS0QpH34aEm5g8f{margin-right:10px}html[dir=rtl] ._3YUg1yOpS0QpH34aEm5g8f{margin-left:10px}",""]),e.locals={attachmentSuggestionButton:"Y5dFr2x0NpqwfbG5Oviij",attachmentSuggestionButtonRoot:"_1WZuMQ9FxqhnVssAqMAxo",replyWithHeaderForBottomBar:"_3NGlKWY26Xz0pCQUr9Ecyl",iconRoot:"_1k-l7cwOml3YeFDzK_YXa1",iconRootComputer:"beD5wfT9nKlvcUu1Zadxl",iconRootCloud:"ctnBkSVZRcg6YHaFyFMPx",iconRootUploadAndShare:"_384qPkGUpAypLOEjHCtj6y",loadingSpinner:"_3YUg1yOpS0QpH34aEm5g8f"}},18176:function(t){t.exports=JSON.parse('{"a":"aMc","b":"bMc"}')},18177:function(t,e,n){var r=n(18178);"string"==typeof r&&(r=[[t.i,r,""]]);var i={transform:void 0};n(84)(r,i);r.locals&&(t.exports=r.locals)},18178:function(t,e,n){(e=t.exports=n(83)(!1)).push([t.i,".j-FILlw4CH3fSWY03-Amv{font-size:12px}",""]),e.locals={menuButton:"j-FILlw4CH3fSWY03-Amv"}},18179:function(t){t.exports=JSON.parse('{"f":"vLc","v":"wLc","o":"xLc","p":"yLc","g":"zLc","h":"ALc","i":"BLc","j":"CLc","k":"DLc","l":"ELc","m":"FLc","n":"GLc","q":"HLc","r":"ILc","s":"JLc","t":"KLc","u":"LLc","a":"MLc","b":"NLc","c":"OLc","d":"PLc","e":"QLc"}')},18180:function(t,e,n){var r=n(18181);"string"==typeof r&&(r=[[t.i,r,""]]);var i={transform:void 0};n(84)(r,i);r.locals&&(t.exports=r.locals)},18181:function(t,e,n){(e=t.exports=n(83)(!1)).push([t.i,"html[dir] ._2ErmWVChyjAlt8V0aXtt9l{padding-top:10px}html[dir=ltr] ._2ErmWVChyjAlt8V0aXtt9l{margin-left:52px}html[dir=rtl] ._2ErmWVChyjAlt8V0aXtt9l{margin-right:52px}",""]),e.locals={bar:"_2ErmWVChyjAlt8V0aXtt9l"}},19693:function(t,e,n){"use strict";n.r(e);var r=n(2);const i=Object(r.action)("setSmartPillBlockVisibility",(t,e)=>({viewState:t,smartPillBlockVisible:e})),o=Object(r.action)("setSmartPillFeedbackSubmitted",(t,e)=>({item:t,smartPillFeedbackSubmitted:e}));Object(r.mutator)(i,t=>{t.viewState.smartPillBlockVisible=t.smartPillBlockVisible}),Object(r.mutator)(o,t=>{t.item.smartPillFeedbackSubmitted=t.smartPillFeedbackSubmitted});var a=Object(r.action)("updateItemLanguageAction",(function(t){return{item:t}})),c=n(22),l=n(7874);function s(t){const e=function(t){const e=t.ExtendedProperty;if(e){const t=e.filter(t=>t.ExtendedFieldURI.PropertyName===l.a);if(t.length>0)return t[0]}return null}(t);let n=void 0,r=void 0,i=0,o=void 0;try{if(e){const t=JSON.parse(e.Value)[0],a=t[l.c],c=t[l.d];o=t[l.b],r=Object.keys(c)[0],n=(null==a?void 0:a[l.e])&&a[l.e].toLowerCase(),i=parseInt(Object.values(c)[0])}}catch(t){c.h.info(`[getStampedLanguage] Failed to parse property, error: ${t.message}`)}return{locale:n,language:r,confidenceScore:i,entityId:o}}Object(r.mutator)(a,t=>{const e=t.item;e.stampedLanguage=s(e)});var u=n(21),d=n(1199),m=n(25);function g(t){const e=t.featureName;return"SmartReply"===e?Object(m.k)("mc-smartReply"):"SmartTime"===e?Object(m.k)("mc-smartReplyWithCustomMeeting"):"SmartDoc"===e?Object(m.k)("mc-smartReplyWithDoc"):(c.h.info(`[isPillTypeEnabled] Unknown pill type: ${e}`),!1)}function f(t){if(t){if("SmartDoc"===t.featureName)return!0;null==t.confidenceScore&&c.h.info("[isConfidenceScoreAcceptable] confidence score is null. Feature: "+t.featureName+" EntityId: "+t.logData.mainPayload.EID);const e=t.confidenceScore;if(e>0){if(Object(m.k)("mc-smartPillConfidenceLevel_LOW"))return!0;if(Object(m.k)("mc-smartPillConfidenceLevel_MID"))switch(t.featureName){case"SmartTime":return e>=70;default:return!0}else switch(t.featureName){case"SmartTime":return e>=90;default:return!0}}}return!1}function p(){const t=Object(m.k)("mc-smartReplyWithTextPositionThird");return[{aggregation:{SmartReply:2,SmartTime:1},arrangement:t?["SmartTime","SmartReply"]:["SmartReply","SmartTime"]},{aggregation:{SmartTime:1},arrangement:["SmartTime"]},{aggregation:{SmartReply:2,SmartDoc:1},arrangement:t?["SmartDoc","SmartReply"]:["SmartReply","SmartDoc"]},{aggregation:{SmartDoc:1},arrangement:["SmartDoc"]},{aggregation:{SmartReply:3},arrangement:["SmartReply"]}]}const b={selectPills:t=>(function(t,e){const n=[];return e&&t.length>0&&e.arrangement.forEach(r=>{n.push(...function(t,e,n){return t.filter(t=>t.featureName===e).slice(0,n)}(t,r,e.aggregation[r]))}),n})(t,function(t){if(t){const e=function(t){let e={};for(let n of t)e[n.featureName]=void 0===e[n.featureName]?1:e[n.featureName]+1;return e}(t),n=p();for(let t=0;t<n.length;t++){let r=!0;const i=n[t];for(let t=0;t<i.arrangement.length;t++){if(i.aggregation[i.arrangement[t]]>(void 0===e[i.arrangement[t]]?0:e[i.arrangement[t]])){r=!1;break}}if(r)return i}}return null}(t))};function S(t,e,n,r){const i=[];return t.forEach(t=>{n(t)?i.push(t):(t.logData.mainPayload.renderStory|=r,e.push(t))}),i}var h={arbitratePills:t=>{const e=[],n=[];if(t){const r=S(t,n,g,1),i=S(r,n,f,4);if(i.length>0){const t=b;e.push(...t.selectPills(i));for(let t=0;t<i.length;t++){const r=i[t];e.some(t=>t===r)||(r.logData.mainPayload.renderStory|=2,n.push(r))}}}return{pillsToShow:e,pillsToHide:n,arbitratorId:"complexArbitrator"}}};var O=Object(r.action)("createMessageWithAttachmentAction",(function(t,e,n){return{item:t,attachment:e,option:n}})),j=n(2826),y=n(2835);function v(t,e){const n=function(t){for(let e=0;e<t.length;e++)if(0===t[e].type)return t[e].model.Id;return c.h.warn("createCloudFileFromAttachmentData: Could not get OneDrive Pro provider ID. Attachment will not upload."),""}(t);return{fileType:j.a.CloudSuggestion,name:e.FileName,size:null,providerId:n,providerType:0,location:e.Url,providerEndpointUrl:null,isFolder:!1,fileId:e.Id,fileParentId:null,thumbnailUrl:null,previewUrl:null,type:null}}var I=n(3587),w=n(2919);async function x(t,e){let n=Object(I.a)(t.ConversationId.Id);if(!n){const r=await w.n.import();n=await r({referenceItemOrId:t,isReplyAll:!0,useFullCompose:!1,instrumentationContexts:null,conversationId:t.ConversationId.Id,body:null,smartDocOption:e})}return n}var E=n(4127),P=n(68),T=n(1427);Object(r.orchestrator)(O,(async function(t){const{item:e,attachment:n,option:r}=t;if(n)try{if(2==n.Endpoint){const t=await x(e,r);(await w.b.import())([{fileType:j.a.AttachmentItemSuggestion,name:n.FileName,size:parseInt(n.FileSize),attachmentItemId:n.Id,type:T.c}],t,{isInline:!1,isHiddenInline:!1,shouldShare:!1,isAddedFromSmartDoc:!0},()=>C(e,t),null,null,null)}else await async function(t,e){let n=null;if(Object(y.j)()===y.c.NotLoaded){(await y.l.import())(r=>{n=v(Object(y.h)(),t),e(n)})}else n=v(Object(y.h)(),t),e(n)}(n,t=>{!async function(t,e,n){if(e){const r=await x(t,n);(await w.b.import())([e],r,{isInline:!1,isHiddenInline:!1,shouldShare:!0,isAddedFromSmartDoc:!0},()=>C(t,r),null,null,null)}}(e,t,r)})}catch(t){c.d(`[createMessageWithAttachmentOrchestrator] Error when creating cloud file: ${t.message}`)}else await x(e,r)}));function C(t,e){Object(P.p)("SmartDocAttachmentsAdded",{smartDocExtractionId:t.SmartDocData.EntityId},{isCore:!0,excludeFromKusto:!0}),e.smartPillViewState.smartDocOption=E.a.None}var R=Object(r.action)("cacheSmartDocDataAction",(function(t,e,n){return{item:t,validPropertyExists:e,entityId:n}})),D=(Object(r.mutator)(R,(function(t){let e={EntityId:void 0};const{item:n,validPropertyExists:r,entityId:i}=t;r&&(e.EntityId=i),n.SmartDocData=e})),n(0)),k=n(3211);var F=n(398),N=n(3615),A=n(5454);const L=Object(r.createStore)("smartDocStatusAndSuggestionStore",{status:0,suggestions:[]});var M=L;const _=Object(r.mutatorAction)("SET_SMART_DOC_SUGGESTION_STATUS",t=>{L().status=t}),U=Object(r.mutatorAction)("SET_SMART_DOC_SUGGESTIONS",(t,e)=>{L().suggestions=t,L().status=e}),z="application/json;charset=utf-8",G="/search/api/v1/recommendations";async function B(t,e){let n=null,r="";_(1);try{const i=function(t,e){const n={};n.headers=new Headers,n.headers.set("Authorization",`Bearer ${t}`),n.headers.set("Content-Type",z),n.method="POST";const r=Object(N.b)();r&&n.headers.append("X-AnchorMailbox",r);n.headers.set("X-Client-LocalTime",(new Date).toISOString());const i=[];i.length&&n.headers.set("X-Client-Flights",i.join(","));const o=Object(m.k)("mc-smartReplyWithDoc-SmartAttachments"),a={EntityRequests:[e?{Context:{EntityId:e}}:{}],Scenario:{Name:o?"SmartAttachments":"AttachFile"}};return n.body=JSON.stringify(a),n}(await async function(){let[t,e]=Object(F.getAccessTokenforResourceAsLazy)(window.location.origin,"FetchMRUSuggestions");t||(t=await e);return t}(),t),o=await fetch(G,i);if(o&&200==o.status){const t=await o.text();n=function(t){try{return t.EntitySets[0].ResultSets[0].Results.map((t,e)=>(function(t,e){var n,r;try{const i=!!t.Source.LastShared&&!t.Source.WebUrl;return{DateAccessed:t.Source.LastAccessDateTime||(null===(n=t.Source.UserRelationship)||void 0===n?void 0:n.LastAccessDateTime),DateModified:t.Source.LastModifiedDateTime,Endpoint:"Implicit"===(null===(r=t.SubstrateSearchExtendedProperties)||void 0===r?void 0:r.RelevanceRelationship)?i?k.a.MRUClassicContextual:k.a.MRUContextual:i?k.a.MRUClassic:k.a.MRUCloudy,FileExtension:t.Source.FileExtension,FileName:t.Source.FileName,FileSize:t.Source.FileSize,FileSourceType:t.ContentSource||t.Provenance,Id:i?t.Source.LastShared.AttachmentId:t.Id,Position:e,ReferenceId:t.ReferenceId,SourceTitle:t.Source.SiteTitle||t.Source.LastShared.SharingSubject,Url:t.Source.Url,TraceId:null}}catch(t){return c.h.info(`[convertMRUAttachmentToReplyWithAttachmentSuggestion] Error accessing MRUAttachment properties: ${t.message}`),null}})(t,e))}catch(t){return c.h.info(`[fetchMRUSuggestions_getAttachmentsFromResponse] Error: ${t.message}`),[]}}(JSON.parse(t))}else r=o?o.status+"-"+o.statusText:"No response"}catch(t){r=t.message}finally{return r?(c.h.info(`getMRUSuggestions: Error ${r}`),_(3)):U(n,2),Object(A.l)("SmartDocSuggestionRequestSent",{EID:e,isSuccessful:!r,numOfFileSuggestions:null==n?void 0:n.length}),n}}var Z=n(6);const V="@EntityId";function H(t,e){let n=!1;if(t){if(e)try{n=function(t,e){let n=!1;const r=e[V];if(!r){throw c.h.info("[extractAndCacheSmartDocDataFromProperty] Cannot parse entity ID. Aborting..."),new Error("NoEntityIdOnProperty")}return n=!0,R(t,n,r),n}(t,JSON.parse(e.Value)[0])}catch(t){throw c.h.warn("[parseSmartDocProperty] Malformed property, cannot parse. Error: "+t.message),t.networkError=!0,t}else c.h.info("[parseSmartDocProperty] No property found.");n||R(t,n)}else c.h.info("[parseSmartDocProperty] No item.")}var q=n(5),W=n(18171),$=n(753),J=n(3373),K=n(18172),Y=n.n(K);const X="...",Q=30;function tt(t){const{item:e,suggestion:n,smartPillLogData:r,onAttachmentClicked:i,dismissMenu:o}=t,a=D.useCallback(()=>{Object(A.j)(A.a,r,{subtype:"FileSuggestion"+n.Position,clickedSuggestion:{endpoint:k.a[n.Endpoint],fileSourceType:n.FileSourceType}}),i(e,n,E.a.FileSuggestion),o()},[e,n,o]);let l,s,u;try{l=function(t){let e=null;try{e=[t.FileName,rt(t),et(t),nt(t)].filter(t=>t).join("\n")}catch(t){c.h.info("[SmartDocMenuItemBuilder] Failed to parse attachment tooltip data, message: "+t.message)}finally{return e}}(n),s=function(t){return t.Endpoint===k.a.MRUClassic||t.Endpoint===k.a.MRUClassicContextual?rt(t):et(t)}(n),u=function(t){if(t.length<=Q)return t;{const e=Q-X.length,n=Math.ceil(e/2),r=Math.floor(e/2),i=t.substr(0,n),o=t.substr(t.length-r);return`${i}${X}${o}`}}(function(t){const e="."+t.FileExtension;return t.FileName.indexOf(e)>=0?t.FileName.replace(e,""):t.FileName}(n)+function(t){return"."+t.FileExtension}(n))}catch(t){throw c.h.warn(`[SmartDocMenuItemBuilder] Error: ${t.message}`),t.networkError=!0,t}return D.createElement("button",{className:Y.a.attachmentSuggestionButton,title:l,name:n.FileName,"aria-label":Object(Z.c)(Object(Z.b)(W.b),n.FileName),"aria-posinset":1,"aria-setsize":7,"aria-disabled":"false",role:"menuitem",onClick:a,tabIndex:0},D.createElement("div",{className:Y.a.attachmentSuggestionButtonContent},D.createElement("div",{className:Y.a.attachmentSuggestionButtonImageContainer,role:"presentation","aria-hidden":"true"},function(t){const e=t.FileName+"."+t.FileExtension;if(t.Endpoint===k.a.MRUClassic||t.Endpoint===k.a.MRUClassicContextual){const t=Object(J.f)(e,null,!1,!1,null).medium;return D.createElement("div",{className:t})}return D.createElement(J.a,{fileName:e,contentType:null,isBlocked:!1,isFolder:!1,embeddedItemClass:null,cloudyIconStyle:Y.a.cloudyIcon,fileIconStyle:Y.a.fileIcon})}(n)),D.createElement("div",null,D.createElement("div",{className:Y.a.attachmentSuggestionButtonTextContainer},D.createElement("div",{className:Y.a.attachmentSuggestionPrimaryText},u)),D.createElement("div",{className:Y.a.attachmentSuggestionSecondaryText},s))))}function et(t){if(t.Endpoint===k.a.MRUClassic||t.Endpoint===k.a.MRUClassicContextual)return null;{const{DateAccessed:e}=t;e||c.d(`[SmartDocMenuItemBuilder] Access date is not available for suggestion "${t.Id}"`);const n=Object(q.Ub)("UTC",e),r=Object(q.N)(n,Object($.i)());return Object(Z.c)(Object(Z.b)(W.a),r)}}function nt(t){const{DateModified:e}=t;e||c.d(`[SmartDocMenuItemBuilder] Modified date is not available for suggestion "${t.Id}"`);const n=Object(q.Ub)("UTC",e),r=Object(q.Z)(n);return Object(Z.c)(Object(Z.b)(W.c),r)}function rt(t){let e=null;const n=document.createElement("a");n.href=t.Url,e=decodeURIComponent(n.hostname);const r=Object(Z.h)(),i=decodeURIComponent(n.pathname).split("/");for(let t=1;t<i.length-1;t++)r?e=i[t]+" < "+e:e+=" > "+i[t];return e}const it=3;var ot=n(72),at=n(711),ct=n(12970),lt=n(1461),st=n(252),ut=n(5557),dt=n(134),mt=n(18174),gt=n.n(mt),ft=n(209);const pt=n.n(ft).a.bind(gt.a);var bt=Object(u.a)((function(t){var e;const{store:n,item:r,logData:i,pillsToShowTypes:o}=t,a=D.useRef(!1),l=D.useRef(),s=[],u=[];switch(s.push({key:"replyWithHeader",name:Object(Z.b)(ct.b),title:Object(Z.b)(ct.b),itemType:dt.a.Header,iconProps:{iconName:null,styles:{root:{margin:"0px",width:"0px"}}},className:gt.a.replyWithHeaderForBottomBar}),n.status){case 0:case 2:if(null===(e=n.suggestions)||void 0===e?void 0:e.length){(function(t,e=it){const n=[];let r=null;if(t)for(let i=0;i<t.length&&n.length<e;i++)r=t[i],r?n.push(r):c.h.info("[extractAttachmentSuggestions] mru suggestion is null");return n})(n.suggestions).forEach((t,e)=>{s.push(function(t,e,n,r){return{key:"fileSuggestion"+e,className:gt.a.attachmentSuggestionButtonRoot,onRender:(e,i)=>D.createElement(tt,{item:n,suggestion:t,smartPillLogData:r,onAttachmentClicked:O,dismissMenu:i})}}(t,e,r,i)),u.push(function(t){return{endpoint:k.a[t.Endpoint],fileSourceType:t.FileSourceType}}(t))})}s.push(St());break;case 1:s.push({key:"spinner",className:gt.a.attachmentSuggestionButtonRoot,onRender:()=>D.createElement(lt.a,{size:st.a.medium,className:gt.a.loadingSpinner})}),s.push(St());break;case 3:s.pop();break;default:Object(ot.a)(n.status)}s.push(ht(r,i,Object(Z.b)(ut.b),Object(Z.b)(ut.b),{iconName:"System",styles:{root:pt(gt.a.iconRoot,gt.a.iconRootComputer)}},E.a.LocalFiles)),s.push(ht(r,i,Object(Z.b)(ut.a),Object(Z.b)(ut.a),{iconName:"Cloud",styles:{root:pt(gt.a.iconRoot,gt.a.iconRootCloud)}},E.a.CloudFiles)),s.push(ht(r,i,Object(Z.b)(ut.c),Object(Z.b)(ut.d),{iconName:"CloudUpload",styles:{root:pt(gt.a.iconRoot,gt.a.iconRootUploadAndShare)}},E.a.UploadAndShare));const d=(t,e)=>{if(t){const n=(new Date).toISOString(),r={data:[Object.assign(Object.assign({},i.mainPayload),{timeClicked:n,numOfFileSuggestions:u.length,isSuccessful:e})]};t.addCustomData([JSON.stringify(r)]),t.addCosmosOnlyData(i.cosmosOnlyData),t.end()}};D.useEffect(()=>{!a.current||2!==n.status&&3!==n.status||d(l.current,2===n.status)});const g={items:s,onMenuOpened:()=>{a.current=!0,Object(A.j)(A.d,i,{numOfFileSuggestions:u.length,numOfPillsShown:o.length,typesOfPillsShown:o}),1===n.status&&(l.current=new P.b(A.c,{isCore:!0,excludeFromKusto:!0}))},onMenuDismissed:()=>{a.current=!1,Object(A.j)(A.b,i,{numOfFileSuggestions:u.length,suggestions:u}),1===n.status&&d(l.current,!1),l.current=null}},f=Object(Z.b)(ct.a);return D.createElement(at.a,{ariaDescription:f,title:Object(m.k)("mc-smartPillsTooltipV2")?Object(Z.b)(ct.c):f,iconProps:{iconName:"Attach"},key:t.position,split:!1,styles:t.menuItemStyle,text:f,menuProps:g})}));function St(){return{key:"replyWithSeparator",iconProps:{iconName:null,styles:{root:{margin:"0px",width:"0px"}}},className:gt.a.replyWithSeparator,itemType:dt.a.Divider}}function ht(t,e,n,r,i,o){const a=E.a[o];return{key:a,name:n,ariaLabel:r,title:r,iconProps:i,onClick:()=>{Object(A.j)(A.a,e,{subtype:a}),O(t,null,o)}}}var Ot=n(4427),jt=n(5058);const yt="EntityExtraction/SendContentRequestV21.0",vt="Attach a file";function It(t){var e;const n=Object(A.i)("SmartDoc",vt,t.SmartDocData.EntityId);return B(Object(m.k)("mc-smartReplyWithDoc-ContextualMRU")?null===(e=t.ItemId)||void 0===e?void 0:e.Id:null,t.SmartDocData.EntityId),{onRender:(e,r,i)=>D.createElement(bt,{store:M(),item:t,logData:n,position:e,menuItemStyle:r,pillsToShowTypes:i}),ariaLabel:Object(Z.b)(ct.a),featureName:"SmartDoc",index:0,logData:n,onClick:null}}function wt(t){return{buildPills:async()=>(async function(t){var e;if(t.SmartDocData&&!t.SmartDocData.EntityId)return[];if(!t.SmartDocData){const e=await jt.c.import(),n=await e(t.ItemId.Id,Ot.a.SmartDoc);if(n){H(n,function(t,e){const n=t.ExtendedProperty;if(n){const t=n.length;for(let r=0;r<t;r++){const t=n[r];if(t.ExtendedFieldURI.PropertyName===e)return t}}return null}(n,yt))}}return(null===(e=t.SmartDocData)||void 0===e?void 0:e.EntityId)?[It(t)]:[]})(t),getName:()=>"SmartDoc"}}var xt=Object(r.action)("cacheSmartReplyDataAction",(function(t,e,n,r,i){return{item:t,validPropertyExists:e,smartReplies:n,loggableSmartReplies:r,smartReplyExtractionID:i}})),Et=n(13),Pt=(Object(r.mutator)(xt,(function(t){let e={SmartReplies:null,LoggableSmartReplies:null,ExtractionID:null,SuggestionAppropriatenessMap:null,FeedbackSubmitted:!1};const{item:n,validPropertyExists:r,smartReplies:i,loggableSmartReplies:o,smartReplyExtractionID:a}=t;if(r){e={SmartReplies:i,LoggableSmartReplies:o,ExtractionID:a,SuggestionAppropriatenessMap:new Et.ObservableMap,FeedbackSubmitted:!1};for(let t=0;t<i.length;t++){const n=String(t);e.SuggestionAppropriatenessMap.set(n,"")}}n.SmartReplyData=e})),Object(r.action)("updateSIGSDataOnClickAction",(t,e,n)=>({composeViewState:t,timeClicked:e,clickIndex:n})));Object(r.mutator)(Pt,t=>{const{composeViewState:e,timeClicked:n,clickIndex:r}=t;e&&(e.smartPillViewState.smartReplyComposeSIGSData={isSmartSuggestionsClicked:!0,suggestionsClickedTime:n,clickIndex:r})});const Tt="EntityExtraction/SmartReplyForEmail";var Ct=n(18176),Rt=n(3253),Dt=n(18177),kt=n.n(Dt);function Ft(t,e,n){return e.suggestions.slice(1).map(e=>({key:e,name:e,ariaLabel:e,title:Object(m.k)("mc-smartPillsTooltipV2")?Object(Z.b)(Ct.b):e,itemProps:{styles:{root:kt.a.menuButton}},onClick:()=>{Object(A.j)(A.f,n,{subtype:e}),Rt.h.importAndExecute(t.ItemId.Id,t.ConversationId.Id,e,1)}}))}const Nt="2018-06-20T00:00:00.0000000Z",At="@extractionTimeUtc",Lt="@EntityId",Mt=3,_t="SmartReplyForEmail",Ut="SmartReplyForEmail_Group";function zt(t,e){let n=!1;if(t){if(e)try{const r=JSON.parse(e.Value)[0],i=r[At];if(!i){c.h.warn("[getSmartRepliesForItem_parseSmartReplyProperty] Time stamp not found on property, aborting smart reply parsing.");const t=new Error("NoTimeStamp");throw t.networkError=!0,t}Date.parse(i)>=Date.parse(Nt)&&(n=function(t,e){const n=e[Lt],r=[],i=[];let o=!1;const a=e.entities.length;for(let t=0;t<a;t++){const{smartReply:n,loggableSmartReply:o}=Gt(e.entities[t]);r.push(n),i.push(o)}if(!n||r.length!=Mt){c.h.info("[getSmartRepliesForItem_extractAndCacheSmartRepliesFromProperty] Unexpected number of smart replies on item. Expected "+Mt+" but found "+r.length);const t=new Error("NumberOfSmartRepliesIs"+r.length);throw t.networkError=!0,t}o=!0,xt(t,o,r,i,n);return o}(t,r))}catch(t){throw c.h.warn("[getSmartRepliesForItem_parseSmartReplyProperty] Malformed property, cannot parse. Error: "+t.message),t.networkError=!0,t}else c.h.info("[getSmartRepliesForItem_parseSmartReplyProperty] No property found.");n||xt(t,n,null)}else c.h.info("[getSmartRepliesForItem_parseSmartReplyProperty] No item.")}function Gt(t){let e=null,n=null;switch(t["@type"]){case _t:e={type:0,suggestions:t.value},n=t.valueRaw||t.value;break;case Ut:e={type:1,suggestions:t.values},n=JSON.stringify(t.values);break;default:c.h.warn("[getSmartRepliesForItem_parseSmartReplyProperty] Unexpected entity type. Expected "+_t+" or "+Ut+" but found "+t["@type"])}return{smartReply:e,loggableSmartReply:n}}async function Bt(t){var e;if(t){if(!t.SmartReplyData){const e=await jt.c.import(),n=await e(t.ItemId.Id,Ot.a.SmartReply);if(n){zt(n,function(t,e){const n=t.ExtendedProperty;if(n){const t=n.length;for(let r=0;r<t;r++){const t=n[r];if(t.ExtendedFieldURI.PropertyName===e)return t}}return null}(n,Tt))}}if(null===(e=t.SmartReplyData)||void 0===e?void 0:e.ExtractionID)return t.SmartReplyData.SmartReplies.map((e,n)=>(function(t,e,n,r,i){const o=Object(A.i)("SmartReply",n,r,i+1);let a=null,c=null;if(0==e.type)a=e.suggestions;else if(1==e.type)switch(e.suggestions.length){case 0:a="";break;case 1:a=e.suggestions[0];break;default:a=e.suggestions[0],c={items:Ft(t,e,o)}}return{ariaLabel:Object(Z.c)(Object(Z.b)(Ct.a),a),featureName:"SmartReply",icon:Object(m.k)("mc-smartPillsDesignV2")?{iconName:"Edit"}:null,onClick:async e=>{const n=await Rt.h.importAndExecute(t.ItemId.Id,t.ConversationId.Id,a,1);Pt(n,e.logData.mainPayload.timeClicked,e.logData.mainPayload.position)},logData:o,index:i,text:a,toolTip:Object(m.k)("mc-smartPillsTooltipV2")?Object(Z.b)(Ct.b):a,confidenceScore:o.mainPayload.confidenceScore,menuProps:c}})(t,e,t.SmartReplyData.LoggableSmartReplies[n],t.SmartReplyData.ExtractionID,n))}else c.h.info("[getSmartRepliesForItem] No item, cannot produce smart replies.");return[]}function Zt(t){return{buildPills:async()=>Bt(t),getName:()=>"SmartReply"}}var Vt=Object(r.action)("cacheSmartTimeExtendedPropertyAction",(function(t,e,n){return{item:t,validPropertyExists:e,smartTimesExtendedProp:n}})),Ht=(Object(r.mutator)(Vt,(function(t){let e={beginingOfTimeRange:null,endOfTimeRange:null,duration:null,entityId:null,hasIntent:!1,confidenceScore:0,scheduler:"",rawConfidenceScores:null};const{item:n,validPropertyExists:r,smartTimesExtendedProp:i}=t;r&&i&&(e=Object.assign(Object.assign({},i),{hasIntent:!0})),n.SmartTimeExtendedProperty=e})),n(12971));const qt="EntityExtraction/Events1.0",Wt="EntityExtraction/CalendarRelated1.0";var $t=n(734),Jt=n(1486);const Kt="@EntityId",Yt="confidence",Xt="SenderSchedulerConfidence",Qt="RecipientSchedulerConfidence",te="UnclearSchedulerConfidence",ee="AvailabilityConfidence",ne="times";function re(t,e){if(!e)return void c.h.info("[getSmartTimeForItem_parseSmartTimeProperty] No smart time extended property found.");let n=null,r=!1;try{const i=JSON.parse(e.Value);let o=-1/0,a=null;i.forEach(t=>{const e=function(t){return Object(m.k)("mc-smartReplyWithMeeting-MeetingScheduler")?Math.max(t[Qt]?t[Qt]:0,t[te]?t[te]:0,t[ee]?t[ee]:0):t[Yt]?+t[Yt]:0}(t);e>o&&(o=e,a=t)});const c=a[Kt],l=a[ne][0],s={confidence:a[Yt],AvailabilityConfidence:a[ee],RecipientSchedulerConfidence:a[Qt],SenderSchedulerConfidence:a[Xt],UnclearSchedulerConfidence:a[te]},u=function(t,e){let n="";if(Object(m.k)("mc-smartReplyWithMeeting-MeetingScheduler")&&t&&e>0){let e=0;t[Qt]>e&&(e=t[Qt],n="Recipient"),t[te]>e&&(e=t[te],n="Unclear"),t[ee]>e&&(e=t[ee],n="Availability")}return n}(a,o);n={beginingOfTimeRange:l.beginingOfTimeRange,endOfTimeRange:l.endOfTimeRange,duration:l.duration,entityId:c,hasIntent:!0,confidenceScore:o,scheduler:u,rawConfidenceScores:s},r=!0}catch(t){throw c.h.warn("[getSmartTimeForItem_parseSmartTimeProperty] Malformed property, cannot parse. Error: "+t.message),t.networkError=!0,t}finally{Vt(t,r,n)}}var ie=n(3184),oe=n(358),ae=n(2913),ce=n(3182),le=Object(oe.action)("setCalendarInlineComposeViewState")((async function(t,e){const n=t,r=await w.g.import(),[i,o]=await r(n,!0);Object(ae.a)(t.ConversationId.Id).calendarInlineComposeViewState=Object.assign(Object.assign({},Object(ce.a)(19)),{referenceItemId:t.ItemId.Id,subject:t.Subject,location:null,smartTimeSuggestion:e,toRecipients:i,ccRecipients:o})})),se=n(1198);function ue(){const t=Object(m.k)("mc-smartReplyWithMeeting-Cortana"),e=Object(se.g)(se.d.CalendarHelp).calendarHelpEnabled;return t&&e}var de=n(12256);async function me(t){var e;let n=[];if(t){if(!t.SmartTimeExtendedProperty){const e=await jt.c.import(),n=await e(t.ItemId.Id,Ot.a.SmartTime);if(n){re(n,function(t){let e=null;const n=Object(m.k)("mc-smartReplyWithMeeting-MeetingScheduler")?Wt:qt;if(t){const r=t.ExtendedProperty;r&&r.some(t=>t.ExtendedFieldURI.PropertyName==n&&(e=t,!0))}return e}(n))}}const r=t.SmartTimeExtendedProperty;if(r){const i=r.entityId,o=100*r.confidenceScore,a=r.scheduler,l=r.rawConfidenceScores;let s=function(t){var e;if(null===(e=null==t?void 0:t.SmartTimeExtendedProperty)||void 0===e?void 0:e.beginingOfTimeRange)try{const e=Object(q.pc)(t.SmartTimeExtendedProperty.beginingOfTimeRange);if(Object($.e)(e)){let n=Number(t.SmartTimeExtendedProperty.duration);n<=0&&(n=Object(Jt.a)());const r=Object(q.h)(e,n),i=Object($t.h)(e,r);return{startTime:i.start,endTime:i.end}}}catch(t){throw c.h.warn("[getSmartTimeSuggestion] Unable to parse suggested time. Error: "+t.message),t.networkError=!0,t}return null}(t),u=null;s&&(await le(t,s),u=Object(ae.a)(null===(e=t.ConversationId)||void 0===e?void 0:e.Id).calendarInlineComposeViewState);const d=t,g=ue(),f=function(t,e,n,r,i,o,a){const c=Object(A.i)("SmartTime",Object(Z.b)(Ht.d),t,e),l=null!=o,s=i.ToRecipients?i.ToRecipients.length:0,u=i.CcRecipients?i.CcRecipients.length:0;c.mainPayload.rawConfidenceScores=r,c.mainPayload.scheduler=n,c.mainPayload.hasSuggestedTime=l,c.mainPayload.NumToRecipient=s,c.mainPayload.NumCCRecipient=u,c.mainPayload.isCalendarHelpEnabled=a,c.cosmosOnlyData=i.InternetMessageId,l&&(c.mainPayload.suggestedStartTime=o.startTime,c.mainPayload.suggestedEndTime=o.endTime);return c}(i,o,a,l,d,s,g);let p=null;g&&(p={items:fe(t,u,i,d,f)}),n.push(function(t,e,n,r,i,o,a){return{ariaLabel:Object(Z.b)(Ht.d),featureName:"SmartTime",onClick:n,index:t,logData:r,text:e,toolTip:Object(m.k)("mc-smartPillsTooltipV2")?Object(Z.b)(Ht.e):e,icon:o,confidenceScore:i,menuProps:a}}(n.length,Object(Z.b)(Ht.d),()=>ge(t,u,i,d,{SuggestionsClickedTime:(new Date).toISOString()}),f,o,{iconName:"DateTime2"},p))}}else c.h.info("[getSmartTimesForItem] No item, cannot produce smart times.");return n}function ge(t,e,n,r,i){window.addEventListener("message",pe),ie.r.importAndExecute(t.ItemId.Id,e,!1,null,n,r.InternetMessageId,i)}function fe(t,e,n,r,i){const o=[];return o.push({key:"OutlookMeeting",text:Object(Z.b)(Ht.c),onClick:()=>{Object(A.j)(A.g,i,{subtype:"OutlookMeeting"});const o=(new Date).toISOString();ge(t,e,n,r,{SuggestionsClickedTime:o,IsSmartTimeSuggestionsClicked:o?"True":"False"})}}),o.push({key:"CortanaMeeting",text:Object(Z.b)(Ht.a),onClick:()=>{Object(A.j)(A.g,i,{subtype:"CortanaMeeting"}),function(t){Rt.h.importAndExecute(t.ItemId.Id,t.ConversationId.Id,Object(Z.b)(Ht.b),2)}(t)}}),o}const pe=t=>{if((null==t?void 0:t.data)&&"string"==typeof t.data){const e=JSON.parse(t.data);e&&"calDraftItem"===e.source&&de.a.importAndExecute({featureName:"SmartTime"})}};function be(t){return{buildPills:async()=>me(t),getName:()=>"SmartTime"}}function Se(t){return{updateLogData:e=>{var n,r;if(t){const i=null===(n=t.stampedLanguage)||void 0===n?void 0:n.language,o=null===(r=t.stampedLanguage)||void 0===r?void 0:r.locale,a=t.InternetMessageId;e.forEach(t=>{t.logData.mainPayload.language=i,t.logData.mainPayload.locale=o,t.logData.cosmosOnlyData=a})}},getName:()=>"ItemLevelDataUpdater"}}function he(t){return{preRun:async()=>{const e=await jt.c.import(),n=await e(t.ItemId.Id,Ot.a.LanguageAndLocale);n&&!n.stampedLanguage&&a(n)},getName:()=>"LanguagePreRunner"}}var Oe=n(18179),je=n(5754);const ye={SmartPillFeedbackGenericOption1:"Not relevant",SmartPillFeedbackGenericOption2:"Too similar",SmartPillFeedbackGenericOption3:"No reply needed",SmartPillFeedbackGenericOption4:"Doesn't sound like me",SmartPillFeedbackGenericOption5:"Offensive or rude",SmartPillFeedbackGenericOption6:"Not in the correct language",SmartPillFeedbackGenericOption7:"Other",SmartPillFeedbackGenericOption8:"Helpful",SmartPillFeedbackMeetingOption1:"The meeting is already on my calendar",SmartPillFeedbackMeetingOption2:"A meeting suggestion isn't relevant",SmartPillFeedbackMeetingOption3:"I'm not the person who should schedule the meeting",SmartPillFeedbackMeetingOption4:"I want to schedule the meeting later",SmartPillFeedbackMeetingOption5:"I don't want help scheduling a meeting",SmartPillFeedbackFileOption1:'"Attach a file" suggestion isn\'t relevant',SmartPillFeedbackFileOption2:"I'm not the one who needs to attach a file",SmartPillFeedbackFileOption3:"Didn't find the file I was looking for",SmartPillFeedbackFileOption4:"Didn't get any file suggestions",SmartPillFeedbackFileOption5:"Want to attach a file later"};function ve(t,e){let n;e.UniqueBody?n=e.UniqueBody.Value:e.NormalizedBody&&(n=e.NormalizedBody.Value);const r={subtitle:void 0,dSATOptions:void 0,donationJson:{messageBody:n}},i=t.some(t=>"SmartTime"===t.featureName),o=t.some(t=>"SmartDoc"===t.featureName),a=t.some(t=>"SmartReply"===t.featureName);if(i&&o&&c.h.warn("[SmartPillFeedbackData] feedback options not defined for Smart Time + Smart Doc"),!a&&!i&&!o)return r.subtitle=Object(Z.b)(Oe.o),r;const l=Object(m.k)("mc-smartPillsMessageViewOnTop");return r.dSATOptions=l?[{logString:ye.SmartPillFeedbackGenericOption8,uiString:Object(Z.b)(Oe.n)}]:[],a?(r.subtitle=Object(Z.b)(Oe.o),r.dSATOptions.push({logString:ye.SmartPillFeedbackGenericOption1,uiString:Object(Z.b)(Oe.g)}),i?r.dSATOptions.push({logString:ye.SmartPillFeedbackGenericOption4,uiString:Object(Z.b)(Oe.j)},{logString:ye.SmartPillFeedbackGenericOption5,uiString:Object(Z.b)(Oe.k)},{logString:ye.SmartPillFeedbackMeetingOption3,uiString:Object(Z.b)(Oe.s)},{logString:ye.SmartPillFeedbackMeetingOption5,uiString:Object(Z.b)(Oe.u)}):o?r.dSATOptions.push({logString:ye.SmartPillFeedbackGenericOption5,uiString:Object(Z.b)(Oe.k)},{logString:ye.SmartPillFeedbackFileOption2,uiString:Object(Z.b)(Oe.b)},{logString:ye.SmartPillFeedbackFileOption3,uiString:Object(Z.b)(Oe.c)},{logString:ye.SmartPillFeedbackFileOption5,uiString:Object(Z.b)(Oe.e)}):r.dSATOptions.push({logString:ye.SmartPillFeedbackGenericOption2,uiString:Object(Z.b)(Oe.h)},{logString:ye.SmartPillFeedbackGenericOption3,uiString:Object(Z.b)(Oe.i)},{logString:ye.SmartPillFeedbackGenericOption4,uiString:Object(Z.b)(Oe.j)},{logString:ye.SmartPillFeedbackGenericOption5,uiString:Object(Z.b)(Oe.k)},{logString:ye.SmartPillFeedbackGenericOption6,uiString:Object(Z.b)(Oe.l),l2SubCategories:Object(je.c)().supportedCultures.map(t=>({text:t.NativeName,key:t.Name}))})):i?(r.subtitle=Object(Z.b)(Oe.v),r.dSATOptions.push({logString:ye.SmartPillFeedbackMeetingOption1,uiString:Object(Z.b)(Oe.q)},{logString:ye.SmartPillFeedbackMeetingOption2,uiString:Object(Z.b)(Oe.r)},{logString:ye.SmartPillFeedbackMeetingOption3,uiString:Object(Z.b)(Oe.s)},{logString:ye.SmartPillFeedbackMeetingOption4,uiString:Object(Z.b)(Oe.t)},{logString:ye.SmartPillFeedbackMeetingOption5,uiString:Object(Z.b)(Oe.u)})):o&&(r.subtitle=Object(Z.b)(Oe.f),r.dSATOptions.push({logString:ye.SmartPillFeedbackFileOption1,uiString:Object(Z.b)(Oe.a)},{logString:ye.SmartPillFeedbackFileOption2,uiString:Object(Z.b)(Oe.b)},{logString:ye.SmartPillFeedbackFileOption3,uiString:Object(Z.b)(Oe.c)},{logString:ye.SmartPillFeedbackFileOption4,uiString:Object(Z.b)(Oe.d)},{logString:ye.SmartPillFeedbackFileOption5,uiString:Object(Z.b)(Oe.e)})),r.dSATOptions.push({logString:ye.SmartPillFeedbackGenericOption7,uiString:Object(Z.b)(Oe.m)}),l&&(r.subtitle=Object(Z.b)(Oe.p)),r}var Ie=n(5384);var we=n(9657),xe=n(11496),Ee=n(2996),Pe=n(5332),Te=n(18180),Ce=n.n(Te);var Re=Object(u.a)((function(t){var e,n,r;D.useEffect(()=>(p(),()=>{a.current=null,l.current=null,m.current=null,u.current=null,i(t.viewState,!1)}),[]),D.useEffect(()=>{g.current||(g.current=Object(we.b)(t.item))});const o=D.useContext(Ee.a),a=D.useRef(function(t){return[be(t),wt(t),Zt(t)]}(t.item)),l=D.useRef(h),s=D.useRef(function(t){return[Se(t)]}(t.item)),u=D.useRef(function(t){return[he(t)]}(t.item)),m=D.useRef(),g=D.useRef(!1),f=Object(d.a)(()=>{var e;const{item:n}=t;return!(null===(e=null==n?void 0:n.ItemId)||void 0===e||!e.Id)&&null!=Object(I.a)(n.ItemId.Id,1,!1,Object(Pe.a)(o))}),p=async()=>{c.h.info("[MailSmartPillBlock] Running smart pill builders"),m.current=await Object(A.h)(a.current,l.current,u.current,s.current,3e3),function(t,e){const n=e?e.pillsToShow.filter(t=>"SmartReply"===t.featureName):[],r=n.length>0?n[0].logData.mainPayload.EID:"",i=e&&e.pillsToShow.length>0?"True":"False",o="True"===i?e.pillsToShow.map(t=>t.featureName).toString():"",a="True"===i?e.pillsToShow.map(t=>t.text).join("$"):"";Object(Ie.a)(t.ItemId.Id,i,o,a,r)}(t.item,m.current),m.current&&m.current.pillsToShow.length>0&&i(t.viewState,!0)},{item:b,viewState:S,showOnTop:O}=t,{smartPillBlockVisible:j}=S,y=!!b.RightsManagementLicenseData,v=(null===(n=null===(e=b.AdaptiveCardData)||void 0===e?void 0:e.cardDetails)||void 0===n?void 0:n.length)>0&&"3f0a4969-053e-44be-9931-ca62d0c32bde"!==(null===(r=b.AdaptiveCardData)||void 0===r?void 0:r.cardDetails[0].connectorSenderGuid);if(y||!j||!m.current||0==m.current.pillsToShow.length&&0==m.current.pillsToHide.length||f.get()||v)return null;const w=m.current.pillsToShow.length>0;return D.createElement("div",{className:w&&!O?Ce.a.bar:void 0},D.createElement(xe.a,{arbitratedPills:m.current,enableFeedbackForm:!b.smartPillFeedbackSubmitted,isConversationItemPart:t.isConversationItemPart,feedbackData:ve(m.current.pillsToShow,b),showOnTop:O,localeInfo:b.stampedLanguage}))}));n.d(e,"MailSmartPillBlock",(function(){return Re}))},2352:function(t,e,n){"use strict";t.exports=function(t,e){return"string"!=typeof t?t:(/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),/["'() \t\n]/.test(t)||e?'"'.concat(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):t)}},2739:function(t,e,n){"use strict";var r=n(20);function i(t){return Object.assign({__type:"SetMailboxMessageConfigurationRequest:#Exchange"},t)}var o=n(35);var a=n(167);function c(t){return void 0===(e=i({Header:Object(a.b)(),Options:(r=t,Object.assign({__type:"MailboxMessageConfigurationOptions:#Exchange"},r))}))||e.__type||(e=i(e)),Object(o.a)("SetMailboxMessageConfiguration",e,n);var e,n,r}function l(t,e){return null===t?e:t}function s(t,e,n,i,o){const a=new r.b(e,n),c=i&&o?new r.b(i,o):null;return Object.assign(Object.assign({},t),{tryImportFullOptionFormSettingsSync:()=>a.tryImportForRender(),tryImportQuickOptionSettingsSync:c?()=>c.tryImportForRender():void 0})}function u(t){const e=t.options.map(t=>!function(t){return"fullOptionFormSettings"in t}(t)?Object.assign(Object.assign({},t),{fullOptionFormSettings:t.tryImportFullOptionFormSettingsSync()}):t);return e.some(({fullOptionFormSettings:t})=>!t)?null:e}var d=n(3271);n.d(e,"e",(function(){return g})),n.d(e,"a",(function(){return f})),n.d(e,"f",(function(){return c})),n.d(e,"c",(function(){return l})),n.d(e,"b",(function(){return s})),n.d(e,"g",(function(){return u})),n.d(e,"d",(function(){return d.a}));const m=new r.c(()=>Promise.all([n.e(1),n.e(2),n.e(3),n.e(4),n.e(11),n.e(15),n.e(608)]).then(n.bind(null,20081)));let g=new r.a(m,t=>t.confirmOptionNavigation),f=Object(r.d)(m,t=>t.OptionsEditor)},2835:function(t,e,n){"use strict";n.d(e,"l",(function(){return g})),n.d(e,"n",(function(){return f})),n.d(e,"k",(function(){return p})),n.d(e,"m",(function(){return b}));var r=n(20),i=n(3015);n.d(e,"b",(function(){return i.a}));var o=n(2997);n.d(e,"i",(function(){return o.a}));n(2840);var a=n(2841);n.d(e,"d",(function(){return a.a})),n.d(e,"e",(function(){return a.b})),n.d(e,"o",(function(){return a.c}));var c=n(2998);n.d(e,"a",(function(){return c.b}));var l=n(2894);n.d(e,"g",(function(){return l.a})),n.d(e,"h",(function(){return l.b}));var s=n(2994);n.d(e,"j",(function(){return s.a}));var u=n(2906);n.d(e,"c",(function(){return u.a}));var d=n(2985);n.d(e,"f",(function(){return d.b}));const m=new r.c(()=>Promise.all([n.e(0),n.e(839)]).then(n.bind(null,3947))),g=new r.b(m,t=>t.loadProviders),f=new r.b(m,t=>t.removeFileProvider),p=new r.b(m,t=>t.addFileProvider),b=new r.b(m,t=>t.removeAndAddFileProvider)},2840:function(t,e,n){"use strict";var r=n(2),i=n(13),o=n(2906);const a={providers:new i.ObservableMap,loadState:o.a.NotLoaded,removalPending:new i.ObservableMap},c=Object(r.createStore)("fileProviderStore",a);e.a=c},2841:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return a}));var r=n(2);const i=Object(r.action)("FILE_PROVIDER_ADDED",t=>({providerViewState:t})),o=Object(r.action)("FILE_PROVIDER_REMOVED",t=>({providerType:t})),a=Object(r.action)("PROVIDERS_LOADED",t=>({providers:t}))},2894:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return o}));var r=n(2840);const i=()=>[...Object(r.a)().providers.values()],o=t=>Object(r.a)().providers.get(t)||null},2906:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.Loaded=0]="Loaded",t[t.Loading=1]="Loading",t[t.NotLoaded=2]="NotLoaded",t[t.Throttled=3]="Throttled"}(r||(r={}))},2968:function(t,e,n){"use strict";var r=n(2);e.a=Object(r.createStore)("generalOptions",{supportedCultures:[],supportedShortDateFormats:[],supportedShortTimeFormats:[],supportedTimeZones:[],selectedLocale:null,shouldRenameDefaultFolders:!0,selectedDateFormat:null,selectedTimeFormat:null,selectedTimeZone:null,hasUserChangedLanguage:!1,roamingTimeZoneNotificationIsDisabled:void 0,primaryTimezoneLabel:null,additionalTimezones:[]})},2985:function(t,e,n){"use strict";var r=n(35);function i(t){return Object.assign({__type:"GetNewAttachmentDataProviderCreationInfoRequest:#Exchange"},t)}function o(t){const e=i({ProviderType:t});return void 0===(n=e)||n.__type||(n=i(n)),Object(r.a)("GetNewAttachmentDataProviderCreationInfo",n,o);var n,o}function a(t){return Object.assign({__type:"GetAttachmentDataProviderCreatorRequest:#Exchange"},t)}function c(t){const e=a({ProviderType:t});return void 0===(n=e)||n.__type||(n=a(n)),Object(r.a)("GetAttachmentDataProviderCreator",n,i);var n,i}var l=n(3255),s=n(3212);n.d(e,"a",(function(){return S})),n.d(e,"b",(function(){return j}));const u="code",d="token",m=3e3,g=3;function f(t){return{state:t}}function p(t){return t.state}function b(t){return t.code}function S(t,e,n,r,i){const a={providerType:t,getAuthUrlInfo:null,getCSRFToken:p,getOAuthCode:b};return async function t(e,n,r,i,a,s,u){try{let t;if(7===e||9===e||8===e){const n=await c(e);t=n.AttachmentDataProviderCreator.ProviderAppKey,r=n.AttachmentDataProviderCreator.AuthorizationUri}else{t=(await o(e)).ProviderAppKey}n.getAuthUrlInfo=Object(l.d)(e,r,i,t,a,s)}catch(o){u>0&&setTimeout(()=>t(e,n,r,i,a,s,--u),m)}}(t,a,e,n,r,i,g),a}let h=null;function O(){if(!h){if(h={},Object(s.a)(3)&&(h[3]=S(3,"https://app.box.com/api/oauth2/authorize",Object(l.c)(3),u,f)),Object(s.a)(2)&&(h[2]=S(2,"https://www.dropbox.com/oauth2/authorize",Object(l.b)(2),u,f)),Object(s.a)(6)){const t=S(6,"https://www.facebook.com/dialog/oauth",Object(l.b)(6),d,t=>({state:t,scope:"user_photos,email"}));t.getCSRFToken=p,t.getOAuthCode=t=>t.access_token,h[6]=t}if(Object(s.a)(5)){const t=S(5,"https://accounts.google.com/o/oauth2/auth",`${l.a}/ADPRedirect.aspx`,u,t=>{const e={state:t,provider:5..toString(),url:Object(l.b)()};return{state:JSON.stringify(e),scope:"https://www.googleapis.com/auth/drive",access_type:"offline",prompt:"consent",include_granted_scopes:"true"}});t.getCSRFToken=t=>{return JSON.parse(t.state).state},h[5]=t}Object(s.a)(1)&&(h[1]=S(1,"https://login.live.com/oauth20_authorize.srf",Object(l.c)(1),u,t=>({state:t,scope:"wl.basic onedrive.readwrite wl.offline_access"}))),Object(s.a)(7)&&(h[7]=S(7,"",Object(l.c)(7),u,f)),Object(s.a)(8)&&(h[8]=S(8,"",Object(l.c)(8),u,f)),Object(s.a)(9)&&(h[9]=S(9,"",Object(l.c)(9),u,f))}return h}function j(t){const e=O();return t in e?e[t]:null}},2994:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(2840);function i(){return Object(r.a)().loadState}},2997:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(3279),i=n(3228),o=n(3265),a=n(6),c=n(72);function l(t,e=!1){if(e)return"";switch(t){case 0:return Object(a.b)(o.b);case 1:return Object(a.b)(o.a);case 2:case 9:return Object(a.b)(r.b);case 3:case 7:return Object(a.b)(r.a);case 5:return Object(a.b)(r.e);case 6:return Object(a.b)(r.d);case 4:return Object(a.b)(r.f);case 10:return Object(a.b)(i.b);case 8:return Object(a.b)(r.c);default:return Object(c.a)(t)}}},2998:function(t,e,n){"use strict";var r;n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return o})),function(t){t[t.Groups=1e4]="Groups"}(r||(r={}));const i=Object.freeze([1,3,2,6,5,7,8,9]),o=Object.freeze([...i,0,4,10])},3015:function(t,e,n){"use strict";var r;!function(t){t[t.None=0]="None",t[t.Images=1]="Images"}(r||(r={})),e.a=r},3172:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}));var r=n(2);let i=Object(r.action)("NEW_MESSAGE_V3",(t,e,n,r,i)=>({actionSource:t,groupId:e,toEmailAddressWrappers:n,subject:r,body:i}));const o=Object(r.action)("ON_CLOSE_COMPOSE",t=>({closeReason:t}))},3182:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));let r=0;function i(t){return`${t}_${r++}`}function o(t,e=null,n=!1){return{editorId:i(t),content:e,isDirty:n,textDirection:null,keyStrokeCount:0,selectedImage:null}}},3184:function(t,e,n){"use strict";var r=n(20),i=n(3543),o=n(3163),a=n(3077),c=n(3117),l=n(3285),s=n(3275),u=n(3377),d=n(3570),m=n(3427),g=n(2829),f=n(2740);function p(t,e){return!!t&&(1!==e&&!!f.a.conversations.get(t))}function b(t,e){return 2!=e&&g.a.loadedItemReadingPaneViewStates.has(t)}var S=n(3259),h=n(3260),O=n(3173),j=n(2913);n.d(e,"l",(function(){return v})),n.d(e,"p",(function(){return I})),n.d(e,"m",(function(){return w})),n.d(e,"q",(function(){return x})),n.d(e,"s",(function(){return E})),n.d(e,"n",(function(){return P})),n.d(e,"o",(function(){return T})),n.d(e,"i",(function(){return C})),n.d(e,"j",(function(){return R})),n.d(e,"k",(function(){return D})),n.d(e,"g",(function(){return k})),n.d(e,"r",(function(){return F})),n.d(e,"h",(function(){return N})),n.d(e,"d",(function(){return p})),n.d(e,"e",(function(){return b})),n.d(e,"f",(function(){return S.a})),n.d(e,"a",(function(){return h.a})),n.d(e,"t",(function(){return g.a})),n.d(e,"c",(function(){return O.a})),n.d(e,"b",(function(){return j.a}));const y=new r.c(()=>Promise.all([n.e(0),n.e(5),n.e(6),n.e(9),n.e(13),n.e(15),n.e(18),n.e(25),n.e(27),n.e(30),n.e(42),n.e(62),n.e(73),n.e(98),n.e(156),n.e(168),n.e(190),n.e(257),n.e(237),n.e(280),n.e(417)]).then(n.bind(null,19704)));let v=new r.a(y,t=>t.loadConversationReadingPane),I=new r.a(y,t=>t.moveReadingPaneToTab),w=new r.a(y,t=>t.loadConversationReadingPaneForSingleMailItemSelected),x=new r.a(y,t=>t.print),E=new r.a(y,t=>t.setItemIdToScrollTo),P=new r.a(y,t=>t.loadItemReadingPane),T=new r.a(y,t=>t.loadItemReadingPaneForSingleMailItemSelected),C=new r.a(y,t=>t.expandCollapseAllItemParts);Object(r.f)(a.a,y,t=>t.deleteItemsStoreUpdateOrchestrator),Object(r.f)(l.a,y,t=>t.markConversationsAsReadStoreUpdateOrchestrator),Object(r.f)(s.a,y,t=>t.markItemsAsReadStoreUpdateOrchestrator),Object(r.f)(c.a,y,t=>t.markAllAsReadOrchestrator),Object(r.f)(i.a,y,t=>t.applyConversationFlagStateStoreUpdateOrchestrator),Object(r.f)(o.a,y,t=>t.deleteConversationStoreUpdateOrchestrator),Object(r.f)(m.a,y,t=>t.conversationReadyToLoadOrchestrator),Object(r.f)(m.b,y,t=>t.updateAttachmentsOrchestrator),Object(r.f)(m.c,y,t=>t.updateItemMandatoryPropertiesOrchestrator),Object(r.f)(u.a,y,t=>t.updateInternetMessageIdOrchestrator),Object(r.f)(d.a,y,t=>t.initializeExtendedCardForItemReadingPaneOrchestrator);new r.b(y,t=>t.getLastestNonDraftItemId);let R=new r.b(y,t=>t.getLatestNonDraftItemIdFromConversation),D=new r.b(y,t=>t.isUnsupportedItem),k=new r.a(y,t=>t.clearReadingPaneStore),F=new r.a(y,t=>t.replyByMeeting),N=new r.a(y,t=>t.ensureSecondaryReadingPaneTabHandler)},3211:function(t,e,n){"use strict";n.d(e,"b",(function(){return c})),n.d(e,"d",(function(){return l})),n.d(e,"c",(function(){return s})),n.d(e,"e",(function(){return u})),n.d(e,"g",(function(){return d})),n.d(e,"h",(function(){return m})),n.d(e,"f",(function(){return g})),n.d(e,"i",(function(){return f}));var r=n(20),i=n(3611);n.d(e,"a",(function(){return i.a}));var o=n(3773);n.d(e,"j",(function(){return o.c}));const a=new r.c(()=>Promise.all([n.e(0),n.e(26),n.e(781)]).then(n.bind(null,6462))),c=new r.b(a,t=>t.clearCachedAttachmentSuggestions),l=new r.b(a,t=>t.getAttachmentSuggestionsAction),s=new r.b(a,t=>t.createCloudFileFromAttachmentData),u=new r.b(a,t=>t.getAttachmentSuggestionsMenuItems),d=new r.b(a,t=>t.getAttachmentSuggestionsTraceId),m=new r.b(a,t=>t.getAttachmentSuggestionsTraceIdByComposeId),g=new r.b(a,t=>t.getAttachmentSuggestionsSessionIdByComposeId),f=new r.a(a,t=>t.logEntitiesFromFilePicker)},3212:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(2773),i=n(220),o=n(72),a=n(25);function c(t){const e=Object(r.a)();switch(t){case 5:return(null==e?void 0:e.GoogleDriveAttachmentsEnabled)&&(null==e?void 0:e.ThirdPartyAttachmentsEnabled)&&Object(a.k)("doc-fileProvider-gdrive");case 4:case 0:return!0;case 3:return(null==e?void 0:e.BoxAttachmentsEnabled)&&(null==e?void 0:e.ThirdPartyAttachmentsEnabled)&&Object(a.k)("doc-fileProvider-box");case 2:return(null==e?void 0:e.DropboxAttachmentsEnabled)&&(null==e?void 0:e.ThirdPartyAttachmentsEnabled)&&Object(a.k)("doc-fileProvider-dropbox");case 6:return(null==e?void 0:e.ThirdPartyAttachmentsEnabled)&&Object(a.k)("doc-fileProvider-facebook");case 1:return!!Object(i.a)()||(null==e?void 0:e.OnedriveAttachmentsEnabled)&&(null==e?void 0:e.ThirdPartyAttachmentsEnabled);case 10:return Object(a.k)("doc-filePicker-mailMessageAttachment");case 7:case 8:case 9:return(null==e?void 0:e.ThirdPartyAttachmentsEnabled)&&Object(a.k)("doc-fileProvider-wopiClient");default:return Object(o.a)(t)}}},3228:function(t){t.exports=JSON.parse('{"a":"Oja","b":"Pja"}')},3253:function(t,e,n){"use strict";var r=n(2),i=n(3172);Object(r.orchestrator)(i.a,t=>{l.importAndExecute(t.actionSource,t.groupId,t.toEmailAddressWrappers,t.subject,t.body)});var o=n(3650),a=(Object(r.orchestrator)(o.a,t=>{const{source:e,groupId:n,toRecipients:r,subject:o,body:a}=t;Object(i.a)(e,n,r,o,a)}),n(20));n.d(e,"c",(function(){return l})),n.d(e,"f",(function(){return s})),n.d(e,"a",(function(){return u})),n.d(e,"d",(function(){return d})),n.d(e,"g",(function(){return m})),n.d(e,"b",(function(){return g})),n.d(e,"e",(function(){return f})),n.d(e,"i",(function(){return p})),n.d(e,"h",(function(){return b}));const c=new a.c(()=>Promise.all([n.e(23),n.e(19),n.e(31),n.e(36),n.e(529)]).then(n.bind(null,19827)));let l=new a.a(c,t=>t.newMessage,{captureBundleTime:!0}),s=new a.a(c,t=>t.replyToConversation),u=new a.a(c,t=>t.forwardConversation),d=new a.a(c,t=>t.printConversation),m=new a.a(c,t=>t.replyToItem),g=new a.a(c,t=>t.forwardItem),f=new a.a(c,t=>t.printItem),p=new a.a(c,t=>t.showConversationInImmersiveReader),b=new a.a(c,t=>t.replyWithText)},3255:function(t,e,n){"use strict";var r=n(483),i=n(3);function o(t,e,n){if(!t||!e||!n)throw new Error("Key and Value parameters should not be null");return t.indexOf("?")>0?`${t}&${e}=${n}`:`${t}?${e}=${n}`}n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return c})),n.d(e,"c",(function(){return l})),n.d(e,"d",(function(){return s}));const a=Object(i.R)()?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa";function c(t){const e=t?encodeURIComponent(`?provider=${t}`):"",n=t&&6===t?"AddFacebookFileProvider.html":"AddFileProvider.html";return`${Object(r.n)()}/mail/${n}${e}`}function l(t){const e=`${Object(r.n)()}/mail/AddFileProvider.html`,n=encodeURIComponent(`provider=${t}&url=${e}`);return`${a}/ADPRedirect.aspx?${n}`}function s(t,e,n,r,i,a){return()=>{const t=function(){const t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),e=t.length-1,n=[];for(let r=0;r<16;r++)n.push(t[Math.round(Math.random()*e)]);return"owa_csrf_token_"+n.join("")}();let c=o(e,"client_id",r);if(c=o(c,"redirect_uri",n),c=o(c,"response_type",i),a){const e=a(t);c=Object.keys(e).reduce((t,n)=>o(t,n,e[n]),c)}return{authUrl:c,redirectUrl:n,csrfToken:t}}}},3265:function(t){t.exports=JSON.parse('{"b":"Qja","a":"Rja"}')},3271:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(2);const i=Object(r.action)("HIDE_FULL_OPTION",(t,e)=>({showQuickOptions:t,subcategory:e}))},3279:function(t){t.exports=JSON.parse('{"b":"Ija","a":"Jja","e":"Kja","d":"Lja","f":"Mja","c":"Nja"}')},3303:function(t,e,n){"use strict";function r(t){return Object.assign({__type:"GetRegionalConfigurationRequest:#Exchange"},t)}n.d(e,"a",(function(){return r}))},3565:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(35),i=n(3303);function o(t,e){return void 0===t||t.__type||(t=Object(i.a)(t)),Object(r.a)("GetRegionalConfiguration",t,e)}},3566:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(35);function i(t){return Object(r.a)("GetOwaUserConfiguration",{},t)}},3611:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.Contextual=0]="Contextual",t[t.MRUCloudy=1]="MRUCloudy",t[t.MRUClassic=2]="MRUClassic",t[t.MRUContextual=3]="MRUContextual",t[t.MRUClassicContextual=4]="MRUClassicContextual"}(r||(r={}))},3615:function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return c}));var r=n(3),i=n(46),o=n(52);function a(){let t=Object(r.v)("targetServer"),e="DefaultAnchorMailbox"+(t?"_"+t.toLocaleLowerCase():"");return Object(r.v)(e)}function c(){let t=function(){let t="",e=Object(i.b)().pathname.split("/").filter(t=>t.length);return e.length>=2&&e[1].match(/.+@.+/)&&(t=e[1]),t}();if(0===t.length){let e=Object(o.g)();if(null==e?void 0:e.SessionSettings){let n=e.SessionSettings.ExternalDirectoryTenantGuid,r=e.SessionSettings.UserPuid;r&&n&&(t=`PUID:${r}@${n}`)}}return 0===t.length&&(t=a()),t}},3650:function(t,e,n){"use strict";var r=n(2);e.a=Object(r.action)("createFeedbackForCortana",(t,e,n,r,i)=>({source:t,groupId:e,toRecipients:n,subject:r,body:i}))},3773:function(t){t.exports=JSON.parse('{"b":"EDb","a":"FDb","c":"GDb","d":"HDb"}')},3837:function(t,e,n){"use strict";var r=n(2);const i=Object(r.action)("languageChanged");var o=n(3303),a=n(3565);function c(){return Object(a.a)(Object(o.a)({}))}var l=n(571);function s(){return Object(l.a)({needTimeZoneList:!0}).then(t=>t.TimeZoneList)}var u=n(6),d=n(529),m=n(52),g=n(25),f=n(3566),p=n(1539),b=n(4716);var S=n(167);var h=n(488),O=n(4555);var j=function(t,e,n,r){let{UserOptions:o,SessionSettings:a}=Object(m.g)(),c=(l=a.UserCulture,s=n,j=o.DateFormat,y=o.TimeFormat,v=o.TimeZone,Object(b.a)({Header:Object(S.b)(),Options:(I={Language:l,LocalizeDefaultFolderName:s,DateFormat:j,TimeFormat:y,TimeZone:v},Object.assign({__type:"SetMailboxRegionalConfigurationData:#Exchange"},I)),SkipUserCultureCookies:!1}));var l,s,j,y,v,I;let w=[c];if(t&&(w.push(c.then(i)),Object(g.k)("fwk-localeHotReload")&&r)){let t=Object(d.b)(r);Object(u.l)(t.locale,t.dir)}return e&&w.push(c.then(async()=>{const t=await Object(f.a)();Object(h.a)(t),Object(p.b)(t),Object(O.a)()})),w};n.d(e,"d",(function(){return i})),n.d(e,"a",(function(){return c})),n.d(e,"c",(function(){return s})),n.d(e,"b",(function(){return j}))},4127:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.None=0]="None",t[t.FileSuggestion=1]="FileSuggestion",t[t.LocalFiles=2]="LocalFiles",t[t.CloudFiles=3]="CloudFiles",t[t.UploadAndShare=4]="UploadAndShare"}(r||(r={}))},4145:function(t,e,n){"use strict";var r=n(2),i=n(66);const o=Object(r.action)("neverShowDialogAgain"),a=Object(r.action)("newRoamingTimeZone",t=>({timeZone:t})),c=Object(i.a)("toggleRoamingTimeZoneNotificationIsDisabled",t=>({isDisabled:t}),t=>({customData:{isDisabled_1:t.isDisabled}}));var l=n(1198);function s(){return Object(l.g)(l.d.CalendarSurfaceOptions).lastKnownRoamingTimeZone}function u(){return Object(l.g)(l.d.CalendarSurfaceOptions).roamingTimeZoneNotificationsIsDisabled}function d(t){c(t);const e=Object(l.g)(l.d.CalendarSurfaceOptions);l.i.importAndExecute(l.d.CalendarSurfaceOptions,Object.assign(Object.assign({},e),{roamingTimeZoneNotificationsIsDisabled:t}))}Object(r.orchestrator)(o,()=>{const t=Object(l.g)(l.d.CalendarSurfaceOptions);l.i.importAndExecute(l.d.CalendarSurfaceOptions,Object.assign(Object.assign({},t),{roamingTimeZoneNotificationsIsDisabled:!0}))}),Object(r.orchestrator)(a,t=>{const e=Object(l.g)(l.d.CalendarSurfaceOptions);l.i.importAndExecute(l.d.CalendarSurfaceOptions,Object.assign(Object.assign({},e),{lastKnownRoamingTimeZone:t.timeZone}))}),Object(r.mutator)(o,()=>{Object(l.g)(l.d.CalendarSurfaceOptions).roamingTimeZoneNotificationsIsDisabled=!0}),Object(r.mutator)(a,t=>{Object(l.g)(l.d.CalendarSurfaceOptions).lastKnownRoamingTimeZone=t.timeZone}),Object(r.mutator)(c,t=>{Object(l.g)(l.d.CalendarSurfaceOptions).roamingTimeZoneNotificationsIsDisabled=t.isDisabled}),n.d(e,"c",(function(){return o})),n.d(e,"d",(function(){return a})),n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return u})),n.d(e,"e",(function(){return d}))},418:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t.ShouldEventsEndEarly="Should_Event_End_Early",t.ShortenEventScope="shorten_event_scope",t.EndShortEventsBy="End_Short_meetings_by",t.EndLongEventsBy="End_long_meetings_by",t.EnableOnlineMeetingsByDefault="onlinemeetings_enabledbydefault"}(r||(r={}))},4427:function(t,e,n){"use strict";var r,i=n(20),o=n(5384),a=n(2),c=n(2742);Object(a.mutator)(o.a,t=>{const{itemId:e,isSmartSuggestionsRendered:n,suggestionTypesRendered:r,suggestionsRendered:i,extractionId:o}=t,a=Object(c.g)().items.get(e);(null==a?void 0:a.SIGSData)&&(a.SIGSData.SmartPillData={IsSmartSuggestionsRendered:n,SuggestionTypesRendered:r,SuggestionsRendered:i,ExtractionId:o})});!function(t){t.LanguageAndLocale="SmartPill_LanguageAndLocale",t.SmartDoc="SmartPill_SmartDoc",t.SmartReply="SmartPill_SmartReply",t.SmartTime="SmartPill_SmartTime"}(r||(r={}));var l=n(4127);function s(t){return{smartReplyComposeSIGSData:{isSmartSuggestionsClicked:!1,suggestionsClickedTime:null,clickIndex:-1},smartDocOption:t||l.a.None}}n.d(e,"c",(function(){return d})),n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return s}));const u=new i.c(()=>n.e(1364).then(n.bind(null,19539)));let d=new i.a(u,t=>t.logToSIGSOnMessageSent)},4555:function(t,e,n){"use strict";var r=n(2);e.a=Object(r.action)("updateSurfaceOptions")},4716:function(t,e,n){"use strict";var r=n(35);function i(t,e){var n;return void 0===t||t.__type||(n=t,t=Object.assign({__type:"SetMailboxRegionalConfigurationRequest:#Exchange"},n)),Object(r.a)("SetMailboxRegionalConfiguration",t,e)}n.d(e,"a",(function(){return i}))},5206:function(t,e,n){"use strict";var r=n(2968),i=n(2);e.a=Object(i.mutatorAction)("setRegionalOptionRoamingTimeZoneNotificationIsDisabled",(function(t){Object(r.a)().roamingTimeZoneNotificationIsDisabled=t}))},523:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(13),i=n(2);const o={settings:new r.ObservableMap},a=Object(i.createStore)("CalendarCloudSettings",o)},529:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return a}));const r="en",i={en:{dir:"ltr"},af:{dir:"ltr"},am:{dir:"ltr"},ar:{dir:"rtl"},"as-IN":{dir:"ltr"},"az-Latn-AZ":{dir:"ltr"},bg:{dir:"ltr"},"bn-IN":{dir:"ltr"},"bs-Latn-BA":{dir:"ltr"},ca:{dir:"ltr"},"ca-Es-VALENCIA":{dir:"ltr"},cs:{dir:"ltr"},cy:{dir:"ltr"},da:{dir:"ltr"},de:{dir:"ltr"},el:{dir:"ltr"},"en-GB":{dir:"ltr"},es:{dir:"ltr"},"es-MX":{dir:"ltr"},et:{dir:"ltr"},eu:{dir:"ltr"},fa:{dir:"rtl"},fi:{dir:"ltr"},fil:{dir:"ltr"},fr:{dir:"ltr"},"fr-CA":{dir:"ltr"},"ga-IE":{dir:"ltr"},"gd-gb":{dir:"ltr"},gl:{dir:"ltr"},gu:{dir:"ltr"},he:{dir:"rtl"},hi:{dir:"ltr"},hr:{dir:"ltr"},hu:{dir:"ltr"},hy:{dir:"ltr"},id:{dir:"ltr"},is:{dir:"ltr"},it:{dir:"ltr"},ja:{dir:"ltr"},ka:{dir:"ltr"},kk:{dir:"ltr"},"km-KH":{dir:"ltr"},kn:{dir:"ltr"},ko:{dir:"ltr"},kok:{dir:"ltr"},"lb-LU":{dir:"ltr"},"lo-LA":{dir:"ltr"},lt:{dir:"ltr"},lv:{dir:"ltr"},"mi-NZ":{dir:"ltr"},mk:{dir:"ltr"},ml:{dir:"ltr"},mr:{dir:"ltr"},ms:{dir:"ltr"},"mt-MT":{dir:"ltr"},"ne-NP":{dir:"ltr"},nl:{dir:"ltr"},"nn-NO":{dir:"ltr"},no:{dir:"ltr"},or:{dir:"ltr"},"pa-IN":{dir:"ltr"},pl:{dir:"ltr"},pt:{dir:"ltr"},"pt-PT":{dir:"ltr"},"quz-PE":{dir:"ltr"},ro:{dir:"ltr"},ru:{dir:"ltr"},sk:{dir:"ltr"},sl:{dir:"ltr"},sq:{dir:"ltr"},sr:{dir:"ltr"},"sr-Cyrl":{dir:"ltr"},"sr-Cyrl-BA":{dir:"ltr"},sv:{dir:"ltr"},ta:{dir:"ltr"},te:{dir:"ltr"},th:{dir:"ltr"},tr:{dir:"ltr"},tt:{dir:"ltr"},"ug-CN":{dir:"rtl"},uk:{dir:"ltr"},ur:{dir:"rtl"},uz:{dir:"ltr"},vi:{dir:"ltr"},"zh-Hans":{dir:"ltr"},"zh-Hant":{dir:"ltr"}},o={"en-us":"en","nb-no":"no","ne-ne":"ne-NP","quz-bo":"quz-PE","quz-ec":"quz-PE","zh-cn":"zh-Hans","zh-hk":"zh-Hant","zh-mo":"zh-Hant","zh-sg":"zh-Hans","zh-tw":"zh-Hant"};function a(t){let e=t.toLowerCase().split("-");for(;e.length>0;){let t=e.join("-"),n=o[t];if(n)return l(n);for(const e of Object.keys(i))if(c(e,t))return l(e);e.pop()}return Object.assign(Object.assign({},l(r)),{localeNotFound:!0})}function c(t,e){try{return!t.localeCompare(e,[],{sensitivity:"base"})}catch(t){return!1}}function l(t){return Object.assign({locale:t},i[t])}},5384:function(t,e,n){"use strict";var r=n(2);e.a=Object(r.action)("initializeSIGSDataAction",(t,e,n,r,i)=>({itemId:t,isSmartSuggestionsRendered:e,suggestionTypesRendered:n,suggestionsRendered:r,extractionId:i}))},5392:function(t,e,n){"use strict";var r=n(2968),i=n(2);e.a=Object(i.mutatorAction)("setPrimaryTimezoneLabel",(function(t){Object(r.a)().primaryTimezoneLabel=t}))},5454:function(t,e,n){"use strict";const r=2500;var i=n(68),o=n(3797);function a(t,e,n){const r=new o.a(t,e,{isCore:!0,excludeFromKusto:!0});n&&r.addCosmosOnlyData(n),i.n.importAndExecute(r)}async function c(t,e,n,o,c){const s={},u=c||r;n&&await Promise.all(n.map(t=>t.preRun().catch(e=>{s[t.getName()]=new Error(e)})));const d=new i.b("SmartPillPerformance",{sessionSampleRate:10});d.addCustomProperty("preDefinedTimeout",u);const m=await Promise.all(t.map(t=>Promise.race([t.buildPills(),l(u)]).catch(e=>(s[t.getName()]=new Error(e),[])))).then(t=>(d.end(),t)),g=[].concat.apply([],m);let f=g.length;o&&o.map(t=>{try{t.updateLogData(g)}catch(e){s[t.getName()]=new Error(e)}});let p={pillsToShow:[],pillsToHide:[],arbitratorId:""};try{p=e.arbitratePills(g)}catch(t){s.arbitrator=new Error(t)}const b=Object.keys(s);if(b.length>0){const t=[],e=[];b.forEach(n=>{const r=s[n];r.hasOwnProperty("networkError")?t.push(n+"_"+r.message):e.push(n+"_"+r.message)}),a("SmartPillError",[t.toString(),e.toString(),f])}return p}function l(t){return new Promise((e,n)=>{setTimeout((function(){const t=new Error("timeout");t.networkError=!0,n(t)}),t)})}function s(t,e,n,r,i){return{mainPayload:{renderStory:0,loggableText:e,type:t,position:-1,EID:n,confidenceScore:r},cosmosOnlyData:i}}function u(t,e,n,r){let i=void 0;t.concat(e).forEach(t=>{!i&&t.logData.cosmosOnlyData&&(i=t.logData.cosmosOnlyData)});const o={data:t.map(t=>t.logData.mainPayload)},c={data:e.map(t=>t.logData.mainPayload)},l=r?"conversationView":"itemView",s=t.length>0?t[0].logData.mainPayload.language:null;a("SmartPillsRendered",[t.length,e.length,JSON.stringify(o),JSON.stringify(c),n,s,l],i)}function d(t,e,n){const r=(new Date).toISOString(),i={data:[Object.assign(Object.assign(Object.assign({},e.mainPayload),{timeClicked:r}),n)]};a(t,[JSON.stringify(i),e.mainPayload.language],e.cosmosOnlyData)}n.d(e,"h",(function(){return c})),n.d(e,"i",(function(){return s})),n.d(e,"k",(function(){return u})),n.d(e,"j",(function(){return d})),n.d(e,"l",(function(){return a})),n.d(e,"d",(function(){return"SmartPillClicked"})),n.d(e,"e",(function(){return"SmartPillMenuOpened"})),n.d(e,"g",(function(){return"SmartTimeMenuClicked"})),n.d(e,"a",(function(){return"SmartDocMenuClicked"})),n.d(e,"b",(function(){return"SmartDocMenuClosed"})),n.d(e,"c",(function(){return"SmartDocSpinnerDisposed"})),n.d(e,"f",(function(){return"SmartReplyMenuClicked"}))},5557:function(t){t.exports=JSON.parse('{"b":"tIb","a":"uIb","c":"vIb","d":"wIb"}')},5640:function(t){t.exports=JSON.parse('{"b":"EQa","a":"FQa"}')},5641:function(t){t.exports=JSON.parse('{"b":"CQa","a":"DQa"}')},5754:function(t,e,n){"use strict";var r=n(3837),i=n(2),o=n(2968),a=Object(i.mutatorAction)("setRegionalConfiguration",(function(t,e,n){let r=Object(o.a)();r.supportedCultures=t,r.supportedShortDateFormats=e,r.supportedShortTimeFormats=n})),c=Object(i.mutatorAction)("setSupportedTimeZones",(function(t){Object(o.a)().supportedTimeZones=t}));async function l(){await Object(r.c)().then(t=>{c(t)})}var s=n(5206),u=n(4145);function d(){let t=Object(u.b)();Object(s.a)(t)}var m=Object(i.mutatorAction)("setAdditionalTimezones",(function(t){Object(o.a)().additionalTimezones=t}));var g=n(5392);Object(i.orchestrator)(r.d,()=>{l()});var f=n(5640),p=n(2739),b=n(20),S=new b.c(()=>Promise.all([n.e(1),n.e(2),n.e(3),n.e(6),n.e(7),n.e(11),n.e(183),n.e(199),n.e(340),n.e(900)]).then(n.bind(null,2e4))),h=new b.c(()=>Promise.all([n.e(1),n.e(2),n.e(3),n.e(6),n.e(7),n.e(11),n.e(183),n.e(199),n.e(340),n.e(2200)]).then(n.bind(null,20039)));var O=Object(p.b)({key:"regional",titleStringKey:f.b,hideTitleInFullOptions:!0,searchTermsStringKey:f.a,allowedOptionKeys:["Regional"]},S,t=>t.default,h,t=>t.default),j=n(5641);const y=new b.c(()=>Promise.all([n.e(1),n.e(2),n.e(3),n.e(8),n.e(11),n.e(183),n.e(199),n.e(848)]).then(n.bind(null,19971)));var v=Object(p.b)({key:"timezone",titleStringKey:j.b,searchTermsStringKey:j.a},y,t=>t.default);function I(){const t=Object(o.a)();return null==t?void 0:t.supportedCultures}n.d(e,"a",(function(){return O})),n.d(e,"b",(function(){return v})),n.d(e,"d",(function(){return I})),n.d(e,"c",(function(){return o.a})),Promise.all([Object(r.a)().then(t=>{a(t.SupportedCultures,t.SupportedShortDateFormats,t.SupportedShortTimeFormats)}),l(),d(),void Object(g.a)(""),void m([])])},714:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t.EndEarly="End_Early",t.StartLate="Start_Late",t.None="None"}(r||(r={}))},734:function(t,e,n){"use strict";var r=n(152);function i(t){return Object(r.e)()&&0!==t?t<60?Object(r.c)():Object(r.b)():0}var o=n(1486);function a(){const t=Object(o.a)(),e=i(t);return Math.max(t-e,0)}var c,l=n(5);function s(t,e){if(!Object(r.f)())return e;const n=i(Object(l.x)(e,t)),o=n?Object(l.ic)(e,n):e;return Object(l.Jb)(t,o)?o:e}function u(t,e){if(!Object(r.g)())return t;const n=i(Object(l.x)(e,t)),o=n?Object(l.h)(t,n):t;return Object(l.Jb)(o,e)?o:t}function d(t,e){return{start:u(t,e),end:s(t,e)}}function m(t,e){const n=60-Object(r.b)();return 0===t&&0!==e&&e<n?c.ZeroToShort:0===t&&e>=n?c.ZeroToLong:0===e&&0!==t&&t<n?c.ShortToZero:0===e&&t>=n?c.LongToZero:t<n&&e<n||t>=n&&e>=n?c.None:t<n&&e>=n?c.ShortToLong:t>=n&&e<n?c.LongToShort:null}function g(t,e,n,i,o,a){if(!Object(r.g)())return n;const s=m(Object(l.x)(e,t),Object(l.x)(i,n)),u=o?n:t;let d=n;return s===c.ShortToLong?d=Object(l.h)(Object(l.ic)(u,Object(r.c)()),Object(r.b)()):s===c.LongToShort?d=Object(l.h)(Object(l.ic)(u,Object(r.b)()),Object(r.c)()):s!==c.ZeroToShort||a?s!==c.ZeroToLong||a||(d=Object(l.h)(u,Object(r.b)())):d=Object(l.h)(u,Object(r.c)()),Object(l.Jb)(d,i)?d:n}function f(t,e,n){if(!Object(r.g)())return t;const i=m(Object(l.x)(e,t),n);let o=t;return i===c.ShortToLong?o=Object(l.h)(Object(l.ic)(t,Object(r.c)()),Object(r.b)()):i===c.LongToShort&&(o=Object(l.h)(Object(l.ic)(t,Object(r.b)()),Object(r.c)())),o}function p(t,e,n,i){if(!Object(r.f)())return i;const o=m(Object(l.x)(e,t),Object(l.x)(i,n));let a=i;return o===c.ShortToLong?a=Object(l.ic)(Object(l.h)(i,Object(r.c)()),Object(r.b)()):o===c.LongToShort?a=Object(l.ic)(Object(l.h)(i,Object(r.b)()),Object(r.c)()):o===c.ZeroToShort?a=Object(l.ic)(i,Object(r.c)()):o===c.ZeroToLong&&(a=Object(l.ic)(i,Object(r.b)())),Object(l.Jb)(n,a)?a:i}function b(t,e){if(!Object(r.g)())return e;const n=Object(r.c)(),i=Object(r.b)();return t>=60-i?Object(l.h)(e,i):Object(l.h)(e,n)}function S(t,e,n,r){return Object(l.Kb)(e,r)?p(t,e,n,r):s(n,r)}function h(t,e,n,r){return Object(l.Kb)(t,n)?g(t,e,n,r):u(n,r)}function O(t,e,n,r){return{start:h(t,e,n,r),end:S(t,e,n,r)}}!function(t){t[t.None=0]="None",t[t.ShortToLong=1]="ShortToLong",t[t.LongToShort=2]="LongToShort",t[t.ZeroToShort=3]="ZeroToShort",t[t.ZeroToLong=4]="ZeroToLong",t[t.ShortToZero=5]="ShortToZero",t[t.LongToZero=6]="LongToZero"}(c||(c={})),n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return s})),n.d(e,"d",(function(){return u})),n.d(e,"h",(function(){return d})),n.d(e,"f",(function(){return g})),n.d(e,"c",(function(){return p})),n.d(e,"e",(function(){return b})),n.d(e,"i",(function(){return O})),n.d(e,"j",(function(){return i})),n.d(e,"g",(function(){return f}))},7874:function(t,e,n){"use strict";n.d(e,"c",(function(){return o})),n.d(e,"e",(function(){return a})),n.d(e,"d",(function(){return c})),n.d(e,"b",(function(){return l})),n.d(e,"a",(function(){return s})),n.d(e,"f",(function(){return u})),n.d(e,"h",(function(){return d})),n.d(e,"i",(function(){return g})),n.d(e,"g",(function(){return f}));var r=n(395),i=n(25);const o="Language",a="Locale",c="LanguageScores",l="@EntityId",s="EntityExtraction/ExtractLanguage1.0",u=Object(r.a)({PropertyName:s,DistinguishedPropertySetId:"Common",PropertyType:"String"}),d=Object(r.a)({PropertyName:"EntityExtraction/SmartReplyForEmail",DistinguishedPropertySetId:"Common",PropertyType:"String"}),m=Object(i.k)("mc-smartReplyWithMeeting-MeetingScheduler")?"EntityExtraction/CalendarRelated1.0":"EntityExtraction/Events1.0",g=Object(r.a)({PropertyName:m,DistinguishedPropertySetId:"Common",PropertyType:"String"}),f=Object(r.a)({PropertyName:"EntityExtraction/SendContentRequestV21.0",DistinguishedPropertySetId:"Common",PropertyType:"String"})},9657:function(t,e,n){"use strict";n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return l}));var r=n(68),i=n(2742),o=n(22);const a=4e3;function c(t){var e,n;if(t.SIGSData&&t.SIGSData.SmartPillData){const{IsSmartSuggestionsRendered:i,SuggestionTypesRendered:o,SuggestionsRendered:c,ExtractionId:l}=t.SIGSData.SmartPillData,s=t.InternetMessageId;let u=(null===(e=t.UniqueBody)||void 0===e?void 0:e.Value)||(null===(n=t.NormalizedBody)||void 0===n?void 0:n.Value);if(u&&(u=u.substring(0,a)),"True"===i){const t={InternetMessageId:s,MessageBody:u,SuggestionTypesRendered:o,SuggestionsRendered:c,ExtractionId:l};return r.o.importAndExecute("SmartSuggestionsRendered",{compliance:"CustomerContent",customProperties:t}),!0}}else o.h.warn("SIGSData object not initialized on item.");return!1}function l(t,e,n){var c,l,s;try{if(t){const o=Object(i.g)().items.get(t);if(null===(c=null==o?void 0:o.SIGSData)||void 0===c?void 0:c.SmartPillData){const t=o.InternetMessageId;let i=(null===(l=o.NormalizedBody)||void 0===l?void 0:l.Value)||(null===(s=o.UniqueBody)||void 0===s?void 0:s.Value);i&&(i=i.substring(0,a));const c=e.substring(0,a);r.o.importAndExecute("SmartSuggestionsClicked",{compliance:"CustomerContent",customProperties:Object.assign(Object.assign({InternetMessageId:t,MessageBody:i},o.SIGSData.SmartPillData),{IsSmartSuggestionsClicked:n&&n.isSmartSuggestionsClicked?"True":"False",SuggestionsClickedTime:null==n?void 0:n.suggestionsClickedTime,ClickIndex:n&&n.clickIndex.toString(),ReplyBody:c})})}}}catch(t){o.d(`[logToSIGSOnMessageSent] Error: ${t.message}`)}}}}]);
//# sourceMappingURL=owa.573.js.map
self.scriptsLoaded['owa.573.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.573.js'] = (new Date()).getTime();