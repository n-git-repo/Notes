self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.146.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[146],{11504:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var i=r(10),n=r(52),s=r(3),o=r(106),a=r(9706),d=r(8899);class c{constructor(e){this.properties={};const t=Object(n.g)().SessionSettings||{};this.properties.eventName=e,this.properties.clientType=a.a,this.properties.clientVersion=Object(d.a)(),this.properties.forest=Object(s.y)(),this.properties["UserInfo.Id"]=t.UserPuid,this.properties["UserInfo.PrimaryIdentityHash"]=t.ExternalDirectoryUserGuid,this.properties.clientId=Object(s.t)(),this.properties.tenantGuid=t.ExternalDirectoryTenantGuid,this.properties.sessionId=Object(s.M)(),this.properties.physicalRing=Object(i.g)(),this.properties.correlationVector=Object(o.b)()}setProperty(e,t){this.properties[e]=t}getProperties(e){if(e)for(const e of Object.keys(this.properties)){const t=this.properties[e];"string"==typeof t&&(this.properties[e]=Object(s.T)(t))}return this.properties}}c.type="DataPoint.Aria"},11505:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var i=r(22),n=r(9707);class s extends n.a{constructor(e,t,r,i,n){super(e,t,r,i),this.setHttpActionProperties(r,n)}setHttpActionProperties(e,t){var r;if(null===(r=null==e?void 0:e.card)||void 0===r?void 0:r.messageCardContext)try{const t="string"==typeof e.card.messageCardContext?e.card.messageCardContext:JSON.stringify(e.card.messageCardContext);this.setProperty("messageCardContext",t)}catch(e){i.h.info(`[ActionableMessageDebug] RenderDataPoint - Error while JSON.stringify messageCardContext: ${e}`)}if(null==e?void 0:e.messageCardExtensionContext)try{const t="string"==typeof e.messageCardExtensionContext?e.messageCardExtensionContext:JSON.stringify(e.messageCardExtensionContext);this.setProperty("messageCardExtensionContext",t)}catch(e){i.h.info(`[ActionableMessageDebug] RenderDataPoint - Error while JSON.stringify messageCardExtensionContext: ${e}`)}if(t)try{this.setProperty("actionContext","string"==typeof t?t:JSON.stringify(t))}catch(e){i.h.info(`[ActionableMessageDebug] RenderDataPoint - Error while JSON.stringify actionContext: ${e}`)}}}s.type="DataPoint.HttpAction"},11506:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var i=r(11504);class n extends i.a{constructor(e,t){super(e),this.setSessionProperties(t)}setSessionProperties(e){const t=JSON.stringify(e);this.setProperty("genericInfo",t)}}n.type="DataPoint.Session"},11846:function(e,t,r){"use strict";var i=r(22),n=r(9179);var s=e=>{let t="[";return Object.keys(e).forEach((r,i)=>{0!==i&&(t+=", "),t+=`"${r}": "${e[r]}"`}),t+="]",t},o=r(5);function a(e){return 0===Object.keys(e).length}r.d(t,"a",(function(){return d}));class d extends n.a{constructor(e,t,r,i,n){super(e,t,r),this.setRenderProperties(r,i,n)}setRenderProperties(e,t,r){var n;if(r){const e=function(e){const t=[],r=e.previousCardCheckpoints&&!a(e.previousCardCheckpoints)?e.previousCardCheckpoints:e.currentCardCheckpoints;let i=null;e.previousCardCheckpoints&&!a(e.previousCardCheckpoints)&&(i=e.currentCardCheckpoints);const n=Object(o.w)(r.cardCreateEnd,r.cardCreateStart);t.ICPT=n;const d=Object(o.w)(r.cardRenderEnd,r.cardRenderStart);t.ICRT=d;const c=Object(o.w)(r.themeResolveEnd,r.themeResolveStart);t.ICTT=c;const p=r.totalFetchTime;t.ICFT=p;const C=Object(o.w)(r.cardLibraryRenderEnd,r.cardLibraryRenderStart);t.ICHT=C;const l=Object(o.w)(r.prepareCardEnd,r.prepareCardStart);if(t.IPPT=l,i){const e=Object(o.w)(i.cardCreateEnd,i.cardCreateStart);t.FCPT=e;const r=Object(o.w)(i.cardRenderEnd,i.cardRenderStart);t.FCRT=r;const n=Object(o.w)(i.themeResolveEnd,i.themeResolveStart);if(t.FCTT=n,i.totalFetchTime){const e=i.totalFetchTime;t.FCFT=e}const s=Object(o.w)(i.cardLibraryRenderEnd,i.cardLibraryRenderStart);t.FCHT=s;const a=Object(o.w)(i.prepareCardEnd,i.prepareCardStart);t.FPPT=a}if(e.autoInvokeActionStart&&e.autoInvokeActionEnd){const r=Object(o.w)(e.autoInvokeActionEnd,e.autoInvokeActionStart);t.AIT=r}const u=Object(o.w)(i?i.cardRenderEnd:r.cardRenderEnd,e.loadStart);return t.TCRT=u,s(t)}(r);this.setProperty("genericInfo",e)}if(null===(n=null==e?void 0:e.card)||void 0===n?void 0:n.messageCardContext)try{const t="string"==typeof e.card.messageCardContext?e.card.messageCardContext:JSON.stringify(e.card.messageCardContext);this.setProperty("messageCardContext",t)}catch(e){i.h.info(`[ActionableMessageDebug] RenderDataPoint - Error while JSON.stringify messageCardContext: ${e}`)}if(null==e?void 0:e.messageCardExtensionContext)try{const t="string"==typeof e.messageCardExtensionContext?e.messageCardExtensionContext:JSON.stringify(e.messageCardExtensionContext);this.setProperty("messageCardExtensionContext",t)}catch(e){i.h.info(`[ActionableMessageDebug] RenderDataPoint - Error while JSON.stringify messageCardExtensionContext: ${e}`)}if(t)try{this.setProperty("actionContext","string"==typeof t?t:JSON.stringify(t))}catch(e){i.h.info(`[ActionableMessageDebug] RenderDataPoint - Error while JSON.stringify actionContext: ${e}`)}}}d.type="DataPoint.Render"},12951:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var i=r(7873),n=r(11504);class s extends n.a{constructor(e,t=i.a.Standard,r,n){super(e),this.setErrorProperties(t,r,n)}setErrorProperties(e,t,r){this.setProperty("eventType",e),void 0!==t&&this.setProperty("errorMessage",t),void 0!==r&&this.setProperty("stackTrace",r)}}s.type="DataPoint.Error"},7872:function(e,t,r){"use strict";var i;!function(e){e.ActionCardExpanded="ActionCardExpanded",e.ActionCardCollapsed="ActionCardCollapsed",e.MessageCardHidden="MessageCardHidden",e.MessageCardRemoved="MessageCardRemoved",e.MessageCardViewActionClicked="MessageCardViewActionClicked",e.AutoDFailure="AutoDFailure",e.PrefetchError="PrefetchError",e.CardLoadTimeout="CardLoadTimeout",e.FailedToValidateSignature="FailedToValidateSignature",e.ToggleVisibilityActionClick="ToggleVisibilityActionClick",e.DisplayAppointmentFormClicked="DisplayAppointmentFormClicked",e.DisplayMessageFormClicked="DisplayMessageFormClicked",e.MessageCardPinAddinCommandClicked="MessageCardPinAddinCommandClicked",e.MessageCardInvokeAddinCommandClicked="MessageCardInvokeAddinCommandClicked",e.ActionCardHttpPostActionClicked="ActionCardHttpPostActionClicked",e.SingleClickHttpPostActionClicked="SingleClickHttpPostActionClicked",e.AutoInvokeActionClicked="AutoInvokeActionClicked",e.HttpPostActionExecuted="HttpPostActionExecuted",e.MessageCardRendered="MessageCardRendered",e.SessionDetails="SessionDetails"}(i||(i={})),t.a=i},7873:function(e,t,r){"use strict";var i;!function(e){e.Standard="Standard",e.Critical="Critical"}(i||(i={})),t.a=i},8897:function(e,t,r){"use strict";var i;!function(e){e.ClientEvent="client_event",e.ClientError="client_error"}(i||(i={})),t.a=i},8899:function(e,t,r){"use strict";var i=r(3),n=r(9706);t.a=()=>{let e=n.c;const t=Object(i.u)();return t&&(e=t),e=e.replace(/[^\d]/g,""),e=`16.${e.substr(0,4)}.${e.substr(4,4)}.${e.substr(8)}`,e}},8900:function(e,t,r){"use strict";var i=r(7872),n=r(9179),s=r(9707),o=r(11505),a=r(11846),d=r(12951),c=r(11506);const p={[n.a.type]:[i.a.ActionCardExpanded,i.a.ActionCardCollapsed,i.a.MessageCardHidden,i.a.MessageCardRemoved],[d.a.type]:[i.a.AutoDFailure,i.a.PrefetchError,i.a.CardLoadTimeout,i.a.FailedToValidateSignature],[s.a.type]:[i.a.MessageCardViewActionClicked,i.a.ToggleVisibilityActionClick,i.a.DisplayAppointmentFormClicked,i.a.DisplayMessageFormClicked,i.a.MessageCardPinAddinCommandClicked,i.a.MessageCardInvokeAddinCommandClicked,i.a.HttpPostActionExecuted],[o.a.type]:[i.a.ActionCardHttpPostActionClicked,i.a.SingleClickHttpPostActionClicked,i.a.AutoInvokeActionClicked],[a.a.type]:[i.a.MessageCardRendered],[c.a.type]:[i.a.SessionDetails]};t.a=e=>{let t;return t=p[c.a.type].includes(e)?c.a.type:p[a.a.type].includes(e)?a.a.type:p[o.a.type].includes(e)?o.a.type:p[s.a.type].includes(e)?s.a.type:p[d.a.type].includes(e)?d.a.type:n.a.type,t}},8901:function(e,t,r){"use strict";var i=r(7),n=r(3);t.a=()=>Object(i.a)()||Object(n.R)()},9174:function(e,t,r){"use strict";var i=r(68),n=r(8897),s=r(8901),o=r(12951),a=r(8900);var d=(e,t,r,i)=>{if(void 0===e)return;let n;switch(Object(a.a)(e)){case o.a.type:n=new o.a(e,t,r,i)}return null==n?void 0:n.getProperties(!0)};t.a=async(e,t,r,o)=>{if(Object(s.a)())return;const a=d(e,t,r,o);if(!a)return;const c=await Object(i.g)(),p={name:n.a.ClientError,properties:a};c.logEvent(p)}},9179:function(e,t,r){"use strict";var i,n=r(3878),s=r(6),o=r(9706);!function(e){e.ExplicitMessageCard="explicitMessageCard",e.AdaptiveCard="adaptiveCard",e.AdaptiveCardV2="adaptiveCardV2"}(i||(i={}));var a=i,d=r(11504);r.d(t,"a",(function(){return c}));class c extends d.a{constructor(e,t,r){super(e),this.setCardProperties(t,r)}isACv2Card(e){let t=!1;if(e){const r=new n.SerializationContext,i=n.Version.parse(e,r),s=n.Version.parse("1.4",r);try{t=i.compareTo(s)>=0}catch(e){}}return t}setCardProperties(e,t){var r,i,n,d,c;(null==e?void 0:e.itemId)&&this.setProperty("messageId",e.itemId),(null==e?void 0:e.conversationId)&&this.setProperty("conversationId",e.conversationId),(null==e?void 0:e.isGroupEscalationMessage)&&this.setProperty("isGroupEscalationMessage",e.isGroupEscalationMessage),(null===(r=null==e?void 0:e.mailboxInfo)||void 0===r?void 0:r.type)&&this.setProperty("isGroupMailbox",e.mailboxInfo.type===o.d),(null===(i=null==t?void 0:t.card)||void 0===i?void 0:i.originator)?this.setProperty("originator",t.card.originator):(null==t?void 0:t.connectorSenderGuid)&&this.setProperty("originator",t.connectorSenderGuid),this.setProperty("messageType",t.isAdaptiveCard?this.isACv2Card(null===(n=null==t?void 0:t.card)||void 0===n?void 0:n.version)?a.AdaptiveCardV2:a.AdaptiveCard:a.ExplicitMessageCard),(null==t?void 0:t.connectorSenderGuid)&&this.setProperty("connectorSenderGuid",t.connectorSenderGuid);const p=Object(s.e)();p&&(this.setProperty("culture",p),this.setProperty("uiCulture",p)),(null===(c=null===(d=null==t?void 0:t.card)||void 0===d?void 0:d.messageCardContext)||void 0===c?void 0:c.oamAppName)&&this.setProperty("oamAppName",t.card.messageCardContext.oamAppName),(null==t?void 0:t.providerAccountUniqueId)&&this.setProperty("providerAccountUniqueId",t.providerAccountUniqueId)}}c.type="DataPoint.Card"},9706:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"d",(function(){return n})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return o}));const i="WAC_Outlook_React",n="GroupMailbox",s="30d2f5e2-6e6f-43b0-a2bd-c9d87a5cd6fd",o="20000101001"},9707:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var i=r(9179),n=r(9706);class s extends i.a{constructor(e,t,r,i){super(e,t,r),this.setActionProperties(i)}setActionProperties(e){let t=n.b;(null==e?void 0:e.id)&&(t=e.id),this.setProperty("actionId",t)}}s.type="DataPoint.Action"}}]);
//# sourceMappingURL=owa.146.js.map
self.scriptsLoaded['owa.146.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.146.js'] = (new Date()).getTime();