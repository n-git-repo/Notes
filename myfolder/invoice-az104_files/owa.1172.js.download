self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.1172.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[1172],{16710:function(t){t.exports=JSON.parse('{"a":"Gub"}')},3310:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return u}));var a=n(13),i=n(2);const r={legacySignature:{html:null,txt:null},roamingSignatureMap:new a.ObservableMap,defaultSignatureName:"",defaultReplySignatureName:""},o=Object(i.createStore)("signature",r),u=o()},5868:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"g",(function(){return i})),n.d(e,"d",(function(){return r})),n.d(e,"b",(function(){return o})),n.d(e,"f",(function(){return u})),n.d(e,"i",(function(){return c})),n.d(e,"h",(function(){return l})),n.d(e,"e",(function(){return s})),n.d(e,"c",(function(){return g}));const a="/ows/beta/OutlookCloudSettings/settings/account",i="Roaming_Signature_List",r="Roaming_New_Signature",o="Roaming_Reply_Signature",u="signaturehtml",c="signaturetxt",l=i.toLowerCase(),s=r.toLowerCase(),g=o.toLowerCase()},7e3:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var a=n(20);const i=new a.c(()=>n.e(2193).then(n.bind(null,9872)));let r=new a.a(i,t=>t.loadSignatureInUserOptions)},7112:function(t,e,n){"use strict";n.d(e,"c",(function(){return g})),n.d(e,"d",(function(){return d})),n.d(e,"b",(function(){return m})),n.d(e,"a",(function(){return b}));var a=n(3310),i=n(155),r=n(5868),o=n(30);const u=621355968e9,c=1e4,l="encoding:utf-8",s={"x-outlook-client":"owa",Accept:"application/json","x-overridetimestamp":!0};function g(t){const e=[];t.forEach((t,n)=>{e.push(...function(t){var e,n;const a=null===(e=t.html)||void 0===e?void 0:e.name,i=t.txt?t.txt.value:"";return[f(a,null===(n=t.html)||void 0===n?void 0:n.value,"Blob","RoamingSetting","htm",!0,"roaming_signature_list"),f(a,i,"Blob","RoamingSetting","txt",!0,"roaming_signature_list")]}(t))}),e.length>0&&Object(i.d)(r.a,e,void 0,!0,Object.assign(Object.assign({},s),{"x-islargesetting":!0}))}function d(){const{roamingSignatureMap:t}=a.b,e=[];t.forEach(t=>{var n;(null===(n=t.html)||void 0===n?void 0:n.name)&&e.push(t.html.name)});const n=[f(r.g,e.join(),"BlobArray","RoamingSetting",r.g,!1)];Object(i.d)(r.a,n,void 0,!0,s)}function m(t){const e=[f(r.d,t,"String","RoamingSetting",r.d,!1)];Object(i.d)(r.a,e,void 0,!0,s)}function b(t){const e=[f(r.b,t,"String","RoamingSetting",r.b,!1)];Object(i.d)(r.a,e,void 0,!0,s)}function f(t,e,n,a,i,r,s){var g;const d={name:t,value:e,type:n,scope:null===(g=Object(o.a)().SessionSettings)||void 0===g?void 0:g.UserEmailAddress,itemClass:a,timestamp:u+Date.now()*c,secondaryKey:i,metadata:l};return s&&(d.parentSetting=s),r&&(d["value@is.Large"]=r),d}},9040:function(t,e,n){"use strict";n.r(e);var a=n(155),i=n(2),r=n(3310),o=Object(i.mutatorAction)("setDefaultSignatureName",(t,e)=>{e?Object(r.a)().defaultReplySignatureName=t:Object(r.a)().defaultSignatureName=t}),u=Object(i.mutatorAction)("setLegacySignatureInStore",(t,e)=>{"html"==t?Object(r.a)().legacySignature.html=e:"txt"==t&&(Object(r.a)().legacySignature.txt=e)}),c=Object(i.mutatorAction)("setRoamingSignatureInStore",t=>{const{roamingSignatureMap:e}=Object(r.a)();if("htm"==t.secondaryKey){let n=e.get(t.name);n?n.html=t:n={html:t,txt:null},e.set(t.name,n)}else if("txt"==t.secondaryKey){let n=e.get(t.name);n?n.txt=t:n={html:null,txt:t},e.set(t.name,n)}}),l=n(52),s=n(7112),g=n(6),d=n(16710);const m="dataURI";function b(){var t,e;const{roamingSignatureMap:n,legacySignature:a}=Object(r.a)(),i=Object(l.g)().UserOptions,u=null===(t=a.html)||void 0===t?void 0:t.value;if(!u)return;const b=function(t){var e;const n=(new DOMParser).parseFromString(t,"text/html"),a=n.getElementsByTagName("img");for(let t=0;t<a.length;t++){let n=a[t];if(!n.currentSrc){let t=n.nextElementSibling;(null==t?void 0:t.id)==m&&(t.textContent&&(n.src=t.textContent),null===(e=n.parentElement)||void 0===e||e.removeChild(t))}}return n.body.innerHTML}(u),f={name:Object(g.b)(d.a),value:b,secondaryKey:"htm"};if(c(f),null===(e=a.txt)||void 0===e?void 0:e.value){const t={name:Object(g.b)(d.a),value:a.txt.value,secondaryKey:"txt"};c(t)}Object(s.c)(n),Object(s.d)(),i&&(i.AutoAddSignature&&(o(Object(g.b)(d.a),!1),Object(s.b)(Object(g.b)(d.a))),i.AutoAddSignatureOnReply&&(o(Object(g.b)(d.a),!0),Object(s.a)(Object(g.b)(d.a))))}var f=n(5868);let v;async function S(){return v||(v=Object(a.b)(`${f.a}?settingname=${f.f},${f.i},${f.h},${f.e},${f.c}`,void 0,!1,{"x-outlook-client":"owa"}).then(t=>{let e;t.forEach(t=>{var n;switch(null===(n=t.name)||void 0===n?void 0:n.toLowerCase()){case f.f:u("html",t);break;case f.i:u("txt",t);break;case f.h:e=t.value,function(t){Object(a.b)(`${f.a}?settingname=${t}`,void 0,!1,{"x-islargesetting":!0}).then(t=>{t.forEach(t=>{c(t)})})}(t.value);break;case f.e:o(t.value,!1);break;case f.c:o(t.value,!0)}}),e&&""!=e||b()})),v}var O=n(7e3),j=n(30),h=n(25);async function p(){if(Object(h.k)("cmp-roaming-signature")&&!(null===(t=Object(j.a)().SessionSettings)||void 0===t?void 0:t.IsExplicitLogon)){const t=Object(r.a)();if(null==t.legacySignature.html||null==t.legacySignature.txt)return S()}else{const t=Object(j.a)().UserOptions;if(t&&(null==t.SignatureHtml||null==t.SignatureText))return O.a.importAndExecute()}var t;return Promise.resolve()}n.d(e,"loadSignature",(function(){return p}))}}]);
//# sourceMappingURL=owa.1172.js.map
self.scriptsLoaded['owa.1172.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.1172.js'] = (new Date()).getTime();