self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.597.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[597],{11058:function(e){e.exports=JSON.parse('{"c":"zMc","b":"AMc","a":"BMc"}')},11059:function(e,t,n){var i=n(11060);"string"==typeof i&&(i=[[e.i,i,""]]);var o={transform:void 0};n(84)(i,o);i.locals&&(e.exports=i.locals)},11060:function(e,t,n){(t=e.exports=n(83)(!1)).push([e.i,"._1MWfsXJ00dfskwPk_paMMQ{width:750px!important;max-width:750px!important;height:550px;overflow:hidden}._2CcS0EUh4bxpQ_ZZ_3dKfo{width:690px;height:410px;overflow:auto;word-wrap:break-word;white-space:pre}._2zncB03h5fVc_R1eQxRXU4{color:var(--white)!important}html[dir] ._2zncB03h5fVc_R1eQxRXU4{background-color:var(--themePrimary);border-radius:2px}html[dir] ._2zncB03h5fVc_R1eQxRXU4:hover{background-color:var(--themeDark)}html[dir] ._2zncB03h5fVc_R1eQxRXU4:active{background-color:var(--themeDarker)}",""]),t.locals={container:"_1MWfsXJ00dfskwPk_paMMQ",content:"_2CcS0EUh4bxpQ_ZZ_3dKfo",button:"_2zncB03h5fVc_R1eQxRXU4"}},11523:function(e,t,n){"use strict";function i(e){return!(e.CopyAllowed&&e.ForwardAllowed&&e.ReplyAllAllowed&&e.ReplyAllowed&&e.PrintAllowed)}n.d(t,"a",(function(){return i}))},11524:function(e,t,n){var i=n(18146);"string"==typeof i&&(i=[[e.i,i,""]]);var o={transform:void 0};n(84)(i,o);i.locals&&(e.exports=i.locals)},12965:function(e){e.exports=JSON.parse('{"e":"oMc","d":"pMc","b":"qMc","a":"rMc","c":"sMc"}')},1432:function(e,t,n){"use strict";var i=n(798),o=n(1),a=n(0),r=n(471),s=n(401),c=Object(r.a)(),d=function(e){function t(t){var n=e.call(this,t)||this;return Object(s.a)(n),n}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.styles,i=e.theme;return this._classNames=c(n,{theme:i,className:t}),a.createElement("div",{className:this._classNames.actions},a.createElement("div",{className:this._classNames.actionsRight},this._renderChildrenAsActions()))},t.prototype._renderChildrenAsActions=function(){var e=this;return a.Children.map(this.props.children,(function(t){return t?a.createElement("span",{className:e._classNames.action},t):null}))},t}(a.Component),l=n(8),u={actions:"ms-Dialog-actions",action:"ms-Dialog-action",actionsRight:"ms-Dialog-actionsRight"};n.d(t,"a",(function(){return m}));var m=Object(i.a)(d,(function(e){var t=e.className,n=e.theme,i=Object(l.getGlobalClassNames)(u,n);return{actions:[i.actions,{position:"relative",width:"100%",minHeight:"24px",lineHeight:"24px",margin:"16px 0 0",fontSize:"0",selectors:{".ms-Button":{lineHeight:"normal"}}},t],action:[i.action,{margin:"0 4px"}],actionsRight:[i.actionsRight,{textAlign:"right",marginRight:"-4px",fontSize:"0"}]}}),void 0,{scope:"DialogFooter"})},1446:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0),o=n(179);function a(e){var t=i.useState(e),n=t[0],a=t[1];return[n,{setTrue:Object(o.a)((function(){return function(){a(!0)}})),setFalse:Object(o.a)((function(){return function(){a(!1)}})),toggle:Object(o.a)((function(){return function(){a((function(e){return!e}))}}))}]}},1447:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(0),o=n(179),a=function(){var e=Object(o.a)({});return i.useEffect((function(){return function(){for(var t=0,n=Object.keys(e);t<n.length;t++){var i=n[t];clearTimeout(i)}}}),[e]),Object(o.a)({setTimeout:function(t,n){var i=setTimeout(t,n);return e[i]=1,i},clearTimeout:function(t){delete e[t],clearTimeout(t)}})}},18143:function(e){e.exports=JSON.parse('{"f":"CMc","d":"DMc","k":"EMc","j":"FMc","i":"GMc","e":"HMc","h":"IMc","l":"JMc","b":"KMc","c":"LMc","g":"MMc","a":"NMc"}')},18144:function(e,t,n){var i=n(18145);"string"==typeof i&&(i=[[e.i,i,""]]);var o={transform:void 0};n(84)(i,o);i.locals&&(e.exports=i.locals)},18145:function(e,t,n){(t=e.exports=n(83)(!1)).push([e.i,".crOZ6HqASIV85SZgaN04O{display:block!important}._2JDdEg7MsB03ihtZlIKlQb{width:auto;height:32px}html[dir] ._2JDdEg7MsB03ihtZlIKlQb{border-radius:2px;background:transparent}html[dir] ._2JDdEg7MsB03ihtZlIKlQb:hover{background-color:var(--themeLighterAlt)}html[dir] ._2JDdEg7MsB03ihtZlIKlQb:active{background-color:var(--themeLight)}html[dir] ._2JDdEg7MsB03ihtZlIKlQb._1-_txxivppDmBHDyEQnMmW{background-color:var(--themeLighter)}._2JDdEg7MsB03ihtZlIKlQb._1-_txxivppDmBHDyEQnMmW.ms-Button .ms-Button-icon,._2JDdEg7MsB03ihtZlIKlQb._1-_txxivppDmBHDyEQnMmW.ms-Button .ms-Button-menuIcon,._2JDdEg7MsB03ihtZlIKlQb:active.ms-Button .ms-Button-icon,._2JDdEg7MsB03ihtZlIKlQb:active.ms-Button .ms-Button-menuIcon,._2JDdEg7MsB03ihtZlIKlQb:hover.ms-Button .ms-Button-icon,._2JDdEg7MsB03ihtZlIKlQb:hover.ms-Button .ms-Button-menuIcon{color:var(--themeDarker)}html[dir] ._38cd2fxA9s5359HIcruY0p{background-color:var(--themeLighterAlt)!important}.Ces9DbvnvQleJ9XqBErvr{width:230px}html[dir] .Ces9DbvnvQleJ9XqBErvr{background-color:var(--white)}._1RmXDVEJ4Sd_R3DF5S_B2k{max-height:400px;overflow-x:hidden}._1p7Tym25spa3YbXge7r6Ah{overflow:hidden}._2QzXlBDw0koPzFQulHYPXy{height:44px}html[dir=ltr] ._2QzXlBDw0koPzFQulHYPXy{padding-left:12px}html[dir=rtl] ._2QzXlBDw0koPzFQulHYPXy{padding-right:12px}html[dir] ._2QzXlBDw0koPzFQulHYPXy:hover{background-color:var(--neutralLighter)}",""]),t.locals={likeCustomButtonLabel:"crOZ6HqASIV85SZgaN04O",likeIconButtonCustom:"_2JDdEg7MsB03ihtZlIKlQb",isChecked:"_1-_txxivppDmBHDyEQnMmW",likeCustomButtonActive:"_38cd2fxA9s5359HIcruY0p",callout:"Ces9DbvnvQleJ9XqBErvr",scrollContainer:"_1RmXDVEJ4Sd_R3DF5S_B2k",personaCollection:"_1p7Tym25spa3YbXge7r6Ah",persona:"_2QzXlBDw0koPzFQulHYPXy"}},18146:function(e,t,n){(t=e.exports=n(83)(!1)).push([e.i,"html[dir=ltr] ._3M8qdCPclTTpYW2iSmKxGb{padding-right:2px}html[dir=rtl] ._3M8qdCPclTTpYW2iSmKxGb{padding-left:2px}._36kt_NF29zGpQ-YGXqElhJ{width:100%;min-width:0;display:inline-block;-webkit-box-ordinal-group:2;-ms-flex-order:1;order:1;position:relative;top:1px}html[dir=ltr] ._36kt_NF29zGpQ-YGXqElhJ{left:2px}html[dir=rtl] ._36kt_NF29zGpQ-YGXqElhJ{right:2px}._1REaPD80UGwWcTBTN30Z6S{height:40px}._1Yn-nuWhpARS8i0CiVKZHG{font-size:14px;color:var(--themePrimary)}html[dir] ._1Yn-nuWhpARS8i0CiVKZHG{background:transparent}._2H6ZKnUbHxb0OJk3DVFN7H{height:32px}html[dir] ._2H6ZKnUbHxb0OJk3DVFN7H{background-color:transparent;padding:0}._2H6ZKnUbHxb0OJk3DVFN7H._2VxYcpA_eddfaK5Dq9_zV6{height:28px}._2H6ZKnUbHxb0OJk3DVFN7H._3A_ICB5WWo8p-VS3tkKSqQ{height:24px}._2lDRGEhUulcqvxOS5hWjXx{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}._2BccY5KAu3TwOwcFElMtGS{min-width:auto}html[dir] ._2BccY5KAu3TwOwcFElMtGS{background:transparent;margin:0 2px;border-radius:2px}html[dir] ._2BccY5KAu3TwOwcFElMtGS:hover{background-color:var(--themeLighterAlt)}html[dir] ._2BccY5KAu3TwOwcFElMtGS:active{background-color:var(--themeLight)}html[dir] ._2BccY5KAu3TwOwcFElMtGS._3STduknLPfM7K-CoVTL9Zp{background-color:var(--themeLighter)}._2BccY5KAu3TwOwcFElMtGS._3STduknLPfM7K-CoVTL9Zp.ms-Button .ms-Button-icon,._2BccY5KAu3TwOwcFElMtGS._3STduknLPfM7K-CoVTL9Zp.ms-Button .ms-Button-menuIcon,._2BccY5KAu3TwOwcFElMtGS:active.ms-Button .ms-Button-icon,._2BccY5KAu3TwOwcFElMtGS:active.ms-Button .ms-Button-menuIcon,._2BccY5KAu3TwOwcFElMtGS:hover.ms-Button .ms-Button-icon,._2BccY5KAu3TwOwcFElMtGS:hover.ms-Button .ms-Button-menuIcon{color:var(--themeDarker)}._2BccY5KAu3TwOwcFElMtGS .ms-Button-label{font-weight:600}._2MBd41pUlPCcTlDD3n4ijc{height:32px}._2BccY5KAu3TwOwcFElMtGS._3Ki_O45ZHYfy5-TTOwQTkR .ms-Button-label{display:none}._1hNtpz2z3dm2daLz9Fn2cc{width:32px}._2JDqO7PoPImwXzd06oR1Dx{width:auto}html[dir] ._79re90sT84s7tbqkuGxcv{border:1px solid var(--neutralQuaternary);border-radius:4px}.TsiQDiI4R_TVoxq51bVoS.ms-ContextualMenu-icon,._3bub3nHlVA3tpGPpmZahoQ:not(._1Yn-nuWhpARS8i0CiVKZHG){display:none}._3elxfLs8GcU_Dugz30Zho0{color:var(--themePrimary)}._1W0_9g-Tpom9_WWEdTDPQh{color:var(--neutralTertiary)}._2ZUK2xVkWD8M8UYfCb_bZ8{pointer-events:none}html[dir] ._2ZUK2xVkWD8M8UYfCb_bZ8{background-color:transparent}._1JrQ4xjjBeRMCuesxTAlak{line-height:36px}html[dir] ._1JrQ4xjjBeRMCuesxTAlak{padding:4px 0}",""]),t.locals={surfaceActionsCommandBarCharms:"_3M8qdCPclTTpYW2iSmKxGb",surfaceActionsCommandBarContainer:"_36kt_NF29zGpQ-YGXqElhJ",surfaceActionsCommandBarContainerHeight:"_1REaPD80UGwWcTBTN30Z6S",surfaceActionsCommandBarOverflowIcon:"_1Yn-nuWhpARS8i0CiVKZHG",surfaceActionsCommandBar:"_2H6ZKnUbHxb0OJk3DVFN7H",medium:"_2VxYcpA_eddfaK5Dq9_zV6",compact:"_3A_ICB5WWo8p-VS3tkKSqQ",surfaceActionsCommandBarPrimarySet:"_2lDRGEhUulcqvxOS5hWjXx",surfaceActionsCommandBarButton:"_2BccY5KAu3TwOwcFElMtGS",isChecked:"_3STduknLPfM7K-CoVTL9Zp",surfaceActionsCommandBarButtonHeight:"_2MBd41pUlPCcTlDD3n4ijc",hideLabel:"_3Ki_O45ZHYfy5-TTOwQTkR",surfaceActionsCommandBarButtonWidthHideLabel:"_1hNtpz2z3dm2daLz9Fn2cc",surfaceActionsCommandBarButtonWidthShowLabel:"_2JDqO7PoPImwXzd06oR1Dx",surfaceActionsCommandBarButtonBorder:"_79re90sT84s7tbqkuGxcv",commandBarIcon:"TsiQDiI4R_TVoxq51bVoS",commandBarMenuIcon:"_3bub3nHlVA3tpGPpmZahoQ",enabledIconButton:"_3elxfLs8GcU_Dugz30Zho0",disabledIconButton:"_1W0_9g-Tpom9_WWEdTDPQh",disabledReplyActionButton:"_2ZUK2xVkWD8M8UYfCb_bZ8",reactionButtonContainer:"_1JrQ4xjjBeRMCuesxTAlak"}},18147:function(e){e.exports=JSON.parse('{"a":"yMc"}')},18148:function(e){e.exports=JSON.parse('{"a":"xMc"}')},19709:function(e,t,n){"use strict";n.r(t);var i=n(1),o=n(12965);var a=n(5057);function r(e,t){let n="RPCSAPinned";return(null==e?void 0:e.renderedInOverflow)&&(n=e.isPinned?"RPCSAOverflow":"RPCSANotPinned"),t||n}var s=n(6290);function c(e,t){var n;t.isConversationItemPart&&Object(s.a)(null===(n=e.ConversationId)||void 0===n?void 0:n.Id,t,!1)}var d=n(50),l=n(4423);function u(e,t,n,i,o,a){return(s,u)=>{Object(l.l)(!1,n,u,r(u,a)),t?(c(i,o),e(s,u)):s.which==d.a.enter&&(s.preventDefault(),s.stopPropagation(),c(i,o),e(s,u))}}let m=null;function b(){return m||(m={},Object(l.i)().forEach(e=>{m[e.key]=e})),m}function p(e){var t;return!("GroupMailbox"!==(null===(t=null==e?void 0:e.MailboxInfo)||void 0===t?void 0:t.type))}function h(e,t){var n;return e.isConversationItemPart?null===(n=t.ConversationId)||void 0===n?void 0:n.Id:null}var f=n(2838);function g(e){return Object(f.a)(e.ParentFolderId.Id,"junkemail")}var v=n(2737);var O=n(6),I=n(2733);function w(e){var t,n;const i=Object(I.X)(e)?e:null;if(null==i)return null;const o=null===(t=i.Sender)||void 0===t?void 0:t.Mailbox;if(o){const e=k(o);if(e)return e}const a=null===(n=i.From)||void 0===n?void 0:n.Mailbox;if(a){const e=k(a);if(e)return e}return null}function k(e){return"GroupMailbox"==e.MailboxType||Object(O.j)(e.EmailAddress)?null:Object(O.j)(e.Name)?e.EmailAddress:e.Name}var C=n(6758);function x(e){return!Object(f.a)(e.ParentFolderId.Id,"drafts")&&e.Sender&&e.Sender.Mailbox&&!Object(C.a)(e.Sender.Mailbox.EmailAddress)&&null!=w(e)}var j=n(11523);var A=n(929),M=n(2648),S=n(1251),B=n(57),y=n(48),_=n(2354),D=n(159),T=n(1424),P=n(0),E=n(18143),N=n(30);const R=100;function F(e){try{if(e.LikeCount&&e.Likers){const t=Object(N.a)().SessionSettings.UserEmailAddress,n=!!e.Likers&&e.Likers.some(e=>e.EmailAddress===t);switch(e.LikeCount){case 1:return n?Object(O.b)(E.f):Object(O.c)(Object(O.b)(E.d),e.Likers[0].Name);case 2:return n?Object(O.c)(Object(O.b)(E.k),e.Likers.filter(e=>e.EmailAddress!==t)[0].Name):Object(O.c)(Object(O.b)(E.j),e.Likers[0].Name,e.Likers[1].Name);case 3:return n?Object(O.c)(Object(O.b)(E.i),e.Likers[0].Name,Object(O.b)(E.e)):Object(O.c)(Object(O.b)(E.h),e.Likers[0].Name,e.Likers[1].Name,Object(O.b)(E.e));default:return n?e.LikeCount>=R?Object(O.c)(Object(O.b)(E.l),R-1):Object(O.c)(Object(O.b)(E.b),e.Likers[0].Name,Object(O.c)(Object(O.b)(E.c),e.LikeCount-2)):e.LikeCount>=R?Object(O.c)(Object(O.b)(E.g),R-1):Object(O.c)(Object(O.b)(E.a),e.Likers[0].Name,e.Likers[1].Name,Object(O.c)(Object(O.b)(E.c),e.LikeCount-2))}}}catch(e){return null}return null}function L(e){return e.LikeCount?e.LikeCount<R?e.LikeCount.toString():R-1+"+":null}var H=n(1437),z=n(18144),K=n.n(z),U=n(11524),W=n.n(U),V=n(77),G=n.n(V);let Q=class extends P.Component{constructor(e){super(e),this.onDismissCallOut=()=>{this.setState(Object.assign(Object.assign({},this.state),{isMouseOverButton:!1,isMouseOverLikersList:!1}))},this.onLikeClicked=e=>{const t=e;this.props.surfaceActionItem.onClick(t,this.props.surfaceActionItem),t.stopPropagation()},this.handleMouseOver=()=>{this.state.isMouseOverButton||this.setState({isMouseOverButton:!0})},this.handleMouseLeave=()=>{this.state.isMouseOverButton&&this.setState({isMouseOverButton:!1})},this.handleLikersListMouseOver=()=>{this.state.isMouseOverLikersList||this.setState({isMouseOverLikersList:!0})},this.handleLikersListMouseLeave=()=>{this.state.isMouseOverLikersList&&this.setState({isMouseOverLikersList:!1})},this.state={isMouseOverButton:!1,isMouseOverLikersList:!1}}IsLikersListShown(){return this.state.isMouseOverLikersList}render(){const{surfaceActionItem:e,message:t}=this.props,n=t.LikeCount&&t.Likers&&(this.state.isMouseOverButton||this.state.isMouseOverLikersList),i="likeButtonId"+Object(D.a)();return P.createElement(_.a,{content:e.ariaLabel},P.createElement(M.a,{id:i,role:"menuitem",ariaLabel:e.ariaLabel,ariaDescription:F(t),iconProps:e.iconProps,styles:{root:G()(W.a.surfaceActionsCommandBarButton,K.a.likeIconButtonCustom,n&&K.a.likeCustomButtonActive),label:t.LikeCount&&K.a.likeCustomButtonLabel,rootDisabled:W.a.disabledReplyActionButton,icon:W.a.enabledIconButton,iconDisabled:W.a.disabledIconButton,menuIcon:W.a.commandBarMenuIcon},onClick:this.onLikeClicked,onMouseEnter:this.handleMouseOver,onMouseOver:this.handleMouseOver,onMouseLeave:this.handleMouseLeave,text:L(t)}),n&&P.createElement(S.a,{className:K.a.callout,onDismiss:this.onDismissCallOut,target:"#"+i,isBeakVisible:!1,setInitialFocus:!1,directionalHint:Object(O.h)()?B.a.bottomLeftEdge:B.a.bottomRightEdge},P.createElement("div",{className:G()(K.a.scrollContainer,"customScrollBar"),onMouseEnter:this.handleLikersListMouseOver,onMouseOver:this.handleLikersListMouseOver,onMouseLeave:this.handleLikersListMouseLeave},P.createElement("div",{className:K.a.personaCollection},t.Likers.map(e=>P.createElement(Z,{key:e.EmailAddress,emailAddress:e.EmailAddress,name:e.Name,mailBoxType:e.MailboxType,disableHover:!0,clientScenario:"Liker"},P.createElement(T.a,{className:K.a.persona,key:e.EmailAddress,name:e.Name,emailAddress:e.EmailAddress,size:y.c.size32,showPersonaDetails:!0,mailboxType:e.MailboxType})))))))}};Q=Object(i.__decorate)([A.observer],Q);var J=Q;function Z(e){const t=Object(H.a)(e);return P.createElement(t,null,e.children)}var Y=n(2877);var q=n(2819);var X=n(5315);var $=n(2939),ee=n(2806);var te=n(3544),ne=n(12471),ie=n(11003),oe=n(6998);var ae=n(2919);var re=n(2);const se=Object(re.mutatorAction)("incrementLikeButtonCount",e=>{e.likeUnlikeTracker&&e.likeUnlikeTracker.likeButtonClickCount++}),ce=Object(re.mutatorAction)("updateLikeUnlikeInProgress",(e,t)=>{e.likeUnlikeTracker&&(e.likeUnlikeTracker.likeUnlikeInProgress=t)});const de=async(e,t,n)=>{var i;const o=await Y.o.import();se(n),o(Object.assign(Object.assign({},e.ItemId),{mailboxInfo:e.MailboxInfo}),e,Object(I.I)(),(null===(i=n.likeUnlikeTracker)||void 0===i?void 0:i.likeButtonClickCount)>=5,t),ce(n,!1)};var le=n(6982),ue=n(4154);var me=n(7602);var be=n(10996);var pe=n(3219);async function he(e,t){const n=await ae.g.import(),[i,o]=await n(t,e),a=[...i,...o].map(e=>e.SipUri?e.SipUri:"sip:"+e.EmailAddress);a.length>0&&pe.e.import().then(n=>n(a,t.Subject,e?3:2))}var fe=n(10970);var ge=n(9586);var ve=n(4091),Oe=n(2817);var Ie=n(358),we=Object(Ie.action)("toggleAmpPreference")((function(e){e.preferAmp=!e.preferAmp}));var ke=n(3261);var Ce=n(66);const xe=Object(re.action)("toggleUndoDarkMode",e=>Object(Ce.b)({name:e.undoDarkMode?"ToggleDarkModeOn":"ToggleDarkModeOff"},{viewState:e}));Object(re.mutator)(xe,({viewState:e})=>{e&&(e.undoDarkMode=!e.undoDarkMode)});var je=n(9587),Ae=n(11001);var Me=n(9995),Se=n(68);var Be=n(25),ye=n(9298),_e=n(9299),De=n(9300),Te=n(9301),Pe=n(4842),Ee=n(4109),Ne=n(18147),Re=n(18148),Fe=n(8169),Le=n(6995),He=n(5820),ze=n(10995),Ke=n(5127),Ue=n(5815),We=n(4262),Ve=n(220),Ge=n(2989),Qe=n(8493),Je=n(3232);const Ze={Reply:(e,t)=>{const n=Object(Ke.a)(e.item,e.viewState.isConversationItemPart);t.disabled=n[0],t.onClick=function(e,t,n,i){return o=>{Object(be.a)(!1,t.isConversationItemPart,n,e,i,o)}}(e.instrumentationContext,e.viewState,e.item,e.targetWindow)},ReplyAll:(e,t)=>{const n=Object(Ke.a)(e.item,e.viewState.isConversationItemPart);t.disabled=n[1],t.onClick=function(e,t,n,i){return o=>{Object(be.a)(!0,t.isConversationItemPart,n,e,i,o)}}(e.instrumentationContext,e.viewState,e.item,e.targetWindow)},Forward:(e,t)=>{const n=Object(Ke.a)(e.item,e.viewState.isConversationItemPart);t.disabled=n[2],t.onClick=function(e,t,n){return i=>{i.stopPropagation(),ae.f.importAndExecute(e,e.MailboxInfo,a.a,[t],Object(I.db)(Object(I.I)()),{targetWindow:n})}}(e.item,e.instrumentationContext,e.targetWindow)},ReplyByMeeting:(e,t)=>{t.disabled=Object(Ge.a)(e.item)||!!e.item.RightsManagementLicenseData,t.onClick=function(e){return t=>{t.stopPropagation();const n=Object(I.X)(e)?e:null;Object(fe.a)(e.ItemId.Id,null,!1,a.a,null,null==n?void 0:n.InternetMessageId)}}(e.item)},OtherReplyActions:(e,t)=>{t.onClick=Ye,t.subMenuActionKeys=["ReplyByMeeting","ReplyByIM","ReplyAllByIM","LikeUnlike"]},MessageSafety:(e,t)=>{t.onClick=Ye,t.subMenuActionKeys=["MarkJunkNotJunk","MarkAsPhishing","Block","ReportAbuse"]},ReplyByIM:(e,t)=>{t.onClick=function(e){return t=>{he(!1,e)}}(e.item),t.disabled=!Object(pe.b)()},ReplyAllByIM:(e,t)=>{t.onClick=function(e){return t=>{he(!0,e)}}(e.item),t.disabled=!Object(pe.b)()},MarkJunkNotJunk:(e,t)=>{const n=e.item;if(Object(Je.g)()&&Object(v.E)(n.ParentFolderId.Id)){const i=g(n)?Object(O.b)(o.b):Object(O.b)(Te.a);t.text=i,t.ariaLabel=i,t.datapointName=g(n)?"MarkItemNotjunk":"MarkItemJunk",t.onClick=function(e,t,n){return i=>{i.stopPropagation(),Y.q.importAndExecute(e.ItemId.Id,Object(I.I)(),a.a,[t],n).then(()=>{Object(te.a)()}),q.b.importAndExecute()}}(e.item,e.instrumentationContext,e.targetWindow)}},Delete:(e,t)=>{if(!e.isItemAttachment&&Object(Je.b)(12)){const n=e.item;t.onClick=function(e,t,n){return i=>{i.stopPropagation();const o=h(e,t);if(o){const i=Object(ne.b)(o,e);Y.i.importAndExecute([t.ItemId.Id],Object(oe.a)(t.ItemId.Id),[n],a.a,t.MailboxInfo,!0).then(()=>{Object(ie.a)(i,o)})}else Y.i.importAndExecute([t.ItemId.Id],Object(oe.a)(t.ItemId.Id),[n],a.a,t.MailboxInfo).then(()=>{Object(te.a)()})}}(e.viewState,e.item,e.instrumentationContext),t.disabled=p(e.item)&&!n.CanDelete}},MarkReadUnread:(e,t)=>{if(!e.isPopout||!p(e.item)){const n=e.item,i=n.IsRead?Object(O.b)(Ee.a):Object(O.b)(Pe.a);t.text=i,t.ariaLabel=i,t.datapointName=n.IsRead?"MarkItemUnread":"MarkItemRead",n.IsRead||(t.iconProps.iconName="Read"),t.onClick=function(e,t){return n=>{n.stopPropagation();const i=e;ke.c.importAndExecute(e.ItemId.Id,Object(I.I)(),!i.IsRead,[t],a.a)}}(e.item,e.instrumentationContext)}},FlagUnflag:(e,t)=>{if(Object(Je.b)(16)){const n=e.item,i=!n.Flag||"Flagged"!=n.Flag.FlagStatus,r=i?Object(O.b)(_e.a):Object(O.b)(o.d);t.text=r,t.ariaLabel=r,t.datapointName=i?"FlagItem":"UnflagItem",t.onClick=function(e,t){return n=>{n.stopPropagation();const i="Flagged"!=e.Flag.FlagStatus?"Flagged":"NotFlagged";Y.I.importAndExecute([e.ItemId.Id],[t],{FlagStatus:i},Object(I.J)(),a.a)}}(e.item,e.instrumentationContext)}},Print:(e,t)=>{const n=Object(We.a)(e.item);t.onClick=function(e,t){return n=>{n.stopPropagation(),Object(me.a)(Object.assign(Object.assign({},e.ItemId),{mailboxInfo:e.MailboxInfo}),a.a,t)}}(e.item,e.targetWindow),t.disabled=!n.PrintAllowed},View:(e,t)=>{t.onClick=Ye,t.subMenuActionKeys=["Popout","Translate","ShowInImmersiveReader","ViewMessageSource"]},AdvancedActions:(e,t)=>{t.onClick=Ye,t.subMenuActionKeys=["CreateRule","AssignPolicy"]},Popout:(e,t)=>{t.onClick=function(e,t){return n=>{n.stopPropagation(),Object(ue.a)(t.itemId,null,e.MailboxInfo,async()=>{return(await le.a.import())(Object(I.I)())})}}(e.item,e.viewState)},CreateRule:(e,t)=>{var n;const i=Object(I.X)(e.item)?e.item:null;Object(He.a)()&&(null===(n=null==i?void 0:i.From)||void 0===n?void 0:n.Mailbox)&&Object(v.E)(null==i?void 0:i.ParentFolderId.Id)&&(t.onClick=function(e,t,n){return(i,o)=>{i.stopPropagation(),X.a.import().then(i=>{i(e,r(o,t),n)})}}(e.item,e.actionSource,e.targetWindow))},AddToSafeSenders:(e,t)=>{const n=e.item;x(n)&&(t.onClick=function(e,t,n){return(i,o)=>{i.stopPropagation(),Y.b.importAndExecute(e.Sender.Mailbox,e.ItemId.Id,r(o,t),!1,n)}}(n,e.actionSource,e.targetWindow))},MarkAsPhishing:(e,t)=>{t.onClick=function(e,t){return n=>{n.stopPropagation(),Y.p.importAndExecute(e.ItemId.Id,Object(I.I)(),a.a,t).then(()=>{Object(te.a)()}),q.b.importAndExecute()}}(e.item,e.targetWindow)},Block:(e,t)=>{const n=e.item;if(x(n)&&Object(v.E)(n.ParentFolderId.Id)){const i=Object(O.c)(Object(O.b)(ye.a),w(n));t.text=i,t.ariaLabel=i,t.onClick=function(e,t,n){return i=>{i.stopPropagation(),Y.e.importAndExecute(e.ItemId.Id,[t],a.a,n),q.b.importAndExecute()}}(e.item,e.instrumentationContext,e.targetWindow)}},ReportAbuse:(e,t)=>{Object(Be.k)("tri-reportAbuse")&&(t.onClick=function(e,t,n){return i=>{i.stopPropagation(),ge.b.importAndExecute(e,Object(I.I)(),[t],a.a,n),q.b.importAndExecute()}}(e.item,e.instrumentationContext,e.targetWindow))},Translate:(e,t)=>{const n=Object(We.a)(e.item);t.onClick=function(e,t){return n=>{var i;n.stopPropagation(),je.d.importAndExecute(e.ItemId.Id,Object(Ae.a)(null===(i=e.ConversationId)||void 0===i?void 0:i.Id),t.isConversationItemPart,!0)}}(e.item,e.viewState),t.disabled=function(e,t){return Object(j.a)(e)||!t.TranslationData||!t.TranslationData.userLanguage||t.TranslationData.isShowingTranslation||t.TranslationData.isTranslating}(n,e.item)},ShowInImmersiveReader:(e,t)=>{t.onClick=function(e,t,n){return(i,o)=>{i.stopPropagation(),n&&n!==window?Oe.k.importAndExecute(e.ItemId.Id,{Immersive:""}):ve.d.importAndExecute(Object.assign(Object.assign({},e.ItemId),{mailboxInfo:e.MailboxInfo}),a.a,r(o,t))}}(e.item,e.actionSource,e.targetWindow)},ViewMessageSource:(e,t)=>{const n=e.item;Object(f.a)(n.ParentFolderId.Id,"sentitems")||(t.onClick=function(e,t,n){return(i,o)=>{i.stopPropagation(),Object(Se.p)("ViewMessageSource",{subActionSource:r(o,t)},{actionSource:a.a}),Object(Me.a)(e,n)}}(e.item,e.actionSource,e.targetWindow))},AssignPolicy:(e,t)=>{if(function(e,t){return!p(t)&&(Object(v.C)(e,"UserMailbox")||Object(v.C)(e,"ArchiveMailbox")||Object(v.C)(e,"SharedMailbox"))}(e.item.ParentFolderId.Id,e.item)){const n=Object(I.I)(),i=Ue.a.tryImportForRender();let o;i&&(o=i(null==n?void 0:n.id,"RPCSAOverflow",e.item)),t.onClick=Ye,t.subMenuProps=o}},ToggleDarkMode:(e,t)=>{const n=e.viewState.undoDarkMode,i=n?Object(O.b)(o.a):Object(O.b)(De.a);t.text=i,t.ariaLabel=i,t.iconProps.iconName=n?"ClearNight":"Sunny",t.datapointName=n?"ToggleDarkModeOn":"ToggleDarkModeOff",t.onClick=function(e){return t=>{t.stopPropagation(),xe(e)}}(e.viewState),t.isPinnedOnly=!0},SetReaction:(e,t)=>{const n=e.item;Object(v.C)(n.ParentFolderId.Id,"SharedMailbox")||p(e.item)||(t.onClick=Ye,t.isPinnedOnly=!0,Object(l.o)("SetReaction",n)&&(t.onRender=t=>P.createElement(ze.a,{commandBarItem:t,conversationId:{Id:h(e.viewState,e.item),mailboxInfo:e.item.MailboxInfo},itemId:Object.assign(Object.assign({},e.item.ItemId),{mailboxInfo:e.item.MailboxInfo}),item:e.item,instrumentationContext:e.instrumentationContext})))},Addins:(e,t)=>{t.onClick=Ye},AddToBoard:(e,t)=>{const n=Qe.a.tryImportForRender();n&&(t.onClick=Ye,t.subMenuProps=n(e.item.ItemId.Id,e.item,"MailModuleNotificationBarHost"))},"-":(e,t)=>{t.onClick=Ye},LikeUnlike:(e,t)=>{const n=e.item;if(!Object(Ve.a)()&&!Object(v.C)(n.ParentFolderId.Id,"SharedMailbox")){if(t.onClick=function(e,t,n){return i=>{var o;i.stopPropagation(),(null===(o=n.likeUnlikeTracker)||void 0===o?void 0:o.likeUnlikeInProgress)||(ce(n,!0),de(e,t,n))}}(e.item,e.instrumentationContext,e.viewState),function(e){const t=Object(N.a)().SessionSettings.UserEmailAddress;return!!e.Likers&&e.Likers.some(e=>e.EmailAddress===t)}(n)){t.iconProps.iconName="LikeSolid";const e=Object(O.b)(o.e);t.text=e,t.ariaLabel=e}Object(l.o)("LikeUnlike",n)&&(t.onRender=e=>P.createElement(J,{surfaceActionItem:e,message:n}))}},ToggleAmp:(e,t)=>{const{preferAmp:n,ampAvailability:i}=e.viewState.ampViewState;if(Object(Le.a)()&&i==Fe.a.AmpValidated){const i=n?Object(O.b)(Re.a):Object(O.b)(Ne.a);t.text=i,t.ariaLabel=i,t.datapointName=n?"ViewAsOriginal":"ViewAsDynamic",t.onClick=function(e){return t=>{t.stopPropagation(),we(e.ampViewState)}}(e.viewState),t.isPinnedOnly=!0,n&&(t.iconProps.iconName="LightningBoltSolid")}},CustomizeActions:(e,t)=>{let n=!1;Object(Be.k)("addin-exp-customizedActionsButtonNavBar")&&((Object(Be.k)("addin-exp-awarenessNudgeCusBtn")||Object(Be.k)("addin-exp-awarenessNudge")||Object(Be.k)("addin-exp-awarenessNudgeWaterDropNudge"))&&(ee.y.importAndExecute(t),n=!0),t.onClick=function(e){return t=>{t.stopPropagation(),$.f.importAndExecute("mail","surfaceActions","readSurfaceActions"),ee.G.importAndExecute(e?"HighlightedAndClicked":"Clicked","OverFlowMenu")}}(n))}};function Ye(e){e.stopPropagation()}var qe=n(154);function Xe(e,t,n){if(!e||e.hideInGroup&&p(t.item)||e.hideInSxS&&t.isItemAttachment)return null;const i=function(e,t){var n;const i=Object(l.g)(e);return{key:e,text:i,ariaLabel:i,iconProps:{iconName:null===(n=Object(l.h)(e))||void 0===n?void 0:n.iconName,className:W.a.commandBarIcon},renderButtonAs:t,iconOnly:$e,datapointName:e}}(e.key,n);Ze[e.key](t,i);const o=function(e,t,n){if(!e)return null;const i=b(),o=[];return e.forEach(e=>{const a=Xe(i[e],t,n);a&&o.push(a)}),o.length>0?o:null}(i.subMenuActionKeys,t,n);return i.subMenuActionKeys&&!o?null:function(e,t,n){if(!e.onClick)return null;return Object.assign(Object.assign({},e),{onClick:u(e.onClick,!0,e.datapointName,n.item,n.viewState,n.actionSource),onKeyDown:u(e.onClick,!1,e.datapointName,n.item,n.viewState,n.actionSource),subMenuProps:e.subMenuProps?e.subMenuProps:t?{items:t}:null})}(i,o,t)}const $e=!Object(qe.a)("native")||!Object(Be.k)("mon-rp-showLabels");const et=["Reply","ReplyAll","Forward","OtherReplyActions","-","Delete","MarkReadUnread","FlagUnflag","AddToBoard","AddToSafeSenders","MessageSafety","-","Print","View","-","Addins","CustomizeActions","AdvancedActions","ToggleAmp","SetReaction","ToggleDarkMode"];var tt=n(2361),nt=n(13357),it=n(13),ot=n(21),at=n(2899),rt=n(5540),st=n(6960),ct=n(8902),dt=n(5457),lt=n(3587),ut=n(12466);const mt=Object(re.mutatorAction)("initializeLikeUnlikeTracker",e=>{e.likeUnlikeTracker={likeButtonClickCount:0,likeUnlikeInProgress:!1}});var bt=n(8648),pt=n(2791),ht=n(3148),ft=n(109),gt=n(6997),vt=n(7247),Ot=n(1198),It=n(9888),wt=n(2952),kt=n(209);const Ct=n.n(kt).a.bind(W.a),xt=Object(Be.k)("mon-densities"),jt=new Set(["Reply","ReplyAll","SetReaction","Forward"]);let At=class extends P.Component{constructor(e){super(e),this.commandBarHiddenOverflowItems=[],this.commandBarDividerKey=0,this.showAddinsFRECallout=!1,this.addinsFREShown=!1,this.isLabelActivable=!0,this.shouldHideLabel=!1,this.unpinnedAddinFRECallout=!1,this.unpinnedAddinFreShown=!1,this.forcePinnedSurfaceActions=new Set,this.onMenuClickCallback=()=>{c(this.props.item,this.props.viewState)},this.getRef=e=>{this.commandBar=e,(Object(Be.k)("addin-exp-awarenessNudgeCusBtn")||Object(Be.k)("addin-exp-awarenessNudge")||Object(Be.k)("addin-exp-awarenessNudgeWaterDropNudge"))&&e&&(this.unpinnedAddinFRECallout=!0)},this.showFREIfRenderedButtonMatches=e=>t=>{if(!Object(Be.k)("addin-exp-pinNewAdminAddinsFRECallout"))return;const n=Object(ee.r)(at.a.MessageRead);n&&t&&e.id==n&&(this.showAddinsFRECallout=!0)},this.ItemHeaderToolbarButton=Object(ot.a)(e=>P.createElement(tt.a,{theme:Object(ut.a)(xt?Object(ft.e)():null)},P.createElement(M.a,Object.assign({},e,{componentRef:this.showFREIfRenderedButtonMatches(e),menuProps:e.menuProps&&Object.assign(Object.assign({},e.menuProps),{directionalHint:B.a.bottomAutoEdge}),onMenuClick:this.onMenuClickCallback,styles:Object.assign(Object.assign({},e.styles),{root:Ct(W.a.surfaceActionsCommandBarButton,!xt&&W.a.surfaceActionsCommandBarButtonHeight,this.shouldHideLabel&&W.a.hideLabel,this.shouldHideLabel&&!xt&&W.a.surfaceActionsCommandBarButtonWidthHideLabel,!this.shouldHideLabel&&W.a.surfaceActionsCommandBarButtonWidthShowLabel,!this.shouldHideLabel&&Object(Be.k)("mon-tri-replyButtons")&&W.a.surfaceActionsCommandBarButtonBorder),rootDisabled:W.a.disabledReplyActionButton,icon:!xt&&W.a.enabledIconButton,iconDisabled:W.a.disabledIconButton,menuIcon:W.a.commandBarMenuIcon}),role:"menuitem"})))),this.ItemHeaderToolbarOverflowButton=Object(ot.a)(e=>{const t=this.ItemHeaderToolbarButton;return P.createElement(_.a,{content:Object(O.b)(ct.a)},P.createElement(t,Object.assign({},e)))}),this.onCommandBarReduceData=e=>{let{primaryItems:t,overflowItems:n,cacheKey:i}=e,o=-1;for(let e=0;e<t.length;e++){const n=t[e];if(n&&!jt.has(n.key)){o=e;break}}const a=t.length;if(-1===o&&1===a)return;let r=-1!==o?o:a-1;const s=t[r];return s.isPinnedOnly&&function(e,t){t.forEach(t=>{"View"!==t.key||t.subMenuProps.items.includes(e)||t.subMenuProps.items.push(e)})}(s,n),this.commandBarHiddenOverflowItems=[s,...this.commandBarHiddenOverflowItems],t.splice(r,1),i=this.computeCommandBarCacheKey(t),Object.assign(Object.assign({},e),{primaryItems:t,overflowItems:n,cacheKey:i})},this.onCommandBarGrowData=e=>{let{primaryItems:t,overflowItems:n,cacheKey:i}=e;const o=[];for(let e=0;e<t.length;e++){const n=t[e];"SetReaction"===(null==n?void 0:n.key)&&o.push(n)}const a=this.commandBarHiddenOverflowItems[0];if(a){a.isPinnedOnly&&function(e,t){t.forEach(t=>{if("View"===t.key){const n=t.subMenuProps.items.indexOf(e);n>-1&&t.subMenuProps.items.splice(n,1)}})}(a,n);const r=[];return this.commandBarHiddenOverflowItems=this.commandBarHiddenOverflowItems.slice(1),"ToggleDarkMode"===a.key?o.unshift(a):jt.has(a.key)?r.unshift(a):o.push(a),t=[...o,...t.slice(o.length+r.length-1),...r],i=this.computeCommandBarCacheKey(t),Object.assign(Object.assign({},e),{primaryItems:t,overflowItems:n,cacheKey:i})}},this.onResize=()=>{this.isLabelActivable&&(this.shouldHideLabel=this.isReadingPaneWidthBelowCollapseCutoff()),this.commandBar&&this.commandBar.remeasure()},this.state={addinsInitializedState:0},mt(this.props.viewState),this.initializeShouldHideLabel()}createCommandBarItems(){var e;this.commandBarHiddenOverflowItems=[];const t=[],n=[],i=b(),o=[];return((null===(e=this.props.customizedSubsetActionKeys)||void 0===e?void 0:e.length)>0?this.props.customizedSubsetActionKeys:et).forEach(e=>{i[e]&&o.push(i[e])}),o.forEach(e=>{let i=null;"Addins"!==e.key?(i=Xe(e,this.props,this.ItemHeaderToolbarButton),i&&this.addItemToCommandBar(i,n,t)):this.tryCreateAddinsCommandBarItems(t,n,e)}),{items:this.props.hideSurfaceButton?[]:t,overflowItems:n}}addItemToCommandBar(e,t,n){var i,o;let a=e;this.shouldAddItemToSurface(e)&&(this.addItemToCommandBarSurface(n,e),a=Object.assign({},e)),null===(o=null===(i=e.subMenuProps)||void 0===i?void 0:i.items)||void 0===o||o.forEach(e=>{this.shouldAddItemToSurface(e)&&this.addItemToCommandBarSurface(n,Object.assign({},e))}),this.addItemToCommandBarOverflow(t,a)}addItemToCommandBarSurface(e,t){const n=t.key;Object(l.j)(n)||this.forcePinnedSurfaceActions.add(n),t.isPinned=!0,Object(l.p)(n)?e.push(t):e.unshift(t)}addItemToCommandBarOverflow(e,t){var n,i,o,a;if(!t.isPinnedOnly){const r=t.key;t.onRender=null,"AddToBoard"!==r&&(null===(i=null===(n=t.subMenuProps)||void 0===n?void 0:n.items)||void 0===i||i.forEach(e=>{e.onRender=null})),t.renderedInOverflow=!0,null===(a=null===(o=t.subMenuProps)||void 0===o?void 0:o.items)||void 0===a||a.forEach(e=>{e.renderedInOverflow=!0}),"-"==r?Object(It.b)(e,this.commandBarDividerKey++):e.push(t)}}shouldAddItemToSurface(e){if(this.props.hideSurfaceButton)return!1;const t=e.key;return Object(l.o)(t,this.props.item)||this.forcePinnedSurfaceActions.has(t)}componentDidMount(){ht.a.importAndExecute(this.onResize),this.initailizeAddinsIfNeeded()}componentWillUnmount(){ht.c.importAndExecute(this.onResize),this.deInitializeAddins()}componentDidUpdate(e){var t,n;let i=Promise.resolve();2!=this.state.addinsInitializedState||(null===(t=e.viewState)||void 0===t?void 0:t.itemId)==(null===(n=this.props.viewState)||void 0===n?void 0:n.itemId)&&e.shouldIncludeFullInfo==this.props.shouldIncludeFullInfo||(i=this.deInitializeAddins(e.viewState.itemId)),this.props.shouldIncludeFullInfo&&i.then(()=>{this.initailizeAddinsIfNeeded()}),Object(Be.k)("addin-exp-pinNewAdminAddinsFRECallout")&&this.showAddinsFRECallout&&window.requestAnimationFrame(()=>{this.showLatestNewAdminAddinFRECallout()}),(Object(Be.k)("addin-exp-awarenessNudgeCusBtn")||Object(Be.k)("addin-exp-awarenessNudge")||Object(Be.k)("addin-exp-awarenessNudgeWaterDropNudge"))&&this.unpinnedAddinFRECallout&&window.requestAnimationFrame(()=>{this.showUnpinnedAdminAddinFRECallout()})}render(){const e=!this.props.item.ParentFolderId||!Object(f.a)(this.props.item.ParentFolderId.Id,"notes");return P.createElement("div",{className:Ct(W.a.surfaceActionsCommandBarContainer,!xt&&W.a.surfaceActionsCommandBarContainerHeight)},e&&this.renderCommandBar())}renderCommandBar(){if(!this.props.viewState)return null;const e=this.createCommandBarItems();this.highlightCustomizeActionButtonAndAddins(e);const t=xt?rt.a:"More";return P.createElement(nt.a,{componentRef:this.getRef,items:e.items,overflowItems:e.overflowItems,overflowButtonProps:{id:"read_ellipses_menu",iconProps:{iconName:t},menuIconProps:{iconName:t,styles:{root:Object(O.j)(this.props.seeMoreStyles)?W.a.surfaceActionsCommandBarOverflowIcon:Ct(W.a.surfaceActionsCommandBarOverflowIcon,this.props.seeMoreStyles)}},ariaLabel:Object(O.b)(st.a)},buttonAs:this.ItemHeaderToolbarButton,overflowButtonAs:this.ItemHeaderToolbarOverflowButton,shiftOnReduce:!0,onDataReduced:l.n,onDataGrown:l.m,styles:{root:Ct(W.a.surfaceActionsCommandBar,xt&&Object(ft.e)()),primarySet:W.a.surfaceActionsCommandBarPrimarySet},ariaLabel:Object(O.b)(o.c),onReduceData:this.onCommandBarReduceData,onGrowData:this.onCommandBarGrowData})}highlightCustomizeActionButtonAndAddins(e){if(Object(Be.k)("addin-exp-awarenessNudgeCusBtn")||Object(Be.k)("addin-exp-awarenessNudge")||Object(Be.k)("addin-exp-awarenessNudgeWaterDropNudge")){const t=Object(wt.a)();t.shouldHighlightUnpinnedAdminAddins||setTimeout((function(){if(t.shouldHighlightUnpinnedAdminAddins){let t=!1;e.overflowItems.forEach(e=>{t&&ee.z.importAndExecute(e,at.a.MessageRead),"CustomizeActions"==e.key&&ee.y.importAndExecute(e),"addinDivider_22"==e.key&&(t=!0)})}}),2e3)}}computeCommandBarCacheKey(e){return[e.reduce((e,t)=>{const{cacheKey:n=t.key}=t;return e+n},""),"","overflow"].join(" ")}initializeShouldHideLabel(){if(!Object(Be.k)("mon-rp-showLabels")||!Object(pt.a)())return this.isLabelActivable=!1,void(this.shouldHideLabel=!0);this.isLabelActivable=!0,this.shouldHideLabel=this.isReadingPaneWidthBelowCollapseCutoff()}isReadingPaneWidthBelowCollapseCutoff(){const e=document.getElementById("ReadingPaneContainerId");if(e){if(e.getBoundingClientRect().width<a.b)return!0}return!1}tryCreateAddinsCommandBarItems(e,t,n){if(2!=this.state.addinsInitializedState)return;const i=[],o=[],a=Object(Ot.g)(Ot.d.SurfaceActions),r=n.key;this.props.shouldIncludeFullInfo&&Object(It.a)(at.a.MessageRead,this.props.item,this.getFocusedItemId||this.props.item.ItemId.Id,a.readSurfaceAddins,i,o,!0,this.commandBarDividerKey,this.props.targetWindow,null,!0),[...i,...o].forEach(e=>{if(e.onClick){const t=e.onClick;e.onClick=u(t,!0,r,this.props.item,this.props.viewState,this.props.actionSource),e.onKeyDown=u(t,!1,r,this.props.item,this.props.viewState,this.props.actionSource)}}),e.unshift(...i),t.push(...o)}shouldAddinsPopulate(){const e=(!this.props.customizedSubsetActionKeys||0==this.props.customizedSubsetActionKeys.length)&&this.props.shouldIncludeFullInfo,t=h(this.props.viewState,this.props.item);return e&&!Object(lt.a)(t)&&!this.props.isItemAttachment&&Object(ee.Y)(this.props.item)&&!p(this.props.item)&&!Object(gt.a)(this.props.item)}showLatestNewAdminAddinFRECallout(){if(this.addinsFREShown)return;let e=Object(ee.r)(at.a.MessageRead);if(e){let t="New Add-in";const n=Object(ee.p)(e);n&&(t=n.DisplayName),vt.a.importAndExecute(at.a.MessageRead,e,t),this.addinsFREShown=!0}}showUnpinnedAdminAddinFRECallout(){if(this.unpinnedAddinFreShown)return;let e="WithoutCustomizeActionButton";Object(Be.k)("addin-exp-awarenessNudgeCusBtn")?e="WithCustomizeActionButton":Object(Be.k)("addin-exp-awarenessNudgeWaterDropNudge")&&(e="WaterDropCallout"),vt.b.importAndExecute(at.a.MessageRead,e,"read_ellipses_menu"),this.unpinnedAddinFreShown=!0}initailizeAddinsIfNeeded(){0==this.state.addinsInitializedState&&this.shouldAddinsPopulate()&&(this.setState({addinsInitializedState:1}),this.intializeAddinsTask=window.setTimeout(()=>{this.initializeAddins()},1))}async initializeAddins(){const e=(await dt.b.import())(this.props.item,this.props.viewState);ee.A.import().then(t=>{t(Object(ee.q)(this.props.item.ItemId.Id),e,!0,this.props.targetWindow).then(()=>{this.setState({addinsInitializedState:2})})})}async deInitializeAddins(e){if(clearTimeout(this.intializeAddinsTask),0==this.state.addinsInitializedState)return;(await ee.x.import())(Object(ee.q)(e||this.props.item.ItemId.Id),this.props.targetWindow),this.setState({addinsInitializedState:0})}get getFocusedItemId(){if(this.props.viewState.isConversationItemPart){const e=Object(bt.b)();return null==e?void 0:e.itemId}return null}};Object(i.__decorate)([it.computed],At.prototype,"getFocusedItemId",null),At=Object(i.__decorate)([A.observer],At);var Mt=At;n.d(t,"ItemActionsMenu",(function(){return Mt}))},2641:function(e,t,n){"use strict";var i=n(798),o=n(1),a=n(0),r=n(471),s=n(243),c=n(757),d=n(2721),l=n(451),u=n(401),m=n(378),b=n(225),p=n(1444),h=n(1432),f=Object(r.a)(),g=a.createElement(h.a,null).type,v="DialogContent",O=function(e){function t(t){var n=e.call(this,t)||this;return Object(u.a)(n),Object(m.a)(v,t,{titleId:"titleProps.id"}),n}return Object(o.__extends)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.showCloseButton,i=t.className,r=t.closeButtonAriaLabel,s=t.onDismiss,d=t.subTextId,l=t.subText,u=t.titleProps,m=void 0===u?{}:u,h=t.titleId,g=t.title,v=t.type,O=t.styles,I=t.theme,w=t.draggableHeaderClassName,k=f(O,{theme:I,className:i,isLargeHeader:v===c.a.largeHeader,isClose:v===c.a.close,draggableHeaderClassName:w}),C=this._groupChildren();return l&&(e=a.createElement("p",{className:k.subText,id:d},l)),a.createElement("div",{className:k.content},a.createElement("div",{className:k.header},a.createElement("div",Object(o.__assign)({id:h,role:"heading","aria-level":1},m,{className:Object(b.a)(k.title,m.className)}),g),a.createElement("div",{className:k.topButton},this.props.topButtonsProps.map((function(e,t){return a.createElement(p.a,Object(o.__assign)({key:e.uniqueId||t},e))})),(v===c.a.close||n&&v!==c.a.largeHeader)&&a.createElement(p.a,{className:k.button,iconProps:{iconName:"Cancel"},ariaLabel:r,onClick:s,title:r}))),a.createElement("div",{className:k.inner},a.createElement("div",{className:k.innerContent},e,C.contents),C.footers))},t.prototype._groupChildren=function(){var e={footers:[],contents:[]};return a.Children.map(this.props.children,(function(t){"object"==typeof t&&null!==t&&t.type===g?e.footers.push(t):e.contents.push(t)})),e},t.defaultProps={showCloseButton:!1,className:"",topButtonsProps:[],closeButtonAriaLabel:"Close"},t=Object(o.__decorate)([l.d],t)}(a.Component),I=n(8),w={contentLgHeader:"ms-Dialog-lgHeader",close:"ms-Dialog--close",subText:"ms-Dialog-subText",header:"ms-Dialog-header",headerLg:"ms-Dialog--lgHeader",button:"ms-Dialog-button ms-Dialog-button--close",inner:"ms-Dialog-inner",content:"ms-Dialog-content",title:"ms-Dialog-title"},k=Object(i.a)(O,(function(e){var t,n,i,o=e.className,a=e.theme,r=e.isLargeHeader,s=e.isClose,c=e.hidden,d=e.isMultiline,l=e.draggableHeaderClassName,u=a.palette,m=a.fonts,b=a.effects,p=a.semanticColors,h=Object(I.getGlobalClassNames)(w,a);return{content:[r&&[h.contentLgHeader,{borderTop:"4px solid "+u.themePrimary}],s&&h.close,{flexGrow:1,overflowY:"hidden"},o],subText:[h.subText,m.medium,{margin:"0 0 24px 0",color:p.bodySubtext,lineHeight:"1.5",wordWrap:"break-word",fontWeight:I.FontWeights.regular}],header:[h.header,{position:"relative",width:"100%",boxSizing:"border-box"},s&&h.close,l&&[l,{cursor:"move"}]],button:[h.button,c&&{selectors:{".ms-Icon.ms-Icon--Cancel":{color:p.buttonText,fontSize:I.IconFontSizes.medium}}}],inner:[h.inner,{padding:"0 24px 24px",selectors:(t={},t["@media (min-width: "+I.ScreenWidthMinSmall+"px) and (max-width: "+I.ScreenWidthMaxSmall+"px)"]={padding:"0 16px 16px"},t)}],innerContent:[h.content,{position:"relative",width:"100%"}],title:[h.title,m.xLarge,{color:p.bodyText,margin:"0",minHeight:m.xLarge.fontSize,padding:"16px 46px 20px 24px",lineHeight:"normal",selectors:(n={},n["@media (min-width: "+I.ScreenWidthMinSmall+"px) and (max-width: "+I.ScreenWidthMaxSmall+"px)"]={padding:"16px 46px 16px 16px"},n)},r&&{color:p.menuHeader},d&&{fontSize:m.xxLarge.fontSize}],topButton:[{display:"flex",flexDirection:"row",flexWrap:"nowrap",position:"absolute",top:"0",right:"0",padding:"15px 15px 0 0",selectors:(i={"> *":{flex:"0 0 auto"},".ms-Dialog-button":{color:p.buttonText},".ms-Dialog-button:hover":{color:p.buttonTextHovered,borderRadius:b.roundedCorner2}},i["@media (min-width: "+I.ScreenWidthMinSmall+"px) and (max-width: "+I.ScreenWidthMaxSmall+"px)"]={padding:"15px 8px 0 0"},i)}]}}),void 0,{scope:"DialogContent"}),C=Object(r.a)(),x={isDarkOverlay:!1,isBlocking:!1,className:"",containerClassName:"",topOffsetFixed:!1},j={type:c.a.normal,className:"",topButtonsProps:[]},A=function(e){function t(t){var n=e.call(this,t)||this;return n._getSubTextId=function(){var e=n.props,t=e.ariaDescribedById,i=e.modalProps,o=e.dialogContentProps,a=e.subText,r=i&&i.subtitleAriaId||t;return r||(r=(o&&o.subText||a)&&n._defaultSubTextId),r},n._getTitleTextId=function(){var e=n.props,t=e.ariaLabelledById,i=e.modalProps,o=e.dialogContentProps,a=e.title,r=i&&i.titleAriaId||t;return r||(r=(o&&o.title||a)&&n._defaultTitleTextId),r},n._id=Object(s.a)("Dialog"),n._defaultTitleTextId=n._id+"-title",n._defaultSubTextId=n._id+"-subText",n}return Object(o.__extends)(t,e),t.prototype.render=function(){var e,t,n,i,r=this.props,s=r.className,c=r.containerClassName,l=r.contentClassName,u=r.elementToFocusOnDismiss,m=r.firstFocusableSelector,b=r.forceFocusInsideTrap,p=r.styles,h=r.hidden,f=r.ignoreExternalFocusing,g=r.isBlocking,v=r.isClickableOutsideFocusTrap,O=r.isDarkOverlay,I=r.isOpen,w=r.onDismiss,A=r.onDismissed,M=r.onLayerDidMount,S=r.responsiveMode,B=r.subText,y=r.theme,_=r.title,D=r.topButtonsProps,T=r.type,P=r.minWidth,E=r.maxWidth,N=r.modalProps,R=Object(o.__assign)({},N?N.layerProps:{onLayerDidMount:M});M&&!R.onLayerDidMount&&(R.onLayerDidMount=M),N&&N.dragOptions&&!N.dragOptions.dragHandleSelector?(n="ms-Dialog-draggable-header",i=Object(o.__assign)(Object(o.__assign)({},N.dragOptions),{dragHandleSelector:"."+n})):i=N&&N.dragOptions;var F=Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},x),{className:s,containerClassName:c,isBlocking:g,isDarkOverlay:O,onDismissed:A}),N),{layerProps:R,dragOptions:i}),L=Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({className:l,subText:B,title:_,topButtonsProps:D,type:T},j),this.props.dialogContentProps),{draggableHeaderClassName:n,titleProps:Object(o.__assign)({id:(null===(e=this.props.dialogContentProps)||void 0===e?void 0:e.titleId)||this._defaultTitleTextId},null===(t=this.props.dialogContentProps)||void 0===t?void 0:t.titleProps)}),H=C(p,{theme:y,className:F.className,containerClassName:F.containerClassName,hidden:h,dialogDefaultMinWidth:P,dialogDefaultMaxWidth:E});return a.createElement(d.a,Object(o.__assign)({elementToFocusOnDismiss:u,firstFocusableSelector:m,forceFocusInsideTrap:b,ignoreExternalFocusing:f,isClickableOutsideFocusTrap:v,onDismissed:F.onDismissed,responsiveMode:S},F,{isDarkOverlay:F.isDarkOverlay,isBlocking:F.isBlocking,isOpen:void 0!==I?I:!h,className:H.root,containerClassName:H.main,onDismiss:w||F.onDismiss,subtitleAriaId:this._getSubTextId(),titleAriaId:this._getTitleTextId()}),a.createElement(k,Object(o.__assign)({subTextId:this._defaultSubTextId,title:L.title,subText:L.subText,showCloseButton:F.isBlocking,topButtonsProps:L.topButtonsProps,type:L.type,onDismiss:w||L.onDismiss,className:L.className},L),this.props.children))},t.defaultProps={hidden:!0},t=Object(o.__decorate)([l.d],t)}(a.Component),M={root:"ms-Dialog"};n.d(t,"a",(function(){return S}));var S=Object(i.a)(A,(function(e){var t,n=e.className,i=e.containerClassName,o=e.dialogDefaultMinWidth,a=void 0===o?"288px":o,r=e.dialogDefaultMaxWidth,s=void 0===r?"340px":r,c=e.hidden,d=e.theme;return{root:[Object(I.getGlobalClassNames)(M,d).root,d.fonts.medium,n],main:[{width:a,outline:"3px solid transparent",selectors:(t={},t["@media (min-width: "+I.ScreenWidthMinMedium+"px)"]={width:"auto",maxWidth:s,minWidth:a},t)},!c&&{display:"flex"},i]}}),void 0,{scope:"Dialog"});S.displayName="Dialog"},2856:function(e,t,n){"use strict";n.d(t,"a",(function(){return ReactEditor})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return c}));var i=n(20);const o=new i.c(()=>Promise.all([n.e(23),n.e(27),n.e(30),n.e(31),n.e(41),n.e(294),n.e(751)]).then(n.bind(null,3678)));let ReactEditor=Object(i.d)(o,e=>e.ReactEditor),a=new i.b(o,e=>e.setTableHeaderRow),r=new i.b(o,e=>e.operateContent),s=new i.b(o,e=>e.focusToEditor);function c(e){s.import().then(t=>t(e))}},2876:function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));var i=n(2);const o=Object(i.createStore)("CommandRibbon",{viewMode:0});t.a=o()},2935:function(e,t,n){"use strict";n.d(t,"b",(function(){return a}));var i=n(2);const o={bulkActionInformationMap:new(n(13).ObservableMap)},a=Object(i.createStore)("bulkActionStore",o),r=a();t.a=r},2939:function(e,t,n){"use strict";var i=n(3095),o=n(20),a=n(3272),r=n(3073);function s(){let e=Object(r.a)();return{isFullOptionsShown:e.isFullOptionsShown,areAllAllowedSubCategoriesLoaded:e.areAllAllowedSubCategoriesLoaded,currentCategoryKey:e.currentCategoryKey,currentSubCategoryKey:e.currentSubCategoryKey,currentOptionKey:e.currentOptionKey}}n.d(t,"f",(function(){return d})),n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return m})),n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return s}));const c=new o.c(()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(8),n.e(9),n.e(11),n.e(12),n.e(13),n.e(14),n.e(15),n.e(17),n.e(18),n.e(19),n.e(25),n.e(27),n.e(30),n.e(34),n.e(36),n.e(37),n.e(48),n.e(63),n.e(94),n.e(481)]).then(n.bind(null,19868)));let d=new o.a(c,e=>e.mountAndShowFullOptions),l=new o.b(c,e=>e.hideFullOptions),u=new o.b(c,e=>e.confirmDirtyOptionsAndPerformAction),m=new o.b(c,e=>e.exitOptionsFullPage);var b=Object(i.a)(c,e=>e.QuickOptions);Object(o.f)(a.a,c,e=>e.mountFullOptionsOrchestrator)},2951:function(e,t){e.exports=function(e){return e instanceof Date}},3020:function(e,t,n){"use strict";var i={};n.r(i),n.d(i,"add",(function(){return c})),n.d(i,"remove",(function(){return d})),n.d(i,"removeAll",(function(){return l})),n.d(i,"getCount",(function(){return u})),n.d(i,"getTombstonedReasons",(function(){return m})),n.d(i,"clearMapForFolder",(function(){return b})),n.d(i,"removeRowsFromTombstone",(function(){return p}));var o=n(2);let a=Object(o.createStore)("tombstone",{folderTombstoneMap:{}});a();var r=n(68),s=n(358);let c=Object(s.action)("tombstoneOperations.add")((function(e,t,n){if(1==t.tableQuery.type||"spotlight"===t.tableQuery.scenarioType)return;const i=t.serverFolderId,o=a().folderTombstoneMap;i in o||(o[i]={});const r=o[i];e.forEach(e=>{let t=r[e];t?3!=n?t.indexOf(3)>-1||-1==t.indexOf(n)&&t.push(n):r[e]=[3]:r[e]=[n]})})),d=Object(s.action)("tombstoneOperations.remove")((function(e,t,n){const i=a().folderTombstoneMap;if(!(t in i))return;const o=i[t],r=o[e],s=r?r.indexOf(n):-1;if(-1==s)throw new Error("tombstone.remove given reason does not exist when trying to remove entry from it");r.splice(s,1),0==r.length&&delete o[e],0==Object.keys(o).length&&delete i[t]})),l=Object(s.action)("tombstoneOperations.removeAll")((function(){a().folderTombstoneMap={},Object(r.q)("TnS_RemoveAllFromTombstone")})),u=function(e,t){const n=a().folderTombstoneMap;if(!(e in n))return 0;let i=0;const o=n[e];return Object.values(o).forEach(e=>{e==t&&i++}),i},m=function(e,t){const n=a().folderTombstoneMap;if(t in n){const i=n[t][e];if(i)return i}return[]},b=Object(s.action)("tombstoneOperations.clearMapForFolder")((function(e){const t=a().folderTombstoneMap;t[e]&&(Object(r.q)("TnS_ClearFolderMapInTombstone",[Object.keys(t[e]).length]),delete t[e])})),p=Object(s.action)("tombstoneOperations.removeRowsFromTombstone")((function(e,t){const n=a().folderTombstoneMap;if(!(t in n))return;const i=n[t];for(const t of e)t in i&&delete i[t];0==Object.keys(i).length&&delete n[t]}));t.a=i},3027:function(e,t,n){"use strict";var i=n(2);const o=Object(i.createStore)("undo",{hasUndoableAction:!1,undoableActionFolderId:null});var a=o(),r=n(3020),s=n(68),c=n(595);const d={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DismissUndo"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dismissUndo"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"undoRequestId"},value:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"}}]}}]}}]};var l=n(3962),u=n(3572);let m,b;n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return g})),n.d(t,"d",(function(){return O})),n.d(t,"e",(function(){return I}));const p=Object(i.mutatorAction)("setUndoableAction",(e,t)=>{const n=o();n.hasUndoableAction=e,n.undoableActionFolderId=t});function h(e,t,n){null!==e&&(m=e,b=n||null,p(!0,t))}async function f(){await g(),m=null,p(!1,null)}async function g(){if(b){try{const e=await b;if(e.success){const t=e.undoRequestId;if(t){let e={undoRequestId:t};await v.invokeDismissUndoMutation(e)}}}catch(e){}b=null}}const v={invokeDismissUndoMutation:async function(e){const t=Object(c.a)();t&&await t.mutate({variables:e,mutation:d})}};function O(){return o().hasUndoableAction}function I(e){const t=new s.b("TnS_Undo");t.addCustomData([e]),a.undoableActionFolderId?r.a.clearMapForFolder(a.undoableActionFolderId):r.a.removeAll();return null!==m&&(m().then(()=>{Object(l.a)()||Object(u.a)()}),f()),t.end(),Promise.resolve()}},3030:function(e,t,n){var i=n(2951),o=36e5,a=6e4,r=2,s=/[T ]/,c=/:/,d=/^(\d{2})$/,l=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],u=/^(\d{4})/,m=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],b=/^-(\d{2})$/,p=/^-?(\d{3})$/,h=/^-?(\d{2})-?(\d{2})$/,f=/^-?W(\d{2})$/,g=/^-?W(\d{2})-?(\d{1})$/,v=/^(\d{2}([.,]\d*)?)$/,O=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,I=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,w=/([Z+-].*)$/,k=/^(Z)$/,C=/^([+-])(\d{2})$/,x=/^([+-])(\d{2}):?(\d{2})$/;function j(e,t,n){t=t||0,n=n||0;var i=new Date(0);i.setUTCFullYear(e,0,4);var o=7*t+n+1-(i.getUTCDay()||7);return i.setUTCDate(i.getUTCDate()+o),i}e.exports=function(e,t){if(i(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?r:Number(n);var A=function(e){var t,n={},i=e.split(s);c.test(i[0])?(n.date=null,t=i[0]):(n.date=i[0],t=i[1]);if(t){var o=w.exec(t);o?(n.time=t.replace(o[1],""),n.timezone=o[1]):n.time=t}return n}(e),M=function(e,t){var n,i=l[t],o=m[t];if(n=u.exec(e)||o.exec(e)){var a=n[1];return{year:parseInt(a,10),restDateString:e.slice(a.length)}}if(n=d.exec(e)||i.exec(e)){var r=n[1];return{year:100*parseInt(r,10),restDateString:e.slice(r.length)}}return{year:null}}(A.date,n),S=M.year,B=function(e,t){if(null===t)return null;var n,i,o,a;if(0===e.length)return(i=new Date(0)).setUTCFullYear(t),i;if(n=b.exec(e))return i=new Date(0),o=parseInt(n[1],10)-1,i.setUTCFullYear(t,o),i;if(n=p.exec(e)){i=new Date(0);var r=parseInt(n[1],10);return i.setUTCFullYear(t,0,r),i}if(n=h.exec(e)){i=new Date(0),o=parseInt(n[1],10)-1;var s=parseInt(n[2],10);return i.setUTCFullYear(t,o,s),i}if(n=f.exec(e))return a=parseInt(n[1],10)-1,j(t,a);if(n=g.exec(e)){a=parseInt(n[1],10)-1;var c=parseInt(n[2],10)-1;return j(t,a,c)}return null}(M.restDateString,S);if(B){var y,_=B.getTime(),D=0;return A.time&&(D=function(e){var t,n,i;if(t=v.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*o;if(t=O.exec(e))return n=parseInt(t[1],10),i=parseFloat(t[2].replace(",",".")),n%24*o+i*a;if(t=I.exec(e)){n=parseInt(t[1],10),i=parseInt(t[2],10);var r=parseFloat(t[3].replace(",","."));return n%24*o+i*a+1e3*r}return null}(A.time)),A.timezone?y=function(e){var t,n;if(t=k.exec(e))return 0;if(t=C.exec(e))return n=60*parseInt(t[2],10),"+"===t[1]?-n:n;if(t=x.exec(e))return n=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-n:n;return 0}(A.timezone):(y=new Date(_+D).getTimezoneOffset(),y=new Date(_+D+y*a).getTimezoneOffset()),new Date(_+D+y*a)}return new Date(e)}},3052:function(e,t,n){"use strict";var i=n(2);const o=Object(i.action)("onViewModeChanged",e=>({viewMode:e}));var a=n(2876),r=n(68);const s=Object(i.mutatorAction)("onViewModeChangedInternal",e=>{Object(r.p)("ViewModeChanged",{from:Object(a.b)().viewMode,to:e}),Object(a.b)().viewMode=e});var c=n(1198);async function d(){const e=await c.j.import();return e&&await e(c.d.Commanding)}function l(e){!async function(e){const t=await d()||Object(c.g)(c.d.Commanding),n=Object.assign(Object.assign({},t),e);c.i.importAndExecute(c.d.Commanding,n)}({viewMode:e})}Object(i.orchestrator)(o,async e=>{const{viewMode:t}=e;return s(t),l(t)});var u=n(25),m=n(154);const b=Object(i.mutatorAction)("initializeCommandingViewMode",e=>{let t=Object(u.k)("mon-ribbon")?(e=>{var t;let n=null===(t=e.filter(e=>(null==e?void 0:e.feature)==c.d.Commanding)[0])||void 0===t?void 0:t.viewMode;if([void 0,0,1,2].includes(n))return n})(e):0;void 0===t&&(t=Object(m.a)("ribbonDefaultToSLR")?1:0,Object(m.a)("ribbonPersistDefault")&&l(t)),Object(a.b)().viewMode=t}),p=()=>{const e=a.a.viewMode;return 2===e||1===e||0===e&&Object(u.k)("mon-ribbon-toolbar")};var h=n(3187);n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return b})),n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return h.a}))},3073:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(13),o=n(2);const a=Object(o.createStore)("optionsViewState",{isFullOptionsShown:!1,areAllAllowedSubCategoriesLoaded:!1,isSaving:!1,currentCategoryKey:null,currentSubCategoryKey:null,subCategoryLoadState:new i.ObservableMap,currentOptionKey:null,allowedOptions:[],dirtyOptions:[]})},3085:function(e,t,n){"use strict";var i=n(20),o=n(2935),a=n(3724),r=n(22);function s(e){const t=o.a.bulkActionInformationMap.get(e);return!!t&&(!(t.customData&&!function(e){let t;try{t=JSON.parse(e)}catch(e){return r.d("Failed to parse bulkActionInfo.customData"),!1}return null!==t&&null!==t.Scenario}(t.customData))&&!Object(a.a)(t,e))}function c(e,t){const n=o.a.bulkActionInformationMap.get(e);return s(e)&&n.state==t}function d(e){return(c(e,l.b.Uninitialized)||c(e,l.b.Running))&&s(e)}var l=n(3136);n.d(t,"a",(function(){return m})),n.d(t,"j",(function(){return b})),n.d(t,"i",(function(){return p})),n.d(t,"k",(function(){return h})),n.d(t,"f",(function(){return f})),n.d(t,"h",(function(){return g})),n.d(t,"g",(function(){return v})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return s})),n.d(t,"d",(function(){return d})),n.d(t,"b",(function(){return l.b})),n.d(t,"l",(function(){return o.a}));const u=new i.c(()=>Promise.all([n.e(1),n.e(291),n.e(1061)]).then(n.bind(null,13283))),m=Object(i.d)(u,e=>e.BulkActionSpinner);let b=new i.a(u,e=>e.subscribeToBulkActionNotification),p=new i.a(u,e=>e.onBulkActionSubmitted),h=new i.a(u,e=>e.findBulkActionItemAction),f=new i.a(u,e=>e.onBulkActionCancel),g=new i.a(u,e=>e.onBulkActionHierarchyNotification),v=new i.a(u,e=>e.onBulkActionDismiss)},3095:function(e,t,n){"use strict";var i=n(0),o=n(487),a=n(20),r=n(595);function s(e,t,n,s){return Object(a.d)(e,e=>{const n=t(e);return e=>i.createElement(o.ApolloProvider,{client:Object(r.a)()},i.createElement(n,Object.assign({},e)))},n,s)}n.d(t,"a",(function(){return s}))},3101:function(e,t,n){"use strict";var i=n(20),o=n(3027),a=n(2733),r=n(2742),s=n(1084),c=n(2737);function d(e,t){return!(!e||Object(a.y)()||!t||"UserMailbox"!==t.type||Object(r.m)(e)||e==Object(s.a)("recoverableitemsdeletions")||Object(c.C)(e,"SharedMailbox"))}n.d(t,"f",(function(){return u})),n.d(t,"a",(function(){return o.a})),n.d(t,"b",(function(){return o.b})),n.d(t,"e",(function(){return o.d})),n.d(t,"c",(function(){return o.c})),n.d(t,"d",(function(){return d}));const l=new i.c(()=>n.e(2188).then(n.bind(null,19509)));let u=new i.a(l,e=>e.undo)},3136:function(e,t,n){"use strict";var i,o;n.d(t,"a",(function(){return o})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Running=1]="Running",e[e.Cancelled=2]="Cancelled",e[e.Complete=3]="Complete",e[e.Failed=4]="Failed",e[e.Timeout=5]="Timeout",e[e.Cancelling=6]="Cancelling"}(i||(i={})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Running=1]="Running",e[e.Cancelled=2]="Cancelled",e[e.Complete=3]="Complete",e[e.Failed=4]="Failed",e[e.Timeout=5]="Timeout"}(o||(o={})),t.b=i},3187:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(2876);const o=e=>i.a.viewMode===e},3272:function(e,t,n){"use strict";var i=n(2);t.a=Object(i.action)("mountFullOptions",(e,t,n)=>({category:e,subcategory:t,option:n}))},3508:function(e,t,n){"use strict";var i=n(2);const o=Object(i.action)("openCalendarBoardView");var a=n(25),r=n(52);function s(){var e;return Object(a.k)("cal-sublimity")&&!(null===(e=Object(r.g)().SessionSettings)||void 0===e?void 0:e.IsShadowMailbox)}function c(){window.open("/calendar/view/board","_blank")}n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}))},3572:function(e,t,n){"use strict";var i=n(2);t.a=Object(i.action)("RESTORE_ROW_FAIL")},3652:function(e,t,n){"use strict";var i=n(2);t.a=Object(i.action)("GET_FOLDER_DATA",e=>({folderId:e}))},3724:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(3805),o=n.n(i),a=n(3136),r=n(2935);function s(e,t){const n=new Date,i=new Date(e.sendTime),s=o()(n,i),c=isNaN(s),d=s>7.5,l=Object(r.b)().bulkActionInformationMap.get(t);return!(!c&&!d)||!!l&&[a.b.Cancelled,a.b.Failed,a.b.Complete].indexOf(l.state)>-1}},3767:function(e,t,n){var i=n(3030);e.exports=function(e,t){var n=i(e),o=i(t);return n.getTime()-o.getTime()}},3805:function(e,t,n){var i=n(3767),o=36e5;e.exports=function(e,t){var n=i(e,t)/o;return n>0?Math.floor(n):Math.ceil(n)}},3962:function(e,t,n){"use strict";let i;function o(){i=!0}function a(){return i}n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}))},4091:function(e,t,n){"use strict";var i=n(20),o=n(2),a=n(159);const r={sessionId:Object(a.a)(),isLoading:!1,immersiveReaderFrameState:0,apiResponse:null,token:null,subdomain:null,tokenExpiry:null};let s=Object(o.createStore)("immersivereader",r);var c=s();n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return m})),n.d(t,"e",(function(){return c})),n.d(t,"a",(function(){return s}));const d=new i.c(()=>n.e(1012).then(n.bind(null,19826)));let l=new i.a(d,e=>e.showInImmersiveReader),u=new i.a(d,e=>e.closeImmersiveReader),m=new i.a(d,e=>e.setImmersiveReaderFrameReady)},4109:function(e){e.exports=JSON.parse('{"a":"LGa","c":"MGa","e":"NGa","b":"OGa","d":"PGa"}')},4154:function(e,t,n){"use strict";var i=n(2);var o=Object(i.action)("POPOUT_READING_PANE",(e,t,n,i)=>({itemId:e,conversationId:t,mailboxInfo:n,data:i}));n.d(t,"a",(function(){return o}))},4235:function(e,t,n){"use strict";var i=n(2856);const o="_ShowEditorSettingsSource";function a(e,t){return()=>{i.c.import().then(n=>n(e,e=>(e.triggerContentChangedEvent(o,t),null)))}}var r=n(25),s=n(100);function c(){return Object(s.c)()||Object(s.d)()||Object(r.k)("mc-officeEditorBXFirefoxSafari")&&(Object(s.f)()||Object(s.i)())}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c}))},4451:function(e){e.exports=JSON.parse('{"a":"$Ga"}')},4730:function(e){e.exports=JSON.parse('{"a":"aHa"}')},4842:function(e){e.exports=JSON.parse('{"a":"ztc"}')},4843:function(e){e.exports=JSON.parse('{"a":"gHa"}')},4844:function(e){e.exports=JSON.parse('{"a":"fHa"}')},4883:function(e){e.exports=JSON.parse('{"a":"TUb"}')},5119:function(e){e.exports=JSON.parse('{"a":"JGa"}')},5120:function(e){e.exports=JSON.parse('{"a":"QGa"}')},5315:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));var i=n(20);const o=new i.c(()=>Promise.all([n.e(4),n.e(6),n.e(7),n.e(219),n.e(315),n.e(322),n.e(642)]).then(n.bind(null,7940)));let a=new i.b(o,e=>e.createRuleFromItem),r=new i.b(o,e=>e.createRuleFromRow)},5521:function(e){e.exports=JSON.parse('{"a":"CGa"}')},5540:function(e,t,n){"use strict";var i=n(0),o=n(192),a=n(518);t.a="MoreHorizontalRegular";const r=Object(a.a)({Svg:e=>i.createElement("svg",Object.assign({},e,{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"}),i.createElement("path",{d:"M5 8a1 1 0 11-2 0 1 1 0 012 0z"}),i.createElement("path",{d:"M9 8a1 1 0 11-2 0 1 1 0 012 0z"}),i.createElement("path",{d:"M12 9a1 1 0 100-2 1 1 0 000 2z"})),displayName:"MoreHorizontalRegular"});Object(o.p)({icons:{MoreHorizontalRegular:i.createElement(r,null)}})},5815:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var i=n(20);const o=new i.c(()=>n.e(662).then(n.bind(null,9020))),a=new i.b(o,e=>e.onArchiveTagForFolderChanged),r=new i.b(o,e=>e.onDeleteTagForFolderChanged),s=new i.b(o,e=>e.getRetentionPolicyMenuItem),c=new i.b(o,e=>e.getAssignPolicyPropertiesForMailContextMenu)},6982:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(20);const o=new i.c(()=>n.e(1141).then(n.bind(null,11901)));let a=new i.b(o,e=>e.preparePopoutDataForReadingPane)},7247:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));var i=n(20);const o=new i.c(()=>Promise.all([n.e(4),n.e(8),n.e(12),n.e(14),n.e(17),n.e(18),n.e(22),n.e(34),n.e(36),n.e(40),n.e(45),n.e(48),n.e(63),n.e(94),n.e(128),n.e(135),n.e(187),n.e(183),n.e(231),n.e(308),n.e(320),n.e(489)]).then(n.bind(null,9861))),a=new i.a(o,e=>e.showAdminInstalledNewAddinFRECallout),r=new i.a(o,e=>e.showUnpinnedAdminAddinFRECallout)},757:function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.normal=0]="normal",e[e.largeHeader=1]="largeHeader",e[e.close=2]="close"}(i||(i={}))},8493:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(20);const o=new i.c(()=>n.e(429).then(n.bind(null,11766))),a=new i.b(o,e=>e.getSpacesContextMenuItems)},8689:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(2793),o=n(1087);function a(e){return Object(i.a)(e.ItemId.Id,Object(o.a)({BaseShape:"IdOnly"}),"MessageDetails","V2016_06_24",e.MailboxInfo).then(e=>e&&!(e instanceof Error)&&null!=e.ExtendedProperty&&e.ExtendedProperty.length>=1?e.ExtendedProperty[0].Value:null)}},8902:function(e){e.exports=JSON.parse('{"a":"Mmc"}')},9888:function(e,t,n){"use strict";var i=n(2);var o=Object(i.createStore)("AddinsSurfaceActionsStore",{isAddinObserverLoaded:!1})(),a=n(358),r=Object(a.action)("setAddinObserverLoaded ")((function(){o.isAddinObserverLoaded=!0})),s=n(2806);let c;s.t.import().then(e=>{c=e,r()});var d=n(134),l=n(2899),u=n(2737),m=n(4423),b=n(25);function p(e,t){const n=e.length;n>0&&e[n-1].displayName!=m.a&&e.push({key:`addinDivider_${t}`,displayName:m.a,itemType:d.a.Divider,onClick:null})}function h(e,t,n,i,a,r,m,h,f,g,v,O,I){let w;O=O||function(e){if(!e||!e.ParentFolderId)return!1;const t=e.ParentFolderId.Id;return Object(u.C)(t,"SharedMailbox")}(t);const k=e==l.a.MessageRead?Object(s.q)(n):Object(s.n)(n),C=function(e,t,n,i){return o.isAddinObserverLoaded&&c?c(e,t,n,i).get():null}(e,O,k,f);w=C?C.sectionProps.items:[];let x=!0;w.forEach(t=>{Object(s.l)(k,t,f);const n=t;if(n.iconOnly=!0,g&&(n.className=g),n.disabled=!!I,i.indexOf(t.key)>=0){let e=n;v&&(e=Object.assign({},n)),null!=e.name&&null!=e.title&&e.name.trim()!=e.title.trim()&&(e.name=e.ariaLabel),e.title="",function(e,t,n){t.isPinned=!0,t.subMenuProps&&t.subMenuProps.items.forEach(e=>{e.isPinned=!0}),n?e.unshift(t):e.push(t)}(a,e,m)}(-1==i.indexOf(t.key)||v)&&(x&&(p(r,h++),x=!1),n.renderedInOverflow=!0,n.subMenuProps&&n.subMenuProps.items.forEach(e=>{e.renderedInOverflow=!0}),(n.itemType!==d.a.Divider||0!==r.length&&r[r.length-1].itemType!==d.a.Divider)&&((Object(b.k)("addin-exp-awarenessNudgeCusBtn")||Object(b.k)("addin-exp-awarenessNudge")||Object(b.k)("addin-exp-awarenessNudgeWaterDropNudge"))&&s.z.importAndExecute(n,e),r.push(n)))})}n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return h}))},9995:function(e,t,n){"use strict";var i=n(711),o=n(2641),a=n(757),r=n(1432),s=n(342),c=n(21),d=n(6),l=n(4883),u=n(8689),m=n(2793),b=n(1087);function p(e){return Object(m.a)(e.ItemId.Id,Object(b.a)({BaseShape:"IdOnly",IncludeMimeContent:!0}),null,"V2016_06_24",e.MailboxInfo).then(e=>!e||e instanceof Error?null:e.MimeContent)}var h=n(220),f=n(0),g=n(199),v=n(11058),O=n(77),I=n.n(O),w=n(11059),k=n.n(w);n.d(t,"a",(function(){return x}));const C=Object(c.a)((function(e,t){const[n,s]=f.useState("");f.useImperativeHandle(t,()=>({setContent(e){null!==e&&0!==e.length||(e=Object(d.b)(v.a)),s(e)}}),[]);const c=()=>{e.onClose()};return f.createElement(o.a,{hidden:!1,dialogContentProps:{showCloseButton:!1,title:Object(h.a)()?Object(d.b)(v.c):Object(d.b)(v.b),type:a.a.normal},modalProps:{containerClassName:k.a.container},onDismiss:c},f.createElement("div",{className:I()(k.a.content,"allowTextSelection"),tabIndex:-1},n),f.createElement(r.a,null,f.createElement(i.a,{onClick:c,className:k.a.button},Object(d.b)(l.a))))}),{forwardRef:!0});function x(e,t){var n;const i=(t||window).document,o=i.createElement("div");o.id="ViewMessageSourceDialog",i.body.appendChild(o);const a=f.createRef();g.render(f.createElement(s.b,{window:t||window},f.createElement(C,{onClose:()=>{g.unmountComponentAtNode(o),i.body.removeChild(o)},ref:a})),o),Object(h.a)()?(null===(n=e.MimeContent)||void 0===n?void 0:n.Value)?a.current.setContent(atob(e.MimeContent.Value)):p(e).then(t=>{e.MimeContent=t,a.current.setContent(atob(e.MimeContent.Value))}):Object(u.a)(e).then(e=>{a.current.setContent(e)})}}}]);
//# sourceMappingURL=owa.597.js.map
self.scriptsLoaded['owa.597.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.597.js'] = (new Date()).getTime();