self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.946.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[946],{11891:function(e,t,r){"use strict";var a=r(9607),o=r(9608),n=r(872),i=r(2);Object(i.mutator)(a.b,e=>{Object(o.b)().userMailboxWrapper=e.userMailboxWrapper}),Object(i.mutator)(a.a,()=>{const e=Object(o.b)();e.userMailboxWrapper=null,e.findControlViewState={queryString:"",findResultSet:[],findResultType:n.b.None,isSearching:!1,directorySearchType:n.a.None,findPeopleFeedbackManager:null,numberOfCacheResults:0}});var s=r(20);r.d(t,"a",(function(){return d}));const c=new s.c(()=>Promise.all([r.e(4),r.e(5),r.e(43),r.e(59),r.e(70),r.e(640)]).then(r.bind(null,20090)));let d=Object(s.d)(c,e=>e.PeoplePickerDialog)},16005:function(e){e.exports=JSON.parse('{"a":"xwc"}')},16006:function(e){e.exports=JSON.parse('{"a":"vwc"}')},391:function(e,t,r){"use strict";function a(e,t){return e?Object.assign({mailboxInfo:e},t):null!=t?t:void 0}r.d(t,"a",(function(){return a}))},4791:function(e){e.exports=JSON.parse('{"a":"iYa"}')},5141:function(e,t,r){"use strict";r.d(t,"b",(function(){return n}));var a=r(2);const o={showPeoplePickerDialog:!1,retentionPolicyTags:new(r(13).ObservableMap)({})},n=Object(a.createStore)("sharedFolderState",o),i=n();t.a=i},6571:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var a=r(2737),o=r(52);function n(e){return e||(e=Object(o.b)()),Object(a.s)(e).sharedFolderUserEmails}},7301:function(e){e.exports=JSON.parse('{"a":"hYa"}')},8680:function(e){e.exports=JSON.parse('{"a":"wwc"}')},872:function(e,t,r){"use strict";var a,o;r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return o})),function(e){e[e.None=0]="None",e[e.Cache=1]="Cache",e[e.FindPeople=2]="FindPeople",e[e.SearchDirectory=3]="SearchDirectory",e[e.MixedCacheLive=4]="MixedCacheLive"}(a||(a={})),function(e){e[e.None=0]="None",e[e.Auto=1]="Auto",e[e.Manual=2]="Manual"}(o||(o={}))},9563:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var a=r(4);const o=new a.b(()=>r.e(1310).then(r.bind(null,12955))),n=new a.c(o,e=>e.FolderHierarchyDocument)},9564:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var a=r(2),o=r(52);const n=Object(a.action)("GET_SHARED_FOLDERS",(e,t,r,a)=>(a||(a=Object(o.b)()),{sharedUserMailboxSmtpAddress:e,actionSource:t,isLoadingMore:r,userIdentity:a}))},9607:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return n}));var a=r(2);const o=Object(a.action)("populateUserMailboxInfo",e=>({userMailboxWrapper:e})),n=Object(a.action)("ON_DISMISSED")},9608:function(e,t,r){"use strict";r.d(t,"b",(function(){return i}));var a=r(872),o=r(2);const n={userMailboxWrapper:null,findControlViewState:{queryString:"",findResultSet:[],findResultType:a.b.None,isSearching:!1,directorySearchType:a.a.None,findPeopleFeedbackManager:null,numberOfCacheResults:0}},i=Object(o.createStore)("peoplePickerDialogStore",n);t.a=i()},9833:function(e,t,r){"use strict";r.r(t);var a=r(21),o=r(16005),n=r(8680),i=r(6),s=r(11891),c=r(0),d=r(5141),l=r(16006),u=r(2);const b=Object(u.action)("ADD_SHARED_FOLDER_USER_EMAIL",(e,t)=>({sharedUserMailboxSmtpAddress:e,userIdentity:t})),O=Object(u.action)("ON_ADD_SHARED_FOLDER_SUCCESS",(e,t,r)=>({sharedUserMailboxSmtpAddress:e,folder:t,userIdentity:r}));var h=r(35);function p(e,t){return r={displayName:e,primarySMTPAddress:t},Object(h.a)("AddSharedFolders",r,a);var r,a}var f=r(68),S=r(596),j=r(4791),y=r(22),m=r(52);async function v(e,t,r=!1,a=Object(m.b)()){try{if(!r){if(!await p(e,t))return}}catch(e){return Object(S.b)(Object(i.b)(j.a),Object(i.b)(l.a),!1,{hideCancelButton:!0}),void y.d("Add shared folder API returned error "+e)}O(t,{FolderId:{Id:t},displayName:e,principalSMTPAddress:t,UnreadCount:0,TotalCount:0,DistinguishedFolderId:void 0,mailboxInfo:{type:"SharedMailbox",userIdentity:a,mailboxSmtpAddress:t}},a),b(t,a),r||Object(f.p)("Triage_SharedFolders_AddFolder")}const g=Object(u.action)("showAddSharedFolderDialog",e=>({showDialogMessageFlag:e}));var M=Object(a.a)((function(){return d.a.showPeoplePickerDialog&&c.createElement(s.a,{title:Object(i.b)(n.a),subTitle:Object(i.b)(o.a),addCallback:x,cancelCallback:A})}));function x(e){v(e.Name,e.EmailAddress)}function A(){g(!1)}const F=Object(u.action)("REMOVE_SHARED_FOLDER_USER",(e,t)=>(t||(t=Object(m.b)()),{sharedUserMailboxSmtpAddress:e,userIdentity:t}));var I=r(6571);const R=Object(u.action)("REMOVE_SHARED_FOLDER_USER_EMAIL",(e,t)=>({sharedUserMailboxSmtpAddress:e,userIdentity:t}));Object(u.mutator)(R,e=>{let t=Object(I.a)(e.userIdentity);const r=t.indexOf(e.sharedUserMailboxSmtpAddress);-1!==r?t.splice(r,1):y.d("Trying to remove a non-existent shared folder user : "+e.sharedUserMailboxSmtpAddress)}),Object(u.mutator)(b,e=>{let t=Object(I.a)(e.userIdentity);-1==t.indexOf(e.sharedUserMailboxSmtpAddress)&&t.push(e.sharedUserMailboxSmtpAddress)}),Object(u.mutator)(g,e=>{Object(d.b)().showPeoplePickerDialog=e.showDialogMessageFlag});var _=r(2737);Object(u.orchestrator)(O,e=>{const t={};t[e.sharedUserMailboxSmtpAddress]=e.folder,Object(_.b)(t),Object(_.V)(e.sharedUserMailboxSmtpAddress,e.folder,_.a.Uninitialized,!0,0,e.userIdentity)});const E=Object(u.action)("ON_SHARED_FOLDER_FETCH_FAILED",(e,t)=>({sharedUserMailboxSmtpAddress:e,actionSource:t}));var D=r(66),w=r(9564),P=r(2741),T=r(595),U=r(9563);const N=Object(u.action)("INITIALIZE_SHARED_FOLDER_RETENTION_POLICY_TAGS",(e,t)=>({sharedUserMailboxSmtpAddress:e,userIdentity:t}));Object(u.orchestrator)(w.a,async e=>{const{userIdentity:t,sharedUserMailboxSmtpAddress:r,actionSource:a,isLoadingMore:o}=e,n=Object(_.p)(r,t);if(n===_.a.Loading||n===_.a.Loaded&&!o)return;let i;Object(_.W)(r,_.a.Loading,t);const s=Object(_.n)(r,t);try{const e=await U.a.import();i=(await Object(T.a)().query({query:e,variables:{baseFolderDistinguishedIds:[P.m,"inbox"],offset:s,mailboxInfo:{userIdentity:t,mailboxSmtpAddress:r,type:"SharedMailbox"}}})).data.folderHierarchy}catch(e){return Object(f.p)("SharedFolders_FetchFailed",[e.ResponseCode,e.diagnosticInfo],{isCore:!0}),E(r,a),void Object(_.W)(r,_.a.ErrorLoading,t)}const c=Object(_.w)(r).displayName;Object(_.R)(i.RootFolder,i.Folders,P.m,r,c,r,t,i.IncludesLastItemInRange,i.offset),0===s&&N(r,t),function(e){Object(f.p)("Triage_SharedFolders_OpenFolder",[Object(D.c)({value:e})])}(i.TotalItemsInView)});var C=r(7301),L=r(2948),k=r(4028);function H(e){return t={primarySMTPAddress:e},Object(h.a)("RemoveSharedFolders",t,r);var t,r}Object(u.orchestrator)(E,e=>{Object(L.i)(Object(i.b)(j.a),Object(i.b)(C.a)),"folderPane"===e.actionSource&&Object(k.a)(e.sharedUserMailboxSmtpAddress,!0)});Object(u.orchestrator)(F,async e=>{const{sharedUserMailboxSmtpAddress:t,userIdentity:r}=e;let a;try{a=await H(t)}catch(e){y.d("Remove shared folders server call failed with error "+e)}a?(R(t,r),Object(_.U)(t,r),Object(f.p)("Triage_SharedFolders_RemoveFolder")):y.d("Remove shared folders server call returned false")});function W(e,t){var r;return void 0===e||e.__type||(r=e,e=Object.assign({__type:"GetUserRetentionPolicyTagsJsonRequest:#Exchange"},r)),Object(h.a)("GetUserRetentionPolicyTags",e,t)}var z=r(167),B=r(391);const J=Object(u.mutatorAction)("setPolicyTags",(e,t)=>{Object(d.b)().retentionPolicyTags.set(e,t)});function V(){return e={},Object(h.a)("GetOtherMailboxConfiguration",e,t);var e,t}Object(u.orchestrator)(N,async e=>{var t,r;const{sharedUserMailboxSmtpAddress:a}=e;try{const e=await function(e){const t={type:"SharedMailbox",userIdentity:Object(m.b)(),mailboxSmtpAddress:e},r=Object(B.a)(t);return W({Header:Object(z.b)(),Body:{}},r)}(a);"Success"===(null===(t=null==e?void 0:e.Body)||void 0===t?void 0:t.ResponseClass)?J(a,e.Body.RetentionPolicyTags):y.d("Initialize shared folders policy tags server call failed with error "+(null===(r=null==e?void 0:e.Body)||void 0===r?void 0:r.MessageText))}catch(e){y.d("Initialize shared folders policy tags server call failed with error "+e)}});var q=r(20);const G=Object(q.e)(_.B,"initializeSharedFolderRootsOrchestratorClone",async e=>{const t=await V(),r=null==t?void 0:t.OtherMailboxEntries;r?r.length>0&&(r.forEach(e=>{v(e.DisplayName,e.PrincipalSMTPAddress,!0)}),function(e){Object(f.p)("Triage_SharedFolders_LoadList",[Object(D.c)({value:e})])}(r.length)):y.d("initializeSharedFolderRoots failed with getOtherMailboxConfiguration response as : "+t)});r.d(t,"SharedFolderPeoplePicker",(function(){return M})),r.d(t,"showSharedFolderPeoplePickerDialog",(function(){return g})),r.d(t,"removeSharedFolderUser",(function(){return F})),r.d(t,"initializeSharedFolderRootsOrchestrator",(function(){return G}))}}]);
//# sourceMappingURL=owa.946.js.map
self.scriptsLoaded['owa.946.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.946.js'] = (new Date()).getTime();