self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~CalendarBootstrapUtils.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[396],{1200:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(13),o=n(933),a=n(137);t.default=function(e,t,n,c){a.getGlobalContext().legacyInDispatch++,r.action(t||"(anonymous action)",o.dispatchWithMiddleware.bind(null,e,t,n,c))(),a.getGlobalContext().legacyInDispatch--}},1201:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(755),o=n(137);function a(e,t){var n={};return Object.keys(e).forEach((function(r){void 0===n[r]&&Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[r].apply(null,t)}})})),Object.freeze(n),n}t.default=function(e){return function(t){if(o.getGlobalContext().legacyTestMode)return t;var n=this,c=t.length-1,u=r.getOriginalTarget(t);u&&(c=u.length-1);var i=function(){var r=a(e,arguments),o=Array.prototype.slice.call(arguments);if(void 0===o[c]){for(var u=o.length;u<c;u++)o[u]=void 0;o[c]=r}return t.apply(n,o)};return r.setActionType(i,r.getActionType(t)),i}}},1202:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(13),o=n(931),a=0,c=null;var u=[];function i(e){var t,n=e.object;switch(e.type){case"update":t=void 0!==e.index?{verify:function(){return n[e.index]===e.newValue},objectName:e.name,propertyName:e.index,undo:function(){n[e.index]=e.oldValue}}:void 0!==n.get?{verify:function(){return n.get(e.key)===e.newValue},objectName:e.name,propertyName:e.key,undo:function(){n.set(e.key,e.oldValue)}}:{verify:function(){return n[e.key]===e.newValue},objectName:e.name,propertyName:e.key,undo:function(){n[e.key]=e.oldValue}};break;case"splice":t={verify:function(){for(var t=0;t<e.addedCount;t++)if(n[e.index+t]!==e.added[t])return!1;return!0},objectName:e.name,propertyName:e.index,undo:function(){n.splice(e.index,e.addedCount);for(var t=0;t<e.removedCount;t++)n.splice(e.index+t,0,e.removed[t])}};break;case"add":t=void 0!==n.get?{verify:function(){return n.get(e.key)===e.newValue},objectName:e.name,propertyName:e.key,undo:function(){n.delete(e.key)}}:{verify:function(){return n[e.key]===e.newValue},objectName:e.name,propertyName:e.key,undo:function(){delete n[e.key]}};break;case"delete":t={verify:function(){return!n.has(e.key)},objectName:e.name,propertyName:e.key,undo:function(){n.set(e.key,e.oldValue)}};break;default:return}u.forEach((function(e){return e.steps.push(t)}))}function d(e,t,n){0===a&&(c=r.spy(i)),a++,u.push({steps:[]});try{var d=t(),s=u[u.length-1],l=!1;s.steps.reverse();var f=o.default("undo-"+e)((function(){if(l)throw"This instance of undo-"+e+" has already been executed";n&&s.steps.forEach((function(e){if(!e.verify())throw'Property "'+e.propertyName+' on store object "'+e.objectName+" changed since action was performed."})),s.steps.forEach((function(e){return e.undo()})),l=!0}));return f.actionReturnValue=d,f}finally{u.pop(),0==--a&&(c(),c=null)}}t.default=function(e,t){return function(n){return d(e,n,!!t)}}},1203:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(137);t.initializeTestMode=function(){r.getGlobalContext().legacyTestMode=!0},t.resetTestMode=function(){r.getGlobalContext().legacyTestMode=!1}},1207:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(2);const o=Object(r.action)("initializeOwaAccountsStore"),a=Object(r.action)("owaConnectedAccountAdded",(e,t,n)=>({userIdentity:e,accountProviderType:t,source:n})),c=Object(r.action)("removeAccount",e=>({userIdentity:e})),u=Object(r.action)("owaAccountStoreInitializationFailed",(e,t,n,r)=>({userIdentity:e,isRetry:t,accountProvider:n,error:r}))},1223:function(e,t,n){"use strict";var r=n(2),o=n(13);var a,c=Object(r.createStore)("cacheLoaderStore",{calendarAccountLoadMap:new o.ObservableMap({})});!function(e){e[e.Outlook=0]="Outlook",e[e.OutlookGroup=1]="OutlookGroup",e[e.TeamsCalendars=2]="TeamsCalendars"}(a||(a={}));var u=n(72),i=n(168);function d(e,t){switch(e){case a.Outlook:case a.OutlookGroup:return(t||Object(i.d)().userIdentity)+e.toString();case a.TeamsCalendars:return e.toString();default:return Object(u.a)(e)}}var s,l=n(52),f=n(25);function b(e,t){const n=d(e,t);return c().calendarAccountLoadMap.get(n).loadState==s.Loaded}function p(e){return function(e){if(e&&e!==Object(l.b)()){const e=[a.Outlook];return Object(f.k)("cal-multiAccounts-groups")&&e.push(a.OutlookGroup),e}return[a.Outlook,a.OutlookGroup,a.TeamsCalendars]}(e).every(t=>b(t,e))}!function(e){e[e.Loading=0]="Loading",e[e.Loaded=1]="Loaded",e[e.Error=2]="Error"}(s||(s={}));const y=Object(r.mutatorAction)("addToAccounts",(e,t,n,r)=>{const o=c(),a={calendarEndpointType:n,userId:t,loadState:r};o.calendarAccountLoadMap.has(e)||o.calendarAccountLoadMap.set(e,a)}),O=Object(r.mutatorAction)("updateAccountLoadState",(e,t)=>{const n=c(),r=n.calendarAccountLoadMap.get(e);r.loadState=t,n.calendarAccountLoadMap.set(e,r)});var v=n(958),I=n(22);const m=Object(r.action)("calendarCacheInitializedForAccount",(e,t,n)=>({calendarEndpointType:e,userId:t,source:n}));var h=n(1497),C=n(1513),A=n(1512);var j=n(603);const g=Object(j.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(j.a)(1e3)});var E=n(284),w=n(1502);const S={};function T(e,t){const n=t?t.userIdentity:Object(i.d)().userIdentity,r=Object(E.r)(n),o=d(e,n);if(y(o,n,e,s.Loading),b(e,n))return Promise.resolve();const c=S[o];if(c)return c.requestPromise;const l=g(()=>(async function(e,t){switch(e){case a.Outlook:await Object(h.f)(t);break;case a.OutlookGroup:await Object(C.b)(t);break;case a.TeamsCalendars:Object(f.k)("cal-showAddTeamsCalendars")&&await A.c.importAndExecute();break;default:Object(u.a)(e)}})(e,n)).retriableFunc();return S[o]={requestPromise:l},l.then(()=>{O(o,s.Loaded),m(e,n,null==t?void 0:t.source),r&&p(n)&&Object(w.a)(!0,n)}).catch(e=>{O(o,s.Error),I.d("initializeCalendarsCacheForAccount: failed to initialize calendar cache",e)})}async function _(){const e=T(a.Outlook),t=Object(E.n)().map(e=>{if(Object(l.h)(e.userIdentity)){const t={userIdentity:e.userIdentity,source:v.a.Init};T(a.Outlook,t)}});let n=[e,T(a.OutlookGroup),...t,T(a.TeamsCalendars)];if(Object(f.k)("cal-multiAccounts-groups")){const e=Object(E.n)().map(e=>{if(Object(l.h)(e.userIdentity)){const t={userIdentity:e.userIdentity,source:v.a.Init};T(a.OutlookGroup,t)}});n=n.concat(e)}await Promise.all(n)}function G(e,t){const{calendarAccountLoadMap:n}=c(),r=d(t,e);return n.get(r).loadState}Object(r.orchestrator)(v.f,e=>{const{userIdentity:t,source:n}=e,r={userIdentity:t,source:n};T(a.Outlook,r),Object(f.k)("cal-multiAccounts-groups")&&T(a.OutlookGroup,r)}),n.d(t,"g",(function(){return b})),n.d(t,"b",(function(){return p})),n.d(t,"f",(function(){return T})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return m})),n.d(t,"e",(function(){return _})),n.d(t,"d",(function(){return G}))},1457:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Add=0]="Add",e[e.Init=1]="Init"}(r||(r={}))},1495:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(35),o=n(1499);function a(e,t){return void 0===e||e.__type||(e=Object(o.a)(e)),Object(r.a)("GetUserUnifiedGroups",e,t)}},1496:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"GetUserUnifiedGroupsRequest:#Exchange"},e)}n.d(t,"a",(function(){return r}))},1499:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"GetUserUnifiedGroupsJsonRequest:#Exchange"},e)}n.d(t,"a",(function(){return r}))},1502:function(e,t,n){"use strict";var r=n(2),o=Object(r.createStore)("calendarAccountInitializationStateStore",{isAllCalendarAccountsAndCacheLoaded:!1});const a=Object(r.action)("allCalendarAccountsAndCacheLoaded",(e,t)=>({isSuccess:e,userIdentity:t})),c=Object(r.action)("removedConnectedAccountIdCleanup");function u(){return o().isAllCalendarAccountsAndCacheLoaded}Object(r.mutator)(a,e=>{e.isSuccess&&(o().isAllCalendarAccountsAndCacheLoaded=!0)}),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return u}))},1512:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u}));var r=n(20);const o=new r.c(()=>Promise.all([n.e(1),n.e(2),n.e(3),n.e(18),n.e(30),n.e(704)]).then(n.bind(null,2654))),a=new r.a(o,e=>e.initializeSelectedTeamsCalendars),c=new r.a(o,e=>e.getSelectedTeamsCalendars),u=new r.a(o,e=>e.createCalendarCacheInfoFromTeamsChannel)},1513:function(e,t,n){"use strict";var r=n(68),o=n(79);const a="Groups";var c=n(358),u=n(168),i=n(167),d=n(391),s=n(1495),l=n(1496),f=n(1514),b=n(6);var p=Object(c.action)("getGroupCalendarsService")((async function(e){const t=await async function(e){let t=[];t.push({FilterType:1,SortType:4,SortDirection:"Descending"}),t.push({FilterType:2,SortType:4,SortDirection:"Descending"});const n=Object(i.b)();n.RequestServerVersion="V2018_01_08";const r=Object(d.a)(Object(u.d)(e));return await Object(s.a)({Header:n,Body:Object(l.a)({RequestedGroupsSets:t})},r)}(e);return null!=t&&t.Body.GroupsSets&&t.Body.GroupsSets.length>0?function(e,t){const n=[],r=Object(o.p)(t,a);if(e.forEach(e=>{e.Groups.forEach(e=>{var o;let a=e.SmtpAddress.toLowerCase(),c={calendarId:{id:a,mailboxInfo:{type:"GroupMailbox",userIdentity:t,mailboxSmtpAddress:a}},CalendarColor:-1,CalendarName:e.DisplayName,OwnerEmailAddress:a,OwnerName:e.DisplayName,IsGroupMailboxCalendar:!0,IsGeneralScheduleCalendar:!0,ParentGroupId:r,CanShare:!1,DistinguishedFolderId:a,__typename:"LinkedCalendarEntry"};n.push({entry:c,groupMailboxGuid:null===(o=e.MailboxGuid)||void 0===o?void 0:o.toLowerCase()})})}),n.length>0){const e={calendarGroupId:{id:r,mailboxInfo:{type:"GroupMailbox",userIdentity:t,mailboxSmtpAddress:t}},serverGroupId:r,GroupName:Object(b.b)(f.a),GroupType:3};return{groupCalendars:n,calendarGroup:e}}return null}(t.Body.GroupsSets,e):null}));var y=n(217);var O=n(220);async function v(e){const t=await p(e),n=Object(O.a)(e)?function(e){var t;let n=Object(o.i)().filter(e=>Object(y.g)(e));if(0==n.length)return e;const r=[];for(let o=0;o<(null===(t=null==e?void 0:e.groupCalendars)||void 0===t?void 0:t.length);o++){const t=e.groupCalendars[o];n.some(e=>{var n,r;const o=e;return(null===(n=o.OwnerEmailAddress)||void 0===n?void 0:n.toLowerCase())===t.entry.calendarId.mailboxInfo.mailboxSmtpAddress&&(null===(r=o.SharedOwnerMailboxGuid)||void 0===r?void 0:r.toLowerCase())===t.groupMailboxGuid})||r.push(t)}return(null==r?void 0:r.length)>0?{groupCalendars:r,calendarGroup:e.calendarGroup}:null}(t):t;return null!=n&&null!=n.groupCalendars?(n.groupCalendars.forEach(e=>{Object(o.b)(e.entry)}),Object(o.a)(n.calendarGroup),{group:n.calendarGroup}):null}var I=n(52);const m=Object(c.action)("initializeGroupCalendars")((async function(e,t){var n;const c=new r.b("initializeGroupCalendars");e||(e=Object(u.d)().userIdentity);const i=!!(null===(n=Object(I.h)(e))||void 0===n?void 0:n.GroupsEnabled),d=Object(o.p)(e,a),s=!Object(o.r)().some(t=>t.serverGroupId===d&&t.calendarGroupId.mailboxInfo.userIdentity===e),l=i&&(t||s);c.addCustomData({issueServiceCall:l,GroupsEnabled:i,featureEnabled:!0,refresh:t,initialLoad:s});try{l&&await v(e),c.end()}catch(e){throw c.endWithError("ServerError",Error(e)),e}}));n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return a}))},1514:function(e){e.exports=JSON.parse('{"a":"pJa"}')},1536:function(e,t,n){"use strict";let r;function o(e){return r=null==e?void 0:e.getCalendarFolders,e}function a(){let e=r;return r=void 0,e}n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}))},217:function(e,t,n){"use strict";const r="LinkedCalendarEntry",o="LocalCacheForRemoteCalendarEntry";function a(e){return(null==e?void 0:e.__typename)==r}function c(e){return(null==e?void 0:e.__typename)==o}function u(e){return(null==e?void 0:e.__typename)==r&&!(null==e?void 0:e.IsGroupMailboxCalendar)}function i(e){var t;return(null===(t=e)||void 0===t?void 0:t.CanViewPrivateItems)||a(e)}const d="_CHANNELTEAMSTYPE_";function s(e){return e.split(d)[0]}function l(e,t){return[e,t].join(d)}function f(e){if(e.FolderId)return e.FolderId;let t=e;return t.IsGeneralScheduleCalendar?{Id:t.OwnerEmailAddress,ChangeKey:""}:t.SharedFolderId?{Id:t.SharedFolderId.Id,ChangeKey:null!=t.SharedFolderId.ChangeKey?t.SharedFolderId.ChangeKey:""}:null}n.d(t,"f",(function(){return a})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return"LocalCalendarEntry"})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"i",(function(){return l})),n.d(t,"e",(function(){return f}))},2870:function(e,t,n){"use strict";var r=n(217);function o(e,t){return!e.some(e=>{var n,o;return e&&t&&(null===(n=Object(r.e)(e))||void 0===n?void 0:n.Id)===(null===(o=Object(r.e)(t))||void 0===o?void 0:o.Id)})}function a(e,t){return e.indexOf(t)<0}function c(e,t=a){if(!e)return[];const n=[];return e&&e.forEach(e=>{t(n,e)&&n.push(e)}),n}var u=n(13);function i(e,t=a){if(!e)return e;const n=new u.ObservableMap;return e.forEach((e,r)=>{n.set(r,c(e,t))}),n}function d(e,t=a){if(!e)return[];const n=[];return e.forEach(e=>{e&&e.forEach(e=>{t(n,e)&&n.push(e)})}),n}n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return d}))},3018:function(e,t,n){"use strict";var r;!function(e){e.EwsId="ews",e.EwsImmutableId="ewsimmutable"}(r||(r={}));var o=n(25),a=n(2),c=Object(a.createStore)("immutableId",{IsImmutableIdFeatureOnForConnectedAccount:!1});var u=n(284);function i(e){return Object(u.r)(e)?c().IsImmutableIdFeatureOnForConnectedAccount?r.EwsImmutableId:r.EwsId:Object(o.k)("fwk-immutable-ids")?r.EwsImmutableId:r.EwsId}function d(e){return!!e&&e.length<90}function s(e){const t=[],n=[],r=[];return null==e||e.forEach((e,o)=>{"string"==typeof e&&(e.indexOf("@")>-1?r.push({id:e,idx:o}):d(e)?t.push({id:e,idx:o}):n.push({id:e,idx:o}))}),[t,n,r]}function l(e,t){const[n,o]=s(e),a=i(t);return a===r.EwsImmutableId&&o.length>0||a===r.EwsId&&n.length>0}const f=Object(a.mutatorAction)("setIsImmutableIdFeatureOnForConnectedAccount",e=>{c().IsImmutableIdFeatureOnForConnectedAccount=e});n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return d})),n.d(t,"f",(function(){return f})),n.d(t,"a",(function(){return r}))},3115:function(e,t,n){"use strict";var r,o=n(4);!function(e){e.SelectedCalendars="SelectedCalendars",e.MyDay="MyDay",e.SavedCalendarViews="SavedCalendarViews",e.BoardCalendarAsset="BoardCalendarAsset",e.Spotlight="Spotlight",e.CalendarWidget="CalendarWidget",e.Addins="Addins",e.ActivityFeed="ActivityFeed",e.ReadingPane="ReadingPane",e.SXSAttachments="SXSAttachments",e.BoardMailItem="BoardMailItem"}(r||(r={})),n.d(t,"b",(function(){return u})),n.d(t,"e",(function(){return i})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return r}));const a=new o.d(()=>n.e(1068).then(n.bind(null,19909))),c=(e,t)=>{const n=new o.a(e,t);return(...e)=>n.importAndExecute(...e)},u=c(a,e=>e.convertIdsToTargetFormat),i=c(a,e=>e.translateRestImmutableIdsToEwsIds),d=c(a,e=>e.translateEwsIdsToEwsImmutableIds),s=c(a,e=>e.translateEwsIdsToRestImmutableIds);c(a,e=>e.translateEwsImmutableIdsToEwsIds)},3124:function(e,t,n){"use strict";var r=n(2);const o=Object(r.action)("UPDATE_SELECTED_CALENDARS_IN_STORE",(e,t)=>({calendarIds:e,userIdentity:t})),a=Object(r.action)("ADD_SELECTED_CALENDAR_IN_STORE",(e,t)=>({calendarId:e,userIdentity:t})),c=Object(r.action)("FORMAT_INITIAL_SELECTED_CALENDARS",(e,t)=>({ids:e,userIdentity:t}));const u={selectedCalendars:new(n(13).ObservableMap)},i=Object(r.createStore)("selectedCalendarsStore",u);var d=n(2870);function s(){return Object(d.c)(i().selectedCalendars)}function l(){return Object(d.d)(s())}function f(e){const t=s().get(e);return t||[]}Object(r.mutator)(o,e=>{const{calendarIds:t,userIdentity:n}=e;i().selectedCalendars.set(n,Object(d.b)(t))}),Object(r.mutator)(a,e=>{const{calendarId:t,userIdentity:n}=e;i().selectedCalendars.set(n,Object(d.b)([...f(n),t]))});const b=Object(r.action)("UPDATE_SELECTED_CALENDARS",(e,t)=>({calendarIds:e,userIdentity:t})),p=Object(r.action)("ADD_SELECTED_CALENDAR",(e,t)=>({calendarId:e,userIdentity:t})),y=(Object(r.action)("INITIALIZE_SELECTED_CALENDARS",(e,t)=>({calendarIds:e,userIdentity:t})),Object(r.action)("SELECTED_CALENDARS_UPDATED",(e,t)=>({calendarIds:e,userIdentity:t}))),O=Object(r.action)("REFRESH_IMMUTABLE_SELECTED_CALENDARS",e=>({userIdentity:e}));var v=n(168),I=n(22),m=n(52),h=n(391);const C="OWA.ViewStateConfiguration";function A(e,t){e&&m.u.importAndExecute([{key:"SelectedCalendarsDesktop",valuetype:"StringArray",value:Object(d.b)(e)}],C,Object(h.a)(Object(v.d)(t))).catch(e=>{I.h.warn("Could not save new selected calendars list to user configuration")})}Object(r.orchestrator)(b,e=>{const{calendarIds:t,userIdentity:n}=e;o(t,n),y(t,n),A(t,n)}),Object(r.orchestrator)(p,e=>{const{calendarId:t,userIdentity:n}=e;a(t,n);const r=f(n);y(r,n),A(r,n)});var j=n(3018);Object(r.orchestrator)(m.z,e=>{const{userConfiguration:t,userIdentity:n}=e;let r=t.ViewStateConfiguration.SelectedCalendarsDesktop;const a=n||Object(v.d)().userIdentity;Object(j.c)(r,a)?c(r,a):(o(r,a),y(r,a))});var g=n(3115);function E(e){return e?function(e){let t=s().get(e);return t?t.length:0}(e):function(){let e=s(),t=0;return e.forEach((e,n)=>{e&&(t+=e.length)}),t}()}function w(e){return!!i().selectedCalendars.get(e)}Object(r.orchestrator)(c,async e=>{const{ids:t,userIdentity:n}=e,r=await Object(g.b)(t,Object(j.b)(n),n,g.a.SelectedCalendars);b(r,n),O(n)}),n.d(t,"i",(function(){return b})),n.d(t,"a",(function(){return p})),n.d(t,"h",(function(){return y})),n.d(t,"g",(function(){return O})),n.d(t,"e",(function(){return f})),n.d(t,"c",(function(){return E})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"f",(function(){return w}))},358:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(933);t.legacyApplyMiddleware=r.default;var o=n(931);t.action=o.default;var a=n(1201);t.select=a.default;var c=n(1202);t.createUndo=c.default;var u=n(755);t.getActionType=u.getActionType;var i=n(1203);t.initializeTestMode=i.initializeTestMode,t.resetTestMode=i.resetTestMode},391:function(e,t,n){"use strict";function r(e,t){return e?Object.assign({mailboxInfo:e},t):null!=t?t:void 0}n.d(t,"a",(function(){return r}))},474:function(e,t,n){"use strict";function r(e,t,n){return null==e?null:Object.assign({__typename:t},n?n(e):e)}function o(e,t,n){return(null==e?void 0:e.map(e=>r(e,t,n)))||null}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}))},603:function(e,t,n){"use strict";function r(e={}){!function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||(()=>6e4)}(e);const{maximumAttempts:t,timeBetweenRetryInMS:n}=e;return e=>{let r=0,o=!1;const a=(c,u)=>{o?u(new Error("The function retry was cancelled")):(r++,e().then(e=>c(e)).catch(e=>{t&&r>=t?u(e):setTimeout(()=>a(c,u),n(r))}))};return{retriableFunc:()=>new Promise((e,t)=>a(e,t)),cancel:()=>o=!0}}}function o(e){return t=>Math.pow(2,t)*e}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}))},6919:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=n(20);const o=new r.c(()=>n.e(1307).then(n.bind(null,11774)).then(e=>(e.initialize(),e)));let a=new r.a(o,e=>e.tryAutoSelect)},710:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"FolderId:#Exchange"},e)}n.d(t,"a",(function(){return r}))},7495:function(e,t,n){"use strict";n.r(t);var r=n(1223),o=n(2),a=n(3124),c=n(168),u=n(79),i=n(1497);Object(o.orchestrator)(r.c,async e=>{const{userId:t}=e,n=Object(a.e)(t||Object(c.d)().userIdentity);await Promise.all(n.filter(e=>Object(u.d)(e)&&Object(u.c)(e)).map(i.c))});var d=n(8088),s=n(9922);n.d(t,"initializeAccountAndCalendars",(function(){return d.a})),n.d(t,"initializeCalendarsDataForModule",(function(){return s.a}))},755:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setOriginalTarget=function(e,t){e.__SATCHELJS_ORIGINAL_TARGET=t},t.getOriginalTarget=function(e){if(void 0!==e.__SATCHELJS_ORIGINAL_TARGET)return e.__SATCHELJS_ORIGINAL_TARGET},t.setActionType=function(e,t){e.__SATCHELJS_ACTION_TYPE=t},t.getActionType=function(e){return e.__SATCHELJS_ACTION_TYPE}},8088:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(52),o=n(1223),a=n(958),c=n(25),u=n(154);async function i(){await Object(o.e)();const e=Object(r.g)();Object(c.i)("cal-multiAccounts",()=>{var t,n;Object(u.a)("multiAccounts")&&!Object(r.r)()&&!(null===(t=null==e?void 0:e.SessionSettings)||void 0===t?void 0:t.IsExplicitLogon)&&(null===(n=null==e?void 0:e.PolicySettings)||void 0===n?void 0:n.PersonalAccountCalendarsEnabled)&&a.b.importAndExecute()})}},931:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1200),o=n(755);function a(e,t,n){var a=function(){var o,a=this,c=arguments;return r.default((function(){return o=e.apply(a,c)}),t,arguments,n),o};return o.setOriginalTarget(a,e),o.setActionType(a,t),a}function c(e,t,n,r,o){if(!n||"function"!=typeof n.value)throw new Error("The @action decorator can only apply to class methods.");n.value=a(n.value,r,o)}t.default=function(e,t){return function(n,r,o){if(1==arguments.length&&"function"==typeof n)return a(n,e,t);c(n,r,o,e,t)}}},933:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(137);function o(e,t){return e.bind(null,t)}function a(e,t,n,r){return e()}t.default=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=a,c=e.length-1;c>=0;c--)n=o(e[c],n);r.getGlobalContext().legacyDispatchWithMiddleware=n},t.dispatchWithMiddleware=function(e,t,n,o){r.getGlobalContext().legacyDispatchWithMiddleware||(r.getGlobalContext().legacyDispatchWithMiddleware=a),r.getGlobalContext().legacyDispatchWithMiddleware(e,t,n,o)}},958:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return d}));var r=n(1207);n.d(t,"f",(function(){return r.c})),n.d(t,"e",(function(){return r.b}));var o=n(1457);n.d(t,"a",(function(){return o.a}));var a=n(20);const c=new a.c(()=>n.e(825).then(n.bind(null,2652))),u=new a.a(c,e=>e.initializeOwaAccountsStore),i=new a.a(c,e=>e.initializeOwaConnectedAccount),d=new a.a(c,e=>e.removeOWAConnectedAccount)},9922:function(e,t,n){"use strict";var r=n(6919),o=n(8088),a=n(20);const c=new a.c(()=>n.e(856).then(n.bind(null,20068))),u=new a.a(c,e=>e.loadWorkloadScenarioSettings);n.d(t,"a",(function(){return d}));let i=!1;async function d(){if(i)return;i=!0;const e=[Object(o.a)(),u.importAndExecute()];r.a.import(),await Promise.all(e)}}}]);
//# sourceMappingURL=owa.MailBoot~CalendarBootstrapUtils.js.map
self.scriptsLoaded['owa.MailBoot~CalendarBootstrapUtils.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~CalendarBootstrapUtils.js'] = (new Date()).getTime();