self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.667.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[667],{1084:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(58);function c(t){if(!t)throw new Error("Input parameter to folderNameToId must not be null.");return r.a.defaultFolderNameToIdMap.get(t)}},1087:function(t,e,n){"use strict";function r(t){return Object.assign({__type:"ItemResponseShape:#Exchange"},t)}n.d(e,"a",(function(){return r}))},1427:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return c})),n.d(e,"c",(function(){return o})),n.d(e,"e",(function(){return a})),n.d(e,"d",(function(){return i}));const r="FileAttachment:#Exchange",c="ItemAttachment:#Exchange",o="ItemIdAttachment:#Exchange",a="ReferenceAttachment:#Exchange",i="LinkAttachment:#Exchange"},1462:function(t,e,n){"use strict";function r(t){return Object.assign({__type:"FindItemJsonRequest:#Exchange"},t)}n.d(e,"a",(function(){return r}))},1490:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(35),c=n(1462);function o(t,e){return void 0===t||t.__type||(t=Object(c.a)(t)),Object(r.a)("FindItem",t,e)}},1498:function(t,e,n){"use strict";function r(t){return Object.assign({__type:"FindItemRequest:#Exchange"},t)}n.d(e,"a",(function(){return r}))},244:function(t,e,n){"use strict";e.decode=e.parse=n(492),e.encode=e.stringify=n(493)},2761:function(t,e,n){"use strict";function r(t,e){Object.keys(e).forEach(n=>t.set(n,e[n]))}function c(t){let e=null!=t?t:{headers:new Headers};return e.datapoint=e.datapoint||{},e.datapoint.mailbox="Default",e}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return c}))},2762:function(t,e,n){"use strict";var r=n(2820),c=n(284),o=n(753),a=n(68),i=n(5),u=n(22);const s="X-AnchorMailbox",d="Authorization",l="X-OwaWebSessionType",f="X-OWA-ExplicitLogonUser";async function b(t,e){const n={},b=Object(c.k)(t);if(b){if(b.accountState==c.b.AccessRevoked)return null;if(b.accountState==c.b.AccountDeprovisioned||b.accountState==c.b.AccountNotFound)return Object(c.d)(b.accountState,b.accountProviderType),null}if(e?(n[s]=e,n[f]=e):b&&(n[s]=b.anchorMailbox),b){let e,c=b.token,s=Object(o.g)(b.tokenExpiry);!s&&c||(Object(a.p)("getAndUpdateAccessToken",{tokenExpiry:Object(i.y)(b.tokenExpiry,Object(i.Tb)()),isTokenExpired_1:s,isTokenInvalid_2:!c},{isCore:!0}),c=await r.a.importAndExecute(b.accountId,t,c),u.h.info("[AccountLoadRecovery] getConnectedAccountHeaders: finished GetAndUpdateAccessToken for "+t+c),c||(c="")),"Outlook"==b.accountProviderType?(e=`MSAuth1.0 usertoken="${c}", type="MSACT"`,n[l]=1..toString()):"Google"!=b.accountProviderType&&"ICloud"!=b.accountProviderType&&"Yahoo"!=b.accountProviderType||(e=`Bearer ${c}`,n[l]=2..toString()),n[d]=e}return n}var h=n(2761);async function m(t,e){const n=Object(h.a)();return n.headers=await async function(t,e){var n;const r=e&&(null===(n=t.headers)||void 0===n?void 0:n.set)?new Headers(t.headers):new Headers,c=await b(t.mailboxInfo.userIdentity,p(t.mailboxInfo.type,t.mailboxInfo.mailboxSmtpAddress)?t.mailboxInfo.mailboxSmtpAddress:null);return Object(h.b)(r,c),r}(t,e),n.authNeededOnUnAuthorized=!1,n.datapoint=n.datapoint||{},n.datapoint.mailbox="Connected",n}function p(t,e){const n="GroupMailbox"==t||"TeamsMailbox"==t||"SharedMailbox"==t||"PublicMailbox"==t;return n&&null==e&&u.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(e,"a",(function(){return b})),n.d(e,"b",(function(){return m})),n.d(e,"c",(function(){return p}))},2763:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(2);const c=Object(r.action)("triggerReInitializeAccount",t=>({userIdentity:t}))},2820:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(20),c=n(2763);n.d(e,"b",(function(){return c.a}));const o=new r.c(()=>n.e(1069).then(n.bind(null,3034))),a=new r.a(o,t=>t.getAndUpdateAccessToken)},284:function(t,e,n){"use strict";var r,c=n(2);!function(t){t[t.Valid=0]="Valid",t[t.AccountDeprovisioned=1]="AccountDeprovisioned",t[t.AccessRevoked=2]="AccessRevoked",t[t.TransientTokenError=3]="TransientTokenError",t[t.FailedToInitializeOWAConfig=4]="FailedToInitializeOWAConfig",t[t.AccountNotFound=5]="AccountNotFound",t[t.UnknownTokenError=6]="UnknownTokenError"}(r||(r={}));var o=n(66);const a=Object(c.action)("addAccount",t=>({userIdentity:t.userIdentity,account:t})),i=Object(c.action)("removeAccount",t=>({userIdentity:t})),u=Object(c.action)("updateAccount",(t,e,n)=>({userIdentity:t,accountToken:e,accountTokenExpiresIn:n})),s=Object(c.action)("updateOWAConnectedAccountStatus",(t,e)=>({userIdentity:t,accountState:e})),d=Object(c.action)("connectedAccountIsInErrorState",(t,e)=>Object(o.b)({name:"connectedAccountIsInErrorState",customData:{accountState_1:r[t],accountProvider_2:e}},{accountState:t})),l=Object(c.action)("connectedAccountsListRequested",t=>({isSuccess:t})),f=Object(c.action)("setAccountsStoreState",t=>({state:t}));var b,h=n(13);!function(t){t[t.None=0]="None",t[t.Loading=1]="Loading",t[t.AccountsLoadSuccessful=2]="AccountsLoadSuccessful",t[t.AccountsLoadError=3]="AccountsLoadError"}(b||(b={}));var m=Object(c.createStore)("OWAAccountsStore",{accountsMap:new h.ObservableMap({}),accountsLoadedState:b.None}),p=n(72),O=n(52);function g(t){if(t==Object(O.b)())return!1;return void 0!==v(t)}function j(){return[...m().accountsMap.values()]}function v(t){return m().accountsMap.get(t)}function I(){var t;return(null===(t=j())||void 0===t?void 0:t.length)>0?j()[0]:null}function y(){return j().filter(t=>t.accountState!=r.Valid)}function A(t){return j().filter(e=>t.includes(e.accountState))}function T(t){return j().filter(e=>e.accountProviderType==t)}function w(t){return g(t)?v(t).accountProviderType:null}function x(t){return"Outlook"==t.accountProviderType?`MSAuth1.0 usertoken="${t.token}", type="MSACT"`:"Google"==t.accountProviderType||"ICloud"==t.accountProviderType||"Yahoo"==t.accountProviderType?`Bearer ${t.token}`:Object(p.a)(t.accountProviderType)}function k(t,e){return function(n){const r=v(n);return r?r[t]:e}}k("accountUniqueId","0");const S=k("accountState",r.Valid),P=()=>j().some(t=>!C(t.userIdentity)),E=k("accountProviderType",null),L=t=>"Outlook"==E(t),C=t=>S(t)==r.Valid,D=()=>j().length>0;function U(){return m().accountsLoadedState}var R=n(5),N=n(68);Object(c.mutator)(a,({account:t})=>{Object(N.p)("owaAccountAdded",{accountStatus_1:r[t.accountState]}),m().accountsMap.set(t.userIdentity,t)}),Object(c.mutator)(i,({userIdentity:t})=>{m().accountsMap.delete(t)}),Object(c.mutator)(u,({userIdentity:t,accountToken:e,accountTokenExpiresIn:n})=>{const r=m().accountsMap.get(t);r.token=e,r.tokenExpiry=Object(R.j)(Object(R.Tb)(),n)}),Object(c.mutator)(s,({userIdentity:t,accountState:e})=>{const n=m().accountsMap.get(t);n.accountState==r.Valid&&e!=r.Valid&&Object(N.p)("owaConnectedAccountStatusUpdated",{accountStatus_1:r[e]}),n.accountState=e}),Object(c.mutator)(l,t=>{const e=t.isSuccess?b.AccountsLoadSuccessful:b.AccountsLoadError;m().accountsLoadedState=e}),Object(c.mutator)(f,t=>{m().accountsLoadedState=t.state}),n.d(e,"c",(function(){return a})),n.d(e,"u",(function(){return i})),n.d(e,"x",(function(){return u})),n.d(e,"w",(function(){return s})),n.d(e,"d",(function(){return d})),n.d(e,"e",(function(){return l})),n.d(e,"v",(function(){return f})),n.d(e,"n",(function(){return j})),n.d(e,"k",(function(){return v})),n.d(e,"i",(function(){return I})),n.d(e,"f",(function(){return y})),n.d(e,"g",(function(){return A})),n.d(e,"o",(function(){return T})),n.d(e,"j",(function(){return w})),n.d(e,"m",(function(){return x})),n.d(e,"l",(function(){return S})),n.d(e,"q",(function(){return P})),n.d(e,"t",(function(){return L})),n.d(e,"s",(function(){return C})),n.d(e,"p",(function(){return D})),n.d(e,"h",(function(){return U})),n.d(e,"r",(function(){return g})),n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return b}))},2855:function(t,e,n){"use strict";function r(t){return Object.assign({__type:"IndexedPageView:#Exchange"},t)}n.d(e,"a",(function(){return r}))},2907:function(t,e,n){"use strict";var r;function c(){return[r.noPermissionToShare,r.getSharingInfoFailed,r.linkHasExpired,r.linkWillExpire,r.noPermissionToShareExternally,r.externalRecipientCSL,r.noPermissionSet,r.sharingWithLargeDL]}n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return c})),function(t){t.noPermissionToShare="WarningNoPermissionToShare",t.getSharingInfoFailed="WarningGetSharingInfoFailed",t.linkHasExpired="WarningLinksHasExpired",t.linkWillExpire="WarningLinksWillExpire",t.noPermissionToShareExternally="WarningExternalRecipientButNoPermissionToShareExternally",t.externalRecipientCSL="WarningExternalRecipientsCannotOpenCSLs",t.noPermissionSet="WarningOnlyPeopleWithExistingAccessCanAccess",t.sharingWithLargeDL="WarningNotAllMembersOfDLCanAccess"}(r||(r={}))},2951:function(t,e){t.exports=function(t){return t instanceof Date}},3030:function(t,e,n){var r=n(2951),c=36e5,o=6e4,a=2,i=/[T ]/,u=/:/,s=/^(\d{2})$/,d=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],l=/^(\d{4})/,f=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],b=/^-(\d{2})$/,h=/^-?(\d{3})$/,m=/^-?(\d{2})-?(\d{2})$/,p=/^-?W(\d{2})$/,O=/^-?W(\d{2})-?(\d{1})$/,g=/^(\d{2}([.,]\d*)?)$/,j=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,v=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,I=/([Z+-].*)$/,y=/^(Z)$/,A=/^([+-])(\d{2})$/,T=/^([+-])(\d{2}):?(\d{2})$/;function w(t,e,n){e=e||0,n=n||0;var r=new Date(0);r.setUTCFullYear(t,0,4);var c=7*e+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+c),r}t.exports=function(t,e){if(r(t))return new Date(t.getTime());if("string"!=typeof t)return new Date(t);var n=(e||{}).additionalDigits;n=null==n?a:Number(n);var x=function(t){var e,n={},r=t.split(i);u.test(r[0])?(n.date=null,e=r[0]):(n.date=r[0],e=r[1]);if(e){var c=I.exec(e);c?(n.time=e.replace(c[1],""),n.timezone=c[1]):n.time=e}return n}(t),k=function(t,e){var n,r=d[e],c=f[e];if(n=l.exec(t)||c.exec(t)){var o=n[1];return{year:parseInt(o,10),restDateString:t.slice(o.length)}}if(n=s.exec(t)||r.exec(t)){var a=n[1];return{year:100*parseInt(a,10),restDateString:t.slice(a.length)}}return{year:null}}(x.date,n),S=k.year,P=function(t,e){if(null===e)return null;var n,r,c,o;if(0===t.length)return(r=new Date(0)).setUTCFullYear(e),r;if(n=b.exec(t))return r=new Date(0),c=parseInt(n[1],10)-1,r.setUTCFullYear(e,c),r;if(n=h.exec(t)){r=new Date(0);var a=parseInt(n[1],10);return r.setUTCFullYear(e,0,a),r}if(n=m.exec(t)){r=new Date(0),c=parseInt(n[1],10)-1;var i=parseInt(n[2],10);return r.setUTCFullYear(e,c,i),r}if(n=p.exec(t))return o=parseInt(n[1],10)-1,w(e,o);if(n=O.exec(t)){o=parseInt(n[1],10)-1;var u=parseInt(n[2],10)-1;return w(e,o,u)}return null}(k.restDateString,S);if(P){var E,L=P.getTime(),C=0;return x.time&&(C=function(t){var e,n,r;if(e=g.exec(t))return(n=parseFloat(e[1].replace(",",".")))%24*c;if(e=j.exec(t))return n=parseInt(e[1],10),r=parseFloat(e[2].replace(",",".")),n%24*c+r*o;if(e=v.exec(t)){n=parseInt(e[1],10),r=parseInt(e[2],10);var a=parseFloat(e[3].replace(",","."));return n%24*c+r*o+1e3*a}return null}(x.time)),x.timezone?E=function(t){var e,n;if(e=y.exec(t))return 0;if(e=A.exec(t))return n=60*parseInt(e[2],10),"+"===e[1]?-n:n;if(e=T.exec(t))return n=60*parseInt(e[2],10)+parseInt(e[3],10),"+"===e[1]?-n:n;return 0}(x.timezone):(E=new Date(L+C).getTimezoneOffset(),E=new Date(L+C+E*o).getTimezoneOffset()),new Date(L+C+E*o)}return new Date(t)}},3045:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.InProgress=0]="InProgress",t[t.Failed=1]="Failed",t[t.Succeeded=2]="Succeeded"}(r||(r={}))},3061:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(2);const c=Object(r.action)("REFRESH_EXPIRATION_DATE",t=>({id:t}))},3062:function(t,e,n){"use strict";var r;n.d(e,"a",(function(){return r})),function(t){t[t.ignore=0]="ignore",t[t.refreshExpiration=1]="refreshExpiration",t[t.changePermission=2]="changePermission",t[t.attachAsACopy=3]="attachAsACopy"}(r||(r={}))},3114:function(t,e,n){"use strict";var r=n(1427),c=n(6);const o=t=>t&&["IPM.Note","IPM.Schedule.Meeting","IPM.GroupMailbox.JoinRequest","IPM.Post"].includes(t);function a(t){const e=t.__type||t.OwsTypeName;switch(e){case r.a:return 0;case r.e:return t.IsLink?3:1;case r.d:return 3;case r.b:return 2;case r.c:const n=t,a=t.EmbeddedItemClass;return a&&o(a)||Object(c.j)(n.AttachmentIdToAttach)?2:0;default:throw new Error(`Invalid type of attachment ${e}`)}}n.d(e,"a",(function(){return a}))},3164:function(t,e,n){"use strict";n.d(e,"h",(function(){return s})),n.d(e,"i",(function(){return d})),n.d(e,"f",(function(){return l})),n.d(e,"k",(function(){return f})),n.d(e,"n",(function(){return b})),n.d(e,"e",(function(){return h})),n.d(e,"l",(function(){return m})),n.d(e,"g",(function(){return p})),n.d(e,"j",(function(){return O})),n.d(e,"m",(function(){return g}));var r=n(20),c=n(3061);n.d(e,"o",(function(){return c.a}));var o=n(3045);n.d(e,"a",(function(){return o.a}));var a=n(2907);n.d(e,"d",(function(){return a.b})),n.d(e,"c",(function(){return a.a}));var i=n(3062);n.d(e,"b",(function(){return i.a}));const u=new r.c(()=>Promise.all([n.e(0),n.e(29),n.e(87),n.e(795)]).then(n.bind(null,4080))),s=new r.b(u,t=>t.getSharingInformation),d=new r.b(u,t=>t.getSharingIssuesForSharingData),l=new r.b(u,t=>t.getInfoBarCreator),f=new r.b(u,t=>t.hasLargeDLRecipient),b=new r.b(u,t=>t.hasRecipientExpansionFailure),h=new r.b(u,t=>t.getGroupsAndSmallDLs),m=new r.b(u,t=>t.isDLOrGroup),p=new r.b(u,t=>t.getInvididualRecipients),O=new r.b(u,t=>t.hasGetRecipientPermissionFailed),g=new r.b(u,t=>t.logSharingTipChangesForLinkRemoval)},3384:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"d",(function(){return c})),n.d(e,"a",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"e",(function(){return i}));const r="originalsrc",c="shash",o="data-auth",a="&reserved=0",i="Verified"},3578:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(1427);function c(t){return(t.__type||t.OwsTypeName)===r.d}},391:function(t,e,n){"use strict";function r(t,e){return t?Object.assign({mailboxInfo:t},e):null!=e?e:void 0}n.d(e,"a",(function(){return r}))},403:function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},4212:function(t,e,n){"use strict";n.d(e,"f",(function(){return a})),n.d(e,"g",(function(){return i})),n.d(e,"h",(function(){return u}));var r=n(20),c=n(3384);n.d(e,"b",(function(){return c.b})),n.d(e,"d",(function(){return c.d})),n.d(e,"a",(function(){return c.a})),n.d(e,"c",(function(){return c.c})),n.d(e,"e",(function(){return c.e}));const o=new r.c(()=>n.e(1373).then(n.bind(null,7962))),a=new r.b(o,t=>t.evaluateSafeLink),i=(new r.b(o,t=>t.evaluateSafeLinks),new r.b(o,t=>t.isSafeLink)),u=new r.b(o,t=>t.isSafeLinkUrl)},4430:function(t,e,n){"use strict";var r=n(25),c=n(6),o=n(5281),a=n(7455),i=n(3921),u=n(5669),s=n(5224),d=n(5045),l=n(5225),f=n(3245),b=n(4632),h=n(3254),m=n(22),p=n(358),O=n(2961);var g=n(3114),j=n(2852);e.a=Object(p.action)("addAndInitializeAttachments")((function(t,e,n=!1,v=!1){const I=Object(O.a)();n||(t=t.filter(t=>!I.attachments.has(t.attachment.AttachmentId.Id))),t.map(t=>{const{attachmentId:n,attachment:I,permissionInfo:y,modelInitializationValues:A}=t,T=function(t,e){const n={id:t,type:Object(g.a)(e),download:{url:null},attachmentClass:0,previewImage:{url:null},thumbnailImage:{url:null},info:{allowDownload:!1,supportedPermissionLevels:[],sharingInfo:null},model:e};if(1===n.type&&Object(j.a)(e)){return Object.assign(Object.assign({},n),{type:1,openUrl:null,originalUrl:null,isFolder:e.AttachmentIsFolder,requiresFetchingSharingInformation:!1})}return n}(n,I);return v||function(t,e,n){const g=Object(f.a)(t),j=Object(h.b)(t.model,!0),v=Object(a.a)(j,t.model);t.attachmentClass=v,t.info=Object(o.a)(j,v,t.model,g,g?t.model.ProviderType:null,e),t.info.allowDownload&&(t.download.url=Object(d.a)(t.id,t.model,!0,!0)),g&&(t.openUrl=Object(l.a)(t.model)),(g&&Object(r.k)("doc-unwrap-safelinks")?Object(s.a)(t.model):Promise.resolve(void 0)).then(e=>{if(e&&(t.originalUrl=e),g&&!n){const e=t.model,n=Object(i.a)(e.ProviderType);(null==n?void 0:n.requiresFetchingSharingInformation)&&!Object(c.j)(e.AttachLongPathName)&&(t.requiresFetchingSharingInformation=!0)}if(Object(b.a)(t.model)){const e=t.id.Id;Object(u.a)(t.id,t.model,g).then(Object(p.action)("updateAttachmentThumbnailUrl")((function(t){Object(O.a)().attachments.has(e)&&(Object(O.a)().attachments.get(e).thumbnailImage.url=t)})),t=>{m.h.warn(t)})}})}(T,y,e),function(t,e){e=e||{},Object.keys(e).forEach(n=>{e[n]&&(t[n]=e[n])})}(T,A||{}),T}).forEach(t=>{var e;const n=t.model;if(n&&!n.AttachmentOriginalUrl){const r=I.attachments.get(t.id.Id);(null===(e=null==r?void 0:r.model)||void 0===e?void 0:e.AttachmentOriginalUrl)&&(n.AttachmentOriginalUrl=r.model.AttachmentOriginalUrl)}if(n&&Object(f.b)(n)){const e=n;if(!e.AttachLongPathName){const n=I.attachments.get(t.id.Id),r=null==n?void 0:n.model;(null==r?void 0:r.AttachLongPathName)&&(e.AttachLongPathName=r.AttachLongPathName)}}I.attachments.set(t.id.Id,t)})}))},462:function(t,e,n){"use strict";class r{constructor(t,e,n){this.maxParallelTasks=t,this.taskCallback=e,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}add(t){this.taskList.unshift(t),this.scheduleTask()}clear(){this.taskList.splice(0,this.taskList.length)}canRunMoreTasks(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0}scheduleTask(){this.canRunMoreTasks()&&setTimeout(()=>{this.tryRunTask()},this.taskDelay)}onTaskComplete(){this.numberOfTasksRunning--,this.scheduleTask()}tryRunTask(){if(this.canRunMoreTasks()){let t=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(t).then(()=>{this.onTaskComplete()}).catch(()=>{this.onTaskComplete()}),this.scheduleTask()}}}n.d(e,"a",(function(){return r}))},4632:function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var r=n(3921),c=n(3106),o=n(3254),a=n(2767),i=n(2852),u=n(5015),s=n(6672);function d(t){if(!Object(o.b)(t,!0).directFileAccessEnabled&&!t.IsInline||Object(c.b)(t.AttachmentId.Id))return!1;if(t.Thumbnail)return!0;const e=Object(a.g)(t.Name,t.ContentType,!1),n=Object(a.h)(t.Name);if((Object(u.a)(t)||Object(s.a)(t))&&(e||n))return!0;if(Object(i.a)(t)){const n=Object(r.a)(t.ProviderType);if(t.AttachmentThumbnailUrl||e&&n&&n.supportImageThumbnail)return!0}return!1}},4804:function(t,e,n){"use strict";n.r(e);var r=n(2);var c=Object(r.action)("checkPendingAttachmentOperation",(t,e,n,r,c)=>({attachmentId:t,itemId:e,operationId:n,operationType:r,completeHandler:c}));function o(t){return Object.assign({__type:"CheckPendingAttachmentOperationRequest:#Exchange"},t)}var a=n(35);function i(t,e,n,r,c){const i=function(t,e,n,r){return o({ewsAttachmentId:t,itemId:e,operationId:n,operationType:r})}(t,e,n,r);return s=c,void 0===(u=i)||u.__type||(u=o(u)),Object(a.a)("CheckPendingAttachmentOperation",u,s);var u,s}var u=n(22),s=n(391),d=(Object(r.orchestrator)(c,async t=>{try{const e=t.itemId?t.itemId.mailboxInfo:t.attachmentId.mailboxInfo,n=await i(t.attachmentId?t.attachmentId.Id:null,t.itemId?t.itemId.Id:null,t.operationId,t.operationType,Object(s.a)(e));t.completeHandler(n)}catch(t){u.h.warn("checkPendingAttachmentOperationAction is failing with error: "+t)}}),n(2990)),l=n(2778),f=n(3164),b=n(7976);Object(r.orchestrator)(f.o,async t=>{if("object"==typeof t.id){const e=Object(l.a)(t.id);if(e){const n=e.model;await Object(b.a)([t.id],n.PermissionType),Object(d.a)(e.id)}}}),Object(r.mutator)(d.b,t=>{const{attachmentId:e,attachmentContentId:n}=t;Object(l.a)(e).model.ContentId=n}),Object(r.mutator)(d.c,t=>{const{attachmentId:e,isInline:n}=t;Object(l.a)(e).model.IsInline=n});var h=n(4430),m=n(358),p=Object(m.action)("setPreviewImageUrl")((function(t,e){Object(l.a)(t).previewImage.url=e})),O=n(5410),g=n(8005),j=n(2893),v=n(5372),I=n(3245),y=n(3403);async function A(t,e,n=!1){const r=Object(l.a)(t);if(Object(I.b)(r.model)&&r.model.ProviderType===j.e){const e=await async function(t){const e=await Object(v.a)(t);if(null==e)throw new Error("URL not available");return e+"2"}(r.model);p(t,e)}else if(!Object(I.b)(r.model)||r.model.ProviderType===j.h||r.model.ProviderType===j.i){const c=Object(y.a)(t,r.model,1,1===r.type,e,n);p(t,c)}}var T=n(4632),w=n(5281),x=Object(m.action)("setAttachmentInfo")((function(t,e){Object(l.a)(t).info=e}));n.d(e,"addAndInitializeAttachments",(function(){return h.a})),n.d(e,"setPreviewImageUrl",(function(){return p})),n.d(e,"refreshDownloadUrl",(function(){return O.a})),n.d(e,"refreshThumbnailImageUrl",(function(){return g.a})),n.d(e,"refreshPreviewImageUrl",(function(){return A})),n.d(e,"getAttachment",(function(){return l.a})),n.d(e,"checkPendingAttachmentOperation",(function(){return c})),n.d(e,"shouldShowImageView",(function(){return T.a})),n.d(e,"createAttachmentInfo",(function(){return w.a})),n.d(e,"setAttachmentInfo",(function(){return x}))},492:function(t,e,n){"use strict";function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,n,o){e=e||"&",n=n||"=";var a={};if("string"!=typeof t||0===t.length)return a;var i=/\+/g;t=t.split(e);var u=1e3;o&&"number"==typeof o.maxKeys&&(u=o.maxKeys);var s=t.length;u>0&&s>u&&(s=u);for(var d=0;d<s;++d){var l,f,b,h,m=t[d].replace(i,"%20"),p=m.indexOf(n);p>=0?(l=m.substr(0,p),f=m.substr(p+1)):(l=m,f=""),b=decodeURIComponent(l),h=decodeURIComponent(f),r(a,b)?c(a[b])?a[b].push(h):a[b]=[a[b],h]:a[b]=h}return a};var c=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},493:function(t,e,n){"use strict";var r=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,n,i){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?o(a(t),(function(a){var i=encodeURIComponent(r(a))+n;return c(t[a])?o(t[a],(function(t){return i+encodeURIComponent(r(t))})).join(e):i+encodeURIComponent(r(t[a]))})).join(e):i?encodeURIComponent(r(i))+n+encodeURIComponent(r(t)):""};var c=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function o(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var a=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}},5045:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(2893),c=n(3245),o=n(3403);function a(t,e,n,a=!1){if(Object(c.b)(e))switch(e.ProviderType){case r.b:return function(t){const e=t.AttachLongPathName,n=e.lastIndexOf("?");return`${e.substring(0,n)}?dl=1`}(e)}return Object(o.a)(t,e,0,Object(c.b)(e),n,a)}},5224:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(4212);async function c(t){let e,n;return(n=await r.f.import())&&(e=await n(t.AttachLongPathName)),e}},5225:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(6),c=n(2893),o=n(3997),a=n(30);function i(t){return Object(r.j)(t)?null:("/"!=(t=t.trim())[t.length-1]&&(t+="/"),t)}function u(t){let e=t.AttachLongPathName;if(Object(o.f)(t.PermissionType)||t.ProviderType!==c.i)return e;const n=Object(a.a)(),r=n.ApplicationSettings;if(null!==e&&null!==r){let t;t=i(r.VDirIsPublicProperty||n.PublicComputersDetectionEnabled&&n.SessionSettings.IsPublicComputerSession?r.ExternalSPMySiteHostURL:r.InternalSPMySiteHostURL),null!==t&&(e=function(t,e){const n=new RegExp("^(https?)\\:[\\/\\\\]{2}([\\w\\.-]+)(\\:[0-9]{1,4})?(.*)$","i"),r=n.exec(t),c=n.exec(e);let o,a,i;return r&&c&&r.length>=5&&c.length>=5&&(c[1]&&c[2]&&(i=c[1]+"://"+c[2],o=!0),c[3]&&(i+=c[3]),r[4]&&(a=!0,i+=r[4])),o&&a?i:null}(e,t))}return null!==e?e:t.AttachLongPathName}},5281:function(t,e,n){"use strict";var r=n(3997),c=n(2767),o=n(5),a=n(25);var i=n(5331),u=n(3921);function s(t,e,n,s,d,l=null){if(1===e)return{allowDownload:!1,supportedPermissionLevels:null,sharingInfo:null};const f=Object(c.b)(n.Name),b=Object(i.a)(t,n,f),h=function(t,e,n){if(!t)return null;if(n&&n.length>0)return n;const r=Object(u.a)(e);return null==r?void 0:r.supportedPermissionLevels}(s,d,Object(r.a)(l,0)),m=(p=l)&&0===p.ResultCode?(Object(a.k)("doc-attachment-referenceAttachmentExpiration")||(p.ExpirationDate=null),{getSharingInfoSucceeded:!0,blocksDownload:p.BlocksDownload,canonicalUrl:p.CanonicalUrl,canShareInternally:p.CanShareInternally,canShareExternally:p.CanShareExternally,expirationDate:p.ExpirationDate?Object(o.pc)(p.ExpirationDate):null,canRefresh:!1,shareId:p.ShareId,siteUrl:p.SiteUrl,linkType:p.Type,itemUniqueId:p.ItemUniqueId,mimeType:p.MimeType}):null;var p;return s?function(t,e,n){return{allowDownload:t,supportedPermissionLevels:e,sharingInfo:n}}(b,h,m):function(t){return{allowDownload:t,supportedPermissionLevels:null,sharingInfo:null}}(b)}n.d(e,"a",(function(){return s}))},5331:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n(2852),c=n(3921),o=n(3254),a=n(107),i=n(25);function u(t,e,n){let u=t.level!==o.a.Block&&t.directFileAccessEnabled;return u&&Object(r.a)(e)&&(u=function(t,e){if(t.AttachLongPathName){const e=document.createElement("a");if(e.href=t.AttachLongPathName,(!Object(i.k)("doc-unwrap-safelinks")||Object(a.i)())&&e.host.indexOf(s,0)>0||e.search.indexOf(d,0)>0)return!1}if(function(t){const e=Object(c.a)(t);return null==e?void 0:e.supportDownload}(t.ProviderType)&&!t.AttachmentIsFolder)return".fluid"!==e&&!function(t,e){return!(t||e&&"application/onenote"!==e&&"image/png"!==e)}(e,t.ContentType);return!1}(e,n)),u}const s="safelinks.protection.outlook.com",d="b7780972f918485c8cfc32b1ba7438eb"},5410:function(t,e,n){"use strict";var r=n(2778),c=n(5045),o=n(358);e.a=Object(o.action)("refreshDownloadUrl")((function(t,e,n=!1){const o=Object(r.a)(t),a=Object(c.a)(t,o.model,e,n);o.download.url=a}))},5669:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(2893),c=n(5372),o=n(3403);async function a(t,e,n){if(!n)return Object(o.a)(t,e,2,n,!0);const a=e;return a.ProviderType===r.e&&a.AttachLongPathName?Object(c.a)(a):a.AttachmentThumbnailUrl||null}},66:function(t,e,n){"use strict";var r=n(2);function c(t,e){return(e=e||{}).dp=t,e}function o(t,e,n){return Object(r.action)(t,(...r)=>{const o=e?e(...r):{},a=n?n(o,...r):{name:t};return a.name=a.name||t,a.options=a.options||{isCore:!0},c(a,o)})}function a(t){const{value:e,exactMatches:n=[0,1,2,3,4,5],buckets:r=[10,15,25,50,100]}=t;if(0===r.length)throw new Error("getAggregationBucket: buckets cannot be an empty array");if(n[0]&&e<n[0])return`<${n[0]}`;if(n.includes(e))return`${e}`;for(let t=0;t<r.length;t++)if(e<=r[t])return`${t>0?r[t-1]+1:n[n.length-1]+1||"0"}-${r[t]}`;return`${r[r.length-1]+1}+`}n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return c})),n.d(e,"c",(function(){return a}))},6772:function(t,e,n){"use strict";var r=n(2990),c=n(2778),o=n(5225),a=n(25),i=n(358);e.a=Object(i.action)("setAttachmentPermissionLevel")((function(t,e,n,i){const u=Object(c.a)(t),s=u.model;s.PermissionType=e,n&&(s.AttachLongPathName=n,u.openUrl=Object(o.a)(s)),Object(a.k)("doc-attachment-referenceAttachmentExpiration")&&u.info&&u.info.sharingInfo&&(u.info.sharingInfo.expirationDate=i),Object(r.a)(t)}))},710:function(t,e,n){"use strict";function r(t){return Object.assign({__type:"FolderId:#Exchange"},t)}n.d(e,"a",(function(){return r}))},753:function(t,e,n){"use strict";var r=n(2);const c=Object(r.action)("initializeOwaObservableDateTime"),o=Object(r.action)("observableNowChanged"),a=Object(r.action)("observableTodayChanged");var i=n(5),u=n(13),s=Object(r.createStore)("ObservableDateTime",{now:0,today:0});const d=Object(u.computed)(()=>Object(i.pc)(s().now)),l=()=>d.get(),f=Object(u.computed)(()=>Object(i.pc)(s().today)),b=()=>f.get(),h=t=>Object(i.Jb)(t,l()),m=t=>Object(i.Hb)(t,l()),p=t=>g(t,i.Jb),O=t=>g(t,i.Kb),g=(t,e)=>e(Object(i.ac)(Object(i.pc)(t)),b());function j(t){if(!t)return"";const e=Object(i.pc)(t);return function(t,e){const n=Object(i.ac)(t);if(Object(i.Lb)(n,e))return i.ab;const r=t=>Object(i.Qb)(n,Object(i.e)(e,-t),e);if(r(3))return i.ib;if(r(30))return i.hb;return i.Y}(e,b())(e)}function v(t){if(!t)return"";const e=Object(i.pc)(t);return function(t,e){const n=Object(i.ac)(t);if(Object(i.Lb)(n,e))return i.T;return i.U}(e,b())(e)}function I(t){if(!t)return"";return function(t,e){const n=Object(i.ac)(t);return Object(i.Lb)(n,e)?Object(i.ab)(t):y(n,e,2)?Object(i.lb)(t):y(n,e,7)?Object(i.H)(Object(i.bb)(t),Object(i.ab)(t)):Object(i.H)(Object(i.J)(t),Object(i.ab)(t))}(Object(i.pc)(t),b())}function y(t,e,n){return Object(i.Qb)(t,Object(i.e)(e,-n),e)}const A=Object(r.action)("updateTimes"),T=Object(r.action)("setNow"),w=Object(r.action)("setToday",t=>({today:t}));Object(r.mutator)(T,()=>{s().now=Object(i.nc)()}),Object(r.mutator)(w,({today:t})=>{s().today=t});var x=n(24),k=n(80);let S=!1;Object(r.orchestrator)(c,()=>{if(A(),!S){const t=Object(i.Tb)(),e=Object(i.cc)(Object(i.h)(t,1)),n=Object(i.w)(e,t);setTimeout(()=>setInterval(A,x.g),n),document&&document.addEventListener("visibilitychange",A),S=!0}}),Object(r.orchestrator)(k.l,()=>{A()}),Object(r.orchestrator)(A,()=>{T();const t=Object(i.Cb)(Object(i.oc)()),e=s().today!=t;e&&w(t),o(),e&&a()}),n.d(e,"d",(function(){return c})),n.d(e,"j",(function(){return o})),n.d(e,"l",(function(){return a})),n.d(e,"i",(function(){return l})),n.d(e,"k",(function(){return b})),n.d(e,"g",(function(){return h})),n.d(e,"e",(function(){return m})),n.d(e,"f",(function(){return p})),n.d(e,"h",(function(){return O})),n.d(e,"a",(function(){return j})),n.d(e,"b",(function(){return v})),n.d(e,"c",(function(){return I}))},7976:function(t,e,n){"use strict";var r=n(5),c=n(6772);function o(t){return Object.assign({__type:"SetAttachmentPermissionsRequest:#Exchange"},t)}var a=n(35);function i(t,e,n=null,r=!1){const c=function(t,e,n=null,r=!1){return o({AttachmentIds:t,PermissionLevel:e,NewAttachLongPathNames:n,SetToOriginalPermissionLevel:r})}(t,e,n,r);return void 0===(i={request:c}).request||i.request.__type||(i.request=o(i.request)),Object(a.a)("SetAttachmentPermissionsV2",i,u);var i,u}async function u(t,e,n=null,o=!1){const a=await i(t.map(t=>t.Id),e,n,o);if(!a.OperationSucceeded||!a.NewAttachLongPathNames||a.NewAttachLongPathNames.length!==t.length)throw new Error("Error setting attachment permissions");t.forEach((t,n)=>{var o;let i=null;(null===(o=a.ExpirationDates)||void 0===o?void 0:o[n])&&(i=Object(r.pc)(a.ExpirationDates[n])),Object(c.a)(t,e,a.NewAttachLongPathNames[n],i)})}n.d(e,"a",(function(){return u}))}}]);
//# sourceMappingURL=owa.667.js.map
self.scriptsLoaded['owa.667.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.667.js'] = (new Date()).getTime();