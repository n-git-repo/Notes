self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.1102.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[1102],{11014:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var o=n(2844),a=n(4029);function c(){const e=Object(a.a)();return Object(o.c)(e)}},19882:function(e,t,n){"use strict";n.r(t);var o=n(20),a=n(4353),c=n(3572),r=n(5783),i=n(2733);const s=Object(o.e)(a.a,"reloadTableOnTriageActionFailClone",e=>{const{tableView:t}=e;d(t)}),l=Object(o.e)(c.a,"reloadTableOnTriageActionFailClone",e=>{d(Object(i.I)())});function d(e){e&&Object(r.a)(e)}var u=n(3012),b=n(68),O=n(358);let j=Object(O.action)("onLoadMoreRowsSucceeded")((function(e,t,n,o){e.isLoading=!1,o(e,t,n),e.currentLoadedIndex=e.rowKeys.length})),w=Object(O.action)("onLoadMoreRowsFailed")((function(e,t){e.isLoading=!1,Object(b.p)("TnS_LoadMoreRowsError",[e.tableQuery.listViewType,t])}));var y=n(2827),f=n(3046),g=n(3451);var I=n(4119),h=n(4120),p=n(4204),m=n(1085),v=n(4121),F=n(8381);var T=n(25),R=n(3919);function V(e,t){const n=e.rowKeys.length-1,o=e.tableQuery;Object(T.k)("mon-messageList-useGqlForFindItem")?Object(f.h)(Object(i.k)(o),t,o.viewFilter,o.sortBy,Object(u.l)(o),o.focusedViewFilter,o.requestShapeName,Object(y.d)(o),void 0,Object(y.e)(o),o.categoryName,Object(i.l)(e,!0),e.rowKeys[n]).then(t=>{let n=[];t.edges&&(n=t.edges.map(e=>e.node)),j(e,n,t.totalItemRowsInView,u.b)}).catch(t=>{const n=Object(g.a)(t);w(e,n)}):function(e,t,n,o,a,c,r,i,s,l){const d=Object(p.a)({FieldURIOrConstant:Object(h.a)({Item:Object(I.a)({Value:t})}),Item:Object(m.a)({FieldURI:"InstanceKey"})}),u=Object(v.a)({Item:d}),b=Object(F.a)({BasePoint:"Beginning",Condition:u,MaxEntriesReturned:n});return Object(f.b)(e,b,o,a,c,r,i,s,Object(f.g)(o),l)}(Object(i.k)(o),e.rowKeys[n],t,o.viewFilter,Object(R.a)(o),o.focusedViewFilter,o.requestShapeName,Object(y.e)(o),o.categoryName,Object(i.l)(e,!0)).then(t=>{"Success"===t.ResponseClass?j(e,t.RootFolder.Items,t.RootFolder.TotalItemsInView,u.b):w(e,t.ResponseCode)},t=>{w(e)})}var x=n(3495);const L=50;function Q(e){switch(e.isLoading=!0,e.tableQuery.listViewType){case 0:!function(e,t){var n;const o=e.rowKeys.length-1,a=e.tableQuery,c=null===(n=Object(i.l)(e,!0))||void 0===n?void 0:n.Id;Object(f.d)(a.folderId,t,a.viewFilter,a.sortBy,Object(u.l)(a),a.focusedViewFilter,a.requestShapeName,Object(y.d)(a),e.rowKeys[o],a.categoryName,c).then(t=>{let n=[];t.edges&&(n=t.edges.map(e=>e.node)),j(e,n,t.totalConversationRowsInView,u.a)}).catch(t=>{const n=Object(g.a)(t);w(e,n)})}(e,L);break;case 1:V(e,L)}}var S=Object(O.action)("loadMoreInTable")((function(e){if(!e)throw new Error("Selected tableview must not be null if loadMoreRows is being called.");if(e.currentLoadedIndex<e.rowKeys.length){if(e.rowKeys.length-e.currentLoadedIndex>=L)return void(e.currentLoadedIndex+=L);e.currentLoadedIndex=e.rowKeys.length}if((0==e.tableQuery.type||2==e.tableQuery.type||Object(T.k)("grp-loadFolders")&&3==e.tableQuery.type)&&"spotlight"!==e.tableQuery.scenarioType)Q(e);else if(1===e.tableQuery.type){"FindItem"===e.tableQuery.searchProvider?C(e):N(e)}}));const C=async e=>{(await x.b.import())(e.currentLoadedIndex-1,e,"loadMoreInTable",j,w)},N=async e=>{const t=e.rowKeys.length-1,n=e.tableQuery;if(t>n.lastIndexFetched){n.lastIndexFetched=t,(await x.c.import())(t,e,"loadMoreInTable",j,w)}};var K=n(11014);function M(){setTimeout(()=>{const e=Object(K.a)();Object(r.a)(e)},3e3)}n.d(t,"reloadTableOnTriageActionFailOrchestrator",(function(){return s})),n.d(t,"reloadTableUponUndoWithoutNotificaitonChannel",(function(){return l})),n.d(t,"loadMoreInTable",(function(){return S})),n.d(t,"reloadInboxPostBoot",(function(){return M}))},4119:function(e,t,n){"use strict";function o(e){return Object.assign({__type:"Constant:#Exchange"},e)}n.d(t,"a",(function(){return o}))},4120:function(e,t,n){"use strict";function o(e){return Object.assign({__type:"FieldURIOrConstantType:#Exchange"},e)}n.d(t,"a",(function(){return o}))},4121:function(e,t,n){"use strict";function o(e){return Object.assign({__type:"RestrictionType:#Exchange"},e)}n.d(t,"a",(function(){return o}))},4204:function(e,t,n){"use strict";function o(e){return Object.assign({__type:"IsEqualTo:#Exchange"},e)}n.d(t,"a",(function(){return o}))},5783:function(e,t,n){"use strict";var o=n(68),a=n(3012),c=n(358);let r=Object(c.action)("onReloadTableSucceeded")((function(e,t,n){Object(a.h)(t,e,n,!0,!1,"MergeOnReload"),e.currentLoadedIndex=e.rowKeys.length})),i=Object(c.action)("onReloadTableFailed")((function(e){Object(o.p)("TnS_ReloadError",[e])}));var s=n(3451),l=n(25),d=n(3652),u=n(3046),b=n(2844),O=n(3919),j=n(462),w=n(2733),y=n(2827);const f=new j.a(1,(async function(e){const t=e.tableViewId,n=Object(w.L)().tableViews.get(t);if(!n)return Promise.resolve();const c=Math.max(n.currentLoadedIndex,b.a);switch(n.tableQuery.listViewType){case 0:await function(e,t){var n;const o=e.tableQuery,c=Object(w.l)(e,!0),l=null===(n=c)||void 0===n?void 0:n.Id;return Object(u.d)(o.folderId,t,o.viewFilter,o.sortBy,Object(a.l)(o),o.focusedViewFilter,o.requestShapeName,Object(y.d)(o),void 0,o.categoryName,l).then(t=>{let n=[];t.edges&&(n=t.edges.map(e=>e.node)),r(e,n,t.totalConversationRowsInView)}).catch(e=>{const t=Object(s.a)(e);i(t)})}(n,c);break;case 1:await function(e,t){const n=e.tableQuery;return Object(l.k)("mon-messageList-useGqlForFindItem")?Object(u.h)(Object(w.k)(n),t,n.viewFilter,n.sortBy,Object(a.l)(n),n.focusedViewFilter,n.requestShapeName,Object(y.d)(n),void 0,Object(y.e)(n),n.categoryName,Object(w.l)(e,!0)).then(t=>{let n=[];t.edges&&(n=t.edges.map(e=>e.node)),r(e,n,t.totalItemRowsInView)}).catch(e=>{const t=Object(s.a)(e);i(t)}):Object(u.c)(Object(w.k)(n),0,t,n.viewFilter,Object(O.a)(n),n.focusedViewFilter,n.requestShapeName,void 0,Object(y.e)(n),n.categoryName,Object(w.l)(e,!0)).then(t=>{"Success"==t.ResponseClass?r(e,t.RootFolder.Items,t.RootFolder.TotalItemsInView):i(t.ResponseCode)}).catch(e=>{i()})}(n,c)}0==n.tableQuery.type&&Object(d.a)(n.tableQuery.folderId);return Object(o.p)("ReloadTable",[c],{sessionSampleRate:10}),Promise.resolve()}),150);t.a=Object(c.action)("reloadMailListTableAction")((function(e){1===e.tableQuery.type||Object(w.V)(e.tableQuery.folderId)||f.add({tableViewId:e.id})}))},8381:function(e,t,n){"use strict";function o(e){return Object.assign({__type:"SeekToConditionPageView:#Exchange"},e)}n.d(t,"a",(function(){return o}))}}]);
//# sourceMappingURL=owa.1102.js.map
self.scriptsLoaded['owa.1102.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.1102.js'] = (new Date()).getTime();