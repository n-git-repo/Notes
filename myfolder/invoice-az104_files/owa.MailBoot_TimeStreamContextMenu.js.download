self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~TimeStreamContextMenu.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[429],{1149:function(e){e.exports=JSON.parse('{"a":"lAb","b":"mAb"}')},11766:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(17470),o=n(21),i=n(6),c=n(17472),u=Object(o.a)((function({item:e,dismissMenu:t}){const{onClick:n,data:{space:o}}=e,u=r.useCallback(r=>{null==n||n(r,e),t()},[n,e,t]);return r.createElement("button",{key:o.id,className:a.spaceProjectContainer,onClick:u,"aria-label":Object(i.b)(c.a,o.name),role:"menuitem",tabIndex:0},r.createElement("span",null,o.name))})),s=n(2),d=n(13),l=Object(s.createStore)("timeStreamProjects",{spaces:new d.ObservableMap});function m(){return l().spaces}var f=n(5343);const O=Object(s.mutatorAction)("reloadProjects",e=>{const t=l().spaces;t.clear(),e.map(e=>{t.set(e.id,e)})});var b=n(903);const p=Object(f.a)((async function(){let e=await Object(b.g)();if(e=e.filter(e=>"OutlookCalendar"===e.appName||!e.appName),e){const t=m();let n=!1;e.map(r=>{var a;e.length===t.size&&t.has(r.id)&&(null===(a=t.get(r.id))||void 0===a?void 0:a.name)===r.name||(n=!0)}),n&&O(e)}}),3e3);var g=n(17473),T=n(898),j=n(8363),S=n(8374),h=n(483),v=n(134),D=n(405),y=n(654),C=n(5),I=n(950),k=n(3115),w=n(72),A=n(68);const E={paddingLeft:"12px"},N={iconName:"OpenInNewWindow",styles:{root:{marginRight:7}}};function x(e,t,n,r){const a=m(),o=(a,o)=>{o&&async function e(t,n,r,a,o){var c;null==o||o();const u=Math.pow(2,16),s={x:u,y:u},d=await Object(k.d)([n],k.a.BoardMailItem)[0];let l;if(r.CalendarItemType)l=Object.assign(Object.assign({},s),{type:"calendarItem",payload:{itemId:n,item:Object(S.a)(r)},isCaptured:!0});else if(r.ConversationId)l=Object.assign(Object.assign({},s),{type:"mailItem",payload:{itemId:n,immutableId:null==d?void 0:d.TargetId,item:Object(j.a)(r)},isCaptured:!0});else if(Object(D.j)(r)){const{ParentFolderId:e,Subject:t,Status:a,DueDateTime:o}=r,i=o?Object(C.nb)(o):"",u=null!==(c=null==o?void 0:o.tz)&&void 0!==c?c:"";l=Object.assign(Object.assign({},s),{type:"task",payload:{taskId:n,taskParentId:e,taskSubject:t,isComplete:Object(y.p)(a)},dueDate:i,dueDateTz:u,taskId:n})}else Object(w.a)(r);await I.f.importAndExecute("createCaptureAssetInitial",a,Object(i.b)(g.b),{icon:"CheckMark"});let m=!0;try{await Object(b.c)(t,l)}catch(o){I.f.importAndExecute("createCaptureAsset",a,Object(i.b)(g.a),{icon:"Error",primaryActionHotKeyCommand:I.a.Retry},{primaryActionText:Object(i.b)(T.a),notificationCallback:o=>{o===I.b.PrimaryActionClicked?e(t,n,r,a):m=!1}})}m&&Object(A.p)("OUTLOOKSPACES_CREATE_ASSET",{assetType_1:l.type,source_2:"ContextMenu",x:s.x,y:s.y})}(o.data.space.id,e,t,n,r)},c=[];(null==a?void 0:a.size)>=0&&a.forEach(e=>{c.push({key:e.id,text:e.name,title:e.name,onRender:F,onClick:o,data:{space:e}})}),c.sort((e,t)=>(e.text||"").localeCompare(t.text||""));const u=Object(i.b)(g.c);return c.push({key:"spaces-contextmenu-divider",itemType:v.a.Divider},{key:"go-to-calendarBoard",text:u,title:u,style:E,onClick:P,iconProps:N}),{items:c,onMenuOpened:p}}function P(){window.open(Object(h.e)()+"view/board"+Object(h.s)(),"_blank")}function F(e,t){return r.createElement(u,{item:e,dismissMenu:t})}n.d(t,"getSpacesContextMenuItems",(function(){return x}))},1448:function(e,t,n){"use strict";var r=n(165),a=n(121),o=function(){return a.a.Date.now()},i=n(716),c="Expected a function",u=Math.max,s=Math.min;t.a=function(e,t,n){var a,d,l,m,f,O,b=0,p=!1,g=!1,T=!0;if("function"!=typeof e)throw new TypeError(c);function j(t){var n=a,r=d;return a=d=void 0,b=t,m=e.apply(r,n)}function S(e){var n=e-O;return void 0===O||n>=t||n<0||g&&e-b>=l}function h(){var e=o();if(S(e))return v(e);f=setTimeout(h,function(e){var n=t-(e-O);return g?s(n,l-(e-b)):n}(e))}function v(e){return f=void 0,T&&a?j(e):(a=d=void 0,m)}function D(){var e=o(),n=S(e);if(a=arguments,d=this,O=e,n){if(void 0===f)return function(e){return b=e,f=setTimeout(h,t),p?j(e):m}(O);if(g)return clearTimeout(f),f=setTimeout(h,t),j(O)}return void 0===f&&(f=setTimeout(h,t)),m}return t=Object(i.a)(t)||0,Object(r.a)(n)&&(p=!!n.leading,l=(g="maxWait"in n)?u(Object(i.a)(n.maxWait)||0,t):l,T="trailing"in n?!!n.trailing:T),D.cancel=function(){void 0!==f&&clearTimeout(f),b=0,a=O=d=f=void 0},D.flush=function(){return void 0===f?m:v(o())},D}},1483:function(e,t,n){"use strict";var r,a;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),function(e){e[e.Retry=1]="Retry",e[e.Undo=2]="Undo"}(r||(r={})),function(e){e[e.ForceDismissedFromCode=11]="ForceDismissedFromCode"}(a||(a={}))},1561:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(72),a=n(3);function o(e){const t=function(e){switch(e){case"TimePanelAgenda":case"TimePanelTodo":return"MyDay";case"BoardCalendarAsset":case"SpacesTaskListAsset":case"SpacesTaskAsset":return"CalendarBoard";case"TodoWidget":return"ToDoWidget";case"AgendaTodo":case"CalendarSurface":case"CalendarAgenda":return;default:Object(r.a)(e)}}(e);if(t){const e=Object(a.E)();if(e===a.f)return{utmSource:`${t}SuiteHeader`};if(e===a.g)return{utmSource:`${t}Desktop`,removeFromOwa:!0};if(e===a.j&&"ToDoWidget"===t)return{utmSource:t}}return{utmSource:""}}},17470:function(e,t,n){var r=n(17471);"string"==typeof r&&(r=[[e.i,r,""]]);var a={transform:void 0};n(84)(r,a);r.locals&&(e.exports=r.locals)},17471:function(e,t,n){(t=e.exports=n(83)(!1)).push([e.i,"._2C9SrakQubH8DZwX-KCv2Y{color:inherit;font:inherit;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%;height:36px;cursor:pointer}html[dir] ._2C9SrakQubH8DZwX-KCv2Y{background:none;border:none;padding-bottom:0;padding-top:0}html[dir=ltr] ._2C9SrakQubH8DZwX-KCv2Y{padding:0 8px 0 13px}html[dir=rtl] ._2C9SrakQubH8DZwX-KCv2Y{padding:0 13px 0 8px}html[dir] ._2C9SrakQubH8DZwX-KCv2Y:focus,html[dir] ._2C9SrakQubH8DZwX-KCv2Y:hover{background-color:var(--neutralLighter)}html[dir] ._2C9SrakQubH8DZwX-KCv2Y:active{background-color:var(--neutralLight)}html[dir=ltr] ._1FbqRv1YsQ_jaQRu-NmPoq{margin-right:11px}html[dir=rtl] ._1FbqRv1YsQ_jaQRu-NmPoq{margin-left:11px}",""]),t.locals={spaceProjectContainer:"_2C9SrakQubH8DZwX-KCv2Y",spaceIcon:"_1FbqRv1YsQ_jaQRu-NmPoq"}},17472:function(e){e.exports=JSON.parse('{"a":"qAb"}')},17473:function(e){e.exports=JSON.parse('{"c":"nAb","b":"oAb","a":"pAb"}')},3115:function(e,t,n){"use strict";var r,a=n(4);!function(e){e.SelectedCalendars="SelectedCalendars",e.MyDay="MyDay",e.SavedCalendarViews="SavedCalendarViews",e.BoardCalendarAsset="BoardCalendarAsset",e.Spotlight="Spotlight",e.CalendarWidget="CalendarWidget",e.Addins="Addins",e.ActivityFeed="ActivityFeed",e.ReadingPane="ReadingPane",e.SXSAttachments="SXSAttachments",e.BoardMailItem="BoardMailItem"}(r||(r={})),n.d(t,"b",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return r}));const o=new a.d(()=>n.e(1068).then(n.bind(null,19909))),i=(e,t)=>{const n=new a.a(e,t);return(...e)=>n.importAndExecute(...e)},c=i(o,e=>e.convertIdsToTargetFormat),u=i(o,e=>e.translateRestImmutableIdsToEwsIds),s=i(o,e=>e.translateEwsIdsToEwsImmutableIds),d=i(o,e=>e.translateEwsIdsToRestImmutableIds);i(o,e=>e.translateEwsImmutableIdsToEwsIds)},397:function(e,t,n){"use strict";var r=n(221),a=n(193),o="[object Symbol]";t.a=function(e){return"symbol"==typeof e||Object(a.a)(e)&&Object(r.a)(e)==o}},405:function(e,t,n){"use strict";const r="dragged_email";var a;!function(e){e.Normal="Normal",e.High="High",e.Low="Low"}(a||(a={}));var o=a;function i(e){return"Todo"===(null==e?void 0:e.__type)}var c=n(159);function u(e){return e=null!==e?e:{},Object.assign(Object.assign({},e),{CompletedDateTime:e.CompletedDateTime?e.CompletedDateTime:null,Id:e.Id?e.Id:Object(c.a)(),IsCompleted:!!e.IsCompleted&&e.IsCompleted,OrderDateTime:e.OrderDateTime?e.OrderDateTime:null,Subject:e.Subject?e.Subject:null})}function s(e){const t=(e=null!==e?e:{}).Id?e.Id:Object(c.a)();return Object.assign(Object.assign({},e),{__type:"Todo",Id:t,ParentFolderId:e.ParentFolderId?e.ParentFolderId:null,Subject:e.Subject?e.Subject:null,ReminderDateTime:e.ReminderDateTime?e.ReminderDateTime:null,IsReminderOn:!!e.IsReminderOn&&e.IsReminderOn,CompletedDateTime:e.CompletedDateTime?e.CompletedDateTime:null,DueDateTime:e.DueDateTime?e.DueDateTime:null,OrderDateTime:e.OrderDateTime?e.OrderDateTime:null,Status:e.Status?e.Status:"NotStarted",Subtasks:e.Subtasks?e.Subtasks:null,Importance:e.Importance?e.Importance:o.Normal,Note:e.Note?e.Note:null,LinkedEmail:e.LinkedEmail?e.LinkedEmail:null,CommittedDay:e.CommittedDay?e.CommittedDay:null,CommittedOrder:e.CommittedOrder?e.CommittedOrder:null,PostponedDay:e.PostponedDay?e.PostponedDay:null,CreatedWithLocalId:t,Categories:e.Categories?e.Categories:null})}function d(e){return e=null!==e?e:{},Object.assign(Object.assign({},e),{Id:e.Id?e.Id:Object(c.a)(),Name:e.Name?e.Name:null,IsDefaultFolder:!!e.IsDefaultFolder&&e.IsDefaultFolder,IsSharedFolder:!!e.IsSharedFolder&&e.IsSharedFolder,IsOwner:!!e.IsOwner&&e.IsOwner,FolderType:e.FolderType?e.FolderType:"Other",SyncStatus:e.SyncStatus?e.SyncStatus:"Synced",OrderDateTime:e.OrderDateTime?e.OrderDateTime:null})}function l(e){if(!e||!e.subjects||0===e.subjects.length)return[];return e.subjects.map((t,n)=>({Subject:t,LinkedEmail:{Id:e.latestItemIds[n],EntitySubtype:r,DisplayName:t}}))}n.d(t,"c",(function(){return"message"})),n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return"highlight_from_email"})),n.d(t,"a",(function(){return"context_menu_email"})),n.d(t,"e",(function(){return o})),n.d(t,"j",(function(){return i})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return s})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return l}))},437:function(e,t,n){"use strict";var r=n(155);const a=!0,o=!0;function i(e,t,n){return Object(r.g)(e,"GET",n,{throwServiceError:a,customHeaders:d(t)})}function c(e,t,n,i){return Object(r.g)(e,"DELETE",n,{requestObject:i,sendPayloadAsBody:o,throwServiceError:a,customHeaders:d(t)})}function u(e,t,n,i,c){return Object(r.g)(e,"POST",n,{requestObject:i,sendPayloadAsBody:o,throwServiceError:a,customHeaders:d(t,c)})}function s(e,t,n,i,c){return Object(r.g)(e,"PATCH",n,{requestObject:i,sendPayloadAsBody:o,throwServiceError:a,customHeaders:d(t,c)})}function d(e,t){const n={};return e&&(n["x-anchormailbox"]=e),!0===t&&(n.Prefer="return=representation"),!1===t&&(n.Prefer="return=minimal"),n}n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return s}))},5343:function(e,t,n){"use strict";var r=n(1448),a=n(165),o="Expected a function";t.a=function(e,t,n){var i=!0,c=!0;if("function"!=typeof e)throw new TypeError(o);return Object(a.a)(n)&&(i="leading"in n?!!n.leading:i,c="trailing"in n?!!n.trailing:c),Object(r.a)(e,t,{leading:i,maxWait:t,trailing:c})}},654:function(e,t,n){"use strict";var r=n(1149),a=n(6);function o(){return Object(a.b)(r.a)}var i=n(5);function c(e){const t=e||Object(i.Tb)(),n=Object(i.ac)(t),r=Object(i.e)(n,1);return Object(i.f)(r,11)}function u(e){return e.IsDefaultFolder?o():"Commitments"===e.FolderType?e.Name:"FlaggedEmails"===e.FolderType?Object(a.b)(r.b):e.Name}function s(e){return"FlaggedEmails"===e.FolderType}var d=n(405);function l(e){return e===d.e.High}var m=function(e,t=Object(i.Tb)()){return Object(i.u)(Object(i.ac)(t),Object(i.ac)(e))>0};function f(e){return!!e.CommittedDay&&Object(i.Lb)(e.CommittedDay,Object(i.oc)())}var O=function(e){return"Completed"===e};function b(e){const t=[];let n=null,r=null,a=null;e.forEach(e=>{e.IsDefaultFolder?(n=Object.assign({},e),n.Name=u(e)):"Commitments"===e.FolderType?(r=Object.assign({},e),r.Name=u(e)):"FlaggedEmails"===e.FolderType?(a=Object.assign({},e),a.Name=u(e)):t.push(e)});const o=t.sort((e,t)=>e.OrderDateTime&&t.OrderDateTime?Object(i.p)(t.OrderDateTime,e.OrderDateTime):e.OrderDateTime?-1:t.OrderDateTime?1:0);return r&&o.splice(0,0,r),a&&o.splice(0,0,a),n&&o.splice(0,0,n),o}function p(e,t){return Object(i.Hb)(e.OrderDateTime,t.OrderDateTime)?-1:1}function g(e,t){return Object(i.Hb)(e.CommittedOrder,t.CommittedOrder)?-1:1}var T=n(1561);function j(e,t){return e&&t&&t.Id!==e.ParentFolderId?{ParentFolderId:t.Id}:{}}function S(e){return null!==e.CompletedDateTime&&"NotStarted"!==e.Status?{Status:"NotStarted"}:{}}function h(e,t){let n={};return t&&(n={CommittedOrder:Object(i.Tb)()}),e?n=Object.assign(Object.assign({},n),{CommittedDay:Object(i.oc)(),PostponedDay:null}):e||(n=Object.assign(Object.assign({},n),{CommittedDay:void 0,PostponedDay:Object(i.oc)()})),n}var v=n(72);const D=36e5;function y(e,t,n){if(0===t.length)return{};if(e>=t.length){return function(e,t){switch(t){case"CommittedOrder":return{CommittedOrder:Object(i.g)(e.CommittedOrder,-D)};case"OrderDateTime":return I(e);default:return Object(v.a)(t)}}(t[t.length-1],n)}if(0===e){return function(e,t){const n=Object(i.Tb)();switch(t){case"CommittedOrder":return{CommittedOrder:A(Object(i.Hb)(e.CommittedOrder,n)?Object(i.g)(e.CommittedOrder,D):n,e.CommittedOrder)};case"OrderDateTime":return k(e);default:return Object(v.a)(t)}}(t[e],n)}const r=t[e];return function(e,t,n){switch(n){case"CommittedOrder":return{CommittedOrder:A(e.CommittedOrder,t.CommittedOrder)};case"OrderDateTime":return w(e,t);default:return Object(v.a)(n)}}(t[e-1],r,n)}function C(e,t){if(0===t.length)return{};if(e>=t.length){return function(e,t){switch(t){case"OrderDateTime":return I(e);default:return Object(v.a)(t)}}(t[t.length-1],"OrderDateTime")}if(0===e){return function(e,t){switch(t){case"OrderDateTime":return k(e);default:Object(v.a)(t)}}(t[e],"OrderDateTime")}const n=t[e];return function(e,t,n){switch(n){case"OrderDateTime":return w(e,t);default:return Object(v.a)(n)}}(t[e-1],n,"OrderDateTime")}function I(e){return{OrderDateTime:Object(i.g)(e.OrderDateTime,-D)}}function k(e){const t=Object(i.Tb)();return{OrderDateTime:A(Object(i.Hb)(e.OrderDateTime,t)?Object(i.g)(e.OrderDateTime,D):t,e.OrderDateTime)}}function w(e,t){return{OrderDateTime:A(e.OrderDateTime,t.OrderDateTime)}}function A(e,t){const n=Object(i.w)(e,t)/2;return Object(i.g)(t,n)}n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"l",(function(){return s})),n.d(t,"m",(function(){return l})),n.d(t,"o",(function(){return m})),n.d(t,"n",(function(){return f})),n.d(t,"p",(function(){return O})),n.d(t,"q",(function(){return b})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return g})),n.d(t,"k",(function(){return T.a})),n.d(t,"g",(function(){return j})),n.d(t,"i",(function(){return S})),n.d(t,"f",(function(){return h})),n.d(t,"h",(function(){return y})),n.d(t,"j",(function(){return C}))},716:function(e,t,n){"use strict";var r=/\s/;var a=function(e){for(var t=e.length;t--&&r.test(e.charAt(t)););return t},o=/^\s+/;var i=function(e){return e?e.slice(0,a(e)+1).replace(o,""):e},c=n(165),u=n(397),s=NaN,d=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,m=/^0o[0-7]+$/i,f=parseInt;t.a=function(e){if("number"==typeof e)return e;if(Object(u.a)(e))return s;if(Object(c.a)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Object(c.a)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=i(e);var n=l.test(e);return n||m.test(e)?f(e.slice(2),n?2:8):d.test(e)?s:+e}},8363:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const r=["ConversationId","DateTimeReceived","Flag","HasAttachments","IsRead","ItemId","ParentFolderId","Preview","Sender","Subject"];function a(e){const t={};return r.forEach(n=>{t[n]=e[n]}),t}},8374:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const r=["CalendarItemType","End","Start","HasAttachments","FreeBusyType","Location","Subject","Organizer","ItemId","ParentFolderId","Preview","IsOrganizer","IsCancelled","ResponseType","InstanceKey"];function a(e){const t={};return r.forEach(n=>{t[n]=e[n]}),t}},898:function(e){e.exports=JSON.parse('{"a":"Wcb"}')},903:function(e,t,n){"use strict";var r={};n.r(r),n.d(r,"getOutlookSpaces",(function(){return s})),n.d(r,"createOutlookSpace",(function(){return d})),n.d(r,"getOutlookSpace",(function(){return l})),n.d(r,"deleteOutlookSpace",(function(){return m})),n.d(r,"patchOutlookSpace",(function(){return f})),n.d(r,"getOutlookSpaceAssets",(function(){return O})),n.d(r,"canSyncAssets",(function(){return b})),n.d(r,"syncAssets",(function(){return p})),n.d(r,"createOutlookSpaceAsset",(function(){return g})),n.d(r,"deleteOutlookSpaceAsset",(function(){return T})),n.d(r,"patchOutlookSpaceAsset",(function(){return j})),n.d(r,"reorderOutlookSpaceAssetChildren",(function(){return S})),n.d(r,"emptyOutlookSpaceRecycleBin",(function(){return h}));var a=n(1);function o(){return JSON.parse(localStorage.LocalOutlookSpaces||"{}")}function i(e){localStorage.LocalOutlookSpaces=JSON.stringify(e)}function c(e){return JSON.parse(JSON.stringify(e))}function u(e){const{assets:t}=e,n=Object(a.__rest)(e,["assets"]);return Object.assign({},n)}function s(e){return new Promise(t=>{const n=o();let r=Object.keys(n).map(e=>u(n[e])).sort((e,t)=>e.createdDateTime<t.createdDateTime?-1:1);const a=(null==e?void 0:e.appName)||"";a&&(r=r.filter(e=>e.appName&&e.appName.indexOf(a)>-1)),t(r)})}function d(e){return new Promise(t=>{const{assets:n}=e,r=c(Object(a.__rest)(e,["assets"])),s=new Date;r.id=`VOLATILE_${s.getTime()}`,r.createdDateTime=s.toISOString(),r.lastModifiedDateTime=s.toISOString(),r.assets=(null==n?void 0:n.reduce((e,t,n)=>{const r=c(t),a=new Date;return r.id=`VOLATILE_${a.getTime()}_${n}`,r.createdDateTime=a.toISOString(),r.lastModifiedDateTime=a.toISOString(),e[r.id]=r,e},{}))||{};const d=o();d[r.id]=r,i(d),t(u(r))})}function l(e){return new Promise((t,n)=>{const r=o()[e];r?t(u(r)):n("VOLATILE PROJECT NOT FOUND")})}function m(e){return new Promise((t,n)=>{const r=o();r[e]?(delete r[e],i(r),t()):n("VOLATILE PROJECT NOT FOUND")})}function f(e,t){return new Promise((n,r)=>{const a=o();if(a[e]){const r=a[e]=Object.assign(Object.assign(Object.assign({},a[e]),c(t)),{lastModifiedDateTime:(new Date).toISOString()});i(a),n(u(r))}else r("VOLATILE PROJECT NOT FOUND")})}async function O(e){return new Promise((t,n)=>{var r;const a=null===(r=o()[e])||void 0===r?void 0:r.assets;if(a){const e=Object.keys(a).map(e=>a[e]).sort((e,t)=>e.createdDateTime<t.createdDateTime?-1:1);for(const t of e)t.x=t.x||0,t.y=t.y||0;t(e)}else n("VOLATILE PROJECT NOT FOUND")})}function b(){return!1}function p(e,t){return Promise.reject()}async function g(e,t){return new Promise((n,r)=>{var a;const u=o(),s=null===(a=u[e])||void 0===a?void 0:a.assets;if(s){const e=c(t),r=new Date;e.id=`VOLATILE_${r.getTime()}`,e.createdDateTime=r.toISOString(),e.lastModifiedDateTime=r.toISOString(),s[e.id]=e,i(u),n(e)}else r("VOLATILE PROJECT NOT FOUND")})}function T(e,t){return new Promise((n,r)=>{var a;const c=o(),u=null===(a=c[e])||void 0===a?void 0:a.assets;if(u){u[t]||r("VOLATILE ASSET NOT FOUND"),delete u[t],Object.keys(u).forEach(e=>{u[e].parentId==t&&delete u[e]}),i(c),setTimeout(n,1)}else r("VOLATILE PROJECT NOT FOUND")})}function j(e,t,n,r){return new Promise((r,a)=>{var u;const s=o(),d=null===(u=s[e])||void 0===u?void 0:u.assets;if(d){const e=d[t];e||a("VOLATILE ASSET NOT FOUND");const o=d[t]=Object.assign(Object.assign(Object.assign({},e),c(n)),{parentId:null===n.parentId?void 0:n.parentId||e.parentId,lastModifiedDateTime:(new Date).toISOString()});i(s),r(o)}else a("VOLATILE PROJECT NOT FOUND")})}function S(e,t){return Promise.reject("NOT IMPLEMENTED")}function h(e){return Promise.resolve()}var v=n(25),D=n(437);const y=[["outlookSpaces-v2_0-api","v2.0/spaces"],["outlookSpaces-v1_0-api","v1.0/spaces"],["outlookSpaces-v1_5-api","v1.5/spaces"]];function C(){for(const[e,t]of y)if(Object(v.k)(e))return t;return"api/spaces"}function I(e){const t=null==e?void 0:e.appName,n=t?"?appName="+encodeURIComponent(t):"";return C()+n}function k(e){return C()+"/"+encodeURIComponent(e)}function w(e){return k(e)+"/assets"}function A(e,t){return w(e)+"/"+encodeURIComponent(t)}class E{constructor(e){this.targetMailbox=e,this.baseUrl="ows/"+(e?e+"/":"")}getOutlookSpaces(e){return Object(D.b)("getOutlookSpaces",this.targetMailbox,this.baseUrl+I(e))}createOutlookSpace(e){return Object(D.d)("createOutlookSpace",this.targetMailbox,this.baseUrl+I(),e)}getOutlookSpace(e){return Object(D.b)("getOutlookSpace",this.targetMailbox,this.baseUrl+k(e))}deleteOutlookSpace(e){return Object(D.a)("deleteOutlookSpace",this.targetMailbox,this.baseUrl+k(e))}patchOutlookSpace(e,t){return Object(D.c)("patchOutlookSpace",this.targetMailbox,this.baseUrl+k(e),t)}getOutlookSpaceAssets(e){return Object(D.b)("getOutlookSpaceAssets",this.targetMailbox,this.baseUrl+w(e))}canSyncAssets(){return!0}syncAssets(e,t){return Object(D.b)("syncAssets",this.targetMailbox,this.baseUrl+function(e,t){const n=w(e)+"/sync",r=["skipToken","deltaToken","maxPageSize"].map(e=>t[e]?`${e}=${encodeURIComponent(t[e])}`:"").filter(e=>e).join("&");return n+(r?"?"+r:"")}(e,t))}createOutlookSpaceAsset(e,t){return Object(D.d)("createOutlookSpaceAsset",this.targetMailbox,this.baseUrl+w(e),t)}deleteOutlookSpaceAsset(e,t){return Object(D.a)("deleteOutlookSpaceAsset",this.targetMailbox,this.baseUrl+A(e,t)+"?deleteChildren=true")}patchOutlookSpaceAsset(e,t,n,r){return Object(D.c)("patchOutlookSpaceAsset",this.targetMailbox,this.baseUrl+A(e,t),n,r)}reorderOutlookSpaceAssetChildren(e,t){return Object(D.d)("reorderOutlookSpaceAssetChildren",this.targetMailbox,this.baseUrl+function(e,t){return A(e,t)+"/reorderChildren"}(e,t),null)}emptyOutlookSpaceRecycleBin(e){return Object(D.a)("emptyOutlookSpaceRecycleBin",this.targetMailbox,this.baseUrl+function(e){return k(e)+"/recycleBin"}(e))}}let N=void 0;function x(){return void 0===N&&(N=Object(v.k)("cal-board-dev-useLocalService")?r:new E),N}function P(e){return x().getOutlookSpaces(e)}function F(e,t){const n=t?new E(t):x();return e.assets&&e.assets.forEach((function(e){M(e)})),n.createOutlookSpace(e)}function L(e){return x().getOutlookSpaceAssets(e)}function R(e,t){return x().createOutlookSpaceAsset(e,M(t))}function _(e){return x().emptyOutlookSpaceRecycleBin(e)}function M(e){return e.x=U(e.x),e.y=U(e.y),e.width=U(e.width),e.height=U(e.height),e.rotation=U(e.rotation),e}function U(e){return e?Math.round(e):e}n.d(t,"g",(function(){return P})),n.d(t,"b",(function(){return F})),n.d(t,"f",(function(){return L})),n.d(t,"c",(function(){return R})),n.d(t,"d",(function(){return _})),n.d(t,"a",(function(){return E})),n.d(t,"e",(function(){return x}))},950:function(e,t,n){"use strict";n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return d}));var r=n(20),a=n(1483);n.d(t,"a",(function(){return a.b}));var o=n(934);n.d(t,"b",(function(){return o.a})),n.d(t,"c",(function(){return o.b}));const i=new r.c(()=>n.e(989).then(n.bind(null,2655)));let c=new r.a(i,e=>e.showNotification),u=new r.a(i,e=>e.showNotificationWithButtonCallback),s=new r.a(i,e=>e.dismissNotification),d=new r.a(i,e=>e.enableNotificationBar)}}]);
//# sourceMappingURL=owa.MailBoot~TimeStreamContextMenu.js.map
self.scriptsLoaded['owa.MailBoot~TimeStreamContextMenu.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~TimeStreamContextMenu.js'] = (new Date()).getTime();