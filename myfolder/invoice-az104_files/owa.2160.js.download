self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.2160.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[2160],{7460:function(i,e,n){"use strict";n.r(e);var l=n(155),o=n(25),t=n(1473);const d="/PeopleGraph/v1.0/contacts",a="PrsId",s="OID";function v(i){var e,n,l,o,t,d,v,r,u,c,m,p,f,b,$,j,y,w;const I=null===(n=null===(e=i.positions)||void 0===e?void 0:e.filter(i=>i.isCurrent))||void 0===n?void 0:n[0],h=null===(l=null==I?void 0:I.detail)||void 0===l?void 0:l.company,x=null===(o=null==i?void 0:i.emails)||void 0===o?void 0:o[0],C=null===(t=null==i?void 0:i.phones)||void 0===t?void 0:t[0],[N,O]=function(i){var e,n,l;return[null===(e=i.map(i=>i.split(":")).filter(i=>i[0]===a)[0])||void 0===e?void 0:e[1],null===(l=null===(n=i.map(i=>i.split(":")).filter(i=>i[0]===s)[0])||void 0===n?void 0:n[1].split("@"))||void 0===l?void 0:l[0]]}(i.alternateIds);return{personaId:N,hubPersonaId:`HubContactId_${i.id}`,type:1,isReadOnly:!1,info:{allEmailAddresses:null===(d=i.emails)||void 0===d?void 0:d.map(i=>i.address),displayNameLastFirst:[null===(v=i.name)||void 0===v?void 0:v.last,null===(r=i.name)||void 0===r?void 0:r.middle,null===(u=i.name)||void 0===u?void 0:u.first].filter(Boolean).join(" "),displayNameFirstLast:[null===(c=i.name)||void 0===c?void 0:c.first,null===(m=i.name)||void 0===m?void 0:m.middle,null===(p=i.name)||void 0===p?void 0:p.last].filter(Boolean).join(" "),mainEmailAddress:null==x?void 0:x.address,company:null==h?void 0:h.displayName,surname:null===(f=i.name)||void 0===f?void 0:f.last,givenName:null===(b=i.name)||void 0===b?void 0:b.first,prefix:null===($=i.name)||void 0===$?void 0:$.title,generation:null===(j=i.name)||void 0===j?void 0:j.suffix,phoneNumber:null==C?void 0:C.number,title:null===(y=null==I?void 0:I.detail)||void 0===y?void 0:y.jobTitle,department:null==h?void 0:h.department,location:null==h?void 0:h.officeLocation,originalDisplayName:(null===(w=i.name)||void 0===w?void 0:w.displayName)||"",externalDirectoryObjectId:O,contactId:i.id}}}var r=function(i){return i.value.map(v)};const u=["names","emails","phones","addresses","positions","notes","webAccounts","anniversaries","relationships","websites"],c=["id","alternateIds","createdDateTime","lastModifiedDateTime","changeKey"];var m=async(i={expand:u,count:1e3,select:c})=>{const e=((i={expand:u,count:1e3,select:c})=>{const{expand:e,count:n,filter:l,select:o}=i;let t="?";return e&&(t+=`$expand=${e.join(",")}&`),n&&(t+=`$top=${n}&`),o&&(t+=`$select=${o.join(",")}&`),l&&(t+=`$filter=${l}`),t})(i),n=`${d}${e}`,o=await Object(l.b)(n,void 0,!0,null,!0),t=await o.json();return r(t)};var p=i=>Object(l.a)(`${d}('${i}')`,void 0,void 0,!0,null);n.d(e,"convertContactToPersonType",(function(){return v}));e.default={isEnabled:()=>!!Object(o.k)("fwk-application-settings")&&Object(t.f)("CAPIv3").isCAPIv3Enabled,ListContacts:m,DeleteContact:p}}}]);
//# sourceMappingURL=owa.2160.js.map
self.scriptsLoaded['owa.2160.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.2160.js'] = (new Date()).getTime();