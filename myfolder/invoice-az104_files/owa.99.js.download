self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.99.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[99],{2844:function(e,t,n){"use strict";var o=n(2),r=n(66),i=n(2733);const c=Object(o.action)("selectFocusedViewFilter",(e,t)=>Object(r.b)({name:0===e?"TnS_SelectFocusedPivot":"TnS_SelectOtherPivot",options:{isCore:!0},customData:[e,t,null!=i.Z.inboxPausedDateTime]},{focusedViewFilter:e,actionSource:t})),u=Object(o.action)("ON_INITIAL_TABLE_LOAD_COMPLETE",e=>({tableView:e}));var a=n(4453),d=n(13);const s=Object(o.mutatorAction)("addTableViewToStore",(e,t)=>{t.set(e.id,e)});function l(e,t){const n=Object(i.L)().tableViews,o=Object(a.a)(e);let r=n.get(o);if(!r&&(r=function(e,t){return{currentLoadedIndex:0,loadErrorStatus:0,id:e,isInCheckedMode:!1,isInVirtualSelectAllMode:!1,isInitialLoadComplete:!1,isLoading:!0,rowKeys:[],rowIdToRowKeyMap:new d.ObservableMap,lastEmptiedTime:null,selectAllModeTimeStamp:null,selectedRowKeys:new d.ObservableMap,serverFolderId:t.folderId,tableQuery:t,totalRowsInView:0,virtualSelectAllExclusionList:[],selectionAnchorRowKey:null,focusedRowKey:null,multiSelectionAnchorRowKey:null}}(o,e),!t)){const e=r.id;s(r,n),r=n.get(e)}return r}n.d(t,"a",(function(){return 25})),n.d(t,"b",(function(){return 25})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return l}))},2948:function(e,t,n){"use strict";var o=n(3190),r=n(3809),i=n(4264),c=n(20),u=n(3966),a=n(3117),d=n(596);function s(e,t){return Object(d.b)(e,t,!1,{hideCancelButton:!0})}var l=n(3480),f=n(3288),b=n(2929),O=n(1423),S=n(3360),j=n(30),w=n(1084),p=n(2737),I=n(220);function v(e,t){var n;if(t==Object(w.a)("msgfolderroot"))return!(null===(n=Object(j.a)().UserOptions)||void 0===n?void 0:n.IsMailRootFolderTreeCollapsed);{const n=e[t];return!n||n.IsExpanded}}async function g(e){var t;await Object(p.v)(void 0,void 0,e),Object(I.a)()||((null===(t=Object(j.a)().SessionSettings)||void 0===t?void 0:t.HasArchive)&&Object(p.z)(),Object(p.B)()),function(){const e=Object(l.c)();Object.keys(e).forEach(t=>{const{sortColumn:n,sortDirection:o}=Object(f.a)(t),r={isExpanded:v(e,t),sortColumn:n,sortOrder:o,drag:Object(b.a)(),drop:Object(O.a)()};Object(S.a)(t,r)})}()}var C=n(3494),h=n(3575),m=n(3345),F=n(2),y=n(4172),R=(Object(F.orchestrator)(y.a,e=>{g()}),n(4028));Object(F.orchestrator)(o.b,()=>{Object(R.a)(C.a)});n.d(t,"d",(function(){return T})),n.d(t,"i",(function(){return s})),n.d(t,"g",(function(){return o.b})),n.d(t,"f",(function(){return o.a})),n.d(t,"e",(function(){return g})),n.d(t,"a",(function(){return C.a})),n.d(t,"b",(function(){return m.a})),n.d(t,"c",(function(){return m.b})),n.d(t,"h",(function(){return r.a}));const D=new c.c(()=>n.e(993).then(n.bind(null,19866)));Object(c.f)(i.a,D,e=>e.onNewFolderSuccessOrchestrator),Object(c.f)(o.a,D,e=>e.onFilesFolderShownOrchestrator),Object(c.f)(h.a,D,e=>e.onNewFolderRowNotificationOrchestrator),Object(c.f)(a.a,D,e=>e.markAllAsReadOrchestrator),Object(c.f)(u.a,D,e=>e.emptyFolderStoreUpdateOrchestrator),Object(c.f)(r.a,D,e=>e.setFolderSortByOrchestrator);let T=new c.a(D,e=>e.dismissMailFolderTextField)},3176:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var o=n(3360),r=n(3236),i=n(2929),c=n(1423),u=n(2733),a=n(3345),d=n(154),s=n(25);function l(e){const t=u.c.getDefaultSortBy();r.a.folderNodeViewStates.has(e)||Object(o.a)(e,{isExpanded:!1,sortColumn:t.sortColumn,sortOrder:t.sortDirection,drag:Object(i.a)(),drop:Object(c.a)()});const n=r.a.folderNodeViewStates.get(e);return Object(d.a)("native")&&Object(s.k)("mon-conv-useHx")&&0===Object(a.a)(e)?Object.assign(Object.assign({},n),{sortColumn:t.sortColumn,sortOrder:t.sortDirection}):n}},3190:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var o=n(2);const r=Object(o.action)("ON_FILES_FOLDER_SHOWN",e=>({isExpanded:e})),i=Object(o.action)("FILES_TREE_ROOT_NODE_CLICKED",e=>({isExpanded:e}))},3236:function(e,t,n){"use strict";var o=n(2),r=n(13),i=n(2737),c=n(3344),u=n(3575),a=n(2782);Object(o.mutator)(c.a,e=>{d(e.unreadCount,e.totalCount,e.folderId,e.isDeltaChange)});Object(o.mutator)(u.b,e=>{d(e.unreadCount,e.totalCount,e.folderId,!1)});function d(e,t,n,o){const r=i.d.folderTable.get(n);r&&(o?(r.UnreadCount+=e,r.TotalCount+=t):(r.UnreadCount=e,r.TotalCount=t),r.pausedTotalCount&&Object(a.b)()===n&&(r.pausedTotalCount=r.TotalCount),r.UnreadCount=Math.max(r.UnreadCount,0),r.TotalCount=Math.max(r.TotalCount,0))}n.d(t,"b",(function(){return l}));const s={folderNodeViewStates:new r.ObservableMap({}),contextMenuState:null,folderTextFieldViewState:null,isDraggedOver:!1,withContextMenuFolderId:null},l=Object(o.createStore)("folderViewState",s),f=l();t.a=f},3288:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var o=n(3480),r=n(2733),i=n(4259),c=n(68);function u(e){const t=Object(o.c)()[e];if(t){const n=Object(i.getSupportedSortColumns)(e),{SortColumn:o,SortOrder:u}=t;if(n.includes(o)){let e=u;return(!u||u!=r.c.DESCENDING_SORT_DIR&&u!=r.c.ASCENDING_SORT_DIR)&&(e=r.c.getDefaultSortDirectionForSortColumn(o),Object(c.p)("getSortByFolderId_invalidSortOrder",{sortColumn:o,sortOrder:u})),{sortColumn:o,sortDirection:e}}}return r.c.getDefaultSortBy()}},3344:function(e,t,n){"use strict";var o=n(2);t.a=Object(o.action)("UPDATE_FOLDER_COUNTS",(e,t,n,o)=>({unreadCount:e,totalCount:t,folderId:n,isDeltaChange:o}))},3345:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var o=n(30),r=n(2737);const i=["drafts","junkemail","recoverableitemsdeletions"];function c(e){let t;return e&&(t=Object(r.m)().get(e)),u(t)}function u(e){var t,n;return e&&(e.DistinguishedFolderId&&-1!=i.indexOf(e.DistinguishedFolderId)||"ArchiveMailbox"===e.mailboxInfo.type||"SharedMailbox"===e.mailboxInfo.type)||Object(r.G)(null==e?void 0:e.FolderId.Id)?1:(null===(n=null===(t=Object(o.a)())||void 0===t?void 0:t.UserOptions)||void 0===n?void 0:n.GlobalListViewTypeReact)||0}},3360:function(e,t,n){"use strict";var o=n(3236),r=n(2);t.a=Object(r.mutatorAction)("setFolderViewState",(function(e,t){o.a.folderNodeViewStates.set(e,t)}))},3441:function(e,t,n){"use strict";var o=n(2);const r=Object(o.action)("ON_NUDGE_REMOVED",e=>({rowKey:e})),i=Object(o.action)("ON_GET_NUDGES_COMPLETED",(e,t)=>({nudgedRows:e,tableView:t}));let c=Object(o.createStore)("nudgeStore",{nudgedRows:[]});var u=c();Object(o.mutator)(i,e=>{u.nudgedRows=e.nudgedRows}),Object(o.mutator)(r,e=>{for(let t=u.nudgedRows.length-1;t>=0;t--)u.nudgedRows[t].rowKey===e.rowKey&&u.nudgedRows.splice(t,1)});var a=n(5530),d=n(6);function s(e){const t=u.nudgedRows.filter(t=>t.rowKey===e)[0],n=t.daysAgo,o=0==t.reason;return 0==n?o?Object(d.b)(a.c):Object(d.b)(a.f):1==n?o?Object(d.b)(a.b):Object(d.b)(a.e):o?Object(d.c)(Object(d.b)(a.a),n):Object(d.c)(Object(d.b)(a.d),n)}var l=n(2733);function f(e,t){return u.nudgedRows.some(n=>n.rowKey===e&&n.tableViewId===t||"testNudgeRowKey"==e)}var b=n(5320);function O(e,t,n){return!!f(e,t)&&(!!Object(b.c)(t)&&!Object(l.x)(n))}function S(e){const t=u.nudgedRows.filter(t=>t.conversationId===e);return t.length>0&&w(t[0])?t[0].rowKey:null}function j(e){const t=u.nudgedRows.filter(t=>t.itemId===e);return t.length>0&&w(t[0])?t[0].rowKey:null}function w(e){const t=e.tableViewId,n=Object(l.L)().tableViews.get(t);if(!n||n.id!=Object(l.J)())return!1;const o=e.rowKey;return O(o,t,l.b.getLastDeliveryOrRenewTimeStamp(o,n))}function p(e){const t=u.nudgedRows.filter(t=>t.rowKey===e);return t.length>0?t[0].itemId:null}n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return j})),n.d(t,"d",(function(){return S})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return O})),n.d(t,"g",(function(){return f})),n.d(t,"f",(function(){return c})),n.d(t,"h",(function(){return i})),n.d(t,"i",(function(){return r}))},3480:function(e,t,n){"use strict";var o=n(3176),r=n(30),i=n(52),c=n(2751),u=n(3448);function a(e){return"inbox"!=Object(c.a)(e)||Object(u.a)(e)?w.SearchRefinerScopeCurrentFolder:w.SearchRefinerScopeAll}var d=n(2733),s=n(3174),l=n(2737),f=n(2742);function b(e){const t=Object(c.a)(e);return Object(u.a)(e)||Object(l.G)(e)?p.DateViewOnly:"drafts"==t||"junkemail"==t||"outbox"==t||"notes"==t?p.DateViewOnly:"deleteditems"==t||Object(f.k)(e)?p.DateView:p.ConversationView}var O=n(1448),S=n(68);const j=Object(O.a)(e=>{Object(S.p)("UpdateFolderViewState",{},{isCore:!0}),i.u.importAndExecute([{key:"FolderViewState",valuetype:"StringArray",value:e}],"OWA.ViewStateConfiguration")},3e4,{leading:!1,trailing:!0});var w,p,I=n(361);function v(e){return JSON.parse(e,(function(e,t){return"SortOrder"!==e||1!==t&&0!==t?t:1===t?d.c.DESCENDING_SORT_DIR:d.c.ASCENDING_SORT_DIR}))}function g(){var e;const t=(null===(e=Object(r.a)().ViewStateConfiguration)||void 0===e?void 0:e.FolderViewState)||[],n={};for(let e=0;e<t.length;e++){const o=v(t[e]);n[o.FolderId.Id]=o}return n}function C(e){return JSON.stringify(e,(function(e,t){return"SortOrder"!==e||t!==d.c.DESCENDING_SORT_DIR&&t!==d.c.ASCENDING_SORT_DIR?t:t===d.c.DESCENDING_SORT_DIR?1:0}))}function h(e){let t=!1;Object(I.a)(n=>{var i;const c=(null===(i=n.ViewStateConfiguration)||void 0===i?void 0:i.FolderViewState)||[],u=Object(o.a)(e);let d=null,f=-1;for(let t=0;t<c.length;t++){const n=v(c[t]);if(n.FolderId.Id===e){d=n,f=t;break}}const O=function(e,t,n){var o;const i=n?n.sortOrder:"Ascending",c=n?n.sortColumn:1,u=!!n&&n.isExpanded;if(t)return Object.assign(Object.assign({},t),{SortOrder:i,SortColumn:c,IsExpanded:u});const d=l.d.folderTable.get(e);return d?{FolderId:d.FolderId,View:b(d.FolderId.Id),Width:s.b,SortOrder:i,SortColumn:c,IsExpanded:u,ReadingPanePosition:null===(o=Object(r.a)().UserOptions)||void 0===o?void 0:o.GlobalReadingPanePositionReact,SearchScope:a(d.FolderId.Id)}:null}(e,d,u);O&&(-1!==f?(t=d!==O,t&&(c[f]=C(O))):(t=!0,c.push(C(O))))}),t&&function(){var e,t;const n=null===(e=Object(r.a)().ViewStateConfiguration)||void 0===e?void 0:e.FolderViewState;if(n){const e=[],o=d.c.getDefaultSortBy();for(let i=0;i<n.length;i++){const c=v(n[i]),u=Object(l.m)().get(c.FolderId.Id);(!(!u||u.childFolderCount>0)||!c.IsExpanded)&&c.SearchScope===a(c.FolderId.Id)&&c.SortColumn===o.sortColumn&&c.SortOrder===o.sortDirection&&c.Width===s.b&&c.ReadingPanePosition===(null===(t=Object(r.a)().UserOptions)||void 0===t?void 0:t.GlobalReadingPanePositionReact)&&c.View===b(c.FolderId.Id)||e.push(n[i])}j(e)}}()}n.d(t,"b",(function(){return w})),n.d(t,"a",(function(){return p})),n.d(t,"d",(function(){return v})),n.d(t,"c",(function(){return g})),n.d(t,"e",(function(){return h})),function(e){e[e.SearchRefinerScopeAll=0]="SearchRefinerScopeAll",e[e.SearchRefinerScopePrimaryMailbox=1]="SearchRefinerScopePrimaryMailbox",e[e.SearchRefinerScopeCurrentFolder=2]="SearchRefinerScopeCurrentFolder",e[e.SearchRefinerScopeCurrentFolderAndSubfolders=3]="SearchRefinerScopeCurrentFolderAndSubfolders"}(w||(w={})),function(e){e[e.ConversationView=1]="ConversationView",e[e.DateView=2]="DateView",e[e.DateViewOnly=3]="DateViewOnly",e[e.ItemGroupView=4]="ItemGroupView",e[e.BundledView=5]="BundledView"}(p||(p={}))},3494:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));const o="filesFolderId"},3575:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var o=n(2);const r=Object(o.action)("onNewFolderNotification",(e,t,n,o=0,r=0,i)=>({folderId:e,parentFolderId:t,displayName:n,unreadCount:o,totalCount:r,mailboxInfo:i})),i=Object(o.action)("onUpdateFolderNotification",(e,t,n,o,r)=>({unreadCount:e,totalCount:t,folderId:n,displayName:o,parentFolderId:r}))},3809:function(e,t,n){"use strict";var o=n(2);const r=Object(o.action)("setFolderSortBy",(e,t,n)=>({folderId:e,sortColumn:t,sortDirection:n}));t.a=r},3966:function(e,t,n){"use strict";var o=n(2);t.a=Object(o.action)("EMPTY_FOLDER_STORE_UPDATE",(e,t,n,o,r,i)=>({folderId:e,clientLastSyncTime:t,deletedItemsFolderId:n,disposalType:o,deleteSubFolders:r,rowKeysToExclude:i}))},4028:function(e,t,n){"use strict";var o=n(358),r=n(3480),i=n(3176),c=n(3360);t.a=Object(o.action)("toggleFolderNodeExpansion")((function(e,t){const n=Object(i.a)(e);n&&(n.isExpanded=!n.isExpanded,Object(c.a)(e,n)),t||Object(r.e)(e)}))},4172:function(e,t,n){"use strict";var o=n(2);t.a=Object(o.action)("SELECT_CATEGORIES_OPTIONS")},4264:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(2);const r=Object(o.action)("onNewFolderSuccess",(e,t,n,o)=>({folderId:e,parentFolderId:t,displayName:n,mailboxInfo:o}))},4453:function(e,t,n){"use strict";function o(e,t=!1){const n=[];switch(e.type){case 0:n.push("folderId:"+e.folderId);const o=e;n.push("lVT:"+e.listViewType),n.push("vF:"+o.viewFilter),n.push("fVF:"+o.focusedViewFilter),t||(n.push("sC:"+o.sortBy.sortColumn),n.push("sD:"+o.sortBy.sortDirection)),o.categoryName&&n.push("catName:"+o.categoryName),n.push("sT:"+o.scenarioType);break;case 1:n.push("folderId:"+e.folderId);const r=e;n.push("id:"+r.searchNumber),n.push("query:"+r.queryString),n.push("lVT:"+e.listViewType),n.push("sT:"+r.scenarioType);break;case 2:n.push("gId:"+e.folderId);const i=e;n.push("lVT:"+e.listViewType),n.push("vF:"+i.viewFilter);break;case 3:n.push("folderId:"+e.folderId);const c=e;n.push("gId:"+c.groupId),n.push("lVT:"+e.listViewType),n.push("vF:"+c.viewFilter),t||(n.push("sC:"+c.sortBy.sortColumn),n.push("sD:"+c.sortBy.sortDirection))}return n.join(";").toString()}n.d(t,"a",(function(){return o}))},4570:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var o=n(52);function r(e){var t;return!!(e&((null===(t=Object(o.g)().ViewStateConfiguration)||void 0===t?void 0:t.FocusedInboxBitFlags)||0))}function i(e,t){r(t)!==e&&Object(o.x)(n=>{var o;null!=(null===(o=n.ViewStateConfiguration)||void 0===o?void 0:o.FocusedInboxBitFlags)&&(e?n.ViewStateConfiguration.FocusedInboxBitFlags|=t:n.ViewStateConfiguration.FocusedInboxBitFlags&=~t)})}},5320:function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return S})),n.d(t,"a",(function(){return j}));var o=n(25),r=n(4259),i=n(1084),c=n(2733),u=n(4570),a=n(30),d=n(220),s=n(68);let l;function f(){const e=Object(d.a)(),t=e&&Object(o.k)("tri-nudge-consumer"),n=!e&&Object(o.k)("tri-nudge"),r=Object(a.a)().UserOptions.MessageRemindersEnabled;return l||(l=!0,Object(s.p)("Nudge_TenantSetting",{owa_1:r})),r&&(n||t)&&!Object(u.a)(32)}function b(e){return e===Object(i.a)("inbox")||e===Object(i.a)("sentitems")}function O(e,t){if(0!=e.tableQuery.type)return!1;if("All"!=Object(c.Q)(e))return!1;const n=Object(c.n)(e);if(0!=n&&-1!=n)return!1;const o=Object(c.K)(e);return 1==o.sortColumn&&o.sortDirection==r.DESCENDING_SORT_DIR}function S(e){const t=c.Z.tableViews.get(e),n=t.tableQuery.folderId;return!!b(n)&&O(t)}function j(e){if(!b(e))return!1;return O(Object(c.I)())}},5530:function(e){e.exports=JSON.parse('{"c":"qqc","b":"rqc","a":"sqc","f":"tqc","e":"uqc","d":"vqc"}')}}]);
//# sourceMappingURL=owa.99.js.map
self.scriptsLoaded['owa.99.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.99.js'] = (new Date()).getTime();