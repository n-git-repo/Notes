self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.172.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[172],{102:function(e,n,t){"use strict";var i=this&&this.__awaiter||function(e,n,t,i){return new(t||(t=Promise))((function(r,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(s,a)}c((i=i.apply(e,n||[])).next())}))},r=this&&this.__generator||function(e,n){var t,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;s;)try{if(t=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=n.call(e,s)}catch(e){o=[6,e],i=0}finally{t=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(n,"__esModule",{value:!0}),n.throwIfVersionIsNotSupported=n.IsVersonSupportedByHost=n.isPIEHostPresent=n.HostBridge=void 0;var o=function(){function e(){this.nextHandlerId=1,this.registeredHandlers=new Map}return e.prototype.registerHandler=function(e){var n=this,t=this.nextHandlerId;return this.nextHandlerId=this.nextHandlerId+1,this.registeredHandlers.set(t,e),function(){n.unregisterHandler(t)}},e.prototype.RaiseEvent=function(e){this.registeredHandlers.forEach((function(n){n(e)}))},e.prototype.HasHandlers=function(){return 0!==this.registeredHandlers.size},e.prototype.unregisterHandler=function(e){this.registeredHandlers.has(e)&&this.registeredHandlers.delete(e)},e}(),s=function(){function e(){this.nextMessageId=1,this.pendingMessages=new Map,this.eventHandlers=new Map,this.abandonedCallHandlers=new o,this.namespaceVersionChangeHandlers=new o,this.hostNotificationHandlers=new o,this.firstSyncIdCall=!0,this.nextSyncId=1,this.maxMessageId=2147483647}return e.prototype.isNamespaceVersionChange=function(e){return e.isIdRequest&&"version-change"===e.messageName&&-3===e.messageId},e.prototype.onMessageFromHost=function(e){if("app/pie"===e.contentType)if(this.raiseMessageInfoIfNeeded(e,!1),e.isEvent){var n=e.messageName;this.eventHandlers.has(n)&&this.eventHandlers.get(n).RaiseEvent(e.args)}else{var t=e.messageId;if(this.pendingMessages.has(t)){var i=this.pendingMessages.get(t);this.pendingMessages.delete(t),e.abandoned?this.abandonedCallHandlers.RaiseEvent(e.messageName):e.wasSuccessful?i.resolve(i.postProcessing?i.postProcessing(e.message):e.message):i.reject(new Error(e.messageName+":"+e.errorMessage))}else this.isNamespaceVersionChange(e)&&this.namespaceVersionChangeHandlers.RaiseEvent(e.message)}},e.prototype.addMessageToPendingMessages=function(e,n,t){var i=this.nextMessageId;this.nextMessageId=this.nextMessageId===this.maxMessageId?1:this.nextMessageId+1;var r={resolve:e,reject:n,postProcessing:t};return this.pendingMessages.set(i,r),i},e.prototype.invokeIdRequest=function(e,n,t,i,r){var o={contentType:"app/pie",messageName:n,isIdRequest:!0,messageId:this.addMessageToPendingMessages(i,r),message:t};this.raiseMessageInfoIfNeeded(o,!0,!0),e.sendMessageToHost(o)},e.throwPieSyncNotSupported=function(){throw new Error("Synchronous bridge not supported")},e.prototype.getNextSyncId=function(e){this.firstSyncIdCall&&(this.nextSyncId=e.getStartingSyncId(),this.firstSyncIdCall=!1);var n=this.nextSyncId;return this.nextSyncId=this.nextSyncId===Number.MAX_SAFE_INTEGER?1:this.nextSyncId+1,n},e.prototype.invokeOnHostSync=function(n,t,i,r,o,s){if(n.sendMessageToHostSync){var a=this.addMessageToPendingMessages(r,o,s),c={contentType:"app/pie",messageName:t,syncId:this.getNextSyncId(n),messageId:a,message:i};this.raiseMessageInfoIfNeeded(c,!0,!1),n.sendMessageToHostSync(c)}else e.throwPieSyncNotSupported()},e.prototype.invokeOnHost=function(e,n,t,i,r,o){var s={contentType:"app/pie",messageName:n,messageId:this.addMessageToPendingMessages(i,r,o),message:t};this.raiseMessageInfoIfNeeded(s,!0,!0),e.sendMessageToHost(s)},e.prototype.registerForEvent=function(e,n){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new o),this.eventHandlers.get(e).registerHandler(n)},e.prototype.registerForAbandonedCalls=function(e){return this.abandonedCallHandlers.registerHandler(e)},e.prototype.registerForNamespaceVersionChange=function(e){return this.namespaceVersionChangeHandlers.registerHandler(e)},e.prototype.registerForHostMessageNotification=function(e){return this.hostNotificationHandlers.registerHandler(e)},e.prototype.raiseMessageInfoIfNeeded=function(e,n,t){if(this.hostNotificationHandlers.HasHandlers()){var i={isToHost:n,isAsync:t,messageName:e.messageName,isIdRequest:e.isIdRequest,syncId:e.syncId,messageId:e.messageId,isEvent:e.isEvent,wasSuccessful:e.wasSuccessful,abandoned:e.abandoned};this.hostNotificationHandlers.RaiseEvent(i)}},e}(),a=function(){function e(e){this.bridge=e,this.processor=new s,this.instanceId=null,this.namespaceVersions=new Map;var n=function(e){this.namespaceVersions.has(e)&&this.namespaceVersions.delete(e)}.bind(this);this.processor.registerForNamespaceVersionChange(n);var t=function(e){this.processor.onMessageFromHost(e)}.bind(this);this.bridge.addHostMessageHandler(t)}return e.prototype.isUsingBridge=function(e){return this.bridge===e},e.prototype.invokeHost=function(e,n,t){var i=this;return new Promise((function(r,o){i.processor.invokeOnHost(i.bridge,e,n,r,o,t)}))},e.prototype.invokeHostSync=function(e,n,t){var i;return this.processor.invokeOnHostSync(this.bridge,e,n,(function(e){i=e}),(function(e){throw e}),t),i},e.prototype.invokeIdRequestOnHost=function(e,n){var t=this;return new Promise((function(i,r){t.processor.invokeIdRequest(t.bridge,e,n,i,r)}))},e.prototype.registerForEvent=function(e,n){return this.processor.registerForEvent(e,n)},e.prototype.registerForAbandonedCalls=function(e){return this.processor.registerForAbandonedCalls(e)},e.prototype.registerForHostMessageNotification=function(e){return this.processor.registerForHostMessageNotification(e)},e.prototype.getInstanceId=function(){var e=this;return new Promise((function(n,t){e.instanceId?n(e.instanceId):e.invokeIdRequestOnHost("instance","id").then((function(t){e.instanceId=t,n(e.instanceId)})).catch((function(e){t(e)}))}))},e.prototype.getNamespaceVersion=function(e){var n=this;return new Promise((function(t,i){n.namespaceVersions.has(e)?t(n.namespaceVersions.get(e)):n.invokeIdRequestOnHost("version",e).then((function(r){var o=parseFloat(r);isNaN(o)?i("Non numeric version returned"):(n.namespaceVersions.set(e,o),t(o))})).catch((function(e){i(e)}))}))},e}(),c=function(){function e(){}return e.setGlobalPreprocessCheck=function(n){e._globalPreprocessCheck=n},e.isInitializationNeeded=function(n){return!e._implInstance||!e._implInstance.isUsingBridge(n)},e.initialize=function(n){e.isInitializationNeeded(n)&&(e._implInstance=new a(n))},e.resetBridgeForUnitTests=function(){e._implInstance=null},e.reloadBridgeForUnitTests=function(){if(e._implInstance){var n=e._implInstance.bridge;e._implInstance=new a(n)}},e.failBridgeNotInitialized=function(){return new Promise((function(e,n){n(new Error("HostBridge not initialized"))}))},e.invokeHost=function(n,t,o){return i(this,void 0,void 0,(function(){return r(this,(function(i){switch(i.label){case 0:return e._implInstance?e._globalPreprocessCheck?[4,e._globalPreprocessCheck(n)]:[3,2]:[3,3];case 1:i.sent(),i.label=2;case 2:return[2,e._implInstance.invokeHost(n,t,o)];case 3:return[2,e.failBridgeNotInitialized()]}}))}))},e.invokeHostSync=function(n,t,i){if(e._implInstance)return e._implInstance.invokeHostSync(n,t,i);throw new Error("HostBridge not initialized")},e.getInstanceId=function(){return i(this,void 0,void 0,(function(){return r(this,(function(n){return e._implInstance?[2,e._implInstance.getInstanceId()]:[2,e.failBridgeNotInitialized()]}))}))},e.getNamespaceVersion=function(n){return i(this,void 0,void 0,(function(){return r(this,(function(t){return e._implInstance?[2,e._implInstance.getNamespaceVersion(n)]:[2,e.failBridgeNotInitialized()]}))}))},e.registerForEvent=function(n,t){return e._implInstance?e._implInstance.registerForEvent(n,t):null},e.registerForAbandonedCalls=function(n){return e._implInstance?e._implInstance.registerForAbandonedCalls(n):null},e.registerForHostMessageNotification=function(n){return e._implInstance?e._implInstance.registerForHostMessageNotification(n):null},e.throwPieSyncNotSupported=function(){s.throwPieSyncNotSupported()},e._implInstance=null,e._globalPreprocessCheck=null,e}();function u(){return i(this,void 0,void 0,(function(){return r(this,(function(e){return[2,new Promise((function(e){c.getInstanceId().then((function(n){e(!!n)})).catch((function(){e(!1)}))}))]}))}))}function d(e,n,t){return i(this,void 0,void 0,(function(){var i;return r(this,(function(r){switch(r.label){case 0:return[4,u()];case 1:return r.sent()?[4,c.getNamespaceVersion(e)]:[3,3];case 2:if((i=r.sent())>=n&&(!t||i<t))return[2,!0];r.label=3;case 3:return[2,!1]}}))}))}n.HostBridge=c,n.isPIEHostPresent=u,n.IsVersonSupportedByHost=d,n.throwIfVersionIsNotSupported=function(e,n,t){return i(this,void 0,void 0,(function(){return r(this,(function(i){switch(i.label){case 0:return[4,d(e,n,t)];case 1:if(!i.sent())throw new Error("VersionNotSupported for "+e+": "+n+", "+t);return[2]}}))}))}},1094:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var i=t(489),r=t(885),o=t(310);const s=5e4;function a(e){return Object(i.a)(async n=>{const t=Object(o.a)(await e.getMail(n));await Object(r.a)(t,e=>!e.sentItemsViewId.isNil(),s)})}},1212:function(e,n,t){"use strict";t.r(n),t.d(n,"getHxAccount",(function(){return g}));var i=t(354),r=t(154),o=t(10),s=t(22),a=t(563),c=t(626),u=t(1094),d=t(1133),l=t(159);let f,p;const v="GetHxAccountAuthFailure";async function g(e){if(Object(o.i)("disablehx")&&Object(s.e)("ShouldNotBeCallingGetHxAccount"),Object(r.a)("acctmonaccounts")&&Object(o.i)("strictsourceid")&&Object(s.d)("UseGetHxAccountBySourceId"),Object(r.a)("acctmonaccounts")&&Object(o.i)("acctmonaccounts")){if(e)return Object(a.b)(e);{const e=await Object(c.getSelectedSourceId)(),n=await Object(c.getHxAccountBySourceId)(e);if(!n)throw Object(s.d)("GetHxAccountFailed"),new Error("Didn't get selected account by SourceId");return n}}if(!f){const n=await Object(a.c)();if(n.items.length>0)if(e){const t=n.items.filter(n=>n.primarySmtp===e);if(1!==t.length)throw 0===t.length?(Object(s.d)("GetHxAccountFailed"),new Error("Didn't get an account by primarySmtp")):(Object(s.d)("GetHxAccountFailed"),new Error("Get duplicated accounts by primarySmtp"));f=t[0]}else f=n.items[0];else p||(p=async function(){const e=Object(l.a)(),n=await i.b(e);if(n.successful&&n.accessToken&&n.expiresDurationSecondsSinceZero){const e=n.isAad?"OFFICE365":"OUTLOOKDOTCOM";return Object(a.a)(n.email,n.accessToken,n.expiresDurationSecondsSinceZero,e)}throw s.h.warn(`Failed to add initial account for correlationGuid: ${e}`),new Error(`${v} Error retrieving auth token for ${n?n.email:""}`)}()),f=await p,Object(d.a)(f);await Object(u.a)(f)}return f}},1220:function(e,n,t){"use strict";var i;!function(e){e[e.NotSupportedByHx=0]="NotSupportedByHx"}(i||(i={}));const r=(e,n)=>{var t,i;return void 0!==n?(null===(t=null==e?void 0:e.extensions)||void 0===t?void 0:t.hxFallbackReason)===n:void 0!==(null===(i=null==e?void 0:e.extensions)||void 0===i?void 0:i.hxFallbackReason)};var o=t(882);const s=e=>{const n={hxFallbackReason:i.NotSupportedByHx,message:null!=e?e:""};return new o.a(n.message,null,null,null,null,null,n)};t.d(n,"b",(function(){return r})),t.d(n,"a",(function(){return s}))},2930:function(e,n,t){"use strict";var i=t(634);n.a=function(e,n){return Object(i.a)(e,n)}},3129:function(e,n,t){"use strict";var i=t(2);const r={groupListNodesViewStates:new(t(13).ObservableMap)({})},o=Object(i.createStore)("groupListNodesViewState",r)();n.a=o},3251:function(e,n,t){"use strict";var i;!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded",e[e.ErrorLoading=3]="ErrorLoading"}(i||(i={}));var r=t(2);const o={folderTable:new(t(13).ObservableMap)({})},s=Object(r.createStore)("leftNavGroupFoldersStore",o);function a(e){var n;const t=null===(n=s().folderTable)||void 0===n?void 0:n.get(e.toLowerCase());return(null==t?void 0:t.loadingState)||i.Uninitialized}function c(e,n){var t,i,r,o;if(e&&n){const a=null===(i=null===(t=s().folderTable)||void 0===t?void 0:t.get(e.toLowerCase()))||void 0===i?void 0:i.folderHierarchy;return null!==(o=null===(r=null==a?void 0:a.get(n))||void 0===r?void 0:r.DisplayName)&&void 0!==o?o:""}return""}var u=t(3129);function d(e){if(e){const n=u.a.groupListNodesViewStates.get(e.toLowerCase());return null!=n?n:null}return null}function l(e,n){var t;if(e&&n){const i=null===(t=u.a.groupListNodesViewStates.get(e.toLowerCase()))||void 0===t?void 0:t.groupFolderNodeViewStates.get(n);return null!=i?i:null}return null}var f=Object(r.mutatorAction)("updateFolderTable",(e,n)=>{s().folderTable.set(e,n)});function p(e,n){var t;let i="";const r=null===(t=s().folderTable.get(e.toLowerCase()))||void 0===t?void 0:t.folderHierarchy;if(r)for(const e of r.values())if((null==e?void 0:e.WellKnownName)===n){i=e.Id;break}return i}function v(e,n){var t,i;e=e.toLowerCase();const r=null===(t=s().folderTable.get(e))||void 0===t?void 0:t.folderHierarchy;if(r){if(n){return null===(i=r.get(n))||void 0===i?void 0:i.ChildFolderIds}{let n=[];return n.push(p(e,"inbox")),n.push(p(e,"deleteditems")),n}}return[]}function g(e,n){var t,i,r;let o;return e&&n&&(o=null===(r=null===(i=null===(t=s().folderTable)||void 0===t?void 0:t.get(e.toLowerCase()))||void 0===i?void 0:i.folderHierarchy)||void 0===r?void 0:r.get(n)),o}function h(e,n,t){return Object.assign(Object.assign({},e),{ParentFolderDisplayName:t,Depth:n})}function b(e){const n=[];if(e){const t=v(e=e.toLowerCase());if(t){const i=t.map(n=>g(e,n));i&&i.forEach(t=>{t&&(n.push(h(t,1,"")),function e(n,t,i,r,o){for(const s of r){const r=g(t,s);r&&(n.push(h(r,i,o)),e(n,t,i+1,r.ChildFolderIds,r.DisplayName))}}(n,e,2,t.ChildFolderIds,t.DisplayName))})}}return n}function m(e,n){var t,i,r,o;const a=null===(i=null===(t=s().folderTable)||void 0===t?void 0:t.get(e.toLowerCase()))||void 0===i?void 0:i.folderHierarchy;return null!==(o=null===(r=null==a?void 0:a.get(n))||void 0===r?void 0:r.WellKnownName)&&void 0!==o?o:""}function y(e){var n,t;let i=!1;if(!e)return i;const r=null===(n=s().folderTable.get(e.toLowerCase()))||void 0===n?void 0:n.folderHierarchy;if(r)for(const e of r.values()){if("inbox"===(null===(t=e.WellKnownName)||void 0===t?void 0:t.toLowerCase())&&e.ChildFolderCount>0){i=!0;break}}return i}t.d(n,"a",(function(){return i})),t.d(n,"g",(function(){return a})),t.d(n,"f",(function(){return c})),t.d(n,"j",(function(){return d})),t.d(n,"h",(function(){return l})),t.d(n,"l",(function(){return u.a})),t.d(n,"k",(function(){return s})),t.d(n,"n",(function(){return f})),t.d(n,"b",(function(){return b})),t.d(n,"d",(function(){return v})),t.d(n,"c",(function(){return g})),t.d(n,"e",(function(){return p})),t.d(n,"i",(function(){return m})),t.d(n,"m",(function(){return y}))},3424:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var i=t(0),r=t(3680);function o(e,n){const t={query:e,variables:null==n?void 0:n.variables,context:null==n?void 0:n.context};Object(i.useEffect)(()=>(r.a.addRef(t),()=>r.a.releaseRef(t)))}},3425:function(e,n,t){"use strict";t.d(n,"b",(function(){return i})),t.d(n,"a",(function(){return r}));const i=e=>{const n=e||{},t=n.context||{};return n.fetchPolicy=n.fetchPolicy||"cache-first",Object.assign(Object.assign({},n),{context:Object.assign(Object.assign({},t),{isManagedQuery:!0})})},r=e=>{const n=e||{},t=n.context||{};return Object.assign(Object.assign({},n),{context:Object.assign(Object.assign({},t),{isManagedQuery:!0})})}},3680:function(e,n,t){"use strict";var i=t(635),r=t(22),o=t(68),s=t(2930);const a=500,c=-1;function u(){const e=new Map;return{upsert:n=>(function(e,n){const t=e.get(n.key)||[],i=d(t,n);return i!==c?t[i]:(t.push(n),e.set(n.key,t),t.length>a&&Object(o.p)("KVMap.TooBig",{size:t.length,name:n.diag(n.key)}),n)})(e,n),remove:n=>(function(e,n){const t=e.get(n.key),i=d(t,n);t.splice(i,1)})(e,n),get:n=>(function(e,n){const t=e.get(n.key)||[];return t[d(t,n)]})(e,n),clear:()=>e.clear(),count:()=>e.size,forEach:n=>{e.forEach((e,t)=>{e.forEach(e=>n(e))})}}}function d(e,n){let t=c;return e.some((e,i)=>{const r=Object(s.a)(e.variables,n.variables);return r&&(t=i),r}),t}var l=t(595);function f(e){var n;for(const t of e.definitions)if("OperationDefinition"===t.kind)return`${t.operation}:${(null===(n=t.name)||void 0===n?void 0:n.value)||"unknown"}`;return"unknown"}var p=t(10),v=t(3);const g=u(),h=u(),b=new Map,m=3e4;function y(e){e.count=e.count?e.count+1:1}function I(e){e.count=e.count?e.count-1:0}function O(e){const n=new Array;for(const t of e.key.definitions)if("OperationDefinition"===t.kind){if("query"!=t.operation&&"mutation"!=t.operation){Object(r.c)(`cannot track operation of type ${t.operation}`);break}t.selectionSet.selections.forEach(t=>{if("Field"===t.kind){const i=t.name.value,r={};(t.arguments||[]).forEach(n=>{var t;if("Variable"===n.value.kind){const i=n.value.name.value;r[i]=null===(t=e.variables)||void 0===t?void 0:t[i]}}),n.push({key:i,variables:r,diag:k,count:0})}})}return n}const k=e=>e;const w={addRef:function(e){const n=g.upsert({key:e.query,variables:e.variables,context:e.context,diag:f,count:0}),t=O(n).map(h.upsert);y(n),t.forEach(y)},releaseRef:function(e){const n=g.get({key:e.query,variables:e.variables}),t=O(n).map(h.get);I(n),t.forEach(I),0===n.count&&self.setTimeout(()=>(function(e,n){if(!e.disposed&&0===e.count){if(e.sessionId&&!Object(p.i)("disablehx")){Object(i.d)().activeSet.releaseSession(e.sessionId),b.delete(e.sessionId)}e.disposed=!0,g.remove(e);let t=!1;n.forEach(e=>{if(!e.disposed&&0===e.count){const n={id:"ROOT_QUERY",fieldName:e.key,broadcast:!1};e.variables&&!Object(s.a)({},e.variables)&&(n.args=e.variables),Object(l.a)().cache.evict(n),h.remove(e),t=!0,e.disposed=!0}}),t&&Object(l.a)().cache.gc()}})(n,t),m)},getSessionId:function(e){const n=g.upsert({key:e.query,variables:e.variables,context:e.context,diag:f,count:0});if(O(n).forEach(h.upsert),!n.sessionId){const e=Object(p.i)("disablehx")?Object(v.M)():Object(i.d)().activeSet.createSession();n.sessionId=e,b.set(e,{query:n.key,variables:n.variables,context:n.context})}return n.sessionId},getQueryFromSessionId:function(e){return b.get(e)},resetStateForTests:function(){g.clear(),h.clear(),b.clear()}};t.d(n,"a",(function(){return w})),t.d(n,"b",(function(){return u})),t.d(n,"c",(function(){return f}))},3689:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var i=t(487),r=t(3424),o=t(3717),s=t(3425);function a(e,n){const t=Object(s.b)(n);return Object(r.a)(e,t),Object(o.a)(e,t),Object(i.useQuery)(e,t)}},3717:function(e,n,t){"use strict";t.d(n,"a",(function(){return p}));var i=t(64),r=t(5104),o=t(3680),s=t(367),a=t(595),c=t(154),u=t(68),d=t(10);const l=Object(o.b)();let f=!1;function p(e,n){Object(c.a)("nativeResolvers")&&!Object(d.i)("disablehx")&&(f||(Object(s.a)().activeSet.registerHandler(v),f=!0))}const v={onActiveSetChanged:e=>{e.forEach(e=>{e.type!==i.HxActiveSetEventType.ObjectChanged&&e.type!==i.HxActiveSetEventType.ObjectDeleted&&e.type!==i.HxActiveSetEventType.CollectionChanged||e.sessionIds.forEach(e=>{var n;const t=o.a.getQueryFromSessionId(e);t&&"query"===(null===(n=Object(r.a)(t.query))||void 0===n?void 0:n.operation)&&l.upsert(Object.assign(Object.assign({},t),{key:t.query,diag:o.c}))})}),l.count()>0&&self.setTimeout(g,500)}};function g(){const e=Object(a.a)();l.forEach(n=>{const t=(Object(o.c)(n.key)||"unknown")+"_requery",i=new u.b("ApolloLiveQuery");i.addCustomData({opName:t}),e.query({query:n.key,variables:n.variables,context:n.context,fetchPolicy:"network-only"}).then(e=>i.end()).catch(e=>i.endWithError("ClientError",e))}),l.clear()}},3889:function(e,n,t){"use strict";var i=t(3689),r=t(487),o=t(3424),s=(t(3717),t(3425));function a(e,n){const t=Object(s.a)(n);return Object(o.a)(e,t),Object(r.useMutation)(e,t)}t.d(n,"b",(function(){return i.a})),t.d(n,"a",(function(){return a}))},5104:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var i=t(75);function r(e,n){for(var t=null,r=0,o=e.definitions;r<o.length;r++){var s,a=o[r];if(a.kind===i.a.OPERATION_DEFINITION)if(null==n){if(t)return null;t=a}else if((null===(s=a.name)||void 0===s?void 0:s.value)===n)return a}return t}},635:function(e,n,t){"use strict";var i=t(626),r=t(64),o=t(354),s=t(563);async function a(e,n){const t=await o.d(e,function(e){switch(e){case"OFFICE365":return o.a.OFFICE365;case"OUTLOOKDOTCOM":return o.a.OUTLOOKDOTCOM;case"GOOGLE":return o.a.GOOGLE;case"YAHOO":return o.a.YAHOO;case"ICLOUD":return o.a.ICLOUD;case"OTHER":return o.a.OTHER;default:throw new Error(`Add Account not supported for type: ${e}`)}}(n));if(t.successful&&t.accessToken&&t.expiresDurationSecondsSinceZero){return await Object(s.a)(t.email,t.accessToken,t.expiresDurationSecondsSinceZero,n)}throw r.HxEnums.HxAccountCreationFailureType.Err_InvalidCredentials}var c=t(1212),u=t(367),d=t(489);t(310),t(989);var l=t(1094);t.d(n,"c",(function(){return i.getHxAccountBySourceId})),t.d(n,"e",(function(){return i.getPreliminaryHxAccountAndSourceIds})),t.d(n,"f",(function(){return i.getSelectedSourceId})),t.d(n,"h",(function(){return i.selectAccountSource})),t.d(n,"a",(function(){return a})),t.d(n,"b",(function(){return c.getHxAccount})),t.d(n,"d",(function(){return u.a})),t.d(n,"g",(function(){return d.a})),t.d(n,"i",(function(){return l.a}))},7620:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));const i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CreateFolder"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"parentId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"displayName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createFolder"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"parentId"},value:{kind:"Variable",name:{kind:"Name",value:"parentId"}}},{kind:"ObjectField",name:{kind:"Name",value:"displayName"},value:{kind:"Variable",name:{kind:"Name",value:"displayName"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"FolderId"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AccessDenied"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"message"}}]}}]}}]}}]}},885:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var i=t(64),r=t(489),o=t(367),s=t(1131);function a(e,n,t,a){return Object(r.a)(async r=>{const c=e.objectId;if(e=await Object(o.a)().activeSet.getObject(c,r),n(e))return Promise.resolve(e);return Object(s.a)(e=>{if(e.type===i.HxActiveSetEventType.ObjectChanged&&e.object.objectId.isEqual(c)&&n(e.object))return e.object},t,a)})}}}]);
//# sourceMappingURL=owa.172.js.map
self.scriptsLoaded['owa.172.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.172.js'] = (new Date()).getTime();