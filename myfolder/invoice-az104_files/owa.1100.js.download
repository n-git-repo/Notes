self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.1100.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[1100],{11067:function(e,n,t){"use strict";t.d(n,"b",(function(){return i})),t.d(n,"c",(function(){return r})),t.d(n,"a",(function(){return o})),t.d(n,"d",(function(){return c}));const i="mailtoHandlerIgnoredCount",r=14,o=6048e5,c={"https://outlook-sdf.office.com":"AoxP1SeWYDYaKSqgQMEvcNV6+kiHTEA8E7F9FjDjLwt7H0aRzgY65MUDyudqsVVEU4fc3e3gWdo0W2cPQO6iAKYAAAB6eyJvcmlnaW4iOiJodHRwczovL291dGxvb2stc2RmLm9mZmljZS5jb206NDQzIiwiaXNTdWJkb21haW4iOnRydWUsImZlYXR1cmUiOiJQYXJzZVVybFByb3RvY29sSGFuZGxlciIsImV4cGlyeSI6MTYyODcxMDg1NX0=","https://outlook.office.com":"ArohrU+3nrD+36RWgvyIVASpPMV5qmL2aBKg/vdjAPsb74oW+ljPFdkdIMWDND2sIN67kbxraiSt5lnF+SyovEMAAAB2eyJvcmlnaW4iOiJodHRwczovL291dGxvb2sub2ZmaWNlLmNvbTo0NDMiLCJpc1N1YmRvbWFpbiI6dHJ1ZSwiZmVhdHVyZSI6IlBhcnNlVXJsUHJvdG9jb2xIYW5kbGVyIiwiZXhwaXJ5IjoxNjI4NzEwODgxfQ==","https://outlook-sdf.live.com":"AuUoPvZX8c3JfzbLy7x7DfhA112kexySjZL3RNuqj+tiOK9dItPzWZENDwOa8vH0W0YvqCu1XsmKAGqbhVGLBakAAAB4eyJvcmlnaW4iOiJodHRwczovL291dGxvb2stc2RmLmxpdmUuY29tOjQ0MyIsImlzU3ViZG9tYWluIjp0cnVlLCJmZWF0dXJlIjoiUGFyc2VVcmxQcm90b2NvbEhhbmRsZXIiLCJleHBpcnkiOjE2Mjg3MTI3MTV9","https://outlook.live.com":"AuLB2GUe2LClDSVyaFtvIFySHIjhldxQuohbvtoqo1W8RQTQRTDuyE0y8lwoDKsUj50ta4qmsIpdjcgPzluIzIUAAAB0eyJvcmlnaW4iOiJodHRwczovL291dGxvb2subGl2ZS5jb206NDQzIiwiaXNTdWJkb21haW4iOnRydWUsImZlYXR1cmUiOiJQYXJzZVVybFByb3RvY29sSGFuZGxlciIsImV4cGlyeSI6MTYyODcxMjczMn0="}},1204:function(e,n,t){"use strict";var i=t(21),r=t(875),o=t(0),c=t.n(o),a=t(1091);function l(e,n){const t=(n,t)=>c.a.createElement(s,Object.assign({},n),c.a.createElement(e,Object.assign({},n)));return t.displayName=e.displayName,n?c.a.forwardRef(t):t}const s=Object(i.a)((function(e){const{lid:n,when:t,series:i,children:o,disposeOnUnmount:l=!0}=e;return c.a.useEffect(()=>(Object(r.b)(n,t,i),()=>{l&&r.c.importAndExecute(n)}),[]),o&&Object(a.a)(n)?c.a.createElement(c.a.Fragment,null,o):null}));var u=t(1445);t.d(n,"c",(function(){return l})),t.d(n,"a",(function(){return s})),t.d(n,"e",(function(){return a.a})),t.d(n,"d",(function(){return u.a})),t.d(n,"b",(function(){return r.a}))},1467:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var i=t(68),r=t(942);function o(e,n){Object.keys(r.a).some(t=>r.a[t]==n&&(Object(i.p)(e,{key:t,id:n},{isCore:!0}),!0))}},19883:function(e,n,t){"use strict";t.r(n);var i=t(21),r=t(0),o=t(1204),c=t(20);const a=new c.c(()=>t.e(1198).then(t.bind(null,20200)));let l=Object(c.d)(a,e=>e.IrisUpsellBanner);var s=t(9602);const u=new c.c(()=>t.e(1089).then(t.bind(null,20201))),d=Object(c.d)(u,e=>e.MailtoProtocolUpsellBanner);var b,f=t(2);!function(e){e.IrisUpsell="IrisUpsell",e.OWAMailHandlerUpsell="OWAMailHandlerUpsell",e.CommercialBizBar="CommercialBizBar",e.None=""}(b||(b={}));let m=Object(f.createStore)("UpsellBannerState",{upsellBannerType:b.None})();var O=t(25),j=t(9596),w=Object(f.mutatorAction)("setUpsellBannerType",e=>{m.upsellBannerType=e}),v=t(107),h=t(7684),g=t(154),p=t(30);const I=async function(){var e=await h.e.importAndExecute();return Object(O.k)("fwk-mailtoProtocolHandler")&&Object(g.a)("showOWAMailtoBanner")&&Object(s.a)()&&Object(s.b)()?(w(b.OWAMailHandlerUpsell),!0):Object(O.k)("iris-commercial-bizbar")&&Object(v.q)()&&e?y(b.CommercialBizBar):!(Object(v.l)()||Object(v.f)()||Object(v.r)()||Object(v.n)()||!Object(O.k)("edge-iris-upsell-experiment"))&&y(b.IrisUpsell)};async function y(e){const{IsConsumerChild:n}=Object(p.a)();if(n)return!1;let t=await j.b.import();return(null==t?void 0:t.message)||await j.c.importAndExecute(),w(e),!!t.message}const U=Object(i.a)((function(){const[e,n]=r.useState(!1);if(r.useEffect(()=>{!async function(){let e=await I();n(e)}()},[]),e)switch(m.upsellBannerType){case b.CommercialBizBar:return r.createElement(l,{lid:o.b.CommercialBizBar});case b.IrisUpsell:return r.createElement(l,{lid:o.b.EdgeUpsell});case b.OWAMailHandlerUpsell:return r.createElement(d,{lid:o.b.MailtoProtocolHandler});default:return r.createElement("div",null)}return null}));t.d(n,"TopUpsellBanner",(function(){return U}))},7684:function(e,n,t){"use strict";t.d(n,"c",(function(){return o})),t.d(n,"d",(function(){return c})),t.d(n,"e",(function(){return a})),t.d(n,"f",(function(){return l})),t.d(n,"a",(function(){return s})),t.d(n,"b",(function(){return u}));var i=t(20);const r=new i.c(()=>Promise.all([t.e(0),t.e(1137)]).then(t.bind(null,11750)));let o=new i.a(r,e=>e.isFeedbackPolicyEnabled),c=new i.a(r,e=>e.isNpsSurveyPolicyEnabled),a=new i.a(r,e=>e.isOutlookRecommendationEnabled),l=new i.a(r,e=>e.isScreenshotPolicyEnabled),s=new i.a(r,e=>e.isContactPolicyEnabled),u=new i.a(r,e=>e.isContentPolicyEnabled)},875:function(e,n,t){"use strict";var i=t(315),r=t(22),o=t(7),c=t(13),a=t(2),l=Object(a.mutatorAction)("initializeLightning",(function(e){if(r.h.info("initialize lightning store"),Object(i.a)().lastShownId=null,Object(i.a)().lightedCount=0,Object(i.a)().unseenItems=new c.ObservableMap,e)for(let n of e)Object(i.a)().unseenItems.set(n.identity,n)}));var s=t(155);const u="ows/v1.0/lightning/items/unseen";function d(){return r.h.info("initialize lightning from server"),Object(s.b)(u).then(e=>{let n=e.map(b);l(n)})}function b(e){return e.category?{identity:e.id,visible:!1,category:e.category}:{identity:e,visible:!1}}var f=t(30);let m;const O="lightning",j="UnseenLightening";function w(){if(!m){const n=Object(o.c)(O);if(n)m=function(e){r.h.info("initialize lightning from override query parameter");let n=e.split(",").map(e=>({identity:e,visible:!1}));return l(n),Promise.resolve()}(n);else{let n=Object(f.a)().PrimeSettings;if(null==n?void 0:n.Items)for(let t of n.Items)if(t.Id===j&&t.Value){e=t.Value,r.h.info("initialize lightning from session data"),l(e.map(e=>({identity:e.id,visible:!1,category:e.category}))),m=Promise.resolve();break}m||(m=d())}}var e;return m}var v=t(1467);let h=Object(a.action)("lightup",e=>({id:e}));var g=h;Object(a.mutator)(h,e=>{r.h.info(`lightup - id:${e.id}`),Object(i.a)().lastShownId=e.id,Object(i.a)().lightedCount++;const n=Object(i.a)().unseenItems.get(e.id);n&&(n.visible=!0)}),Object(a.orchestrator)(h,(function(e){Object(v.a)("LIGHTUP",e.id)}));var p,I=t(483);function y(e,n){if(r.h.info(`lightupOrReject - id:${e}, recurrenceCount:${n}, lightedCount:${Object(i.a)().lightedCount}, lastShown:${Object(i.a)().lastShownId}`),Object(I.w)())return void r.h.info("lightning is disabled for deeplink");if(!Object(i.a)().unseenItems.has(e))return;(!Object(i.a)().lastShownId||function(e,n){let t=!1;const{lastShownId:r}=Object(i.a)();if(r&&n&&!function(){const{lastShownId:e,unseenItems:n}=Object(i.a)();return e&&n.has(e)&&n.get(e).visible}()){let i=n.indexOf(r),o=n.indexOf(e);i>=0&&i+1==o&&(t=!0)}return t}(e,n)||function(e){const n=Object(i.a)().unseenItems.get(e);return!!n&&n.category==p.UIFeatureDiscovery}(e)||function(e){const n=Object(i.a)().unseenItems.get(e);return!!n&&n.category==p.Compliance}(e))&&g(e)}function U(e,n,t){r.h.info(`beginLightning - id:${e}`),n(()=>{w().then(()=>y(e,t)).catch(n=>{r.h.warn(`something is wrong, lightning id:${e}, reason:${n}`)})})}!function(e){e.None="0",e.UpSell="1",e.FeatureDiscovery="2",e.TeachingMoment="3",e.UITeachingMoment="4",e.UIFeatureDiscovery="5",e.UIUpSell="6",e.JITNewUser="7",e.Compliance="8",e.SatCoreMetric="9",e.UpSellExperiment="10"}(p||(p={}));var A=t(942),B=t(1092);t.d(n,"d",(function(){return i.b})),t.d(n,"b",(function(){return U})),t.d(n,"a",(function(){return A.a})),t.d(n,"c",(function(){return B.a}))},9596:function(e,n,t){"use strict";t.d(n,"c",(function(){return o})),t.d(n,"d",(function(){return c})),t.d(n,"a",(function(){return a})),t.d(n,"b",(function(){return l})),t.d(n,"f",(function(){return s})),t.d(n,"e",(function(){return u}));var i=t(20);const r=new i.c(()=>Promise.all([t.e(0),t.e(1177)]).then(t.bind(null,13308)));let o=new i.a(r,e=>e.initializeUpsellBarState),c=new i.a(r,e=>e.initializeLeftNavUpsellState),a=new i.b(r,e=>e.ArcStore),l=new i.b(r,e=>e.BizBarArcStore),s=new i.a(r,e=>e.makeImpressionCall),u=new i.a(r,e=>e.makeBeaconCall)},9602:function(e,n,t){"use strict";t.d(n,"a",(function(){return c})),t.d(n,"c",(function(){return a})),t.d(n,"b",(function(){return l}));var i=t(11067),r=t(11),o=t(107);function c(){var e;return!!(null===(e=null===window||void 0===window?void 0:window.navigator)||void 0===e?void 0:e.registerProtocolHandler)}function a(){if(!Object(r.b)(window,"MailToBannerAskAgainLater")){const e=Object(r.a)(window,i.b);if(e){const n=parseInt(e);Object(r.e)(window,i.b,(n+1).toString())}else Object(r.e)(window,i.b,"1")}}function l(){if(Object(o.h)()||Object(o.j)())return!1;if(Object(r.c)(window)){if(Object(r.b)(window,"MailToBannerTryItNow")||Object(r.b)(window,"MailToBannerClose"))return!1;if(Object(r.b)(window,"MailToBannerAskAgainLater"))return(new Date).getTime()-Number(Object(r.a)(window,"MailToBannerAskAgainLater"))>=i.a;{const e=Object(r.a)(window,i.b);return!e||parseInt(e)<=i.c}}return!1}}}]);
//# sourceMappingURL=owa.1100.js.map
self.scriptsLoaded['owa.1100.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.1100.js'] = (new Date()).getTime();