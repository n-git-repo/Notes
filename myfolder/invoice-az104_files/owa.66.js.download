self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.66.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[66],{1112:function(e,n,t){"use strict";var a=t(24),i=t(1115),r=t(961),o=t(5),d=t(79);function c(e){return e.ParentFolderId&&e.ParentFolderId.Id===Object(d.h)()}function l(e){if(!e.ParentFolderId)return!1;const n=Object(d.x)(),t=Object(d.l)(e.ParentFolderId.Id);return(null==t?void 0:t.ParentGroupId)===(null==n?void 0:n.ParentGroupId)}function s(e,n){let t=Object(r.a)(e);if(t!=Object(r.a)(n))return t?-1:1;let a=f(n)-f(e);if(0!=a)return a;if(a=Object(o.w)(e.Start,n.Start),0!=a)return a;if(m(e)&&m(n)){let t=c(e);if(t!=c(n))return t?-1:1;let a=l(e);if(a!=l(n))return a?-1:1}return a=Object(i.a)(e,n),0!=a?a:(a=Object(o.w)(n.End,e.End),0!=a?a:(a=u(e.Subject,n.Subject),0!=a?a:(a=u(e.CalendarItemType,n.CalendarItemType),0!=a?a:(a=u(e.ParentFolderId.Id,n.ParentFolderId.Id),0!=a?a:u(e.ItemId.Id,n.ItemId.Id)))))}function u(e,n){return(e||"").localeCompare(n||"")}function f(e){let n=Object(o.w)(e.End,e.Start);return Math.max(Math.ceil(n/a.e),1)}function m(e){return"Booking"!=e.__type&&"AnonymousCalendarEvent"!=e.__type}t.d(n,"a",(function(){return s}))},1113:function(e,n,t){"use strict";var a=t(20);function i(e,n){var t,a;return!!e&&!!n&&(null===(t=e.shareLinkInfo)||void 0===t?void 0:t.url)===(null===(a=n.shareLinkInfo)||void 0===a?void 0:a.url)&&e.isShared===n.isShared&&e.collabAllowed===n.collabAllowed&&e.resourceId===n.resourceId}var r=t(22);const o=e=>{let n=null,t=null,a=null;if(e)try{const i=JSON.parse(e);if(i){const{location:e,metadata:r}=i;n=e,r&&(t="Enabled"===r.state,a=r.isShared)}}catch(n){r.h.warn("Unable to parse collab space extended property: "+e)}return{shareLinkInfo:{url:(null==n?void 0:n.length)>0?n:null,linkId:null},collabAllowed:(null==n?void 0:n.length)>0?t:null,isShared:(null==n?void 0:n.length)>0?a:null,changeKey:null,resourceId:null}};function d(e){var n,t,a;return e&&!e.IsDraft&&(!(null===(n=e.CollabSpace)||void 0===n?void 0:n.changeKey)||0===(null===(a=null===(t=e.CollabSpace)||void 0===t?void 0:t.changeKey)||void 0===a?void 0:a.length))}var c=t(25);function l(e,n){var t,a,i,r;if(!e)return!1;return(n?Object(c.k)("cal-meeting-recap"):Object(c.k)("cal-fluid-collabObject"))&&!!e.UID&&!!(null===(a=null===(t=e.Organizer)||void 0===t?void 0:t.Mailbox)||void 0===a?void 0:a.EmailAddress)&&!!(null===(r=null===(i=e.ItemId)||void 0===i?void 0:i.mailboxInfo)||void 0===r?void 0:r.userIdentity)}t.d(n,"d",(function(){return u})),t.d(n,"c",(function(){return f})),t.d(n,"b",(function(){return m})),t.d(n,"e",(function(){return v})),t.d(n,"a",(function(){return i})),t.d(n,"f",(function(){return o})),t.d(n,"g",(function(){return d})),t.d(n,"h",(function(){return l}));const s=new a.c(()=>t.e(1039).then(t.bind(null,19997))),u=new a.a(s,e=>e.parseCollabObject),f=new a.a(s,e=>e.isCollabAllowedInEvent),m=new a.a(s,e=>e.createCollabObject),v=new a.a(s,e=>e.updateMeetingNotes)},1115:function(e,n,t){"use strict";var a=t(975);n.a=(e,n)=>Object(a.a)(e.FreeBusyType)-Object(a.a)(n.FreeBusyType)},1116:function(e,n,t){"use strict";var a=t(391),i=t(25),r=t(5);var o=t(381),d=t(35);function c(e,n){var t;return void 0===e||e.__type||(t=e,e=Object.assign({__type:"ExpandCalendarEventJsonRequest:#Exchange"},t)),Object(d.a)("ExpandCalendarEvent",e,n)}var l=t(167);async function s(e,n){const t={Header:Object(l.b)(),Body:(d={EventId:Object(o.a)({Id:e.Id}),WindowStart:Object(r.sb)(n.start),WindowEnd:Object(r.sb)(n.end),ReturnMaster:!0,ReturnRegularOccurrences:!0,ReturnExceptions:!0,ReturnCancellations:!0,IncludeDeclinedMeetings:Object(i.k)("cal-surface-declinedMeetings")},Object.assign({__type:"ExpandCalendarEventRequest:#Exchange"},d))};var d;return(await c(t,Object(a.a)(e.mailboxInfo))).Body}t.d(n,"a",(function(){return s}))},1120:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"AllEnhancedLocationFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EnhancedLocation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"DisplayName"}},{kind:"Field",name:{kind:"Name",value:"Annotation"}},{kind:"Field",name:{kind:"Name",value:"PostalAddress"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Street"}},{kind:"Field",name:{kind:"Name",value:"City"}},{kind:"Field",name:{kind:"Name",value:"State"}},{kind:"Field",name:{kind:"Name",value:"Country"}},{kind:"Field",name:{kind:"Name",value:"PostalCode"}},{kind:"Field",name:{kind:"Name",value:"PostOfficeBox"}},{kind:"Field",name:{kind:"Name",value:"Type"}},{kind:"Field",name:{kind:"Name",value:"Latitude"}},{kind:"Field",name:{kind:"Name",value:"Longitude"}},{kind:"Field",name:{kind:"Name",value:"Accuracy"}},{kind:"Field",name:{kind:"Name",value:"Altitude"}},{kind:"Field",name:{kind:"Name",value:"AltitudeAccuracy"}},{kind:"Field",name:{kind:"Name",value:"FormattedAddress"}},{kind:"Field",name:{kind:"Name",value:"LocationUri"}},{kind:"Field",name:{kind:"Name",value:"LocationSource"}}]}},{kind:"Field",name:{kind:"Name",value:"Id"}},{kind:"Field",name:{kind:"Name",value:"IdType"}},{kind:"Field",name:{kind:"Name",value:"LocationType"}}]}}]}},1122:function(e,n,t){"use strict";var a=t(1532),i=t(1533),r=t(79),o=t(201),d=t(421),c=t(595),l=t(25),s=t(1125),u=t(1120),f=t(1525);const m={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"FullCalendarEventFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CalendarEvent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"PartialCalendarEventFragment"}},{kind:"Field",name:{kind:"Name",value:"Body"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"BodyType"}},{kind:"Field",name:{kind:"Name",value:"Value"}},{kind:"Field",name:{kind:"Name",value:"QuotedText"}},{kind:"Field",name:{kind:"Name",value:"IsTruncated"}},{kind:"Field",name:{kind:"Name",value:"UTF8BodySize"}},{kind:"Field",name:{kind:"Name",value:"BodyFragmentInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"StartOffset"}},{kind:"Field",name:{kind:"Name",value:"EndOffset"}}]}},{kind:"Field",name:{kind:"Name",value:"DataUriCount"}},{kind:"Field",name:{kind:"Name",value:"CustomDataUriCount"}}]}},{kind:"Field",name:{kind:"Name",value:"ConversationId"}},{kind:"Field",name:{kind:"Name",value:"DocLinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ProviderType"}},{kind:"Field",name:{kind:"Name",value:"Url"}},{kind:"Field",name:{kind:"Name",value:"PermissionType"}}]}},{kind:"Field",name:{kind:"Name",value:"EffectiveRights"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"CreateAssociated"}},{kind:"Field",name:{kind:"Name",value:"CreateContents"}},{kind:"Field",name:{kind:"Name",value:"CreateHierarchy"}},{kind:"Field",name:{kind:"Name",value:"Delete"}},{kind:"Field",name:{kind:"Name",value:"Modify"}},{kind:"Field",name:{kind:"Name",value:"Read"}},{kind:"Field",name:{kind:"Name",value:"ViewPrivateItems"}}]}},{kind:"Field",name:{kind:"Name",value:"EntityNamesMap"}},{kind:"Field",name:{kind:"Name",value:"HasBlockedImages"}},{kind:"Field",name:{kind:"Name",value:"InReplyTo"}},{kind:"Field",name:{kind:"Name",value:"LastModifiedTime"}},{kind:"Field",name:{kind:"Name",value:"TailoredXpEntities"}},{kind:"Field",name:{kind:"Name",value:"AppointmentReplyName"}},{kind:"Field",name:{kind:"Name",value:"AppointmentReplyTime"}},{kind:"Field",name:{kind:"Name",value:"AutoRoomBookingStatus"}},{kind:"Field",name:{kind:"Name",value:"ClientSeriesId"}},{kind:"Field",name:{kind:"Name",value:"DoNotForwardMeeting"}},{kind:"Field",name:{kind:"Name",value:"ExtractionSourceId"}},{kind:"Field",name:{kind:"Name",value:"InboxReminders"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"}},{kind:"Field",name:{kind:"Name",value:"ReminderOffset"}},{kind:"Field",name:{kind:"Name",value:"Message"}},{kind:"Field",name:{kind:"Name",value:"IsOrganizerReminder"}},{kind:"Field",name:{kind:"Name",value:"OccurrenceChange"}},{kind:"Field",name:{kind:"Name",value:"IsImportedFromOLC"}},{kind:"Field",name:{kind:"Name",value:"SendOption"}}]}},{kind:"Field",name:{kind:"Name",value:"IntendedFreeBusyStatus"}},{kind:"Field",name:{kind:"Name",value:"IsRoomRequested"}},{kind:"Field",name:{kind:"Name",value:"JoinOnlineMeetingUrl"}},{kind:"Field",name:{kind:"Name",value:"Locations"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AllEnhancedLocationFields"}}]}},{kind:"Field",name:{kind:"Name",value:"OnlineMeetingProvider"}},{kind:"Field",name:{kind:"Name",value:"OnlineMeetingConferenceId"}},{kind:"Field",name:{kind:"Name",value:"OnlineMeetingTollNumber"}},{kind:"Field",name:{kind:"Name",value:"OnlineMeetingTollFreeNumbers"}},{kind:"Field",name:{kind:"Name",value:"RequiredAttendees"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AllAttendeeFields"}}]}},{kind:"Field",name:{kind:"Name",value:"OptionalAttendees"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AllAttendeeFields"}}]}},{kind:"Field",name:{kind:"Name",value:"Resources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AllAttendeeFields"}}]}},{kind:"Field",name:{kind:"Name",value:"AppendOnSend"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"txt"}},{kind:"Field",name:{kind:"Name",value:"typ"}},{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"CollabSpace"}},{kind:"Field",name:{kind:"Name",value:"FlexEventsMetadata"}},{kind:"Field",name:{kind:"Name",value:"IsBookedFreeBlocks"}},{kind:"Field",name:{kind:"Name",value:"TravelTimeEventsLinked"}},{kind:"Field",name:{kind:"Name",value:"PersonId"}}]}},...s.a.definitions,...u.a.definitions,...f.a.definitions]},v={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"FullCalendarEvent"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EventRequestTypeParameters"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullCalendarEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"calendarEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"FullCalendarEventFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"error"}},{kind:"Field",name:{kind:"Name",value:"responseCode"}}]}}]}},...m.definitions]},b={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"FullBirthdayCalendarEvent"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"BirthdayEventRequestTypeParameters"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullBirthdayCalendarEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"calendarEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"FullCalendarEventFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"error"}},{kind:"Field",name:{kind:"Name",value:"responseCode"}}]}}]}},...m.definitions]};var I=t(5),O=t(982);async function j(e,n,t,s=!1){if(Object(l.k)("mon-cal-loadEventsViaGql"))return async function(e,n,t,a=!1){const i=Object(r.l)(n);if(i&&3==i.CalendarFolderType){const t=Object(o.h)(n),a=Object(c.a)(),i=await a.query({query:b,variables:{input:{id:e,parentFolderId:n,dateRange:{start:Object(I.vb)(t.start),end:Object(I.vb)(t.end)}}}});return Object.assign(Object.assign({},i.data.fullBirthdayCalendarEvent),{calendarEvent:Object(O.a)(i.data.fullBirthdayCalendarEvent.calendarEvent)})}{const o=Object(r.N)(i),d=Object(c.a)(),l=await d.query({query:v,variables:{input:{id:{mailboxInfo:e.mailboxInfo,Id:e.Id,ChangeKey:e.ChangeKey},parentFolderId:o?n:void 0,shape:t,fetchMasterItemFromOccurence:a}}});return Object.assign(Object.assign({},l.data.fullCalendarEvent),{calendarEvent:Object(O.a)(l.data.fullCalendarEvent.calendarEvent)})}}(e,n,t,s);const u=Object(r.l)(n);let f;if(u&&3==u.CalendarFolderType){const t=Object(o.h)(n);return f=await Object(i.a)(e),f.calendarEvent?Object.assign(Object.assign({},f),{calendarEvent:Object(d.b)(f.calendarEvent,n,t,e.mailboxInfo)}):f}{const i=Object(r.N)(u);return f=await Object(a.a)(e,i?n:void 0,t,s),f.calendarEvent&&(f.calendarEvent=Object(d.a)(f.calendarEvent,e.mailboxInfo)),f}}t.d(n,"a",(function(){return j}))},1123:function(e,n,t){"use strict";t.d(n,"b",(function(){return k})),t.d(n,"a",(function(){return y}));var a=t(893),i=t(99),r=t(210),o=t(648),d=t(79),c=t(368),l=t(122),s=t(254),u=t(1128),f=t(201),m=t(983),v=t(22),b=t(1124);const I={};function O(e){I[e]||(I[e]=[])}function j(e,n){O(e);const t=I[e];for(let e=0;e<t.length;e++)if(n(t[e]))return{index:e,info:t[e]};return{index:-1,info:null}}function p(e,n){return j(e,e=>Object(l.c)(e.dateRange,n,!0))}function k(e){return O(e),I[e].map(e=>e.dateRange)}function y(e,n,t){const c=Object(f.g)(e,n);if(null===t)return{fetchPromise:new Promise(async e=>e([]))};!function(e,n,t){var a,i;const{info:r}=function(e,n){return j(e,e=>e.lockIds.indexOf(n)>-1)}(e,t);if(r){const e=1==r.lockIds.length,t=Object(l.c)(r.dateRange,n,!0);e&&!t&&(null===(i=null===(a=r.requestPromises)||void 0===a?void 0:a.cancelEnhancedFetchPromise)||void 0===i||i.call(a))}}(n,t,e);const{info:v}=p(n,t);if(c&&c.lockedDateRange&&Object(l.c)(c.lockedDateRange,t,!0)){const i=Object(d.t)(n);Object(r.j)(e,i,"Loaded");const o=Object(a.a)(e,n,t);let c=E(o,n,t,v);return{fetchPromise:Promise.resolve(o),enhancedFetchPromise:c,events:o}}{const a=function(e,n){const t=Object(f.d)(e),a=Object(f.f)(e);return t.some(e=>Object(l.c)(e,n,!0))&&a?Object(b.a)(Object(s.j)(n,a.events)).map(e=>Object.assign({},e)):null}(n,t);if(a){const i=g(e,n,t,Promise.resolve(a),"existing");let o=E(a,n,t,v);return null==i||i.then(t=>{const a=Object(d.t)(n);Object(r.j)(e,a,"Loaded")}),{fetchPromise:i,enhancedFetchPromise:o,events:a}}if(null==v?void 0:v.requestPromises){const{fetchPromise:a,enhancedFetchPromise:i}=v.requestPromises;return v.lockIds.push(e),{fetchPromise:g(e,n,t,null==a?void 0:a.then(e=>e?e.filter(({Start:e,End:n})=>0==Object(l.j)(t,{start:e,end:n},!0)):[]),"new"),enhancedFetchPromise:null==i?void 0:i.then(e=>F(t)(e)),events:null}}!function(e,n,t){O(n),I[n].push({dateRange:t,requestPromises:null,lockIds:[e]})}(e,n,t);const c=function(e,n,t){const a=Object(u.a)(n,e,t,o.c);return{fetchPromise:(async()=>{try{return await(null==a?void 0:a.fetchPromise)}finally{!function(e,n){const{index:t}=p(e,n);-1!==t&&I[e].splice(t,1)}(e,n)}})(),enhancedFetchPromise:null==a?void 0:a.enhancedFetchPromise}}(n,t,function(e,n){return(t,a)=>{const{index:i,info:o}=p(e,n);-1!==i&&o.lockIds.forEach(e=>{Object(r.j)(e,t,a)})}}(n,t)),j=null==c?void 0:c.fetchPromise,k=null==c?void 0:c.enhancedFetchPromise;!function(e,n,t){const{index:a,info:i}=p(e,n);-1!==a&&(i.requestPromises=t)}(n,t,c);const y=g(e,n,t,j,"new");return{fetchPromise:y,enhancedFetchPromise:async function(e,n,t,a){const[r]=await Promise.all([t,a]);r&&(Object(m.a)(e,n),Object(i.m)(r));return r}(n,t,k,y),events:null}}}function E(e,n,t,a){var i;let r=null;if(n===Object(d.h)())if(Object(m.b)(n,t)&&e)r=Promise.resolve(e);else if(null===(i=null==a?void 0:a.requestPromises)||void 0===i?void 0:i.enhancedFetchPromise){const{enhancedFetchPromise:e}=a.requestPromises;r=e.then(F(t))}else v.h.warn("[loadEnhancedEvents] - Failed to load GetCalendarView++ events on an existing lock.");return r}async function g(e,n,t,a,r){const o=await a,d=o?o.length:"no";return Object(c.a)({lockId:e,updateMessage:`Fetched ${d} ${r} items for date range: ${t.start} - ${t.end}`}),o&&Object(i.b)(e,n,t,o),o}function F(e){return n=>n?n.filter(({Start:n,End:t})=>!(!n||!t)&&0==Object(l.j)(e,{start:n,end:t},!0)):[]}},1124:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var a=t(338);function i(e){return e.filter(e=>!Object(a.K)(e.CalendarItemType))}},1125:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var a=t(1120),i=t(1524);const r={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"PartialCalendarEventFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CalendarEvent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"ItemId"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mailboxInfo"}},{kind:"Field",name:{kind:"Name",value:"Id"}}]}},{kind:"Field",name:{kind:"Name",value:"Categories"}},{kind:"Field",name:{kind:"Name",value:"EffectiveRights"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"CreateAssociated"}},{kind:"Field",name:{kind:"Name",value:"CreateContents"}},{kind:"Field",name:{kind:"Name",value:"CreateHierarchy"}},{kind:"Field",name:{kind:"Name",value:"Delete"}},{kind:"Field",name:{kind:"Name",value:"Modify"}},{kind:"Field",name:{kind:"Name",value:"Read"}},{kind:"Field",name:{kind:"Name",value:"ViewPrivateItems"}}]}},{kind:"Field",name:{kind:"Name",value:"HasAttachments"}},{kind:"Field",name:{kind:"Name",value:"InstanceKey"}},{kind:"Field",name:{kind:"Name",value:"IsDraft"}},{kind:"Field",name:{kind:"Name",value:"ParentFolderId"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"}},{kind:"Field",name:{kind:"Name",value:"mailboxInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"Preview"}},{kind:"Field",name:{kind:"Name",value:"ReminderIsSet"}},{kind:"Field",name:{kind:"Name",value:"ReminderMinutesBeforeStart"}},{kind:"Field",name:{kind:"Name",value:"Sensitivity"}},{kind:"Field",name:{kind:"Name",value:"Subject"}},{kind:"Field",name:{kind:"Name",value:"CalendarItemType"}},{kind:"Field",name:{kind:"Name",value:"CharmId"}},{kind:"Field",name:{kind:"Name",value:"End"}},{kind:"Field",name:{kind:"Name",value:"EndTimeZoneId"}},{kind:"Field",name:{kind:"Name",value:"ExperienceType"}},{kind:"Field",name:{kind:"Name",value:"FreeBusyType"}},{kind:"Field",name:{kind:"Name",value:"HideAttendees"}},{kind:"Field",name:{kind:"Name",value:"IsAllDayEvent"}},{kind:"Field",name:{kind:"Name",value:"IsMeeting"}},{kind:"Field",name:{kind:"Name",value:"IsCancelled"}},{kind:"Field",name:{kind:"Name",value:"IsOnlineMeeting"}},{kind:"Field",name:{kind:"Name",value:"IsOrganizer"}},{kind:"Field",name:{kind:"Name",value:"IsRecurring"}},{kind:"Field",name:{kind:"Name",value:"IsResponseRequested"}},{kind:"Field",name:{kind:"Name",value:"IsSeriesCancelled"}},{kind:"Field",name:{kind:"Name",value:"SkypeTeamsProperties"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"cid"}},{kind:"Field",name:{kind:"Name",value:"rid"}},{kind:"Field",name:{kind:"Name",value:"mid"}},{kind:"Field",name:{kind:"Name",value:"uid"}},{kind:"Field",name:{kind:"Name",value:"private"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}},{kind:"Field",name:{kind:"Name",value:"Location"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AllEnhancedLocationFields"}}]}},{kind:"Field",name:{kind:"Name",value:"MeetingRequestWasSent"}},{kind:"Field",name:{kind:"Name",value:"OnlineMeetingJoinUrl"}},{kind:"Field",name:{kind:"Name",value:"Organizer"}},{kind:"Field",name:{kind:"Name",value:"Recurrence"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AllRecurrenceFields"}}]}},{kind:"Field",name:{kind:"Name",value:"ResponseType"}},{kind:"Field",name:{kind:"Name",value:"SeriesMasterItemId"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mailboxInfo"}},{kind:"Field",name:{kind:"Name",value:"Id"}}]}},{kind:"Field",name:{kind:"Name",value:"PersonId"}},{kind:"Field",name:{kind:"Name",value:"Start"}},{kind:"Field",name:{kind:"Name",value:"StartTimeZoneId"}},{kind:"Field",name:{kind:"Name",value:"UID"}}]}},...a.a.definitions,...i.a.definitions]}},1126:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var a=t(386),i=t(1122);async function r(e){const n=e.ParentFolderId.Id;if(null!==Object(a.f)(e.ItemId.Id)){const t=Object(a.b)(e.ItemId.Id),{calendarEvent:r}=await Object(i.a)(e.ItemId,n,t);return r}return Promise.resolve(null)}},1127:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var a=t(2);const i=Object(a.action)("CALENDAR_EVENTS_CLEAR_ALL_FULL_CALENDAR_EVENTS",()=>({}))},1128:function(e,n,t){"use strict";var a=t(79),i=t(421),r=t(1534),o=t(1487),d=t(1530),c=t(889),l=t(25),s=t(217),u=t(756);function f(e,n,t){return a=>{if(!m(a)||a.ParentFolderId.Id!==e)return!1;const i=function(e,n){return t=>m(t)&&t.ParentFolderId.Id===e&&t.ItemId.Id===n}(a.ParentFolderId.Id,a.ItemId.Id);return t?n.some(i):!n.some(i)}}function m(e){var n;return(null===(n=null==e?void 0:e.ItemId)||void 0===n?void 0:n.Id)&&e.ParentFolderId&&e.ParentFolderId.Id}var v=t(99),b=t(201),I=t(980);function O(e,n){const t=Object(b.a)(e);if(null==t?void 0:t.length){const{eventsOverlapping:a}=Object(I.a)(t,[n]);Object(v.r)(e,f(e,a,!0))}}var j=t(210);function p(e){const n=Object(b.f)(e),t=n?[...n.events.values()]:[];Object(j.e)(f(e,t,!1))}var k=t(22),y=t(2),E=t(253);const g=Object(y.mutatorAction)("updateCalendarWorkingHours",(e,n)=>{const{calendarFolderWorkingHours:t}=Object(E.a)();t.set(e,n)});var F=t(595);const S={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"CalendarEvents"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CalendarEventsInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"calendarEvents"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"events"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"PartialCalendarEventFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"requiresForceOverride"}},{kind:"Field",name:{kind:"Name",value:"workingHours"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"WorkHoursStartTimeInMinutes"}},{kind:"Field",name:{kind:"Name",value:"WorkHoursEndTimeInMinutes"}},{kind:"Field",name:{kind:"Name",value:"WorkDays"}},{kind:"Field",name:{kind:"Name",value:"WorkingHoursTimeZoneId"}}]}}]}}]}},...t(1125).a.definitions]};var h=t(1084),N=t(52),R=t(982),C=t(5);function T(e,n,t,i=0){return Object.assign({fetchPromise:A(e,n,t,i)},function(e,n){if(Object(l.k)("cal-mf-noPeekJump")&&e==Object(a.h)()){const e=u.u.importAndExecute(n);return{enhancedFetchPromise:e.then(e=>e.requestPromise),cancelEnhancedFetchPromise:()=>{e.then(e=>{e.cancel()})}}}return{enhancedFetchPromise:null,cancelEnhancedFetchPromise:null}}(n,e))}async function A(e,n,t,i=0){var r,o,d;const c=n==Object(a.h)(),s=Object(a.t)(n);let u,f,m;const v=Object(a.K)(n);v?f=Object(a.l)(n):(f=Object(a.j)(s.id),u=Object(a.O)(f)),t(s,"Loading"),n||(n=null!==(r=f.SharedFolderId.Id)&&void 0!==r?r:Object(h.a)("calendar"));try{const a=Object(F.a)();m=await a.query({query:S,variables:{input:{dateRange:{start:Object(C.vb)(e.start),end:Object(C.vb)(e.end)},calendarEntryData:{calendarId:{id:s.id,mailboxInfo:s.mailboxInfo},folderId:n,ownerEmailAddress:f.OwnerEmailAddress,isGroupMailboxCalendar:f.IsGroupMailboxCalendar,hasEffectiveRights:!!f.EffectiveRights,hasReadRights:!!(null===(o=f.EffectiveRights)||void 0===o?void 0:o.Read),isGeneralScheduleCalendar:f.IsGeneralScheduleCalendar,calendarFolderType:f.CalendarFolderType,typename:f.__typename,isDefault:c,isValidCalendarEntry:u,isLocalCalendarEntry:v},retryCount:i,timeZone:Object(N.g)().UserOptions.TimeZone,includeDeclinedMeetings:Object(l.k)("cal-surface-declinedMeetings")}}}),t(s,"Loaded")}catch(e){throw"RequestNotComplete"==e.fetchErrorType?t(s,"Throttled"):t(s,"Failed"),e}const b=m.data.calendarEvents;return b.forceOverride&&(O(n,e),p(n)),b.workingHours&&g(n,b.workingHours),null===(d=b.events)||void 0===d?void 0:d.map(R.a)}function P(e,n,t,o=0){if(Object(l.k)("mon-cal-loadEventsViaGql"))return T(e,n,t,o);const d=async function(e,n,t,o=0){const d=Object(a.t)(n);if(t(d,"Loading"),Object(a.K)(n)){return 3==Object(a.l)(n).CalendarFolderType?async function(e,n,t,a,o=0){for(;o>=0;)try{const d=await Object(r.a)(Object(C.sb)(e.start),Object(C.sb)(e.end),n);if("NoError"==d.ResponseCode){return a(n,"Loaded"),d.BirthdayEvents.map(a=>Object(i.b)(a,t,e,n.mailboxInfo))}o--}catch(e){if(k.h.warn(`[loadCalendarEventsInDateRange:getBirthdayCalendarView: Exception occured: ${e}`),e.message&&(e.message.indexOf("ErrorApiQuarantined")>=0||e.message.indexOf("ErrorTooManyObjectsOpened")>=0))return a(n,"Throttled"),null;o--}return a(n,"Failed"),null}(e,d,n,t,o):M(e,d,n,t,null,o)}{let r=Object(a.j)(d.id);return Object(a.O)(r)?async function(e,n,t,a,r,o=0){if(!n.FolderId&&Object(s.f)(n)||n.hasOwnProperty("OwnerEmailAddress")&&!n.IsGroupMailboxCalendar&&!n.EffectiveRights||(!n.EffectiveRights||!n.EffectiveRights.Read)&&n.IsGeneralScheduleCalendar){for(;o>=0;)try{const d=await Object(c.b)(Object(C.sb)(t.start),Object(C.sb)(t.end),[n.OwnerEmailAddress],"DetailedMerged",null,a.mailboxInfo);if("NoError"==d.ResponseCode){r(a,"Loaded"),O(e,t),p(e);const{WorkingHours:n,Items:o}=d.Responses[0].CalendarView;return g(e,n),null==o?void 0:o.map(e=>Object(i.a)(e,a.mailboxInfo))}o--}catch(e){if(k.h.warn(`[loadCalendarEventsInDateRange:loadCalendarEventsUsingFolderId: Exception occured: ${e}`),e.message&&(e.message.indexOf("ErrorApiQuarantined")>=0||e.message.indexOf("ErrorTooManyObjectsOpened")>=0))return r(a,"Throttled"),null;o--}return r(a,"Failed"),null}{let e=n.FolderId?n.FolderId.Id:n.SharedFolderId.Id;return M(t,a,e,r,n.IsGroupMailboxCalendar?null:n.OwnerEmailAddress,o)}}(n,r,e,d,t,o):(t(d,"Failed"),null)}}(e,n,t,o);return Object.assign({fetchPromise:d},function(e,n){if(Object(l.k)("cal-mf-noPeekJump")&&e==Object(a.h)()){const e=u.u.importAndExecute(n);return{enhancedFetchPromise:e.then(e=>e.requestPromise),cancelEnhancedFetchPromise:()=>{e.then(e=>{e.cancel()})}}}return{enhancedFetchPromise:null,cancelEnhancedFetchPromise:null}}(n,e))}async function M(e,n,t,a,r,c=0){for(var u;c>=0;)try{let f;if(n.mailboxInfo&&"TeamsMailbox"==n.mailboxInfo.type?(f=await Object(d.a)(Object(C.sb)(e.start),Object(C.sb)(e.end),Object(s.d)(t),n.id,Object(N.g)().UserOptions.TimeZone),f&&(f=f.Body)):f=await Object(o.a)(Object(C.sb)(e.start),Object(C.sb)(e.end),null!=t?t:Object(h.a)("calendar"),n,r,Object(l.k)("cal-surface-declinedMeetings")),"NoError"==f.ResponseCode){return a(n,"Loaded"),null===(u=f.Items)||void 0===u?void 0:u.map(e=>(n.mailboxInfo&&"TeamsMailbox"==n.mailboxInfo.type&&(e.ParentFolderId.Id=t),Object(i.a)(e,n.mailboxInfo)))}c--}catch(e){if(k.h.warn(`[loadCalendarEventsInDateRange:getCalendarView: Exception occured: ${e}`),e.message&&(e.message.indexOf("ErrorApiQuarantined")>=0||e.message.indexOf("ErrorTooManyObjectsOpened")>=0))return a(n,"Throttled"),null;c--}return a(n,"Failed"),null}t.d(n,"a",(function(){return P}))},1460:function(e,n,t){"use strict";var a=t(1112),i=t(1115),r=(t(975),t(5));var o=t(1469),d=(e,n)=>Object(r.Cb)(e.Start)<Object(r.Cb)(n.End)&&Object(r.Cb)(e.End)>Object(r.Cb)(n.Start),c=(e,n)=>n.filter(n=>n!=e&&d(e,n)).sort(a.a);function l(e,n){e.Start=n.Start,e.ItemId=n.ItemId,e.End=n.End,e.CalendarItemType="ThisAndFollowingInstancesMaster",e.Recurrence.RecurrenceRange.StartDate=function({StartTimeZoneId:e,Start:n}){const t=Object(r.Ub)(e,n),a=Object(r.ac)(t);return Object(r.wb)(a)}(n)}var s=t(961);function u(e){e.Start=Object(r.Ub)(e.StartTimeZoneId,e.Start),e.End=Object(r.Ub)(e.EndTimeZoneId,e.End)}t.d(n,"a",(function(){return a.a})),t.d(n,"b",(function(){return i.a})),t.d(n,"c",(function(){return o.a})),t.d(n,"d",(function(){return c})),t.d(n,"e",(function(){return l})),t.d(n,"f",(function(){return d})),t.d(n,"g",(function(){return s.a})),t.d(n,"h",(function(){return u}))},1503:function(e,n,t){"use strict";var a=t(353),i=t(963),r=t(468);var o=t(1522);function d(e){return function(e){return!(e<=0)&&(Object(r.a)(e,i.a)==i.a||Object(r.a)(e,a.d)==a.d||Object(r.a)(e,a.e)==a.e||Object(r.a)(e,i.b)==i.b||Object(r.a)(e,a.a)==a.a||Object(r.a)(e,a.b)==a.b||Object(r.a)(e,a.f)==a.f)}(e)||function(e){return Object(r.a)(e,a.g)==a.g||Object(r.a)(e,a.h)==a.h||Object(r.a)(e,a.i)==a.i}(e)||Object(o.a)(e)}t.d(n,"a",(function(){return d}))},1507:function(e){e.exports=JSON.parse('{"a":"_Ea"}')},1508:function(e,n,t){"use strict";var a=t(1511),i=1,r=4;n.a=function(e){return Object(a.a)(e,i|r)}},1509:function(e,n,t){"use strict";t.d(n,"a",(function(){return d}));var a=t(765),i=t(421),r=t(30),o=t(168);function d(e){var n,t;const r=[];for(let d=0;d<e.length;d++){const u=e[d],{requiredAttendees:f,optionalAttendees:m}=l(u.Attendees),v={ItemId:{Id:Object(a.b)(u.Id),mailboxInfo:Object(o.d)()},ResponseType:c(null===(n=u.ResponseStatus)||void 0===n?void 0:n.Response),AppointmentReplyTime:Object(i.c)(s(u.Attendees)),IsOnlineMeeting:u.IsOnlineMeeting,OnlineMeetingProvider:u.OnlineMeetingProvider,OnlineMeetingJoinUrl:null===(t=u.OnlineMeeting)||void 0===t?void 0:t.JoinUrl,RequiredAttendees:f,OptionalAttendees:m};r.push(v)}return r}function c(e){let n;switch(e){case"Accepted":n="Accept";break;case"TentativelyAccepted":n="Tentative";break;case"Organizer":n="Organizer";break;case"Declined":n="Decline";break;case"NotResponded":n="NoResponseReceived";break;default:n="Unknown"}return n}function l(e){const n=[],t=[];return null==e||e.forEach(e=>{var a,i,r,o;const d={Mailbox:{Name:null===(a=e.EmailAddress)||void 0===a?void 0:a.Name,EmailAddress:null===(i=e.EmailAddress)||void 0===i?void 0:i.Address},ResponseType:c(null===(r=e.Status)||void 0===r?void 0:r.Response),LastResponseTime:null===(o=e.Status)||void 0===o?void 0:o.Time};"Required"==e.Type?n.push(d):"Optional"==e.Type&&t.push(d)}),{requiredAttendees:n,optionalAttendees:t}}function s(e){var n,t,a,i;if(!e)return null;for(let o=0;o<e.length;o++){const d=e[o];if((i=d.EmailAddress)&&(t=i.Address,a=Object(r.a)().SessionSettings.UserEmailAddress,t===a||t&&a&&t.toLowerCase()==a.toLowerCase()))return null===(n=d.Status)||void 0===n?void 0:n.Time}return null}},1511:function(e,n,t){"use strict";var a=t(352),i=t(1484),r=t(764),o=t(427),d=t(332);var c=function(e,n){return e&&Object(o.a)(n,Object(d.a)(n),e)},l=t(426);var s=function(e,n){return e&&Object(o.a)(n,Object(l.a)(n),e)},u=t(768),f=t(767),m=t(524);var v=function(e,n){return Object(o.a)(e,Object(m.a)(e),n)},b=t(1106);var I=function(e,n){return Object(o.a)(e,Object(b.a)(e),n)},O=t(605),j=t(1482),p=t(465),k=Object.prototype.hasOwnProperty;var y=function(e){var n=e.length,t=new e.constructor(n);return n&&"string"==typeof e[0]&&k.call(e,"index")&&(t.index=e.index,t.input=e.input),t},E=t(628);var g=function(e,n){var t=n?Object(E.a)(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.byteLength)},F=/\w*$/;var S=function(e){var n=new e.constructor(e.source,F.exec(e));return n.lastIndex=e.lastIndex,n},h=t(229),N=h.a?h.a.prototype:void 0,R=N?N.valueOf:void 0;var C=function(e){return R?Object(R.call(e)):{}},T=t(769),A="[object Boolean]",P="[object Date]",M="[object Map]",D="[object Number]",w="[object RegExp]",x="[object Set]",_="[object String]",L="[object Symbol]",K="[object ArrayBuffer]",U="[object DataView]",q="[object Float32Array]",B="[object Float64Array]",V="[object Int8Array]",$="[object Int16Array]",H="[object Int32Array]",z="[object Uint8Array]",W="[object Uint8ClampedArray]",G="[object Uint16Array]",J="[object Uint32Array]";var Z=function(e,n,t){var a=e.constructor;switch(n){case K:return Object(E.a)(e);case A:case P:return new a(+e);case U:return g(e,t);case q:case B:case V:case $:case H:case z:case W:case G:case J:return Object(T.a)(e,t);case M:return new a;case D:case _:return new a(e);case w:return S(e);case x:return new a;case L:return C(e)}},Q=t(770),Y=t(166),X=t(349),ee=t(193),ne="[object Map]";var te=function(e){return Object(ee.a)(e)&&Object(p.a)(e)==ne},ae=t(525),ie=t(399),re=ie.a&&ie.a.isMap,oe=re?Object(ae.a)(re):te,de=t(165),ce="[object Set]";var le=function(e){return Object(ee.a)(e)&&Object(p.a)(e)==ce},se=ie.a&&ie.a.isSet,ue=se?Object(ae.a)(se):le,fe=1,me=2,ve=4,be="[object Arguments]",Ie="[object Function]",Oe="[object GeneratorFunction]",je="[object Object]",pe={};pe[be]=pe["[object Array]"]=pe["[object ArrayBuffer]"]=pe["[object DataView]"]=pe["[object Boolean]"]=pe["[object Date]"]=pe["[object Float32Array]"]=pe["[object Float64Array]"]=pe["[object Int8Array]"]=pe["[object Int16Array]"]=pe["[object Int32Array]"]=pe["[object Map]"]=pe["[object Number]"]=pe[je]=pe["[object RegExp]"]=pe["[object Set]"]=pe["[object String]"]=pe["[object Symbol]"]=pe["[object Uint8Array]"]=pe["[object Uint8ClampedArray]"]=pe["[object Uint16Array]"]=pe["[object Uint32Array]"]=!0,pe["[object Error]"]=pe[Ie]=pe["[object WeakMap]"]=!1;n.a=function e(n,t,o,m,b,k){var E,g=t&fe,F=t&me,S=t&ve;if(o&&(E=b?o(n,m,b,k):o(n)),void 0!==E)return E;if(!Object(de.a)(n))return n;var h=Object(Y.a)(n);if(h){if(E=y(n),!g)return Object(f.a)(n,E)}else{var N=Object(p.a)(n),R=N==Ie||N==Oe;if(Object(X.a)(n))return Object(u.a)(n,g);if(N==je||N==be||R&&!b){if(E=F||R?{}:Object(Q.a)(n),!g)return F?I(n,s(E,n)):v(n,c(E,n))}else{if(!pe[N])return b?n:{};E=Z(n,N,g)}}k||(k=new a.a);var C=k.get(n);if(C)return C;k.set(n,E),ue(n)?n.forEach((function(a){E.add(e(a,t,o,a,n,k))})):oe(n)&&n.forEach((function(a,i){E.set(i,e(a,t,o,i,n,k))}));var T=S?F?j.a:O.a:F?l.a:d.a,A=h?void 0:T(n);return Object(i.a)(A||n,(function(a,i){A&&(a=n[i=a]),Object(r.a)(E,i,e(a,t,o,i,n,k))})),E}},1516:function(e){e.exports=JSON.parse('{"a":"aFa"}')},1517:function(e){e.exports=JSON.parse('{"a":"$Ea"}')},1518:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var a=t(5);function i(e,n){if(null==n?void 0:n.RecurrenceRange){const t=n.RecurrenceRange.EndDate;if(t)return Object(a.Ub)(e,t)}return null}},1520:function(e,n,t){"use strict";t.d(n,"b",(function(){return o}));var a=t(20),i=t(1503);t.d(n,"a",(function(){return i.a}));const r=new a.c(()=>Promise.all([t.e(149),t.e(1184)]).then(t.bind(null,2660))),o=new a.a(r,e=>e.getTxpObjectFromTxpEntities)},1522:function(e,n,t){"use strict";var a=t(468);var i=t(353),r=t(25);const o="cal-txp-invoice";function d(e){return function(e,n,t){return Object(a.a)(e,n)==n&&t}(e,i.c,Object(r.k)(o))}t.d(n,"a",(function(){return d}))},1524:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"AllRecurrenceFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"RecurrenceType"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"RecurrencePattern"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AbsoluteYearlyRecurrence"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"DayOfMonth"}},{kind:"Field",name:{kind:"Name",value:"Month"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AbsoluteMonthlyRecurrence"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Interval"}},{kind:"Field",name:{kind:"Name",value:"DayOfMonth"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DailyRecurrence"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Interval"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"RegeneratingPatternBaseType"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Interval"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"RelativeYearlyRecurrence"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"DaysOfWeek"}},{kind:"Field",name:{kind:"Name",value:"DayOfWeekIndex"}},{kind:"Field",name:{kind:"Name",value:"Month"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"RelativeMonthlyRecurrence"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"DaysOfWeek"}},{kind:"Field",name:{kind:"Name",value:"DayOfWeekIndex"}},{kind:"Field",name:{kind:"Name",value:"Interval"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WeeklyRecurrence"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"DaysOfWeek"}},{kind:"Field",name:{kind:"Name",value:"FirstDayOfWeek"}},{kind:"Field",name:{kind:"Name",value:"Interval"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"RecurrenceRange"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EndDateRecurrence"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"StartDate"}},{kind:"Field",name:{kind:"Name",value:"EndDate"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"NoEndRecurrence"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"StartDate"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"NumberedRecurrence"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"StartDate"}},{kind:"Field",name:{kind:"Name",value:"NumberOfOccurrences"}}]}}]}}]}}]}},1525:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"AllAttendeeFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Attendee"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Mailbox"}},{kind:"Field",name:{kind:"Name",value:"ResponseType"}},{kind:"Field",name:{kind:"Name",value:"LastResponseTime"}},{kind:"Field",name:{kind:"Name",value:"ResponseComment"}},{kind:"Field",name:{kind:"Name",value:"ProposedStart"}},{kind:"Field",name:{kind:"Name",value:"ProposedEnd"}},{kind:"Field",name:{kind:"Name",value:"IsCoauthor"}}]}}]}},1527:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var a=t(2);const i=Object(a.action)("logNotificationUpdateForDiagnostics",e=>({notificationUpdateLog:e}))},1530:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var a=t(437);async function i(e,n,t,i,r){const o=`ows/api/beta/TeamsCalendarEvents/items?id=${encodeURIComponent(t)}&rangeStart=${encodeURIComponent(e)}&rangeEnd=${encodeURIComponent(n)}&channelId=${i}&timeZone=${r}`;return Object(a.b)("getTeamsCalendarView",null,o)}},1532:function(e,n,t){"use strict";var a=t(381),i=t(796),r=t(391),o=t(25),d=t(1500),c=t(1501),l=t(167),s=t(772),u=t(894),f=t(943);var m=t(556);const v="X-RedirectToCalendarService",b=7;let I=null;async function O(e,n,t,a,i){const{Id:O,mailboxInfo:j}=e;let p,k=null,y=null;const E=Object(r.a)(j)||{};E.datapoint={customData:{itemId:O,fetchingMasterItem:t},jsonCustomData:e=>{let n=e.Body.ResponseMessages.Items[0];return{responseClass:n.ResponseClass,responseCode:n.ResponseCode}}},Object(o.k)("platform-redirectToCalendarService")&&(E.headers||(E.headers=new Headers),E.headers.set(v,"true"));try{if(k=await function(){null==I&&(I=Object(m.a)(b));return I}().add(()=>Object(c.a)({Header:Object(l.b)(),Body:Object(d.a)({EventIds:a,ItemShape:n,IncludeDeclinedMeetings:Object(o.k)("cal-surface-declinedMeetings")})},E)),p=k.Body.ResponseMessages.Items[0],"Success"==p.ResponseClass)if(null!=p){let e=p.Items[0];null!=e&&(!function(e){e.Locations?e.Locations=e.Locations.filter(e=>e):e.Locations=[],e.Resources&&e.Resources.map(n=>{Object(u.c)(e.Locations,n.Mailbox.EmailAddress)||(e.Locations=e.Locations.filter(e=>e.DisplayName!==n.Mailbox.Name||Object(f.r)(e.PostalAddress)),e.Locations.push(Object(f.g)(n.Mailbox.Name,n.Mailbox.EmailAddress)))})}(e),i&&(e.ParentFolderId.Id=i),y={calendarEvent:e,error:null,responseCode:p.ResponseCode})}else y={calendarEvent:null,error:"[getCalendarEventService] null response.",responseCode:p.ResponseCode};else{y={calendarEvent:null,error:`[getCalendarEventService] request failed. Message: ${p.MessageText}, ResponseCode: ${p.ResponseCode}, ResponseClass: ${p.ResponseClass}`,responseCode:p.ResponseCode}}}catch(e){y={calendarEvent:null,error:e.message}}finally{Object(o.k)("cal-mf-diagnostics")&&Object(s.a)({action:"GetCalendarEvent",status:(null==p?void 0:p.ResponseClass)||"Error",response:null==k?void 0:k.Body})}return y}var j=t(1210),p=t(661),k=t(1450),y=t(1222),E=t(72);var g=t(662),F=t(663),S=t(664),h=t(665),N=t(1436);function R(e,n,t,r){const d=[r?Object(i.a)({OccurrenceId:e.Id}):Object(a.a)({Id:e.Id})];return O(e,function(e){const n=[p.a];Object(o.k)("cal-dev-focusTime")&&n.push(g.a),Object(N.a)()&&n.push(F.a),Object(o.k)("cal-mf-mobility-create")&&(n.push(S.a),n.push(h.a));const t={BaseShape:"IdOnly",MaximumBodySize:0,BodyType:"HTML",FilterHtmlContent:!0,InlineImageCustomDataTemplate:j.e,InlineImageUrlTemplate:j.f,AddBlankTargetToLinks:!0,CssScopeClassName:"cal_"+Math.ceil(65534*Math.random()+1).toString(16),AdditionalProperties:n,ImageProxyCapability:Object(o.k)("cal-bodyImageProxy")&&Object(k.a)()?y.a.OwaAndConnectorsProxy:y.a.None};if(!Object(o.k)("cal-mf-blockExternalContent"))return t;switch(e){case"Default":return Object.assign(Object.assign({},t),{BlockContentFromUnknownSenders:!0,BlockExternalImages:!0});case"WithBlockedExternalContent":return t;default:return Object(E.a)(e)}}(t),r,d,n)}t.d(n,"a",(function(){return R}))},1533:function(e,n,t){"use strict";var a=t(391);var i=t(381),r=t(35);function o(e,n){var t;return void 0===e||e.__type||(t=e,e=Object.assign({__type:"GetBirthdayEventJsonRequest:#Exchange"},t)),Object(r.a)("GetBirthdayEvent",e,n)}var d=t(167);async function c(e){const{Id:n,mailboxInfo:t}=e,r=Object(a.a)(t)||{};r.datapoint={customData:{itemId:n},jsonCustomData:e=>{var n,t;return{responseClass:null===(n=null==e?void 0:e.Body)||void 0===n?void 0:n.ResponseClass,responseCode:null===(t=null==e?void 0:e.Body)||void 0===t?void 0:t.ResponseCode}}};const c=await o({Header:Object(d.b)(),Body:(l={CalendarItemId:Object(i.a)({Id:n})},Object.assign({__type:"GetBirthdayEventRequest:#Exchange"},l))},r);var l;if(null!=c.Body&&"Success"==c.Body.ResponseClass){let e=c.Body.BirthdayEvent;if(null!=e)return{calendarEvent:e,error:null}}return{calendarEvent:null,error:"[getBirthdayEventService] request failed"}}t.d(n,"a",(function(){return c}))},1534:function(e,n,t){"use strict";var a=t(35);function i(e,n){var t;return void 0===e||e.__type||(t=e,e=Object.assign({__type:"GetBirthdayCalendarViewJsonRequest:#Exchange"},t)),Object(a.a)("GetBirthdayCalendarView",e,n)}var r=t(167),o=t(391);async function d(e,n,t){var a;return(await i({Header:Object(r.b)(),Body:(a={StartRange:e,EndRange:n},Object.assign({__type:"GetBirthdayCalendarViewRequest:#Exchange"},a))},Object(o.a)(t.mailboxInfo))).Body}t.d(n,"a",(function(){return d}))},210:function(e,n,t){"use strict";t.d(n,"d",(function(){return l})),t.d(n,"c",(function(){return s})),t.d(n,"b",(function(){return u})),t.d(n,"e",(function(){return f})),t.d(n,"a",(function(){return m})),t.d(n,"f",(function(){return v})),t.d(n,"j",(function(){return b})),t.d(n,"g",(function(){return I})),t.d(n,"i",(function(){return O})),t.d(n,"h",(function(){return j}));var a=t(1507),i=t(1516),r=t(1517),o=t(6),d=t(66),c=t(2);const l=Object(c.action)("calendarEventsRemoved",e=>({eventsRemoved:e})),s=Object(c.action)("calendarEventsAdded",e=>({eventsAdded:e})),u=Object(c.action)("calendarEventUpdated",e=>({eventUpdated:e})),f=Object(c.action)("calendarEventsRemovedMatchedFilter",e=>({removePredicate:e})),m=Object(c.action)("cacheReloaded",(e,n)=>({previousEvents:e,reloadedEvents:n})),v=Object(c.action)("deleteEventsCache",e=>({folderId:e})),b=Object(c.action)("loadingCalendarEvents",(e,n,t)=>Object(d.b)({name:"CalendarLoadState",customData:{loadingState:t},options:{isVerbose:!0}},{lockId:e,calendarId:n,loadingState:t})),I=Object(c.action)("instantCalendarEventCreate",(e,n,t,a=(()=>{}),r,d=Object(o.b)(i.a),c=(()=>{}))=>({eventToCreate:e,actionToExecute:n,onEventCreatedSuccess:t,onEventCreatedFailed:a,actionSource:r,errorMessage:d,onEventCreatedLocally:c})),O=Object(c.action)("instantCalendarEventUpdate",(e,n,t,i,r,d=(()=>{}),c,l=Object(o.b)(a.a),s=(()=>{}))=>({eventId:e,eventChanges:n,eventScope:t,actionToExecute:i,onEventUpdateSuccess:r,onEventUpdateFailed:d,actionSource:c,errorMessage:l,onEventUpdatedLocally:s})),j=Object(c.action)("instantCalendarEventDelete",(e,n,t,a,i,d=(()=>{}),c,l=Object(o.b)(r.a),s=!1,u=(()=>Promise.resolve(!1)))=>({eventId:e,eventScope:n,dataPoint:t,actionToExecute:a,onEventDeleteSuccess:i,onEventDeleteFailed:d,actionSource:c,errorMessage:l,responseSent:s,asyncUndoAction:u}))},272:function(e,n,t){"use strict";t.d(n,"a",(function(){return o})),t.d(n,"b",(function(){return d})),t.d(n,"c",(function(){return c})),t.d(n,"d",(function(){return l})),t.d(n,"e",(function(){return s}));var a=t(254),i=t(253),r=t(368);function o(e,n){const t=Object(i.a)().calendarFolderEvents.get(e);return t?[...t.events.values()].filter(n):[]}function d(e,n=null){if(n){const[t]=o(n,n=>n.ItemId.Id===e);return t||null}return u(n=>n.ItemId.Id===e)}function c(e,n=null){if(n){const[t]=o(n,n=>n.InstanceKey===e);return t||null}return u(n=>n.InstanceKey===e)}function l(e,n=null){const t=Object(i.a)();if(n){return t.calendarFolderEvents.get(n).events.get(e)||null}return function(e){const n=[...Object(i.a)().calendarFolderEvents.keys()];for(let t=0;t<n.length;t++){const a=l(e,n[t]);if(a)return a}return null}(e)}function s(e,n,t){let o=null;o=e?function(e,n,t){const r=Object(i.a)().calendarFolderEvents.get(e);if(r){const[e]=Object(a.l)([n],t,r);return e||null}return null}(e,n,t):function(e,n){const t=Object(i.a)(),r=[...t.calendarFolderEvents.keys()];for(let i=0;i<r.length;i++){const o=r[i],d=t.calendarFolderEvents.get(o),[c]=d?Object(a.l)([e],n,d):[null];if(c)return c}return null}(n,t);const d=o?"1":"no";return Object(r.a)({lockId:t,updateMessage:`Got ${d} item from the cache for given folder and key`}),o}function u(e){const n=Object(i.a)(),t=[...n.calendarFolderEvents.keys()];for(let a=0;a<t.length;a++){const i=t[a],r=n.calendarFolderEvents.get(i),[o]=r?[...r.events.values()].filter(e):[null];if(o)return o}return null}},338:function(e,n,t){"use strict";var a=t(1520),i=t(79),r=t(429),o=t(217);function d(e){return!!e.EffectiveRights&&!!e.EffectiveRights.Modify&&!Object(i.L)(e.ParentFolderId.Id)&&!Object(r.c)(e)&&("Private"!==e.Sensitivity||function(e){const n=Object(i.l)(e);return Object(o.c)(n)}(e.ParentFolderId.Id))}var c=e=>G(e)&&d(e)&&!e.IsCancelled,l=e=>{var n;return(null===(n=null==e?void 0:e.ParentFolderId)||void 0===n?void 0:n.mailboxInfo)&&"GroupMailbox"==e.ParentFolderId.mailboxInfo.type};function s(e,n){if(!e)return!1;let t=!l(e);const a=n=>n?t?n.filter(n=>!e.Organizer||n.Mailbox.EmailAddress!=e.Organizer.Mailbox.EmailAddress):n:[],i=a(e.RequiredAttendees).length,r=a(e.OptionalAttendees).length;return n?i+r>0:i+r+a(e.Resources).length>0}function u(e){const n=e.RequiredAttendees,t=e.OptionalAttendees;return n&&0!=n.length||t&&0!=t.length}function f(e){return!!e&&(e.IsDraft?s(e):e.IsMeeting||s(e))}var m=e=>!f(e)&&!e.IsOrganizer&&d(e)&&!e.IsCancelled,v=e=>!(!e.IsOrganizer||f(e)&&e.MeetingRequestWasSent||!d(e)),b=t(52),I=t(421);function O(e){const n=Object(i.l)(e.ParentFolderId.Id),t=Object(I.d)(e);return d(e)&&f(e)&&!!n&&!!t&&!([3,6,7].includes(n.CalendarFolderType)||t.IsMeetingPollEvent)}function j(e){return!!(e.IsOrganizer&&e.IsMeeting&&e.MeetingRequestWasSent&&d(e))}const p=e=>v(e)||c(e)||m(e);function k(e){return!l(e)&&!e.IsOrganizer&&e.IsMeeting&&!e.IsCancelled&&d(e)}function y(e){return 0==Object(b.g)().SessionSettings.WebSessionType&&k(e)&&e.IsResponseRequested&&!e.IsAllDayEvent&&(!e.IsRecurring||F(e))}function E(e){return!e.IsOrganizer&&e.IsCancelled&&d(e)}function g(e){return!Object(a.a)(e.EntityNamesMap)&&e.IsOrganizer&&d(e)}function F(e){return e.IsRecurring&&"RecurringMaster"!==e.CalendarItemType&&"ThisAndFollowingInstancesMaster"!==e.CalendarItemType}function S(e){return"RecurringMaster"===e.CalendarItemType}function h(e){return"ThisAndFollowingInstancesMaster"===e.CalendarItemType}function N(e){return l(e)&&!e.IsCancelled&&!e.DoNotForwardMeeting}function R(e){if(e){const n=Object(i.l)(e.ParentFolderId.Id);if(n)return n.IsSharedWithMe||Object(o.f)(n)}return!1}var C=t(25);function T(e){return!!l(e)||(!R(e)||Object(C.k)("cal-mf-enableFTDFOnSharedCalendar"))}var A=e=>{const n=Object(i.l)(e.ParentFolderId.Id),t=n?n.CalendarFolderType:void 0;return(Object(r.c)(e)||d(e))&&(!t||1==t||3==t||5==t)};function P(e){var n;return!!(null===(n=e.EffectiveRights)||void 0===n?void 0:n.Read)}var M=t(159);function D(e){return e&&P(e)&&w(e.ItemId)}function w(e){return(null==e?void 0:e.Id)&&!Object(M.b)(e.Id)}var x=t(284);function _(e){return e.IsMeeting&&!Object(x.r)(e.ParentFolderId.mailboxInfo.userIdentity)}var L=t(727);function K(e,n){var t,a;return!(n&&n.length>0)||(e.Subject&&-1!=e.Subject.toLowerCase().indexOf(n.toLowerCase())||(null===(t=e.Location)||void 0===t?void 0:t.DisplayName)&&-1!=Object(L.d)(e.Location.DisplayName,e.Location.PostalAddress).toLowerCase().indexOf(n.toLowerCase())||(null===(a=e.Organizer)||void 0===a?void 0:a.Mailbox)&&-1!=e.Organizer.Mailbox.Name.toLowerCase().indexOf(n.toLowerCase()))}var U=e=>{if(!e)return!1;let n=e.ParentFolderId.mailboxInfo.mailboxSmtpAddress;return q(e.RequiredAttendees,n)||q(e.OptionalAttendees,n)};function q(e,n){return e&&e.some(e=>e.Mailbox.EmailAddress.toLowerCase()==n)}var B=t(959);function V(e){if(!e)return!1;let n=!1;return e.forEach(e=>{Object(B.a)(e.Mailbox)||(n=!0)}),n}function $(e){if(!e)return!1;const n=Object(i.l)(e.ParentFolderId.Id);return n&&3==n.CalendarFolderType}function H(e){return"Exception"===e}function z(e){return"Occurrence"===e}function W(e){return z(e.CalendarItemType)||H(e.CalendarItemType)}function G(e){return(null==e?void 0:e.IsMeeting)&&!e.IsOrganizer}function J(e){return(null==e?void 0:e.IsMeeting)&&(null==e?void 0:e.IsOrganizer)}function Z(e){return Object(r.c)(e)&&f(e)}var Q=t(5);function Y(e,n){return e&&n&&!Object(r.c)(e)&&Object(Q.Kb)(n.Start,e.Start)&&Object(Q.Kb)(n.End,e.End)&&n.IsAllDayEvent==e.IsAllDayEvent}function X(e){return"RecurringMaster"===e}function ee(e,n){if(!e.IsOrganizer)return!1;if(n&&Object(C.k)("mon-cal-item-doubleclick"))return!0;return!(!e.IsDraft&&e.MeetingRequestWasSent||!Object(C.k)("cal-draft-updates-flag"))}function ne(e){return!(!e.ItemId||!e.IsDraft||function(e){return!!(e.ItemId&&e.IsDraft&&e.IsMeeting&&e.IsOrganizer)}(e))}t.d(n,"j",(function(){return O})),t.d(n,"c",(function(){return j})),t.d(n,"d",(function(){return p})),t.d(n,"q",(function(){return k})),t.d(n,"n",(function(){return y})),t.d(n,"o",(function(){return E})),t.d(n,"h",(function(){return g})),t.d(n,"L",(function(){return F})),t.d(n,"M",(function(){return S})),t.d(n,"B",(function(){return h})),t.d(n,"b",(function(){return N})),t.d(n,"a",(function(){return T})),t.d(n,"e",(function(){return c})),t.d(n,"f",(function(){return m})),t.d(n,"g",(function(){return v})),t.d(n,"i",(function(){return A})),t.d(n,"k",(function(){return d})),t.d(n,"l",(function(){return D})),t.d(n,"m",(function(){return w})),t.d(n,"p",(function(){return _})),t.d(n,"r",(function(){return K})),t.d(n,"s",(function(){return s})),t.d(n,"w",(function(){return u})),t.d(n,"t",(function(){return U})),t.d(n,"u",(function(){return V})),t.d(n,"v",(function(){return P})),t.d(n,"x",(function(){return $})),t.d(n,"y",(function(){return f})),t.d(n,"z",(function(){return W})),t.d(n,"A",(function(){return H})),t.d(n,"C",(function(){return G})),t.d(n,"D",(function(){return R})),t.d(n,"E",(function(){return J})),t.d(n,"F",(function(){return Z})),t.d(n,"H",(function(){return z})),t.d(n,"I",(function(){return l})),t.d(n,"J",(function(){return Y})),t.d(n,"K",(function(){return X})),t.d(n,"N",(function(){return ee})),t.d(n,"G",(function(){return ne}))},353:function(e,n,t){"use strict";t.d(n,"a",(function(){return a})),t.d(n,"d",(function(){return i})),t.d(n,"e",(function(){return r})),t.d(n,"b",(function(){return o})),t.d(n,"c",(function(){return d})),t.d(n,"f",(function(){return c})),t.d(n,"g",(function(){return l})),t.d(n,"h",(function(){return s})),t.d(n,"i",(function(){return u}));const a=2,i=4,r=8,o=32,d=64,c=128,l=4294967296,s=8589934592,u=17179869184},386:function(e,n,t){"use strict";t.d(n,"a",(function(){return r})),t.d(n,"e",(function(){return o})),t.d(n,"d",(function(){return c})),t.d(n,"f",(function(){return l})),t.d(n,"b",(function(){return s})),t.d(n,"c",(function(){return u}));var a=t(13),i=t(253);function r(){return f.get()}function o(e,n){const t=d(e);return t&&t.itemResponseShapeType===n?t:null}function d(e){const n=r()[e];return n||null}function c(e,n,t){const a=Object(i.a)().fullItemsMruMap.get(e);if(a){const[e]=a.eventInfos.filter(e=>e.eventKey===n);if(e&&e.itemResponseShapeType===t)return e}return null}function l(e){const n=d(e);return n?n.loadState:null}function s(e){var n;const t=null===(n=d(e))||void 0===n?void 0:n.itemResponseShapeType;return t||"Default"}function u(){return"Default"}const f=Object(a.computed)(()=>{const e=Object(i.a)();return[...e.fullItemsMruMap.keys()].reduce((n,t)=>{const{eventInfos:a}=e.fullItemsMruMap.get(t);return a.forEach(e=>n[e.eventKey]=e),n},{})})},421:function(e,n,t){"use strict";const a=175,i="_____";function r(e){if(!e)return null;const n=e.indexOf(i);if(-1!=n&&(e=e.substring(0,n)),(e=e.trim()).length<a)return e;const t=e.substr(0,a).trim();return t.length>0?t.concat("..."):null}var o=t(168),d=t(80),c=t(25),l=t(12),s=t(5),u=t(887),f=t(661),m=t(526),v=t(662),b=t(663),I=t(664),O=t(665),j=t(653),p=t(1113),k=t(122),y=t(318);function E(e,n,t,a){var i;a=a||Object(o.d)();let r=Object(u.a)(),d=function(e,n){const t=Object(s.qc)(e),a=g(t,Object(s.Fb)(n.start));return Object(k.t)(n,a)?a:g(t,Object(s.Fb)(n.end))}(e.Birthday,t);return Object.assign(Object.assign(Object.assign({},r),e),{Subject:e.Name,Start:d,End:Object(s.e)(d,1),IsAllDayEvent:!0,ParentFolderId:{Id:n,mailboxInfo:a},ItemId:{Id:e.Id.Id,mailboxInfo:a},PersonId:e.PersonId,EffectiveRights:{Delete:!0,Modify:!0,Read:!0},FreeBusyType:"Free",ReminderIsSet:e.PopupReminderSettings[0].IsReminderSet,ReminderMinutesBeforeStart:e.PopupReminderSettings[0].ReminderMinutesBeforeStart,InboxReminders:null===(i=e.EmailReminderSettings)||void 0===i?void 0:i.map(j.c)})}function g(e,n){const t=Object(s.Ab)(e),a=Object(s.mb)(e),i=Object(y.a)(n,t),r=Math.min(a,i);return Object(s.pc)(n,t,r)}t.d(n,"a",(function(){return h})),t.d(n,"c",(function(){return N})),t.d(n,"d",(function(){return R})),t.d(n,"b",(function(){return E}));const F=Object(u.a)(),S=[[Object(s.qc)("2019-11-03T00:00:00.000-03:00"),Object(s.qc)("2020-02-15T23:59:59.999-03:00")],[Object(s.qc)("2020-11-08T00:00:00.000-03:00"),Object(s.qc)("2021-02-20T23:59:59.999-03:00")],[Object(s.qc)("2021-11-07T00:00:00.000-03:00"),Object(s.qc)("2022-02-20T23:59:59.999-03:00")]];function h(e,n){var t;n=n||Object(o.d)();let a=[],i=!1,l=null,u=!1,m=null;if(null==e?void 0:e.ExtendedProperty){let n=e.ExtendedProperty.filter(e=>{var n;return(null===(n=e.ExtendedFieldURI)||void 0===n?void 0:n.PropertyName)===f.a.PropertyName})[0];if(null==n?void 0:n.Value)try{a=JSON.parse(n.Value)}catch(e){a=[]}e.ExtendedProperty.some(e=>{var n;return(null===(n=e.ExtendedFieldURI)||void 0===n?void 0:n.PropertyName)===v.a.PropertyName&&!!e.Value})&&(i=!0),n=e.ExtendedProperty.filter(e=>{var n;return(null===(n=e.ExtendedFieldURI)||void 0===n?void 0:n.PropertyName)===b.a.PropertyName})[0],(null==n?void 0:n.Value)&&(l=Object(p.f)(n.Value)),n=e.ExtendedProperty.filter(e=>{var n;return(null===(n=e.ExtendedFieldURI)||void 0===n?void 0:n.PropertyName)===O.a.PropertyName})[0],(null==n?void 0:n.Value)&&(m=n.Value),n=e.ExtendedProperty.filter(e=>{var n;return(null===(n=e.ExtendedFieldURI)||void 0===n?void 0:n.PropertyName)===I.a.PropertyName})[0],(null==n?void 0:n.Value)&&(u="true"===n.Value.toLowerCase())}const k=Object.assign(Object.assign(Object.assign({},F),e),{ItemId:e.ItemId?Object.assign(Object.assign({},e.ItemId),{mailboxInfo:n}):e.ItemId,ParentFolderId:e.ParentFolderId?Object.assign(Object.assign({},e.ParentFolderId),{mailboxInfo:n}):e.ParentFolderId,Start:N(e.Start),End:N(e.End),StartTimeZoneId:Object(d.b)(e.StartTimeZoneId),EndTimeZoneId:Object(d.b)(e.EndTimeZoneId),LastModifiedTime:N(e.LastModifiedTime),FreeBusyType:e.FreeBusyType,ResponseType:e.ResponseType,AppointmentReplyTime:N(e.AppointmentReplyTime),ExperienceType:e.ExperienceType?e.ExperienceType:"Unspecified",SeriesMasterItemId:e.SeriesMasterItemId?Object.assign(Object.assign({},e.SeriesMasterItemId),{mailboxInfo:n}):null,Sensitivity:"GroupMailbox"==n.type&&"Private"==e.Sensitivity?"Normal":e.Sensitivity,Preview:r(e.Preview),AppendOnSend:a,IsBookedFreeBlocks:i,CollabSpace:l,TravelTimeEventsLinked:u,FlexEventsMetadata:m,InboxReminders:null===(t=e.InboxReminders)||void 0===t?void 0:t.map(j.c)});if(!e.IsAllDayEvent&&e.SeriesId&&"Occurrence"==e.CalendarItemType&&"tzone://Microsoft/Custom"==e.StartTimeZoneId&&"E. South America Standard Time"==e.EndTimeZoneId&&!Object(c.k)("cal-killSwitch-63446")&&k.Start&&k.End&&S.some(([e,n])=>Object(s.Qb)(k.Start,e,n))){const e=Object(s.x)(k.End,k.Start);k.Start=Object(s.f)(k.Start,1),k.End=Object(s.h)(k.Start,e),k.StartTimeZoneId=k.EndTimeZoneId,k.__BrazilHack__=1}return k}function N(e){if(e){if(Object(c.k)("cal-assumeTzOffsetFromCalendarItem")){const n=Object(l.a)().timezone,t=!!n;return Object(s.Vb)(n,e,t)}return Object(s.qb)(e)}}function R(e){var n,t,a;const i=[];if(e.AppendOnSend&&e.AppendOnSend.length>0&&i.push(Object(m.a)({ExtendedFieldURI:f.a,Value:JSON.stringify(e.AppendOnSend)})),e.FlexEventsMetadata&&i.push(Object(m.a)({ExtendedFieldURI:O.a,Value:e.FlexEventsMetadata})),e.IsBookedFreeBlocks&&i.push(Object(m.a)({ExtendedFieldURI:v.a,Value:e.IsBookedFreeBlocks.toString()})),e.CollabSpace){const a=Object.assign({},(null===(t=null===(n=e.CollabSpace.shareLinkInfo)||void 0===n?void 0:n.url)||void 0===t?void 0:t.length)>0&&{type:"collaborativeSpace",location:e.CollabSpace.shareLinkInfo.url,metadata:{state:e.CollabSpace.collabAllowed?"Enabled":"Disabled",isShared:e.CollabSpace.isShared}});i.push(Object(m.a)({ExtendedFieldURI:b.a,Value:JSON.stringify(a)}))}return e.TravelTimeEventsLinked&&i.push(Object(m.a)({ExtendedFieldURI:I.a,Value:e.TravelTimeEventsLinked.toString()})),Object.assign(Object.assign({__type:"CalendarItem:#Exchange"},e),{Start:e.Start&&Object(s.sb)(e.Start),End:e.End&&Object(s.sb)(e.End),LastModifiedTime:e.LastModifiedTime&&Object(s.sb)(e.LastModifiedTime),AppointmentReplyTime:e.AppointmentReplyTime&&Object(s.sb)(e.AppointmentReplyTime),FreeBusyType:e.FreeBusyType,CharmId:e.CharmId,IsDraft:e.IsDraft,IsRoomRequested:e.IsRoomRequested,SkypeTeamsProperties:e.SkypeTeamsProperties&&JSON.stringify(e.SkypeTeamsProperties),ExtendedProperty:i,InboxReminders:null===(a=e.InboxReminders)||void 0===a?void 0:a.map(j.d),AutoRoomBookingStatus:e.AutoRoomBookingStatus&&Object(j.b)(e.AutoRoomBookingStatus)})}},429:function(e,n,t){"use strict";function a(e){var n;if(null===(n=null==e?void 0:e.ItemId)||void 0===n?void 0:n.Id){let n=e.ClientSeriesId;return!!n&&(e.IsRecurring?n==e.InstanceKey:n==e.ItemId.Id)}return!0}var i=t(381),r=t(159);function o(e,n){let t=Object(r.a)();e.forEach(e=>{const a=Object(r.a)();c(e,t,a,n),e.IsRecurring=!0,e.InstanceKey=e.InstanceKey&&!n?e.InstanceKey:t})}function d(e){const n=Object(r.a)();c(e,n,n,!1)}function c(e,n,t,a){e.ItemId=Object.assign(Object.assign({},Object(i.a)({Id:t})),{mailboxInfo:e.ParentFolderId.mailboxInfo}),e.ClientSeriesId&&!a||(e.ClientSeriesId=n),e.EffectiveRights={Read:!0,Modify:!0,Delete:!0,ViewPrivateItems:!0},e.IsOrganizer=!0}t.d(n,"c",(function(){return a})),t.d(n,"a",(function(){return o})),t.d(n,"b",(function(){return d}))},498:function(e,n,t){"use strict";t.d(n,"a",(function(){return c})),t.d(n,"b",(function(){return l}));var a=t(210),i=t(895),r=t(22),o=t(272),d=t(99);function c(e,n,t,i=!1){const c=e.ParentFolderId.Id;let l=!1,s=function(e,n,t){let a=null;if(t)a=Object(o.b)(n.ItemId.Id,e);else{let t=e=>e.InstanceKey==n.InstanceKey;[a]=Object(o.a)(e,t)}if(!a){const t=n.ClientSeriesId;if(t){const n=e=>e.ClientSeriesId==t;[a]=Object(o.a)(e,n)}}return a}(c,e,n);s?s.IsRecurring&&!n?i?Object(a.d)([s]):l=!0:(null==e.IsOnlineMeeting&&null!=s.IsOnlineMeeting&&(e.IsOnlineMeeting=s.IsOnlineMeeting),null==e.OnlineMeetingJoinUrl&&null!=s.OnlineMeetingJoinUrl&&(e.OnlineMeetingJoinUrl=s.OnlineMeetingJoinUrl),s.IsDraft&&void 0===e.IsDraft&&(e.IsDraft=s.IsDraft),Object(a.d)([s])):r.h.info("[SharedCacheFunctions] addOrModifyItemInCache: Skipping removal of old item from cache as no old item was found"),!s&&t||(l||(Object(d.w)(c,[e],[{start:e.Start,end:e.End}]),Object(a.c)([e])),i?Object(d.u)(e):Object(d.t)(e))}async function l(e,n=!1){await Object(i.a)(e,n)}},648:function(e,n,t){"use strict";t.d(n,"a",(function(){return a})),t.d(n,"b",(function(){return i})),t.d(n,"c",(function(){return r}));const a=110,i=3,r=1},732:function(e,n,t){"use strict";var a=t(2);const i=Object(a.action)("poll",(e,n,t)=>({requestFunction:e,requestIdentifier:n,interval:t})),r=Object(a.action)("cancelPoll",e=>({requestIdentifier:e}));const o={currentRequest:new(t(13).ObservableMap)};let d=Object(a.createStore)("requestIdStore",o);Object(a.mutator)(r,e=>{const n=d().currentRequest.get(e.requestIdentifier);if(!n)return;let t=n.timer;clearTimeout(t),n.timer=null});const c=Object(a.mutatorAction)("setCurrentRequestId",(e,n)=>{let t=d().currentRequest.get(e);t?t.requestId=n:d().currentRequest.set(e,{requestId:n,timer:null})});function l(e,n){return d().currentRequest.get(e).requestId===n}async function s(e,n){const t=Math.random();c(n,t);let a=await e();const i={isCurrent:l(n,t)};return Object.assign({response:a},i)}const u=Object(a.mutatorAction)("setPollTimer",(e,n)=>{const t=d().currentRequest.get(e);t&&(t.timer=n)});Object(a.orchestrator)(i,e=>{const{requestFunction:n,requestIdentifier:t,interval:a}=e;r(t);const o=setTimeout(()=>(async function(e,n,t){await s(()=>e(),n),i(e,n,t)})(n,t,a),a);u(t,o)}),t.d(n,"c",(function(){return s})),t.d(n,"b",(function(){return i})),t.d(n,"a",(function(){return r}))},756:function(e,n,t){"use strict";var a=t(201),i=t(980),r=t(2),o=t(99),d=t(210),c=t(773);Object(r.orchestrator)(d.a,e=>{const{previousEvents:n,reloadedEvents:t}=e;t&&(n&&Object(d.d)(n),Object(d.c)(t))}),Object(r.orchestrator)(o.q,e=>{const{folderId:n,instanceKey:t}=e;let a=null;Object(o.k)(n,t,e=>{a=e}),a&&(a.forEach(e=>Object(o.s)(n,e.Key)),Object(d.d)(a))}),Object(r.orchestrator)(o.b,e=>{const{lockId:n,folderId:t,dateRange:a,calendarEvents:i}=e;Object(o.i)(n,t,a,i),i&&Object(d.c)(i)}),Object(r.orchestrator)(o.a,e=>{const{folderId:n,calendarEvents:t}=e,r=Object(a.d)(n),{eventsOverlapping:c}=Object(i.a)(t,r);c.length>0&&(Object(o.w)(n,c,r),Object(d.c)(c))}),Object(r.orchestrator)(o.c,e=>{const{folderId:n,eventsReloaded:t,dateRanges:r,forceReplace:c}=e,l=Object(a.a)(n),{eventsOverlapping:s}=Object(i.a)(l,r);Object(o.w)(n,t,r,c),Object(d.a)(s,t)}),Object(r.orchestrator)(d.f,e=>{const{folderId:n}=e;Object(c.e)(n),Object(o.p)(n),Object(o.j)(n)});var l=t(5),s=t(1518),u=t(122),f=t(883),m=t(892),v=t(251),b=t.n(v);function I(e,n){const t=function(e){return Object(f.d)(e)?O:Object(f.h)(e)?j:Object(f.e)(e)?p:(Object(f.i)(e),null)}(e.Recurrence);if(!t)return[Object.assign({},e)];const a=Object(m.a)(n),i=[];let r=e.Recurrence.RecurrencePattern.Interval;a.forEach(n=>{let a=function(e,n){let t=Object(l.ac)(e.Start),a=Object(s.a)(t.tz,e.Recurrence),i={start:t,end:a};return function(e,n){e.start=Object(l.p)(e.start,n.start)>0?e.start:n.start,e.end=null!=e.end&&Object(l.p)(e.end,n.end)<0?e.end:n.end}(i,n),i}(e,n),o=t(e,a,r);i.push(...o)});let o=Object(l.x)(e.Start,Object(l.ac)(e.Start)),d=Object(l.x)(e.End,Object(l.ac)(e.Start));return function(e,n,t,a){let i=[];return a.forEach(a=>{let r={};b()(r,e),r.Start=Object(l.h)(a,n),r.End=Object(l.h)(a,t),r.CalendarItemType="Occurrence",i.push(r)}),i}(e,o,d,i)}function O(e,n,t){let a=[],i=Object(l.s)(n.end,n.start);for(let e=0;e<=i;e+=t){let t=Object(l.e)(n.start,e);a.push(t)}return a}function j(e,n,t){let a=[],i=e.Recurrence.RecurrencePattern,r=i.DaysOfWeek.split(" ").map(e=>k(e)),o=Math.max(k(i.FirstDayOfWeek),0),d=n.start;for(;Object(l.p)(d,n.end)<=0;){let e=d,i=Object(l.C)(e,o);for(;Object(l.p)(e,i)<=0;)r.includes(Object(l.ob)(e))&&Object(u.t)(n,e)&&a.push(e),e=Object(l.e)(e,1);d=Object(l.ec)(Object(l.e)(d,7*t),o)}return a}function p(e,n,t){let a=[];if(Object(f.b)(e.Recurrence)){let i=e.Recurrence.RecurrencePattern.DayOfMonth,r=n.start;for(;Object(l.p)(r,n.end)<=0;){let e=r,o=Object(l.B)(e);for(;Object(l.p)(e,o)<=0;)Object(l.mb)(e)==i&&Object(u.t)(n,e)&&a.push(e),e=Object(l.e)(e,1);r=Object(l.dc)(Object(l.i)(r,t))}}else{let i=e.Recurrence.RecurrencePattern,r=k(i.DaysOfWeek),o=-1;switch(i.DayOfWeekIndex){case"First":o=1;break;case"Second":o=2;break;case"Third":o=3;break;case"Fourth":o=4}let d=n.start;for(;Object(l.p)(d,n.end)<=0;){let e;e=o>0?y(r,o,d):E(r,d),Object(u.t)(n,e)&&a.push(e),d=Object(l.dc)(Object(l.i)(d,t))}}return a}function k(e){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].indexOf(e)}function y(e,n,t){const a=Object(l.dc)(t),i=(e-Object(l.ob)(a)+7)%7+7*(n-1);return Object(l.e)(a,i)}function E(e,n){let t=y(e,5,n);return Object(l.Ab)(t)==Object(l.Ab)(n)?t:y(e,4,n)}var g=t(498),F=t(429);function S(e,n){if(n){const n=e.ParentFolderId.Id;e.Recurrence&&Object(o.r)(n,n=>n.InstanceKey==e.InstanceKey),Object(o.r)(n,n=>n.ItemId.Id===e.ItemId.Id)}}Object(r.orchestrator)(d.g,async e=>{const{eventToCreate:n,actionToExecute:t,actionSource:i,onEventCreatedFailed:r,onEventCreatedSuccess:c,errorMessage:l,onEventCreatedLocally:s}=e,u=function(e){return Object(a.i)(e.ParentFolderId.Id)}(n);!function(e,n,t,i,r){if(n){const n=e.ParentFolderId.Id;if(e.Recurrence){const t=Object(a.d)(n);let i=I(e,t);Object(F.a)(i,!1);let r=i.map(e=>Object.assign(Object.assign({},e),{CalendarItemType:"Occurrence"}));Object(o.a)(n,r)}Object(F.b)(e);const t=e.Recurrence?Object.assign(Object.assign({},e),{CalendarItemType:"RecurringMaster"}):e;Object(o.a)(n,[t])}t(i,r)}(n,u,s,n.IsDraft,i);let f=()=>Object(d.g)(n,t,()=>r(l,null,i),c,i,l),m=null;try{m=await t(n)}catch(e){throw S(n,u),r(e,f,i),e}let v=null;if(!m.isSuccessful)throw S(n,u),r(l,f,i),l;v=m.createdItem,function(e,n,t){n.ParentFolderId||(n.ParentFolderId=Object.assign({},e.ParentFolderId));if(t){const t=n.ParentFolderId.Id;Object(o.r)(t,n=>n.ItemId.Id===e.ItemId.Id),Object(g.a)(n,!0,!1)}}(n,v,u),c(v)});var h=t(1);function N(e,n){const t={Key:e,Start:n.Start,End:n.End};return b()(n,t),n}var R=t(386),C=t(272),T=t(253);var A=t(338),P=t(648),M=t(254),D=t(1460);function w(e,n=!1){return n?x(e):Object(D.c)(e)}function x(e){var n;return null===(n=e.SeriesMasterItemId)||void 0===n?void 0:n.Id}function _(e){if(!e)return;const n=Object(T.a)();n.calendarFolderEvents.get(e)||n.calendarFolderEvents.set(e,Object(M.f)())}Object(r.mutator)(o.n,e=>{const{lockId:n}=e,t=Object(T.a)();[...t.calendarFolderEvents.keys()].forEach(e=>{t.calendarFolderEvents.get(e).locksInfo.get(n)&&Object(M.n)(n,t.calendarFolderEvents.get(e))}),t.fullItemsMruMap.delete(n)}),Object(r.mutator)(o.f,e=>{const{folderId:n,eventKey:t,event:a}=e,i=Object(C.d)(t,n);i&&Object(M.q)(i,a,!0)}),Object(r.mutator)(o.t,e=>{let{partialCalendarEvent:n}=e;!function(e){var n;if(function(e){const n=e;return!!n.Key&&void 0!==n.Start&&void 0!==n.End}(e)){const{Key:n}=e,t=Object(h.__rest)(e,["Key"]);e=t}const t=w(e),a=null===(n=e.ParentFolderId)||void 0===n?void 0:n.Id;if(a){const n=Object(C.d)(t,a);n&&Object(M.q)(n,e)}}(n)}),Object(r.mutator)(o.m,e=>{const{events:n}=e;n.forEach(e=>{const n=Object(C.b)(e.ItemId.Id);n&&(Object(A.w)(n)&&(delete e.RequiredAttendees,delete e.OptionalAttendees),Object(M.q)(n,e))})}),Object(r.mutator)(o.i,e=>{const{lockId:n,folderId:t,dateRange:i,calendarEvents:r}=e;_(t);const o=Object(a.f)(t),d=Object(R.a)(),c=r.filter(e=>!Object(A.K)(e.CalendarItemType)).map(e=>N(e.ItemId.Id,e)).filter(e=>!d[e.Key]);Object(M.b)(i,c,n,o);const{lockedDateRange:s}=o.locksInfo.get(n);if(Object(l.s)(s.end,s.start)>P.a){const e=function(e,n,t){const a=Object(l.s)(n.end,n.start);if(a===t)return n;if(a>t)return{start:n.start,end:Object(l.e)(n.start,t)};{let i=t-a;const r=Math.abs(Object(l.s)(n.end,e.end)),o=Math.abs(Object(l.s)(e.start,n.start));let{start:d,end:c}=n;if(r>0){const e=Math.min(i,r);c=Object(l.e)(c,e),i-=e}if(i>0&&o>0){const e=Math.min(i,o);d=Object(l.e)(d,-1*e)}return{start:d,end:c}}}(s,i,P.a);Object(M.h)(e,n,o)}}),Object(r.mutator)(o.k,e=>{const{folderId:n,instanceKey:t,onEventsRemoved:i}=e;_(n);const r=Object(a.f)(n);i(Object(M.o)(e=>e.InstanceKey===t,r))}),Object(r.mutator)(o.l,e=>{const{folderId:n,predicate:t,onEventsRemoved:i}=e;_(n);const r=Object(a.f)(n);i(Object(M.o)(t,r))}),Object(r.mutator)(o.j,e=>{const{folderId:n}=e;Object(T.a)().calendarFolderEvents.delete(n)}),Object(r.mutator)(o.w,e=>{const{folderId:n,calendarEvents:t,dateRanges:i,forceReplace:r}=e;_(n);const o=t.map(e=>N(e.ItemId.Id,e)),d=Object(a.f)(n);r?Object(M.p)(o,d,i):Object(M.r)(o,d.events)}),Object(r.mutator)(o.v,e=>{b()(e.existingItem,e.updatedItem)});var L=t(1127);const K=new Map;const U=5;function q(e,n,t,a){V(n,t);const{eventKey:i}=e,r=t.get(n),{eventInfos:o}=r,[d]=o.filter(e=>e.eventKey===i);if(d){$(r.eventInfos.indexOf(d),e,r)}else o.push(e),function(e,n){!function(e,n,t){for(;e.eventInfos.length>n&&0<e.eventInfos.length;)H(0,e,t)}(e,e.maxSize||U,n)}(r,a);[...t.keys()].forEach(n=>{const{eventInfos:a}=t.get(n);a.forEach(n=>{e.eventKey===n.eventKey&&(n.itemResponseShapeType=e.itemResponseShapeType)})})}function B(e,n,t,a=(()=>{})){V(n,t);const i=t.get(n),[r]=i.eventInfos.filter(n=>n.eventKey===e),o=i.eventInfos.indexOf(r);return-1!==o&&H(o,i,a),-1!==o}function V(e,n){if(!n.get(e)){const t=function(e){return K.get(e)}(e);n.set(e,{eventInfos:[],maxSize:t})}}function $(e,n,t){if(-1===e)throw new Error(`Item with eventKey ${n.eventKey} does not exist in the MRU`);t.eventInfos.splice(e,1),t.eventInfos.push(n)}function H(e,n,t){if(e<0||e>=n.eventInfos.length)throw new Error(`Invalid index to remove ${e}`);const a=n.eventInfos[e];n.eventInfos.splice(e,1),t(a.eventKey)}function z(e){if(!e)return;const n=Object(T.a)();n.calendarFolderEvents.get(e)||n.calendarFolderEvents.set(e,Object(M.f)())}function W(e,n){return t=>{Object(M.i)([t],e,Object(T.a)().calendarFolderEvents.get(n))}}Object(r.mutator)(o.d,e=>{const{eventKey:n,folderId:t,lockId:a,partialCalendarEvent:i,itemResponseShapeType:r}=e;z(t);const o=Object(T.a)();if(i){const e=N(n,i);Object(M.a)(e,a,o.calendarFolderEvents.get(t))}q({eventKey:n,itemResponseShapeType:r,folderId:t,loadState:0},a,o.fullItemsMruMap,W(a,t))}),Object(r.mutator)(o.e,e=>{const{eventKey:n,folderId:t,lockId:a,itemResponseShapeType:i}=e;z(t),q({eventKey:n,itemResponseShapeType:i,folderId:t,loadState:2},a,Object(T.a)().fullItemsMruMap,W(a,t))}),Object(r.mutator)(o.g,e=>{const{lockId:n,eventKey:t,folderId:a,event:i,hasEventChanged:r,itemResponseShapeType:o,forceOverrideAllPropertiesForEventIfAvailable:d}=e;z(a);const c=Object(T.a)(),l=N(t,i);Object(M.a)(l,n,c.calendarFolderEvents.get(a),r,d),q({eventKey:t,itemResponseShapeType:o,folderId:a,loadState:1},n,c.fullItemsMruMap,W(n,a))}),Object(r.mutator)(o.s,e=>{const{folderId:n,eventKey:t}=e,a=Object(T.a)();a.calendarFolderEvents.get(n)&&[...a.fullItemsMruMap.keys()].forEach(e=>{B(t,e,a.fullItemsMruMap)})}),Object(r.mutator)(o.p,e=>{const{folderId:n}=e,t=Object(T.a)(),a=t.calendarFolderEvents.get(n);if(a){const e=[...a.locksInfo.entries()].reduce(Object(M.d)(),{}),n=Object.keys(e);[...t.fullItemsMruMap.keys()].forEach(e=>{n.forEach(n=>B(n,e,t.fullItemsMruMap))})}}),Object(r.mutator)(L.a,()=>{const e=Object(T.a)();[...e.fullItemsMruMap.keys()].forEach(n=>{!function(e,n){V(e,n),n.get(e).eventInfos=[]}(n,e.fullItemsMruMap)})}),Object(r.mutator)(o.h,e=>{const n=Object(T.a)(),{lockId:t,eventKey:a}=e;!function(e,n,t){V(n,t);const a=t.get(n),{eventInfos:i}=a,[r]=i.filter(n=>n.eventKey===e);if(r){$(a.eventInfos.indexOf(r),r,a)}}(a,t,n.fullItemsMruMap)});var G=t(381),J=t(796);function Z(e,n){var t;if(3==n){const n=Object(C.b)(e);t=(null==n?void 0:n.SeriesMasterItemId)?Object(G.a)({Id:n.SeriesMasterItemId.Id}):t=Object(J.a)({OccurrenceId:e})}else t=Object(G.a)({Id:e});return t}function Q(e,n,t){t&&(Object(o.w)(n,e,null,!1),Object(d.c)(e))}Object(r.orchestrator)(d.h,async e=>{const{eventId:n,eventScope:t,dataPoint:i,actionToExecute:r,onEventDeleteSuccess:c,onEventDeleteFailed:s,responseSent:u,actionSource:f,errorMessage:m,asyncUndoAction:v}=e,b=Object(C.b)(n.Id);let I=function(e){return e&&Object(a.i)(e.ParentFolderId.Id)}(b);const O=function(e,n,t){let a=[];if(t){const t=e.ParentFolderId.Id;if(3==n||2==n){let i=e.Start;a=Object(o.r)(t,t=>t.InstanceKey==e.InstanceKey&&(3==n||2==n&&!Object(l.Jb)(t.Start,i)))}else a=Object(o.r)(t,n=>n.ItemId.Id===e.ItemId.Id)}return a}(b,t,I);i&&i.markUserPerceivedTime();let j=Z(n.Id,t),p=null;try{if(await v(b,u,f))return void Q(O,b.ParentFolderId.Id,I);if(p=await r(j),!p.isSuccessful)throw new Error(m)}catch(e){Q(O,b.ParentFolderId.Id,I);let a=()=>Object(d.h)(n,t,null,r,c,()=>s(e,null,f),f,m,u);throw s(e,a,f),e}c()});var Y=t(1126);Object(r.orchestrator)(o.u,async e=>{const n=e.partialCalendarEvent,t=await Object(Y.a)(n);if(t){const e=w(n),a=n.ParentFolderId.Id,i=Object(R.b)(n.ItemId.Id);Object(o.f)(a,e,i,t)}});var X=t(284);Object(r.orchestrator)(d.i,async e=>{var n;const{eventId:t,eventChanges:i,errorMessage:r,actionToExecute:c,onEventUpdateFailed:s,onEventUpdateSuccess:u,onEventUpdatedLocally:f,actionSource:m}=e;let v=e.eventScope,b=Object(C.b)(t.Id),O=Z(t.Id,e.eventScope);b&&Object(A.K)(b.CalendarItemType)&&(v=3);let j=function(e,n){if(!e)return!1;let t=e.ParentFolderId.Id;if(!Object(a.i)(t))return!1;let i=n.ParentFolderId;if(i&&i.Id!=t)return!1;return!0}(b,i);j&&function(e,n,t,i,r){const c=e.ParentFolderId.Id;!Object(A.H)(e.CalendarItemType)||0!=t&&1!=t||(n.CalendarItemType="Exception");let s=Object.assign(Object.assign({},e),n);if(3==t||2==t)if(n.Recurrence||n.Start||n.StartTimeZoneId||n.End||n.EndTimeZoneId||2==t){let i=e.Start;if(Object(o.r)(c,n=>(Object(A.H)(n.CalendarItemType)||Object(A.A)(n.CalendarItemType))&&n.InstanceKey==e.InstanceKey&&(3==t||2==t&&!Object(l.Jb)(n.Start,i))),3===t||2===t){let i=Object(a.d)(c);2===t&&(i=i.map(e=>({start:Object(l.Ub)(e.start.tz,e.start),end:Object(l.Ub)(e.end.tz,e.end)})),function(e,n){let t=[];e.forEach((e,a)=>{Object(l.p)(e.start,n)<=0&&Object(l.p)(e.end,n)<=0&&t.push(a),Object(l.p)(e.start,n)<=0&&Object(l.p)(e.end,n)>0&&(e.start=Object(l.ac)(n))}),t.reverse().forEach(n=>{e.splice(n,1)})}(i,e.Start));let r=s;"Occurrence"!=s.CalendarItemType||s.Recurrence||(r=Object(C.b)(s.SeriesMasterItemId.Id),r||(r=s));let d=I(r,i);Object(F.a)(d.concat(s),!0),delete n.Start,delete n.End;let u=d.map(e=>Object.assign(Object.assign(Object.assign({},e),n),{CalendarItemType:"Occurrence"}));Object(o.a)(s.ParentFolderId.Id,u)}}else{let t=Object(C.a)(c,n=>n.InstanceKey==e.InstanceKey&&Object(A.H)(n.CalendarItemType));for(let e of t){let t=e;Object(o.v)(t,n),Object(d.b)(t)}}if(!Object(A.A)(e.CalendarItemType)||3!=t){let n=null==e.InstanceKey||Object(A.H)(e.CalendarItemType)||Object(A.A)(e.CalendarItemType);Object(g.a)(s,n,!0)}i(s,r)}(b,i,v,f,m);let p=()=>Object(d.i)(t,i,v,c,u,()=>s(r,null,m),m,r),k=null;try{k=await c(O)}catch(e){throw j&&Object(g.b)(b.ParentFolderId.Id),s(e,p,m),e}if(!k.isSuccessful)throw j&&Object(g.b)(b.ParentFolderId.Id),s(r,p,m),r;(null===(n=i.ParentFolderId)||void 0===n?void 0:n.mailboxInfo)&&Object(X.r)(i.ParentFolderId.mailboxInfo.userIdentity)&&(Object(g.b)(i.ParentFolderId.Id,!0),Object(g.b)(b.ParentFolderId.Id,!0)),u()});var ee=t(80),ne=t(884);Object(r.orchestrator)(ee.l,ne.a);var te=t(20),ae=t(79);function ie(e){let n=Object(ae.l)(e);return n?n.CharmId:null}function re(e){return(null==e?void 0:e.CharmId)||ie(e.ParentFolderId.Id)}var oe=t(732),de=t(895),ce=t(217);function le(){Object(a.b)().map(e=>{Object(ce.h)(Object(ae.l)(e))&&Object(de.a)(e,!0)})}const se=3e5;function ue(e){e?Object(oe.b)(le,"RELOAD_LINKEDCALENDAR_ENTRIES",se):Object(oe.a)("RELOAD_LINKEDCALENDAR_ENTRIES")}function fe(e,n,t){let a=null;return a="Decline"===t?"Free":"Free"===e&&"Decline"!==n?"Free":"Accept"===t?"Busy":"Tentative",{FreeBusyType:a,AppointmentReplyTime:Object(l.Tb)(),ResponseType:t}}var me=t(1116),ve=t(1509),be=t(1123),Ie=t(72),Oe=t(1122),je=t(68),pe=t(22),ke=t(1508),ye=t(13);const Ee={};function ge(e,n){return e+n}function Fe(e,n){const t=ge(e,n);return Ee[t]||Promise.resolve({calendarEvent:null,error:"Could not find full event promise in existing promises"})}function Se(e,n,t=null,a,i={fetchSource:"unknown"},r){var o,d,c;const l=Ne(t,a);r||(r=Object(R.b)(n.Id));const s=Object(R.e)(n.Id,r);let u;if(s)u=function(e,n,t,a,i,r){const o=i(n);switch(t.loadState){case 1:return{event:o,fullEventPromise:Promise.resolve({calendarEvent:o,error:null}),promiseSource:2};case 0:return{event:o,fullEventPromise:Fe(n.Id,r),promiseSource:0};case 2:const i=Ce(o,n,a,e,r);return Object.assign({event:o},i);default:return Object(Ie.a)(t.loadState)}}(t=t||s.folderId,n,s,!1,l,r);else{const e=l(n),a=Ce(e,n,!1,t||(null===(o=null==e?void 0:e.ParentFolderId)||void 0===o?void 0:o.Id)||null,r);u=Object.assign({event:e},a)}let f=null;return u&&(t=t||(null===(c=null===(d=u.event)||void 0===d?void 0:d.ParentFolderId)||void 0===c?void 0:c.Id)||null,f={event:u.event,fullEventPromise:Te(u.fullEventPromise,u.promiseSource,u.event,e,t,i,n.Id,!1,r)}),f}function he(e,n,t=null,a,i={fetchSource:"unknown"},r){var o,d,c;let l;const s=Ne(t,a)(n);t=t||(null===(o=null==s?void 0:s.ParentFolderId)||void 0===o?void 0:o.Id);const u=s&&x(s);r||(r=u?Object(R.b)(u):Object(R.c)()),l=function(e,n,t,a,i){const r=a&&Object(R.e)(a,t);if(r&&1===r.loadState){const n=Object(C.d)(a,e);return{event:n,fullEventPromise:Promise.resolve({calendarEvent:n,error:null}),promiseSource:2}}if(r&&0===r.loadState){return{event:Object(C.d)(a,e)||Re(i),fullEventPromise:Fe(a,t),promiseSource:0}}return{event:Re(i),fullEventPromise:Ae(n,!0,e,t),promiseSource:0}}(t,n,r,u,s);let f=null;return l&&(t=t||(null===(c=null===(d=l.event)||void 0===d?void 0:d.ParentFolderId)||void 0===c?void 0:c.Id)||null,f={event:l.event,fullEventPromise:Te(l.fullEventPromise,l.promiseSource,l.event,e,t,i,u,!0,r)}),f}function Ne(e,n){return t=>{return Object(C.b)(t.Id,e)||(null==n?void 0:n(t))}}function Re(e){return e&&Object.assign(Object.assign({},Object(ke.a)(Object(ye.toJS)(e))),{ItemId:Object.assign({},null==e?void 0:e.SeriesMasterItemId),CalendarItemType:"RecurringMaster"})}function Ce(e,n,t,a,i){return e&&e.EffectiveRights&&!Object(A.v)(e)?{fullEventPromise:Promise.resolve({calendarEvent:e,error:null}),promiseSource:1}:{fullEventPromise:Ae(n,t,a,i),promiseSource:0}}async function Te(e,n,t,a,i,r,c,l,s){let u=Object(R.d)(a,c,s),f=null,m=null,v=null;try{if(pe.h.info(`[fetchFullCalendarEvent] Handling loading full calendar event Key: ${c}, Lock: ${a}`),!i||u&&1===u.loadState||c&&(pe.h.info(`[fetchFullCalendarEvent] Loading full calendar event Key: ${c}, Lock: ${a}`),function(e,n,t){const a=ge(e,n);Ee[a]=t}(c,s,e),Object(o.d)(a,i,c,s,t)),2==n)f=t;else{const n=await e;f=null==n?void 0:n.calendarEvent,m=null==n?void 0:n.error,v=null==n?void 0:n.responseCode,void 0===c&&(c=w(n.calendarEvent))}if(!f){const e=new Error(`[fetchFullCalendarEvent] Action source:${r.fetchSource} with response code: ${null!=v?v:"<null>"} and error: ${m}`);throw v&&(e.responseCode=v,e.fetchErrorType="ServerFailure"),e.diagnosticInfo=JSON.stringify({responseCode:v,eventKey:c}),e}const b=i||f.ParentFolderId.Id,I=u;if(u=Object(R.d)(a,c,s),!b||u&&1===u.loadState)pe.h.info(`[fetchFullCalendarEvent] Full calendar event already loaded. EventKey: "${c}", Lock: "${a}", FolderId: "${b}"`),Object(o.h)(a,c);else{pe.h.info(`[fetchFullCalendarEvent] Loaded full calendar event Key: "${c}", Lock: "${a}", FolderId: "${b}"`),Object(je.p)("FullCalendarEventLoaded",Object.assign({eventKey:c,lockId:a,prevFullItemLoadState:I?I.loadState:null,fullItemLoadState:u?u.loadState:null,isFullItem:void 0!==f.RequiredAttendees,isSameAsExistingEvent:t===f,eventScope:l?3:0,errorMessage:null},r));const e=0===n;Object(o.g)(a,b,c,s,f,l,e)}const O=Object(C.d)(c,i);return O&&Object(d.b)(O),O}catch(m){const e=u;throw u=Object(R.d)(a,c,s),Object(je.p)("FullCalendarEventLoaded",Object.assign({eventKey:c,lockId:a,prevFullItemLoadState:e?e.loadState:null,fullItemLoadState:u?u.loadState:null,isFullItem:!1,isSameAsExistingEvent:!1,eventScope:l?3:0,errorMessage:m.toString()},r)),i&&("ErrorItemNotFound"===m.responseCode?Object(o.r)(i,e=>w(e)===c):Object(o.e)(a,i,c,s)),m}finally{!function(e,n){const t=ge(e,n);delete Ee[t]}(c,s)}}function Ae(e,n,t,a){return(()=>(async function(e,n,t,a,i){let r=0;for(;r<e;)try{const o=await Object(Oe.a)(n,a,i,t);if(r++,!o.error||r>=e)return o}catch(t){if(pe.h.warn(`[fetchFullCalendarEvent] Received error when trying to load calendar event from server for "${n.Id}" with try ${r}: Error ${t.toString()}`),r++,r>=e||"ErrorItemNotFound"===t.responseCode)throw t}return{calendarEvent:null,error:"Error: Unable to fetch event"}})(P.b,e,n,t,a))()}function Pe(e){if(!e)throw new Error("The lock id should be provided");return{fetchCalendarEventsForDateRange:(n,t)=>{const{fetchPromise:a,enhancedFetchPromise:i,events:r}=Object(be.a)(e,n,t);return{fetchPromise:a,enhancedFetchPromise:i,events:r}},subscribeNotifications:n=>Object(c.c)(n,e),fetchFullCalendarEvent:(n,t,a,i,r)=>{let o=Object(C.b)(n.Id),{event:d,fullEventPromise:c}=Me(e,n,t,a,i,r,(null==o?void 0:o.IsOrganizer)?"WithBlockedExternalContent":null);return c=c.then(async o=>{if(o.IsOrganizer&&o.HasBlockedImages){let{fullEventPromise:d}=Me(e,n,t,a,i,r,"WithBlockedExternalContent");o=await d}return o}),{event:d,fullEventPromise:c}},fetchFullCalendarEventAndUpdateItemResponseShapeType:(n,t,a,i,r,o)=>Me(e,n,a,i,r,o,t),getLockId:()=>e,release:()=>Object(o.o)(e)}}function Me(e,n,t,a,i,r,o){return i?he(e,n,t,a,r,o):Se(e,n,t,a,r,o)}function De(e,n){const t=Object(M.g)(e);return n&&function(e,n){n?K.set(e,n):K.delete(e)}(t,n.maxMruSize),Pe(t)}var we=t(893),xe=t(983);function _e(e){return{getCalendarEventsForDateRange:(n,t)=>Object(we.a)(e,n,t),getEnhancedCalendarEventsForDateRange:(n,t)=>(function(e,n,t){return Object(xe.b)(n,t)?Object(we.a)(e,n,t):null})(e,n,t),getFullCalendarEvent:(n,t)=>Object(C.e)(n,t,e)}}function Le(e){const n=Object(T.a)(),{calendarFolderWorkingHours:t}=n;return t.get(e)}t.d(n,"u",(function(){return Ue})),t.d(n,"k",(function(){return C.b})),t.d(n,"c",(function(){return d.d})),t.d(n,"b",(function(){return d.c})),t.d(n,"a",(function(){return d.b})),t.d(n,"d",(function(){return d.e})),t.d(n,"g",(function(){return d.f})),t.d(n,"v",(function(){return d.j})),t.d(n,"r",(function(){return d.g})),t.d(n,"t",(function(){return d.i})),t.d(n,"s",(function(){return d.h})),t.d(n,"y",(function(){return c.b})),t.d(n,"z",(function(){return c.d})),t.d(n,"i",(function(){return ie})),t.d(n,"m",(function(){return re})),t.d(n,"o",(function(){return Z})),t.d(n,"n",(function(){return R.f})),t.d(n,"w",(function(){return ue})),t.d(n,"j",(function(){return fe})),t.d(n,"x",(function(){return ne.a})),t.d(n,"h",(function(){return me.a})),t.d(n,"e",(function(){return ve.a})),t.d(n,"f",(function(){return De})),t.d(n,"q",(function(){return Pe})),t.d(n,"p",(function(){return _e})),t.d(n,"l",(function(){return Le}));const Ke=new te.c(()=>Promise.all([t.e(0),t.e(1065)]).then(t.bind(null,20137)));let Ue=new te.a(Ke,e=>e.getCalendarEventsFromRest)},773:function(e,n,t){"use strict";var a=t(892),i=t(210),r=t(272),o=t(68),d=t(79),c=t(338),l=t(421),s=t(1116),u=t(1527),f=t(25),m=function(e){Object(f.k)("cal-notificationDiagnostics")&&setTimeout(()=>Object(u.a)(e),0)},v=t(429),b=t(122),I=t(99),O=t(937),j=t(498),p=t(201),k=t(884),y=t(732);const E=864e5;t.d(n,"c",(function(){return A})),t.d(n,"e",(function(){return P})),t.d(n,"a",(function(){return L})),t.d(n,"d",(function(){return q})),t.d(n,"b",(function(){return B}));const g={RowAdded:"RowAdded",RowModified:"RowModified",RowDeleted:"RowDeleted",Reload:"Reload"},F=2e3;let S,h={},N={},R=[],C=!0,T=!0;function A(e,n){if(T&&(Object(y.b)(k.a,"RELOAD_CALENDAR_SUBSCRIPTIONS",E),T=!1),h[e])return h[e].locks[n]=!0,void m({message:"Already subscribed to calendar item notifications for folder",folderId:e});const t=Object(d.l)(e);if(!t)return void m({message:"Calendar entry not found to subscribe to notifications for folder",folderId:e});const a=Object(d.E)(t);if(a){const t=Object(f.k)("cal-surface-declinedMeetings");O.b.import().then(i=>{const r=Object.assign(Object.assign({},a),{ChannelId:i(),NotificationType:"CalendarItemNotification",IncludeDeclinedMeetings:t}),o={subscriptionId:`${r.NotificationType}${e}`+(t?"declinedMeetings":""),requiresExplicitSubscribe:!0,subscriptionParameters:r},d={folderId:e,subscription:o,locks:{[n]:!0}};m({message:`Subscribing to calendar item notifications for folder with includeDeclinedMeetings = ${t}`,folderId:e}),O.j.importAndExecute(o,M),h[e]=d})}}function P(e){const n=h[e];n?(m({message:"Unsubscribing from calendar item notifications for folder",folderId:e}),O.k.importAndExecute(n.subscription,M),delete h[e]):m({message:"Could not unsubscribe calendar item notifications for folder due to subscription data not found",folderId:e})}function M(e){x(e,!0),function(e){if(R.some(e=>_(e.NotificationPayload)))m({message:"A reload notification is in the queue. No additional notifications will be added",notificationPayload:e.NotificationPayload});else if(_(e.NotificationPayload))m({message:"A reload notification will be enqueued. All existing notifications will be discarded.",notificationPayload:e.NotificationPayload}),R=[],R[0]=e;else{for(let n=R.length-1;n>=0;n--){let t,a,i,r=R[n].NotificationPayload.Item;if(null!=e.NotificationPayload.Item.InstanceKey?(a=e.NotificationPayload.Item.InstanceKey,t=r.InstanceKey,i="InstanceKey"):(a=e.NotificationPayload.Item.ItemId.Id,t=r.ItemId.Id,i="ItemId"),a===t){m({message:`Found an existing notification in the queue for the same ${i}. Old notification will be removed.`,notificationPayload:e.NotificationPayload}),R[n].InstanceKeyToDelete&&(e.InstanceKeyToDelete=R[n].InstanceKeyToDelete),R.splice(n,1);break}}let n=!1;if(null!=e.NotificationPayload.Item.InstanceKey)if(e.NotificationPayload.EventType==g.RowModified&&Object(c.K)(e.NotificationPayload.Item.CalendarItemType)&&null!=e.NotificationPayload.Item.UID&&(N[e.NotificationPayload.Item.InstanceKey]=e.NotificationPayload.Item.UID),e.NotificationPayload.EventType===g.RowAdded||e.NotificationPayload.EventType===g.RowModified){for(let n=R.length-1;n>=0;n--)if(R[n].NotificationPayload.EventType===g.RowDeleted&&R[n].OriginalUID==e.NotificationPayload.Item.UID){m({message:"Found an existing RowDeleted notification in the queue for the same UID, which will be removed from the queue.",notificationPayload:e.NotificationPayload}),e.InstanceKeyToDelete=R[n].NotificationPayload.Item.InstanceKey,R.splice(n,1);break}}else if(e.NotificationPayload.EventType===g.RowDeleted){let t=N[e.NotificationPayload.Item.InstanceKey];if(delete N[e.NotificationPayload.Item.InstanceKey],t){e.OriginalUID=t;for(let a=R.length-1;a>=0;a--){let i=R[a].NotificationPayload.Item.UID;if((R[a].NotificationPayload.EventType===g.RowAdded||R[a].NotificationPayload.EventType===g.RowModified)&&i==t){m({message:"Found an existing RowAdded or RowModified notification in the queue for the same UID, which will be merged with the RowDelete.",notificationPayload:e.NotificationPayload}),R[a].InstanceKeyToDelete=e.NotificationPayload.Item.InstanceKey,n=!0;break}}}}n?m({message:"RowDeleted notification was merged with a RowAdded notification for the same UID and will not be enqueued",notificationPayload:e.NotificationPayload}):(m({message:"Notification will be enqueued",notificationPayload:e.NotificationPayload}),R.push(e))}m({message:`Notification queue length is ${R.length}`})}({NotificationPayload:e,InstanceKeyToDelete:null,OriginalUID:null}),C?(S&&(m({message:"Notification processing timer was already started. It will be cancelled and restarted."}),clearTimeout(S)),S=setTimeout(w,F),m({message:"Timer to drain queue has started"})):m({message:"The notification was received while notification processing was suspended"})}function D(e){var n,t;if(x(e.NotificationPayload,!1),_(e.NotificationPayload))L();else{let a=e.NotificationPayload.FolderId;const i=null===(n=e.NotificationPayload.Item)||void 0===n?void 0:n.SkypeTeamsProperties;Object(f.k)("cal-showAddTeamsCalendars")&&i&&!Object(d.l)(a)&&(a=function(e,n){let t=JSON.parse(n);if(null==t?void 0:t.cid){const n=t.cid.split("@")[0];e=n?Object(d.Q)(e,n):e}return e}(a,i),(null===(t=e.NotificationPayload.Item)||void 0===t?void 0:t.ParentFolderId)&&(e.NotificationPayload.Item.ParentFolderId.Id=a));const o=Object(p.i)(a),u=Object(p.d)(a),v=Object(p.e)(a),O=Object(d.l)(a),k=Object(d.z)(a);O&&3==O.CalendarFolderType?L(a):o&&(u.length>0||Object.keys(v).length>0)?e.NotificationPayload.EventType==g.RowDeleted?function(e,n){let t=n.Item.InstanceKey;const a=Object(r.c)(t,e);a?(m({message:`Removing event from cache ${a}`,folderId:e,notificationPayload:n,notificationItem:a}),Object(I.q)(e,t)):m({message:`Could not find event with instance key ${t} in the cache to remove`,folderId:e,notificationPayload:n})}(a,e.NotificationPayload):Object(c.K)(e.NotificationPayload.Item.CalendarItemType)?function(e,n,t){const a=Object(l.a)(t.NotificationPayload.Item,n);if(a.UID){V(e).forEach(i=>{const r=Object(s.a)(a.ItemId,i);r.then(o=>{o&&"Success"==o.ResponseClass?function(e,n,t,a,i,r,o){if(m({message:`Action to expand series completed successfully. Retrieved ${i?i.length:0} items for dates: ${t.start.toString()} - ${t.end.toString()} `,folderId:a,notificationItem:e}),V(a).some(e=>Object(b.b)(t,e))){m({message:"Updating all cached items for the series and removing nonexistant ones",folderId:a});const n=[];i&&n.push(...i),r&&n.push(r);const d=n.map(e=>e.UID),c=e=>!(d.includes(e.UID)&&e.IsRecurring);U(t,e.ItemId.Id,e.InstanceKey,o,a,c),Object(I.u)(r),Object(I.a)(a,i),i.forEach(e=>{Object(I.u)(e)})}else m({message:"Range in the cache is different from what we originally requested - reloading cache",folderId:a}),Object(j.b)(a,!0)}(a,0,i,e,o.Occurrences.map(e=>Object(l.a)(e,n)),Object(l.a)(o.RecurrenceMaster,n),t.InstanceKeyToDelete):K(a,r,i,e,t.InstanceKeyToDelete,o)}).catch(n=>{K(a,r,i,e,t.InstanceKeyToDelete,null,n.message)})})}}(a,k,e):function(e,n,t){let a=Object(l.a)(t.Item,n),i=!1;switch(t.EventType){case g.RowAdded:i=!0;break;case g.RowModified:i=null==a.InstanceKey||Object(c.H)(a.CalendarItemType)||Object(c.A)(a.CalendarItemType)}Object(j.a)(a,i,!1,!0)}(0,k,e.NotificationPayload):m({message:o?"Events cache was empty for folder":"Events cache has not been loaded for folder yet",folderId:e.NotificationPayload.FolderId,notificationPayload:e.NotificationPayload})}}function w(){let e=R.length;if(e>=8||R.some(e=>_(e.NotificationPayload)))L();else for(let n=0;n<e;n++){D(R[n])}R=[],N={},clearTimeout(S)}function x(e,n){var t;let a=(null===(t=e.Item)||void 0===t?void 0:t.ItemId)?e.Item.ItemId.Id:"<null>";if(m({message:`${n?"Got calendar notification":"Processing calendar notification"} for event type ${e.EventType}`,folderId:e.FolderId,notificationPayload:e}),n){let n=e.Item?e.Item.CalendarItemType:"<null>";Object(o.p)("IncomingNotification",{NotificationType:e.EventType,ItemType:n,ItemId:a},{excludeFromKusto:!0,isVerbose:!0})}}function _(e){return e.EventType==g.Reload||e.Reload}function L(e){let n=e?[e]:Object.keys(h);for(let e of n)Object(j.b)(e,!0)}function K(e,n,t,a,i,r,o=null){if(r&&"ErrorItemNotFound"==r.ResponseCode)m({message:"Action to expand recurring series failed with item not found because item is not on the server. Removing series.",folderId:a,notificationItem:e}),U(t,e.ItemId.Id,e.InstanceKey,i,a);else{const n=r?`${r.ResponseCode}: ${r.MessageText}`:o;m({message:"Action to expand recurring series failed for unknown reason, reloading cache",folderId:a,notificationItem:e,errorMessage:n}),Object(j.b)(a,!0)}}function U(e,n,t,a,o,d){const c=i=>{var r;const o={start:i.Start,end:i.End},c=0==Object(b.j)(e,o,!0),l=i.InstanceKey==t||a&&i.InstanceKey==a||n&&n===(null===(r=i.SeriesMasterItemId)||void 0===r?void 0:r.Id);return c&&(Object(v.c)(i)||l&&(!d||d(i)))};Object(I.r)(o,c);const l=Object(r.a)(o,c);Object(i.d)(l)}function q(){C&&(clearTimeout(S),m({message:"Processing of notifications will be suspended"}),C=!1)}function B(){C||(C=!0,m({message:"Processing of notifications will be resumed"}),S=setTimeout(w,F))}function V(e){const n=Object(p.d)(e);return Object(a.a)(n)}},883:function(e,n,t){"use strict";t.d(n,"a",(function(){return i})),t.d(n,"e",(function(){return r})),t.d(n,"i",(function(){return o})),t.d(n,"b",(function(){return d})),t.d(n,"c",(function(){return c})),t.d(n,"f",(function(){return l})),t.d(n,"g",(function(){return s})),t.d(n,"d",(function(){return u})),t.d(n,"h",(function(){return f}));var a=t(298);function i(e){return e?u(e)?a.e:f(e)?a.F:l(e)?a.v:d(e)?a.a:s(e)?a.x:c(e)?a.c:a.s:a.s}function r(e){return d(e)||l(e)}function o(e){return c(e)||s(e)}function d(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==a.b}function c(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==a.d}function l(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==a.w}function s(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==a.y}function u(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==a.f}function f(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==a.G}},884:function(e,n,t){"use strict";var a=t(201),i=t(895);var r=t(1127);function o(){return Object(r.a)(),async function(){const e=Object(a.b)();await Promise.all(e.map(e=>Object(i.a)(e,!0)))}()}t.d(n,"a",(function(){return o}))},887:function(e,n,t){"use strict";function a(){return{__type:void 0,ItemId:void 0,ParentFolderId:void 0,Subject:void 0,ReminderIsSet:void 0,ReminderMinutesBeforeStart:void 0,LastModifiedTime:void 0,InstanceKey:void 0,Preview:void 0,EffectiveRights:void 0,HasAttachments:void 0,HasBlockedImages:void 0,Attachments:void 0,Sensitivity:void 0,Body:void 0,EntityNamesMap:void 0,TailoredXpEntities:void 0,IsDraft:void 0,Categories:void 0,Start:void 0,End:void 0,IsAllDayEvent:void 0,IsRoomRequested:void 0,AutoRoomBookingStatus:void 0,FreeBusyType:void 0,IsMeeting:void 0,IsCancelled:void 0,IsRecurring:void 0,IsResponseRequested:void 0,CalendarItemType:void 0,ResponseType:void 0,Organizer:void 0,RequiredAttendees:void 0,OptionalAttendees:void 0,Resources:void 0,AppointmentReplyTime:void 0,Recurrence:void 0,Location:void 0,IntendedFreeBusyStatus:void 0,IsOrganizer:void 0,AppointmentReplyName:void 0,IsSeriesCancelled:void 0,CharmId:void 0,Locations:void 0,ClientSeriesId:void 0,UID:void 0,SeriesId:void 0,ExperienceType:void 0,DoNotForwardMeeting:void 0,IsOnlineMeeting:void 0,JoinOnlineMeetingUrl:void 0,InboxReminders:void 0,MeetingRequestWasSent:void 0,ExtractionSourceId:void 0,StartTimeZoneId:void 0,EndTimeZoneId:void 0,OnlineMeetingProvider:void 0,OnlineMeetingJoinUrl:void 0,OnlineMeetingConferenceId:void 0,OnlineMeetingTollNumber:void 0,OnlineMeetingTollFreeNumbers:void 0,SeriesMasterItemId:void 0,ExtractionSourceInternetMessageId:void 0,HideAttendees:void 0,PersonId:void 0,InReplyTo:void 0,IsFreeBusyOnly:void 0,ConversationId:void 0,SkypeTeamsProperties:void 0,DocLinks:void 0,DateTimeCreated:void 0,AppendOnSend:void 0,IsBookedFreeBlocks:void 0,AssociatedTasks:void 0,CollabSpace:void 0,TravelTimeEventsLinked:void 0,FlexEventsMetadata:void 0}}t.d(n,"a",(function(){return a}))},892:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var a=t(122);function i(e){if(0===e.length)return[];const n=[];return e.forEach(e=>(function(e,n){let t=!1;for(let i=0;i<n.length&&!t;i++){const r=n[i];0===Object(a.j)(r,e,!0)&&(n[i]=Object(a.f)(r,e),t=!0)}t||n.push(e)})(e,n)),n}},893:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var a=t(254),i=t(201),r=t(1124);function o(e,n,t){const o=Object(a.k)(t,e,Object(i.f)(n));return o?Object(r.a)(o):[]}},895:function(e,n,t){"use strict";var a=t(99),i=t(201),r=t(1123),o=t(1128),d=t(210),c=t(648),l=t(892);var s=t(1126),u=t(251),f=t.n(u);async function m(e,n=!1){var t,u;const m=function(e){const n=Object(r.b)(e),t=null==n?void 0:n.filter(e=>null!==e),a=Object(i.d)(e),o=[...t,...a];return Object(l.a)(o)}(e),v=m.map(n=>Object(o.a)(n,e,function(e,n){return(t,a)=>{"Loading"!==a&&Object(i.c)(e,n).forEach(e=>{Object(d.j)(e,t,a)})}}(e,n),c.c));let b=[];for(let e=0;e<v.length;e++)await Promise.all([null===(t=v[e])||void 0===t?void 0:t.fetchPromise,null===(u=v[e])||void 0===u?void 0:u.enhancedFetchPromise]).then(e=>{let n=e[0];const t=e[1];if(n&&t)for(let e=0;e<n.length;e++){const a=n[e].ItemId.Id;let[i]=t.filter(e=>e.ItemId.Id===a);i&&f()(n[e],i),b.push(n[e])}else n&&b.push(...n)});if(b.length>0){const t=b.map(e=>Object(s.a)(e));await Promise.all(t).then(e=>{for(let n=0;n<e.length;n++){const t=e[n];t&&f()(b[n],t)}});const i=function(e,n){const t={},a=[];return e.forEach(e=>{const i=n(e);t.hasOwnProperty(i)||(a.push(e),t[i]=!0)}),a}(b.reduce((e,n)=>(n&&e.push(n),e),[]),e=>e.ItemId.Id);return Object(a.c)(e,i,m,n),i}return null}t.d(n,"a",(function(){return m}))},961:function(e,n,t){"use strict";var a=t(5);n.a=e=>e.IsAllDayEvent||Object(a.u)(e.End,e.Start)>0},975:function(e,n,t){"use strict";n.a=e=>{switch(e){case"OOF":return 0;case"Busy":return 1;case"Tentative":return 2;case"WorkingElsewhere":return 3;case"Free":return 4;default:return 5}}},980:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var a=t(122);function i(e,n){const t=[],i=[];return e.forEach(e=>{const r={start:e.Start,end:e.End};n.some(e=>0===Object(a.j)(e,r,!0))?t.push(e):i.push(e)}),{eventsOverlapping:t,eventsNotOverlapping:i}}},982:function(e,n,t){"use strict";t.d(n,"a",(function(){return l}));var a=t(5),i=t(887),r=t(168),o=t(653),d=t(669),c=t(1113);function l(e){var n,t,l,s,u,f,m,v,b;return Object.assign(Object.assign(Object.assign({},Object(i.a)()),e),{ItemId:{mailboxInfo:(null===(n=e.ItemId)||void 0===n?void 0:n.mailboxInfo)||Object(r.d)(),Id:null===(t=e.ItemId)||void 0===t?void 0:t.Id,ChangeKey:null===(l=e.ItemId)||void 0===l?void 0:l.ChangeKey},ParentFolderId:{mailboxInfo:(null===(s=e.ParentFolderId)||void 0===s?void 0:s.mailboxInfo)||Object(r.d)(),Id:null===(u=e.ParentFolderId)||void 0===u?void 0:u.Id},SeriesMasterItemId:e.SeriesMasterItemId?{mailboxInfo:e.SeriesMasterItemId.mailboxInfo||Object(r.d)(),Id:null===(f=e.SeriesMasterItemId)||void 0===f?void 0:f.Id}:void 0,Start:Object(a.pc)(e.Start),End:Object(a.pc)(e.End),AppointmentReplyTime:e.AppointmentReplyTime?Object(a.pc)(e.AppointmentReplyTime):void 0,LastModifiedTime:e.LastModifiedTime?Object(a.pc)(e.LastModifiedTime):void 0,InboxReminders:e.InboxReminders,AutoRoomBookingStatus:e.AutoRoomBookingStatus,AppendOnSend:null===(m=e.AppendOnSend)||void 0===m?void 0:m.map(o.a),FreeBusyType:e.FreeBusyType,DocLinks:null===(v=e.DocLinks)||void 0===v?void 0:v.map(d.d),Recurrence:e.Recurrence&&Object(o.f)(e.Recurrence),__type:"CalendarItem:#Exchange",ResponseType:e.ResponseType,Attachments:null===(b=e.Attachments)||void 0===b?void 0:b.map(d.b),CollabSpace:Object(c.f)(e.CollabSpace)})}},983:function(e,n,t){"use strict";t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return o}));var a=t(122);const i={};function r(e,n){d(e),i[e].push({dateRange:n})}function o(e,n){return function(e,n){d(e);const t=i[e];for(let e=0;e<t.length;e++)if(Object(a.c)(t[e].dateRange,n,!0))return{index:e,info:t[e]};return{index:-1,info:null}}(e,n).index>=0}function d(e){i[e]||(i[e]=[])}},99:function(e,n,t){"use strict";var a=t(2),i=t(210);function r(e,n){let t=null;return p(e,n,e=>{t=e}),t&&(t.forEach(n=>m(e,n.Key)),Object(i.d)(t)),t}t.d(n,"d",(function(){return o})),t.d(n,"e",(function(){return d})),t.d(n,"g",(function(){return c})),t.d(n,"f",(function(){return l})),t.d(n,"u",(function(){return s})),t.d(n,"t",(function(){return u})),t.d(n,"m",(function(){return f})),t.d(n,"s",(function(){return m})),t.d(n,"p",(function(){return v})),t.d(n,"w",(function(){return b})),t.d(n,"a",(function(){return I})),t.d(n,"q",(function(){return O})),t.d(n,"k",(function(){return j})),t.d(n,"l",(function(){return p})),t.d(n,"n",(function(){return k})),t.d(n,"o",(function(){return y})),t.d(n,"c",(function(){return E})),t.d(n,"b",(function(){return g})),t.d(n,"i",(function(){return F})),t.d(n,"j",(function(){return S})),t.d(n,"h",(function(){return h})),t.d(n,"v",(function(){return N})),t.d(n,"r",(function(){return r}));const o=Object(a.action)("CALENDAR_EVENTS_FETCHING_FULL_CALENDAR_EVENT_FOR_LOCK",(e,n,t,a,i)=>({lockId:e,folderId:n,eventKey:t,itemResponseShapeType:a,partialCalendarEvent:i})),d=Object(a.action)("CALENDAR_EVENTS_FETCHING_FULL_CALENDAR_EVENT_FOR_LOCK_FAILED",(e,n,t,a)=>({lockId:e,folderId:n,eventKey:t,itemResponseShapeType:a})),c=Object(a.action)("CALENDAR_EVENTS_FULL_CALENDAR_EVENT_LOADED_FOR_LOCK",(e,n,t,a,i,r,o)=>({lockId:e,folderId:n,eventKey:t,itemResponseShapeType:a,event:i,hasEventChanged:r,forceOverrideAllPropertiesForEventIfAvailable:o})),l=Object(a.action)("CALENDAR_EVENTS_FULL_CALENDAR_EVENT_LOADED",(e,n,t,a)=>({folderId:e,eventKey:n,itemResponseShapeType:t,event:a})),s=Object(a.action)("CALENDAR_EVENTS_UPDATE_FULL_CALENDAR_EVENT_FROM_SERVER",e=>({partialCalendarEvent:e})),u=Object(a.action)("CALENDAR_EVENTS_UPDATE_FULL_CALENDAR_EVENT_FROM_PARTIAL_CALENDAR_EVENT",e=>({partialCalendarEvent:e})),f=Object(a.action)("CALENDAR_EVENT_MERGE_EVENTS_INTO_CACHE",e=>({events:e})),m=Object(a.action)("CALENDAR_EVENTS_REMOVE_FULL_CALENDAR_EVENT",(e,n)=>({folderId:e,eventKey:n})),v=Object(a.action)("CALENDAR_EVENTS_REMOVE_ALL_FULL_CALENDAR_EVENTS_INFO_FOR_CACHE",e=>({folderId:e})),b=Object(a.action)("ADD_CALENDAR_EVENTS_TO_EVENTS_CACHE",(e,n,t,a=!1)=>({folderId:e,calendarEvents:n,dateRanges:t,forceReplace:a})),I=Object(a.action)("ADD_CALENDAR_EVENTS_WITHING_CURRENT_LOCKED_DATE_RANGES",(e,n)=>({folderId:e,calendarEvents:n})),O=Object(a.action)("REMOVE_CALENDAR_EVENT_WITH_INSTANCE_KEY_FROM_EVENTS_CACHE",(e,n)=>({folderId:e,instanceKey:n})),j=Object(a.action)("INTERNAL_REMOVE_CALENDAR_EVENT_WITH_INSTANCE_KEY_FROM_EVENTS_CACHE",(e,n,t)=>({folderId:e,instanceKey:n,onEventsRemoved:t})),p=Object(a.action)("INTERNAL_REMOVE_CALENDAR_EVENTS_FROM_EVENTS_CACHE_MATCHING_FILTER",(e,n,t)=>({folderId:e,predicate:n,onEventsRemoved:t})),k=Object(a.action)("CALENDAR_EVENTS_RELEASE_LOCK",e=>({lockId:e})),y=Object(a.action)("RELEASE_LOCK",e=>({lockId:e})),E=Object(a.action)("CALENDAR_EVENTS_IN_EVENTS_CACHE_RELOADED",(e,n,t,a=!1)=>({folderId:e,eventsReloaded:n,dateRanges:t,forceReplace:a})),g=Object(a.action)("CALENDAR_EVENTS_IN_DATE_RANGE_LOADED_FOR_LOCK",(e,n,t,a)=>({lockId:e,folderId:n,dateRange:t,calendarEvents:a})),F=Object(a.action)("INTERNAL_CALENDAR_EVENTS_IN_DATE_RANGE_LOADED_FOR_LOCK",(e,n,t,a)=>({lockId:e,folderId:n,dateRange:t,calendarEvents:a})),S=Object(a.action)("INTERNAL_DELETE_EVENTS_CACHE",e=>({folderId:e})),h=Object(a.action)("CALENDAR_EVENTS_FULL_CALENDAR_EVENT_WAS_USED",(e,n)=>({lockId:e,eventKey:n})),N=Object(a.action)("UpdateItem",(e,n)=>({existingItem:e,updatedItem:n}))}}]);
//# sourceMappingURL=owa.66.js.map
self.scriptsLoaded['owa.66.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.66.js'] = (new Date()).getTime();