self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.116.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[116],{2823:function(e,n,t){"use strict";var r,i,c;t.d(n,"c",(function(){return r})),t.d(n,"b",(function(){return i})),t.d(n,"a",(function(){return c})),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp",e[e.Peek=5]="Peek",e[e.CalendarCard=6]="CalendarCard"}(r||(r={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity",e[e.InsightMessage=7]="InsightMessage",e[e.External=8]="External",e[e.Spotlight=9]="Spotlight"}(i||(i={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(c||(c={}))},2907:function(e,n,t){"use strict";var r;function i(){return[r.noPermissionToShare,r.getSharingInfoFailed,r.linkHasExpired,r.linkWillExpire,r.noPermissionToShareExternally,r.externalRecipientCSL,r.noPermissionSet,r.sharingWithLargeDL]}t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return i})),function(e){e.noPermissionToShare="WarningNoPermissionToShare",e.getSharingInfoFailed="WarningGetSharingInfoFailed",e.linkHasExpired="WarningLinksHasExpired",e.linkWillExpire="WarningLinksWillExpire",e.noPermissionToShareExternally="WarningExternalRecipientButNoPermissionToShareExternally",e.externalRecipientCSL="WarningExternalRecipientsCannotOpenCSLs",e.noPermissionSet="WarningOnlyPeopleWithExistingAccessCanAccess",e.sharingWithLargeDL="WarningNotAllMembersOfDLCanAccess"}(r||(r={}))},2972:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(72);function i(e){switch(e){case 0:return"ReadOnlyAccess";case 1:return"ReadOnlyPlusAttachmentsBlockedAccess";case 2:return null;default:return Object(r.a)(e)}}},3045:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.InProgress=0]="InProgress",e[e.Failed=1]="Failed",e[e.Succeeded=2]="Succeeded"}(r||(r={}))},3061:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(2);const i=Object(r.action)("REFRESH_EXPIRATION_DATE",e=>({id:e}))},3062:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.ignore=0]="ignore",e[e.refreshExpiration=1]="refreshExpiration",e[e.changePermission=2]="changePermission",e[e.attachAsACopy=3]="attachAsACopy"}(r||(r={}))},3081:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var r=t(168),i=t(284);function c(e){if("ArchiveMailbox"==e.type)return Object(r.a)();const n=e.userIdentity&&Object(i.r)(e.userIdentity),t="GroupMailbox"===e.type;return n&&!t?Object(r.b)(e.mailboxSmtpAddress)+e.userIdentity:"UserMailbox"===e.type?Object(r.a)():e.mailboxSmtpAddress}},3082:function(e,n,t){"use strict";var r=t(284);const i={};function c(e){return i[e]}function a(e,n){const t=i[e];i[e]=Object.assign(Object.assign({},t),n)}var o=t(52),s=t(35);var u=t(68),l=t(22),d=t(603),f=t(2762),b=t(2761);const m=Object(d.b)({timeBetweenRetryInMS:()=>3e4});async function h(e){const n=async()=>{try{let n={};return Object(r.r)(e.userIdentity)&&(n=await async function(e){let n={};n.headers=new Headers;const t=await Object(f.a)(e);return Object(b.b)(n.headers,t),n}(e.userIdentity)),function(e){return Object(s.a)("GetAttachmentDownloadToken",{},e)}(n)}catch(e){throw l.h.warn(`Unable to get the download token ${e}`),e.networkError=!0,e}},t=c(e.userIdentity);if(!(null==t?void 0:t.isRefreshingDownloadToken)){a(e.userIdentity,{isRefreshingDownloadToken:!0});let t=0;const{retriableFunc:r}=m(async()=>{t++;const r=await n();l.h.info("update new token"),a(e.userIdentity,{downloadToken:r,isRefreshingDownloadToken:!1})}),i=new u.c("AttachmentRefreshDownloadToken");try{await r(),i.addCustomData([t]),i.end()}catch(n){l.h.warn(`Retry to refresh token failed: ${n}`),i.addCustomData([t]),i.endWithError("ServerError",n),a(e.userIdentity,{isRefreshingDownloadToken:!1})}}}function p(e){const n=Object(r.r)(e.userIdentity)?Object(o.h)(e.userIdentity):Object(o.g)(),t=null==n?void 0:n.ApplicationSettings;if(t){const n=t.DownloadUrlBase;a(e.userIdentity,{downloadUrlBase:n,downloadToken:t.FirstDownloadToken}),n&&function(e,n){n=n<1?1:n,setInterval(()=>{h(e)},6e4*n)}(e,t.DownloadTokenRefreshMinutes)}}var O=t(72);function g(e){const n=Object(r.j)(null==e?void 0:e.userIdentity),t=c(null==e?void 0:e.userIdentity);if((null==t?void 0:t.downloadToken)&&(null==t?void 0:t.downloadUrlBase))return t;switch(n){case null:case"Outlook":p(e);break;case"Google":case"Yahoo":case"ICloud":break;default:Object(O.a)(n)}const i=c(e.userIdentity);return i||(Object(u.p)("FilesUrlDataNotFound",{accountProviderType:n}),l.h.warn("Unable to get the url data")),i}function w(e){if(!e)return null;const n=g(e);return null==n?void 0:n.downloadToken}t.d(n,"b",(function(){return g})),t.d(n,"a",(function(){return w}))},3102:function(e,n,t){"use strict";var r=t(2773);function i(){const e=Object(r.a)();return e.ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||e.ConditionalAccessDirectFileAccessOnPublicComputersBlocked?e.ConditionalAccessWacViewingOnPrivateComputersBlocked||e.ConditionalAccessWacViewingOnPublicComputersBlocked?[1]:[0]:[]}var c=t(2972),a=t(2852);function o(){return i()}function s(e){return(e&&e.length>0&&function(e){return e.some(e=>!function(e){return e.IsInline&&!Object(a.a)(e)}(e))}(e)?i():[]).map(c.a)}t.d(n,"a",(function(){return o})),t.d(n,"b",(function(){return s}))},3164:function(e,n,t){"use strict";t.d(n,"h",(function(){return u})),t.d(n,"i",(function(){return l})),t.d(n,"f",(function(){return d})),t.d(n,"k",(function(){return f})),t.d(n,"n",(function(){return b})),t.d(n,"e",(function(){return m})),t.d(n,"l",(function(){return h})),t.d(n,"g",(function(){return p})),t.d(n,"j",(function(){return O})),t.d(n,"m",(function(){return g}));var r=t(20),i=t(3061);t.d(n,"o",(function(){return i.a}));var c=t(3045);t.d(n,"a",(function(){return c.a}));var a=t(2907);t.d(n,"d",(function(){return a.b})),t.d(n,"c",(function(){return a.a}));var o=t(3062);t.d(n,"b",(function(){return o.a}));const s=new r.c(()=>Promise.all([t.e(0),t.e(29),t.e(87),t.e(795)]).then(t.bind(null,4080))),u=new r.b(s,e=>e.getSharingInformation),l=new r.b(s,e=>e.getSharingIssuesForSharingData),d=new r.b(s,e=>e.getInfoBarCreator),f=new r.b(s,e=>e.hasLargeDLRecipient),b=new r.b(s,e=>e.hasRecipientExpansionFailure),m=new r.b(s,e=>e.getGroupsAndSmallDLs),h=new r.b(s,e=>e.isDLOrGroup),p=new r.b(s,e=>e.getInvididualRecipients),O=new r.b(s,e=>e.hasGetRecipientPermissionFailed),g=new r.b(s,e=>e.logSharingTipChangesForLinkRemoval)},3268:function(e,n,t){"use strict";var r=t(72),i=t(6),c=t(69);const a="/owa/",o="service.svc/s/GetFileAttachment?id={0}",s="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",u="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",l="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",d="service.svc/s/GetAttachmentThumbnail?id={0}",f="pdfprint.aspx?id={0}",b="pdfprint.aspx?id={0}&location={1}",m=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var h=t(220),p=t(107),O=t(3),g=t(36),w=t(3082),v=t(3081);function j(e,n,t,r=!1,o=null){if(!e||!e.Id||!e.mailboxInfo)return null;const s=Object(w.b)(e.mailboxInfo),u=null==s?void 0:s.downloadUrlBase,l=Object(v.a)(e.mailboxInfo);if(o=o||Object(i.c)(n,encodeURIComponent(e.Id)),!u||r&&"Firefox"===Object(p.a)().browser){const e=a+o+"&X-OWA-CANARY="+Object(c.a)();return Object(g.a)(e)}let d="{0}{1}/{2}";Object(h.a)()&&(d+="&isc=1");let f=Object(i.c)(d,u,l,o);return t&&(f+="&token="+(null==s?void 0:s.downloadToken),f+="&X-OWA-CANARY="+Object(c.a)()),Object(p.i)()||(f+="&owa="+window.location.hostname,f+="&scriptVer="+Object(O.u)()||!1),f}function A(e,n,t,o,u=0,d=0,f=!0,h=null,p=null){let O;switch(t){case 0:O=s;break;case 3:O=b;break;case 1:if(!function(e){if(!e)return!1;let n=null;const t=e.lastIndexOf(".");return t>0&&(n=e.substr(t).toLowerCase()),!!n&&m.indexOf(n.toLowerCase())>=0}(h))return null;O=l;break;default:Object(r.a)(t)}let w=o?d:u;!w&&u&&(w=u);let v=Object(i.c)("{0}&permissionLevel={1}",Object(i.c)(O,encodeURIComponent(e.Id),encodeURIComponent(n)),w);const A=j(e,O,!0,3===t,v);if(A)return A;let I=Object(i.c)("{0}{1}{2}",a,p,v);if(f){I=`${I}&X-OWA-CANARY=${Object(c.a)()}`}return Object(g.a)(I)}function I(e,n,t=!1,c=!0){let a;switch(n){case 0:a=o;break;case 1:a=u;break;case 2:a=d;break;case 3:a=f;break;default:return Object(r.a)(n)}if(!Object(i.j)(a)){const r=j(e,a,c,3===n);return Object(i.c)("{0}{1}{2}",r,t?"&isDownload=true":"","&animation=true")}return null}t.d(n,"b",(function(){return A})),t.d(n,"a",(function(){return I}))},3318:function(e,n,t){"use strict";var r=t(20);const i=[0,1];var c=t(3392),a=t(3378),o=t(6),s=t(72),u=t(2823);function l(e){switch(e){case"ReadOnlyPlusAttachmentsBlockedAccess":return{key:"access_control_info_bar",source:u.c.Compose,rank:u.b.Error,message:Object(o.b)(a.a),messageParts:[Object(o.b)(a.a),d()],color:u.a.Red};case"ReadOnlyAccess":return{key:"access_control_info_bar_check",source:u.c.Compose,rank:u.b.Error,message:Object(o.b)(c.b),messageParts:[Object(o.b)(c.b),d()],color:u.a.Red};default:return Object(s.a)(e)}}function d(){return{text:Object(o.b)(c.a),action:()=>{window.open("https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done","_blank")}}}var f=t(3102),b=t(2972),m=t(25),h=t(2773);function p(){const e=Object(h.a)();if(Object(m.k)("fwk-devTools")){if(Object(m.k)("doc-attachment-CA-readOnlyAccessIssues"))return Object.assign(Object.assign({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!0,WacViewingOnPublicComputersEnabled:!0});if(Object(m.k)("doc-attachment-CA-readOnlyPlusAttachmentsBlocked"))return Object.assign(Object.assign({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!1,WacViewingOnPublicComputersEnabled:!1})}return e}function O(){const e=p();return e.DirectFileAccessOnPrivateComputersEnabled&&e.DirectFileAccessOnPublicComputersEnabled?2:e.WacViewingOnPrivateComputersEnabled&&e.WacViewingOnPublicComputersEnabled?0:1}t.d(n,"g",(function(){return w})),t.d(n,"a",(function(){return i})),t.d(n,"f",(function(){return l})),t.d(n,"b",(function(){return f.a})),t.d(n,"e",(function(){return b.a})),t.d(n,"d",(function(){return O})),t.d(n,"c",(function(){return p}));const g=new r.c(()=>t.e(2151).then(t.bind(null,19527))),w=new r.b(g,e=>e.getAccessIssuesForAttachments)},3378:function(e){e.exports=JSON.parse('{"a":"bma"}')},3392:function(e){e.exports=JSON.parse('{"a":"$la","b":"ama"}')},3403:function(e,n,t){"use strict";var r=t(72),i=t(3552),c=t(69),a=t(3728);function o(e,n,t,c,o=!0){var s;const{Name:u,OriginalPermissionType:l,PermissionType:d}=n,f=Object(a.a)(n),b="GroupMailbox"===(null===(s=null==e?void 0:e.mailboxInfo)||void 0===s?void 0:s.type)?e.mailboxInfo.mailboxSmtpAddress+"/":null;switch(t){case 0:case 3:return i.b(e,f,t,c,d,l,o,u,b);case 1:return n.AttachmentPreviewUrl?n.AttachmentPreviewUrl:i.b(e,f,1,c,d,l,o,u,b);case 2:return n.AttachmentThumbnailUrl;default:return Object(r.a)(t)}}function s(e,n,t=!1,r=!0){return i.a(e,n,t,r)}function u(e,n,t,r,a=!1){const u=t?o(e,n,1,r,!1):s(e,1,a,!1);if(t)return{url:u,init:{credentials:"include",headers:new Headers}};{const n=i.c(e.mailboxInfo),t=new Headers;return t.set("X-Token",n),t.set("X-OWA-CANARY",Object(c.a)()),{url:u,init:{headers:t}}}}function l(e,n,t,r,i,c=!1){return r?o(e,n,t,i):s(e,t,c)}t.d(n,"a",(function(){return l})),t.d(n,"b",(function(){return s})),t.d(n,"c",(function(){return u}))},3552:function(e,n,t){"use strict";var r=t(3268);t.d(n,"a",(function(){return r.a})),t.d(n,"b",(function(){return r.b}));var i=t(3082);t.d(n,"c",(function(){return i.a}));var c=t(3081);t.d(n,"d",(function(){return c.a}))},3667:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(35);function i(e,n){return Object(r.a)("GetWacAttachmentInfo",e,n)}},3728:function(e,n,t){"use strict";function r(e){let n=null;return n=e.AttachLongPathName,n||(n=e.WebUrl),n}t.d(n,"a",(function(){return r}))},3940:function(e,n,t){"use strict";var r=t(4305),i=t(4909),c=t(2778),a=t(358);n.a=Object(a.action)("removeAttachmentFromWell")((function(e,n,t=!0,a=!0){const o=Object(c.a)(n.attachmentId);if(!o)return;let s,u=!1;1===n.attachmentType?(s=e.inlineAttachments,u=!0):s=e.imageViewAttachments.some(e=>e.attachmentId===n.attachmentId)?e.imageViewAttachments:e.docViewAttachments;let l=!1;for(let e=0;e<s.length;e++)if(s[e].attachmentId===n.attachmentId){s.splice(e,1),l=!0;break}t&&l&&(u||!n.isCloudy)&&Object(r.a)(e,-1*o.model.Size),a&&Object(i.a)(n.attachmentId)}))},4058:function(e,n,t){"use strict";function r(e,n){n&&e&&(e.addCustomData({httpStatusCode:n.status}),function(e,n){n&&e&&e.addCustomData({frontendServer:n.get("x-feserver"),requestId:n.get("request-id"),backendServer:n.get("x-beserver"),backendHttpStatus:n.get("x-backendhttpstatus"),serverVersion:n.get("x-owa-version")})}(e,n.headers))}function i(e){return e&&void 0!==e.fetchErrorType}function c(e,n){e.addCustomProperty("ErrorInformation",n)}function a(e,n){let t="";t=n?"Empty response from server":"Null response from server",c(e,t)}t.d(n,"c",(function(){return r})),t.d(n,"a",(function(){return i})),t.d(n,"d",(function(){return c})),t.d(n,"b",(function(){return a}))},4305:function(e,n,t){"use strict";var r=t(2);n.a=Object(r.mutatorAction)("changeTotalClassicAttachmentSize",(function(e,n){e.totalClassicAttachmentSize+=n}))},603:function(e,n,t){"use strict";function r(e={}){!function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||(()=>6e4)}(e);const{maximumAttempts:n,timeBetweenRetryInMS:t}=e;return e=>{let r=0,i=!1;const c=(a,o)=>{i?o(new Error("The function retry was cancelled")):(r++,e().then(e=>a(e)).catch(e=>{n&&r>=n?o(e):setTimeout(()=>c(a,o),t(r))}))};return{retriableFunc:()=>new Promise((e,n)=>c(e,n)),cancel:()=>i=!0}}}function i(e){return n=>Math.pow(2,n)*e}t.d(n,"b",(function(){return r})),t.d(n,"a",(function(){return i}))}}]);
//# sourceMappingURL=owa.116.js.map
self.scriptsLoaded['owa.116.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.116.js'] = (new Date()).getTime();