self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.89.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[89],{3012:function(e,t,n){"use strict";function o(e,t){let n,o;switch(t){case 0:n=e.LastDeliveryOrRenewTime,o=e.LastDeliveryTime;break;case 1:n=e.ReceivedOrRenewTime,o=e.DateTimeReceived}return{lastDeliveryOrRenewTimeStamp:n,lastDeliveryTimeStamp:o}}var r=n(3020);function i(e,t){const n=o(e,t.tableQuery.listViewType);return!!(t.lastEmptiedTime&&t.lastEmptiedTime>new Date(n.lastDeliveryTimeStamp))||r.a.getTombstonedReasons(e.InstanceKey,t.serverFolderId).indexOf(3)>-1}var a=n(25),s=n(3539),c=n(3890),u=n(3491),d=n(2827),l=n(4351),f=n(3918),b=n(30),m=n(3596);function p(e){const t=e.tableQuery.listViewType,n=Object(d.b)(e);Object(b.a)().UserOptions.ShowInlinePreviews&&s.b.importAndExecute(n,t),Object(a.k)("tri-coupon-peek")&&c.d.import().then(e=>{e(n.mailboxSmtpAddress,t)});const o=e.id!==Object(u.a)();m.b.importAndExecute({task:()=>l.b.importAndExecute(n,t,o)},{task:()=>f.d.importAndExecute(n,t,o),condition:Object(a.k)("tri-txpButtonInLV")})}var w=n(2733),I=n(4454),y=n(3399),O=n(3441),v=n(358),g=Object(v.action)("appendRowResponse")((function(e,t,n,o="",r,s,c=!1){const u=t||[];let d=0;for(const t of u){if(i(t,e))continue;let n=!0;const u=t.InstanceKey;if(y.a.containsRowKey(e,Object(w.E)(t,e.tableQuery.listViewType))){const n=Object(O.a)(u,e.id,w.b.getLastDeliveryOrRenewTimeStamp(u,e))?e.rowKeys.indexOf(u):e.rowKeys.length-1;y.a.updateRow(n,t,e,o,c)}else n=y.a.appendRow(t,e,o,c);if(Object(a.k)("tri-handleTableAddFailures")&&!n&&d++,r){const n={referenceKey:t.ReferenceKey,index:e.rowKeys.length-1,traceId:r,logicalId:s};Object(I.a)(u,e,n)}}e.totalRowsInView=n-d,p(e)})),h=n(2790),R=n(1084);function T(e){if(Object(h.e)(e))return!1;if(0==e.type){const t=e.sortBy,n=w.c.getSortBySupportingPin();return t.sortColumn==n.sortColumn&&t.sortDirection==n.sortDirection&&function(e){if(!e)throw new Error("Current folder id should not be null");return Object(R.a)("sentitems")!=e&&Object(R.a)("deleteditems")!=e&&Object(R.a)("drafts")!=e&&Object(R.a)("junkemail")!=e&&Object(R.a)("archive")!=e}(e.folderId)}return 1==e.type}var j=n(22),S=n(3411),C=n(2742);function x(e,t){let n=!1;switch(t.tableQuery.listViewType){case 0:n=K(t.tableQuery,Object(S.a)(e.InstanceKey,t.id),e);break;case 1:n=D(t.tableQuery,e,C.u.items.get(e.ItemId.Id))}return n}let K=function(e,t,n,o={listViewStore:w.Z}){if(!(0===e.type||2===e.type||Object(a.k)("grp-loadFolders")&&3===e.type))return j.d("isConversationSortKeyEqual should not be called on non MailFolderTableQuery type"),!1;const r=e.sortBy;if(!r)throw new Error("SortBy should not be null");const i=t.instanceKey===n.InstanceKey,s=function(e,t,n){const o=new Date(t.lastDeliveryTimeStamp).getTime()===new Date(n.LastDeliveryTime).getTime();if(T(e)){return new Date(t.lastDeliveryOrRenewTimeStamp).getTime()===new Date(n.LastDeliveryOrRenewTime).getTime()&&o}return o}(e,t,n);if(!i||!s)return!1;const c=o.listViewStore.conversationItems.get(t.id);switch(r.sortColumn){case 1:case 3:return!0;case 5:return c.subject===n.ConversationTopic;case 8:return t.importance===n.Importance;case 7:return c.size===n.Size;default:return j.h.warn("isSortKeyEqual: sortColumn not supported "+r.sortColumn),!1}};function D(e,t,n){if(!(0==e.type||2===e.type||Object(a.k)("grp-loadFolders")&&3===e.type))return j.d("isItemSortKeyEqual should not be called on non MailFolderTableQuery type"),!1;const o=e.sortBy;if(!o)throw new Error("SortBy should not be null");const r=t.InstanceKey===n.InstanceKey,i=function(e,t,n){const o=new Date(t.DateTimeReceived).getTime()===new Date(n.DateTimeReceived).getTime();if(T(e)){return new Date(t.ReceivedOrRenewTime).getTime()===new Date(n.ReceivedOrRenewTime).getTime()&&o}return o}(e,t,n);if(!r||!i)return!1;switch(o.sortColumn){case 1:return!0;case 5:return t.Importance===n.Importance;case 8:return t.Subject===n.Subject;case 3:const e=V(t),r=V(n);if(e&&r){return(e.From&&e.From.Mailbox.EmailAddress)===(r.From&&r.From.Mailbox.EmailAddress)}return!0;case 7:return t.Size===n.Size;default:return j.h.warn("isSortKeyEqual: sortColumn not supported "+o.sortColumn),!1}}function V(e){return-1!==e.ItemClass.indexOf("IPM.Schedule.Meeting")||-1!==e.ItemClass.indexOf("IPM.Note")?e:null}var M=n(68),k=n(2);const F=Object(k.action)("ON_MERGE_ROW_COMPLETED",e=>({tableView:e}));var E=Object(v.action)("mergeRowResponseFromTop")((function(e,t,n,o,r,s){if(!e)return void j.d("We need to have a valid list of rows");if(r){let n=!0;for(let o=0;o<Math.min(t.rowKeys.length,2,e.length);o++)if(t.rowKeys[o]!=e[o].InstanceKey||!x(e[o],t)){n=!1;break}Object(M.q)("TnS_MergeFindResponse",[n])}let c=0,u=0;const d=t.tableQuery.listViewType;for(const n of e){if(i(n,t))continue;const e=Object(w.E)(n,d);let o=!0;y.a.containsRowKey(t,e)?Object(a.k)("tri-smartMergeFindResponse")&&w.b.getLastModifiedTimeStamp(e,t)===n.LastModifiedTime?y.a.updateRowPosition(c,e,t,s):y.a.updateRow(c,n,t,s):o=y.a.addRow(c,n,t,s),!Object(a.k)("tri-handleTableAddFailures")||o?c++:u++}if(o){const e=c;for(let n=t.rowKeys.length-1;n>=e;n--){const e=t.rowKeys[n];Object(O.a)(e,t.id,w.b.getLastDeliveryOrRenewTimeStamp(e,t))||y.a.removeRow(e,t,s+"_RemoveAfterMerge")}}F(t),t.totalRowsInView=n-u,p(t)}));function L(e,t,n){if(!t||0==t.length)return;const o=t[0].InstanceKey,r=Object(S.a)(o,e.id);r&&K(e.tableQuery,r,t[0])&&g(e,t,n,"AppendOnLoadMore")}function A(e,t,n){if(!t||0==t.length)return;const o=t[0].ItemId.Id;C.u.items.has(o)&&(1==e.tableQuery.type||D(e.tableQuery,C.u.items.get(o),t[0]))&&g(e,t,n,"AppendOnLoadMore")}function P(e,t){let n;for(n=t;n<e.rowKeys.length&&w.b.getIsPinned(e.rowKeys[n],e);n++);return n}var Q=n(4737),U=n.n(Q);let q=new Map;function B(e,t){let n;const o=Object(w.R)(t);n=o?e.LastDeliveryOrRenewTime:e.ReceivedOrRenewTime;const r=w.b.getLastDeliveryOrRenewTimeStamp(e.InstanceKey,t),i=new Date(n).toString()===new Date(r).toString();return i||(o?e.LastDeliveryOrRenewTime=r:e.ReceivedOrRenewTime=r),i}function _(e,t,n){return(0,q[n])(e,t)}function G(e,t){return!i(e,t)&&(function(e,t){const n=e.InstanceKey,o=t.serverFolderId,i=r.a.getTombstonedReasons(n,o).slice(0);if(i)for(const a of i){if(3==a)throw new Error("syncTombstonedProperties should not be called for Remove reason");_(e,t,a)&&r.a.remove(n,o,a)}}(e,t),!0)}function z(e,t){const n=e.InstanceKey,o=t.serverFolderId,i=r.a.getTombstonedReasons(n,o);return i.indexOf(3)>-1?(r.a.remove(n,o,3),!0):!("Unread"===Object(w.Q)(t)&&Object(w.h)(t)&&i.indexOf(2)>-1)||(r.a.remove(n,o,2),!1)}q[1]=B,q[0]=function(e,t){const n=w.b.getCategories(e.InstanceKey,t),o=n?n.slice().sort():[],r=e.Categories?e.Categories.slice().sort():[],i=U()(o,r);i||(e.Categories=n);return i},q[2]=function(e,t){let n,o,r;const i=w.b.getUnreadCount(e.InstanceKey,t);Object(w.R)(t)?(n=e,o=n.UnreadCount,r=i==o,r||(n.UnreadCount=i),Object(w.f)(t)&&(!function(e,t){const n=e,o=n.LastDeliveryTime,r=w.b.getLastDeliveryTimeStamp(e.InstanceKey,t);new Date(o).toString()!==new Date(r).toString()&&(n.LastDeliveryTime=r)}(e,t),B(e,t))):Object(w.X)(e)?(n=e,o=n.IsRead?0:1,r=i==o,r||(n.IsRead=0==i)):r=!0;return r},q[4]=function(){},n.d(t,"c",(function(){return g})),n.d(t,"h",(function(){return E})),n.d(t,"a",(function(){return L})),n.d(t,"b",(function(){return A})),n.d(t,"l",(function(){return T})),n.d(t,"f",(function(){return P})),n.d(t,"d",(function(){return p})),n.d(t,"k",(function(){return G})),n.d(t,"j",(function(){return z})),n.d(t,"g",(function(){return x})),n.d(t,"e",(function(){return o})),n.d(t,"i",(function(){return F}))},3020:function(e,t,n){"use strict";var o={};n.r(o),n.d(o,"add",(function(){return c})),n.d(o,"remove",(function(){return u})),n.d(o,"removeAll",(function(){return d})),n.d(o,"getCount",(function(){return l})),n.d(o,"getTombstonedReasons",(function(){return f})),n.d(o,"clearMapForFolder",(function(){return b})),n.d(o,"removeRowsFromTombstone",(function(){return m}));var r=n(2);let i=Object(r.createStore)("tombstone",{folderTombstoneMap:{}});i();var a=n(68),s=n(358);let c=Object(s.action)("tombstoneOperations.add")((function(e,t,n){if(1==t.tableQuery.type||"spotlight"===t.tableQuery.scenarioType)return;const o=t.serverFolderId,r=i().folderTombstoneMap;o in r||(r[o]={});const a=r[o];e.forEach(e=>{let t=a[e];t?3!=n?t.indexOf(3)>-1||-1==t.indexOf(n)&&t.push(n):a[e]=[3]:a[e]=[n]})})),u=Object(s.action)("tombstoneOperations.remove")((function(e,t,n){const o=i().folderTombstoneMap;if(!(t in o))return;const r=o[t],a=r[e],s=a?a.indexOf(n):-1;if(-1==s)throw new Error("tombstone.remove given reason does not exist when trying to remove entry from it");a.splice(s,1),0==a.length&&delete r[e],0==Object.keys(r).length&&delete o[t]})),d=Object(s.action)("tombstoneOperations.removeAll")((function(){i().folderTombstoneMap={},Object(a.q)("TnS_RemoveAllFromTombstone")})),l=function(e,t){const n=i().folderTombstoneMap;if(!(e in n))return 0;let o=0;const r=n[e];return Object.values(r).forEach(e=>{e==t&&o++}),o},f=function(e,t){const n=i().folderTombstoneMap;if(t in n){const o=n[t][e];if(o)return o}return[]},b=Object(s.action)("tombstoneOperations.clearMapForFolder")((function(e){const t=i().folderTombstoneMap;t[e]&&(Object(a.q)("TnS_ClearFolderMapInTombstone",[Object.keys(t[e]).length]),delete t[e])})),m=Object(s.action)("tombstoneOperations.removeRowsFromTombstone")((function(e,t){const n=i().folderTombstoneMap;if(!(t in n))return;const o=n[t];for(const t of e)t in o&&delete o[t];0==Object.keys(o).length&&delete n[t]}));t.a=o},3399:function(e,t,n){"use strict";var o={};n.r(o),n.d(o,"addRow",(function(){return W})),n.d(o,"appendRow",(function(){return Y})),n.d(o,"removeRow",(function(){return J})),n.d(o,"updateRowPosition",(function(){return X})),n.d(o,"updateRow",(function(){return $})),n.d(o,"updateRowData",(function(){return ee})),n.d(o,"clear",(function(){return te})),n.d(o,"containsRowKey",(function(){return ne}));var r=n(3539),i=n(3890),a=n(2827),s=n(52),c=n(25),u=n(2790),d=n(963),l=n(468);var f=n(2733),b=n(3918);function m(e,t,n,o){if(e>0&&Object(c.k)("tri-txpButtonInLV")&&!Object(u.e)(o.tableQuery)&&function(e){return e>0&&(Object(l.a)(e,d.b)==d.b||Object(l.a)(e,d.a)==d.a)}(e)){return Object(f.L)().txpActionButtonData.get(n)||b.b.importAndExecute(o,t,n),!0}return!1}function p(e,t){return{Id:e.ConversationId.Id,mailboxInfo:Object(a.b)(t)}}function w(e,t){const n=function(e){const t=[];for(const n of e){const e=Object.assign({},n);t.push(e.Id)}return t}(e.GlobalItemIds),o=e.ItemIds[0].Id;return{id:e.ConversationId.Id,subject:e.ConversationTopic,globalItemIds:n,shouldShowAttachmentPreviews:Object(s.g)().UserOptions.ShowInlinePreviews&&Object(r.e)(e,t.tableQuery),validCouponIndexes:Object(i.b)(e,t.tableQuery),globalUnreadCount:e.GlobalUnreadCount,size:e.Size,clientId:p(e,t),globalMessageCount:e.GlobalMessageCount,shouldShowTxpButton:m(e.EntityNamesMap,e.InstanceKey,o,t),hasExternalEmails:e.HasExternalEmails,hasSharepointLink:e.HasProcessedSharepointLink}}var I=n(5829),y=n(3202),O=n(1085),v=n(2751),g=n(3020);const h=[Object(O.a)({FieldURI:"Start"}),Object(O.a)({FieldURI:"End"}),Object(O.a)({FieldURI:"CalendarItemType"})],R=[Object(O.a)({FieldURI:"ConflictingMeetings"}),Object(O.a)({FieldURI:"IsResponseRequested"}),Object(O.a)({FieldURI:"Organizer"})];function T(e,t,n,o){if(g.a.getTombstonedReasons(e,o.serverFolderId).indexOf(4)>-1)return!1;const r=o.tableQuery.folderId?Object(v.a)(o.tableQuery.folderId):null;return!(!t||Object(u.e)(o.tableQuery)||!n||!(r||"deleteditems"!==r&&"sentitems"!==r)||!Object(y.q)(n)&&!Object(y.l)(n))}function j(e,t,n,o){T(e,t,n,o)&&function(e,t){const n=Object(f.L)().meetingMessageItems.get(e);if(!n)return!0;let o=h;Object(y.q)(t)&&(o=o.concat(R));return o.some(e=>void 0===n[e.FieldURI])}(t,n)&&I.a(o,e,t)}function S(e,t){if(!e.ItemClasses||0===e.ItemClasses.length)return!1;const n=e.ItemIds[0].Id,o=e.ItemClasses[0];return!!T(e.InstanceKey,n,o,t)&&(j(e.InstanceKey,n,o,t),!0)}function C(e){return e.GlobalMentionedMe||e.GlobalAtAllMention}function x(e){return Object(c.k)("tri-flagStatusV2")&&e.FlagStatusV2?e.FlagStatusV2:e.FlagStatus}var K=n(2791),D=n(22),V=n(358),M=Object(V.action)("addOrUpdateConversationData")((function(e,t,n=!1,o={conversationItems:f.Z.conversationItems,tableViewConversationRelations:f.Z.tableViewConversationRelations}){const{conversationItems:r,tableViewConversationRelations:i}=o;e.ConversationId||D.d("addOrUpdateConversationData: ConversationId is undefined");const a=e.ConversationId.Id,s=Object(f.O)(e.InstanceKey,t.id);if(k(n,a,r)){const n=w(e,t);r.set(a,n)}const c=function(e,t){return{categories:e.Categories,draftItemIds:e.DraftItemIds?e.DraftItemIds.map(e=>e.Id):[],effectiveMentioned:C(e),executeSearchSortOrder:e.SortOrderSource,flagStatus:x(e),hasAttachments:e.HasAttachments,isTaggedForBigScreen:e.IsTaggedForBigScreen,hasIrm:e.HasIrm,iconIndex:e.IconIndex,id:e.ConversationId.Id,importance:e.Importance,instanceKey:e.InstanceKey,itemClasses:e.ItemClasses,itemIds:e.ItemIds.map(e=>e.Id),lastDeliveryOrRenewTimeStamp:e.LastDeliveryOrRenewTime,lastDeliveryTimeStamp:e.LastDeliveryTime,lastSentTimeStamp:e.LastSentTime||e.LastDeliveryTime,lastModifiedTimeStamp:e.LastModifiedTime,lastSender:e.LastSender?e.LastSender:e.From,parentFolderId:e.ParentFolderId?e.ParentFolderId.Id:null,previewText:e.Preview,returnTime:e.ReturnTime?e.ReturnTime:null,uniqueRecipients:e.UniqueRecipients,uniqueSenders:e.UniqueSenders,unreadCount:e.UnreadCount,globalLikeCount:e.GlobalLikeCount?e.GlobalLikeCount:null,shouldShowRSVP:S(e,t),spotlightIsVisible:e.SpotlightIsVisible}}(e,t);if(Object(K.a)()&&F(e,t)){const t=e.ItemIds.map(e=>e.Id);Object(f.e)(e.InstanceKey,[...t])}i.set(s,c)}));const k=(e,t,n)=>{return!n.get(t)||!e},F=(e,t)=>{const n=e.InstanceKey,o=[...t.selectedRowKeys.keys()];if(1==o.length&&n===o[0]){const o=f.b.getItemIds(n,t);if(o&&o.length<e.MessageCount)return!0}return!1};var E=n(5830),L=n(4350),A=n(2742);function P(e,t){const n=e.ItemId.Id,o=e.ItemClass;return!!T(e.InstanceKey,n,o,t)&&(j(e.InstanceKey,n,o,t),!0)}var Q=Object(V.action)("addOrUpdateItemData")((function(e,t,n={items:A.u.items,tableViewItemRelations:f.Z.tableViewItemRelations}){const o=e.ItemId.Id,c=Object.assign(Object.assign({},e),{MailboxInfo:Object(a.b)(t),validCouponIndexes:Object(i.c)(e,t.tableQuery),shouldShowAttachmentPreviews:Object(s.g)().UserOptions.ShowInlinePreviews&&Object(r.f)(e,t.tableQuery),shouldShowRSVP:P(e,t),shouldShowTxpButton:m(e.EntityNamesMap,e.InstanceKey,e.ItemId.Id,t)});if(n.items.has(o)){!function(e,t,n){var o;const r="spotlight"==(null===(o=null==n?void 0:n.tableQuery)||void 0===o?void 0:o.scenarioType);if(1===n.tableQuery.type||r||(e.ReceivedOrRenewTime=t.ReceivedOrRenewTime,e.validCouponIndexes=t.validCouponIndexes,e.shouldShowRSVP=t.shouldShowRSVP,e.shouldShowTxpButton=t.shouldShowTxpButton),e.Subject=t.Subject,e.Importance=t.Importance,e.Sensitivity=t.Sensitivity,e.HasAttachments=t.HasAttachments,e.ItemClass=t.ItemClass,e.Flag=t.Flag,e.Categories=t.Categories,e.SpotlightIsVisible=t.SpotlightIsVisible,e.ParentFolderId=t.ParentFolderId,e.ConversationId=t.ConversationId,e.DateTimeReceived=t.DateTimeReceived,e.IsDraft=t.IsDraft,e.Size=t.Size,e.Preview=t.Preview,e.DisplayTo=t.DisplayTo,e.IconIndex=t.IconIndex,e.shouldShowAttachmentPreviews=t.shouldShowAttachmentPreviews,t.ReturnTime&&(e.ReturnTime=t.ReturnTime),t.HasProcessedSharepointLink&&(e.HasProcessedSharepointLink=t.HasProcessedSharepointLink),!(null==e?void 0:e.ItemClass)||-1!==e.ItemClass.indexOf("IPM.Schedule.Meeting")||-1!==e.ItemClass.indexOf("IPM.Note")){const o=e,r=t;o.IsRead=r.IsRead,1!==n.tableQuery.type&&(o.IsReadReceiptRequested=r.IsReadReceiptRequested,o.IsDeliveryReceiptRequested=r.IsDeliveryReceiptRequested)}}(n.items.get(o),c,t)}else n.items.set(o,c),c.ConversationId||D.d("addOrUpdateItemData: item.ConversationId is null.");const u=Object(L.a)(e.InstanceKey,t.id),d=Object(E.a)(e,t);n.tableViewItemRelations.set(u,d)})),U=Object(V.action)("addOrUpdateRowData")((function(e,t,n=!1){switch(t.tableQuery.listViewType){case 0:M(e,t,n);break;case 1:Q(e,t)}})),q=n(2883),B=n(2834),_=n(4351),G=Object(V.action)("removeConversationData")((function(e,t,n={tableViewConversationRelations:q.a.tableViewConversationRelations,tableViews:q.a.tableViews,conversationItems:q.a.conversationItems,conversationCache:B.a}){const o=Object(L.a)(e,t.id),a=n.tableViewConversationRelations,s=a.get(o).id,u=a.get(o).itemIds;if(!a.has(o))throw new Error("Conversation not found in store");a.delete(o);let d=!1;for(const e of n.tableViews.values())if(e.id!=t.id&&e.rowIdToRowKeyMap.get(s)){d=!0;break}d||(n.conversationItems.delete(s),r.d.importAndExecute(s),Object(c.k)("tri-coupon-peek")&&i.e.import().then(e=>{e(s)}),_.a.importAndExecute(u),Object(c.k)("tri-txpButtonInLV")&&b.c.importAndExecute(u),n.conversationCache.remove(s))})),z=n(3262);var H=n(3967),N=Object(V.action)("removeRowData")((function(e,t){switch(t.selectedRowKeys.has(e)&&Object(H.a)(e,t.id,!1),t.tableQuery.listViewType){case 0:G(e,t);break;case 1:!function(e,t){const n=Object(f.D)([e],t.id)[0],o=Object(f.O)(e,t.id);if(!f.Z.tableViewItemRelations.has(o))throw new Error("Item not found in list view store");f.Z.tableViewItemRelations.delete(o),_.a.importAndExecute([n]),Object(c.k)("tri-txpButtonInLV")&&b.c.importAndExecute([n]),Object(z.a)(n,0)}(e,t)}})),Z=n(5);function W(e,t,n,o="",r=!1){return U(t,n,r),oe(n,e,Object(f.E)(t,n.tableQuery.listViewType),o)}function Y(e,t,n="",o=!1){return W(t.rowKeys.length,e,t,n,o)}const J=Object(V.action)("tableOperations.removeRow")((function(e,t,n=""){ie(t,e,n),N(e,t)})),X=Object(V.action)("tableOperations.updateRowPosition")((function(e,t,n,o=""){const r=n.rowKeys.indexOf(t);if(r<0){const e=new Error("updateRowPosition: Row not found in table, source: "+o);return e.diagnosticInfo="tableLength: "+n.rowKeys.length+" rowKey: "+t,void D.d(e)}r!=e&&(ie(n,t,o),oe(n,e,t,o))})),$=Object(V.action)("tableOperations.updateRow")((function(e,t,n,o="",r=!1){X(e,Object(f.E)(t,n.tableQuery.listViewType),n,o),U(t,n,r)})),ee=Object(V.action)("tableOperations.updateRowData")((function(e,t){U(e,t)})),te=Object(V.action)("tableOperations.clear")((function(e,t=null,n=[],o=""){for(let r=e.rowKeys.length-1;r>=0;r--){const i=e.rowKeys[r];if(-1==n.indexOf(i))if(t){const n=f.b.getLastDeliveryTimeStamp(i,e);Object(Z.pc)(n)<t&&J(i,e,o)}else J(i,e,o)}}));function ne(e,t){return e.rowKeys.indexOf(t)>=0}function oe(e,t,n,o=""){if(t<0||t>e.rowKeys.length)return ue("addToTableRowKeys: Invalid add index",o,ae(e,t)),!1;if(ne(e,n))return ue("addToTableRowKeys: RowKey already exists",o,ae(e,t)),!1;try{const o=f.b.getRowIdString(n,e);return re(e,o,n,t),!0}catch(n){return ue("addToTableRowKeys: exception when adding row at valid index",o,ae(e,t)+" exp: "+(null==n?void 0:n.message)),!1}}const re=Object(V.action)("tableOperations.addRowKeyToTableRowKeysAndMap")((function(e,t,n,o){let r=e.rowIdToRowKeyMap.get(t);r||(r=[]),-1==r.indexOf(n)&&r.push(n),e.rowIdToRowKeyMap.set(t,r),e.rowKeys.splice(o,0,n)}));function ie(e,t,n=""){const o=e.rowKeys.indexOf(t);if(o<0)return void ue("removeFromTableRowKeys: RowKey not found in tableView.rowKeys",n,se(e));const r=f.b.getRowIdString(t,e),i=e.rowIdToRowKeyMap.get(r);if(!i)return void ue("removeFromTableRowKeys: invalid rowKeysForRowId",n,se(e,r));const a=i.indexOf(t);-1!=a?(1==i.length?e.rowIdToRowKeyMap.delete(r):i.splice(a,1),e.rowKeys.splice(o,1)):ue("removeFromTableRowKeys: RowKey should be present in rowIdToRowKey map",n,se(e,r))}function ae(e,t){return"addAtIndex: "+t+ce(e)}function se(e,t){return(t?"rowId: "+t:"")+ce(e)}function ce(e){return" tableLength: "+e.rowKeys.length+" tableType: "+e.tableQuery.type+" lvType: "+e.tableQuery.listViewType}function ue(e,t,n){const o=new Error(e+": source: "+t);o.diagnosticInfo=n,D.d(o)}t.a=o},3596:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s}));var o=n(20);const r=new o.c(()=>n.e(1214).then(n.bind(null,5373))),i=new o.a(r,e=>e.tti),a=new o.a(r,e=>e.govern),s=new o.a(r,e=>e.enableGovernReport)},3890:function(e,t,n){"use strict";var o=n(20),r=n(5825),i=n(5828);function a(e,t){return new Date(e)>new Date(t)}var s=n(25),c=n(2827),u=n(2742),d=n(2751),l=n(2733);function f(e,t){const n=e.ConversationId.Id;if(Object(l.L)().couponPeekPreviews.get(n)){const e=Object(l.ab)(n);if(e)return e.validCouponIndexes}return m(e.ItemIds[0].Id,e.CouponRanks,e.CouponExpiryDates,t)}function b(e,t){if(!Object(l.X)(e))return null;const n=e,o=e.ItemId.Id;if(Object(l.L)().couponPeekPreviews.get(o)){const e=Object(u.g)().items.get(o);if(e)return e.validCouponIndexes}return m(e.ItemId.Id,n.CouponRanks,n.CouponExpiryDates,t)}function m(e,t,n,o){if(1==o.type)return null;if("junkemail"==Object(d.a)(o.folderId))return null;if(!t||!n||t.length!=n.length)return null;const r=[];for(let e=0;e<n.length;e++){a(n[e],Date.now())&&r.push({index:e,rank:t[e]})}return r.sort((function(e,t){return t.rank-e.rank})),r.length>0&&Object(s.k)("tri-coupon-peek")&&i.a(Object(c.d)(o).mailboxSmtpAddress,e),r.map(e=>e.index)}n.d(t,"d",(function(){return w})),n.d(t,"e",(function(){return I})),n.d(t,"a",(function(){return y})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return b}));const p=new o.c(()=>n.e(2174).then(n.bind(null,19885)));let w=new o.b(p,e=>e.fetchCouponData),I=new o.b(p,e=>e.removeCouponFromStore),y=Object(o.d)(p,e=>e.CouponPreviewWell,e=>Object(r.a)(e))},3918:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var o=n(20);const r=new o.c(()=>Promise.all([n.e(63),n.e(149),n.e(643)]).then(n.bind(null,9033))),i=new o.a(r,e=>e.tryGetTxpAdditionalData),a=new o.a(r,e=>e.removeTxpFromStoreAction),s=new o.a(r,e=>e.addToTxpItemIdMap),c=Object(o.d)(r,e=>e.TxpListViewButton)},3967:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(2);const r=Object(o.action)("SET_SELECTION_ON_ROW",(e,t,n)=>({rowKey:e,tableViewId:t,shouldSelect:n}))},4351:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var o=n(20);const r=new o.c(()=>n.e(1101).then(n.bind(null,9050))),i=new o.a(r,e=>e.tryPrefetchMeetingMessage),a=new o.a(r,e=>e.removeMeetingMessagesFromStore)},4454:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(3411),r=n(5314);function i(e,t,n){switch(t.tableQuery.listViewType){case 0:Object(o.a)(e,t.id).instrumentationContext=n;break;case 1:Object(r.a)(e,t.id).instrumentationContext=n}}},4737:function(e,t){e.exports=function(e,t){var n=e.length;if(n!==t.length)return!1;for(var o=0;o<n;o++)if(e[o]!==t[o])return!1;return!0}},5825:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var o=n(5826),r=n(351),i=n(0),a=n(5827),s=n.n(a);function c(e){const t=Math.min(o.a,e.validCouponIndexes.length);return Array.apply(null,Array(t)).map(e=>i.createElement("div",{key:e},i.createElement(r.a,{iconName:"",className:s.a.icon})))}},5826:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));const o=1},5827:function(e,t,n){var o=n(6077);"string"==typeof o&&(o=[[e.i,o,""]]);var r={transform:void 0};n(84)(o,r);o.locals&&(e.exports=o.locals)},5828:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return c}));var o=n(22);const r={};let i=function(e,t){if(a(e,t))return void o.h.warn("couponPeekOperations: duplicate itemId should not be fetched again");r[e]?r[e].push(t):r[e]=[t]},a=function(e,t){const n=r[e];return n&&n.indexOf(t)>0},s=function(e){delete r[e]},c=function(e){return r[e]}},5829:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return c}));var o=n(2827);const r={};let i=function(e,t,n){const i=Object(o.d)(e.tableQuery).mailboxSmtpAddress;a(i,n)||(r[i]?r[i].push({rowKey:t,itemId:n,tableViewId:e.id}):r[i]=[{rowKey:t,itemId:n,tableViewId:e.id}])},a=function(e,t){const n=r[e];return n&&n.some(e=>e.itemId===t)},s=function(e){delete r[e]},c=function(e){return r[e]}},5830:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));var o=n(2827);function r(e,t){return{Id:e,mailboxInfo:Object(o.b)(t)}}function i(e,t){return{executeSearchSortOrder:e.SortOrderSource,clientId:r(e.ItemId.Id,t),instanceKey:e.InstanceKey}}},6077:function(e,t,n){(t=e.exports=n(83)(!1)).push([e.i,".aAOUrceWy2gvw1VJ9nVpx{white-space:nowrap;color:var(--redDark);font-weight:400}html[dir=ltr] ._3CKg3eii2ICDVpVyYyZe9k{margin-right:10px}html[dir=rtl] ._3CKg3eii2ICDVpVyYyZe9k{margin-left:10px}",""]),t.locals={couponRow:"aAOUrceWy2gvw1VJ9nVpx",icon:"_3CKg3eii2ICDVpVyYyZe9k"}}}]);
//# sourceMappingURL=owa.89.js.map
self.scriptsLoaded['owa.89.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.89.js'] = (new Date()).getTime();