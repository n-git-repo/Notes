self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.612.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[612],{10422:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(22);class i{constructor(e=5,t=5e3){this.throttleCallbacks=[],this.activeRequests=0,this.processedRequests=0,this.lastProcessedRequests=0,this.watchDogTimer=null,this.clearQueue=()=>{this.throttleCallbacks.length=0,this.activeRequests=0},this.maxConcurrentRequests=e,this.watchDogTimerInterval=t}watchDogAction(){this.throttleCallbacks.length>0?this.processedRequests===this.lastProcessedRequests?(this.activeRequests=0,this.traceInfo("Watch dog is processing the queue."),this.processNextRequest()):(this.traceInfo("Watch dog is watching."),this.lastProcessedRequests=this.processedRequests):(window.clearInterval(this.watchDogTimer),this.watchDogTimer=null,this.traceInfo("Stop watch dog."))}traceInfo(e){a.h.info(`ThrottleRequests:active=${this.activeRequests};throttled=${this.throttleCallbacks.length};processed=${this.processedRequests};lastProcessed=${this.lastProcessedRequests};info=${e}`)}processNextRequest(){if(this.processedRequests++,0===this.throttleCallbacks.length)this.activeRequests>0&&this.activeRequests--,this.traceInfo("Queue is empty.");else{this.throttleCallbacks.shift()(!1),this.traceInfo("Process next.")}}registerCallback(e){if(null==e)throw new Error("A null callback is registered to Throttle Thumbnails queue.");this.activeRequests<this.maxConcurrentRequests?(e(!1),this.activeRequests++,this.processedRequests++,this.traceInfo("Process now.")):(e(!0),this.throttleCallbacks.push(e),this.traceInfo("Pushes to queue."),this.watchDogTimer||(this.watchDogTimer=window.setInterval(()=>{this.watchDogAction()},this.watchDogTimerInterval),this.traceInfo("Start watch dog.")))}unregisterCallback(e){const t=this.throttleCallbacks.indexOf(e);this.throttleCallbacks.splice(t,1),this.activeRequests=0,this.traceInfo("unregisterComponent:"+t)}}},11499:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s}));var a=n(20);const i=new a.c(()=>Promise.all([n.e(6),n.e(8),n.e(124),n.e(150),n.e(146),n.e(873)]).then(n.bind(null,13275))),r=new a.b(i,e=>e.openBotConversation),s=new a.b(i,e=>e.openCortanaConversation);new a.a(i,e=>e.setEditorInterface)},18157:function(e,t,n){var a=n(18158);"string"==typeof a&&(a=[[e.i,a,""]]);var i={transform:void 0};n(84)(a,i);a.locals&&(e.exports=a.locals)},18158:function(e,t,n){(t=e.exports=n(83)(!1)).push([e.i,".YHuTLR0ArejsCKCCDtUvI{-webkit-box-sizing:border-box;box-sizing:border-box}html[dir] .YHuTLR0ArejsCKCCDtUvI{border-width:1px;border-style:dashed;border-color:var(--themePrimary)}",""]),t.locals={imagePlaceholder:"YHuTLR0ArejsCKCCDtUvI"}},18159:function(e){e.exports=JSON.parse('{"a":"hLc","c":"iLc","b":"jLc","g":"kLc","f":"lLc","e":"mLc","h":"nLc","d":"oLc","i":"pLc","j":"qLc"}')},18160:function(e){e.exports=JSON.parse('{"a":"sLc","b":"tLc","c":"uLc"}')},18161:function(e){e.exports=JSON.parse('{"a":"rLc"}')},18162:function(e,t,n){var a=n(18163);"string"==typeof a&&(a=[[e.i,a,""]]);var i={transform:void 0};n(84)(a,i);a.locals&&(e.exports=a.locals)},18163:function(e,t,n){(t=e.exports=n(83)(!1)).push([e.i,"html[dir] .e7RD5OqJ5eTaFCmmUQNhE{margin-top:12px}html[dir=ltr] .e7RD5OqJ5eTaFCmmUQNhE{margin-left:52px}html[dir=rtl] .e7RD5OqJ5eTaFCmmUQNhE{margin-right:52px}._3gCYwk0lDIK2EfckwxKl4W{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}._3fpj87EnIj38wOaoGqJcxK{-ms-flex-item-align:center;align-self:center;height:16px;line-height:16px}html[dir] ._3fpj87EnIj38wOaoGqJcxK{margin-top:8px}._3fpj87EnIj38wOaoGqJcxK ._2PapeCuGRS-nixm3gyA25I{font-size:8px}",""]),t.locals={container:"e7RD5OqJ5eTaFCmmUQNhE",cardArea:"_3gCYwk0lDIK2EfckwxKl4W",bodyToggleButton:"_3fpj87EnIj38wOaoGqJcxK",icon:"_2PapeCuGRS-nixm3gyA25I"}},19726:function(e,t,n){"use strict";n.r(t);var a=n(9909);async function i(e){var t,n,i;if(null===(t=e.AdaptiveCardData)||void 0===t?void 0:t.cardDetails)return e.AdaptiveCardData.cardDetails;return(null!==(i=await Object(a.d)([null===(n=e.ItemId)||void 0===n?void 0:n.Id]))&&void 0!==i?i:[[]])[0]}var r=n(0),s=n(21),o=n(22),c=n(68),d=n(5),l=n(3840),u=n(4511),h=n(6838),p=n(5758),b=n(2);var m=Object(b.mutatorAction)("SET_SHOW_BODY_WITH_MESSAGE_CARD",(function(e,t){e?e.showBodyWithMessageCard=t:o.h.warn("[ActionableMessageDebug] setShowBodyWithMessageCard: viewState undefined")}));var g=Object(b.mutatorAction)("updateShowCardLoading",(function(e,t){e.showCardLoading=t})),f=n(3403),C=n(2767),A=n(6),x=n(10422),O=n(18157),v=n.n(O);const y=/url\("(.*)"\)/g,S=new x.a(5,5e3);var w=(e,t,n)=>{const a=e.querySelectorAll('img[src^="cid:"]');if(a)for(let e=0;e<a.length;e++)I(a[e],t,n);const i=e.querySelectorAll("div[style*='background-image: url(\"cid:']");if(i)for(let e=0;e<i.length;e++)j(i[e],t,n)};const I=(e,t,n)=>{const a=e.src;if(a&&0===a.indexOf("cid:")){e.src=h.a,e.setAttribute("originalSrc",a),e.classList.add(v.a.imagePlaceholder);const i=M(a,t,n);if(i){const t=t=>{t||(e.src=i)};e.onload=t=>{e.classList.remove(v.a.imagePlaceholder),S.processNextRequest()},e.onerror=t=>{let n=t.target;e.classList.remove(v.a.imagePlaceholder),S.processNextRequest(),o.h.info("[ActionableMessageDebug] imageSrcError: image cannot be loaded for src: "+n.src)},S.registerCallback(t)}}},j=(e,t,n)=>{let a=e.style.backgroundImage;var i=y.exec(a);if(i&&i.length>1&&i[1]){const a=M(i[1],t,n);a&&(e.style.backgroundImage=Object(A.c)('url("{0}")',a))}},M=(e,t,n)=>{if(!t.Attachments)return null;const a=D(e.substring("cid:".length));let i;for(let e=0;e<t.Attachments.length;e++){const n=t.Attachments[e];if(a===D(n.Name)||a===D(n.ContentId)){i=n.AttachmentId;break}}if(!i)return o.h.warn("[ActionableMessageDebug] fixSrcForImage: attachment id not found for cid: "+a),null;const r=Object(f.b)(Object.assign(Object.assign({},i),{mailboxInfo:n}),1);return r||(o.h.warn("[ActionableMessageDebug] fixSrcForImage: could not create attachment url for image with cid: "+a+" and attachment id: "+i),null)},D=e=>{if(Object(C.g)(e)){const t=Object(C.b)(e);return e.substring(0,e.length-t.length)}return e};var k=n(10997),N=n(3397);class P extends N.Action{getJsonTypeName(){return"DisplayAppointmentForm"}parse(e){super.parse(e),this.itemId=e.itemId,this.isPrimary=e.isPrimary}}const T="Action.InvokeAddInCommand",R="Action.PinAddInCommand",E="Action.DisplayReplyAllForm",J="Action.DisplayAppointmentForm",L="Action.DisplayMessageForm",z="Action.StartBotConversation";class q extends N.Action{getJsonTypeName(){return L}parse(e){super.parse(e),this.itemId=e.itemId,this.isPrimary=e.isPrimary}}class F extends N.Action{getJsonTypeName(){return"DisplayReplyAllForm"}parse(e){super.parse(e),this.isPrimary=e.isPrimary}}class _ extends N.Action{constructor(){super(),this.addinId="",this.desktopCommandId="",this.initializationContext=""}parse(e){super.parse(e),this.isPrimary=e.isPrimary,this.addinId=e.addInId?e.addInId:e.addinid,this.desktopCommandId=e.desktopCommandId?e.desktopCommandId:e.desktopcommandid,this.initializationContext=e.initializationContext?JSON.stringify(e.initializationContext):JSON.stringify(e.initializationcontext)}getJsonTypeName(){return T}}class H extends N.Action{constructor(){super(),this.productId="",this.newPinnedStatus=!1}parse(e){super.parse(e),this.isPrimary=e.isPrimary,this.productId=e.productId,this.newPinnedStatus=e.newPinnedStatus}getJsonTypeName(){return R}}class W extends N.Action{constructor(){super(),this.botId="",this.initialMessage="",this.botName=""}parse(e){super.parse(e),this.isPrimary=e.isPrimary,this.botId=e.botId,this.botName=e.botName,this.initialMessage=e.initialMessage}getJsonTypeName(){return z}}var U=n(2806),G=n(2899),B=n(1198),$=n(11499),K=n(2919),Y=n(3981),V=n(9924),Q=n(25),X=n(2756),Z=n(2857);const ee="MessageCardInvokeAddinCommandClicked",te="MessageCardPinAddinCommandClicked",ne="DisplayAppointmentFormClicked",ae="DisplayMessageFormClicked",ie="ActionCardHttpPostActionClicked",re="SingleClickHttpPostActionClicked",se="AutoInvokeActionClicked",oe="actionContext";var ce={registerActions:function(){N.AdaptiveCard.actionTypeRegistry.registerType(T,()=>new _),N.AdaptiveCard.actionTypeRegistry.registerType(R,()=>new H),N.AdaptiveCard.actionTypeRegistry.registerType(E,()=>new F),N.AdaptiveCard.actionTypeRegistry.registerType(J,()=>new P),N.AdaptiveCard.actionTypeRegistry.registerType(L,()=>new q),Object(Q.k)("mc-botConversation")&&N.AdaptiveCard.actionTypeRegistry.registerType(z,()=>new W)},executeAction:function(e,t,n,a,i,r,s,c){const d={id:e.id,type:e.getJsonTypeName()},l={cardDetails:t,elementDetails:d,messageContext:i,actionContext:e[oe],eventName:void 0};if(e instanceof F){o.h.info("[ActionableMessageDebug] onExecuteAction: reply all with: "+e.title);const t=X.HtmlSanitizer.sanitizeHtml(e.title);K.m.importAndExecute({referenceItemOrId:i.itemId,mailboxInfo:i.mailboxInfo,isReplyAll:!0,useFullCompose:!1,actionSource:"Link",instrumentationContexts:null,conversationId:i.conversationId,body:t})}else if(e instanceof P){o.h.info("[ActionableMessageDebug] onExecuteAction: display appointment form for itemId: "+e.itemId),l.eventName=ne,r.logTelemetry(l);const t=`/calendar/item/${encodeURIComponent(e.itemId)}`;window.open(t,"_blank")}else if(e instanceof q)o.h.info("[AdaptiveCard] DisplayMessageFormAction executed"),l.eventName=ae,r.logTelemetry(l),Object(Y.a)(e.itemId);else if(e instanceof H&&Object(Q.k)("addin-pinThroughAM")){o.h.info("[AdaptiveCard] PinAddinCommandAction executed"),l.eventName=te,r.logTelemetry(l),function(e){let t=Object(Z.t)().Extensions;for(const n of t)if(n.Id===e.productId){let t={readMode:null!=n.ExtensionPointCollection.MessageReadCommandSurface,composeMode:null!=n.ExtensionPointCollection.MessageComposeCommandSurface,calendarMode:null!=n.ExtensionPointCollection.AppointmentOrganizerCommandSurface&&null!=n.ExtensionPointCollection.AppointmentAttendeeCommandSurface};B.l.importAndExecute(e.productId.toLowerCase(),e.newPinnedStatus,t);break}}(e)}else if(e instanceof _){o.h.info("[AdaptiveCard] InvokeAddinCommandAction executed"),l.eventName=ee,r.logTelemetry(l);const t=e,n=Object(U.q)(i.itemId);U.C.import().then(e=>{e(n,t.addinId.toLowerCase(),t.desktopCommandId,G.a.MessageRead,c,t.initializationContext)})}else if(e instanceof W){const{botId:n,botName:a}=e,s=function(e){if(null==e?void 0:e.$data)return e.$data;return}(t.card);o.h.info("[ActionableMessageDebug] StartBotConversation executed with message: "+n),$.a.import().then(e=>e(i.mailboxInfo,{friendlyBotName:a,botId:n,botData:s,connectorSenderGuid:t.connectorSenderGuid,smtpAddressSerialized:t.smtpAddressesSerialized},"help")),r.logTelemetry(l)}else{if(!(e instanceof N.OpenUrlAction))return!1;{const t=new URL(e.url);if("mailto:"===t.protocol.toLowerCase()){const{composeInitProps:e}=Object(V.a)(t.href);K.k.importAndExecute(e,2)}}}return!0},parseLegacyMessageCardAction:function(e,t){switch(e["@type"].toLowerCase()){case"displayreplyallform":return function(e){const t=new F;return t.title=e.name,t.htmlBody=e.htmlBody,t}(e);case"invokeaddincommand":return function(e){const t=new _;return t.title=e.name,t.addinId=e.addInId,t.desktopCommandId=e.desktopCommandId,t.initializationContext=JSON.stringify(e.initializationContext),t}(e);case"pinaddincommand":return function(e){const t=new H;return t.title=e.name,t.productId=e.productId,t.newPinnedStatus=e.newPinnedStatus,t}(e)}return null},processAutoInvokeAction:function(e,t){if(Object(Q.k)("mc-botConversation")&&e.type===z){const t=new W;return t.parse(e),t}return null},registerHostCapabilities:null},de=n(18159),le=n(7869),ue=n(18160),he=n(18161),pe=n(340);var be=()=>Object(Q.k)("rp-actionableMessages-ACv2-support");const me="messageCardContext";var ge,fe=n(3878),Ce=n(52),Ae=n(9704);!function(e){e.Completed="Completed",e.Failed="Failed"}(ge||(ge={}));var xe=ge;var Oe=e=>{let t=e?6e3:1e4;const n=Object(h.j)();return e&&(null==n?void 0:n.AutoInvokedActionTimeoutInMsec)?t=n.AutoInvokedActionTimeoutInMsec:!e&&(null==n?void 0:n.HttpActionTimeoutInMsec)&&(t=n.HttpActionTimeoutInMsec),t};var ve=(e,t,n)=>{const a=e.action,i={type:"invoke",name:"adaptiveCard/action",localTimezone:"",localTimestamp:"",value:{action:{type:"Action.Execute",id:a.id,verb:a.verb,data:a.data},trigger:e.trigger},from:{id:t},channelData:n};return e.authCode&&(i.value.state=e.authCode),i};var ye=e=>{"string"==typeof e&&(e={buttons:[{type:"signin",value:e}]});const t=new fe.Authentication;return t.parse(e),t};class Se extends fe.ChannelAdapter{constructor(e,t,n,a,i){super(),this.url=e,this.parseCardFromStringOrObject=e=>u.d.import().then(t=>t(this.cardDetails,this.cardDetails.connectorSenderGuid,e.newCardPayload,e.newCardSignature,!0,this.cardDetails.cardId)),this.isActionInShowCard=e=>{for(;e.parent;){if(e instanceof fe.AdaptiveCard)return!0;e=e.parent}return!1},this.cardDetails=t,this.messageContext=n,this.onCardDetailsUpdated=a,this.telemetryHandler=i}parseResponse(e,t){const n=t&&e.status===xe.Completed;let a;return a=e.displayMessage?e.displayMessage:e.errorMessage?e.errorMessage:n?Object(A.b)(Ae.a):Object(A.b)(le.a),{status:n?xe.Completed:xe.Failed,displayMessage:a,newCardPayload:e.refreshCardSerialized,newCardSignature:e.refreshCardSignature,loginUrl:e.loginUrl,oAuthCard:e.oAuthCard}}getActionTelemetryEventName(e){return e.trigger===fe.ActivityRequestTrigger.Automatic?se:e.action.parent&&this.isActionInShowCard(e.action.parent)?ie:re}getTelemetryDataFromAnalytics(e,t,n){const a=Object(p.d)(this.telemetryHandler.getTelemetryDetailsForEvent(this.cardDetails,e,t,n),!1);if(a.messageCardContext)try{a.messageCardContext=JSON.parse(a.messageCardContext)}catch(e){}if(a.messageCardExtensionContext)try{a.messageCardExtensionContext=JSON.parse(a.messageCardExtensionContext)}catch(e){}if(a.actionContext)try{a.actionContext=JSON.parse(a.actionContext)}catch(e){}return a}getActionExecuteChannelData(e,t){return{connectorSenderGuid:this.cardDetails.connectorSenderGuid,inputParameters:[],senderAddress:this.messageContext.senderAddress,smtpAddressesSerialized:this.cardDetails.smtpAddressesSerialized,adaptiveCardSignature:this.cardDetails.cardSignature,adaptiveCardHash:this.cardDetails.cardHash,clientTelemetry:this.getTelemetryDataFromAnalytics(e,null,t)}}async sendRequestAsync(e){var t,n,a;try{const i=Object(Ce.g)(),r=null===(t=i.SessionSettings)||void 0===t?void 0:t.UserPrincipalName,s=null===(n=i.SessionSettings)||void 0===n?void 0:n.UserEmailAddress,o=await Object(l.a)();if(!o){const e=new Error(`Token is empty: ${o}`);throw e.name="EmptyTokenError",e}const c=this.getActionTelemetryEventName(e),d={id:e.action.id,type:e.action.getJsonTypeName()};this.telemetryHandler.logTelemetryProvider(this.cardDetails,c,null,d);const u=this.getActionExecuteChannelData(c,d),p=ve(e,r||s,u),b=e.trigger===fe.ActivityRequestTrigger.Automatic,m=Oe(b),g=Object(h.c)(new Headers);g.set("Content-Type","application/json"),g.set("Authorization",`Bearer ${o}`);const f={method:"POST",headers:g,body:JSON.stringify(p)};let C=await Object(h.e)(this.url,f,m);const A=await C.json(),x=this.parseResponse(A,C.ok);if(x.newCardPayload){const e=await this.parseCardFromStringOrObject(x);this.cardDetails=e,this.onCardDetailsUpdated([e])}let O;return O=C.ok&&x.status===xe.Completed?new fe.SuccessResponse(e,x.newCardPayload?x.newCardPayload:x.displayMessage):x.oAuthCard||x.loginUrl?new fe.LoginRequestResponse(e,ye(null!==(a=x.oAuthCard)&&void 0!==a?a:x.loginUrl)):new fe.ErrorResponse(e,new fe.ActivityRequestError(xe.Failed,x.displayMessage)),O}catch(t){return new fe.ErrorResponse(e,new fe.ActivityRequestError(xe.Failed,Object(A.b)(le.a)))}}}var we=n(2996);class Ie extends fe.Action{internalParse(e,t){super.internalParse(e,t),this.itemId=e.itemId}getJsonTypeName(){return J}}class je extends fe.Action{internalParse(e,t){super.internalParse(e,t),this.itemId=e.itemId}getJsonTypeName(){return L}}class Me extends fe.Action{getJsonTypeName(){return E}}class De extends fe.Action{constructor(){super(...arguments),this.addinId="",this.desktopCommandId="",this.initializationContext=""}internalParse(e,t){super.internalParse(e,t),this.addinId=e.addInId?e.addInId:e.addinid,this.desktopCommandId=e.desktopCommandId?e.desktopCommandId:e.desktopcommandid,this.initializationContext=e.initializationContext?JSON.stringify(e.initializationContext):JSON.stringify(e.initializationcontext)}getJsonTypeName(){return T}}class ke extends fe.Action{constructor(){super(...arguments),this.productId="",this.newPinnedStatus=!1}internalParse(e,t){super.internalParse(e,t),this.productId=e.productId,this.newPinnedStatus=e.newPinnedStatus}getJsonTypeName(){return R}}var Ne={registerActions:function(){fe.GlobalRegistry.actions.register(T,De),fe.GlobalRegistry.actions.register(R,ke),fe.GlobalRegistry.actions.register(E,Me),fe.GlobalRegistry.actions.register(J,Ie),fe.GlobalRegistry.actions.register(L,je)},executeAction:function(e,t,n,a,i){const r={cardDetails:t,elementDetails:{id:e.id,type:e.getJsonTypeName()},messageContext:n,actionContext:e[oe],eventName:void 0};if(e instanceof Me){o.h.info("[ActionableMessageDebug] onExecuteAction: reply all with: "+e.title);const t=X.HtmlSanitizer.sanitizeHtml(e.title);K.m.importAndExecute({referenceItemOrId:n.itemId,mailboxInfo:n.mailboxInfo,isReplyAll:!0,useFullCompose:!1,actionSource:"Link",instrumentationContexts:null,conversationId:n.conversationId,body:t})}else if(e instanceof Ie){o.h.info("[ActionableMessageDebug] onExecuteAction: display appointment form for itemId: "+e.itemId),r.eventName=ne,a.logTelemetry(r);const t=`/calendar/item/${encodeURIComponent(e.itemId)}`;window.open(t,"_blank")}else if(e instanceof je)o.h.info("[AdaptiveCard] DisplayMessageFormAction executed"),r.eventName=ae,a.logTelemetry(r),Object(Y.a)(e.itemId);else if(e instanceof ke&&Object(Q.k)("addin-pinThroughAM")){o.h.info("[AdaptiveCard] PinAddinCommandAction executed"),r.eventName=te,a.logTelemetry(r),function(e){let t=Object(Z.t)().Extensions;for(const n of t)if(n.Id===e.productId){let t={readMode:null!=n.ExtensionPointCollection.MessageReadCommandSurface,composeMode:null!=n.ExtensionPointCollection.MessageComposeCommandSurface,calendarMode:null!=n.ExtensionPointCollection.AppointmentOrganizerCommandSurface&&null!=n.ExtensionPointCollection.AppointmentAttendeeCommandSurface};B.l.importAndExecute(e.productId.toLowerCase(),e.newPinnedStatus,t);break}}(e)}else if(e instanceof De){o.h.info("[AdaptiveCard] InvokeAddinCommandAction executed"),r.eventName=ee,a.logTelemetry(r);const t=e,s=Object(U.q)(n.itemId);U.C.import().then(e=>{e(s,t.addinId.toLowerCase(),t.desktopCommandId,G.a.MessageRead,i,t.initializationContext)})}}},Pe=n(18162),Te=n.n(Pe),Re=Object(s.a)((function(e){const t=r.useContext(we.a);r.useEffect(()=>(o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper mount"),()=>{S.clearQueue(),o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper unmount")}),[]),r.useEffect(()=>{o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper update"),O()}),r.useEffect(()=>(b.current=setTimeout(()=>{o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper card load timed out"),Object(c.p)("actionableMessageContentLoadTimeout"),Object(p.e)(p.b.CardLoadTimeout,p.a.Standard),f.current=!0,P(!0)},4e3),()=>clearTimeout(b.current)),[]);const n=r.useRef({loadStartTime:Object(d.Ub)()}),s=r.useRef([]),b=r.useRef(),f=r.useRef(),[C,x]=r.useState(null),O=async()=>{const{item:t}=e,{cardFetchStatus:r}=t.AdaptiveCardData;if(r===u.c.Loading)return void o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties fetch already in process. Aborting this attempt");n.current.fetchStartTime=Object(d.Ub)();const{cardDetails:s}=t.AdaptiveCardData;if(s&&s.length>0)return o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties already had cardDetails on the item. cardId: "+s[0].cardId),void(n.current.fetchEndTime=Object(d.Ub)());const l=new c.b("MCActionableCardGetProperty");try{o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties fetching cardDetails from the server"),Object(a.g)([t],u.c.Loading);const e=await i(t);e&&e.length>0?(Object(a.g)([t],u.c.Loaded),l.end(),n.current.fetchEndTime=Object(d.Ub)(),o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties got card details from the server. cardId: "+e[0].cardId),Object(a.a)(t,e)):(o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties error getting card details from the server"),Object(a.g)([t],u.c.NotLoaded),P(!0),l.endWithError("ServerError"))}catch(e){o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties error getting card details from the server"),o.h.warn("[ActionableMessageDebug] ActionableMessageMailWrapper getCardProperties: exception during getCardDetails: "+e.message),Object(a.g)([t],u.c.NotLoaded),P(!0),l.endWithError("ClientError")}},v=e=>e.filter(e=>!e.isContextual),y=a=>{const i=v(a),c=Object(k.a)(e.item);let d={onUndo:()=>(()=>{const{darkModeContentHandler:t,undoDarkMode:n}=e;t&&n&&(o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper: applyDarkModeHandlerToCardElement: undoing dark mode"),t.undoHandler(s.current),s.current=[])})(),onApply:t=>(t=>{const{undoDarkMode:n,darkModeContentHandler:a}=e;if(t&&a&&!n)if(o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper: applyDarkModeHandlerToCardElement: applying dark mode to card elements"),a.cssSelector){a.handler(t),s.current.push(t);const e=t.querySelectorAll(a.cssSelector);if(e)for(let t=0;t<e.length;t++){const n=e.item(t);a.handler(n),s.current.push(n)}}else o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper: applyDarkModeHandlerToCardElement: no cssSelector specified by DarkMode handler")})(t)};const b=new u.b(p.g,c,n.current);let m;if(i&&i.length>0&&(m=be()?i[0]:i[i.length-1]),m&&(t=>{var n;let a=!0,i=null===(n=null==t?void 0:t.card)||void 0===n?void 0:n.originator;return i||(i=null==t?void 0:t.connectorSenderGuid),i&&(a=!Object(h.l)(i,e.isDarkMode)),a})(m)){o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper renderCardFromDetails. cardId: "+m.cardId);const n=new Se(Object(h.h)(c),m,c,j,b);return r.createElement("div",{className:Te.a.container},r.createElement(u.a,{key:m.cardId,cardDetails:m,isActionableMessageV2Enabled:be(),snackBarTimeout:Object(h.i)(),v2SnackBarTimeout:Object(h.k)(),showMessageBodyCallback:I,contentHandlerUndoMode:e.undoDarkMode,actionProviders:[ce,h.b],adjustCardElementBeforeRenderCallback:M,fixImagesBeforeRenderCallback:D,onCardRendered:N,onCardDetailsUpdated:j,getClientAuthToken:l.a,actionableMessageContentHandler:d,actionableMessageCardStrings:{format:A.c,placeholder:{textInput:Object(A.b)(de.g),numberInput:Object(A.b)(de.f),dateInput:Object(A.b)(de.e),timeInput:Object(A.b)(de.h),choiceSetInput:Object(A.b)(de.d)},error:{generic:Object(A.b)(le.a)},warning:{invalidInput:Object(A.b)(de.i),missingRequiredInput:Object(A.b)(de.j),inputNumberNotNumeric:Object(A.b)(ue.c),inputNumberLessThanMin:Object(A.b)(ue.a),inputNumberMoreThanMax:Object(A.b)(ue.b),requiredField:Object(A.b)(he.a)},information:{actionInProgress:Object(A.b)(de.a),authenticationFlowAcknowledgeMessage:Object(A.b)(de.c),authenticationFlowAcknowledgeButtonText:Object(A.b)(de.b)},datePicker:Object.assign(Object.assign({},Object(pe.a)()),{isRequiredErrorMessage:Object(A.b)(he.a)})},telemetryHandler:b,httpChannelAdapter:n,isTrustedDomain:h.m,actionProviderV2:Ne,targetWindow:t}))}return o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper renderCardFromDetails - Did not find expected number of cards on the message"),I(!0),r.createElement("div",null)},I=t=>{o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper setShowMessageBody: "+t),m(e.viewState,t),t&&g(e.viewState,!1),P(t)},j=t=>{o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper updateCardOnItem"),Object(a.f)(e.item,t)},M=(t,n)=>{o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper fixInlineImages"),Object(h.f)(t,e.item.MailboxInfo,n),w(t,e.item,e.item.MailboxInfo)},D=(t,n)=>{Object(h.f)(t,e.item.MailboxInfo,n)},N=t=>{o.h.info("[ActionableMessageDebug] ActionableMessageMailWrapper  onCardRendered. Updating loading state"),C!==t&&(x(t),P(!1)),e.viewState.showCardLoading&&g(e.viewState,!1)},P=t=>{o.h.info("[ActionableMessageDebug] Finish Loading - forceShowMessageBody:"+t),b.current&&(clearTimeout(b.current),b.current=null);const{viewState:n}=e;g(n,!1),t&&m(n,!0)},T=e.item.AdaptiveCardData.cardDetails;return o.h.info(`[ActionableMessageDebug] ActionableMessageMailWrapper render. itemId: ${e.item.ItemId.Id}. CardDetails: ${(null==T?void 0:T[0])?T[0].cardId:"undefined"}`),T&&T.length>0?0!==(e=>{let t=v(e);return t=t.filter(e=>(function(e){const{card:t}=e;if(t&&t.hasOwnProperty(me)){const{messageCardContext:n}=t;return!!n&&"Transaction"===e.card.messageCardContext.oamAppName}return!1})(e)),t})(T).length?(P(!0),null):(e=>(f.current&&P(!0),!f.current&&r.createElement("div",{className:Te.a.cardArea},y(e))))(T):null}));n.d(t,"getCardDetails",(function(){return i})),n.d(t,"ActionableMessageMailWrapper",(function(){return Re})),n.d(t,"doesActionableMessageEnabled",(function(){return h.d}))},202:function(e){e.exports=JSON.parse('{"l":"Swa","i":"Twa","n":"Uwa","k":"Vwa","m":"Wwa","j":"Xwa","d":"Ywa","b":"Zwa","f":"_wa","g":"$wa","e":"axa","a":"bxa","c":"cxa","o":"dxa","s":"exa","r":"fxa","p":"gxa","q":"hxa","h":"ixa"}')},3004:function(e,t,n){"use strict";function a(e){var t=e&&(e.commonAncestorContainer||e),n=t&&(t.ownerDocument||("[object HTMLDocument]"==Object.prototype.toString.apply(t)?t:null));return n&&(n.defaultView||window)}Object.defineProperty(t,"__esModule",{value:!0}),t.getTargetWindow=a,t.default=function(e,t){var n=a(e),i=n&&n[t],r=window,s=r&&r[t];return s&&e instanceof s||i&&e instanceof i}},340:function(e,t,n){"use strict";var a=n(774),i=n(775),r=n(776),s=n(777),o=n(778),c=n(779),d=n(780),l=n(636),u=n(637),h=n(638),p=n(639),b=n(640),m=n(641),g=n(642),f=n(643),C=n(644),A=n(645),x=n(646),O=n(647),v=n(202),y=n(964),S=n(784),w=n(785),I=n(786),j=n(787),M=n(788),D=n(789),k=n(790),N=n(791),P=n(792),T=n(793),R=n(794),E=n(795),J=n(6),L=n(13),z=()=>q.get();const q=Object(L.computed)(()=>({months:[Object(J.b)(O.a),Object(J.b)(x.a),Object(J.b)(A.a),Object(J.b)(C.a),Object(J.b)(f.a),Object(J.b)(g.a),Object(J.b)(m.a),Object(J.b)(b.a),Object(J.b)(p.a),Object(J.b)(h.a),Object(J.b)(u.a),Object(J.b)(l.a)],shortMonths:[Object(J.b)(E.a),Object(J.b)(R.a),Object(J.b)(T.a),Object(J.b)(P.a),Object(J.b)(N.a),Object(J.b)(k.a),Object(J.b)(D.a),Object(J.b)(M.a),Object(J.b)(j.a),Object(J.b)(I.a),Object(J.b)(w.a),Object(J.b)(S.a)],days:[Object(J.b)(d.a),Object(J.b)(c.a),Object(J.b)(o.a),Object(J.b)(s.a),Object(J.b)(r.a),Object(J.b)(i.a),Object(J.b)(a.a)],shortDays:[Object(J.b)(v.d),Object(J.b)(v.b),Object(J.b)(v.f),Object(J.b)(v.g),Object(J.b)(v.e),Object(J.b)(v.a),Object(J.b)(v.c)],goToToday:Object(J.b)(y.a),prevMonthAriaLabel:Object(J.b)(v.l),nextMonthAriaLabel:Object(J.b)(v.i),prevYearAriaLabel:Object(J.b)(v.n),nextYearAriaLabel:Object(J.b)(v.k),prevYearRangeAriaLabel:Object(J.b)(v.m),nextYearRangeAriaLabel:Object(J.b)(v.j),monthPickerHeaderAriaLabel:Object(J.b)(v.o),yearPickerHeaderAriaLabel:Object(J.b)(v.s),weekNumberFormatString:Object(J.b)(v.r),selectedDateFormatString:Object(J.b)(v.p),todayDateFormatString:Object(J.b)(v.q),dayMarkedAriaLabel:Object(J.b)(v.h)}));var F=n(52),_=(e,t)=>e?e.tz:t||Object(F.o)(),H=n(5),W=(e,t)=>Object(H.Ub)(e,t.getFullYear(),t.getMonth(),t.getDate());n.d(t,"a",(function(){return z})),n.d(t,"c",(function(){return _})),n.d(t,"b",(function(){return W}))},3981:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2873),i=n(2802),r=n(2993);function s(e,t,n,s){const o=Object(i.e)(n,e,null,t),c=Object.assign(Object.assign({},s),{protectionStore:r.b,includeFluidOnPopout:Object(a.e)(7)});Object(i.c)("mail",o,c,{resizable:!0})}},6311:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return r}));const a=Object.freeze({Start:"A0",AddingGciPayload:"A1",AddedGciPayload:"A2",AddGciPayloadToStore:"A3",GciUpdateFetchStatus:"A4",PrefetchStart:"A5",CardAblInStore:"A6",AddingPrefetchCardToStore:"A7",CannotAddCardData:"A8",PrefetchSuccess:"A9",PrefetchFailed:"A10",PrefetchUpdFetchStatusNotLoaded:"A11",PrefetchFinish:"A12",Finish:"A13"}),i=Object.freeze({ItemArrayLengthMismatch:"A0",NoCardAfterFetch:"A1",MailStoreNotFound:"A2",CardNotPresentInStore:"A3"}),r=Object.freeze({AddCardDuplicate:"AMA_W0",JsonParseIssue:"AMA_W1",NoCardPresent:"AMA_W2",FetchCatchBlock:"AMA_W3",FetchNoExtProp:"AMA_W4"})},636:function(e){e.exports=JSON.parse('{"a":"uxa"}')},637:function(e){e.exports=JSON.parse('{"a":"txa"}')},638:function(e){e.exports=JSON.parse('{"a":"sxa"}')},639:function(e){e.exports=JSON.parse('{"a":"rxa"}')},640:function(e){e.exports=JSON.parse('{"a":"qxa"}')},641:function(e){e.exports=JSON.parse('{"a":"pxa"}')},642:function(e){e.exports=JSON.parse('{"a":"oxa"}')},643:function(e){e.exports=JSON.parse('{"a":"nxa"}')},644:function(e){e.exports=JSON.parse('{"a":"mxa"}')},645:function(e){e.exports=JSON.parse('{"a":"lxa"}')},646:function(e){e.exports=JSON.parse('{"a":"kxa"}')},647:function(e){e.exports=JSON.parse('{"a":"jxa"}')},6771:function(e,t,n){"use strict";var a=n(1218),i=n(2359),r=n(1224),s=a.rotr64_hi,o=a.rotr64_lo,c=a.shr64_hi,d=a.shr64_lo,l=a.sum64,u=a.sum64_hi,h=a.sum64_lo,p=a.sum64_4_hi,b=a.sum64_4_lo,m=a.sum64_5_hi,g=a.sum64_5_lo,f=i.BlockHash,C=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function A(){if(!(this instanceof A))return new A;f.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=C,this.W=new Array(160)}function x(e,t,n,a,i){var r=e&n^~e&i;return r<0&&(r+=4294967296),r}function O(e,t,n,a,i,r){var s=t&a^~t&r;return s<0&&(s+=4294967296),s}function v(e,t,n,a,i){var r=e&n^e&i^n&i;return r<0&&(r+=4294967296),r}function y(e,t,n,a,i,r){var s=t&a^t&r^a&r;return s<0&&(s+=4294967296),s}function S(e,t){var n=s(e,t,28)^s(t,e,2)^s(t,e,7);return n<0&&(n+=4294967296),n}function w(e,t){var n=o(e,t,28)^o(t,e,2)^o(t,e,7);return n<0&&(n+=4294967296),n}function I(e,t){var n=s(e,t,14)^s(e,t,18)^s(t,e,9);return n<0&&(n+=4294967296),n}function j(e,t){var n=o(e,t,14)^o(e,t,18)^o(t,e,9);return n<0&&(n+=4294967296),n}function M(e,t){var n=s(e,t,1)^s(e,t,8)^c(e,t,7);return n<0&&(n+=4294967296),n}function D(e,t){var n=o(e,t,1)^o(e,t,8)^d(e,t,7);return n<0&&(n+=4294967296),n}function k(e,t){var n=s(e,t,19)^s(t,e,29)^c(e,t,6);return n<0&&(n+=4294967296),n}function N(e,t){var n=o(e,t,19)^o(t,e,29)^d(e,t,6);return n<0&&(n+=4294967296),n}a.inherits(A,f),e.exports=A,A.blockSize=1024,A.outSize=512,A.hmacStrength=192,A.padLength=128,A.prototype._prepareBlock=function(e,t){for(var n=this.W,a=0;a<32;a++)n[a]=e[t+a];for(;a<n.length;a+=2){var i=k(n[a-4],n[a-3]),r=N(n[a-4],n[a-3]),s=n[a-14],o=n[a-13],c=M(n[a-30],n[a-29]),d=D(n[a-30],n[a-29]),l=n[a-32],u=n[a-31];n[a]=p(i,r,s,o,c,d,l,u),n[a+1]=b(i,r,s,o,c,d,l,u)}},A.prototype._update=function(e,t){this._prepareBlock(e,t);var n=this.W,a=this.h[0],i=this.h[1],s=this.h[2],o=this.h[3],c=this.h[4],d=this.h[5],p=this.h[6],b=this.h[7],f=this.h[8],C=this.h[9],A=this.h[10],M=this.h[11],D=this.h[12],k=this.h[13],N=this.h[14],P=this.h[15];r(this.k.length===n.length);for(var T=0;T<n.length;T+=2){var R=N,E=P,J=I(f,C),L=j(f,C),z=x(f,C,A,M,D),q=O(f,C,A,M,D,k),F=this.k[T],_=this.k[T+1],H=n[T],W=n[T+1],U=m(R,E,J,L,z,q,F,_,H,W),G=g(R,E,J,L,z,q,F,_,H,W);R=S(a,i),E=w(a,i),J=v(a,i,s,o,c),L=y(a,i,s,o,c,d);var B=u(R,E,J,L),$=h(R,E,J,L);N=D,P=k,D=A,k=M,A=f,M=C,f=u(p,b,U,G),C=h(b,b,U,G),p=c,b=d,c=s,d=o,s=a,o=i,a=u(U,G,B,$),i=h(U,G,B,$)}l(this.h,0,a,i),l(this.h,2,s,o),l(this.h,4,c,d),l(this.h,6,p,b),l(this.h,8,f,C),l(this.h,10,A,M),l(this.h,12,D,k),l(this.h,14,N,P)},A.prototype._digest=function(e){return"hex"===e?a.toHex32(this.h,"big"):a.split32(this.h,"big")}},7327:function(e,t,n){"use strict";var a=n(4511),i=n(2),r=n(6311);const s=Object(i.mutatorAction)("addCardDetailsOnItem",(function(e,t,n){if(e.AdaptiveCardData){const{cardDetails:a}=e.AdaptiveCardData;if(a&&a.length>0)return void(null==n||n.push([r.c.AddCardDuplicate,!1]));e.AdaptiveCardData.cardDetails=t}else null==n||n.push([r.a.CardNotPresentInStore,!0]),e.AdaptiveCardData={cardDetails:t,cardFetchStatus:t?a.c.Loaded:a.c.NotLoaded}}));t.a=s},7328:function(e,t,n){"use strict";var a=n(2);const i=Object(a.mutatorAction)("updateCardFetchStatusForItems",(function(e,t){for(const n of e)n.AdaptiveCardData.cardFetchStatus=t}));t.a=i},774:function(e){e.exports=JSON.parse('{"a":"awa"}')},775:function(e){e.exports=JSON.parse('{"a":"gwa"}')},776:function(e){e.exports=JSON.parse('{"a":"fwa"}')},777:function(e){e.exports=JSON.parse('{"a":"ewa"}')},778:function(e){e.exports=JSON.parse('{"a":"dwa"}')},779:function(e){e.exports=JSON.parse('{"a":"cwa"}')},780:function(e){e.exports=JSON.parse('{"a":"bwa"}')},7800:function(e,t,n){"use strict";var a=n(9606),i=n(2793),r=n(3656),s=n(1087),o=n(167),c=n(5924),d=n(6311);const l=()=>Object(o.a)(c.e,c.d,"String");t.a=async(e,t)=>{try{const n=Object(s.a)({BaseShape:"IdOnly",AdditionalProperties:[l()]}),o=await Object(i.a)(e,n);if(o&&!(o instanceof Error)){let e=[];for(const n of o){const i=Object(r.a)(n,null,c.d);i?e.push(Object(a.a)(i,null!=t?t:[])):e.push(null)}return e}}catch(e){null==t||t.push([d.c.FetchCatchBlock,!1])}return null==t||t.push([d.c.FetchNoExtProp,!1]),null}},784:function(e){e.exports=JSON.parse('{"a":"Qwa"}')},785:function(e){e.exports=JSON.parse('{"a":"Pwa"}')},786:function(e){e.exports=JSON.parse('{"a":"Owa"}')},787:function(e){e.exports=JSON.parse('{"a":"Nwa"}')},788:function(e){e.exports=JSON.parse('{"a":"Mwa"}')},789:function(e){e.exports=JSON.parse('{"a":"Lwa"}')},790:function(e){e.exports=JSON.parse('{"a":"Kwa"}')},791:function(e){e.exports=JSON.parse('{"a":"Jwa"}')},792:function(e){e.exports=JSON.parse('{"a":"Iwa"}')},793:function(e){e.exports=JSON.parse('{"a":"Hwa"}')},794:function(e){e.exports=JSON.parse('{"a":"Gwa"}')},795:function(e){e.exports=JSON.parse('{"a":"Fwa"}')},8698:function(e,t,n){var a=t;a.utils=n(1218),a.common=n(2359),a.sha=n(8699),a.ripemd=n(8703),a.hmac=n(8704),a.sha1=a.sha.sha1,a.sha256=a.sha.sha256,a.sha224=a.sha.sha224,a.sha384=a.sha.sha384,a.sha512=a.sha.sha512,a.ripemd160=a.ripemd.ripemd160},8699:function(e,t,n){"use strict";t.sha1=n(8700),t.sha224=n(8701),t.sha256=n(1531),t.sha384=n(8702),t.sha512=n(6771)},8700:function(e,t,n){"use strict";var a=n(1218),i=n(2359),r=n(2365),s=a.rotl32,o=a.sum32,c=a.sum32_5,d=r.ft_1,l=i.BlockHash,u=[1518500249,1859775393,2400959708,3395469782];function h(){if(!(this instanceof h))return new h;l.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}a.inherits(h,l),e.exports=h,h.blockSize=512,h.outSize=160,h.hmacStrength=80,h.padLength=64,h.prototype._update=function(e,t){for(var n=this.W,a=0;a<16;a++)n[a]=e[t+a];for(;a<n.length;a++)n[a]=s(n[a-3]^n[a-8]^n[a-14]^n[a-16],1);var i=this.h[0],r=this.h[1],l=this.h[2],h=this.h[3],p=this.h[4];for(a=0;a<n.length;a++){var b=~~(a/20),m=c(s(i,5),d(b,r,l,h),p,n[a],u[b]);p=h,h=l,l=s(r,30),r=i,i=m}this.h[0]=o(this.h[0],i),this.h[1]=o(this.h[1],r),this.h[2]=o(this.h[2],l),this.h[3]=o(this.h[3],h),this.h[4]=o(this.h[4],p)},h.prototype._digest=function(e){return"hex"===e?a.toHex32(this.h,"big"):a.split32(this.h,"big")}},8701:function(e,t,n){"use strict";var a=n(1218),i=n(1531);function r(){if(!(this instanceof r))return new r;i.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}a.inherits(r,i),e.exports=r,r.blockSize=512,r.outSize=224,r.hmacStrength=192,r.padLength=64,r.prototype._digest=function(e){return"hex"===e?a.toHex32(this.h.slice(0,7),"big"):a.split32(this.h.slice(0,7),"big")}},8702:function(e,t,n){"use strict";var a=n(1218),i=n(6771);function r(){if(!(this instanceof r))return new r;i.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}a.inherits(r,i),e.exports=r,r.blockSize=1024,r.outSize=384,r.hmacStrength=192,r.padLength=128,r.prototype._digest=function(e){return"hex"===e?a.toHex32(this.h.slice(0,12),"big"):a.split32(this.h.slice(0,12),"big")}},8703:function(e,t,n){"use strict";var a=n(1218),i=n(2359),r=a.rotl32,s=a.sum32,o=a.sum32_3,c=a.sum32_4,d=i.BlockHash;function l(){if(!(this instanceof l))return new l;d.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function u(e,t,n,a){return e<=15?t^n^a:e<=31?t&n|~t&a:e<=47?(t|~n)^a:e<=63?t&a|n&~a:t^(n|~a)}function h(e){return e<=15?0:e<=31?1518500249:e<=47?1859775393:e<=63?2400959708:2840853838}function p(e){return e<=15?1352829926:e<=31?1548603684:e<=47?1836072691:e<=63?2053994217:0}a.inherits(l,d),t.ripemd160=l,l.blockSize=512,l.outSize=160,l.hmacStrength=192,l.padLength=64,l.prototype._update=function(e,t){for(var n=this.h[0],a=this.h[1],i=this.h[2],d=this.h[3],l=this.h[4],C=n,A=a,x=i,O=d,v=l,y=0;y<80;y++){var S=s(r(c(n,u(y,a,i,d),e[b[y]+t],h(y)),g[y]),l);n=l,l=d,d=r(i,10),i=a,a=S,S=s(r(c(C,u(79-y,A,x,O),e[m[y]+t],p(y)),f[y]),v),C=v,v=O,O=r(x,10),x=A,A=S}S=o(this.h[1],i,O),this.h[1]=o(this.h[2],d,v),this.h[2]=o(this.h[3],l,C),this.h[3]=o(this.h[4],n,A),this.h[4]=o(this.h[0],a,x),this.h[0]=S},l.prototype._digest=function(e){return"hex"===e?a.toHex32(this.h,"little"):a.split32(this.h,"little")};var b=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],m=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],g=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],f=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},8704:function(e,t,n){"use strict";var a=n(1218),i=n(1224);function r(e,t,n){if(!(this instanceof r))return new r(e,t,n);this.Hash=e,this.blockSize=e.blockSize/8,this.outSize=e.outSize/8,this.inner=null,this.outer=null,this._init(a.toArray(t,n))}e.exports=r,r.prototype._init=function(e){e.length>this.blockSize&&(e=(new this.Hash).update(e).digest()),i(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(t=0;t<e.length;t++)e[t]^=54;for(this.inner=(new this.Hash).update(e),t=0;t<e.length;t++)e[t]^=106;this.outer=(new this.Hash).update(e)},r.prototype.update=function(e,t){return this.inner.update(e,t),this},r.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)}},9606:function(e,t,n){"use strict";var a=n(5924),i=n(159),r=n(6311),s=n(8698),o=n.n(s);const c=(e,t,n,a,s,c,d)=>{let l,u;try{if("string"==typeof n){l=JSON.parse(n);const e=o.a.sha256().update(n).digest();u=btoa(String.fromCharCode.apply(null,new Uint8Array(e)))}else l=n}catch(e){return s.push([r.c.JsonParseIssue,!1]),null}return Object.assign(Object.assign({},e),{connectorSenderGuid:t,isAdaptiveCard:void 0===c?"AdaptiveCard"===l.type:c,cardSignature:a,card:l,cardHash:u,cardId:d||Object(i.a)()})};t.a=(e,t)=>{let n;try{n=JSON.parse(e)}catch(e){return t.push([r.c.JsonParseIssue,!1]),[]}const i={smtpAddressesSerialized:n.SmtpAddressesSerialized,providerAccountUniqueId:n.ProviderAccountUniqueId,messageCardExtensionContext:n.MessageCardExtensionContext},s=[];if(n.AdaptiveCardV2Serialized){const e=c(i,n.ConnectorSenderGuidV2?n.ConnectorSenderGuidV2:a.a,n.AdaptiveCardSerializedV2,n.AdaptiveCardSignatureV2,t,!0);e&&s.push(e)}if(n.AdaptiveCardSerialized){const e=c(i,n.ConnectorSenderGuid?n.ConnectorSenderGuid:a.a,n.AdaptiveCardSerialized,n.AdaptiveCardSignature,t,!0);e&&s.push(e)}else{if(!n.MessageCardSerialized)return t.push([r.c.NoCardPresent,!1]),[];{const e=c(i,n.ConnectorSenderGuid?n.ConnectorSenderGuid:a.a,n.MessageCardSerialized,n.MessageCardSignature,t,!1);e&&s.push(e)}}return s.concat(((e,t,n)=>{const i=[];return Object.keys(e).map(s=>{if(e.hasOwnProperty(s)&&0===s.indexOf(a.c)){const o=e[s];try{const r=JSON.parse(o),s=c(t,e.ConnectorSenderGuid?e.ConnectorSenderGuid:a.a,r.card,null,n);s.isContextual=!0,s.key=r.id,s.highlightTerm=r.text,i.push(s)}catch(e){n.push([r.c.JsonParseIssue,!1])}}}),i})(n,i,t))}},964:function(e){e.exports=JSON.parse('{"a":"Rwa"}')},9909:function(e,t,n){"use strict";var a=n(20),i=n(7327),r=n(2);var s=Object(r.mutatorAction)("updateCardDetailsOnItem",(function(e,t){e.AdaptiveCardData.cardDetails=t})),o=n(7328),c=n(7800),d=n(7790),l=n(3656),u=n(5924);var h=e=>{return!!Object(l.a)(e,null,u.d)};n.d(t,"e",(function(){return b})),n.d(t,"a",(function(){return i.a})),n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return o.a})),n.d(t,"d",(function(){return c.a})),n.d(t,"b",(function(){return d.a})),n.d(t,"c",(function(){return h}));const p=new a.c(()=>Promise.all([n.e(124),n.e(146),n.e(2171)]).then(n.bind(null,20004))),b=new a.b(p,e=>e.prefetchActionableMessageForItems)}}]);
//# sourceMappingURL=owa.612.js.map
self.scriptsLoaded['owa.612.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.612.js'] = (new Date()).getTime();