self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.801.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[801,2148],{1431:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"DistinguishedFolderId:#Exchange"},e)}n.d(t,"a",(function(){return r}))},180:function(e,t,n){"use strict";var r=n(22);let o;function i(){return null==o&&(o="undefined"!=typeof window&&null!=window.performance&&null!=window.performance.timing&&null!=window.performance.navigation&&null!=window.performance.getEntriesByName),o}const c=500,u=[],a=[],s=[],d=[];let f,l=!0;function b(e,t){Object(r.g)((e,t,n)=>{l&&(t==r.b.Error&&a.push({message:e,error:n}),u.push({message:e,level:t}))}),e(v),t(v),i()&&(window.performance.setResourceTimingBufferSize?window.performance.setResourceTimingBufferSize(c):window.performance.webkitSetResourceTimingBufferSize&&window.performance.webkitSetResourceTimingBufferSize(c))}function p(e,t,n){f?f(e,t,n):d.push({name:e,customData:t})}function h(e){return f=e,l=!1,{traces:u,errors:a,network:s,usage:d}}function v(){l&&s.push(arguments)}n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return h})),n.d(t,"d",(function(){return p})),n.d(t,"c",(function(){return i}))},181:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,o=!1;function i(t){r--,delete e[t]}this.put=function(t,n,o,c){if(void 0!==o&&("number"!=typeof o||isNaN(o)||o<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==c&&"function"!=typeof c)throw new Error("Cache timeout callback must be a function");var u=e[t];u?clearTimeout(u.timeout):r++;var a={value:n,expire:o+Date.now()};return isNaN(a.expire)||(a.timeout=setTimeout(function(){i(t),c&&c(t,n)}.bind(this),o)),e[t]=a,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&i(t),n},this.clear=function(){for(var i in e)clearTimeout(e[i].timeout);r=0,e=Object.create(null),o&&(t=0,n=0)},this.get=function(i){var c=e[i];if(void 0!==c){if(isNaN(c.expire)||c.expire>=Date.now())return o&&t++,c.value;o&&n++,r--,delete e[i]}else o&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){o=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),o=Date.now(),i=n&&n.skipDuplicates;for(var c in r)if(r.hasOwnProperty(c)){if(i)if(e[c])continue;var u=r[c],a=u.expire-o;if(a<=0){this.del(c);continue}a=a>0?a:void 0,this.put(c,u.value,a)}return this.size()}}e.exports=new r,e.exports.Cache=r},244:function(e,t,n){"use strict";t.decode=t.parse=n(492),t.encode=t.stringify=n(493)},2741:function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"k",(function(){return i})),n.d(t,"a",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"b",(function(){return a})),n.d(t,"i",(function(){return s})),n.d(t,"m",(function(){return d})),n.d(t,"l",(function(){return f})),n.d(t,"j",(function(){return l})),n.d(t,"c",(function(){return b})),n.d(t,"e",(function(){return p})),n.d(t,"g",(function(){return h}));const r=["journal","outbox","syncissues"],o="archivemsgfolderroot",i="msgfolderroot",c="archivedeleteditems",u="deleteditems",a="archiverecoverableitemsdeletions",s="recoverableitemsdeletions",d="msgfolderroot",f="sharedFolderTree",l="primaryFolderTree",b="archiveFolderTree",p="favorites",h="groups"},2751:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(58);function o(e){if(!e)throw new Error("Input parameter to folderIdToName must not be null.");return r.a.defaultFolderIdToNameMap.get(e)||"none"}},2770:function(e,t,n){"use strict";n.d(t,"b",(function(){return c}));var r=n(2),o=n(13);const i=Object(r.createStore)("folderStore",{folderTable:new o.ObservableMap,mailboxFolderTreeData:new o.ObservableMap}),c=i();t.a=i},2776:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2890);function o(e,t){const n=Object(r.a)(t),o=n&&n.get(e);return null==o?void 0:o.rootFolder}},2875:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2770);function o(){return Object(r.a)().folderTable}},2890:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return c}));var r=n(2770),o=n(52);function i(e){return c(e).folderTreeTable}function c(e){return e||(e=Object(o.b)()),Object(r.a)().mailboxFolderTreeData.get(e)}},2898:function(e,t,n){"use strict";var r=n(52),o=n(25);function i(e){var t;const n=Object(r.g)().SegmentationSettings,i=null===(t=Object(r.g)().SessionSettings)||void 0===t?void 0:t.IsShadowMailbox;return"junkemail"===e?!!(null==n?void 0:n.JunkEMail):"notes"!==e||!!(null==n?void 0:n.StickyNotes)&&Object(o.k)("cal-stickyNotesFolder")&&!i}var c=n(220);function u(){const e=Object(c.a)()?["inbox","junkemail","drafts","sentitems","scheduled","deleteditems","archive"]:["inbox","drafts","sentitems","scheduled","deleteditems","junkemail","archive"];return Object(o.k)("notes-folder-view")&&e.push("notes"),e}n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return u}))},2912:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2776),o=n(2741);function i(e){return Object(r.a)(o.k,e)}},2916:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2776),o=n(2741);function i(e){return Object(r.a)(o.d,e)}},2917:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2776);function o(e){return Object(r.a)(e)}},2940:function(e,t,n){"use strict";function r(e){return Object.assign({},e)}function o(e){return Object.assign({},e)}function i(e){return Object.assign({},e)}function c(e){return Object.assign({},e)}function u(e){return Object.assign({},e)}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return u}))},2950:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"UnifiedGroupIdentity:#Exchange"},e)}n.d(t,"a",(function(){return r}))},2971:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return b}));var r=n(1084),o=n(2751),i=n(2770),c=n(2912),u=n(2875),a=n(2916),s=n(2917),d=n(2898);function f(e,t){const n=Object(u.a)();if(t){return[...n.values()].filter(n=>n.DistinguishedFolderId===e&&n.mailboxInfo.mailboxSmtpAddress===t)[0]}{const t=Object(r.a)(e);return t?n.get(t):void 0}}function l(e,t){if("SharedMailbox"===e&&!t)throw new Error("To get all the shared folders you must pass principalSMTPAddress");let n,r=[];switch(e){case"ArchiveMailbox":n=Object(a.a)(t);break;case"SharedMailbox":n=Object(s.a)(t);break;default:n=Object(c.a)(t)}const u=Object(d.a)();if("UserMailbox"==e&&n.DistinguishedFolderId==Object(c.a)(t).DistinguishedFolderId&&n.FolderId){const e=u.map(e=>f(e,t)).filter(e=>(null==e?void 0:e.parentFolderId)===n.FolderId.Id);r=t?e.filter(e=>e.mailboxInfo.mailboxSmtpAddress===t).map(e=>e.FolderId.Id):e.map(e=>e.FolderId.Id)}const l=function(e,t){if(!(null==e?void 0:e.childFolderIds))return[];const n=e.childFolderIds.map(e=>i.b.folderTable.get(e));return(t?n.filter(e=>e.mailboxInfo.mailboxSmtpAddress===t):n).map(e=>e.FolderId.Id)}(n,t);for(let e=0;e<l.length;e++)-1==u.indexOf(Object(o.a)(l[e]))&&r.push(l[e]);return r}function b(e,t){const n=Object(u.a)().get(e);return(null==n?void 0:n.mailboxInfo.type)===t}},3019:function(e,t,n){"use strict";var r=n(1431),o=n(710);function i(e){return Object.assign({__type:"SingleLargeArchiveSearchScopeType:#Exchange"},e)}function c(e){return Object.assign({__type:"SearchFolderScopeType:#Exchange"},e)}var u=n(2950),a=n(2751);var s=n(1084),d=n(2940),f=n(2741),l=n(2971);n.d(t,"a",(function(){return j})),n.d(t,"b",(function(){return y})),n.d(t,"c",(function(){return S}));const b={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){const e=[];e.push(Object(d.b)({folderId:Object(s.a)(f.k),kind:"PrimaryMailbox"}));const t=Object(l.b)("UserMailbox");for(let n of t)e.push(Object(d.b)({folderId:n,kind:"PrimaryMailbox"}));return e},getSearchScopeType:function(e){const t=Object(a.a)(e.folderId);let n;return n="none"!=t?Object(r.a)({Id:t}):Object(o.a)({Id:e.folderId}),[(i={FolderScope:c({BaseFolderId:n}),IsDeepTraversal:!0},Object.assign({__type:"PrimaryMailboxSearchScopeType:#Exchange"},i))];var i}},p={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){const e=[];return e.push(Object(d.a)({folderId:Object(s.a)(f.d),kind:"ArchiveMailbox"})),e.push(Object(d.a)({folderId:Object(s.a)(f.a),kind:"ArchiveMailbox"})),e},getSearchScopeType:function(e){const t=Object(a.a)(e.folderId);let n;return n="none"!=t?Object(r.a)({Id:t}):Object(o.a)({Id:e.folderId}),"archivemsgfolderroot"==t?[(u={ArchiveTypes:16777215},Object.assign({__type:"LargeArchiveSearchScopeType:#Exchange"},u))]:[i({FolderScope:c({BaseFolderId:n})})];var u}},h={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},v={getKey:function(e){return e.kind+"-"+e.groupId.toLowerCase()},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return[(t={GroupIdentity:Object(u.a)({Type:0,Value:e.groupId})},Object.assign({__type:"SingleGroupSearchScopeType:#Exchange"},t))];var t}},m={getKey:function(e){return e.kind+"-"+e.calendarFolderId?e.calendarFolderId.toLowerCase():""},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},g={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},O=e=>{switch(e.kind){case"PrimaryMailbox":return b;case"ArchiveMailbox":return p;case"SharedFolders":return h;case"Group":return v;case"Calendar":return m;case"PublicFolder":return g;default:throw new Error("Unregistered search scope")}},j=e=>O(e).getKey(e),y=e=>O(e).getSearchScopeList(),S=e=>O(e).getSearchScopeType(e)},316:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return a}));var r=n(124),o=n(117),i=n(3);let c;function u(e){c=e}async function a(){var e,t;if(Object(i.P)())return o.f.importAndExecute(Object(r.a)());const n=c&&await c();if(n&&n.length>0){if("bearer"===(null===(e=null==n?void 0:n.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return n.split(" ")[1];if("msauth1.0"===(null===(t=null==n?void 0:n.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return n}}},3206:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3019);function o(e,t){return!(!e||!t)&&Object(r.a)(e)===Object(r.a)(t)}},3886:function(e,t,n){"use strict";n.r(t);var r=n(9495);let o={},i=[];function c(e,t,n,i){const c={Name:"clientdatasource",Attributes:[]},u={Results:[]};n.forEach(e=>{u.Results.push({ReferenceId:e.localContentId,EntityId:e.entityId,Type:e.contentType})}),c.Attributes.push({Key:t,Value:btoa(JSON.stringify(u))}),Object(r.a)(e,c,i),function(e){e.forEach(e=>{o[e.entityId]=e.localContentId})}(n)}function u(e,t,n){if(-1!=i.indexOf(e))return;i.push(e);const o={Name:"clientlayout",Attributes:[]};Object.keys(t).forEach(e=>{const n={Results:[]};t[e].forEach(e=>{const t=s(e.entityId);n.Results.push({ReferenceId:t,Position:e.position})}),o.Attributes.push({Key:e,Value:btoa(JSON.stringify(n))})}),Object(r.a)(e,o,n)}function a(){o={},i=[]}function s(e){return o[e]}var d=n(6103),f=n(155),l=n(3684),b=n(398),p=n(483),h=n(52);async function v(e,t,n,r){const o={cvid:e,scenario:t},i=Object(l.a)(o),c={};if(n&&(c["X-Client-Flights"]=n),2==r){let[e,t]=Object(b.getAccessTokenforResourceAsLazy)((Object(h.q)()?`${Object(p.n)()}/search`:Object(p.n)()).replace("outlook-sdf.office.com","outlook.office.com"),"OwaSearchService");e||(e=await t),c.authorization="Bearer "+e}return Object(f.b)(Object(p.v)(Object(d.a)("init",r),i),void 0,void 0,c,void 0,!1)}var m=n(2842),g=n(22);function O(e,t,n,r,o,i,c){const u={Cvid:t,EntityRequests:[{EntityType:n,Filter:void 0,From:void 0,PropertySet:void 0,Provenances:void 0,Query:{QueryString:e},RefiningQueries:void 0,Size:r,Sort:void 0}],Scenario:{Name:o},TextDecorations:void 0,TimeZone:void 0,LogicalId:c};return Object(f.e)(Object(p.v)(Object(m.A)("suggestions"),Object(l.a)()),u,void 0,!0,i,void 0,void 0,!1).then(e=>Promise.resolve(e)).catch(e=>(g.h.warn(e),Promise.reject(e)))}function j(){S("Delete")}function y(){return S("Export")}const S=e=>{const t=Object(l.a)();return Object(f.e)(Object(p.v)(Object(d.a)("searchHistory"),t),{Action:e,Scenario:{Name:"owa.react"}})};n.d(t,"logLocalContentDataSource",(function(){return c})),n.d(t,"logLocalContentLayout",(function(){return u})),n.d(t,"clearLocalContentInstrumentationCache",(function(){return a})),n.d(t,"getLocalContentId",(function(){return s})),n.d(t,"substrateSearchInitOperation",(function(){return v})),n.d(t,"substrateSearchPostSuggestionsService",(function(){return O})),n.d(t,"deleteSubstrateSearchHistoryService",(function(){return j})),n.d(t,"exportSubstrateSearchHistoryService",(function(){return y}))},462:function(e,t,n){"use strict";class r{constructor(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}add(e){this.taskList.unshift(e),this.scheduleTask()}clear(){this.taskList.splice(0,this.taskList.length)}canRunMoreTasks(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0}scheduleTask(){this.canRunMoreTasks()&&setTimeout(()=>{this.tryRunTask()},this.taskDelay)}onTaskComplete(){this.numberOfTasksRunning--,this.scheduleTask()}tryRunTask(){if(this.canRunMoreTasks()){let e=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(e).then(()=>{this.onTaskComplete()}).catch(()=>{this.onTaskComplete()}),this.scheduleTask()}}}n.d(t,"a",(function(){return r}))},492:function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,i){t=t||"&",n=n||"=";var c={};if("string"!=typeof e||0===e.length)return c;var u=/\+/g;e=e.split(t);var a=1e3;i&&"number"==typeof i.maxKeys&&(a=i.maxKeys);var s=e.length;a>0&&s>a&&(s=a);for(var d=0;d<s;++d){var f,l,b,p,h=e[d].replace(u,"%20"),v=h.indexOf(n);v>=0?(f=h.substr(0,v),l=h.substr(v+1)):(f=h,l=""),b=decodeURIComponent(f),p=decodeURIComponent(l),r(c,b)?o(c[b])?c[b].push(p):c[b]=[c[b],p]:c[b]=p}return c};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},493:function(e,t,n){"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,u){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?i(c(e),(function(c){var u=encodeURIComponent(r(c))+n;return o(e[c])?i(e[c],(function(e){return u+encodeURIComponent(r(e))})).join(t):u+encodeURIComponent(r(e[c]))})).join(t):u?encodeURIComponent(r(u))+n+encodeURIComponent(r(e)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function i(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var c=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},765:function(e,t,n){"use strict";function r(e){if(!e)return e;let t=e.replace(/\+/g,"_");return t=t.replace(/\//g,"-"),t}function o(e){if(!e)return e;let t=e.replace(/_/g,"+");return t=t.replace(/-/g,"/"),t}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}))},9495:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(6103),o=n(68),i=n(3),c=n(155),u=n(3684),a=n(483);let s={};function d(e,t,n){const d=t.Attributes.filter(e=>null!=e.Value);t.Attributes=d,t.Attributes.forEach(e=>{if(e.Value&&"string"!=typeof e.Value)throw new Error("All values in substrate search event attributes must be strings or null/undefines")}),void 0===s[n]&&(s[n]={},setTimeout(function(e){return()=>{const t=s[e],n=Object.keys(t).reduce((e,n)=>(e.push({Key:n,Value:t[n]}),e),[]),d={scenario:e},f=Object(u.a)(d);s[e]=void 0,Object(c.e)(Object(a.v)(Object(r.a)("events"),f),n,void 0,!0,{"Client-Session-Id":Object(i.M)()},void 0,void 0,!1).then(n=>{const r={},i=Object.keys(t).reduce((e,n)=>(t[n].forEach(t=>{e.push({TraceId:n,EventName:t.Name}),r[t.Name]?r[t.Name]=r[t.Name]+1:r[t.Name]=1}),e),[]),c={scenario:e,status:n.status,totalEvents:i.length,events:JSON.stringify(i)};Object.keys(r).forEach(e=>{c[e]=r[e]}),Object(o.p)("3SInstEvent",c)})}}(n),5e3)),s[n][e]=(s[n][e]||[]).concat(t)}}}]);
//# sourceMappingURL=owa.801.js.map
self.scriptsLoaded['owa.801.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.801.js'] = (new Date()).getTime();