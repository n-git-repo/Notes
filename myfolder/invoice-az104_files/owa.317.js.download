self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.317.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[317],{2871:function(t,n,e){"use strict";var r=e(3278),i=e(358);const o=Object(i.action)("addInfoBarMessage")((function(t,n,e){if(t){-1==t.infoBarIds.indexOf(n)?t.infoBarIds.push(n):t.infoBarIds=[...t.infoBarIds];const i=t.infoBarHostKey;e&&(r.b[i]||(r.b[i]={}),r.b[i][n]=e)}}));n.a=o},2905:function(t,n,e){"use strict";e.d(n,"n",(function(){return a})),e.d(n,"q",(function(){return u})),e.d(n,"a",(function(){return s})),e.d(n,"p",(function(){return d})),e.d(n,"f",(function(){return l})),e.d(n,"t",(function(){return f})),e.d(n,"g",(function(){return b})),e.d(n,"d",(function(){return m})),e.d(n,"e",(function(){return h})),e.d(n,"j",(function(){return g})),e.d(n,"i",(function(){return p})),e.d(n,"l",(function(){return w})),e.d(n,"k",(function(){return O})),e.d(n,"c",(function(){return A})),e.d(n,"o",(function(){return j})),e.d(n,"r",(function(){return v})),e.d(n,"b",(function(){return I})),e.d(n,"m",(function(){return S})),e.d(n,"h",(function(){return E})),e.d(n,"s",(function(){return T}));var r=e(20),i=e(3024);e.d(n,"u",(function(){return i.a}));var o=e(3025);e.d(n,"v",(function(){return o.a}));const c=new r.c(()=>Promise.all([e.e(0),e.e(21),e.e(24),e.e(25),e.e(29),e.e(35),e.e(50),e.e(57),e.e(60),e.e(116),e.e(153),e.e(256),e.e(748),e.e(539)]).then(e.bind(null,3881))),a=new r.a(c,t=>t.initializeAttachments),u=new r.a(c,t=>t.reinitializeAttachments),s=(new r.a(c,t=>t.setInlineAttachmentStatus),new r.a(c,t=>t.addAttachmentIntoWellBeforeUpload)),d=new r.b(c,t=>t.refreshSharingTipsAttachmentWell),l=new r.b(c,t=>t.createAttachmentsViaQueueManager),f=new r.b(c,t=>t.createAttachmentsFromRecentAttachments),b=new r.a(c,t=>t.deleteAttachmentViaQueueManager),m=new r.b(c,t=>t.createAttachmentFullViewStateAndStoreBackingModel),h=new r.b(c,t=>t.createAttachmentFullViewState),g=new r.b(c,t=>t.getAttachmentWellInitialValue),p=new r.b(c,t=>t.getAttachmentWellForCompose),w=new r.b(c,t=>t.getConversationAttachmentWellInitialValue),O=(new r.b(c,t=>t.getMaxClassicAttachmentsSize),new r.b(c,t=>t.getAvailableLocalAttachmentSize)),A=new r.b(c,t=>t.createAttachmentFileFromExistingMailboxAttachment),j=new r.a(c,t=>t.mergeToConversationAttachmentWell),v=new r.a(c,t=>t.sortConversationAttachmentWell),I=new r.a(c,t=>t.convertImageViewAttachmentToInlineAttachment),S=new r.b(c,t=>t.getLastCloudyAttachmentsSharingIssueForBlockOnSend),E=new r.b(c,t=>t.getAllValidAttachments),T=new r.b(c,t=>t.uploadLocalFile)},2993:function(t,n,e){"use strict";e.d(n,"a",(function(){return c})),e.d(n,"b",(function(){return a}));var r=e(13),i=e(2);const o={clpLabels:[],learnMoreUrl:"",hasMandatoryLabel:!1,rmsTemplates:new r.ObservableMap,messageClassifications:new r.ObservableMap},c=Object(i.createStore)("protection",o),a=c()},3024:function(t,n,e){"use strict";var r=e(2);n.a=Object(r.action)("ON_ATTACHMENT_CREATED",(t,n,e,r=!0)=>({parentItemId:t,attachmentId:n,attachment:e,shouldTriggerAddInAttachmentsChangedCallback:r}))},3025:function(t,n,e){"use strict";var r=e(2);n.a=Object(r.action)("ON_ATTACHMENT_DELETED",(t,n,e,r=!0)=>({parentItemId:t,attachmentId:n,attachment:e,shouldTriggerAddInAttachmentsChangedCallback:r}))},3139:function(t,n,e){"use strict";e.d(n,"a",(function(){return c})),e.d(n,"c",(function(){return u})),e.d(n,"b",(function(){return s}));var r=e(68);let i={};const o="DebugEditor108089";function c(t,n,e){var c;const u=null===(c=i[t.editorId])||void 0===c?void 0:c.htmlEditor;if(n&&u){const e=u.getDocument().defaultView,i=n.getDocument().defaultView,c=e==i,s=window!=e,d=window!=i,l=a(()=>i.opener?"true":"false"),f=a(()=>i.parent==i?"false":"true"),b=a(()=>i.location.href.replace(/\/[^\/]*@[^\/]+\//,"/<PII>/"));Object(r.p)(o,{eventName:"DuplicatedEditor",inSameWindow:c,OriginalInProjection:s,NewInProjection:d,NewWindowHasOpener:l,NewWindowIsIFrame:f,NewWindowUrl:b,editorId:t.editorId})}i[t.editorId]={htmlEditor:n,plainTextEditor:e}}function a(t){try{return t()}catch(t){return"error"}}function u(t,n,e){const c=i[t.editorId];let a=!1;c&&(c.htmlEditor==n&&(c.htmlEditor=null,a=!0),c.plainTextEditor==e&&(c.plainTextEditor=null,a=!0),c.htmlEditor||c.plainTextEditor||delete i[t.editorId]),!a&&n&&Object(r.p)(o,{eventName:"NoEditorToRemove",hasOperator:!!c,hasOriginalEditor:!!(null==c?void 0:c.htmlEditor),removingEditorId:t.editorId})}function s(t,n,e,c,a){var u;if(t){const s=t.bodyType,d=void 0===s||"HTML"===s,l="Text"===s,{htmlEditor:f,plainTextEditor:b}=a||i[t.editorId]||{};if(d&&n&&(f&&!f.isDisposed()||c)){n(f);const e=null===(u=i[t.editorId])||void 0===u?void 0:u.htmlEditor;f&&e&&f!=e&&Object(r.p)(o,{eventName:"OperateWrongEditor",editorId:t.editorId})}else l&&e&&(b||c)&&e(b)}}},3278:function(t,n,e){"use strict";e.d(n,"b",(function(){return r})),e.d(n,"a",(function(){return i}));const r={};function i(t,n){var e;const i=t.infoBarHostKey;return null===(e=r[i])||void 0===e?void 0:e[n]}},3310:function(t,n,e){"use strict";e.d(n,"a",(function(){return c})),e.d(n,"b",(function(){return a}));var r=e(13),i=e(2);const o={legacySignature:{html:null,txt:null},roamingSignatureMap:new r.ObservableMap,defaultSignatureName:"",defaultReplySignatureName:""},c=Object(i.createStore)("signature",o),a=c()},332:function(t,n,e){"use strict";var r=e(521),i=e(713),o=e(306);n.a=function(t){return Object(o.a)(t)?Object(r.a)(t):Object(i.a)(t)}},3346:function(t,n,e){"use strict";n.a=t=>{if(t){const{shouldEncryptMessageAsSmime:n,shouldSignMessageAsSmime:e}=t;return n||e}return!1}},3499:function(t,n,e){"use strict";var r=e(25),i=e(2993),o=e(220);n.a=function(){const{clpLabels:t}=i.b;return Object(r.k)("cmp-clp")&&t.length>0&&t.some(t=>t.isLabelEnabled)&&!Object(o.a)()}},3612:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));var r=e(30);function i(){return Object(r.a)().SessionSettings.UserEmailAddress}},3696:function(t,n,e){"use strict";e.d(n,"a",(function(){return o}));var r=e(30),i=e(25);function o(){var t;return Object(i.k)("cmp-roaming-signature")&&!(null===(t=Object(r.a)().SessionSettings)||void 0===t?void 0:t.IsExplicitLogon)}},3730:function(t,n,e){"use strict";e.d(n,"c",(function(){return o})),e.d(n,"f",(function(){return c})),e.d(n,"d",(function(){return a})),e.d(n,"h",(function(){return u})),e.d(n,"e",(function(){return s})),e.d(n,"g",(function(){return d})),e.d(n,"b",(function(){return l})),e.d(n,"a",(function(){return f}));var r=e(20);const i=new r.c(()=>Promise.all([e.e(4),e.e(8),e.e(15),e.e(21),e.e(24),e.e(330),e.e(550)]).then(e.bind(null,5975))),o=new r.a(i,t=>t.loadCLPUserLabels),c=(new r.a(i,t=>t.addAuditActionToViewState),new r.b(i,t=>t.showJustificationModal)),a=new r.a(i,t=>t.loadItemCLPInfo),u=new r.b(i,t=>t.updateItemCLPInfo),s=new r.b(i,t=>t.logReadCLPLabel),d=new r.b(i,t=>t.triggerCLPAutoLabeling),l=(new r.b(i,t=>t.constructCLPAuditAction),Object(r.d)(i,t=>t.CLPSubjectHeaderLabel)),f=Object(r.d)(i,t=>t.CLPMandatoryLabelModal)},4037:function(t,n,e){"use strict";e.d(n,"b",(function(){return r})),e.d(n,"a",(function(){return i}));const r={Name:{id:34230,propertyType:"String"},Description:{id:34231,propertyType:"String"},Id:{id:34232,propertyType:"String"},IsClassified:{id:34229,propertyType:"Boolean"}},i="messageClassification"},4089:function(t,n,e){"use strict";var r=e(4181),i=e(3612),o=e(941),c=e(30),a=e(220);var u=e(4277);function s(){const t=function(){const t=Object(c.a)(),n=Object(a.a)()?t.SessionSettings.DefaultFromAddress:t.UserOptions.SendAddressDefault;return Object(o.c)(n)?n:Object(i.a)()}(),n=Object(i.a)();if(n===t&&Object(u.a)(t)){const t=Object(r.b)(n,!0);if(t&&t.length>0)return t[0]}return t}var d=e(4860),l=e(2742),f=e(25),b=e(154),m=e(4126);function h(t){let n;if(t){const e=Object(l.g)(),r=null==e?void 0:e.items,i=r&&r.has(t.Id)&&r.get(t.Id);n=i&&Object(d.a)(i.ToRecipients,i.CcRecipients)}if(!n&&Object(f.k)("nh-boot-acctmonaccounts")&&Object(b.a)("acctmonaccounts")){const t=Object(m.a)(),{emailAddress:n,displayName:e}=(null==t?void 0:t.mailbox)||{};if(n&&e)return{MailboxType:"Mailbox",RoutingType:"SMTP",EmailAddress:n,Name:e}}return{MailboxType:"Mailbox",RoutingType:"SMTP",EmailAddress:n||s(),Name:Object(c.a)().SessionSettings.UserDisplayName}}e.d(n,"a",(function(){return h}))},4126:function(t,n,e){"use strict";e.d(n,"a",(function(){return o}));var r=e(22),i=e(2988);function o(){return function(t){const n=Object(i.a)().accountSources.filter(n=>n.id===t);if(1===n.length)return n[0];n.length>1&&r.h.warn("Found more than one account with the same source id");return}(Object(i.a)().selectedAccountSourceId)}},4181:function(t,n,e){"use strict";e.d(n,"a",(function(){return a})),e.d(n,"b",(function(){return u}));var r=e(3612),i=e(4277),o=e(30),c=e(220);function a(t){let n=[];const e=Object(r.a)();Object(i.a)(e)||n.push(e);const c=u(e,t);return n=n.concat(c),n=function(t){const n=Object(o.a)().SessionSettings.ConnectedAccountInfos;n&&n.length>0&&n.forEach(n=>{-1==t.lastIndexOf(n.EmailAddress)&&t.push(n.EmailAddress)});return t}(n),n}function u(t,n){let e=[];if(Object(c.a)()||n){const n=function(t){return s(t,Object(o.a)().SessionSettings.UserProxyAddresses)}(t);e=e.concat(n)}if(Object(c.a)()){const n=function(t){return s(t,Object(o.a)().SessionSettings.NotManagedEmailAddresses)}(t);e=e.concat(n)}return e}function s(t,n){const e=[];return n&&n.length>0&&n.forEach(n=>{t==n||Object(i.a)(n)||e.push(n)}),e}},4277:function(t,n,e){"use strict";e.d(n,"a",(function(){return o}));var r=e(30),i=e(220);function o(t){let n=!1;if(Object(i.a)()){const e=Object(r.a)();n=0==(t=t.toLowerCase()).indexOf("outlook_"+e.HexCID)||-1!=t.indexOf("@shadow.outlook.com")}return n}},4860:function(t,n,e){"use strict";e.d(n,"a",(function(){return o}));var r=e(4181),i=e(4278);function o(t,n){return function(t,n){for(let e=0;e<n.length;e++)if(c(n[e],t))return n[e];return null}((t||[]).concat(n||[]),Object(r.a)(!0))}function c(t,n){if(n&&n.length>0)for(let e of n)if(e&&Object(i.a)(t,e.EmailAddress))return!0;return!1}},5342:function(t,n,e){"use strict";var r=e(2);n.a=Object(r.mutatorAction)("switchToReadWriteRecipient",(function(t){t.showCompactRecipientWell=!1}))},713:function(t,n,e){"use strict";var r=e(416),i=e(522),o=Object(i.a)(Object.keys,Object),c=Object.prototype.hasOwnProperty;n.a=function(t){if(!Object(r.a)(t))return o(t);var n=[];for(var e in Object(t))c.call(t,e)&&"constructor"!=e&&n.push(e);return n}},941:function(t,n,e){"use strict";e.d(n,"d",(function(){return s})),e.d(n,"c",(function(){return d})),e.d(n,"b",(function(){return l})),e.d(n,"a",(function(){return f}));const r="A-Za-zªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠ-ࢴऀ-५ॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛱ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎↃↄⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〆〱-〵〻〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿕ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛥꜗ-ꜟꜢ-ꞈꞋ-ꞭꞰ-ꞷꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭥꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ0-9٠-٩۰-۹߀-߉०-९০-৯੦-੯૦-૯୦-୯௦-௯౦-౯೦-೯൦-൯෦-෯๐-๙໐-໙༠-༩၀-၉႐-႙០-៩᠐-᠙᥆-᥏᧐-᧙᪀-᪉᪐-᪙᭐-᭙᮰-᮹᱀-᱉᱐-᱙꘠-꘩꣐-꣙꤀-꤉꧐-꧙꧰-꧹꩐-꩙꯰-꯹０-９",i=new RegExp("^(["+r+"!#$%&'*+/=?^_`{|}~-](?:["+r+".!#$%&'*+/=?^_`{|}~-]*["+r+"!#$%&'*+/=?^_`{|}~-])?)(?=@)"),o=new RegExp('^("['+r+'.!#$%&\'*+\\/=?^_`{|}~\\-(),:;<>@[\\\\\\]" ]*")(?=@)'),c=new RegExp("^["+r+"-]+(?:\\.["+r+"-]+)*$"),a=/[^\\]"/,u=/^[A-Za-z0-9_-]+:.*$/,s=t=>{const n=t.match(i);if(n)return-1!==n[0].indexOf("..")?null:n[0];const e=t.match(o);if(e){const t=a.exec(e[0]);return t&&t.index!==e[0].length-2?null:e[0]}return null};function d(t){if(!t)return!1;const n=s(t);return!!n&&!!t.substring(n.length+1).match(c)}function l(t){return u.test(t)}function f(t){return d(t)||l(t)}}}]);
//# sourceMappingURL=owa.317.js.map
self.scriptsLoaded['owa.317.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.317.js'] = (new Date()).getTime();