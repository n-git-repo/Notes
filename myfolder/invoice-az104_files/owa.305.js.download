self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.305.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[305,2148],{1085:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"PropertyUri:#Exchange"},e)}n.d(t,"a",(function(){return r}))},1089:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"TargetFolderId:#Exchange"},e)}n.d(t,"a",(function(){return r}))},1098:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"GetNotesForPersonaRequest:#Exchange"},e)}n.d(t,"a",(function(){return r}))},1114:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"PersonaPropertyUpdate:#Exchange"},e)}n.d(t,"a",(function(){return r}))},124:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(46);function i(){let e=Object(r.b)(),t=e.origin;return t||(t=e.protocol+"//"+e.hostname+(e.port?":"+e.port:"")),t}function o(){return i()+"/"}},1431:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"DistinguishedFolderId:#Exchange"},e)}n.d(t,"a",(function(){return r}))},1473:function(e,t,n){"use strict";var r=n(2);var i,o=Object(r.action)("initializeApplicationSettings",e=>({config:e}));!function(e){e[e.None=0]="None",e[e.Hx=1]="Hx",e[e.Web=2]="Web",e[e.Remote=4]="Remote",e[e.All=7]="All"}(i||(i={}));const c={Loki:{resourceUrl:"https://loki.delve.office.com/"},Analytics:{disabledDatapoints:[]},EnabledResolvers:{Query:{},Mutation:{markItemAsRead:i.Hx|i.Remote},Subscription:{}},CAPIv3:{isCAPIv3Enabled:!1}};var u=n(11);const s=()=>{const e=Object(u.a)(self,"applicationSettingOverrides");if(e)try{return JSON.parse(e)}catch(e){return{}}return{}};let a={settings:c,overrides:s(),configIDs:void 0,lastError:void 0,initialized:!1,report:void 0,searchKey:void 0};var f=Object(r.createStore)("applicationSettings",a);const l=(e,t,n)=>{const r={};let i=0;const{count:o,keys:c}=function e(t,n={}){let r=0,i=[];return Object.keys(t).forEach(o=>{const c=t[o];if("object"==typeof c&&null!==c&&!Array.isArray(c)){const{count:c,keys:u}=e(t[o],n[o]);c&&(r+=c,i.push({group:o,settings:u}))}else n.hasOwnProperty(o)||(r+=1,i.push(o))}),{count:r,keys:i}}(e,t);if(o&&(r.MissingSettings=c,i=o),i&&(r.MissingSettingsCount=i),n&&(r.LastError=n),i)return r};Object(r.mutator)(o,({config:e})=>{const t=f();if(t.initialized=!0,!e)return void(t.report={NoSettings:!0});if(!e.settings)return t.lastError=e.lastError,void(t.report={NoSettings:!0});const n={};Object.keys(c).forEach(t=>{n[t]={};const r=e.settings[t];Object.keys(c[t]).forEach(e=>{n[t][e]=r&&r.hasOwnProperty(e)?r[e]:c[t][e]})}),t.configIDs=e.configIDs,t.lastError=e.lastError,t.settings=n,t.report=l(c,e.settings,e.lastError)});var d=Object(r.action)("setApplicationSettingOverride",(e,t)=>({setting:e,value:t}));Object(r.mutator)(d,({setting:e,value:t})=>{const n=f();n.overrides=Object.assign(Object.assign({},n.overrides),{[e]:t})});var p=Object(r.action)("setApplicationSettingsSearchKey",e=>({key:e}));Object(r.mutator)(p,({key:e})=>{f().searchKey=e});var b=Object(r.action)("resetApplicationSettingOverrides");Object(r.mutator)(b,()=>{f().overrides={}});Object(r.orchestrator)(d,({setting:e,value:t})=>{((e,t)=>{const n=s();n[e]=t,Object(u.e)(window,"applicationSettingOverrides",JSON.stringify(n))})(e,t)});Object(r.orchestrator)(b,()=>{Object(u.d)(window,"applicationSettingOverrides")});var g=n(22),v=n(25);function O(e){const t=f();return t.initialized||g.d(`Attempted to read ${e} before application settings were initialized.`),Object(v.k)("fwk-devTools")?function e(t,n,r){let i={};return Object.keys(t).forEach(o=>{if("object"==typeof o&&null!==o&&!Array.isArray(o))i=Object.assign(Object.assign({},i),{[r.shift()]:e(t[o],n,r)});else{const e=[...r,o].join("."),c=n[e];i=Object.assign(Object.assign({},i),{[o]:void 0===c?t[o]:c})}}),i}(t.settings[e],t.overrides,[e]):t.settings[e]}function m(e){return f().overrides[e]}function j(){return f().report}function h(){return f().searchKey}function w(){const e=f();return e.initialized||g.d("Attempted to read settings before application settings were initialized."),e.settings}const y=new Map([["markItemAsRead","fwk-useoutlookgateway-markItemAsRead"]]);function k(e,t){return(S(e,t)&i.Hx)==i.Hx}function z(e,t){return(S(e,t)&i.Web)==i.Web}function x(e,t){return(S(e,t)&i.Remote)==i.Remote}function S(e,t){var n;const r=i.All;if(y.has(t)){let e=y.get(t);if(e)return Object(v.k)(e)?i.Hx|i.Remote:r}if(Object(v.k)("fwk-graphql-resolvers-config")&&Object(v.k)("fwk-application-settings")){const i=O("EnabledResolvers"),o=null===(n=null==i?void 0:i[e])||void 0===n?void 0:n[t];return null==o?r:o}return r}n.d(t,"f",(function(){return O})),n.d(t,"e",(function(){return m})),n.d(t,"g",(function(){return j})),n.d(t,"h",(function(){return h})),n.d(t,"d",(function(){return w})),n.d(t,"i",(function(){return o})),n.d(t,"k",(function(){return d})),n.d(t,"l",(function(){return p})),n.d(t,"j",(function(){return b})),n.d(t,"a",(function(){return k})),n.d(t,"c",(function(){return z})),n.d(t,"b",(function(){return x}))},1485:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(35),i=n(1098);function o(e,t){return void 0===e.getNotesForPersonaRequest||e.getNotesForPersonaRequest.__type||(e.getNotesForPersonaRequest=Object(i.a)(e.getNotesForPersonaRequest)),Object(r.a)("GetNotesForPersona",e,t)}},180:function(e,t,n){"use strict";var r=n(22);let i;function o(){return null==i&&(i="undefined"!=typeof window&&null!=window.performance&&null!=window.performance.timing&&null!=window.performance.navigation&&null!=window.performance.getEntriesByName),i}const c=500,u=[],s=[],a=[],f=[];let l,d=!0;function p(e,t){Object(r.g)((e,t,n)=>{d&&(t==r.b.Error&&s.push({message:e,error:n}),u.push({message:e,level:t}))}),e(v),t(v),o()&&(window.performance.setResourceTimingBufferSize?window.performance.setResourceTimingBufferSize(c):window.performance.webkitSetResourceTimingBufferSize&&window.performance.webkitSetResourceTimingBufferSize(c))}function b(e,t,n){l?l(e,t,n):f.push({name:e,customData:t})}function g(e){return l=e,d=!1,{traces:u,errors:s,network:a,usage:f}}function v(){d&&a.push(arguments)}n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return g})),n.d(t,"d",(function(){return b})),n.d(t,"c",(function(){return o}))},181:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,i=!1;function o(t){r--,delete e[t]}this.put=function(t,n,i,c){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==c&&"function"!=typeof c)throw new Error("Cache timeout callback must be a function");var u=e[t];u?clearTimeout(u.timeout):r++;var s={value:n,expire:i+Date.now()};return isNaN(s.expire)||(s.timeout=setTimeout(function(){o(t),c&&c(t,n)}.bind(this),i)),e[t]=s,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&o(t),n},this.clear=function(){for(var o in e)clearTimeout(e[o].timeout);r=0,e=Object.create(null),i&&(t=0,n=0)},this.get=function(o){var c=e[o];if(void 0!==c){if(isNaN(c.expire)||c.expire>=Date.now())return i&&t++,c.value;i&&n++,r--,delete e[o]}else i&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){i=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),i=Date.now(),o=n&&n.skipDuplicates;for(var c in r)if(r.hasOwnProperty(c)){if(o)if(e[c])continue;var u=r[c],s=u.expire-i;if(s<=0){this.del(c);continue}s=s>0?s:void 0,this.put(c,u.value,s)}return this.size()}}e.exports=new r,e.exports.Cache=r},211:function(e,t,n){"use strict";var r=n(930);n.d(t,"a",(function(){return r.a}))},316:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return s}));var r=n(124),i=n(117),o=n(3);let c;function u(e){c=e}async function s(){var e,t;if(Object(o.P)())return i.f.importAndExecute(Object(r.a)());const n=c&&await c();if(n&&n.length>0){if("bearer"===(null===(e=null==n?void 0:n.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return n.split(" ")[1];if("msauth1.0"===(null===(t=null==n?void 0:n.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return n}}},381:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"ItemId:#Exchange"},e)}n.d(t,"a",(function(){return r}))},430:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(89);function i(e){return Object(r.a)(e,[r.c])}},48:function(e,t,n){"use strict";var r,i,o;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),function(e){e[e.tiny=0]="tiny",e[e.extraExtraSmall=1]="extraExtraSmall",e[e.extraSmall=2]="extraSmall",e[e.small=3]="small",e[e.regular=4]="regular",e[e.large=5]="large",e[e.extraLarge=6]="extraLarge",e[e.size8=17]="size8",e[e.size10=9]="size10",e[e.size16=8]="size16",e[e.size24=10]="size24",e[e.size28=7]="size28",e[e.size32=11]="size32",e[e.size40=12]="size40",e[e.size48=13]="size48",e[e.size56=16]="size56",e[e.size72=14]="size72",e[e.size100=15]="size100",e[e.size120=18]="size120"}(r||(r={})),function(e){e[e.none=0]="none",e[e.offline=1]="offline",e[e.online=2]="online",e[e.away=3]="away",e[e.dnd=4]="dnd",e[e.blocked=5]="blocked",e[e.busy=6]="busy"}(i||(i={})),function(e){e[e.lightBlue=0]="lightBlue",e[e.blue=1]="blue",e[e.darkBlue=2]="darkBlue",e[e.teal=3]="teal",e[e.lightGreen=4]="lightGreen",e[e.green=5]="green",e[e.darkGreen=6]="darkGreen",e[e.lightPink=7]="lightPink",e[e.pink=8]="pink",e[e.magenta=9]="magenta",e[e.purple=10]="purple",e[e.black=11]="black",e[e.orange=12]="orange",e[e.red=13]="red",e[e.darkRed=14]="darkRed",e[e.transparent=15]="transparent",e[e.violet=16]="violet",e[e.lightRed=17]="lightRed",e[e.gold=18]="gold",e[e.burgundy=19]="burgundy",e[e.warmGray=20]="warmGray",e[e.coolGray=21]="coolGray",e[e.gray=22]="gray",e[e.cyan=23]="cyan",e[e.rust=24]="rust"}(o||(o={}))},483:function(e,t,n){"use strict";var r=n(430),i=n(36),o=n(89);function c(e){return Object(o.a)(e,[o.b])}var u=n(40),s=n(73);function a(e){return Object(u.b)(Object(u.c)(Object(u.a)(Object(s.a)()||"",e)))}var f=n(600),l=n(763),d=n(223);let p,b,g;function v(){return p||(p=Object(i.a)("/calendar")+"/"),p}function O(){return b||(b=Object(i.a)("/mail")+"/"),b}function m(){return g||(g=Object(i.a)("/files")+"/"),g}var j=n(945);let h,w,y;function k(e){return h&&w===e||(w=e,h=e?Object(i.a)("/people/group/owner")+"/":Object(i.a)("/people/group/member")+"/"),h}function z(){return y||(y=Object(i.a)("/people/group/deleted")+"/"),y}function x(e){return window.location.origin+v()+"showPeek/item/"+encodeURIComponent(e)}var S=n(724),R=n(7),E=n(629);const N=Object(S.a)().split("/").slice(1).join("/")+"deeplink/";function P(e,t,n,r){n&&((r=r||{}).minus="");let i="";if(r){const e=Object(R.d)();Object(E.a)(e),Object.keys(r).filter(e=>e).forEach(t=>e[t]=r[t]),i="?"+Object(R.i)(e)}return`${`/${e}/${N}`}${t}${i}`}var A=n(224),$=n(30);const I="https://to-do.microsoft.com";function T(e,t){var n,r;const i=Object($.a)(),o=i.UserOptions,c=null===(n=i.SessionSettings)||void 0===n?void 0:n.UserPrincipalName;let u=I,s={};if(null===(r=null==o?void 0:o.ReactOptinSettings)||void 0===r?void 0:r.TasksRedirectUrl){let e="";[u,e]=o.ReactOptinSettings.TasksRedirectUrl.split("?"),s=Object(R.g)(e),c&&(s.auth_upn=c)}return e&&(s.utm_source=e),t&&delete s.fromOwa,Object.keys(s).length>0?Object(d.a)(u,s):u}let U;function C(){return U||(U=Object(i.a)("/eventify")+"?entryPoint=owa"),U}var _=n(124);let D;function G(){return D||(D=Object(i.a)("/host")+"/"),D}n(46);n.d(t,"k",(function(){return r.a})),n.d(t,"t",(function(){return i.a})),n.d(t,"g",(function(){return c})),n.d(t,"m",(function(){return a})),n.d(t,"s",(function(){return f.a})),n.d(t,"x",(function(){return u.a})),n.d(t,"a",(function(){return u.b})),n.d(t,"b",(function(){return u.c})),n.d(t,"o",(function(){return l.a})),n.d(t,"v",(function(){return d.a})),n.d(t,"e",(function(){return v})),n.d(t,"l",(function(){return O})),n.d(t,"h",(function(){return m})),n.d(t,"p",(function(){return j.a})),n.d(t,"j",(function(){return k})),n.d(t,"i",(function(){return z})),n.d(t,"d",(function(){return x})),n.d(t,"q",(function(){return P})),n.d(t,"w",(function(){return A.a})),n.d(t,"u",(function(){return T})),n.d(t,"f",(function(){return C})),n.d(t,"n",(function(){return _.a})),n.d(t,"r",(function(){return s.a})),n.d(t,"c",(function(){return G}))},600:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(7),i=n(629);function o(){const e=Object(r.d)();Object(i.a)(e);const t=Object(r.i)(e);return t.length>0?"?"+t:""}},629:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const r=["hostApp","isanonymous","cspoff","frameName","opxInstanceId","hxVersion"];function i(e){e&&Object.keys(e).forEach(t=>{r.includes(t)&&delete e[t]})}},724:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(73),i=n(36);function o(e){return(Object(i.a)("/"+(e||Object(r.a)()))+"/").replace(/^\//,"")}},726:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return b}));var r=n(946),i=n(417),o=n(48),c=n(72),u=n(12);const s="email",a="personId",f="UA",l="size",d="/service.svc/s/GetPersonaPhoto";function p(e,t,n,o){if(Object(i.a)()&&Object(i.b)(t,e))return Object(r.a)(e,n);{let n=Object(u.a)().baseUrl,r="";return e&&(r=g(r,s,e&&e.toLowerCase())),t&&(r=g(r,a,t)),r=g(r,f,"0"),r=g(r,l,o?"HR96x96":"HR64x64"),`${n}${d}?${r}`}}function b(e,t,n){return Object(i.a)()?Object(r.a)(e,t):`https://cid-${e}.users.storage.live.com/users/0x${e}/myprofile/expressionprofile/profilephoto:${function(e){switch(e){case o.c.tiny:case o.c.extraExtraSmall:case o.c.extraSmall:case o.c.small:case o.c.regular:case o.c.large:case o.c.size10:case o.c.size8:case o.c.size16:case o.c.size24:case o.c.size28:case o.c.size32:return"UserTileStatic,UserTileSmall";case o.c.extraLarge:case o.c.size40:case o.c.size48:case o.c.size56:case o.c.size72:case o.c.size100:case o.c.size120:return"UserTileMedium,UserTileStatic,UserTileSmall";default:return Object(c.a)(e)}}(n)}/MeControlMediumUserTile?ck=1&ex=24&fofoff=1`}function g(e,t,n){n&&(n=encodeURIComponent(n));let r=`${t}=${n}`;return e&&(r=`${e}&${r}`),r}},763:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(46),i=n(36),o=n(124);function c(e){let t=Object(r.b)(),n=Object(o.a)()+Object(i.a)("/owa")+"/",c=t.search&&t.search.length>0;n+=c?t.search:"?";let u=Object.keys(e),s=c;for(let t=0;t<u.length;t++)s?n+="&":s=!0,n+=u[t]+"="+e[u[t]];return n}},7794:function(e,t,n){"use strict";n.r(t);var r=n(1139);n.d(t,"downloadPersonaPhoto",(function(){return r.a}));var i=n(1493);n.d(t,"initializeLivePersonaCardAsync",(function(){return i.a}))},876:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(30),i=n(220);function o(e){if(!Object(i.a)()||!e)return;const t=Object(r.a)();var n,o;return t&&t.SessionSettings?(n=e,o=t.SessionSettings.UserEmailAddress,n&&o&&n.toLowerCase()==o.toLowerCase()?t.HexCID:void 0):void 0}},930:function(e,t,n){"use strict";function r(e){return e>=200&&e<300}n.d(t,"a",(function(){return r}))},945:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(36);let i;function o(){return i||(i=Object(r.a)("/people")+"/"),i}},946:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(6);const i="/profile/v1.0/{0}/{1}/image/$value";function o(e,t){const n=e.indexOf("@")>-1,o="GroupMailbox"==t?"groups":"users";return Object(r.c)(i,o,n?e:`cid:${e}`)}}}]);
//# sourceMappingURL=owa.305.js.map
self.scriptsLoaded['owa.305.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.305.js'] = (new Date()).getTime();