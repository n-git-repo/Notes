self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.977.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[977],{20130:function(t,n,e){"use strict";e.r(n);var o=e(9201),r=e(2937),i=e(625),u=e(4147),a=e(5277),c=e(4812),s=e(483),l=e(3682),f=e(3),d=e(682),p=e(154),m=e(170);function g(){const t=Object(l.b)();let n=[];const e=Object(u.a)();return e!=i.a.MailDeepLink&&e!=i.a.PublishedCalendar&&(n=[b(t.gotoMail,v),b(t.gotoCalendar,y),b(t.gotoPeople,w)],Object(r.d)()!==r.a.None&&n.push(b(t.gotoToDo,h)),!Object(m.a)()||"Dogfood"!=Object(f.D)()&&"Microsoft"!=Object(f.D)()||n.push(b(t.goToDevTools,O))),n}function b(t,n){return{command:t,handler:n,options:{allowHotkeyOnTextFields:!0,isEnabled:S}}}function v(){V(i.a.Mail)}function y(){V(i.a.Calendar)}function w(){V(i.a.People)}function h(){V(i.a.Tasks)}function V(t){const n=Object(u.a)();n&&Object(c.b)(n,t)?Object(c.e)(t,n):window.location.assign(t===i.a.Tasks&&Object(r.d)()===r.a.ToDo?Object(s.u)():Object(s.o)({path:"/"+t.toLowerCase()}))}function S(){return!Object(p.a)("disableAppModuleKeys")&&(Object(u.a)()!=i.a.Calendar||Object(o.c)()&&Object(a.b)())}function O(){Object(d.h)(d.a.DevTools)}e.d(n,"setupAppModuleKeys",(function(){return g}))},228:function(t,n,e){"use strict";e.d(n,"a",(function(){return r}));var o=e(549);function r(t,n){return void 0===n&&(n=!0),t&&(n&&Object(o.a)(t)||t.parentNode&&t.parentNode)}},255:function(t,n,e){"use strict";e.d(n,"a",(function(){return r}));var o=e(228);function r(t,n,e){void 0===e&&(e=!0);var r=!1;if(t&&n)if(e)if(t===n)r=!0;else for(r=!1;n;){var i=Object(o.a)(n);if(i===t){r=!0;break}n=i}else t.contains&&(r=t.contains(n));return r}},297:function(t,n,e){"use strict";e.d(n,"e",(function(){return d})),e.d(n,"h",(function(){return p})),e.d(n,"f",(function(){return m})),e.d(n,"i",(function(){return g})),e.d(n,"c",(function(){return b})),e.d(n,"k",(function(){return v})),e.d(n,"j",(function(){return y})),e.d(n,"o",(function(){return w})),e.d(n,"n",(function(){return h})),e.d(n,"m",(function(){return V})),e.d(n,"l",(function(){return S})),e.d(n,"a",(function(){return O})),e.d(n,"p",(function(){return I})),e.d(n,"b",(function(){return j})),e.d(n,"g",(function(){return T})),e.d(n,"d",(function(){return P}));var o=e(717),r=e(255),i=e(228),u=e(43),a=e(87),c="data-is-focusable",s="data-is-visible",l="data-focuszone-id",f="data-is-sub-focuszone";function d(t,n,e){return y(t,n,!0,!1,!1,e)}function p(t,n,e){return v(t,n,!0,!1,!0,e)}function m(t,n,e,o){return void 0===o&&(o=!0),y(t,n,o,!1,!1,e,!1,!0)}function g(t,n,e,o){return void 0===o&&(o=!0),v(t,n,o,!1,!0,e,!1,!0)}function b(t){var n=y(t,t,!0,!1,!1,!0);return!!n&&(j(n),!0)}function v(t,n,e,o,r,i,u,a){if(!n||!u&&n===t)return null;var c=w(n);if(r&&c&&(i||!V(n)&&!S(n))){var s=v(t,n.lastElementChild,!0,!0,!0,i,u,a);if(s){if(a&&h(s,!0)||!a)return s;var l=v(t,s.previousElementSibling,!0,!0,!0,i,u,a);if(l)return l;for(var f=s.parentElement;f&&f!==n;){var d=v(t,f.previousElementSibling,!0,!0,!0,i,u,a);if(d)return d;f=f.parentElement}}}if(e&&c&&h(n,a))return n;var p=v(t,n.previousElementSibling,!0,!0,!0,i,u,a);return p||(o?null:v(t,n.parentElement,!0,!1,!1,i,u,a))}function y(t,n,e,o,r,i,u,a){if(!n||n===t&&r&&!u)return null;var c=w(n);if(e&&c&&h(n,a))return n;if(!r&&c&&(i||!V(n)&&!S(n))){var s=y(t,n.firstElementChild,!0,!0,!1,i,u,a);if(s)return s}if(n===t)return null;var l=y(t,n.nextElementSibling,!0,!0,!1,i,u,a);return l||(o?null:y(t,n.parentElement,!1,!1,!0,i,u,a))}function w(t){if(!t||!t.getAttribute)return!1;var n=t.getAttribute(s);return null!=n?"true"===n:0!==t.offsetHeight||null!==t.offsetParent||!0===t.isVisible}function h(t,n){if(!t||t.disabled)return!1;var e=0,o=null;t&&t.getAttribute&&(o=t.getAttribute("tabIndex"))&&(e=parseInt(o,10));var r=t.getAttribute?t.getAttribute(c):null,i=null!==o&&e>=0,u=!!t&&"false"!==r&&("A"===t.tagName||"BUTTON"===t.tagName||"INPUT"===t.tagName||"TEXTAREA"===t.tagName||"SELECT"===t.tagName||"true"===r||i);return n?-1!==e&&u:u}function V(t){return!!(t&&t.getAttribute&&t.getAttribute(l))}function S(t){return!(!t||!t.getAttribute||"true"!==t.getAttribute(f))}function O(t){var n=Object(a.a)(t),e=n&&n.activeElement;return!(!e||!Object(r.a)(t,e))}function I(t,n){return"true"!==Object(o.a)(t,n)}var D=void 0;function j(t){if(t){if(D)return void(D=t);D=t;var n=Object(u.a)(t);n&&n.requestAnimationFrame((function(){D&&D.focus(),D=void 0}))}}function T(t,n){for(var e=t,o=0,r=n;o<r.length;o++){var i=r[o],u=e.children[Math.min(i,e.children.length-1)];if(!u)break;e=u}return e=h(e)&&w(e)?e:y(t,e,!0)||v(t,e)}function P(t,n){for(var e=[];n&&t&&n!==t;){var o=Object(i.a)(n,!0);if(null===o)return[];e.unshift(Array.prototype.indexOf.call(o.children,n)),n=o}return e}},359:function(t,n,e){"use strict";e.d(n,"a",(function(){return r}));var o=e(228);function r(t,n){return t&&t!==document.body?n(t)?t:r(Object(o.a)(t),n):null}},3646:function(t){t.exports=JSON.parse('{"c":"Ixb","a":"Jxb","d":"Kxb","e":"Lxb","f":"Mxb","b":"Nxb"}')},3682:function(t,n,e){"use strict";var o=e(6),r=e(3646),i=e(2937),u=e(3),a=e(170);const c="goTo";function s(){const t={gotoMail:l(r.c,"ctrl+shift+1","ctrl+1"),gotoCalendar:l(r.a,"ctrl+shift+2","ctrl+2"),gotoPeople:l(r.d,"ctrl+shift+3","ctrl+3")};return Object(i.d)()!==i.a.None&&(t.gotoToDo=l(Object(i.b)()?r.f:r.e,"ctrl+shift+4","ctrl+4")),!Object(a.a)()||"Dogfood"!=Object(u.D)()&&"Microsoft"!=Object(u.D)()||(t.goToDevTools=l(r.b,"ctrl+shift+d","ctrl+d")),t}function l(t,n,e){return{category:c,description:Object(o.b)(t),hotmail:n,yahoo:n,gmail:n,owa:n,outlook:e}}e.d(n,"b",(function(){return s})),e.d(n,"a",(function(){return c}))},485:function(t,n,e){"use strict";function o(t){return t&&!!t._virtual}e.d(n,"a",(function(){return o}))},5277:function(t,n,e){"use strict";let o=[];function r(t,n){return!t&&!n||!(!t||!n)&&t.popupRoot==n.popupRoot}function i(t){for(let n=o.length-1;n>=0;n--){if(o[n].popupRoot==t.popupRoot)return o.splice(n,1),!0}return!1}function u(){return o[o.length-1]}var a=e(297);function c(t){window.addEventListener("focus",n=>{if(function(t){if(t.target==window)return!0;if(!(t.target!=document.body&&document.body.contains(t.target)||Object(a.n)(t.target)))return t.preventDefault(),!0;return!1}(n))return;let e=function(t){if(t==document.body||t.contains(document.body))return null;let n=t;for(;(null==n?void 0:n.parentElement)&&n.parentElement!=document.body;)n=n.parentElement;return n}(n.target);null!=(Object(a.n)(n.target)?n.target:n.relatedTarget)&&t(n.target,e)},!0)}let s;var l=e(22);let f=0;const d=200;function p(){var t,n;t=b,n=v,s||(s=new MutationObserver(e=>{e.forEach(e=>{let o=e.removedNodes,r=e.addedNodes;for(let n=0;n<r.length;n++){let e=r.item(n);t(e)}for(let t=0;t<o.length;t++){let e=o.item(t);n(e)}})})),s.disconnect(),s.observe(document.body,{childList:!0,subtree:!1}),c(h)}function m(){f++,setTimeout(()=>f--,d)}function g(){return t=u(),r(o[0],t);var t}function b(t){m()}function v(t){let n=u(),e={popupRoot:t,element:null,path:null,fullPath:null};if(i(e),r(n,e)){V();let t=u();t&&function(t){if(!t)return;let n=t.element;if(document.body.contains(n))w(n);else{let n=y(t.path,t.popupRoot);n?w(n):(n=y(t.fullPath,t.popupRoot),n&&w(n))}}(t)}}function y(t,n){let e;try{e=n.querySelectorAll(t)}catch(t){l.h.warn("moduleFocusController: Error selecting for elements, will not set focus")}return e&&1==e.length?e.item(0):null}function w(t){let n=t;for(;n&&n!=document.body;){let t=Object(a.e)(n,n,!0);if(t&&Object(a.n)(t))return void setTimeout(()=>{0==f&&t.focus({preventScroll:!document.body.classList.contains("ms-Fabric--isFocusVisible")})},0);n=n.parentElement}}function h(t,n){let e={popupRoot:n,element:t,fullPath:O(t,n),path:S(t)};V(),m(),i(e),function(t){let n=!1;for(let e=o.length-1;e>=0;e--){o[e].popupRoot==t.popupRoot&&(o[e]=t,n=!0)}n||o.push(t)}(e)}function V(){let t=u();for(;t;){if(document.body.contains(t.popupRoot)&&Object(a.e)(t.popupRoot,t.popupRoot,!0))return;i(t),t=u()}}function S(t,n){let e=t.tagName;for(let o=0;o<t.attributes.length;o++){let r=t.attributes[o];if(null==n?void 0:n.includes(r.name))continue;let i=r.value.replace("\\","\\\\");if(0===i.length)continue;i=i.replace(/[\n']/g,"']["+r.name+"*='");let u="["+r.name+"*='"+i+"']";e=e.concat(u)}return e}function O(t,n){let e=t,o="";const r=["class","style"];for(;e!==n;)o=` ${S(e,r)}`+o,e=e.parentElement;return o}e.d(n,"a",(function(){return p})),e.d(n,"c",(function(){return m})),e.d(n,"b",(function(){return g}))},549:function(t,n,e){"use strict";e.d(n,"a",(function(){return r}));var o=e(485);function r(t){var n;return t&&Object(o.a)(t)&&(n=t._virtual.parent),n}},682:function(t,n,e){"use strict";e.d(n,"c",(function(){return o})),e.d(n,"d",(function(){return r})),e.d(n,"b",(function(){return i})),e.d(n,"a",(function(){return a})),e.d(n,"g",(function(){return l})),e.d(n,"m",(function(){return f})),e.d(n,"i",(function(){return d})),e.d(n,"e",(function(){return p})),e.d(n,"f",(function(){return m})),e.d(n,"p",(function(){return g})),e.d(n,"n",(function(){return b})),e.d(n,"o",(function(){return v})),e.d(n,"q",(function(){return y})),e.d(n,"j",(function(){return w})),e.d(n,"h",(function(){return h})),e.d(n,"l",(function(){return V})),e.d(n,"k",(function(){return S}));var o,r,i,u,a,c=e(102);!function(t){t.Unknown="Unknown",t.WW="WW",t.Dogfood="Dogfood",t.SIP="SIP",t.BlackForest="BlackForest",t.DONMT="DONMT",t.MSIT="MSIT",t.Gallatin="Gallatin",t.SDFV2="SDFV2",t.PDT="PDT",t.TDF="TDF",t.ITAR="ITAR"}(o||(o={})),function(t){t.Unknown="Unknown",t.AG08="AG08",t.AG09="AG09",t.BlackForest="BlackForest",t.DITAR="DITAR",t.DoD="DoD",t.Dogfood="Dogfood",t.Gallatin="Gallatin",t.GCCModerate="GCCModerate",t.GccHigh="GccHigh",t.GovCloud="GovCloud",t.ITAR="ITAR",t.Prod="Prod"}(r||(r={})),function(t){t.Dogfood="Dogfood",t.Microsoft="Microsoft",t.FirstRelease="FirstRelease",t.WW="WW",t.Unknown="Unknown"}(i||(i={})),function(t){t.Business="Business",t.Consumer="Consumer"}(u||(u={})),function(t){t.Unknown="Unknown",t.DevTools="DevTools"}(a||(a={}));class s{static ArrayOfRectDimensionsValue(t){for(let n=0;n<t.length;n++)t[n]=s.RectDimensionsValue(t[n]);return t}static ArrayOfKeyValuePairValue(t){for(let n=0;n<t.length;n++)t[n]=s.KeyValuePairValue(t[n]);return t}static ArrayOfStringValue(t){return t}static PhysicalRingEnumValue(t){return t}static VariantEnvironmentEnumValue(t){return t}static LogicalRingEnumValue(t){return t}static UserTypeValue(t){return t}static HotKeyValue(t){return t}static WindowDimensionsValue(t){return t}static RectDimensionsValue(t){return t}static UpdateFrameContextValue(t){const n=t;return n.window=s.WindowDimensionsValue(n.window),n.titleBar=s.RectDimensionsValue(n.titleBar),n.excluded=s.ArrayOfRectDimensionsValue(n.excluded),n}static DiagnosticInfoValue(t){const n=t;return n.physicalRing=s.PhysicalRingEnumValue(n.physicalRing),n.variantEnv=s.VariantEnvironmentEnumValue(n.variantEnv),n.logicalRing=s.LogicalRingEnumValue(n.logicalRing),n.userType=s.UserTypeValue(n.userType),n}static KeyValuePairValue(t){return t}static WindowStateValue(t){return t}static CloseParamsValue(t){return t}static ToggleMaximizeParamsValue(t){return t}static MinimizeParamsValue(t){return t}static BootCompletedParamsValue(t){const n=t;return void 0!==n.info&&(n.info=s.DiagnosticInfoValue(n.info)),n}static BootFailedParamsValue(t){const n=t;return void 0!==n.telemetry&&(n.telemetry=s.ArrayOfKeyValuePairValue(n.telemetry)),n}static UpdateHostParamsValue(t){return t}static UpdateFlightsParamsValue(t){return t}static UpdateFrameParamsValue(t){const n=t;return n.context=s.UpdateFrameContextValue(n.context),n}static UpdateMainWindowIconParamsValue(t){return t}static PopoutLoadedParamsValue(t){return t}static InitialWindowStateParamsValue(t){const n=t;return n.windowState=s.WindowStateValue(n.windowState),n}static HotKeyPressedParamsValue(t){const n=t;return n.hotKey=s.HotKeyValue(n.hotKey),n}}async function l(t){await c.throwIfVersionIsNotSupported("System",.4);const n={windowId:t};return c.HostBridge.invokeHost("System.close",n,void 0)}async function f(t){await c.throwIfVersionIsNotSupported("System",.4);const n={windowId:t};return c.HostBridge.invokeHost("System.toggleMaximize",n,void 0)}async function d(t){await c.throwIfVersionIsNotSupported("System",.4);const n={windowId:t};return c.HostBridge.invokeHost("System.minimize",n,void 0)}async function p(t){await c.throwIfVersionIsNotSupported("System",.3);const n={info:t};return c.HostBridge.invokeHost("System.bootCompleted",n,void 0)}async function m(t){await c.throwIfVersionIsNotSupported("System",.6);const n={telemetry:t};return c.HostBridge.invokeHost("System.bootFailed",n,void 0)}async function g(t){await c.throwIfVersionIsNotSupported("System",.1);const n={forceUpdate:t};return c.HostBridge.invokeHost("System.updateHost",n,void 0)}async function b(t){await c.throwIfVersionIsNotSupported("System",.7);const n={flights:t};return c.HostBridge.invokeHost("System.updateFlights",n,void 0)}async function v(t,n){await c.throwIfVersionIsNotSupported("System",.5);const e={context:t,windwowId:n};return c.HostBridge.invokeHost("System.updateFrame",e,void 0)}async function y(t,n){await c.throwIfVersionIsNotSupported("System",.8);const e={fullIconResourcePath:t,overlayIconResourcePath:n};return c.HostBridge.invokeHost("System.updateMainWindowIcon",e,void 0)}async function w(t){await c.throwIfVersionIsNotSupported("System",.4);const n={windowId:t};return c.HostBridge.invokeHost("System.popoutLoaded",n,void 0)}async function h(t){await c.throwIfVersionIsNotSupported("System",.8);const n={hotKey:t};return c.HostBridge.invokeHost("System.hotKeyPressed",n,void 0)}function V(t){return c.HostBridge.registerForEvent("System.promptUpdateHost",(function(){t()}))}function S(t){return c.HostBridge.registerForEvent("System.initialWindowState",(function(n){if(n){const e=s.InitialWindowStateParamsValue(n);t(e.windowState)}}))}},717:function(t,n,e){"use strict";e.d(n,"a",(function(){return r}));var o=e(359);function r(t,n){var e=Object(o.a)(t,(function(t){return t.hasAttribute(n)}));return e&&e.getAttribute(n)}},9201:function(t,n,e){"use strict";e.d(n,"a",(function(){return r})),e.d(n,"b",(function(){return i})),e.d(n,"c",(function(){return u}));let o=!0;function r(){o=!1}function i(){o=!0}function u(){return o}}}]);
//# sourceMappingURL=owa.977.js.map
self.scriptsLoaded['owa.977.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.977.js'] = (new Date()).getTime();