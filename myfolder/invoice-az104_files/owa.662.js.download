self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.662.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[662],{10971:function(e,t,n){var r=n(15538);"string"==typeof r&&(r=[[e.i,r,""]]);var c={transform:void 0};n(84)(r,c);r.locals&&(e.exports=r.locals)},15538:function(e,t,n){(t=e.exports=n(83)(!1)).push([e.i,"._19HOG2LpcMDmWLDbxgSrjA{font-weight:600}html[dir] ._2GcaHUHDLUAbpYLrgQ3dmp .ms-ContextualMenu-header{padding:0 4px}._1fxzcsX1Q_SnxHkwotTLub{font-weight:700}",""]),t.locals={checkedItem:"_19HOG2LpcMDmWLDbxgSrjA",sectionHeader:"_2GcaHUHDLUAbpYLrgQ3dmp",checkmark:"_1fxzcsX1Q_SnxHkwotTLub"}},2764:function(e,t,n){"use strict";var r=n(13),c=n(2),i=n(3806);function o(e){return Math.floor(Math.random()*e+1)}var a=n(3807);n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return b}));const s=4,u=8,l={toDate:null,fromDate:null,includeAttachments:!1,initialSearchScope:null,isSearchHistoryDirty:!1,isAnswerInitialized:!1,isAnswerLocalizationCompleted:!1,isUnread:!1,isToMe:!1,isFlagged:!1,isMentioned:!1,previousNode:null,searchNumber:0,staticSearchScope:null,staticSearchScopeList:null,shouldShowAdvancedSearch:!1,advancedSearchViewState:Object(i.a)(),initialAdvancedSearchViewState:Object(i.a)(),legacySuggestions:new r.ObservableMap({}),recipientForPersonalizedGhostTextIndex:o(a.a-1),generalizedGhostTextBankIndex:o(s-1),personalizedGhostTextBankIndex:o(u-1),usePersonalGhostText:!1,isAnswerAvailable:!1,provider:null,isAlterationRecourse:!1,filtersInstrumentationContext:null,answersPositionAndPropertyMapping:new r.ObservableMap},d=Object.assign({},l),b=Object(c.createStore)("mailSearchStore",d),f=b();t.c=f},2874:function(e,t,n){"use strict";var r,c,i;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return i})),function(e){e[e.Keywords=0]="Keywords",e[e.People=1]="People",e[e.PrivateDistributionList=2]="PrivateDistributionList",e[e.File=3]="File",e[e.Category=4]="Category",e[e.Message=5]="Message",e[e.Event=6]="Event",e[e.TrySuggestion=7]="TrySuggestion",e[e.Setting=8]="Setting"}(r||(r={})),function(e){e.ODSPFile="ODSP file",e.CloudyAttachment="Cloudy attachment",e.ClassicAttachment="Classic attachment",e.LinkAttachment="Link attachment",e.Unknown="Unknown"}(c||(c={})),function(e){e[e.Unknown=0]="Unknown",e[e.Checking=1]="Checking",e[e.NotSupported=2]="NotSupported",e[e.Supported=3]="Supported"}(i||(i={}))},3003:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"Message:#Exchange"},e)}n.d(t,"a",(function(){return r}))},3029:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(30);function c(){return Object(r.a)().SessionSettings.IsSubstrateSearchServiceAvailable}},3185:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"SetItemField:#Exchange"},e)}n.d(t,"a",(function(){return r}))},3186:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"ItemChange:#Exchange"},e)}n.d(t,"a",(function(){return r}))},3257:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(30);function c(){const e=Object(r.a)().PolicySettings;return e?{OutboundCharset:e.OutboundCharset,UseGB18030:e.UseGB18030,UseISO885915:e.UseISO885915}:{OutboundCharset:"AutoDetect"}}},3269:function(e,t,n){"use strict";var r=n(20),c=n(3527),i=n(2764),o=n(2866),a=n(3493),s=n(3361),u=n(3496),l=(n(3428),n(3858)),d=n(3859);function b(e){return Object(d.a)()||Object(l.a)()||Object(i.e)().isUnread||Object(i.e)().isToMe||Object(i.e)().isFlagged||Object(i.e)().isMentioned||!!(null==e?void 0:e.viewFilter)&&"All"!==(null==e?void 0:e.viewFilter)}var f=n(2839);n.d(t,"a",(function(){return h})),n.d(t,"l",(function(){return p})),n.d(t,"b",(function(){return c.b})),n.d(t,"q",(function(){return i.c})),n.d(t,"g",(function(){return i.e})),n.d(t,"e",(function(){return o.a})),n.d(t,"s",(function(){return o.g})),n.d(t,"r",(function(){return o.e})),n.d(t,"f",(function(){return a.a})),n.d(t,"h",(function(){return s.a})),n.d(t,"i",(function(){return u.a})),n.d(t,"j",(function(){return b})),n.d(t,"m",(function(){return f.j})),n.d(t,"d",(function(){return f.d})),n.d(t,"c",(function(){return f.c})),n.d(t,"n",(function(){return f.k})),n.d(t,"o",(function(){return f.l})),n.d(t,"p",(function(){return f.n})),n.d(t,"k",(function(){return f.h}));const g=new r.c(()=>Promise.all([n.e(0),n.e(5),n.e(6),n.e(7),n.e(8),n.e(9),n.e(13),n.e(15),n.e(20),n.e(18),n.e(21),n.e(24),n.e(25),n.e(27),n.e(28),n.e(29),n.e(32),n.e(34),n.e(35),n.e(38),n.e(39),n.e(40),n.e(43),n.e(50),n.e(478)]).then(n.bind(null,4801))),h=Object(r.d)(g,e=>e.AnswersContainer);let p=new r.a(g,e=>e.initializeAndWarmupAnswers)},3355:function(e,t,n){"use strict";var r=n(35);function c(e,t){var n;return void 0===e||e.__type||(n=e,e=Object.assign({__type:"UpdateItemJsonRequest:#Exchange"},n)),Object(r.a)("UpdateItem",e,t)}n.d(t,"a",(function(){return c}))},3361:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));var r=n(25),c=n(3029),i=n(550);function o(){return Object(c.a)()&&(Object(r.k)("sea-fetchPeople3")||Object(r.k)("sea-fetchEvents2")||Object(r.k)("sea-calendarTriggerControl2")||Object(r.k)("sea-fetchFlights2")||Object(r.k)("sea-flightTriggerControl2")||Object(r.k)("sea-fetchFiles4")||Object(r.k)("sea-fileTriggerControl4")||Object(r.k)("sea-peopleTriggerControl3")||Object(r.k)("sea-answers-sdf")||Object(r.k)("sea-answers-ms"))||Object(c.a)()&&Object(i.a)()&&(Object(r.k)("sea-fetchBookmarks2")||Object(r.k)("sea-bookmarkTriggerControl2")||Object(r.k)("sea-fetchAcronyms3")||Object(r.k)("sea-fetchLinks2")||Object(r.k)("sea-linkTriggerControl2")||Object(r.k)("sea-acronymTriggerControl3")||Object(r.k)("sea-answers-sdf")||Object(r.k)("sea-answers-ms"))}function a(){return o()&&Object(r.k)("sea-v23sQueryApi2")&&Object(r.k)("sea-single3sQueryCallForAnswersAndSerp")}},3366:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"UpdateItemRequest:#Exchange"},e)}n.d(t,"a",(function(){return r}))},3428:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2764),c=n(25),i=n(3029),o=n(52);function a(){const{staticSearchScope:e}=Object(r.e)(),t=null==e?void 0:e.kind;return"SharedFolders"===t||"PublicFolder"===t?"FindItem":Object(o.g)().SessionSettings.IsExplicitLogon?"ArchiveMailbox"===t?"FindItem":Object(c.k)("sea-3s-explicitLogon")&&"PrimaryMailbox"===t&&Object(i.a)()?"SubstrateSearch":"ExecuteSearch":"PrimaryMailbox"===t?Object(i.a)()?Object(c.k)("sea-v23sQueryApi2")&&!Object(c.k)("sea-v13sQueryApiHoldback")?"SubstrateSearchV2":"SubstrateSearch":"ExecuteSearch":"ArchiveMailbox"===t?Object(c.k)("sea-archive-mailbox-3S-2")&&Object(i.a)()?"SubstrateSearch":"ExecuteSearch":"Group"===t?"ExecuteSearch":null}},3493:function(e,t,n){"use strict";function r(e){const t=e.tableQuery;if(0===t.type)return t.folderId;if(function(e){if(1!=e.type)return!1;const t=e.searchScope;return["PrimaryMailbox","ArchiveMailbox","SharedFolders"].indexOf(t.kind)>-1}(t)){return t.searchScope.folderId}return null}n.d(t,"a",(function(){return r}))},3496:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(25);function c(){return Object(r.k)("sea-interactiveFiltersAll")||Object(r.k)("sea-interactiveFiltersUnreadTime")}},3527:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return i}));var r=n(2874);const c=[r.c.File,r.c.People,r.c.Keywords],i=[r.c.File,r.c.People,r.c.Keywords,r.c.Message,r.c.Event,r.c.Category,r.c.TrySuggestion,r.c.Setting]},3720:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"DeleteItemField:#Exchange"},e)}n.d(t,"a",(function(){return r}))},3806:function(e,t,n){"use strict";function r(){return{selectedSearchScope:null,subjectFieldText:"",keywordsFieldText:"",fromDate:null,toDate:null,hasAttachments:null,fromPeopleSuggestions:[],toPeopleSuggestions:[],ccPeopleSuggestions:[]}}n.d(t,"a",(function(){return r}))},3807:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=10},3858:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2764);function c(){return null!==Object(r.e)().fromDate||null!==Object(r.e)().toDate}},3859:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2764);function c(){return Object(r.e)().includeAttachments}},3869:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"ApplyConversationActionRequest:#Exchange"},e)}n.d(t,"a",(function(){return r}))},3870:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"ConversationAction:#Exchange"},e)}n.d(t,"a",(function(){return r}))},391:function(e,t,n){"use strict";function r(e,t){return e?Object.assign({mailboxInfo:e},t):null!=t?t:void 0}n.d(t,"a",(function(){return r}))},3956:function(e,t,n){"use strict";var r=n(35);function c(e,t){var n;return void 0===e||e.__type||(n=e,e=Object.assign({__type:"ApplyConversationActionJsonRequest:#Exchange"},n)),Object(r.a)("ApplyConversationAction",e,t)}n.d(t,"a",(function(){return c}))},4370:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return a}));const r="ArchivePolicyParentRow",c="DeletePolicyParentRow",i="FolderArchiveTag",o="FolderPolicyTag",a="none"},4486:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"SetFolderField:#Exchange"},e)}n.d(t,"a",(function(){return r}))},4844:function(e){e.exports=JSON.parse('{"a":"fHa"}')},4994:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return s}));var r=n(2);const c=Object(r.action)("ON_ARCHIVE_TAG_FOR_FOLDER_UPDATE_SUCCESS",(e,t)=>({folder:e,archiveTag:t})),i=Object(r.action)("ON_DELETE_TAG_FOR_FOLDER_UPDATE_SUCCESS",(e,t)=>({folder:e,deleteTag:t})),o=Object(r.action)("ON_RETENTION_TAG_FOR_ITEMS_UPDATE_SUCCESS",(e,t,n)=>({tag:e,isArchiveTag:t,itemIds:n})),a=Object(r.action)("ON_RETENTION_TAG_FOR_ITEMS_CHANGED",(e,t,n,r,c)=>({isArchiveTag:e,tagValue:t,itemIds:n,actionSource:r,mailboxInfo:c})),s=Object(r.action)("ON_RETENTION_TAG_FOR_CONVERSATIONS_CHANGED",(e,t,n,r,c,i,o)=>({isArchiveTag:e,tagValue:t,folderId:n,conversationActionContexts:r,itemIds:c,actionSource:i,mailboxInfo:o}))},5141:function(e,t,n){"use strict";n.d(t,"b",(function(){return i}));var r=n(2);const c={showPeoplePickerDialog:!1,retentionPolicyTags:new(n(13).ObservableMap)({})},i=Object(r.createStore)("sharedFolderState",c),o=i();t.a=o},5191:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"Folder:#Exchange"},e)}n.d(t,"a",(function(){return r}))},5556:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(5141);function c(e){const t=Object(r.b)().retentionPolicyTags;return e&&t.has(e)?t.get(e):[]}},7015:function(e,t,n){"use strict";function r(e,t){return e.RetentionPeriod&&t.RetentionPeriod?e.RetentionPeriod-t.RetentionPeriod:t.RetentionPeriod?1:-1}n.d(t,"a",(function(){return r}))},7016:function(e,t,n){"use strict";function r(e){switch(e){case"msgfolderroot":case"archivemsgfolderroot":return 12;case"deleteditems":case"archivedeleteditems":return 3;case"recoverableitemsdeletions":case"archiverecoverableitemsdeletions":return 18;case"calendar":return 1;case"contacts":return 2;case"conversationhistory":return 16;case"drafts":return 4;case"inbox":return 5;case"junkemail":return 6;case"journal":return 7;case"notes":return 8;case"outbox":return 9;case"sentitems":return 10;case"syncissues":return 15;case"tasks":return 11;case"none":default:return 17}}n.d(t,"a",(function(){return r}))},7017:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2790),c=n(30);function i(e){return(!e||!Object(r.e)(e.tableQuery))&&!!Object(c.a)().SessionSettings.HasArchive}},7018:function(e,t,n){"use strict";function r(e){const t={},n=e.filter(e=>null==e.ParentLabelIdentity||e.ParentLabelIdentity.length<=0).reduce((e,n)=>{const r={parentPolicyTag:n,childrenPolicyTags:[]};return e.push(r),t[n.RetentionId]=r,e},[]);return e.filter(e=>null!=e.ParentLabelIdentity&&e.ParentLabelIdentity.length>0&&e.ParentLabelIdentity in t).forEach(e=>{t[e.ParentLabelIdentity].childrenPolicyTags.push(e)}),n}n.d(t,"a",(function(){return r}))},7019:function(e){e.exports=JSON.parse('{"a":"Wzc","b":"Xzc","c":"Yzc"}')},7020:function(e){e.exports=JSON.parse('{"a":"Vzc"}')},7021:function(e){e.exports=JSON.parse('{"a":"Uzc"}')},7022:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2790),c=n(30),i=n(5556);function o(e,t,n){if(e&&Object(r.e)(e.tableQuery)){const t=r.i.tryImportForRender();return t?t(e.tableQuery):[]}return"SharedMailbox"===t?Object(i.a)(n):Object(c.a)().RetentionPolicyTags}},7023:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2790),c=n(3269),i=n(2737);function o(e){let t,n,o;if(e&&Object(r.e)(e.tableQuery))t=null,n="GroupMailbox";else{const r=Object(c.f)(e),a=r&&Object(i.m)().get(r);if(!a)return null;t=a.DistinguishedFolderId||a.FolderId.Id,n=a.mailboxInfo.type,o=a.mailboxInfo.mailboxSmtpAddress}return{folderId:t,mailboxType:n,principalSMTPAddress:o}}},7513:function(e,t,n){"use strict";var r=n(2733),c=n(2827);var i=n(4370),o=n(4994);function a(e,t,n,a,s,u){const l=r.Z.selectedTableViewId,d=r.Z.tableViews.get(l);if(!function(e){const{retentionTag:t,retentionId:n,inheritSubMenuIdentifier:r}=e;return!!t&&n!=t.Value||!t&&n!=r}({retentionTag:n,retentionId:e,inheritSubMenuIdentifier:t?i.a:i.c}))return;const b="RPCSAOverflow"==u||1===d.tableQuery.listViewType,f=[...d.selectedRowKeys.keys()],g=Object(c.b)(d);if(b){const n="RPCSAOverflow"==u?[null==s?void 0:s.ItemId.Id]:f.map(e=>Object(r.N)(e,d.id).clientId.Id);Object(o.d)(t,e,n,u,g)}else{const n=f.map(e=>Object(r.j)(e,d.id)),c=f.reduce((e,t)=>{const n=Object(r.M)(t,d.id);return n&&e.push(...n.itemIds),e},[]);Object(o.c)(t,e,a,n,c,u,g)}}n.d(t,"a",(function(){return a}))},9020:function(e,t,n){"use strict";n.r(t);var r=n(2);const c=Object(r.action)("ON_ARCHIVE_TAG_FOR_FOLDER_CHANGED",(e,t,n)=>({folder:e,tagValue:t,actionSource:n})),i=Object(r.action)("ON_DELETE_TAG_FOR_FOLDER_CHANGED",(e,t,n)=>({folder:e,tagValue:t,actionSource:n}));var o=n(4994),a=n(2737),s=n(4486);var u=n(1085),l=n(5191),d=n(4370),b=n(2827);function f(e,t,n){const r=Object(a.q)(e),c={Path:Object(u.a)({FieldURI:t}),Folder:n?t===d.b?Object(l.a)({ArchiveTag:n}):Object(l.a)({PolicyTag:n}):null},i=[n?Object(s.a)(c):(o=c,Object.assign({__type:"DeleteFolderField:#Exchange"},o))];var o;return a.M.importAndExecute(r.Id,i,Object(b.c)(e))}var g=n(22),h=n(68);function p(e){const{isArchiveTag:t,actionSource:n,responseClass:r}=e;Object(h.p)("TnS_RetentionPolicySelected",[t,n,r])}function O(e){const{folder:t,retentionId:n,inheritSubMenuIdentifier:r}=e,c=r===d.a?t.ArchiveTag:t.PolicyTag;return!!c&&n!=c.Value||!c&&n!=r}Object(r.orchestrator)(c,async e=>{const{folder:t,tagValue:n,actionSource:r}=e;if(O({folder:t,retentionId:n,inheritSubMenuIdentifier:d.a}))try{const e=n===d.a?null:{Value:n,IsExplicit:!0},c=t.DistinguishedFolderId||t.FolderId.Id,i=await f(c,d.b,e);"Success"===i.ResponseClass&&Object(o.a)(t,e),p({isArchiveTag:!0,actionSource:r,responseClass:i.ResponseClass})}catch(e){g.d("Error while updating folder archive tag"+e)}}),Object(r.orchestrator)(i,async e=>{const{folder:t,tagValue:n,actionSource:r}=e;if(O({folder:t,retentionId:n,inheritSubMenuIdentifier:d.c}))try{const e=n===d.c?null:{Value:n,IsExplicit:!0},c=t.DistinguishedFolderId||t.FolderId.Id,i=await f(c,d.d,e);"Success"===i.ResponseClass&&Object(o.b)(t,e),p({isArchiveTag:!1,actionSource:r,responseClass:i.ResponseClass})}catch(e){g.d("Error while updating folder delete tag"+e)}});var v=n(3186),y=n(381),j=n(3355),S=n(3366),m=n(167),I=n(3003),T=n(3185),A=n(3720),C=n(3257);function k(e,t,n,r){const c=function(e,t,n){const r=t?"ItemArchiveTag":"ItemPolicyTag",c=t?"ArchiveTag":"PolicyTag",i=[n?Object(T.a)({Path:Object(u.a)({FieldURI:r}),Item:Object(I.a)({[c]:n})}):Object(A.a)({Path:Object(u.a)({FieldURI:r})})],o=[];return e.forEach(e=>o.push(Object(v.a)({Updates:i,ItemId:Object(y.a)({Id:e})}))),Object(S.a)(Object.assign({ItemChanges:o,ConflictResolution:"AlwaysOverwrite",MessageDisposition:"SaveOnly",SuppressReadReceipts:!1,ClientSupportsIrm:!0,SendCalendarInvitationsOrCancellations:"SendToNone"},Object(C.a)()))}(e,t,n);return Object(j.a)({Header:Object(m.b)(),Body:c},r).then(e=>e.Body.ResponseMessages.Items[0])}var P=n(391),x=n(2742),_=(Object(r.orchestrator)(o.d,async e=>{try{const{isArchiveTag:t,tagValue:n,itemIds:r,actionSource:c,mailboxInfo:i}=e,a=n===d.a||n===d.c?null:{Value:n,IsExplicit:!0};r.map(e=>{var t;const n=x.u.items.get(e);return null===(t=null==n?void 0:n.ConversationId)||void 0===t?void 0:t.Id}).forEach(e=>{const t=x.u.conversations.get(e);t&&(t.syncState=null)});const s=await k(r,t,a,Object(P.a)(i));"Success"==s.ResponseClass&&Object(o.e)(a,t,r),p({isArchiveTag:t,actionSource:c,responseClass:s.ResponseClass})}catch(e){g.d("Error while updating item retention tag "+e)}}),n(3869)),w=n(3870),E=n(1089),F=n(1431),R=n(710),M=n(9571),D=n(1084);function N(e,t,n,r,c){const i=function(e,t,n,r){const c=e.map(e=>(function(e,t,n,r){const c=Object(w.a)({Action:"SetRetentionPolicy",ConversationId:Object(y.a)({Id:e.conversationId}),RetentionPolicyType:n});t&&(c.RetentionPolicyTagId=t);if(r){const e=Object(E.a)({BaseFolderId:(i=r,Object(D.a)(i)?Object(F.a)({Id:i}):Object(R.a)({Id:i}))});c.ContextFolderId=e}var i;return c})(e,t,n,r));return Object(_.a)({ConversationActions:c,ReturnMovedItemIds:!1})}(e,t,n,r);return Object(M.a)(i)}Object(r.orchestrator)(o.c,async e=>{try{const{isArchiveTag:t,tagValue:n,folderId:r,conversationActionContexts:c,itemIds:i,actionSource:a,mailboxInfo:s}=e,u=t?1:0,l=n===d.a||n===d.c,b=l?null:n;c.map(e=>null==e?void 0:e.conversationId).forEach(e=>{const t=x.u.conversations.get(e);t&&(t.syncState=null)});const f=await N(c,b,u,r,Object(P.a)(s));if("Success"==f.ResponseClass){const e=l?null:{Value:n,IsExplicit:!0};Object(o.e)(e,t,i)}p({isArchiveTag:t,actionSource:a,responseClass:f.ResponseClass})}catch(e){g.d("Error while updating conversation retention tag"+e)}});Object(r.mutator)(o.a,e=>{const{folder:t,archiveTag:n}=e;t.ArchiveTag=n}),Object(r.mutator)(o.b,e=>{const{folder:t,deleteTag:n}=e;t.PolicyTag=n}),Object(r.mutator)(o.e,e=>{const{itemIds:t,tag:n,isArchiveTag:r}=e;t.forEach(e=>{const t=x.u.items.get(e);t&&(r?t.ArchiveTag=n:t.PolicyTag=n)})});var L=n(2733),U=n(7016),V=n(7020),H=n(6),G=n(134),Q=n(10971),z=n.n(Q);function B(e){const{retentionId:t,displayName:n,isChecked:r,subMenuProps:c,onClickCallback:i}=e;return{key:t,text:n,data:t,onClick:i,checked:r,itemProps:r?{styles:{label:z.a.checkedItem}}:null,iconProps:r?{iconName:"CheckMark",className:z.a.checkmark}:null,subMenuProps:c}}var q=n(7019);function J(e){const{retentionId:t,retentionPolicyTags:n,folderType:r,isArchive:c,isChecked:i,onClickCallback:o}=e,a=function(e,t){return 12==e?t?Object(H.b)(q.a):Object(H.b)(q.b):Object(H.b)(q.c)}(r,c);return B({retentionId:t,displayName:17!=r?function(e){const{retentionPolicyTags:t,folderType:n,isArchive:r,defaultName:c}=e;return t.reduce((e,t)=>t.Type===n&&t.IsArchive==r?t.DisplayName:e,c)}({retentionPolicyTags:n,folderType:r,isArchive:c,defaultName:a}):a,isChecked:i,subMenuProps:null,onClickCallback:o})}function K(e,t,n,r,c){let i=!1;return(12==r?[]:e.map(e=>{const r=e.RetentionId===n;return r&&(i=!0),B({retentionId:e.RetentionId,displayName:e.DisplayName,isChecked:t&&r,subMenuProps:null,onClickCallback:c})})).concat(J({retentionId:d.a,retentionPolicyTags:e,folderType:r,isArchive:!0,isChecked:t&&!i,onClickCallback:c}))}var W=n(7021);var X=n(7018);function Y(e,t,n,r,c,i){let o=!1;return(17!=r||"archive"===c?[]:Object(X.a)(e).map(e=>{const r=function(e,t,n,r){const{parentPolicyTag:c,childrenPolicyTags:i}=e,o=c.RetentionId===n;if(null==i||0==i.length)return{item:B({retentionId:c.RetentionId,displayName:c.DisplayName,isChecked:t&&o,subMenuProps:null,onClickCallback:r}),policyFound:o};let a=!1;const s=i.map(e=>{const c=e.RetentionId===n;return c&&(a=!0),B({retentionId:e.RetentionId,displayName:e.DisplayName,isChecked:t&&c,subMenuProps:null,onClickCallback:r})});return{item:B({retentionId:c.RetentionId,displayName:c.DisplayName,isChecked:t&&o,subMenuProps:{items:s},onClickCallback:null}),policyFound:a}}(e,t,n,i);return r.policyFound&&(o=!0),r.item})).concat(J({retentionId:d.c,retentionPolicyTags:e,folderType:r,isArchive:!1,isChecked:t&&!o,onClickCallback:i}))}var Z=n(7015);function $(e){const{retentionPolicyTagList:t,showTagSelection:n,selectedArchiveTag:r,selectedDeleteTag:c,mailboxType:i,distinguishedFolderId:o,hasArchive:a,onArchivePolicyClickedCallback:s,onDeletePolicyClickedCallback:u}=e,l=[],d=a&&"ArchiveMailbox"!=i,b=Object(U.a)(o),f=t.filter(e=>e.IsVisible&&e.IsArchive).sort(Z.a),g=t.filter(e=>e.IsVisible&&!e.IsArchive).sort(Z.a);return d&&l.push(...function(e,t,n,r,c){const i=(null==n?void 0:n.IsExplicit)?n.Value:null;return[{key:"archiveSection",className:z.a.sectionHeader,itemType:G.a.Section,sectionProps:{bottomDivider:!0,title:Object(H.b)(V.a),items:K(e,t,i,r,c)}}]}(f,n,r,b,s)),l.push(...function(e,t,n,r,c,i){const o=(null==n?void 0:n.IsExplicit)?n.Value:null;return[{key:"deleteSection",className:z.a.sectionHeader,itemType:G.a.Section,sectionProps:{title:Object(H.b)(W.a),items:Y(e,t,o,r,c,i)}}]}(g,n,c,b,o,u)),{items:l}}var ee=n(7023),te=n(7022),ne=n(7017),re=n(7513);function ce(e,t,n){const r=L.Z.tableViews.get(e);if(!r)return null;const c=Object(ee.a)(r);if(!c)return null;const i=Object(te.a)(r,c.mailboxType,c.principalSMTPAddress);if(!i)return null;const o=[...r.selectedRowKeys.keys()];let a,s,u;return n?(a=n.ArchiveTag,s=n.PolicyTag,u=!0):(a=1==o.length?L.b.getArchiveTag(o[0],r):null,s=1==o.length?L.b.getPolicyTag(o[0],r):null,u=1==o.length),$({retentionPolicyTagList:i,showTagSelection:u,selectedArchiveTag:a,selectedDeleteTag:s,mailboxType:c.mailboxType,distinguishedFolderId:d.e,hasArchive:Object(ne.a)(r),onArchivePolicyClickedCallback:ie(!0,a,c.folderId,n,t),onDeletePolicyClickedCallback:ie(!1,s,c.folderId,n,t)})}function ie(e,t,n,r,c){return(i,o)=>{Object(re.a)(o.data,e,t,n,r,c)}}var oe=n(4844),ae=n(30),se=n(220),ue=n(5556);function le(e){if(Object(se.a)())return null;const t=Object(ae.a)();let n;return n="SharedMailbox"===e.mailboxType?Object(ue.a)(e.principalSMTPAddress):t.RetentionPolicyTags,n&&0!==n.length?{key:"AssignPolicy",name:Object(H.b)(oe.a),disabled:!1,subMenuProps:$(Object.assign(Object.assign({},e),{showTagSelection:!0,retentionPolicyTagList:n,hasArchive:!!t.SessionSettings.HasArchive}))}:null}n.d(t,"getAssignPolicyPropertiesForMailContextMenu",(function(){return ce})),n.d(t,"onArchiveTagForFolderChanged",(function(){return c})),n.d(t,"onDeleteTagForFolderChanged",(function(){return i})),n.d(t,"getRetentionPolicyMenuItem",(function(){return le}))},9571:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(167),c=n(3956);function i(e,t=Object(r.b)(),n){if(!e||!e.ConversationActions||0===e.ConversationActions.length)throw new Error("ApplyConversationAction requestBody is invalid!");n=n||{};const i=Object.assign({},n),o=i.headers?new Headers(i.headers):new Headers;return o.set("X-OWA-ActionSource","ApplyConversationAction_"+e.ConversationActions[0].Action),i.headers=o,Object(c.a)({Header:t,Body:e},i).then(e=>e.Body.ResponseMessages.Items[0]).catch(e=>Promise.reject(e))}}}]);
//# sourceMappingURL=owa.662.js.map
self.scriptsLoaded['owa.662.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.662.js'] = (new Date()).getTime();