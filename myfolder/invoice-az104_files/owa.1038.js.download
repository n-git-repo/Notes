self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.1038.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[1038],{10414:function(e,t,n){"use strict";t.a=function(e){if(null==e||""==e)return Promise.resolve("");let t=new Request(e);return t.headers.append("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),t.headers.append("Accept","application/x-www-form-urlencoded; charset=UTF-8"),fetch(t).then((function(e){return e.text()}))}},1200:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(13),o=n(933),a=n(137);t.default=function(e,t,n,i){a.getGlobalContext().legacyInDispatch++,r.action(t||"(anonymous action)",o.dispatchWithMiddleware.bind(null,e,t,n,i))(),a.getGlobalContext().legacyInDispatch--}},1201:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(755),o=n(137);function a(e,t){var n={};return Object.keys(e).forEach((function(r){void 0===n[r]&&Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[r].apply(null,t)}})})),Object.freeze(n),n}t.default=function(e){return function(t){if(o.getGlobalContext().legacyTestMode)return t;var n=this,i=t.length-1,c=r.getOriginalTarget(t);c&&(i=c.length-1);var l=function(){var r=a(e,arguments),o=Array.prototype.slice.call(arguments);if(void 0===o[i]){for(var c=o.length;c<i;c++)o[c]=void 0;o[i]=r}return t.apply(n,o)};return r.setActionType(l,r.getActionType(t)),l}}},1202:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(13),o=n(931),a=0,i=null;var c=[];function l(e){var t,n=e.object;switch(e.type){case"update":t=void 0!==e.index?{verify:function(){return n[e.index]===e.newValue},objectName:e.name,propertyName:e.index,undo:function(){n[e.index]=e.oldValue}}:void 0!==n.get?{verify:function(){return n.get(e.key)===e.newValue},objectName:e.name,propertyName:e.key,undo:function(){n.set(e.key,e.oldValue)}}:{verify:function(){return n[e.key]===e.newValue},objectName:e.name,propertyName:e.key,undo:function(){n[e.key]=e.oldValue}};break;case"splice":t={verify:function(){for(var t=0;t<e.addedCount;t++)if(n[e.index+t]!==e.added[t])return!1;return!0},objectName:e.name,propertyName:e.index,undo:function(){n.splice(e.index,e.addedCount);for(var t=0;t<e.removedCount;t++)n.splice(e.index+t,0,e.removed[t])}};break;case"add":t=void 0!==n.get?{verify:function(){return n.get(e.key)===e.newValue},objectName:e.name,propertyName:e.key,undo:function(){n.delete(e.key)}}:{verify:function(){return n[e.key]===e.newValue},objectName:e.name,propertyName:e.key,undo:function(){delete n[e.key]}};break;case"delete":t={verify:function(){return!n.has(e.key)},objectName:e.name,propertyName:e.key,undo:function(){n.set(e.key,e.oldValue)}};break;default:return}c.forEach((function(e){return e.steps.push(t)}))}function u(e,t,n){0===a&&(i=r.spy(l)),a++,c.push({steps:[]});try{var u=t(),d=c[c.length-1],f=!1;d.steps.reverse();var s=o.default("undo-"+e)((function(){if(f)throw"This instance of undo-"+e+" has already been executed";n&&d.steps.forEach((function(e){if(!e.verify())throw'Property "'+e.propertyName+' on store object "'+e.objectName+" changed since action was performed."})),d.steps.forEach((function(e){return e.undo()})),f=!0}));return s.actionReturnValue=u,s}finally{c.pop(),0==--a&&(i(),i=null)}}t.default=function(e,t){return function(n){return u(e,n,!!t)}}},1203:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(137);t.initializeTestMode=function(){r.getGlobalContext().legacyTestMode=!0},t.resetTestMode=function(){r.getGlobalContext().legacyTestMode=!1}},19959:function(e,t,n){"use strict";n.r(t);var r=n(598),o=n(6),a=n(242),i=n(155),c=n(22);let l="ows/v1.0/CalendarIcons/?AssetType=svg&Lang=",u=2,d=null;var f=n(358);function s(e){let t={IconId:e.iconId,Name:e.name,LocalizedName:e.locName,SvgFile:e.svgFile,Keywords:[],IsInDefaultSet:e.isInDefaultSet,SvgHtmlText:""};if(null!=e.keywords)for(var n of e.keywords)t.Keywords.push(n);return t}var p=Object(f.action)("setCharmInfoInMap")((function(e,t={charmStore:r.a}){var n=t.charmStore;return new Promise(t=>{if(null==n||null==n.charmInfoMap||null==e||null==e.icons)return t();for(var r of e.icons){let e=s(r);n.charmInfoMap.set(r.iconId.toString(),e)}return t()})}));var v=Object(f.action)("setCharmKeywordsInMap")((function(e={charmStore:r.a}){var t=e.charmStore;return new Promise(e=>{if(null==t||null==t.keywordsMap||null==t.charmInfoMapMaxId)return e();if(t.keywordsMap.size>3)return e();for(var n=0;n<=t.charmInfoMapMaxId;n++){var r=t.charmInfoMap.get(n.toString());if(null!=r)for(var o of r.Keywords)if(!t.keywordsMap.has(o)){let e={Keyword:o,IconId:r.IconId};t.keywordsMap.set(o.toLocaleLowerCase(),e)}}return e()})}));let h=void 0;var y=Object(f.action)("loadCharmsCatalog")((function(e={charmStore:r.a}){var t=e.charmStore;return h||(h=new Promise(e=>{let n=function(){if(null!=d)return d;let e="";if(Object(a.a)(Object(o.e)())||(e=Object(o.e)().toLowerCase()),e.length<u)return c.d(`[getCalendarIconsFromService] Failed to get locale, got: ${e}.`),null;let t=l+e;return d=new Promise(n=>{Object(i.b)(t).then(t=>null!=t?(c.h.info(`[getCalendarIconsFromService] Got response for locale: ${e}.`),n(t)):(c.d(`[getCalendarIconsFromService] Failed to get response for locale: ${e}.`),n(null)))}),d}();null!=n&&n.then(e=>null!=e&&null!=e.icons&&e.icons.length>0?(p(e),t.charmInfoMapMaxId=function(e){let t=0;for(var n of e)t<n.iconId&&(t=n.iconId);return t}(e.icons),v(),void c.h.info("[loadCharmsCatalog] Loaded charms catalog into the charms store.")):(h=void 0,void c.h.info("[loadCharmsCatalog] Failed to load charms from service. Continuing without charms."))).then(()=>e())}),h)}));var m=n(10414),g=n(2);const w=Object(g.mutatorAction)("setSvgHtmlText",(e,t)=>{e.SvgHtmlText=t}),I=Object(g.mutatorAction)("addCharmInfo",e=>{r.a.charmInfoMap.set(e.IconId.toString(),e)});var b=async function(e){if(null==e||null==r.a||null==r.a.charmInfoMapMaxId)return;let t=r.a.charmInfoMap.get(e.toString());null==t||null!=t.SvgHtmlText&&""!=t.SvgHtmlText||(await Object(m.a)(t.SvgFile).then((function(e){w(t,e)})),c.h.info("[setCharmInfoWithUpdatedSvgText] complete, iconId: "+t.IconId),I(t))};n.d(t,"loadCharmsCatalog",(function(){return y})),n.d(t,"loadCharmSvgTextInMap",(function(){return b}))},358:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(933);t.legacyApplyMiddleware=r.default;var o=n(931);t.action=o.default;var a=n(1201);t.select=a.default;var i=n(1202);t.createUndo=i.default;var c=n(755);t.getActionType=c.getActionType;var l=n(1203);t.initializeTestMode=l.initializeTestMode,t.resetTestMode=l.resetTestMode},755:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setOriginalTarget=function(e,t){e.__SATCHELJS_ORIGINAL_TARGET=t},t.getOriginalTarget=function(e){if(void 0!==e.__SATCHELJS_ORIGINAL_TARGET)return e.__SATCHELJS_ORIGINAL_TARGET},t.setActionType=function(e,t){e.__SATCHELJS_ACTION_TYPE=t},t.getActionType=function(e){return e.__SATCHELJS_ACTION_TYPE}},931:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1200),o=n(755);function a(e,t,n){var a=function(){var o,a=this,i=arguments;return r.default((function(){return o=e.apply(a,i)}),t,arguments,n),o};return o.setOriginalTarget(a,e),o.setActionType(a,t),a}function i(e,t,n,r,o){if(!n||"function"!=typeof n.value)throw new Error("The @action decorator can only apply to class methods.");n.value=a(n.value,r,o)}t.default=function(e,t){return function(n,r,o){if(1==arguments.length&&"function"==typeof n)return a(n,e,t);i(n,r,o,e,t)}}},933:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(137);function o(e,t){return e.bind(null,t)}function a(e,t,n,r){return e()}t.default=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=a,i=e.length-1;i>=0;i--)n=o(e[i],n);r.getGlobalContext().legacyDispatchWithMiddleware=n},t.dispatchWithMiddleware=function(e,t,n,o){r.getGlobalContext().legacyDispatchWithMiddleware||(r.getGlobalContext().legacyDispatchWithMiddleware=a),r.getGlobalContext().legacyDispatchWithMiddleware(e,t,n,o)}}}]);
//# sourceMappingURL=owa.1038.js.map
self.scriptsLoaded['owa.1038.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.1038.js'] = (new Date()).getTime();