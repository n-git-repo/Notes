self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.614.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[614,2148],{11014:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2844),i=n(4029);function o(){const e=Object(i.a)();return Object(r.c)(e)}},1448:function(e,t,n){"use strict";var r=n(165),i=n(121),o=function(){return i.a.Date.now()},c=n(716),a="Expected a function",u=Math.max,s=Math.min;t.a=function(e,t,n){var i,d,l,f,g,m,p=0,b=!1,I=!1,h=!0;if("function"!=typeof e)throw new TypeError(a);function v(t){var n=i,r=d;return i=d=void 0,p=t,f=e.apply(r,n)}function O(e){var n=e-m;return void 0===m||n>=t||n<0||I&&e-p>=l}function w(){var e=o();if(O(e))return y(e);g=setTimeout(w,function(e){var n=t-(e-m);return I?s(n,l-(e-p)):n}(e))}function y(e){return g=void 0,h&&i?v(e):(i=d=void 0,f)}function S(){var e=o(),n=O(e);if(i=arguments,d=this,m=e,n){if(void 0===g)return function(e){return p=e,g=setTimeout(w,t),b?v(e):f}(m);if(I)return clearTimeout(g),g=setTimeout(w,t),v(m)}return void 0===g&&(g=setTimeout(w,t)),f}return t=Object(c.a)(t)||0,Object(r.a)(n)&&(b=!!n.leading,l=(I="maxWait"in n)?u(Object(c.a)(n.maxWait)||0,t):l,h="trailing"in n?!!n.trailing:h),S.cancel=function(){void 0!==g&&clearTimeout(g),p=0,i=m=d=g=void 0},S.flush=function(){return void 0===g?f:y(o())},S}},15652:function(e){e.exports=JSON.parse('{"g":"Etc","a":"Ftc","b":"Gtc","c":"Htc","e":"Itc","j":"Jtc","d":"Ktc","f":"Ltc","h":"Mtc","i":"Ntc"}')},159:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c}));const r=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function i(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function o(){return i()+i()+"-"+i()+"-"+i()+"-"+i()+"-"+i()+i()+i()}function c(e){return r.test(e)}},180:function(e,t,n){"use strict";var r=n(22);let i;function o(){return null==i&&(i="undefined"!=typeof window&&null!=window.performance&&null!=window.performance.timing&&null!=window.performance.navigation&&null!=window.performance.getEntriesByName),i}const c=500,a=[],u=[],s=[],d=[];let l,f=!0;function g(e,t){Object(r.g)((e,t,n)=>{f&&(t==r.b.Error&&u.push({message:e,error:n}),a.push({message:e,level:t}))}),e(b),t(b),o()&&(window.performance.setResourceTimingBufferSize?window.performance.setResourceTimingBufferSize(c):window.performance.webkitSetResourceTimingBufferSize&&window.performance.webkitSetResourceTimingBufferSize(c))}function m(e,t,n){l?l(e,t,n):d.push({name:e,customData:t})}function p(e){return l=e,f=!1,{traces:a,errors:u,network:s,usage:d}}function b(){f&&s.push(arguments)}n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return p})),n.d(t,"d",(function(){return m})),n.d(t,"c",(function(){return o}))},181:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,i=!1;function o(t){r--,delete e[t]}this.put=function(t,n,i,c){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==c&&"function"!=typeof c)throw new Error("Cache timeout callback must be a function");var a=e[t];a?clearTimeout(a.timeout):r++;var u={value:n,expire:i+Date.now()};return isNaN(u.expire)||(u.timeout=setTimeout(function(){o(t),c&&c(t,n)}.bind(this),i)),e[t]=u,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&o(t),n},this.clear=function(){for(var o in e)clearTimeout(e[o].timeout);r=0,e=Object.create(null),i&&(t=0,n=0)},this.get=function(o){var c=e[o];if(void 0!==c){if(isNaN(c.expire)||c.expire>=Date.now())return i&&t++,c.value;i&&n++,r--,delete e[o]}else i&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){i=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),i=Date.now(),o=n&&n.skipDuplicates;for(var c in r)if(r.hasOwnProperty(c)){if(o)if(e[c])continue;var a=r[c],u=a.expire-i;if(u<=0){this.del(c);continue}u=u>0?u:void 0,this.put(c,a.value,u)}return this.size()}}e.exports=new r,e.exports.Cache=r},19728:function(e,t,n){"use strict";n.r(t);var r=n(2),i=Object(r.action)("onCacheUpdated",(e,t)=>({interactionType:e,triageContext:t})),o=Object(r.action)("onNudgedSpotlightItemRemoved",e=>({rowKey:e})),c=Object(r.action)("onSpotlightDismissedFromRP",e=>({rowKey:e}));const a=Object(r.action)("onSpotlightDismissedFromRPProcessed",e=>({rowKey:e}));var u,s=Object(r.action)("onSpotlightItemsFetched",(e,t,n)=>({spotlightItems:e,isConversationView:t,requestStartTime:n})),d=n(3289);!function(e){e[e.Unknown=0]="Unknown",e[e.Weak=1]="Weak",e[e.Strong=2]="Strong"}(u||(u={}));var l=e=>{switch(e){case"CreateRule":case"MarkAsRead":case"MarkAsReadImplicit":case"MarkAsUnread":case"Snooze":return u.Weak;case"Block":case"Categorize":case"Delete":case"Flag":case"FlagCleared":case"FlagComplete":case"Forward":case"Ignore":case"Like":case"MarkAsJunk":case"MarkAsPhishing":case"Move":case"Pin":case"Reaction":case"Reply":case"ReplyAll":case"ReportAbuse":case"Unpin":return u.Strong;default:return u.Unknown}},f=n(3452),g=n(68),m=n(2908),p=n(2842),b=n(30);const I=[],h=e=>{const{UserPuid:t,ExternalDirectoryTenantGuid:n}=Object(b.a)().SessionSettings;m.p.importAndExecute(p.c.ContextualInsights,t,n,Object(d.a)().logicalId,null,Object(f.a)(e).referenceId,"EntityClicked"),Object(g.p)("Spotlight_ItemClicked")},v=()=>{const{logicalId:e,requestStartTime:t,spotlightItems:n}=Object(d.a)();-1===I.indexOf(e)&&(I.push(e),m.m.importAndExecute(p.c.ContextualInsights,e,null,Date.now()-t),Object(g.p)("Spotlight_SetRendered",{hasSpotlightItems:n.length>0,logicalId:e}))};var O=n(3453),w=n(5),y=n(159),S=n(2733),j=n(9154),C=n(7);var T,A=n(11);!function(e){e[e.Acknowledged=0]="Acknowledged",e[e.Dismissed=1]="Dismissed"}(T||(T={}));const M=(e,t)=>{const n=x(e);for(const e of t)n.push(e);Object(A.e)(window,E(e),JSON.stringify(n))},k=e=>{const{spotlightCacheType:t,itemId:n,conversationId:r,rowKey:i}=e,o=x(t);for(const e of o)if(n&&e.itemId===n||r&&e.conversationId===r||i&&e.rowKey===i)return!0;return!1},R=(e,t)=>{const n=x(e),r=[];for(const e of n){const{itemId:n,conversationId:i,rowKey:o}=e;for(const e of t){const{itemId:t,conversationId:c,rowKey:a}=e;if(n&&n===t||i&&i===c||o&&o===a){r.push(e);break}}}Object(A.e)(window,E(e),JSON.stringify(r))},x=e=>{const t=Object(A.a)(window,E(e));return t?JSON.parse(t):[]},E=e=>e===T.Acknowledged?"acknowledgedSpotlightItems":"dismissedSpotlightItems";Object(r.mutator)(s,e=>{const{spotlightItems:t,isConversationView:n,requestStartTime:r}=e,i=P(),o=t.concat(i),c=[],a=o.concat(i).filter(e=>{const t=n?e.conversationId:e.itemId;return!(c.indexOf(t)>-1)&&(c.push(t),!0)});(e=>{R(T.Acknowledged,e),R(T.Dismissed,e)})(a);const u=a.filter(e=>!e.isDismissed);Object(d.a)().spotlightItems=u,Object(d.a)().logicalId=Object(y.a)(),Object(d.a)().requestStartTime=r,0===u.length&&v()}),Object(r.mutator)(a,e=>{const t=e.rowKey,n=Object(d.a)().spotlightItems;for(let e=0;e<n.length;e++){if(n[e].rowKey===t){n.splice(e,1);break}}}),Object(r.mutator)(i,e=>{if(!Object(O.a)())return;const{triageContext:t={},interactionType:n}=e;let{itemIds:r=[],conversationIds:i=[],rowKeys:o=[]}=t;if(r=r.filter(e=>!!e),i=i.filter(e=>!!e),o=o.filter(e=>!!e),0!==r.length||0!==i.length||0!==o.length)switch(l(n)){case u.Weak:F({itemIds:r,conversationIds:i,rowKeys:o,actionCategory:u.Weak});break;case u.Strong:F({itemIds:r,conversationIds:i,rowKeys:o,actionCategory:u.Strong});break;case u.Unknown:}}),Object(r.mutator)(j.a,()=>{Object(d.a)().spotlightItems=[]}),Object(r.mutator)(o,e=>{const{rowKey:t}=e,n=Object(d.a)().spotlightItems;for(let e=0;e<n.length;e++)if(n[e].rowKey===t){n.splice(e,1);break}});const F=e=>{const{itemIds:t,conversationIds:n,rowKeys:r,actionCategory:i}=e,o=Object(d.a)().spotlightItems;o.map((e,c)=>{(t.indexOf(e.itemId)>-1||n.indexOf(e.conversationId)>-1||r.indexOf(e.rowKey)>-1)&&(i===u.Weak?e.isAcknowledged=!0:i===u.Strong&&o.splice(c,1))})},P=()=>{const e=[],t=Object(C.c)("testSpotlight");if(t){const n=Object(S.I)(),r=parseInt(t);for(let t=0;t<r;t++){const r=n.rowKeys[t],i=S.b.getItemIds(r,n)[0],o=S.b.getConversationId(r,n);r&&e.push({rowKey:r,itemId:i,conversationId:o,isAcknowledged:k({spotlightCacheType:T.Acknowledged,itemId:i,conversationId:o,rowKey:r}),isDismissed:k({spotlightCacheType:T.Dismissed,itemId:i,conversationId:o,rowKey:r}),reason:0,senderName:S.b.getLastSenderMailbox(r,n).Name,referenceId:"00000000-0000-0000-0000-000000000000",dateTimeReceived:Object(w.Ub)(S.b.getLastDeliveryTimeStamp(r,n))})}}return e};var D=Object(r.action)("onSpotlightFilterLoaded",e=>({actionSource:e}));Object(r.mutator)(D,()=>{Object(d.a)().spotlightItems.map(e=>e.isAcknowledged=!0)});var K=n(3653),L=n(2844);function N(e){const{spotlightTableQuery:t}=Object(d.a)();t&&Object(K.a)([e],Object(L.c)(t),"Spotlight",!1)}var U=n(3441);Object(r.orchestrator)(U.h,e=>{const{nudgedRows:t}=e,n=Object(d.a)().spotlightItems;t.map(e=>{n.map(t=>{t.rowKey!==e.rowKey&&t.itemId!==e.itemId&&t.conversationId!==e.conversationId||(N(e.rowKey),o(e.rowKey))})})});var _=n(2954);function B(e){const{itemId:t,conversationId:n,rowKey:r}=e,i=Object(d.a)().spotlightItems.filter(e=>t&&e.itemId===t||n&&e.conversationId===n||r&&e.rowKey===r);return i.length>0?i[0]:null}Object(r.orchestrator)(c,e=>{const{rowKey:t}=e;M(T.Dismissed,[{rowKey:t}]);const{conversationId:n,itemId:r,referenceId:i}=Object(f.a)(t),o=Object(b.a)().SessionSettings;m.p.importAndExecute(_.b.ContextualInsights,o.UserPuid,o.ExternalDirectoryTenantGuid,Object(d.a)().logicalId,null,i,"SpotlightDismissed");const c=Object(S.I)();c&&Object(g.p)("Spotlight_ItemDismissed",{isImportantFilter:"spotlight"===c.tableQuery.scenarioType,conversationId:Object(S.R)(c)?n:null,itemId:Object(S.R)(c)?null:r}),N(t),a(t)}),Object(r.orchestrator)(D,e=>{Object(g.p)("Spotlight_FilterLoaded",[e.actionSource])});var G=n(3475);Object(r.orchestrator)(G.d,e=>{if(!Object(O.a)())return;const{triageContext:t={},interactionType:n}=e;let{itemIds:r=[],conversationIds:o=[],rowKeys:c=[]}=t;if(r=r.filter(e=>!!e),o=o.filter(e=>!!e),c=c.filter(e=>!!e),0===r.length&&0===o.length&&0===c.length)return;const a=[],s=l(n)===u.Strong?T.Dismissed:T.Acknowledged;r.map(e=>{const t=B({itemId:e});t&&!k({spotlightCacheType:s,itemId:e,rowKey:t.rowKey})&&(M(s,[{itemId:e,rowKey:t.rowKey}]),H(a,t.referenceId,n))}),o.map(e=>{const t=B({conversationId:e});t&&!k({spotlightCacheType:s,conversationId:e,rowKey:t.rowKey})&&(M(s,[{conversationId:e,rowKey:t.rowKey}]),H(a,t.referenceId,n))}),c.map(e=>{const t=B({rowKey:e});t&&!k({spotlightCacheType:s,rowKey:e})&&(M(s,[{rowKey:e}]),H(a,t.referenceId,n))}),i(n,t)}),Object(r.orchestrator)(D,()=>{V()});const V=()=>{const e=Object(d.a)().spotlightItems.map(e=>{const{itemId:t,conversationId:n,rowKey:r}=e;return{itemId:t,conversationId:n,rowKey:r}});M(T.Acknowledged,e)},H=(e,t,n)=>{t&&-1===e.indexOf(t)&&(((e,t)=>{if(!e)return;const{UserPuid:n,ExternalDirectoryTenantGuid:r}=Object(b.a)().SessionSettings;m.p.importAndExecute(p.c.ContextualInsights,n,r,Object(d.a)().logicalId,null,e,t),Object(g.p)("Spotlight_ItemInteraction",{interactionType:t})})(t,n),e.push(t))};function q(e,t){var n,r,i,o,c;return{Categories:e.Categories,ConversationId:e.ConversationId&&{Id:e.ConversationId.Id,ChangeKey:null},ConversationTopic:e.Subject,FlagStatus:null===(n=e.Flag)||void 0===n?void 0:n.FlagStatus,FolderId:e.ParentFolderId&&{Id:e.ParentFolderId.Id},From:e.From&&{Mailbox:{EmailAddress:e.From.EmailAddress.Address,Name:e.From.EmailAddress.Name,RoutingType:"SMTP"}},GlobalItemIds:[{Id:e.ItemId.Id,ChangeKey:null}],GlobalMessageCount:1,GlobalUnreadCount:e.IsRead?0:1,HasAttachments:e.HasAttachments,Hashtags:e.Hashtags,HasIrm:null,Importance:e.Importance,ItemClasses:e.ItemClasses||["IPM.Note"],ItemIds:[{Id:e.ItemId.Id,ChangeKey:null}],LastDeliveryOrRenewTime:e.DateTimeReceived,LastDeliveryTime:e.DateTimeReceived,LastModifiedTime:e.DateTimeLastModified,MessageCount:1,ParentFolderId:e.ParentFolderId&&{Id:e.ParentFolderId.Id},Preview:e.Preview,SenderSMTPAddress:null===(i=null===(r=e.Sender)||void 0===r?void 0:r.EmailAddress)||void 0===i?void 0:i.Address,UniqueSenders:[null===(c=null===(o=e.Sender)||void 0===o?void 0:o.EmailAddress)||void 0===c?void 0:c.Name],UnreadCount:e.IsRead?0:1,InstanceKey:t}}function z(e,t){var n;return{Categories:e.Categories,ConversationId:e.ConversationId&&{Id:e.ConversationId.Id,ChangeKey:null},ConversationIndex:e.ConversationIndex,DateTimeReceived:e.DateTimeReceived,DateTimeSent:e.DateTimeSent,LastModifiedTime:e.DateTimeLastModified,DisplayBcc:e.DisplayBcc,DisplayCc:e.DisplayCc,DisplayTo:e.DisplayTo,Flag:e.Flag&&{FlagStatus:e.Flag.FlagStatus,CompleteDate:e.Flag.CompleteDate,DueDate:e.Flag.DueDate,StartDate:e.Flag.StartDate},From:e.From&&{Mailbox:{EmailAddress:e.From.EmailAddress.Address,Name:e.From.EmailAddress.Name,RoutingType:"SMTP"}},HasAttachments:e.HasAttachments,Hashtags:e.Hashtags,Importance:e.Importance,IsDraft:e.IsDraft,IsRead:e.IsRead,ItemClass:e.ItemClass||"IPM.Note",ItemId:{Id:e.ItemId.Id,ChangeKey:e.ItemId.ChangeKey},ParentFolderId:e.ParentFolderId&&{Id:e.ParentFolderId.Id},Preview:e.Preview,Sender:e.Sender&&{Mailbox:{EmailAddress:e.Sender.EmailAddress.Address,Name:e.Sender.EmailAddress.Name,RoutingType:"SMTP"}},Sensitivity:e.Sensitivity,Subject:e.Subject,MentionedMe:null===(n=e.MentionsPreview)||void 0===n?void 0:n.IsMentioned,InstanceKey:t}}var Q=Object(r.mutatorAction)("onSpotlightRowsAppendedToTable",e=>{Object(d.a)().spotlightTableQuery=e}),W=n(317),J=n(3012),$=n(3115),X=n(3018),Y=n(25),Z=n(154),ee=n(168);const te=(e,t)=>{const n=Object(S.F)([e],t);return n.length>0?n[0]:null},ne=e=>{if(!e||0===e.length)return 0;for(const t of e)if(t.Id.indexOf("SpotlightReason")>-1)switch(t.Value){case"ActionRequired":return 1;case"AffectsSchedule":return 2;case"AtMentioned":return 4;case"ReplyRequired":return 8;case"NewMeetingCreated":return 64;case"UpcomingMeetingTimeChanged":return 128;case"MeetingCanceled":return 256;case"NewMeetingTimeProposed":return 512;case"UltraFocused":return 1024;case"ReplyToYourEmail":return 2048;default:return 0}return 0};var re=n(3615),ie=n(3684),oe=n(1084),ce=n(398),ae=n(483);const ue=async()=>{let[e,t]=Object(ce.getAccessTokenforResourceAsLazy)(window.location.origin,"OwaMailSpotlight");return e||(e=await t),e||""},se=(e,t,n)=>{const r={method:"POST"};r.headers=new Headers,r.headers.set("Authorization",`Bearer ${t}`),r.headers.set("Content-Type","application/json;charset=utf-8"),r.headers.set("X-Client-LocalTime",(new Date).toISOString()),r.headers.set("client-request-id",e);const i=Object(re.b)();i&&r.headers.append("X-AnchorMailbox",i);const o={EntityRequests:[{EntityType:"Message",Context:{EntityContext:[{"@type":"Microsoft.OutlookServices.MailFolder",id:Object(oe.a)("inbox")}]}}],Scenario:{Name:"ContextualInsights"}};return r.body=JSON.stringify(o),r};var de=async e=>{const t=await ue(),n=se(Object(y.a)(),t,Object(S.R)(e));return await fetch(Object(ae.v)("/search/api/v1/recommendations",Object(ie.a)()),n)},le=n(11014),fe=n(1448);let ge=null;const me=async e=>{const t=Object(le.a)(),n=new g.b("SpotlightService",{sessionSampleRate:20}),r=Date.now(),i=await de(t);n.end();const o=await async function(e,t,n,r){var i,o,c,a,u,s,d,l,f;const g=[],b=[],I=Object(S.R)(t),h=[],v=await e.json(),O=(null===(a=null===(c=null===(o=null===(i=null==v?void 0:v.EntitySets)||void 0===i?void 0:i[0])||void 0===o?void 0:o.ResultSets)||void 0===c?void 0:c[0])||void 0===a?void 0:a.Results)||[];m.k.importAndExecute(p.c.ContextualInsights,null===(u=null==v?void 0:v.Instrumentation)||void 0===u?void 0:u.TraceId,n.getData(W.a.e2eTimeElapsed),e.status);let y=!1,j=[];if(Object(Y.k)("fwk-immutable-ids")||Object(Z.a)("native")){const e=O.map(e=>{var t;return null===(t=e.Source.ItemId)||void 0===t?void 0:t.Id}),t=Object(ee.d)().userIdentity;Object(X.c)(e,t)&&(j=await Object($.b)(e,Object(X.b)(t),t,$.a.Spotlight),j.length===O.length&&(y=!0))}let C=0;for(const e of O){const n=null===(s=e.Source.ConversationId)||void 0===s?void 0:s.Id,r=y?j[C++]:null===(d=e.Source.ItemId)||void 0===d?void 0:d.Id,i=te(I?n:r,t);if(i){if(I){if(h.indexOf(n)>-1)continue;h.push(n)}Object(U.g)(i,t.id)||(k({spotlightCacheType:T.Dismissed,itemId:r,conversationId:n,rowKey:i})||(I?b.push(q(e.Source,i)):b.push(z(e.Source,i))),g.push({conversationId:n,itemId:r,rowKey:i,isAcknowledged:k({spotlightCacheType:T.Acknowledged,itemId:r,conversationId:n,rowKey:i}),isDismissed:k({spotlightCacheType:T.Dismissed,itemId:r,conversationId:n,rowKey:i}),reason:ne(e.Source.SingleValueExtendedProperties),senderName:null===(f=null===(l=e.Source.Sender)||void 0===l?void 0:l.EmailAddress)||void 0===f?void 0:f.Name,referenceId:e.ReferenceId,dateTimeReceived:Object(w.Ub)(e.DateTimeReceived),isTeachingMomentTarget:!1}))}}let A=null,M=null;for(let e=0;e<g.length;e++){const t=g[e];(!A||t.dateTimeReceived>A.dateTimeReceived)&&(A=t,M=e)}null!==M&&(g[M].isTeachingMomentTarget=!0);const R=Object.assign(Object.assign({},t.tableQuery),{scenarioType:"spotlight"});return Object(J.c)(Object(L.c)(R),b,b.length,"SpotlightLoad",null,null,!0),Q(R),r&&r(Object(L.c)(R),!0,e.status.toString(),!1),g}(i,t,n,e);s(o,Object(S.R)(t),r)},pe=Object(fe.a)(me,1e4,{maxWait:2e4,trailing:!0});var be=e=>{Object(O.a)()&&(ge?pe(e):(me(e),ge=setInterval(()=>{me(e)},36e5)))};function Ie(){return Object(d.a)().logicalId}function he(){return Object(d.a)().spotlightItems.filter(e=>!e.isAcknowledged).length}function ve(){return Object(d.a)().spotlightItems.length}var Oe=n(2740);function we(e){var t,n;const r=Object(f.a)(e);if(!r)return null;const i=Object(Oe.b)().items.get(r.itemId);return i?JSON.stringify({messageBody:(null===(t=i.UniqueBody)||void 0===t?void 0:t.Value)||(null===(n=i.NormalizedBody)||void 0===n?void 0:n.Value)||"",itemId:i.ItemId.Id}):null}var ye=n(15652),Se=n(6);function je(e){switch(e){case 1:return Object(Se.b)(ye.a);case 2:return Object(Se.b)(ye.b);case 4:return Object(Se.b)(ye.c);case 64:return Object(Se.b)(ye.e);case 128:return Object(Se.b)(ye.j);case 256:return Object(Se.b)(ye.d);case 512:return Object(Se.b)(ye.f);case 1024:return Object(Se.b)(ye.i);case 2048:return Object(Se.b)(ye.h);case 8:case 0:case 16:default:return Object(Se.b)(ye.g)}}function Ce(e){Te(),D(e)}const Te=()=>{const{spotlightTableQuery:e}=Object(d.a)();if(!e)return;const t=Object(L.c)(e),n=x(T.Dismissed).map(e=>e.rowKey).filter(e=>t.rowKeys.includes(e));n.length>0&&Object(K.a)(n,t,"Spotlight",!1)};n.d(t,"fetchSpotlightItems",(function(){return be})),n.d(t,"onSpotlightDismissedFromRP",(function(){return c})),n.d(t,"getSpotlightLogicalId",(function(){return Ie})),n.d(t,"getSpotlightItem",(function(){return B})),n.d(t,"getUnacknowledgedSpotlightCount",(function(){return he})),n.d(t,"getSpotlightCount",(function(){return ve})),n.d(t,"getSpotlightDonationJson",(function(){return we})),n.d(t,"getSpotlightReasonString",(function(){return je})),n.d(t,"loadImportantTable",(function(){return Ce})),n.d(t,"logSpotlightItemClicked",(function(){return h})),n.d(t,"logSpotlightResultsRendered",(function(){return v}))},244:function(e,t,n){"use strict";t.decode=t.parse=n(492),t.encode=t.stringify=n(493)},2790:function(e,t,n){"use strict";var r=n(20),i=n(2733),o=n(25);function c(){return a(Object(i.I)())}function a(e){let t=null;return e&&(2===e.tableQuery.type?t=e.tableQuery.folderId:Object(o.k)("grp-loadFolders")&&3===e.tableQuery.type&&(t=e.tableQuery.groupId)),t}function u(){const e=Object(i.I)();return e&&(2==e.tableQuery.type||Object(o.k)("grp-loadFolders")&&3==e.tableQuery.type)}function s(e){return!!e&&(2==e.type||d(e)||Object(o.k)("grp-loadFolders")&&3==e.type)}function d(e){if(!e||1!=e.type)return!1;return"Group"==e.searchScope.kind}function l(e){if(2==e.type)return e.folderId;if(Object(o.k)("grp-loadFolders")&&3==e.type)return e.groupId;if(d(e)){return e.searchScope.groupId}return null}function f(){const e=Object(i.I)();return e&&s(e.tableQuery)}n.d(t,"g",(function(){return m})),n.d(t,"h",(function(){return p})),n.d(t,"m",(function(){return b})),n.d(t,"l",(function(){return I})),n.d(t,"j",(function(){return h})),n.d(t,"i",(function(){return v})),n.d(t,"k",(function(){return O})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"f",(function(){return f}));const g=new r.c(()=>Promise.all([n.e(15),n.e(18),n.e(48),n.e(113),n.e(610)]).then(n.bind(null,19993))),m=new r.b(g,e=>e.getGroupDisplayName),p=new r.b(g,e=>e.getGroupDisplayNameFromTableView),b=new r.b(g,e=>e.isPrivateUnjoinedGroup),I=new r.b(g,e=>e.isJoinedGroup),h=new r.b(g,e=>e.getRetentionPolicyTagsForGroup),v=new r.b(g,e=>e.getRetentionPolicyTagListForGroupTableQuery),O=new r.b(g,e=>e.isGroupOwner)},2827:function(e,t,n){"use strict";var r=n(2858),i=n(2733);function o(){return Object(r.a)(Object(i.I)())}n.d(t,"b",(function(){return r.a})),n.d(t,"d",(function(){return r.c})),n.d(t,"c",(function(){return r.b})),n.d(t,"e",(function(){return r.d})),n.d(t,"a",(function(){return o}))},2855:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"IndexedPageView:#Exchange"},e)}n.d(t,"a",(function(){return r}))},2858:function(e,t,n){"use strict";var r=n(168),i=n(2737);const o=new Map;var c=n(2878),a=n(2790),u=n(3401);function s(e){return e?d(e.tableQuery):Object(r.d)()}function d(e){const t=Object(a.b)(e),n=null==e?void 0:e.folderId;return null!=t?Object(c.a)(t):l(n)}function l(e){return Object(i.G)(e)?Object(u.a)(e):function(e){if(!e)return Object(r.d)();if(!o.has(e)){let t=Object(i.t)(e,!0);o.set(e,t)}return o.get(e)}(e)}function f(e){return{mailboxInfo:d(e)}}n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return l})),n.d(t,"d",(function(){return f}))},2874:function(e,t,n){"use strict";var r,i,o;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),function(e){e[e.Keywords=0]="Keywords",e[e.People=1]="People",e[e.PrivateDistributionList=2]="PrivateDistributionList",e[e.File=3]="File",e[e.Category=4]="Category",e[e.Message=5]="Message",e[e.Event=6]="Event",e[e.TrySuggestion=7]="TrySuggestion",e[e.Setting=8]="Setting"}(r||(r={})),function(e){e.ODSPFile="ODSP file",e.CloudyAttachment="Cloudy attachment",e.ClassicAttachment="Classic attachment",e.LinkAttachment="Link attachment",e.Unknown="Unknown"}(i||(i={})),function(e){e[e.Unknown=0]="Unknown",e[e.Checking=1]="Checking",e[e.NotSupported=2]="NotSupported",e[e.Supported=3]="Supported"}(o||(o={}))},2878:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(168);const i={};function o(e){const t=e.toLocaleLowerCase();if(!i[t]){const n={type:"GroupMailbox",userIdentity:Object(r.d)().userIdentity,mailboxSmtpAddress:e};i[t]=n}return i[t]}},2904:function(e,t,n){"use strict";n.d(t,"j",(function(){return r})),n.d(t,"l",(function(){return i})),n.d(t,"v",(function(){return o})),n.d(t,"t",(function(){return c})),n.d(t,"a",(function(){return a})),n.d(t,"p",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return g})),n.d(t,"i",(function(){return m})),n.d(t,"e",(function(){return p})),n.d(t,"m",(function(){return b})),n.d(t,"d",(function(){return I})),n.d(t,"k",(function(){return h})),n.d(t,"s",(function(){return v})),n.d(t,"o",(function(){return O})),n.d(t,"u",(function(){return w})),n.d(t,"r",(function(){return y})),n.d(t,"q",(function(){return S})),n.d(t,"n",(function(){return j}));const r="multipart/signed",i="application/pkcs7-mime",o="application/x-pkcs7-mime",c=".p7m",a="CLSID:56023A83-B4FC-413B-9285-6BB1DAD977A2",u="CLASSID",s="4",d="0800",l=57,f=78,g=16,m=11,p="IPM.Note.SMIME.MultipartSigned",b="smime-",I="image",h="OwaToSmime",v="SmimeToOwa",O="en-US",w=["Culture","CodePage","AttachmentSizeLimit","UseKeyIdentifier","AllowUserChoiceOfSigningCertificate","IncludeCertificateChainWithoutRootCertificate","IncludeCertificateChainAndRootCertificate","EncryptTemporaryBuffers","SignedEmailCertificateInclusion","IncludeSmimeCapabilitiesInMessage","CopyRecipientHeaders","OnlyUseSmartCard","EncryptionAlgorithms","SigningAlgorithms","AlwaysEncrypt","AlwaysSign","TripleWrapSignedEncryptedMail","BccEncryptedEmailForking"],y="OwaSmimeEdgeExtension.appxbundle",S="https://microsoftedge.microsoft.com/addons/detail/gamjhjfeblghkihfjdpmbpajhlpmobbp",j="chrome-extension://maafgiompdekodanheihhgilkjchcakm/Options.html"},2908:function(e,t,n){"use strict";n.d(t,"g",(function(){return o})),n.d(t,"j",(function(){return c})),n.d(t,"v",(function(){return a})),n.d(t,"l",(function(){return u})),n.d(t,"o",(function(){return s})),n.d(t,"r",(function(){return d})),n.d(t,"i",(function(){return l})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return g})),n.d(t,"h",(function(){return m})),n.d(t,"e",(function(){return p})),n.d(t,"d",(function(){return b})),n.d(t,"f",(function(){return I})),n.d(t,"k",(function(){return h})),n.d(t,"m",(function(){return v})),n.d(t,"p",(function(){return O})),n.d(t,"q",(function(){return w})),n.d(t,"n",(function(){return y})),n.d(t,"u",(function(){return S})),n.d(t,"a",(function(){return j})),n.d(t,"s",(function(){return C})),n.d(t,"t",(function(){return T}));var r=n(20);const i=new r.c(()=>n.e(1222).then(n.bind(null,3710)));let o=new r.a(i,e=>e.logEntityClicked);const c=new r.a(i,e=>e.logResponseReceived);let a=new r.a(i,e=>e.logSessionEnd),u=new r.a(i,e=>e.logResponseRendered);const s=new r.a(i,e=>e.logSearchBoxStateChanged);let d=new r.a(i,e=>e.logSearchResultInteraction),l=new r.a(i,e=>e.logResponseNeverRendered);const f=new r.a(i,e=>e.flushNonRenderedResponseReceivedItemsFromCache),g=new r.a(i,e=>e.logCachedContentRendered);let m=new r.a(i,e=>e.logFeedback);const p=new r.a(i,e=>e.logClientLayout),b=new r.a(i,e=>e.logClientDataSource),I=new r.a(i,e=>e.logEntitiesFromFilePicker),h=new r.a(i,e=>e.logResponseRecievedV2),v=new r.a(i,e=>e.logResultsRendered),O=new r.a(i,e=>e.logSearchEntityActions),w=new r.a(i,e=>e.logSearchFeedbackActions),y=new r.a(i,e=>e.logSearchActions);let S=new r.a(i,e=>e.logSecondaryEntityActionClicked);const j=new r.a(i,e=>e.clearProcessedTraceIds),C=new r.a(i,e=>e.logSearchSuggestionsClientLayoutEvent),T=new r.a(i,e=>e.logSearchSuggestionsResultsRenderedEvent)},2929:function(e,t,n){"use strict";function r(){return{isBeingDragged:!1}}n.d(t,"a",(function(){return r}))},2940:function(e,t,n){"use strict";function r(e){return Object.assign({},e)}function i(e){return Object.assign({},e)}function o(e){return Object.assign({},e)}function c(e){return Object.assign({},e)}function a(e){return Object.assign({},e)}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return a}))},2950:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"UnifiedGroupIdentity:#Exchange"},e)}n.d(t,"a",(function(){return r}))},2954:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Mail="owa.react",e.MailCompose="owa.react.compose",e.Calendar="owa.react.calendar",e.FilesHub="owa.react.filesHub",e.MailSubject="owa.react.mail.subject",e.MailEmailAttachmentPicker="owa.react.mail.emailPicker",e.SuggestedAttachments="suggestedattachments",e.MeetingPrep="MeetingPrep",e.MeetingPrepPrefetch="MeetingPrep.Prefetch",e.MeetingPrepPeek="MeetingPrep.Peek",e.MeetingPrepReminder="MeetingPrep.Reminder",e.MeetingPrepAgenda="MeetingPrep.AgendaView",e.MeetingPrepMailCalendarCard="MeetingPrep.MailCalendarCard",e.MeetingPrepDesktop="OutlookDesktopOPX.MeetingPrep",e.MeetingPrepShell="ShellOPX.MeetingPrep",e.ContextualInsights="ContextualInsights",e.FileSuggestions="owa.react.filepicker",e.SonoraFilePicker="outlook.inlinefilepicker",e.SonoraHoneybee="owa.honeybee"}(r||(r={})),t.b=r},2980:function(e,t,n){"use strict";var r=n(13),i=n(2);let o={folderTable:new r.ObservableMap,rootFolder:null},c=Object(i.createStore)("publicFolderFavoriteStore",o)();t.a=c},2989:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3175);function i(e){return e&&Object(r.b)(e.ItemClass)}},3018:function(e,t,n){"use strict";var r;!function(e){e.EwsId="ews",e.EwsImmutableId="ewsimmutable"}(r||(r={}));var i=n(25),o=n(2),c=Object(o.createStore)("immutableId",{IsImmutableIdFeatureOnForConnectedAccount:!1});var a=n(284);function u(e){return Object(a.r)(e)?c().IsImmutableIdFeatureOnForConnectedAccount?r.EwsImmutableId:r.EwsId:Object(i.k)("fwk-immutable-ids")?r.EwsImmutableId:r.EwsId}function s(e){return!!e&&e.length<90}function d(e){const t=[],n=[],r=[];return null==e||e.forEach((e,i)=>{"string"==typeof e&&(e.indexOf("@")>-1?r.push({id:e,idx:i}):s(e)?t.push({id:e,idx:i}):n.push({id:e,idx:i}))}),[t,n,r]}function l(e,t){const[n,i]=d(e),o=u(t);return o===r.EwsImmutableId&&i.length>0||o===r.EwsId&&n.length>0}const f=Object(o.mutatorAction)("setIsImmutableIdFeatureOnForConnectedAccount",e=>{c().IsImmutableIdFeatureOnForConnectedAccount=e});n.d(t,"b",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return s})),n.d(t,"f",(function(){return f})),n.d(t,"a",(function(){return r}))},3019:function(e,t,n){"use strict";var r=n(1431),i=n(710);function o(e){return Object.assign({__type:"SingleLargeArchiveSearchScopeType:#Exchange"},e)}function c(e){return Object.assign({__type:"SearchFolderScopeType:#Exchange"},e)}var a=n(2950),u=n(2751);var s=n(1084),d=n(2940),l=n(2741),f=n(2971);n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return w})),n.d(t,"c",(function(){return y}));const g={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){const e=[];e.push(Object(d.b)({folderId:Object(s.a)(l.k),kind:"PrimaryMailbox"}));const t=Object(f.b)("UserMailbox");for(let n of t)e.push(Object(d.b)({folderId:n,kind:"PrimaryMailbox"}));return e},getSearchScopeType:function(e){const t=Object(u.a)(e.folderId);let n;return n="none"!=t?Object(r.a)({Id:t}):Object(i.a)({Id:e.folderId}),[(o={FolderScope:c({BaseFolderId:n}),IsDeepTraversal:!0},Object.assign({__type:"PrimaryMailboxSearchScopeType:#Exchange"},o))];var o}},m={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){const e=[];return e.push(Object(d.a)({folderId:Object(s.a)(l.d),kind:"ArchiveMailbox"})),e.push(Object(d.a)({folderId:Object(s.a)(l.a),kind:"ArchiveMailbox"})),e},getSearchScopeType:function(e){const t=Object(u.a)(e.folderId);let n;return n="none"!=t?Object(r.a)({Id:t}):Object(i.a)({Id:e.folderId}),"archivemsgfolderroot"==t?[(a={ArchiveTypes:16777215},Object.assign({__type:"LargeArchiveSearchScopeType:#Exchange"},a))]:[o({FolderScope:c({BaseFolderId:n})})];var a}},p={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},b={getKey:function(e){return e.kind+"-"+e.groupId.toLowerCase()},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return[(t={GroupIdentity:Object(a.a)({Type:0,Value:e.groupId})},Object.assign({__type:"SingleGroupSearchScopeType:#Exchange"},t))];var t}},I={getKey:function(e){return e.kind+"-"+e.calendarFolderId?e.calendarFolderId.toLowerCase():""},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},h={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},v=e=>{switch(e.kind){case"PrimaryMailbox":return g;case"ArchiveMailbox":return m;case"SharedFolders":return p;case"Group":return b;case"Calendar":return I;case"PublicFolder":return h;default:throw new Error("Unregistered search scope")}},O=e=>v(e).getKey(e),w=e=>v(e).getSearchScopeList(),y=e=>v(e).getSearchScopeType(e)},3032:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r="IPM.Note.SMIME"},3076:function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return c})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return u})),n.d(t,"g",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return l}));var r=n(20);const i=new r.c(()=>Promise.all([n.e(0),n.e(35),n.e(801)]).then(n.bind(null,3886)));let o=new r.a(i,e=>e.logLocalContentDataSource),c=new r.a(i,e=>e.logLocalContentLayout),a=new r.a(i,e=>e.clearLocalContentInstrumentationCache),u=new r.b(i,e=>e.getLocalContentId);const s=new r.b(i,e=>e.substrateSearchInitOperation),d=(new r.b(i,e=>e.substrateSearchPostSuggestionsService),new r.b(i,e=>e.deleteSubstrateSearchHistoryService)),l=new r.b(i,e=>e.exportSubstrateSearchHistoryService)},3110:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.request/i)}n.d(t,"a",(function(){return r}))},3115:function(e,t,n){"use strict";var r,i=n(4);!function(e){e.SelectedCalendars="SelectedCalendars",e.MyDay="MyDay",e.SavedCalendarViews="SavedCalendarViews",e.BoardCalendarAsset="BoardCalendarAsset",e.Spotlight="Spotlight",e.CalendarWidget="CalendarWidget",e.Addins="Addins",e.ActivityFeed="ActivityFeed",e.ReadingPane="ReadingPane",e.SXSAttachments="SXSAttachments",e.BoardMailItem="BoardMailItem"}(r||(r={})),n.d(t,"b",(function(){return a})),n.d(t,"e",(function(){return u})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return r}));const o=new i.d(()=>n.e(1068).then(n.bind(null,19909))),c=(e,t)=>{const n=new i.a(e,t);return(...e)=>n.importAndExecute(...e)},a=c(o,e=>e.convertIdsToTargetFormat),u=c(o,e=>e.translateRestImmutableIdsToEwsIds),s=c(o,e=>e.translateEwsIdsToEwsImmutableIds),d=c(o,e=>e.translateEwsIdsToRestImmutableIds);c(o,e=>e.translateEwsImmutableIdsToEwsIds)},3117:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("MARK_ALL_AS_READ_STORE_UPDATE",(e,t,n)=>({tableView:e,markAsRead:t,rowIdsToExclude:n}))},3119:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(168);function i(e){return{type:"PublicMailbox",userIdentity:Object(r.d)().userIdentity,mailboxSmtpAddress:e}}},3138:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(3046),i=n(3288),o=n(2733),c=n(2751),a=n(3294);function u(e,t,n,u,s,d,l){const f=s||"All",g=l||Object(i.a)(e),m=null==u?function(e){if("inbox"!==Object(c.a)(e))return-1;if(!Object(a.a)())return-1;return 0}(e):u;let p;switch(t){case 0:p=Object(r.e)(e,Object(o.T)(n));break;case 1:p=Object(r.f)()}return{folderId:e,focusedViewFilter:m,listViewType:t,viewFilter:f,sortBy:g,requestShapeName:p,type:0,categoryName:d,scenarioType:n}}},316:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return u}));var r=n(124),i=n(117),o=n(3);let c;function a(e){c=e}async function u(){var e,t;if(Object(o.P)())return i.f.importAndExecute(Object(r.a)());const n=c&&await c();if(n&&n.length>0){if("bearer"===(null===(e=null==n?void 0:n.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return n.split(" ")[1];if("msauth1.0"===(null===(t=null==n?void 0:n.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return n}}},3174:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));const r=350,i=270},3175:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return u}));var r=n(2904),i=n(3032);function o(e){return e&&0===e.indexOf(r.e)}function c(e){return e&&0===e.indexOf(i.a)&&!o(e)}function a(e){return e&&0===e.indexOf(i.a)}function u(e){return e.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}},3178:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.canceled/i)}n.d(t,"a",(function(){return r}))},3202:function(e,t,n){"use strict";var r=n(20),i=n(3207),o=n(3243),c=n(3208),a=n(3110),u=n(3209),s=n(3178),d=n(3244);function l(e){const t=e;return"Single"===t.CalendarItemType&&!t.RecurrenceId}function f(e){return!!e.RecurrenceId}n.d(t,"s",(function(){return m})),n.d(t,"t",(function(){return p})),n.d(t,"w",(function(){return b})),n.d(t,"d",(function(){return I})),n.d(t,"g",(function(){return h})),n.d(t,"h",(function(){return v})),n.d(t,"b",(function(){return O})),n.d(t,"f",(function(){return w})),n.d(t,"e",(function(){return y})),n.d(t,"i",(function(){return S})),n.d(t,"j",(function(){return j})),n.d(t,"a",(function(){return C})),n.d(t,"c",(function(){return T})),n.d(t,"v",(function(){return A})),n.d(t,"u",(function(){return M})),n.d(t,"k",(function(){return i.a})),n.d(t,"x",(function(){return o.a})),n.d(t,"m",(function(){return c.a})),n.d(t,"q",(function(){return a.a})),n.d(t,"r",(function(){return u.a})),n.d(t,"l",(function(){return s.a})),n.d(t,"o",(function(){return d.a})),n.d(t,"p",(function(){return l})),n.d(t,"n",(function(){return f}));const g=new r.c(()=>Promise.all([n.e(0),n.e(5),n.e(9),n.e(13),n.e(25),n.e(27),n.e(28),n.e(34),n.e(39),n.e(58),n.e(66),n.e(71),n.e(257),n.e(346),n.e(510)]).then(n.bind(null,19694))),m=new r.a(g,e=>e.addItemToCalendar),p=new r.a(g,e=>e.initializeMeetingRequestViewStateAction),b=new r.a(g,e=>e.removeCancelledMeetingFromCalendar),I=Object(r.d)(g,e=>e.MeetingMessageInfo),h=(Object(r.d)(g,e=>e.MeetingRequestActions),Object(r.d)(g,e=>e.MeetingCancellationAction),Object(r.d)(g,e=>e.MeetingActionButton),Object(r.d)(g,e=>e.MeetingDetailsTime),Object(r.d)(g,e=>e.MeetingDetailsLocation),Object(r.d)(g,e=>e.MeetingRequestInfo)),v=Object(r.d)(g,e=>e.MeetingRequestResponseEditor),O=Object(r.d)(g,e=>e.MeetingDetails),w=Object(r.d)(g,e=>e.MeetingRequestConflicts),y=(Object(r.d)(g,e=>e.EditEventLink),Object(r.d)(g,e=>e.MeetingMessageSummary)),S=Object(r.d)(g,e=>e.PreviewSummary),j=Object(r.d)(g,e=>e.SenderSummary),C=Object(r.d)(g,e=>e.CollapsedMeetingMessage),T=Object(r.d)(g,e=>e.MeetingIcon),A=new r.a(g,e=>e.logMeetingMessageActionForInvite),M=new r.a(g,e=>e.logMeetingMessageActionForEvent)},3206:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3019);function i(e,t){return!(!e||!t)&&Object(r.a)(e)===Object(r.a)(t)}},3207:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("deleteMeetingMessage",(e,t)=>({item:e,issueDeleteItemCall:t}))},3208:function(e,t,n){"use strict";function r(e){return(null==e?void 0:e.ItemClass)&&e.ItemClass.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}n.d(t,"a",(function(){return r}))},3209:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.resp/i)}n.d(t,"a",(function(){return r}))},3243:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("meetingMessageAddToCalendarStatusChanged",(e,t)=>({status:e,sxsId:t}))},3244:function(e,t,n){"use strict";function r(e){const t=e;return"RecurringMaster"===t.CalendarItemType&&!t.RecurrenceId}n.d(t,"a",(function(){return r}))},3262:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("TRY_REMOVE_FROM_MAIL_STORE_ITEMS",(e,t)=>({itemIdToRemove:e,removeItemSource:t}))},3294:function(e,t,n){"use strict";var r=n(30);function i(){var e;return!!(null===(e=Object(r.a)().UserOptions)||void 0===e?void 0:e.IsFocusedInboxEnabled)}n.d(t,"a",(function(){return i}))},3313:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2);let i=Object(r.action)("USERMAIL_INTERACTION",(e,t,n)=>({interactionType:e,instrumentationContexts:t,triageContext:n}))},3401:function(e,t,n){"use strict";var r=n(2733),i=n(2737);function o(){const e=Object(r.I)();return e&&0==e.tableQuery.type&&Object(i.G)(e.tableQuery.folderId)}function c(){const e=Object(r.I)();return e&&0==e.tableQuery.type&&Object(i.G)(e.tableQuery.folderId)?e.tableQuery.folderId:null}var a=n(2),u=n(2980),s=n(3119),d=n(13);var l=Object(a.createStore)("publicFolderUtilsStore",new d.ObservableMap),f=n(52);function g(e){if(!l().has(e)){const t=u.a.folderTable.get(e),n=null!=t.replicaList?t.replicaList[0]:Object(f.g)().SessionSettings.DefaultPublicFolderMailbox,r=Object(s.a)(n);m(e,r)}return l().get(e)}const m=Object(a.mutatorAction)("addPublicFolderMailboxInfoToStore",(e,t)=>{l().set(e,t)});n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return g}))},3448:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2737);function i(e){return Object(r.C)(e,"SharedMailbox")}},3475:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return u}));var r=n(20),i=n(3313);n.d(t,"d",(function(){return i.a}));const o=new r.c(()=>n.e(1278).then(n.bind(null,5424)));let c=new r.a(o,e=>e.onKeyboardUpDown),a=new r.a(o,e=>e.onOpenEmail),u=new r.a(o,e=>e.onKeyboardToggleSelect)},3539:function(e,t,n){"use strict";var r=n(20),i=n(2733),o=n(2827),c=n(2742),a=n(2751),u=n(3032);var s=n(2989),d=n(25);function l(e,t){if(t.folderId&&"junkemail"==Object(a.a)(t.folderId))return!1;const n=c.u.items.get(e.ItemId.Id);return!(Object(s.a)(e)||(null==n?void 0:n.RightsManagementLicenseData))&&(!(null==n||!n.shouldShowAttachmentPreviews)||!!(e.HasAttachments||Object(d.k)("doc-linkDiscovery-useNewProperty")&&e.HasProcessedSharepointLink)&&(p.importAndExecute(Object(o.d)(t),e.ConversationId,e.ItemId.Id),!0))}let f=function(e,t,n={listViewStore:i.Z}){const r=1==t.type,c=e.ConversationId,s=n.listViewStore.conversationItems.get(c.Id),l=Object(d.k)("doc-linkDiscovery-useNewProperty")&&e.HasProcessedSharepointLink;if(t.folderId&&"junkemail"==Object(a.a)(t.folderId))return!1;if((null==(f=e)?void 0:f.ItemClasses)&&f.ItemClasses.length>0&&f.ItemClasses.some(e=>0===e.indexOf(u.a))||e.HasIrm)return!1;var f;let g,m;if(r){if(null==s?void 0:s.shouldShowAttachmentPreviews)return!0;m=!!e.HasAttachments||l,g=m}else{if(!e.HasAttachmentPreviews&&!l)return!1;s&&!l?(g=s.globalItemIds.length!=e.GlobalItemIds.length,m=s.shouldShowAttachmentPreviews):(g=!0,m=!0)}return g&&p.importAndExecute(Object(o.d)(t),e.ConversationId,null),m};n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return b})),n.d(t,"d",(function(){return I})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return l}));const g=new r.c(()=>n.e(996).then(n.bind(null,19921))),m=new r.a(g,e=>e.getPreviews),p=new r.a(g,e=>e.add),b=new r.a(g,e=>e.getAttachmentsForConversationWell),I=new r.a(g,e=>e.removeAttachmentPreviewsForRow)},3615:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return a}));var r=n(3),i=n(46),o=n(52);function c(){let e=Object(r.v)("targetServer"),t="DefaultAnchorMailbox"+(e?"_"+e.toLocaleLowerCase():"");return Object(r.v)(t)}function a(){let e=function(){let e="",t=Object(i.b)().pathname.split("/").filter(e=>e.length);return t.length>=2&&t[1].match(/.+@.+/)&&(e=t[1]),e}();if(0===e.length){let t=Object(o.g)();if(null==t?void 0:t.SessionSettings){let n=t.SessionSettings.ExternalDirectoryTenantGuid,r=t.SessionSettings.UserPuid;r&&n&&(e=`PUID:${r}@${n}`)}}return 0===e.length&&(e=c()),e}},3653:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("REMOVE_ROWS_FROM_LISTVIEW_STORE",(e,t,n,r=!0)=>({rowKeys:e,tableView:t,actionType:n,shouldRemoveFromAllTables:r}))},397:function(e,t,n){"use strict";var r=n(221),i=n(193),o="[object Symbol]";t.a=function(e){return"symbol"==typeof e||Object(i.a)(e)&&Object(r.a)(e)==o}},4029:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return l}));var r=n(3288),i=n(3138),o=n(2948),c=n(1084),a=n(3294);function u(){const e=Object(c.a)("inbox"),t=Object(o.b)(e),n=Object(r.a)(e);return Object(i.a)(e,t,"mail",-1,null,null,n)}function s(){let e=u();return e.focusedViewFilter=0,e}function d(){let e=u();return e.focusedViewFilter=1,e}function l(){return Object(a.a)()?s():u()}},468:function(e,t,n){"use strict";function r(e,t){const n=Math.pow(2,32);if(e>=n||t>=n){const r=e%n,i=t%n;return(((e-=r)/n&(t-=i)/n)>>>0)*n+((r&i)>>>0)}return(e&t)>>>0}n.d(t,"a",(function(){return r}))},492:function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,o){t=t||"&",n=n||"=";var c={};if("string"!=typeof e||0===e.length)return c;var a=/\+/g;e=e.split(t);var u=1e3;o&&"number"==typeof o.maxKeys&&(u=o.maxKeys);var s=e.length;u>0&&s>u&&(s=u);for(var d=0;d<s;++d){var l,f,g,m,p=e[d].replace(a,"%20"),b=p.indexOf(n);b>=0?(l=p.substr(0,b),f=p.substr(b+1)):(l=p,f=""),g=decodeURIComponent(l),m=decodeURIComponent(f),r(c,g)?i(c[g])?c[g].push(m):c[g]=[c[g],m]:c[g]=m}return c};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},493:function(e,t,n){"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,a){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?o(c(e),(function(c){var a=encodeURIComponent(r(c))+n;return i(e[c])?o(e[c],(function(e){return a+encodeURIComponent(r(e))})).join(t):a+encodeURIComponent(r(e[c]))})).join(t):a?encodeURIComponent(r(a))+n+encodeURIComponent(r(e)):""};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function o(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var c=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},716:function(e,t,n){"use strict";var r=/\s/;var i=function(e){for(var t=e.length;t--&&r.test(e.charAt(t)););return t},o=/^\s+/;var c=function(e){return e?e.slice(0,i(e)+1).replace(o,""):e},a=n(165),u=n(397),s=NaN,d=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,f=/^0o[0-7]+$/i,g=parseInt;t.a=function(e){if("number"==typeof e)return e;if(Object(u.a)(e))return s;if(Object(a.a)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Object(a.a)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=c(e);var n=l.test(e);return n||f.test(e)?g(e.slice(2),n?2:8):d.test(e)?s:+e}},765:function(e,t,n){"use strict";function r(e){if(!e)return e;let t=e.replace(/\+/g,"_");return t=t.replace(/\//g,"-"),t}function i(e){if(!e)return e;let t=e.replace(/_/g,"+");return t=t.replace(/-/g,"/"),t}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}))},9154:function(e,t,n){"use strict";var r=n(2),i=Object(r.action)("onSpotlightDisabled");n.d(t,"a",(function(){return i}))},963:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));const r=1,i=16}}]);
//# sourceMappingURL=owa.614.js.map
self.scriptsLoaded['owa.614.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.614.js'] = (new Date()).getTime();