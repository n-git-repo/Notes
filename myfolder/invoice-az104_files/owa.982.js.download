self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.982.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[982],{20169:function(t,e,n){"use strict";n.r(e);var c=n(4203),o=n(358),r=n(168),u=Object(o.action)("execute3SPrimeCall")((function(){Object(c.b)(Object(r.d)().userIdentity,null,!1)}));n.d(e,"execute3SPrimeCall",(function(){return u}))},211:function(t,e,n){"use strict";var c=n(930);n.d(e,"a",(function(){return c.a}))},2761:function(t,e,n){"use strict";function c(t,e){Object.keys(e).forEach(n=>t.set(n,e[n]))}function o(t){let e=null!=t?t:{headers:new Headers};return e.datapoint=e.datapoint||{},e.datapoint.mailbox="Default",e}n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return o}))},2762:function(t,e,n){"use strict";var c=n(2820),o=n(284),r=n(753),u=n(68),i=n(5),a=n(22);const s="X-AnchorMailbox",d="Authorization",b="X-OwaWebSessionType",f="X-OWA-ExplicitLogonUser";async function l(t,e){const n={},l=Object(o.k)(t);if(l){if(l.accountState==o.b.AccessRevoked)return null;if(l.accountState==o.b.AccountDeprovisioned||l.accountState==o.b.AccountNotFound)return Object(o.d)(l.accountState,l.accountProviderType),null}if(e?(n[s]=e,n[f]=e):l&&(n[s]=l.anchorMailbox),l){let e,o=l.token,s=Object(r.g)(l.tokenExpiry);!s&&o||(Object(u.p)("getAndUpdateAccessToken",{tokenExpiry:Object(i.y)(l.tokenExpiry,Object(i.Tb)()),isTokenExpired_1:s,isTokenInvalid_2:!o},{isCore:!0}),o=await c.a.importAndExecute(l.accountId,t,o),a.h.info("[AccountLoadRecovery] getConnectedAccountHeaders: finished GetAndUpdateAccessToken for "+t+o),o||(o="")),"Outlook"==l.accountProviderType?(e=`MSAuth1.0 usertoken="${o}", type="MSACT"`,n[b]=1..toString()):"Google"!=l.accountProviderType&&"ICloud"!=l.accountProviderType&&"Yahoo"!=l.accountProviderType||(e=`Bearer ${o}`,n[b]=2..toString()),n[d]=e}return n}var O=n(2761);async function j(t,e){const n=Object(O.a)();return n.headers=await async function(t,e){var n;const c=e&&(null===(n=t.headers)||void 0===n?void 0:n.set)?new Headers(t.headers):new Headers,o=await l(t.mailboxInfo.userIdentity,p(t.mailboxInfo.type,t.mailboxInfo.mailboxSmtpAddress)?t.mailboxInfo.mailboxSmtpAddress:null);return Object(O.b)(c,o),c}(t,e),n.authNeededOnUnAuthorized=!1,n.datapoint=n.datapoint||{},n.datapoint.mailbox="Connected",n}function p(t,e){const n="GroupMailbox"==t||"TeamsMailbox"==t||"SharedMailbox"==t||"PublicMailbox"==t;return n&&null==e&&a.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(e,"a",(function(){return l})),n.d(e,"b",(function(){return j})),n.d(e,"c",(function(){return p}))},2763:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var c=n(2);const o=Object(c.action)("triggerReInitializeAccount",t=>({userIdentity:t}))},2820:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var c=n(20),o=n(2763);n.d(e,"b",(function(){return o.a}));const r=new c.c(()=>n.e(1069).then(n.bind(null,3034))),u=new c.a(r,t=>t.getAndUpdateAccessToken)},284:function(t,e,n){"use strict";var c,o=n(2);!function(t){t[t.Valid=0]="Valid",t[t.AccountDeprovisioned=1]="AccountDeprovisioned",t[t.AccessRevoked=2]="AccessRevoked",t[t.TransientTokenError=3]="TransientTokenError",t[t.FailedToInitializeOWAConfig=4]="FailedToInitializeOWAConfig",t[t.AccountNotFound=5]="AccountNotFound",t[t.UnknownTokenError=6]="UnknownTokenError"}(c||(c={}));var r=n(66);const u=Object(o.action)("addAccount",t=>({userIdentity:t.userIdentity,account:t})),i=Object(o.action)("removeAccount",t=>({userIdentity:t})),a=Object(o.action)("updateAccount",(t,e,n)=>({userIdentity:t,accountToken:e,accountTokenExpiresIn:n})),s=Object(o.action)("updateOWAConnectedAccountStatus",(t,e)=>({userIdentity:t,accountState:e})),d=Object(o.action)("connectedAccountIsInErrorState",(t,e)=>Object(r.b)({name:"connectedAccountIsInErrorState",customData:{accountState_1:c[t],accountProvider_2:e}},{accountState:t})),b=Object(o.action)("connectedAccountsListRequested",t=>({isSuccess:t})),f=Object(o.action)("setAccountsStoreState",t=>({state:t}));var l,O=n(13);!function(t){t[t.None=0]="None",t[t.Loading=1]="Loading",t[t.AccountsLoadSuccessful=2]="AccountsLoadSuccessful",t[t.AccountsLoadError=3]="AccountsLoadError"}(l||(l={}));var j=Object(o.createStore)("OWAAccountsStore",{accountsMap:new O.ObservableMap({}),accountsLoadedState:l.None}),p=n(72),v=n(52);function y(t){if(t==Object(v.b)())return!1;return void 0!==S(t)}function h(){return[...j().accountsMap.values()]}function S(t){return j().accountsMap.get(t)}function A(){var t;return(null===(t=h())||void 0===t?void 0:t.length)>0?h()[0]:null}function T(){return h().filter(t=>t.accountState!=c.Valid)}function m(t){return h().filter(e=>t.includes(e.accountState))}function k(t){return h().filter(e=>e.accountProviderType==t)}function g(t){return y(t)?S(t).accountProviderType:null}function I(t){return"Outlook"==t.accountProviderType?`MSAuth1.0 usertoken="${t.token}", type="MSACT"`:"Google"==t.accountProviderType||"ICloud"==t.accountProviderType||"Yahoo"==t.accountProviderType?`Bearer ${t.token}`:Object(p.a)(t.accountProviderType)}function w(t,e){return function(n){const c=S(n);return c?c[t]:e}}w("accountUniqueId","0");const P=w("accountState",c.Valid),x=()=>h().some(t=>!L(t.userIdentity)),E=w("accountProviderType",null),C=t=>"Outlook"==E(t),L=t=>P(t)==c.Valid,M=()=>h().length>0;function D(){return j().accountsLoadedState}var F=n(5),N=n(68);Object(o.mutator)(u,({account:t})=>{Object(N.p)("owaAccountAdded",{accountStatus_1:c[t.accountState]}),j().accountsMap.set(t.userIdentity,t)}),Object(o.mutator)(i,({userIdentity:t})=>{j().accountsMap.delete(t)}),Object(o.mutator)(a,({userIdentity:t,accountToken:e,accountTokenExpiresIn:n})=>{const c=j().accountsMap.get(t);c.token=e,c.tokenExpiry=Object(F.j)(Object(F.Tb)(),n)}),Object(o.mutator)(s,({userIdentity:t,accountState:e})=>{const n=j().accountsMap.get(t);n.accountState==c.Valid&&e!=c.Valid&&Object(N.p)("owaConnectedAccountStatusUpdated",{accountStatus_1:c[e]}),n.accountState=e}),Object(o.mutator)(b,t=>{const e=t.isSuccess?l.AccountsLoadSuccessful:l.AccountsLoadError;j().accountsLoadedState=e}),Object(o.mutator)(f,t=>{j().accountsLoadedState=t.state}),n.d(e,"c",(function(){return u})),n.d(e,"u",(function(){return i})),n.d(e,"x",(function(){return a})),n.d(e,"w",(function(){return s})),n.d(e,"d",(function(){return d})),n.d(e,"e",(function(){return b})),n.d(e,"v",(function(){return f})),n.d(e,"n",(function(){return h})),n.d(e,"k",(function(){return S})),n.d(e,"i",(function(){return A})),n.d(e,"f",(function(){return T})),n.d(e,"g",(function(){return m})),n.d(e,"o",(function(){return k})),n.d(e,"j",(function(){return g})),n.d(e,"m",(function(){return I})),n.d(e,"l",(function(){return P})),n.d(e,"q",(function(){return x})),n.d(e,"t",(function(){return C})),n.d(e,"s",(function(){return L})),n.d(e,"p",(function(){return M})),n.d(e,"h",(function(){return D})),n.d(e,"r",(function(){return y})),n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return l}))},3130:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var c=n(25),o=n(100);function r(){return!Object(o.g)()&&(Object(c.k)("rp-cacheFirstPeopleTrieSize300")||Object(c.k)("rp-cacheFirstPeopleTrieSize500")||Object(c.k)("rp-cacheFirstPeopleTrieSize700")||Object(c.k)("rp-peopleTrieOnTimeoutLow")||Object(c.k)("rp-peopleTrieOnTimeoutMed")||Object(c.k)("rp-peopleTrieOnTimeoutHigh"))}},3684:function(t,e,n){"use strict";var c=n(154);var o=n(25),r=n(7);n.d(e,"a",(function(){return i}));const u="searchtesthook";function i(t={}){const e=function(t,...e){const n={};for(const c of e)for(const e of Object.keys(c))t.includes(e)&&n.hasOwnProperty(e)?n[e]=n[e]+","+c[e]:n[e]=c[e];return n}(["setflight"],t,function(){let t={};const e=Object(r.c)(u),n=decodeURIComponent(e||"").trim();if(Object(o.k)("sea-debugHook")&&n.length>0){t=n.split("&").reduce((t,e)=>{const[n,c]=e.split("=");return t[n]=c,t},{})}return t}(),Object(c.a)("includePartnerIn3SRequest")?{partner:"exchangeshared"}:{});return Object.keys(e).filter(t=>null!==e[t]).reduce((t,n)=>Object.assign(Object.assign({},t),{[n]:e[n]}),{})}},4203:function(t,e,n){"use strict";n.d(e,"a",(function(){return S})),n.d(e,"b",(function(){return A})),n.d(e,"c",(function(){return m}));var c=n(284),o=n(2762),r=n(25),u=n(159),i=n(211),a=n(155),s=n(3684),d=n(220),b=n(3130),f=n(22),l=n(4292);const O="/search/api/v1/init?",j="/search/api/v1/suggestions?",p="owa.react.compose",v="20",y="5",h="CSRClientEnabled",S="owa.projectMoca.peopleCard";async function A(t,e,n,c,o,r,s,d=!0){const b=s||p;if(null==e)return async function(t){return Object(a.b)(O+m(t),void 0,!0,await k(null),!0,!1).then(t=>Object(i.a)(t.status)?t.json():null).catch(t=>(t.networkError=!0,f.d(t),null))}(b);{let i=function(t,e,n){return{AppName:"OWA",Scenario:{Name:n},Cvid:e||Object(u.a)(),EntityRequests:[t]}}(await async function(t,e,n,c,o){let r={Query:{QueryString:t},EntityType:"People",Provenances:T(e),Size:e?v:y};c&&c.length>0&&(r.Context=function(t){let e={};t&&(e.RecipientsTo=t.toString());return e}(c));return r.Fields=o===S?Object(l.a)(2,n):Object(l.a)(1,n),r}(e,n,d,r,b),null==o?void 0:o.conversationId,b);return Object(a.e)(j+m(b,e),i,c,!1,await k(t,null==o?void 0:o.clientSessionId),!0,!0,!1).then(t=>t).catch(t=>(f.h.info(t),null))}}function T(t){let e=["Mailbox"];return t&&!Object(d.a)()&&e.push("Directory"),e}function m(t,e){const n=Object.assign({scenario:t},Object(s.a)());let c=[];return Object(b.a)()&&c.push(h),Object(r.k)("rp-cacheFirstPeopleTrieSize500cf")&&c.push(h),n.setflight&&c.push(n.setflight),c.length>0&&(n.setflight=c.join(",")),Object.keys(n).map(t=>`${t}=${n[t]}`).join("&")}async function k(t,e){let n={};return e&&(n["client-session-id"]=e),t&&Object(c.r)(t)?Object(o.a)(t).then(t=>(Object.keys(t).forEach(e=>n[e]=t[e]),n)):n}},4292:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var c=n(3130),o=n(25);const r=["Id","ADObjectId","DisplayName","EmailAddresses","PeopleSubtype","PeopleType","PDLItemId","PersonaId","ImAddress","JobTitle"],u=r.concat(["FeatureData","GivenName","Surname","Alias","AdditionalNames"]),i=r.concat(["FeatureData"]),a=r.concat(["Phones","OfficeLocation","Department"]);function s(t,e=!0){return 2===t?a:Object(c.a)()&&e?function(t){let e=0==t?[...u]:[...i];Object(o.k)("rp-enableCsrFvlJoin")&&e.push("PersonId");return e}(t):r}},753:function(t,e,n){"use strict";var c=n(2);const o=Object(c.action)("initializeOwaObservableDateTime"),r=Object(c.action)("observableNowChanged"),u=Object(c.action)("observableTodayChanged");var i=n(5),a=n(13),s=Object(c.createStore)("ObservableDateTime",{now:0,today:0});const d=Object(a.computed)(()=>Object(i.pc)(s().now)),b=()=>d.get(),f=Object(a.computed)(()=>Object(i.pc)(s().today)),l=()=>f.get(),O=t=>Object(i.Jb)(t,b()),j=t=>Object(i.Hb)(t,b()),p=t=>y(t,i.Jb),v=t=>y(t,i.Kb),y=(t,e)=>e(Object(i.ac)(Object(i.pc)(t)),l());function h(t){if(!t)return"";const e=Object(i.pc)(t);return function(t,e){const n=Object(i.ac)(t);if(Object(i.Lb)(n,e))return i.ab;const c=t=>Object(i.Qb)(n,Object(i.e)(e,-t),e);if(c(3))return i.ib;if(c(30))return i.hb;return i.Y}(e,l())(e)}function S(t){if(!t)return"";const e=Object(i.pc)(t);return function(t,e){const n=Object(i.ac)(t);if(Object(i.Lb)(n,e))return i.T;return i.U}(e,l())(e)}function A(t){if(!t)return"";return function(t,e){const n=Object(i.ac)(t);return Object(i.Lb)(n,e)?Object(i.ab)(t):T(n,e,2)?Object(i.lb)(t):T(n,e,7)?Object(i.H)(Object(i.bb)(t),Object(i.ab)(t)):Object(i.H)(Object(i.J)(t),Object(i.ab)(t))}(Object(i.pc)(t),l())}function T(t,e,n){return Object(i.Qb)(t,Object(i.e)(e,-n),e)}const m=Object(c.action)("updateTimes"),k=Object(c.action)("setNow"),g=Object(c.action)("setToday",t=>({today:t}));Object(c.mutator)(k,()=>{s().now=Object(i.nc)()}),Object(c.mutator)(g,({today:t})=>{s().today=t});var I=n(24),w=n(80);let P=!1;Object(c.orchestrator)(o,()=>{if(m(),!P){const t=Object(i.Tb)(),e=Object(i.cc)(Object(i.h)(t,1)),n=Object(i.w)(e,t);setTimeout(()=>setInterval(m,I.g),n),document&&document.addEventListener("visibilitychange",m),P=!0}}),Object(c.orchestrator)(w.l,()=>{m()}),Object(c.orchestrator)(m,()=>{k();const t=Object(i.Cb)(Object(i.oc)()),e=s().today!=t;e&&g(t),r(),e&&u()}),n.d(e,"d",(function(){return o})),n.d(e,"j",(function(){return r})),n.d(e,"l",(function(){return u})),n.d(e,"i",(function(){return b})),n.d(e,"k",(function(){return l})),n.d(e,"g",(function(){return O})),n.d(e,"e",(function(){return j})),n.d(e,"f",(function(){return p})),n.d(e,"h",(function(){return v})),n.d(e,"a",(function(){return h})),n.d(e,"b",(function(){return S})),n.d(e,"c",(function(){return A}))},930:function(t,e,n){"use strict";function c(t){return t>=200&&t<300}n.d(e,"a",(function(){return c}))}}]);
//# sourceMappingURL=owa.982.js.map
self.scriptsLoaded['owa.982.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.982.js'] = (new Date()).getTime();