(window.msfast_search_hostapp_owa_jsonp=window.msfast_search_hostapp_owa_jsonp||[]).push([[2],{335:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a});var r={};n.r(r),n.d(r,"getCompactRelativeTimeString",function(){return s}),n.d(r,"getDetailedTimestamp",function(){return u}),n.d(r,"getFriendlyTimestamp",function(){return d}),n.d(r,"getAlternativeFriendlyTimestamp",function(){return m}),n.d(r,"getSemiDetailedRelativeTimestamp",function(){return h}),n.d(r,"getDetailedRelativeTimeString",function(){return p}),n.d(r,"getShortDurationTimeString",function(){return f}),n.d(r,"getShortDurationFromHoursDifferenceString",function(){return g}),n.d(r,"getRelativeTimeFromNow",function(){return b}),n.d(r,"getLongDurationTimeString",function(){return v}),n.d(r,"getWeekRelativeDateString",function(){return O});var a=n(400),i=n(406),o=n(94),c=n(191),l=n(95);function s(e,t,n,r,o,c){return void 0===o&&(o=!1),void 0===c&&(c=!1),y(n,r)&&n.timeFormats?i.o(e,t)?Object(a.format)(o||n.todayAsLabel?n.timeFormats.todayDayShort:n.timeFormats.todayShort,e,t,n,r):i.q(e,t)?Object(a.format)(n.timeFormats.yesterdayShort,e,t,n,r):i.j(e,t)?Object(a.format)(n.timeFormats.daysAgoShort,e,t,n,r):i.p(e,t)?Object(a.format)(n.timeFormats.tomorrowShort,e,t,n,r):i.n(e,t)?Object(l.l)(e,n.timeFormats,"long"):c?Object(l.c)(e,n.timeFormats,"short"):Object(a.format)(n.timeFormats.generic,e,t,n,r):e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear()}function u(e,t,n,r){return y(n,r)&&n.timeFormats?i.m(e,t)?n.timeFormats.justNow:i.h(e,t)?Object(a.format)(n.timeFormats.minutesAgoShort,e,t,n,r):i.o(e,t)?Object(a.format)(n.timeFormats.hoursAgoShort,e,t,n,r):i.q(e,t)?Object(a.format)(n.timeFormats.yesterdayLong,e,t,n,r):i.j(e,t)?Object(a.format)(n.timeFormats.weekdayShort,e,t,n,r):i.a(e,t)?Object(a.format)(n.timeFormats.timestampDate,e,t,n,r):Object(a.format)(n.timeFormats.timestampDateYear,e,t,n,r):e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear()}function d(e,t,n,r){return y(n,r)&&n.timeFormats?i.p(e,t)?Object(a.format)(n.startWithLowercase?n.timeFormats.tomorrowShortLowercase:n.timeFormats.tomorrowShort,e,t,n,r):i.l(e,t)?i.d(e,t)<=59?Object(a.format)(n.a11yFriendly?n.timeFormats.inMinutesShortNumbers:n.timeFormats.inMinutesShorterNumbers,e,t,n,r):i.c(e,t)<=23?Object(a.format)(n.a11yFriendly?n.timeFormats.inHoursShortNumbers:n.timeFormats.inHoursShorterNumbers,e,t,n,r):Object(a.format)(n.startWithLowercase?n.timeFormats.todayLongLowercase:n.timeFormats.todayLong,e,t,n,r):i.m(e,t)?n.startWithLowercase?n.timeFormats.justNowLowercase:n.timeFormats.justNow:i.h(e,t)?Object(a.format)(n.a11yFriendly?n.timeFormats.minutesAgoShortNumbers:n.timeFormats.minutesAgoShorterNumbers,e,t,n,r):i.o(e,t)?Object(a.format)(n.a11yFriendly?n.timeFormats.hoursAgoShortNumbers:n.timeFormats.hoursAgoShorterNumbers,e,t,n,r):i.q(e,t)?Object(a.format)(n.startWithLowercase?n.timeFormats.yesterdayLongLowercase:n.timeFormats.yesterdayLong,e,t,n,r):i.j(e,t)?Object(a.format)(n.timeFormats.weekdayShort,e,t,n,r):i.a(e,t)?Object(a.format)(n.timeFormats.timestampDate,e,t,n,r):Object(a.format)(n.timeFormats.timestampDateYear,e,t,n,r):e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear()}function m(e,t,n,r){return y(n,r)&&n.timeFormats?i.o(e,t)?d(e,t,n,r):i.j(e,t)?Object(l.l)(e,n.timeFormats,"long"):i.a(e,t)?Object(a.format)(n.timeFormats.monthNameAndDate,e,t,n,r):d(e,t,n,r):e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear()}function h(e,t,n,r){return y(n,r)&&n.timeFormats?i.p(e,t)?Object(a.format)(n.timeFormats.tomorrowShort,e,t,n,r):i.l(e,t)?Object(a.format)(n.timeFormats.todayLong,e,t,n,r):i.m(e,t)?n.timeFormats.justNow:i.h(e,t)?Object(a.format)(n.timeFormats.minutesAgoShortNumbers,e,t,n,r):i.o(e,t)?Object(a.format)(n.timeFormats.hoursAgoShortNumbers,e,t,n,r):i.j(e,t)?Object(a.format)(n.timeFormats.daysAgoShortWithYesterday,e,t,n,r):i.i(e,t)?Object(a.format)(n.timeFormats.weeksAgoLongNumbers,e,t,n,r):i.g(e,t)<1?Object(a.format)(n.timeFormats.monthsAgoLongNumbers,e,t,n,r):Object(a.format)(n.timeFormats.yearsAgoLong,e,t,n,r):e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear()}function p(e,t,n,r,o){return void 0===o&&(o=!1),y(n,r)&&n.timeFormats?i.o(e,t)?Object(a.format)(n.timeFormats.todayLong,e,t,n,r):i.q(e,t)?Object(a.format)(n.timeFormats.yesterdayLong,e,t,n,r):i.j(e,t)?Object(a.format)(n.timeFormats.daysAgoLong,e,t,n,r):o&&i.i(e,t)?Object(a.format)(n.timeFormats.weeksAgoLong,e,t,n,r):o&&i.k(e,t)?Object(a.format)(n.timeFormats.monthsAgoLong,e,t,n,r):o?Object(a.format)(n.timeFormats.yearsAgoLong,e,t,n,r):Object(a.format)(n.timeFormats.generic,e,t,n,r):e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear()+" "+e.getHours()+":"+e.getMinutes()}function f(e,t,n,r){if(n){var a=new Date(e).setHours(0,0,0,0),i=new Date(t).setHours(0,0,0,0),c=Math.trunc((i-a)/o.c);return c<1?"":r.shortDurationByDays.replace(o.d,String(c))}var l=t.getTime()-e.getTime(),s=Math.trunc(l/o.c),u=Math.trunc(l/o.e)%24,d=Math.trunc(l/o.h)%60;return!s||u||d?s&&u&&!d?r.shortDurationByDaysAndHours.replace(o.d,String(s)).replace(o.f,String(u)):s&&u&&d?r.shortDurationByDaysHoursAndMinutes.replace(o.d,String(s)).replace(o.f,String(u)).replace(o.i,String(d)):s&&!u&&d?r.shortDurationByDaysAndMinutes.replace(o.d,String(s)).replace(o.i,String(d)):s||!u||d?!s&&u&&d?r.shortDurationByHoursAndMinutes.replace(o.f,String(u)).replace(o.i,String(d)):s||u||!d?"":r.shortDurationByMinutes.replace(o.i,String(d)):r.shortDurationByHours.replace(o.f,String(u)):r.shortDurationByDays.replace(o.d,String(s))}var g=function(e,t,n){return f(e,new Date(e.getTime()+Math.abs(t*o.m)),!1,n)};function b(e,t,n,r){var a=t.getTime()>e.getTime(),i=Math.abs(e.getTime()-t.getTime())>o.c,c=a?e:t,l=a?t:e,s=r?v(c,l,void 0,i):f(c,l,i,n);return""===s?n.justNowLowercase:a?n.durationFuture({p0:s}):n.durationPast({p0:s})}function v(e,t,n,r){var i=Object(c.b)(),l=t.getTime()-e.getTime();if(l<0)return"";if(r){var s=new Date(e).setHours(0,0,0,0),u=new Date(t).setHours(0,0,0,0),d=Math.trunc((u-s)/o.c);return d<1?"":Object(a.getPluralizedFormatString)(i.longDurationByDays,d,n).replace(o.o,String(d))}var m=Math.trunc(l/o.c),h=Math.trunc((l-m*o.c)/o.e),p=Math.trunc((l-m*o.c-h*o.e)/o.h);return!m||h||p?m&&h&&!p?[Object(a.getPluralizedFormatString)(i.longDurationByDays,m,n).replace(o.o,String(m)),Object(a.getPluralizedFormatString)(i.longDurationByHours,h,n).replace(o.p,String(h))].join(" "):m&&h&&p?[Object(a.getPluralizedFormatString)(i.longDurationByDays,m,n).replace(o.o,String(m)),Object(a.getPluralizedFormatString)(i.longDurationByHours,h,n).replace(o.p,String(h)),Object(a.getPluralizedFormatString)(i.longDurationByMinutes,p,n).replace(o.q,String(p))].join(" "):m&&!h&&p?[Object(a.getPluralizedFormatString)(i.longDurationByDays,m,n).replace(o.o,String(m)),Object(a.getPluralizedFormatString)(i.longDurationByMinutes,p,n).replace(o.q,String(p))].join(" "):m||!h||p?!m&&h&&p?[Object(a.getPluralizedFormatString)(i.longDurationByHours,h,n).replace(o.p,String(h)),Object(a.getPluralizedFormatString)(i.longDurationByMinutes,p,n).replace(o.q,String(p))].join(" "):m||h||!p?"":Object(a.getPluralizedFormatString)(i.longDurationByMinutes,p,n).replace(o.q,String(p)):Object(a.getPluralizedFormatString)(i.longDurationByHours,h,n).replace(o.p,String(h)):Object(a.getPluralizedFormatString)(i.longDurationByDays,m,n).replace(o.o,String(m))}function O(e,t,n,r){return void 0===n&&(n="long"),isNaN(e.getTime())?Object(a.format)(t.timeFormats.generic,new Date(432e5),new Date,t,r):i.o(e)?Object(a.format)(t.todayAsLabel?t.timeFormats.todayDayShort:t.timeFormats.todayShort,e,new Date,t,r):i.q(e)?Object(a.format)(t.timeFormats.yesterdayShort,e,new Date,t,r):i.p(e)?Object(a.format)(t.timeFormats.tomorrowShort,e,new Date,t,r):i.j(e)||i.n(e)?Object(l.l)(e,t.timeFormats,n):Object(a.format)(t.timeFormats.generic,e,new Date,t,r)}function y(e,t){if(!e.timeFormats)return Object(l.q)(t,"validateFormatStrings",{message:"Failed validating format strings: timeFormats object was not provided"}),!1;var n=[];return e.is24HourFormat||e.timeFormats.amPartOfDay||n.push("amPartOfDay"),e.is24HourFormat||e.timeFormats.pmPartOfDay||n.push("pmPartOfDay"),e.timeFormats.timeZone||n.push("timeZone"),e.timeFormats.todayShort||n.push("todayShort"),e.timeFormats.todayShortWithTimeZone||n.push("todayShortWithTimeZone"),e.timeFormats.todayDayShort||n.push("todayDayShort"),e.timeFormats.todayLong||n.push("todayLong"),e.timeFormats.yesterdayShort||n.push("yesterdayShort"),e.timeFormats.yesterdayLong||n.push("yesterdayLong"),e.timeFormats.daysAgoShort||n.push("daysAgoShort"),e.timeFormats.daysAgoLong||n.push("daysAgoLong"),e.timeFormats.weeksAgoLong||n.push("weeksAgoLong"),e.timeFormats.monthsAgoLong||n.push("monthsAgoLong"),e.timeFormats.yearsAgoLong||n.push("yearsAgoLong"),e.timeFormats.generic||n.push("generic"),!(n.length>0)||(Object(l.q)(t,"validateFormatStrings",{message:"Failed validating "+n.length+" timeFormat(s)",failedTimeFormats:n}),!1)}},397:function(e,t,n){"use strict";n.d(t,"a",function(){return a});n(94);var r=n(191);new Date(2014,1,1,15,0,0,0);function a(e){var t=Object(r.b)();return[t.sundayLong,t.mondayLong,t.tuesdayLong,t.wednesdayLong,t.thursdayLong,t.fridayLong,t.saturdayLong][e]}},400:function(e,t,n){"use strict";n.r(t),n.d(t,"format",function(){return l}),n.d(t,"formatCalendarDate",function(){return s}),n.d(t,"formatUTCCalendarDate",function(){return u}),n.d(t,"formatTimeZone",function(){return d}),n.d(t,"formatCalendarDateFromString",function(){return m}),n.d(t,"getPluralizedFormatString",function(){return h}),n.d(t,"getWeekDayDate",function(){return p}),n.d(t,"getTimeInAMPM",function(){return f}),n.d(t,"getCompleteDate",function(){return g});var r=n(496),a=n(406),i=n(94),o=n(191),c=n(95);function l(e,t,n,r,o,l){if(!e||!t||isNaN(t.valueOf())||!n||isNaN(n.valueOf()))return"";if(e.match(i.t)){var u=a.g(t,n);e=(e=h(e,u,o)).replace(i.t,String(u))}else if(e.match(i.r)){var d=a.e(t,n);e=(e=h(e,d,o)).replace(i.r,String(d))}else if(e.match(i.s)){var m=a.f(t,n);e=(e=h(e,m,o)).replace(i.s,String(m))}else if(e.match(i.o)){var p=a.b(t,n);e=(e=h(e,p,o)).replace(i.o,String(p))}else if(e.match(i.p)){var f=a.c(t,n);e=(e=h(e,f,o)).replace(i.p,String(f))}else if(e.match(i.q)){var g=a.d(t,n);e=(e=h(e,g,o)).replace(i.q,String(g))}e=(e=(e=(e=(e=e.replace(i.f,c.d(t,r.is24HourFormat,r.hostAppTimeFormat))).replace(i.i,c.e(t))).replace(i.a,c.a(t,r.timeFormats,r.is24HourFormat))).replace(i.x,c.l(t,r.timeFormats,"short"))).replace(i.g,c.l(t,r.timeFormats,"long"));var b=null!=l?l:c.j(t);return e=s(e=e.replace(i.v,c.k(b)),t,r.timeFormats)}function s(e,t,n){return e&&t&&!isNaN(t.valueOf())?e.replace(i.d,""+t.getDate()).replace(i.l,""+(t.getMonth()+1)).replace(i.k,c.f(t.getMonth(),n)).replace(i.z,""+t.getFullYear()):""}function u(e){var t=Object(o.b)(),n=t.timestampDateYear;return n&&e&&!isNaN(e.valueOf())?n.replace(i.d,""+e.getUTCDate()).replace(i.l,""+(e.getUTCMonth()+1)).replace(i.k,c.f(e.getUTCMonth(),t)).replace(i.z,""+e.getUTCFullYear()):""}function d(e,t){return e.replace(i.v,c.k(t))}function m(e,t,n){if(!e||!t||c.o(t))return"";var r=/(\d{4})-(\d{2})-(\d{2})/,a=r.exec(t);if(!r.test(t)||!a)return"";var o=parseInt(a[1],10),l=parseInt(a[2],10),s=parseInt(a[3],10);return e=(e=(e=(e=e.replace(i.d,""+s)).replace(i.l,""+l)).replace(i.k,c.f(l-1,n))).replace(i.z,""+o)}function h(e,t,n){try{return Object(r.a)(e,t)}catch(t){return c.q(n,"getPluralizedFormatString",{message:"Failed parsing pluralized format string '"+e+"'"}),e}}var p=function(e){if(!e)return"";var t=Object(o.b)();return[m(t.monthNameAndDate,e,t),c.l(new Date(e),t,"long")].join(Object(o.a)()+" ")},f=function(e,t){return e&&t?c.i(new Date(new Date(e).getTime()),t,!1,!1).toUpperCase():""},g=function(e){if(!e)return"";var t=Object(o.b)();return m(t.timestampDateYear,e,t)}},406:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"g",function(){return o}),n.d(t,"e",function(){return c}),n.d(t,"f",function(){return l}),n.d(t,"b",function(){return s}),n.d(t,"c",function(){return u}),n.d(t,"d",function(){return d}),n.d(t,"m",function(){return m}),n.d(t,"h",function(){return h}),n.d(t,"o",function(){return p}),n.d(t,"l",function(){return f}),n.d(t,"p",function(){return g}),n.d(t,"q",function(){return b}),n.d(t,"j",function(){return v}),n.d(t,"i",function(){return O}),n.d(t,"k",function(){return y}),n.d(t,"n",function(){return j});var r=n(94);function a(e,t){return void 0===t&&(t=new Date),e.getDate()===t.getDate()&&function(e,t){void 0===t&&(t=new Date);return e.getMonth()===t.getMonth()&&i(e,t)}(e,t)}function i(e,t){return void 0===t&&(t=new Date),e.getFullYear()===t.getFullYear()}function o(e,t){var n=t.getTime(),a=e.getTime();return Math.floor((n-a)/r.y)}function c(e,t){var n=t.getTime(),a=e.getTime();return Math.floor((n-a)/r.j)}function l(e,t){var n=t.getTime(),a=e.getTime();return Math.ceil((n-a)/r.w)}function s(e,t,n){var a=t.getTime(),i=e.getTime();return n&&1===n?Math.floor((a-i)/r.c):Math.ceil((a-i)/r.c)}function u(e,t){var n=t.getTime(),a=e.getTime();return Math.abs(Math.ceil((n-a)/r.e))}function d(e,t){var n=t.getTime(),a=e.getTime();return Math.abs(Math.ceil((n-a)/r.h))}function m(e,t){return void 0===t&&(t=new Date),Boolean(e&&t.getTime()-e.getTime()<r.h)}function h(e,t){return void 0===t&&(t=new Date),Boolean(e&&t.getTime()-e.getTime()<r.e)}function p(e,t){return void 0===t&&(t=new Date),!!e&&a(e,t)}function f(e,t){return void 0===t&&(t=new Date),!!e&&(!!a(e,t)&&t.getTime()-e.getTime()<0)}function g(e,t){return void 0===t&&(t=new Date),!!e&&a(e,new Date(t.getTime()+r.c))}function b(e,t){return void 0===t&&(t=new Date),!!e&&a(new Date(t.getTime()-r.c),e)}function v(e,t){void 0===t&&(t=new Date);var n=t.getTime()-e.getTime(),a=n<r.w&&n>=0,i=t.getDay()===e.getDay()&&n>=r.c;return a&&!i}function O(e,t){void 0===t&&(t=new Date);var n=t.getTime()-e.getTime();return n<r.j&&n>=0}function y(e,t){void 0===t&&(t=new Date);var n=t.getTime()-e.getTime();return n<r.y&&n>=0}function j(e,t){void 0===t&&(t=new Date);var n=t.getTime(),a=e.getTime()-n;return a<r.w&&a>=0}},410:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";function a(){return r.replace(/[xy]/g,function(e){var t;if(window.crypto){var n=new Uint8Array(1);window.crypto.getRandomValues(n),t=n[0]}else t=Math.floor(16*Math.random());return("x"===e?t%16:t%4+8).toString(16)})}},496:function(e,t,n){"use strict";n.d(t,"a",function(){return g});var r=n(1),a=n(246),i=n(96),o=n(516),c="||",l="::",s=",",u=["->","–>","-","–"],d="INF",m="*",h=/^\d+$/;function p(e){var t=Object(a.a)(u,function(t){return e.indexOf(t)>=0}),n=t?e.split(t).map(function(e){return e.trim()}):[e.trim()];if(1===n.length){var r=n[0];if(Object(i.e)(r,m)){var o=r.substring(m.length);return o.match(h)?function(e){return Object(i.b)(e.toString(),o)}:null}return r.match(h)?function(e){return e.toString()===r}:null}if(2===n.length){if(!n[0].match(h))return null;var c=parseInt(n[0],10);if(isNaN(c))return null;if(n[1]===d)return function(e){return e>=c};if(!n[1].match(h))return null;var l=parseInt(n[1],10);return isNaN(l)?null:function(e){return e>=c&&e<l}}return null}function f(e,t){var n,a,i,o,u=function(t){throw new Error('pluralized string "'+e+'" '+t)};try{for(var d=Object(r.__values)(e.split(c)),m=d.next();!m.done;m=d.next()){var h=m.value,f=h.split(l);2!==f.length&&u("is missing separator "+l+' in clause "'+h+'"');var g=Object(r.__read)(f,2),b=g[0],v=g[1];try{for(var O=(i=void 0,Object(r.__values)(b.split(s))),y=O.next();!y.done;y=O.next()){var j=y.value,S=p(j);if(null===S)u('contains invalid range "'+j+'"');else if(!t(v,S))return}}catch(e){i={error:e}}finally{try{y&&!y.done&&(o=O.return)&&o.call(O)}finally{if(i)throw i.error}}}}catch(e){n={error:e}}finally{try{m&&!m.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}}function g(e,t){if(void 0===t)return e;try{return function(e,t){if(t<0||t!==1/0&&!Object(o.a)(t))throw new Error("count must be a positive integer or Infinity");var n="";return f(e,function(e,r){return!r(t)||(n=e,!1)}),n}(e,t)}catch(t){return e}}},503:function(e,t,n){"use strict";n.r(t),n.d(t,"HeroCardRouterContainer",function(){return Fs});var r=n(170),a=n(1),i=n(15),o=i.createContext(void 0);var c=function(e){var t=e.target,n=Object(a.__rest)(e,["target"]),r=i.useContext(o);return i.createElement("a",Object(a.__assign)({target:t||r},n,{id:n.id}))},l=n(258),s=n(17),u=n(79);var d=n(175),m=n(197),h=n(131),p=n(190);n(349);var f=n(151),g=n(13),b=n(150),v=n(73);function O(){return Object(u.useSelector)(g.k)}var y=["SkypeTeams","Yammer","Exchange"],j=n(381),S=n(6),x=n(22),C=n(11);function k(e){var t=function(e){if(Object(S.z)(e))return Object(C.h)(e);var t=Object(x.g)(e);return t&&"Conversation"===t.domain?t.provenance:void 0}(e);return t?Object(j.a)(y,function(e){return e===t?-1:0}):y}var E,w=n(337),T=n(146),P=n(282),I=(E=function(e,t){return(E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}E(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),N=function(e){function t(t){var n=e.call(this,t)||this;return n.state={hasError:!1},n}return I(t,e),t.getDerivedStateFromError=function(){return{hasError:!0}},t.prototype.componentDidCatch=function(e,t){var n=this.props,r=n.appContext,a=n.codeLocation;Object(T.g)(r.logger,a+".componentDidCatch:"+t.componentStack,e)},t.prototype.render=function(){return this.state.hasError?null:this.props.children},t}(i.Component),A=Object(P.a)(N),F=n(93),D=n(127),L=n(27),R=n(69),W=n(189),H=n(65),M=n(8),B=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),z=function(){return(z=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function _(e){return{heroDomain:Object(M.c)(e),allResultDomains:Object(M.a)(e),domainsFilter:Object(S.e)(e),areConnectorsEnabled:Object(S.b)(e),variantEnabledAsyncDomains:Object(g.l)(e)}}var U=n(64),q=(n(278),n(252)),V=n(39),K=n(46),Q=n(387),Y=n(24),G=(n(480),n(2)),J=n(109),$=n(35);function Z(e,t){return void 0===t&&(t=G.c),Object(Q.a)(Object(U.filterOutNull)(Object(Y.a)(e,function(e){return t(e)})))}function X(e,t,n,r,a,i,o,c,l,s,u,d,m){if(!Object(R.a)(t)){var h={cardType:a,clientSize:i,eventScope:r,count:Object(q.a)(t).toString(),isHero:o,pageNumber:c,target:l||Z(t),entityId:Z(t,G.b),initialHeroImpression:s,placement:u,value:d,queryType:m};Object(G.p)(e,{properties:h,eventId:n})}}var ee="Hero";function te(){var e=Object(u.useSelector)(C.v),t=i.useState(!1),n=t[0],r=t[1],a=Object(w.a)(),o=Object(l.b)(),c=Object(u.useSelector)(C.C);i.useEffect(function(){e&&!n&&(r(!0),function(e,t,n,r,a,i){var o={eventScope:"AnswerRoot",cardType:t,clientSize:n,target:r,alreadySignedIn:a,ssoSignedIn:i};Object(G.p)(e,{properties:o,eventId:"Answer_Impression"})}(a,ee,o,c?"Hide":"Shown"))},[e,a,c])}var ne=n(89);n(515);var re=n(283),ae=n(58),ie=n(37);var oe=60;function ce(){return window.performance?performance.now():Date.now()}function le(e){var t=i.useRef({}),n=i.useRef(ce());t.current.logger=Object(w.a)(),t.current.clientSize=Object(l.b)(),t.current.muid=Object(l.e)(),t.current.prevStaticProperties=Object(l.g)(),t.current.isSuppressed=Object(u.useSelector)(g.z),t.current.isHero=Object(u.useSelector)(g.y),t.current.heroDomain=Object(u.useSelector)(M.c);var r=function(e){var r=t.current,i=r.logger,o=r.clientSize,c=r.isSuppressed,l=r.isHero,s=r.heroDomain;n.current&&!c&&i&&o&&(!function(e,t,n,r,i,o){var c=n&&Object($.b)(n),l=Object(a.__assign)({name:"DwellTime",value:t.toString(),eventScope:c,clientSize:r,isHero:i},o||{});Object(G.B)(e,{eventId:"DwellTime",properties:l})}(i,ce()-n.current,s,o,!!l,e),n.current=ce())};return i.useEffect(function(){return function(){r(t.current.prevStaticProperties)}},[e]),i.useEffect(function(){var e=new Date,n=Object(ne.b)(re.a),r=t.current,a=r.logger,i=r.clientSize,o=r.muid;if(n&&a&&i){var c=JSON.parse(n),l=e.getTime()-c.time;if(c.muid===o&&l<1e3*oe){var s=c.eventScope,u=c.clickEventId,d=c.entityId,m=c.isHero;!function(e,t,n,r,a,i,o,c,l,s,u){var d={name:"DwellTime",conversationId:t,impressionGuid:n,logicalSearchId:r,value:o.toString(),eventScope:c,clientSize:l,isHero:s,targetId:i,targetEventId:a,page:u};Object(G.B)(e,{eventId:"ClickDwellTime",properties:d})}(a,c.conversationId,c.impressionGuid,c.logicalSearchId,u,d||"",l,s,i,!!m,c.page)}Object(ne.c)(re.a)}},[re.a]),r}var se=n(130),ue=n(177),de=n(245),me=n(41),he=n(28);function pe(e,t){void 0===t&&(t=!0);var n=i.useRef(void 0);return i.useEffect(function(){(t||null!=e)&&(n.current=e)},[e]),n.current}var fe=function(e,t,n,r){return new(n||(n=Promise))(function(a,i){function o(e){try{l(r.next(e))}catch(e){i(e)}}function c(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,c)}l((r=r.apply(e,t||[])).next())})},ge=function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}};var be=n(198);function ve(e,t){var n=function(e){switch(e){case"Bookmark":return{BookmarkAnswerTriggered:!0};case"Calendar":return{CalendarAnswerTriggered:!0};case"File":return{FileAnswerTriggered:!0};case"Flight":return{FlightAnswerTriggered:!0};case"Person":return{PersonAnswerTriggered:!0};case"Acronym":return{AcronymAnswerTriggered:!0};case"Link":return{LinkAnswerTriggered:!0};case"TuringQnA":return{TuringQnAAnswerTriggered:!0};default:return}}(t);if(n){var r={TriggerConditions:n};Object(G.m)(e,r)}}var Oe=n(19),ye=n(430);function je(e,t,n,r,a){var i,o,c=t.offsetWidth,l=t.offsetHeight;if(a&&(0===c&&(c=(null===(i=t.parentElement)||void 0===i?void 0:i.offsetWidth)||0),0===l&&(l=(null===(o=t.parentElement)||void 0===o?void 0:o.offsetHeight)||0)),!n||n.offsetWidth!==c||n.offsetHeight!==l){var s=0;try{s=null==t?void 0:t.getBoundingClientRect().width}catch(n){console.log("element "+t+" is not on DOM when calling 'element.getBoundingClientRect()' in useDimension from "+e)}r({offsetWidth:c,offsetHeight:l,preciseOffsetWidth:s})}}function Se(e,t){var n=i.useState({offsetWidth:0,offsetHeight:0,preciseOffsetWidth:0}),r=n[0],a=n[1],o=pe(r),c=function(e){var t=i.useRef(null);return i.useEffect(function(){if(t&&t.current){var n=t.current,r=new ye.a(function(t){window.requestAnimationFrame(function(){Array.isArray(t)&&t.length&&(t[0].target===n&&e(n.clientHeight,n.clientWidth))})});return r.observe(n),function(){r.unobserve(n)}}},[t]),[t]}(function(){var n=c.current;n&&je(e,n,o,a,t)})[0];return i.useEffect(function(){var n=c.current;n&&je(e,n,o,a,t)}),[c,r]}function xe(e,t,n,r){var a=Se(e+" + useDynamicClientSize"),i=a[0],o=a[1];return 0===o.offsetWidth?[i,n]:[i,r?r():o.offsetWidth<=t?"Small":"Large"]}var Ce=n(411),ke=n(339);function Ee(){var e=i.useContext(Ce.a);return ke.a.getSettings(["theme"],"WithTheme",e.customizations).theme}var we=n(421),Te=n(518),Pe=n(103),Ie=n(511),Ne=n(383),Ae=n(43),Fe="<sep/>";Object(Pe.a)(function(e,t,n,r){return t?function(e,t){var n=(r=t,a=Object(Ie.a)(r,RegExp("\\W+","g")),i="",Object(V.a)(a,function(e){return i+=(i.length>0?"|":"")+"(\\b"+e+"\\b)"}),new RegExp(i,"gi"));var r,a,i;return De(e,n)}(e,t):function(e,t,n){if(!t||!n)return[e];var r=new RegExp(t+".*?"+n,"gi");return De(e,r)}(e,n,r)});function De(e,t){var n=Object(Ne.a)(e,t,function(e){return""+Fe+e+Fe});return Le(Object(Ie.a)(n,Fe))}function Le(e){return Object(W.a)(e,function(e){return!!e})}function Re(e,t){!t||"Enter"!==e.key&&" "!==e.key||t()}function We(e){return"https://outlook.office365.com/owa/?viewmodel=ReadMessageItem&ItemID="+encodeURIComponent(e)+"&exvsurl=1&path="}var He=function(e){return e.replace(/-/g,"/").replace(/_/g,"+")},Me=n(0),Be=((Object(Me.declareStringWithPlaceholders)("search-components.search.shared.ResultsCount")),(Object(Me.declareStringWithPlaceholders)("search-components.search.shared.resultsCountPlus")),(Object(Me.declareString)("search-components.search.shared.ResultsCount1")),(Object(Me.declareString)("search-components.search.shared.seeProfile")),(Object(Me.declareString)("search-components.search.shared.getDirections")),(Object(Me.declareString)("search-components.search.shared.seeFullMap")),(Object(Me.declareStringWithPlaceholders)("search-components.search.shared.numberMore")),(Object(Me.declareStringWithPlaceholders)("search-components.search.shared.relatedTo")),(Object(Me.declareString)("search-components.search.shared.somethingWentWrong")),(Object(Me.declareString)("search-components.search.shared.clickToRetry")),(Object(Me.declareString)("search-components.search.shared.noResultFound")),(Object(Me.declareString)("search-components.search.shared.noEduResultFound")),(Object(Me.declareString)("search-components.search.shared.moreResults")),(Object(Me.declareString)("search-components.search.shared.noResultMessage")),(Object(Me.declareString)("search-components.search.shared.learnMore")),(Object(Me.declareString)("search-components.search.shared.learnMoreWorkPrivacy")),(Object(Me.declareString)("search-components.search.shared.learnMoreAboutMicrosoftSearch")),(Object(Me.declareString)("search-components.search.shared.microsoftSearch")),(Object(Me.declareString)("search-components.search.shared.seeMore"))),ze=(Object(Me.declareString)("search-components.search.shared.seeLess")),_e=((Object(Me.declareString)("search-components.search.shared.dataFromLabel")),(Object(Me.declareStringWithPlaceholders)("search-components.search.shared.viewAllWithCount")),(Object(Me.declareString)("search-components.search.shared.openInBrowser")),(Object(Me.declareString)("search-components.search.shared.ellipsisString"))),Ue=((Object(Me.declareString)("search-components.search.shared.seeMoreOnOffice")),(Object(Me.declareStringWithPlaceholders)("search-components.search.shared.seeMoreOn")),(Object(Me.declareString)("search-components.search.shared.clickToCollapse")),(Object(Me.declareString)("search-components.search.shared.bingMap")),(Object(Me.declareStringWithPlaceholders)("search-components.search.shared.scopeCardAriaLabel")),(Object(Me.declareString)("search-components.search.shared.plus")),(Object(Me.declareString)("search-components.search.shared.defaultTenantDisplayName")),(Object(Me.declareString)("search-components.search.shared.illustration"))),qe=((Object(Me.declareStringWithPlaceholders)("search-components.search.shared.tenantResults")),(Object(Me.declareString)("search-components.search.shared.copy")),(Object(Me.declareString)("search-components.search.shared.semanticTitle")),(Object(Me.declareString)("search-components.search.shared.semanticDescription")),(Object(Me.declareString)("search-components.search.shared.semanticButton")),(Object(Me.declareString)("search-components.search.shared.event"))),Ve=(Object(Me.declareString)("search-components.search.shared.file")),Ke=(Object(Me.declareString)("search-components.search.shared.people")),Qe=((Object(Me.declareString)("search-components.search.shared.work")),(Object(Me.declareString)("search-components.search.shared.school")),(Object(Me.declareString)("search-components.search.navmenu.all")),(Object(Me.declareString)("search-components.search.shared.closeButton"))),Ye=((Object(Me.declareString)("search-components.search.shared.listGenericTitleNoQuery")),(Object(Me.declareStringWithPlaceholders)("search-components.search.shared.listGenericTitleWithQuery")),(Object(Me.declareStringWithPlaceholders)("search-components.search.shared.listVerticalTitleNoQuery")),(Object(Me.declareStringWithPlaceholders)("search-components.search.shared.listVerticalTitleWithQuery")),(Object(Me.declareString)("search-components.search.shared.workResultIndicatorText")),(Object(Me.declareString)("search-components.search.shared.answerTile")));var Ge=n(341),Je=function(e){return{margin:"0 "+(e?12:24)+"px",padding:"8px 0"}},$e=Object(Pe.a)(function(e,t,n,r,a,i,o,c,l){var s=e.palette,u=s.neutralLighter,d=s.neutralLighterAlt,m=s.themePrimary;return Object(Ge.s)({bodyContainer:["ms-search-heroTile-bodyContainer",Je(t),{overflow:"hidden"},l?l(e).bodyStyles:{}],headerContainer:["ms-search-heroTile-headerContainer",Je(t),{borderBottom:"1px solid "+u,display:"flex",alignItems:"center"},l?l(e).headerStyles:{}],footerContainer:["ms-search-heroTile-footerContainer",{backgroundColor:d,height:"48px",overflow:"hidden",display:"flex"},l?l(e).footerStyles:{}],tileContainer:{display:"flex",flexDirection:"Top"===n?"column":"Bottom"===n?"column-reverse":"Right"===n?"row-reverse":"row",cursor:c?"pointer":"default"},imageContainer:{cursor:o?"pointer":"auto",overflow:"inherit",selectors:{"> img":{backgroundColor:m,width:a,maxWidth:i,height:r}}},content:{width:"100%"},cardStyles:[l?l(e).cardStyles:{}]})}),Ze=Object(Pe.a)(function(e){var t=e.palette.neutralPrimary;return Object(Ge.s)({root:["ms-search-heroTile-dismissButton",{marginLeft:"auto",float:"right"}],icon:["ms-search-heroTile-dimissButton-icon",{color:t}]})}),Xe=n(102);(Object(Me.declareString)("search-components.search.privacy.learnMoreAboutPrivacy")),(Object(Me.declareString)("search-components.search.shared.whoCanSeeWorkResults")),(Object(Me.declareString)("search-components.search.shared.whoCanSeeEduResults")),(Object(Me.declareStringWithPlaceholders)("search-components.search.shared.PrivacyNotice")),(Object(Me.declareString)("search-components.search.shared.privacyNoticeResults")),(Object(Me.declareString)("search-components.search.shared.privacyNoticeResultsSmall")),(Object(Me.declareString)("search-components.search.shared.privacyNoticeResultsForEduLicenses")),(Object(Me.declareStringWithPlaceholders)("search-components.search.shared.privacyNoticeResultsLimited")),(Object(Me.declareStringWithPlaceholders)("search-components.search.shared.privacyNoticeEduResultsLimited")),(Object(Me.declareString)("search-components.search.shared.privacySearchHistory")),(Object(Me.declareString)("search-components.search.shared.privacySearchHistoryEdu")),(Object(Me.declareString)("search-components.search.shared.privacyLinkContent")),(Object(Me.declareString)("search-components.search.shared.privacyLinkEduContent")),(Object(Me.declareString)("search-components.search.shared.privacy")),(Object(Me.declareString)("search-components.search.shared.dismiss")),(Object(Me.declareString)("search-components.search.shared.peopleResultsMessage")),(Object(Me.declareString)("search-components.search.shared.otherResultsMessage"));function et(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Object(U.filterOutNull)(e).join(" ")}var tt=function(e,t,n){if(t&&n)return e?e({name:t,emailAddress:n}):void 0};var nt=n(338),rt=Object(nt.b)(function(e,t){var n;return Object(Ge.s)({heroTileFrame:["ms-search-heroFrame",{background:e.palette.white,margin:"12px 12px 17px 12px",borderRadius:"2px",boxShadow:e.effects.elevation4,border:"1px solid "+e.palette.neutralLighterAlt,selectors:(n={"&:hover":{boxShadow:e.effects.elevation8},"&:active":{boxShadow:e.effects.elevation4}},n["&.ms-search-maxWidth"]={maxWidth:t||"603px"},n["&.ms-search-image-maxWidth"]={maxWidth:t||"871px"},n["&.ms-search-maxContent"]={maxWidth:"fit-content",minWidth:"360px"},n["&.ms-search-IEAdjustment"]={marginRight:"24px"},n)}]})}),at=function(e){var t,n,r,a=e.className,o=e.cardStyles,c=Ee(),l=rt(c).heroTileFrame,s=!(r=null===(n=null===(t=null===window||void 0===window?void 0:window.navigator)||void 0===t?void 0:t.userAgent)||void 0===n?void 0:n.toLowerCase())||-1===r.indexOf("msie")&&-1===r.indexOf("edge")&&-1===r.indexOf("rv:11.0")?void 0:"ms-search-IEAdjustment";return i.createElement("div",{className:et(l,a,o,s)},e.children)};at.displayName="HeroTileFrame";var it=function(e){var t=e.body,n=e.className,r=e.header,a=e.footer,o=e.isSmall,c=e.imageProps,l=e.styleOverrides,s=e.cardClickProps,u=e.onDismiss,d=e.isDismissible,m=null==c?void 0:c.imagePosition,h=null==c?void 0:c.imageHeight,p=null==c?void 0:c.imageWidth,f=null==c?void 0:c.imageMaxWidth,g=null==c?void 0:c.headerImageUrl,b=null==c?void 0:c.onImageClick,v=Ee(),O=i.useState(!0),y=O[0],j=O[1],S=function(){d&&u&&u(),j(!1)},x=$e(v,void 0===o||o,m,h,g&&p,f,!!b,!!s,l),C=x.headerContainer,k=x.bodyContainer,E=x.footerContainer,w=x.tileContainer,T=x.imageContainer,P=x.content,I=x.cardStyles,N=null==s?void 0:s.onCardClick,A=null==s?void 0:s.clickRole,F=function(){b&&b()},D=function(e){var t;null===(t=e.currentTarget.parentElement)||void 0===t||t.setAttribute("hidden","true")},L={iconName:Ae.d};return i.createElement(i.Fragment,null,y&&i.createElement(at,{className:n,cardStyles:I},i.createElement("div",{role:A||"presentation",className:w,tabIndex:N?0:-1,onClick:N,onKeyPress:function(e){e.preventDefault(),Re(e,function(){return null==N?void 0:N()})},"aria-label":Ye()},!o&&m&&g&&i.createElement(we.a,{alt:Ue(),src:g,className:T,onClick:F,onError:function(e){return D(e)}}),i.createElement("div",{className:P},r&&i.createElement("div",{className:C},r,d&&i.createElement(Te.a,{iconProps:L,onClick:function(e){return function(e){e.stopPropagation(),S()}(e)},onKeyPress:function(e){e.stopPropagation(),Re(e,S)},styles:Ze(v),title:Qe(),ariaLabel:Qe()})),o&&m&&g&&i.createElement(we.a,{alt:Ue(),role:"presentation",src:g,className:T,onClick:F,onError:function(e){return D(e)}}),i.createElement("div",{className:k},t),a&&i.createElement("div",{className:E},a)))))},ot=n(147),ct=n(513),lt="Arial, Helvetica, sans-serif",st="'SF UI Text', HelveticaNeue, Roboto, Arial, sans-serif",ut=13,dt=17;var mt=function(e){return["ms-search-text",e.fonts.small,{fontSize:ut+"px",lineHeight:dt+"px"}]};var ht=function(e){return{color:e.palette.themePrimary,textDecoration:"none",cursor:"pointer",selectors:{":hover":{textDecoration:"underline"}}}},pt=function(e){return[mt(e),ht(e),{selectors:{span:{verticalAlign:"middle"}}}]},ft=function(e){return["ms-search-text-s",e.fonts.tiny,{fontSize:"11px",lineHeight:"13px",color:e.palette.neutralPrimary}]},gt={maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis"},bt=[gt,{whiteSpace:"nowrap"}],vt=Object(Pe.a)(function(e){return Object(Ge.s)({icon:{fontSize:11,verticalAlign:"middle",cursor:"pointer",color:e.palette.neutralPrimary},link:{marginLeft:"4px"}})}),Ot="https://support.microsoft.com/en-us/office/find-acronym-definitions-89062352-e1ce-4f59-b58c-f94869521404",yt=function(e){var t=Ee(),n=vt(t),r=e.onPrivacyIconClick,a=e.openLink,o=function(e){null==e||e.preventDefault(),a?a(Ot):window.open(Ot,"_blank"),null==r||r()};return i.createElement("a",{href:Ot,className:n.link,target:"_blank",tabIndex:0,onClick:function(e){return null==o?void 0:o(e)},onKeyPress:function(e){return Re(e,o)},"aria-label":Object(ot.l)()},i.createElement(ct.a,{iconName:"Info",className:n.icon}))},jt=n(501),St=((Object(Me.declareString)("search-components-carousel.search.carousel.scrollLeft")),(Object(Me.declareString)("search-components-carousel.search.carousel.scrollRight")),(Object(Me.declareString)("search-components-carousel.search.carousel.nextPage"))),xt=(Object(Me.declareString)("search-components-carousel.search.carousel.previousPage")),Ct=(Object(Me.declareStringWithPlaceholders)("search-components-carousel.search.carousel.pageNumber")),kt=(Object(Me.declareStringWithPlaceholders)("search-components-carousel.search.carousel.pageNumberSelected")),Et=(Object(Ge.r)({"0%":{opacity:.6},"50%":{opacity:1},"100%":{opacity:.6}}),Object(Ge.r)({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}}),function(e,t){return{visibility:"visible",opacity:1,transition:"opacity "+e+"ms",transitionTimingFunction:t}}),wt=function(e,t){return{visibility:"hidden",opacity:0,transition:"visibility 0s linear "+e+"ms, opacity "+e+"ms",transitionTimingFunction:t}},Tt=Object(Pe.a)(function(e,t,n,r,a){var i=e.palette.neutralSecondary;return Object(Ge.s)({nextIconContainer:{width:"30px",fontSize:"14px",height:"24px",marginTop:"8px",float:"left",display:"flex"},carouselContainer:{position:"relative"},nextIcon:{display:n?"none":void 0,alignSelf:"center",color:i,marginLeft:"-4px",selectors:{":hover":{color:i}}},previousIconContainer:{width:"30px",fontSize:"14px",height:"24px",marginTop:"8px",float:"left",display:"flex"},previousIcon:{display:t?"none":void 0,alignSelf:"center",color:i,marginLeft:"4px",selectors:{":hover":{color:i}}},pageBar:{width:"calc(100% - 62px)",height:"24px",float:"left",display:"flex",justifyContent:"center",marginTop:"8px",alignItems:"center"},footer:{height:"40px"},body:[Et(r,a),{width:"100%"}],hidden:[wt(r,a),{position:"absolute",top:"0",width:"100%"}]})}),Pt=Object(Pe.a)(function(e,t){var n=e.palette.neutralSecondary;return Object(Ge.s)({dot:{height:"7px",width:"7px",marginRight:"8px",border:"1px solid "+n,background:t?n:"",opacity:t?"100%":"40%",borderRadius:"50%",display:"inline-block",selectors:{":hover":{opacity:t?"100%":"65%",cursor:t?"auto":"pointer"}}}})}),It=function(e){var t=e.pages,n=e.onNextButtonClick,r=e.onPreviousButtonClick,a=e.onDotButtonClick,o=Ee(),c=i.useState(0),l=c[0],s=c[1],u=t.length,d=Tt(o,0===l,l===u-1,500,"cubic-bezier(0.3,0.55,0.1,1.0)"),m=d.nextIconContainer,h=d.previousIconContainer,p=d.pageBar,f=d.footer,g=d.body,b=d.hidden,v=d.nextIcon,O=d.previousIcon,y=d.carouselContainer,j=i.useRef(null);function S(e){var t;s(e),a&&a(e),null===(t=j.current)||void 0===t||t.focus()}return i.createElement("div",{className:y,tabIndex:-1,ref:j},t.map(function(e,t){return t===l?i.createElement("div",{key:"page"+t,className:g,tabIndex:-1},e):i.createElement("div",{key:"page"+t,className:b},e)}),i.createElement("div",{className:f},i.createElement("div",{className:h},i.createElement(Te.a,{iconProps:{iconName:"ChevronLeftMed"},title:xt(),"aria-label":xt(),onClick:function(){var e;s(l-1),r&&r(l-1),null===(e=j.current)||void 0===e||e.focus()},className:O})),i.createElement("div",{className:p},Object(jt.a)(t.length,function(e){var t=Pt(o,e===l).dot,n=e===l?-1:0,r=e!==l?Ct({index:(e+1).toString()}):void 0,a=e!==l?Ct({index:(e+1).toString()}):kt({index:(e+1).toString()});return i.createElement("span",{className:t,key:"dot"+e,onClick:function(){return S(e)},tabIndex:n,onKeyPress:function(){return S(e)},title:r,"aria-label":a,role:"button"})})),i.createElement("div",{className:m},i.createElement(Te.a,{iconProps:{iconName:"ChevronRightMed"},title:St(),"aria-label":St(),onClick:function(){var e;s(l+1),n&&n(l+1),null===(e=j.current)||void 0===e||e.focus()},className:v}))))},Nt=Object(Pe.a)(function(e){var t=e.palette.neutralLight;return Object(Ge.s)({pageContainer:{minHeight:"182px",borderBottom:"1px solid",borderColor:t}})}),At=function(){return(At=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Ft=function(e){var t,n=e.numberOfResults,r=e.acronymViews,a=e.setactivePage,o=e.onAcronymCarouselClick,c=[],l=Ee(),s=Nt(l).pageContainer;for(t=0;t<n/3;t++){var u=r.slice(3*t,Math.min(3*(t+1),n)),d=i.createElement("div",{className:s},u);c.push(d)}var m={pages:c,onNextButtonClick:function(e){a(e),o&&o("Acronym_Carousel_Next_Click",(e+1).toString())},onPreviousButtonClick:function(e){a(e),o&&o("Acronym_Carousel_Previous_Click",(e+1).toString())},onDotButtonClick:function(e){a(e),o&&o("Acronym_Carousel_Page_Click",(e+1).toString())}};return i.createElement(It,At({},m))},Dt=n(495),Lt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Rt=function(){return(Rt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};var Wt=n(499),Ht={black:{red:0,green:0,blue:0,alpha:1},transparent:{red:0,green:0,blue:0,alpha:0},white:{red:255,green:255,blue:255,alpha:1}};function Mt(e,t,n){if(!t||!(t<0||t>1)){var r=function(e,t){if(void 0===t&&(t=!1),(e=e.toLowerCase())in Ht)return Ht[e];var n=e.match(/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/);if(n)return t?{alpha:parseInt(n[1],16)/255,red:parseInt(n[2],16),green:parseInt(n[3],16),blue:parseInt(n[4],16)}:{red:parseInt(n[1],16),green:parseInt(n[2],16),blue:parseInt(n[3],16),alpha:parseInt(n[4],16)/255};var r=e.match(/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/);if(r)return{red:parseInt(r[1],16),green:parseInt(r[2],16),blue:parseInt(r[3],16),alpha:1};var a=e.match(/^#([0-9a-f])([0-9a-f])([0-9a-f])([0-9a-f])$/);if(a)return t?{alpha:parseInt(""+a[1],16)/15,red:parseInt(""+a[2]+a[2],16),green:parseInt(""+a[3]+a[3],16),blue:parseInt(""+a[4]+a[4],16)}:{red:parseInt(""+a[1]+a[1],16),green:parseInt(""+a[2]+a[2],16),blue:parseInt(""+a[3]+a[3],16),alpha:parseInt(""+a[4],16)/15};var i=e.match(/^#([0-9a-f])([0-9a-f])([0-9a-f])$/);if(i)return{red:parseInt(""+i[1]+i[1],16),green:parseInt(""+i[2]+i[2],16),blue:parseInt(""+i[3]+i[3],16),alpha:1};var o=e.replace(/\s/g,"").match(/^rgb\(([0-9\.]+),([0-9\.]+),([0-9\.]+)\)/);if(o)return{red:Number(o[1]),green:Number(o[2]),blue:Number(o[3]),alpha:1};var c=e.replace(/\s/g,"").match(/^rgba\(([0-9\.]+),([0-9\.]+),([0-9\.]+),([0-9\.]+)\)/);return c?{red:Number(c[1]),green:Number(c[2]),blue:Number(c[3]),alpha:Number(c[4])}:{red:0,green:0,blue:0,alpha:1}}(e),a=r.red,i=r.green,o=r.blue,c=r.alpha,l=null!=t?t:c,s=a+","+i+","+o+(1!==l?","+l:"");return n?s:1!==l?"rgba("+s+")":"rgb("+s+")"}}var Bt,zt,_t=Object(nt.b)(function(e,t){return Object(Ge.s)({h1:{fontSize:"2em",margin:".67em 0"},h2:{fontSize:"1.5em",margin:".83em 0"},h3:{fontSize:"1.17em",margin:"1em 0"},h4:{margin:"1.33em 0"},code:{background:Mt(e.palette.white,.05),borderRadius:"2px"},blockquote:{padding:"0 1rem",marginLeft:"0",color:"#819198",borderLeft:".3rem solid #dce6f0"},ol:{paddingLeft:"40px",selectors:{"> li":{listStyleType:"decimal"},".ms-search-text &":{paddingLeft:"40px"}}},ul:{paddingLeft:"40px",selectors:{"> li":{listStyleType:"disc"},".ms-search-text &":{paddingLeft:"40px"}}},td:{border:"1px solid",padding:"8px"},th:{border:"1px solid",padding:"8px",fontWeight:"bold"},p:{selectors:{"+ &":{marginTop:t?"0px":"1em"}}}})}),Ut=(Bt=function(e){return function(e){var t=e.theme,n=e.item,r=e.isCompactView,a=e.onLinkClick,o=_t(t,r);switch(Object(Wt.a)(n.type)){case"a":return i.createElement(c,{href:n.href,title:n.title,onClick:a},qt(e));case"blockquote":return i.createElement("blockquote",{className:o.blockquote},qt(e));case"br":return i.createElement("br",null);case"code":return i.createElement("code",{className:et(o.code,n.class)},qt(e));case"div":return i.createElement("div",null,qt(e));case"em":return i.createElement("em",null,qt(e));case"h1":return i.createElement("h1",{className:o.h1},qt(e));case"h2":return i.createElement("h2",{className:o.h2},qt(e));case"h3":return i.createElement("h3",{className:o.h3},qt(e));case"h4":return i.createElement("h4",{className:o.h4},qt(e));case"hr":return i.createElement("hr",null,qt(e));case"img":return i.createElement("img",{src:n.src,title:n.title,alt:n.alt},qt(e));case"li":return i.createElement("li",null,qt(e));case"ol":return i.createElement("ol",{className:o.ol},qt(e));case"p":return i.createElement("p",{className:o.p},qt(e));case"pre":return i.createElement("pre",null,qt(e));case"strong":return i.createElement("strong",null,qt(e));case"text":return i.createElement(i.Fragment,null,n.text);case"span":return i.createElement("span",null,qt(e));case"ul":return i.createElement("ul",{className:o.ul},qt(e));case"table":return i.createElement("table",null,qt(e));case"thead":return i.createElement("thead",null,qt(e));case"tbody":return i.createElement("tbody",null,qt(e));case"tr":return i.createElement("tr",null,qt(e));case"th":return i.createElement("th",{style:Vt(n),className:o.th},qt(e));case"td":return i.createElement("td",{style:Vt(n),className:o.td},qt(e));default:return null}}(e)},zt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Lt(t,e),t.prototype.render=function(){return i.createElement(Bt,Rt({},this.props))},t}(i.Component),Object(Dt.a)("WithTheme",["theme"])(zt));function qt(e){var t=e.item,n=e.isCompactView,r=e.onLinkClick;if(!t.children)return null;if(1===Object(q.a)(t.children)&&"text"===Object(Wt.a)(t.children[0].type)){for(var a=t.children[0].text,o=a&&Object(Ie.a)(a,"\n")||[],c=[],l=0,s=0;s<o.length;s++){var u={type:"text",text:o[s]};c.push(i.createElement(Ut,{item:u,key:l,isCompactView:n})),l++,s<o.length-1&&(c.push(i.createElement("br",{key:l})),l++)}return c}return Object(Y.a)(t.children,function(e,t){return i.createElement(Ut,{item:e,key:t,isCompactView:n,onLinkClick:r})})}function Vt(e){if(e&&e.style)try{var t={},n=Object(W.a)(Object(Ie.a)(e.style,";"),function(e){return!!e});return Object(V.a)(n,function(e){var n=Object(Y.a)(Object(W.a)(Object(Ie.a)(e,":"),function(e){return!!e}),function(e){return e.trim()});if(2===Object(q.a)(n)){var r=n[0],a=n[1];switch(r){case"text-align":t.textAlign=a}}}),t}catch(t){return void console.warn("Invalid style format in markdown: "+e.style)}}var Kt=n(509),Qt=n(399),Yt=n(326),Gt=/([\r\n]+|,|_|\.|-|\/|\\|\))/g,Jt=/(\()/g,$t=/([^A-Z])([A-Z]\w)/g;function Zt(e,t,n,r,a,i,o){if(void 0===o&&(o=!1),Object(Yt.d)(e)||!i)return{originalText:e,numLines:0,text:e};i.font=nn(t);var c=r,l=n,s=e,u=function(e,t){void 0===t&&(t=!1);var n=Object(Yt.b)(e),r=!n&&(a=e,a.indexOf(" ")<0&&!(a.match(Gt)||a.match(Jt)||a.match($t)));var a;return{textUnits:n||r||t?e.split(""):(i=e,i.replace(Gt,"$1​").replace(Jt,"​$1").replace($t,"$1​$2")).match(/([\u200B]?[ ]?[\u200B]?[^\u200B ]+)/g)||[],isCJKLanguage:n,isSingleWord:r};var i}(s,o),d=u.textUnits,m=u.isCJKLanguage,h=u.isSingleWord;!m&&h&&(c=1,r=1);for(var p=o?s:d,f=0,g=p[f],b=g;f<p.length&&c>0;)if(i.measureText(en(g,f,p.length,c,a)).width>=l){if(0===--c&&!o){for(var v=g.length,O=g.length/2;O>=1;)i.measureText(a.replace("{0}",g.slice(0,-v+O))).width<l&&(v-=O),O/=2;var y=p[f].slice(0,-v);y.length>2&&(b+=y)}g=p[f].trim()}else f>0&&(b+=p[f]),g+=p[++f];return{originalText:e,numLines:0===c?r:r-c+1,text:b=en(b,f,p.length,c,a)}}function Xt(){return window&&window.document?window.document.createElement("canvas").getContext("2d"):null}function en(e,t,n,r,a){return t===n||r>1?e:a.replace("{0}",e)}function tn(e,t,n,r){if(Object(Yt.d)(n.fontFamily)||Object(Yt.d)(n.fontSize.toString()))throw new RangeError("Font parameters not provided ");return function(e,t,n,r,a){if(Object(Yt.d)(e)||!a||t<=0)return{originalText:e,text:""};a.font=nn(n);var i=e;if(a.measureText(e).width>t){var o=a.measureText(r).width,c=t-o,l=Zt(e,n,c/2,1,"{0}",a,!0),s=Zt(e.split("").reverse().join(""),n,c/2,1,"{0}",a,!0);s.text=e.slice(-s.text.length),i=""+l.text+r+s.text}return{originalText:e,text:i}}(e,t,n,r,Xt())}function nn(e){return(e.fontStyle||"")+" "+(e.fontVariant||"")+" "+(e.fontWeight||"")+" "+e.fontSize+"px "+e.fontFamily}var rn=Object(nt.b)(function(){return Object(Ge.s)({container:["ms-search-splitter",{display:"inline-block",verticalAlign:"middle"}]})}),an=function(e){var t=rn(),n=e.className,r=e.isLarge;return i.createElement("div",{className:et(t.container,n),"aria-hidden":!0},r?i.createElement(i.Fragment,null,"•"):i.createElement(i.Fragment,null,"·"))},on=function(){return(on=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},cn=function(e,t){for(var n=0,r=t.length,a=e.length;n<r;n++,a++)e[a]=t[n];return e},ln=st,sn=12,un=lt,dn=11,mn=function(e){var t=[ft(e),{display:"block",maxWidth:"50%",whiteSpace:"nowrap",selectors:{a:ht(e)}}];return{attribution:cn(["ms-search-attribution",bt],t),attributionFileType:["ms-search-attribution",t],attributionSource:[ht(e)],scopeAttributionWrapper:{selectors:{" > span":{maxWidth:"50%"}}},dotSplitter:{marginLeft:"4px",marginRight:"4px"}}},hn=Object(nt.b)(function(e,t){return Object(Ge.s)(t?function(e){var t=["ms-search-attribution",{display:"block",color:e.palette.neutralPrimary,fontFamily:ln,fontSize:sn+"px",lineHeight:"16px",whiteSpace:"nowrap",selectors:{a:ht(e)}}];return on(on({},mn(e)),{attribution:[bt,t],attributionFileType:["ms-search-attribution",t],scopeAttributionWrapper:{selectors:{" > span":{marginBottom:0}}}})}(e):mn(e))}),pn=function(e){var t=e.id,n=e.source,r=e.sourceType,a=e.sourceId,o=e.url,c=e.tenantName,l=e.onLinkClick,u=e.isSmall,d=e.disableClickThrough,m=e.className,h=e.fromSourceElement,p=e.openLink,f=Se("AcronymAttribution"),g=f[0],b=f[1],v=Ee(),O=hn(v,u),y=O.attribution,j=O.attributionFileType,S=O.attributionSource,x=O.scopeAttributionWrapper,C=O.dotSplitter,k=function(e,t,n){if(!e)return;return"Email"===e&&n?We(n):t}(r,o,a),E=Object(R.a)(n),w=et(m,x);switch(r){case"Editorial":case"Annotation":return c?fn(y,i.createElement(i.Fragment,null,c,k&&i.createElement(i.Fragment,null,i.createElement(an,{className:C,isLarge:!0}),gn(k,t,Object(ot.n)(),S,l,d))),c,ot.k,h):null;case"Email":return k?fn(y,gn(k,t,T=E?Object(ot.g)():Object(ot.h)({subject:n}),S,l,d,p),T,ot.i,void 0,w):null;case"FileItem":case"File":if(!k)return null;var T,P=function(e){return e?{fontFamily:ln,fontSize:sn}:{fontFamily:un,fontSize:dn}}(u),I=function(e,t){var n=Xt();return n?(n.font=nn(t),n.measureText(e).width):0}(Object(ot.j)({source:""}),P),N=tn(n,b.offsetWidth-I,P,_e());return fn(E?y:j,gn(k,t,T=E?k:N.text,S,l,d,p),T,ot.j,void 0,w,g,n);default:return Object(s.a)(r)}};function fn(e,t,n,r,a,o,c,l){var s=r({source:"|"}),u=Object(Ie.a)(s,"|");return i.createElement("span",{className:o},i.createElement("span",{className:e,ref:c,title:l||n},a||i.createElement(i.Fragment,null,u[0],t,u[1])))}function gn(e,t,n,r,a,o,l){return o?i.createElement("span",{className:r},n):i.createElement(c,{onClick:function(n){n.stopPropagation(),l?l(e):window.open(e,"_blank"),bn(t,a)},onKeyPress:function(n){n.stopPropagation(),l?l(e):window.open(e,"_blank"),bn(t,a)}},n)}function bn(e,t){t&&t(e)}var vn=Object(Pe.a)(function(e,t,n,r,a,i){var o,c=e.palette,l=c.neutralPrimary,s=c.neutralDark,u=c.neutralSecondary,d=c.neutralLight,m=c.neutralLighterAlt,h=c.themeLighterAlt;return Object(Ge.s)({singleAcronymContainer:{cursor:i&&!a?"pointer":"auto",borderBottom:n?"none":"1px solid",borderColor:d,padding:"8px 0 12px 0",display:r?"block":"flex",backgroundColor:t&&!a?h:void 0,selectors:!i||a||t?{}:{":hover":{backgroundColor:m}}},singleAcronym:{margin:"0 12px 0 12px",width:"calc(100% - 24px)"},detailsContainer:{display:r?"block":"flex",width:r?"100%":"calc(100% - 376px)",float:r?"none":"left",flexDirection:t&&!r?"column":void 0},expansionContainer:[!t&&bt,{fontWeight:"600",fontSize:14,lineHeight:"20px",color:l,height:"20px",width:r?"100%":"288px",float:r?"none":"left",marginRight:r?"0":"24px"}],expansionText:[bt,"ms-search-acronymTile-expansionText"],expandContainer:{height:"20px",maxWidth:r||!i||t?"100%":"50%"},iconContainer:{width:"10px",height:r?"10px":"20px",float:"left",transform:t?"rotate(90deg)":void 0,transitionDuration:"200ms",fontSize:"9px",marginRight:"8px",marginTop:r?"5px":"0",display:a?"none":void 0},sourceContainer:[bt,{fontSize:"14px",lineHeight:"20px"},{color:s,height:"100%",width:r&&i?"calc(100% - 20px)":"100%",float:"left",alignItems:"center",selectors:(o={"& .ms-search-text-s":[{fontSize:"14px",lineHeight:"20px"},{maxWidth:"100%"}]},o["& .ms-search-attribution"]=[bt,{marginTop:r?"2px":"0",selectors:{a:{color:s}}}],o)}],descriptionContainer:[!t&&bt,{fontSize:"14px",lineHeight:"20px"},{color:u,display:!r||t?"block":"none",marginLeft:r||t?"0":"17px",height:t?"auto":"20px"}]})}),On=function(e){var t=e.acronym,n=e.isSmall,r=e.isLast,a=e.isSingleAcronym,o=e.activePage,c=e.tenantName,l=e.index,s=e.openLink,u=e.onAcronymEntityClick,d=e.onAcronymAttributionClick,m=t.expansion,h=t.source,p=t.descriptionPlainText,f=t.sourceType,g=t.id,b=t.url,v=t.sourceId,O=t.sourceShardType,y=i.useState(a),j=y[0],S=y[1],x=i.useState(!1),C=x[0],k=x[1],E=function(e,t){return t&&function(e){switch(e){case"User":case"PublicModernGroup":case"EditorialImport":case"Unknown":return!0;default:return!1}}(t)?"Source: "+e+"  Shard: "+t:e}(f,O);i.useEffect(function(){!a&&S(!1)},[o]);var w=Ee(),T=!!p&&("Editorial"===f||"Annotation"===f),P=p;p&&p.length>450&&(P=p.slice(0,450)+"...");var I=vn(w,j,r,n,a,T),N=I.expansionContainer,A=I.descriptionContainer,F=I.singleAcronymContainer,D=I.sourceContainer,L=I.expandContainer,R=I.iconContainer,W=I.detailsContainer,H=I.singleAcronym,M=I.expansionText,B=i.useRef(null);function z(){var e;if(!a&&T){var t=!j;S(t),null===(e=B.current)||void 0===e||e.focus(),u&&u(g,t)}}var _=("Editorial"===f||"Annotation"===f)&&c||("File"===f||"Email"===f)&&(h||b);return i.createElement("div",{className:F,onClick:z,tabIndex:0,ref:B,onKeyPress:z,role:T?"button":"presentation","aria-label":"Editorial"===f||"Annotation"===f?j&&p?Object(ot.a)({description:p}):c?Object(ot.b)({expansion:m,tenantName:c}):"":""},i.createElement("div",{className:H},i.createElement("div",{className:N},T&&!n&&i.createElement("div",{className:R},i.createElement(ct.a,{iconName:"ChevronRightMed"})),i.createElement("div",{title:C?m:void 0,onMouseOver:function(e){return function(e){var t=e.currentTarget,n=t.clientWidth,r=t.scrollWidth;k(n!==r)}(e)},role:"presentation",className:M},m)),i.createElement("div",{className:W},_&&f&&i.createElement("div",{className:L},T&&n&&i.createElement("div",{className:R},i.createElement(ct.a,{iconName:"ChevronRightMed"})),i.createElement("div",{className:D},i.createElement(pn,{id:g,source:h,url:b,sourceType:f,sourceId:v,tenantName:c,isSmall:n,onLinkClick:function(e){d&&d(e,l,E,f)},openLink:s}))),T&&i.createElement("div",{title:p,className:A},P))))};On.displayName="AcronymEntity";var yn={background:"none",padding:0,border:0},jn=function(e,t,n){return{fontSize:e,width:t||e,height:n||e}},Sn=(jn("6px"),jn("8px"),jn("12px")),xn=(jn("14px"),jn("16px"),jn("20px"),jn("24px"),jn("25px"),jn("28px")),Cn=(jn("32px"),jn("40px"),Object(Pe.a)(function(e){var t=e.palette,n=t.neutralLight,r=t.neutralDark;return Object(Ge.s)({pageContainer:{borderBottom:"1px solid",borderColor:n},expandLinkContainer:{height:"36px",display:"flex",margin:"0 12px 4px 12px",alignItems:"center"},expandLink:{cursor:"pointer"},button:[pt(e),yn,{color:r}],icon:[Sn,{lineHeight:"100%",verticalAlign:"middle",margin:"3px 0 0 8px",color:r}]})})),kn=function(e){var t=e.isCardExpanded,n=e.acronymViews,r=e.maxResultsOnCollapsed,a=e.onExpandLinkClick,o=t?n:n.slice(0,r),c=Ee(),l=Cn(c),s=l.pageContainer,u=l.expandLinkContainer,d=l.button,m=l.icon,h=l.expandLink,p=t?ze():Be(),f=t?"ChevronUpMed":"ChevronDownMed";return i.createElement(i.Fragment,null,i.createElement("div",{className:s},o),i.createElement("div",{className:u},i.createElement("div",{className:h,onClick:a,onKeyPress:a,tabIndex:0,role:"button"},i.createElement("button",{className:d},i.createElement("span",null,p)),i.createElement(ct.a,{iconName:f,className:m}))))},En=n(237);var wn=Object(Pe.a)(function(e){var t,n=e.palette.neutralSecondary;return Object(Ge.s)({header:["ms-search-acronymTile-header",{color:n,fontWeight:"600",margin:"0 12px",fontSize:14}],tileBodyOverride:["ms-search-tile-body"],tileHeaderOverride:["ms-search-tile-header"],tile:{selectors:(t={},t["& .ms-search-tile-header"]={margin:"0"},t["& .ms-search-tile-body"]={margin:"0",padding:"1px 0 0 0"},t["& .ms-search-heroTile-dismissButton"]={marginRight:"12px"},t)}})}),Tn=function(){return(Tn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Pn=function(e){var t,n=e.acronyms,r=e.tenantName,a=e.clientSize,o=e.isExpanded,c=e.onAcronymListExpandClick,l=e.onAcronymCarouselClick,s=e.onAcronymEntityClick,u=e.getClientSizeCallback,d=e.onAcronymAttributionClick,m=e.setAnswerHeight,h=e.openLink,p=e.className,f=e.isDismissible,g=e.onDismiss,b=e.onPrivacyIconClick,v=xe("HeroAcronymTile",752,a,u),O=v[0],y=v[1],j=null===(t=O.current)||void 0===t?void 0:t.offsetHeight;i.useEffect(function(){j&&m&&m(j)},[j]);var S=Ee(),x=i.useState(0),C=x[0],k=x[1],E=i.useState(!!o),w=E[0],T=E[1],P=function(e,t){return Object(En.a)(e,t)}(n,9),I="Small"===y,N=Object(K.a)(P).abbreviation,A=P.length,F=wn(S),D=F.header,L=F.tileBodyOverride,R=F.tileHeaderOverride,W=F.tile;function H(){var e=!w;T(e),c&&c(e)}var M=1===A,B=P.map(function(e,t){var n=function(e,t,n,r,a){return e||!t?n===r-1||n%a==a-1:n===r-1}(I,w,t,A,3),a={acronym:e,isSmall:I,tenantName:r,isLast:n,isSingleAcronym:M,activePage:C,index:t,openLink:h,onAcronymEntityClick:s,onAcronymAttributionClick:d};return i.createElement(On,Tn({key:"acronym"+t},a))}),z={header:i.createElement("div",{className:D},Object(ot.c)({abbreviation:N}),i.createElement(yt,{onPrivacyIconClick:b,openLink:h})),body:function(){if(I){if(A>3){var e={numberOfResults:A,acronymViews:B,setactivePage:k,onAcronymCarouselClick:l};return i.createElement(Ft,Tn({},e))}return i.createElement("div",null,B)}if(A<=3)return i.createElement("div",null,B);var t={isCardExpanded:w,acronymViews:B,maxResultsOnCollapsed:3,onExpandLinkClick:H};return i.createElement(kn,Tn({},t))}(),styleOverrides:function(){return{bodyStyles:L,headerStyles:R,cardStyles:W}},className:p,isDismissible:f,onDismiss:g};return i.createElement("div",{ref:O},i.createElement(it,Tn({},z)))};Pn.displayName="HeroAcronymTile";var In=n(410),Nn=n(257);const An=["Hero_File_Impression","PowerBiApp_Impression"];function Fn(e){return Object(D.a)(An,t=>t===e)}var Dn=n(286),Ln=n(376);function Rn(){var e=Object(u.useSelector)(g.j);return Object(u.useSelector)(S.w)?"Ribbon"===e:"RichRibbon"===e}var Wn=n(279);function Hn(e){var t=e.domain,n=e.isHero,r=e.isAsyncDomainImpressionFromMainRequest,a=e.intent,i=e.intentId,o=e.api,c=e.traceId,l=e.useAnswerOnly,p=e.pageNum;return Object(u.useSelector)(function(e){if(c)return c;if(n&&(r||!a))return Object(g.k)(e);switch(t){case"Conversation":case"Message":case"Person":var u=t&&Object(Wn.b)(t);return u&&Object(v.g)(e,u,{intent:a,intentId:i,useAnswerOnly:l,pageNum:p});case"Site":return Object(b.b)(e);case"File":return Object(h.c)(e)||Object(g.k)(e);case"PowerBi":return Object(f.b)(e);case"FederatedSearchDomain":return Object(m.b)(e,i,o);case"Connectors":return Object(d.a)(e,i);case"EducationAssignment":case"EducationClass":case"Calendar":case"CalendarAvailability":case"Group":case"Bookmark":case"Qna":case"Building":case"Acronym":case"FileEntity":case"Flight":case"FileAndSite":case"Notification":case"Turing":case"TuringQnA":case"Topic":case"Link":case"MeetingRoomProposal":case"External":case"EmployeeOffer":case"All":case"SharePoint":case"EducationAssignment":case"QueryReformulation":case void 0:return Object(g.k)(e);case"FloorPlan":return;default:return Object(s.a)(t)}})}var Mn=function(){return(Mn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function Bn(e){var t,n=e.domain,r=e.entity,a=e.impressionEventId,o=e.clickEventId,c=e.cardType,s=e.isHero,d=e.pageNumber,m=e.calendarIntent,h=e.eventScope,p=e.hasSubGroup,f=e.isFromMainSearch,g=e.virtualDomain,b=e.traceId,v=e.queryIntent,y=e.expandClickEventId,j=e.layoutProps,S=Object(w.a)(),x=Object(l.b)(),C=S.getStaticProperties()().logicalSearchId,k=Object(l.f)(),E=O(),T=Hn({traceId:b,domain:g||n,isHero:!!s,isAsyncDomainImpressionFromMainRequest:f&&Object(F.d)(n)||Fn(a)}),P=Rn(),I=Object(u.useSelector)(ie.b),N=!P&&!I,A=i.useState(!1),D=A[0],L=A[1],R=i.useState(void 0),W=R[0],H=R[1],M=i.useState(void 0),B=M[0],z=M[1],_=i.useState(!1),U=_[0],q=_[1],V=i.useState(!1),Q=V[0],Y=V[1],Z=null===(t=Object(l.g)())||void 0===t?void 0:t.logicalSearchId,X=Object(u.useSelector)(ae.c);X=X||"Pole";var ee={cardType:c,clientSize:x,eventScope:h||Object($.b)(n),isHero:s,pageNumber:d,placement:X,traceId:T},te=function(e){var t,n;return JSON.stringify(((t={}).topicId=e.id,t.topicStatus=e.state,t.hasTopicDescription=!(null===(n=e.definitionProperties)||void 0===n||!n.text),t.topicLifeCycleState=e.lifeCycleState,t.topicSource=e.source,t.topicType=e.topicType,t.topicRelevanceScore=Math.round(100*e.relevanceScore)/100,t))};i.useEffect(function(){k&&U&&!Q&&(Y(!0),Object(J.e)({logger:S,domain:g||n,impressionEventId:a,traceId:T,startTime:k,endTime:new Date,pageNumber:d,componentStartTime:W,componentEndTime:Object($.a)(),dontSendResultsRendered:!(T!==E||Z&&Z!==C)}))}),i.useEffect(function(){var e=Object($.a)();H(e),z(new Date),Y(!1),Object(J.g)(a,e),L(!1),q(!1)},[d,T]),i.useEffect(function(){if(r&&!D){if(L(!0),Object(be.a)({logger:S,entity:r,traceId:T,pageLoadStartTime:B,domain:g||n,hasSubGroup:p,entityAttributes:"Topic"===(n||r.domain)?te(r):void 0,isHero:s,eventId:a,layoutProps:j}),a)switch(n){case"Calendar":m&&function(e,t,n,r,a,i,o,c){var l={cardType:r,clientSize:a,eventScope:"Calendar",target:t,isHero:i,placement:o,initialHeroImpression:c};Object(G.p)(e,{properties:l,eventId:n})}(S,m,a,c,x,s,X,N);break;case"Bookmark":!function(e,t,n,r,a,i,o,c){if(t){var l={cardType:r,clientSize:a,eventScope:"Bookmark",target:Object(G.c)(t),entityId:Object(G.b)(t),index:"1",queryType:t.queryType,isHero:i,value:t.entityType||"",content:t.isSystemOwned?"SystemOwned":void 0,placement:o,initialHeroImpression:c};Object(G.p)(e,{properties:l,eventId:n})}}(S,r,a,c,x,s,X,N);break;case"Flight":!function(e,t,n,r,a,i,o){if(t&&Object(K.a)(t.flights)){var c={cardType:r,clientSize:a,eventScope:"Flight",isHero:i,initialHeroImpression:o};Object(G.p)(e,{properties:c,eventId:n})}}(S,r,a,c,x,s,N);break;default:!function(e,t,n,r,a,i,o,c,l,s,u,d,m){if(t){var h={cardType:a,clientSize:i,eventScope:r,target:Object(G.c)(t),isHero:o,pageNumber:c,queryType:s,index:l,initialHeroImpression:u,placement:d,value:m};Object(G.p)(e,{properties:h,eventId:n})}}(S,r,a,h||Object($.b)(n),c,x,s,d,void 0,"Qna"===n?r.queryType:"Person"===n&&v?v:void 0,N,X,"Hero_Adaptive_Async_Answer_Impression"===a?r.contentSource:void 0)}q(!0)}},[S,r,T,k,n,a,h,c,x,s,d,m,N,X,j]);var ne=function(e,t,a,i){var l;o&&r&&Object(Nn.f)(S,c,x,e||o,h||Object($.b)(n),r,T,s,0,d,void 0,t||r.interpretation,r.queryType,a,"Topic"===(n||r.domain)?t||JSON.stringify(((l={}).topicId=r.id,l)):void 0,X,void 0,i)};return{onEntityClick:ne,onActionClick:function(e,t,n){ne(e,t,void 0,n)},nonEntityActions:{onExpandClick:function(e,t){y&&ne(y,void 0,e,t)},onSearchActionClick:function(e,t){return Object(Nn.e)(S,e,Mn(Mn({},ee),t))}}}}function zn(e){var t,n=e.entities,a=e.domain,o=e.isHero,c=e.intent,s=e.calendarIntent,d=e.impressionEventId,m=e.clickEventId,h=e.cardType,p=e.pageNumber,f=e.target,g=e.provenance,b=e.eventScope,v=e.isFromMainSearch,y=e.intentId,j=e.startIndex,S=e.virtualDomain,x=e.traceId,C=e.completedLoading,k=e.expandClickEventId,E=e.groupReferenceId,T=e.contentSources,P=e.queryTypes,I=e.isSuppressed,N=e.layoutProps,A=Object(w.a)(),D=A.getStaticProperties()().logicalSearchId,L=Object(l.f)(),R=O(),W=Object(l.b)(),H=Hn({traceId:x,domain:S||a,isHero:o,intent:c,intentId:y,isAsyncDomainImpressionFromMainRequest:v&&Object(F.d)(a)||Fn(d)}),M=i.useState(void 0),B=M[0],z=M[1],_=i.useState(void 0),U=_[0],q=_[1],V=i.useState(!1),K=V[0],Y=V[1],G=i.useState(!1),Z=G[0],ee=G[1],te=null===(t=Object(l.g)())||void 0===t?void 0:t.logicalSearchId,ne=i.useState(Object(In.a)())[0],re=i.useState(!1),oe=re[0],ce=re[1],le=Rn(),se=Object(u.useSelector)(ie.b),ue=!le&&!se,de=Object(u.useSelector)(ae.c);de=de||"Pole";var me={cardType:h,clientSize:W,eventScope:b||Object($.b)(a),isHero:o,groupReferenceId:E,pageNumber:p,placement:de,target:f,traceId:H};i.useEffect(function(){L&&K&&!Z&&d&&(ee(!0),Object(J.e)({logger:A,domain:S||a,impressionEventId:d,traceId:H,startTime:L,endTime:new Date,noResultsPage:Object(r.a)(n),pageNumber:p,componentStartTime:B,componentEndTime:Object($.a)(),dontSendResultsRendered:!(H!==R||te&&te!==D)}))}),i.useEffect(function(){var e=Object($.a)();z(e),q(new Date),Y(!1),ee(!1),I||Object(J.g)(d,e),ce(!1)},[p,H]),i.useEffect(function(){Object(r.a)(n)&&!C||oe||(ce(!0),Object(be.b)({logger:A,entities:n,domain:S||a,isHero:o,traceId:H,pageLoadStartTime:U,provenance:g,intent:c,layoutKey:ne,eventId:d,groupReferenceId:E,layoutProps:N}),d&&X(A,n,d,b||Object($.b)(a),h,W,o,p,f||s,ue,de,Object(Q.a)(T),Object(Q.a)(P)),Y(!0))},[A,n,a,H,L,g,c,d,b,h,W,o,p,f,ue,ne,de,N]);var he=function(e,t,r,a,i,o){var c=Object(Dn.a)(n,function(t){return t.id===e}),l=null==n?void 0:n[c];l&&pe(l,c,t,r,a,i,void 0,o)},pe=function(e,t,r,i,c,l,s,u){if(m){var d="RelatedSearches"===b?e.technique:void 0,g=e.queryType||d;n&&!t&&(t=Object(Ln.a)(n,e)+1),t=t&&t>0?t+(j||0):void 0,Object(Nn.f)(A,h,W,c||m,b||(r?Object($.b)(r):Object($.b)(a)),e,e.traceId||H,o,t,p,f,i||e.interpretation,g,l,s,de,d,u)}},fe=function(e,t){return Object(Nn.e)(A,e,Mn(Mn({},me),t))};return{onEntityClickId:he,onEntityClick:pe,onActionClickId:function(e,t,n,r,a){he(e,void 0,n,t,r,a)},onActionClick:function(e,t,n,r,a){pe(e,n,void 0,void 0,t,void 0,r,a)},nonEntityActions:{onExpandClick:function(e,t){k&&fe(k,Mn(Mn({},t),{isExpanded:e}))},onSearchActionClick:fe}}}var _n=n(34),Un=n(248);function qn(e){var t,n=null===(t=Un.b.getSelectors(e).getLatestSuccess(Un.c))||void 0===t?void 0:t.responses;return null==n||n.sort(function(e,t){return e.id.valueOf()-t.id.valueOf()}),n}function Vn(e){var t=qn(e);return t&&t[0].body}function Kn(e){var t=Vn(e);return null==t?void 0:t.displayName}function Qn(e){var t=Vn(e);return null==t?void 0:t.mail}function Yn(e){var t=Vn(e);return null==t?void 0:t.userPrincipalName}function Gn(e){var t=function(e){var t=qn(e);return t&&t[1].body}(e);return null==t?void 0:t.value[0].displayName}n(380),n(271);var Jn=100;function $n(e){return e&&"data:image/jpeg;base64,"+e}function Zn(e,t){if(e&&!Object(R.a)(e))for(var n=0;n<e.length;n++){var r=Xn(e[n],t);if(r)return r}}function Xn(e,t){var n=e.text,r=e.children;if(n)return n.substr(0,t||Jn);if(r)for(var a=0;a<r.length;a++){var i=Xn(r[a],t);if(i)return i}}function er(){var e,t=Object(u.useSelector)(_n.g),n=null===(e=nr())||void 0===e?void 0:e.userData,r=Object(u.useSelector)(Qn);return rr()?(null==n?void 0:n.mail)||r:t}function tr(){var e,t=Object(u.useSelector)(_n.g),n=null===(e=nr())||void 0===e?void 0:e.userData,r=Object(u.useSelector)(Yn);return rr()?(null==n?void 0:n.userPrincipalName)||r:t}function nr(){var e;return null===(e=Object(l.h)())||void 0===e?void 0:e.userProperties}function rr(){var e;return!!(null===(e=Object(l.h)().additionalAnswerConfigs)||void 0===e?void 0:e.disableMsbApis)}var ar=n(172);function ir(e){return!!e.sourceType&&!!e.expanded}function or(e,t,n,r,a){var i=Object(Y.a)(null==e?void 0:e.filter(ir),function(e){return function(e,t,n,r){var a=e.id,i=e.shortened,o=e.expanded,c=e.snippet,l=e.source,s=e.url,u=e.sourceId,d=e.sourceType,m=e.sourceShardType,h=e.descriptionText,p=c&&c.json,f=t&&r?r(o,"None"):n?"https://www.bing.com/work/?q="+o+"&FORM=BFBACR":void 0;return{id:a,mappingId:Object(G.c)(e),abbreviation:i,expansion:o,description:p,descriptionPlainText:p?Zn(p):h,source:l,url:s,sourceId:u,sourceType:d,sourceShardType:m,requeryUrl:f}}(e,n,r,a)});return e.length&&!i.length&&Object(T.e)(t,"Acronym answer dropped due to missing required fields"),i}var cr=function(){return(cr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},lr=function(e){var t,n,r,a,o=e.className,c=Object(l.b)(),s=Object(w.a)(),d=O(),m=Object(u.useSelector)(ar.c),h=(n=Object(u.useSelector)(_n.a),r=null===(t=nr())||void 0===t?void 0:t.userOrganization,a=Object(u.useSelector)(Gn),rr()?(null==r?void 0:r.displayName)||a:n),p=Object(l.a)(),f=null==p?void 0:p.getCurrentClientSize,g=null==p?void 0:p.setAnswerHeight,b=null==p?void 0:p.openLink,v=null==p?void 0:p.dismissAnswer,y=Object(l.h)().additionalAnswerConfigs,j=null==y?void 0:y.isAnswerDismissible,S=null==y?void 0:y.answerBlockId,x=zn({entities:m,domain:"Acronym",isHero:!0,cardType:"Hero",impressionEventId:"Hero_Acronym_Impression",clickEventId:"Acronym_Source_Click",expandClickEventId:"Acronym_Expand_Click",isFromMainSearch:!0,groupReferenceId:S});if(i.useEffect(function(){var e;m&&!Object(R.a)(m)&&(null===(e=null==p?void 0:p.setAnswerBlockRendered)||void 0===e||e.call(p))},[]),!m||Object(R.a)(m))return Object(T.h)(s,"Unexpected Empty response received for Acronym"),null;var C={clientSize:c,tenantName:h,acronyms:or(m,s),onAcronymListExpandClick:function(e){x.nonEntityActions.onExpandClick(e,{pageNumber:"1"})},onAcronymCarouselClick:function(e,t){return x.nonEntityActions.onSearchActionClick(e,{pageNumber:t})},onAcronymEntityClick:function(e,t){return x.onActionClickId(e,"Acronym_Expand_Description_Click",void 0,t)},getClientSizeCallback:f,onAcronymAttributionClick:function(e,t,n,r){return x.onEntityClickId(e,"Acronym",n,void 0,void 0,cr({},function(e){if(e)switch(e){case"File":case"FileItem":return{RelatedEntityType:"FileSource"};case"Email":return{RelatedEntityType:"EmailSource"};case"Annotation":case"Editorial":default:return}}(r)))},setAnswerHeight:g,openLink:b,className:o,isDismissible:j,onDismiss:function(){j&&(null==v||v(),Object(Nn.a)(s,"Hero","Acronym",c,d,S,!0))},onPrivacyIconClick:function(){return x.nonEntityActions.onSearchActionClick("Acronym_PrivacyIcon_Click")}};return i.createElement(Pn,cr({},C))},sr=n(176),ur=n(227),dr=Object(Pe.a)(function(e){var t=e.palette,n=t.themeLight,r=t.neutralSecondary,a=t.neutralPrimary,i=t.neutralTertiary;return Object(Ge.s)({headerContent:["ms-search-bookmarkTile-headerContent",{overflow:"hidden",fontSize:"14px",lineHeight:"20px",verticalAlign:"middle",display:"flex"}],headerIcon:{width:"20px",height:"20px",float:"left",textAlign:"center",borderRadius:"50%",background:n},answerTitle:[{float:"left",marginLeft:"8px",fontWeight:"600",color:r},bt],title:["ms-search-bookmarkTile-title",{color:a,fontSize:"17px",fontWeight:"600"},bt],description:["ms-search-bookmarkTile-description",{maxWidth:"100%",maxHeight:"40px",margin:"0 auto",fontSize:"14px",lineHeight:"20px",color:r},bt],url:[{color:ur.a,fontSize:"12px",height:"20px",lineHeight:"20px"},bt],content:{overflow:"hidden",paddingBottom:"8px"},bodyIcon:[xn,{color:i,paddingRight:"12px",paddingTop:"4px",float:"left"}]})}),mr=function(){return(mr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},hr=function(e){var t,n=e.heroBookmark,r=e.onHeroBookmarkClick,a=e.clientSize,o=e.setAnswerHeight,c=e.className,l=e.isDismissible,s=e.onDismiss,u=Ee(),d=dr(u),m=d.headerContent,h=d.headerIcon,p=d.answerTitle,f=d.title,g=d.description,b=d.url,v=d.content,O=d.bodyIcon,y=xe("HeroBookmarkTile",752,a),j=y[0],S=y[1],x=null===(t=j.current)||void 0===t?void 0:t.offsetHeight;i.useEffect(function(){x&&o&&o(x)},[x]);var C="Small"===S,k={body:i.createElement(i.Fragment,null,i.createElement(ct.a,{iconName:Ae.b,className:O}),i.createElement("div",{className:v},i.createElement("div",{className:f,title:n.title},n.title),i.createElement("div",{className:b,title:n.url},n.url),i.createElement("div",{className:g,title:n.description},n.description))),header:i.createElement("div",{className:m},i.createElement(ct.a,{className:h,iconName:"Link12"}),i.createElement("div",{className:p,title:Object(sr.c)(),role:"heading","aria-level":3},Object(sr.c)())),isSmall:C,cardClickProps:{onCardClick:function(){r&&r(n.url)},clickRole:"link"},className:c,isDismissible:l,onDismiss:s};return i.createElement("div",{ref:j},i.createElement(it,mr({},k)))};hr.displayName="HeroBookmarkTile";var pr=n(233);function fr(e){if(e&&e.audience)return{token:e.token,audience:e.audience}}var gr=function(){return(gr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};var br,vr=Object(u.connect)(function(e){return{heroBookmark:Object(pr.c)(e)}})(function(e){var t=e.className,n=e.heroBookmark,r=Object(w.a)(),a=Object(l.b)(),o=Object(u.useSelector)(g.k),c=Object(l.a)(),s=null==c?void 0:c.setAnswerHeight,d=null==c?void 0:c.openLink,m=null==c?void 0:c.dismissAnswer,h=Object(l.h)().additionalAnswerConfigs,p=null==h?void 0:h.isAnswerDismissible,f=null==h?void 0:h.answerBlockId,b=zn({domain:"Bookmark",entities:n?[n]:void 0,impressionEventId:"Hero_Bookmark_Impression",clickEventId:"Bookmark_Click",cardType:"Hero",isHero:!0,groupReferenceId:f});if(i.useEffect(function(){var e;n&&(null===(e=null==c?void 0:c.setAnswerBlockRendered)||void 0===e||e.call(c))},[]),!n)return Object(T.h)(r,"Unexpected Empty response received for Bookmark"),null;var v,O,y,j,S,x,C,k,E,P,I={className:t,heroBookmark:(j=(v=n).id,S=v.displayTitle,x=v.snippet,C=v.url,k=v.powerApp,E=v.powerBiApp,P=x&&(x.raw||x.json&&x.json[0]&&x.json[0].text)||"",{id:j,mappingId:Object(G.c)(v),title:S,description:P,url:C,powerApp:k,powerAppToken:fr(O),powerBiApp:E,powerBiToken:fr(y)}),clientSize:a,onHeroBookmarkClick:function(e){d?d(e):window.open(e,"_blank"),b.onEntityClick(n,0,"Bookmark",void 0,"Bookmark_Click",void 0,void 0,{EntityClickDetails:d?"OpenInViewer":void 0})},setAnswerHeight:s,isDismissible:p,onDismiss:function(){p&&(null==m||m(),Object(Nn.a)(r,"Hero","Bookmark",a,o,f,!0))}};return i.createElement(hr,gr({},I))});!function(e){e[e.Success=0]="Success",e[e.Failed=1]="Failed",e[e.Pending=2]="Pending"}(br||(br={}));var Or=n(95);function yr(e){var t=i.useRef(new Image),n=i.useState(!1),r=n[0],a=n[1],o=function(){var e;(e=t.current)&&1===e.naturalHeight&&1===e.naturalWidth||a(!0)};return i.useEffect(function(){if(t.current.addEventListener("load",o,!1),e)return t.current.src=e,function(){t.current.removeEventListener("load",o,!1)}},[e]),r}var jr=n(497),Sr=n(444),xr=n(508),Cr=((Object(Me.declareString)("search-components-calendar.search.calendar.upNext")),(Object(Me.declareString)("search-components-calendar.search.calendar.noMeetings")),(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.dateTimeString")),(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.dateTimeStringWithoutDotSeparator"))),kr=((Object(Me.declareString)("search-components-calendar.search.calendar.calendarUppercase")),(Object(Me.declareString)("search-components-calendar.search.calendar.calendarIntent")),(Object(Me.declareString)("search-components-calendar.search.calendar.calendarLowercase")),(Object(Me.declareString)("search-components-calendar.search.calendar.meetings")),(Object(Me.declareString)("search-components-calendar.search.calendar.meeting")),(Object(Me.declareString)("search-components-calendar.search.calendar.allDayText")),(Object(Me.declareString)("search-components-calendar.search.calendar.openInOutlookText")),(Object(Me.declareString)("search-components-calendar.search.calendar.tentativelyAcceptedResponse")),(Object(Me.declareString)("search-components-calendar.search.calendar.acceptedResponse")),(Object(Me.declareString)("search-components-calendar.search.calendar.noResponse")),(Object(Me.declareString)("search-components-calendar.search.calendar.organizerText")),(Object(Me.declareString)("search-components-calendar.search.calendar.eventSingleMeetingText")),(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.eventstext")),(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.attendeesText")),(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.topMeetingTitleDecorator")),(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.duration")),(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.meetingStartAndEndTime")));(Object(Me.declareString)("search-components-calendar.search.calendar.previousSubtitle")),(Object(Me.declareString)("search-components-calendar.search.calendar.lastMonthSubtitle")),(Object(Me.declareString)("search-components-calendar.search.calendar.lastWeekSubtitle")),(Object(Me.declareString)("search-components-calendar.search.calendar.yesterdaySubtitle")),(Object(Me.declareString)("search-components-calendar.search.calendar.tomorrowSubtitle")),(Object(Me.declareString)("search-components-calendar.search.calendar.thisWeekSubtitle")),(Object(Me.declareString)("search-components-calendar.search.calendar.nextWeekSubtitle")),(Object(Me.declareString)("search-components-calendar.search.calendar.laterSubtitle")),(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.eventConflictText")),(Object(Me.declareString)("search-components-calendar.search.calendar.eventSingleConflictText")),(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.timeAndLocation")),(Object(Me.declareString)("search-components-calendar.search.calendar.todaySchedule")),(Object(Me.declareString)("search-components-calendar.search.calendar.meetingItemAriaLabel")),(Object(Me.declareString)("search-components-calendar.search.calendar.upcomingSharedEvents")),(Object(Me.declareString)("search-components-calendar.search.calendar.upcomingMeetings")),(Object(Me.declareString)("search-components-calendar.search.calendar.pastMeetings")),(Object(Me.declareString)("search-components-calendar.search.calendar.upcomingEventsForMe")),(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.meetingDateTimeRange")),(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.meetingTimeRange"));(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.availabilityChart.ariaLabelFormat"));(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.availabilityChart.availabilityBlockDescription"));(Object(Me.declareString)("search-components-calendar.search.calendar.free")),(Object(Me.declareString)("search-components-calendar.search.calendar.tentative")),(Object(Me.declareString)("search-components-calendar.search.calendar.busy")),(Object(Me.declareString)("search-components-calendar.search.calendar.outOfOffice")),(Object(Me.declareString)("search-components-calendar.search.calendar.unknown"));(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.currentTime")),(Object(Me.declareString)("search-components-calendar.search.calendar.calendarTitle")),(Object(Me.declareString)("search-components-calendar.search.calendar.meetingsList"));var Er=(Object(Me.declareString)("search-components-calendar.search.calendar.onlineMeeting")),wr=((Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.onlineMeetingWithRoom")),(Object(Me.declareString)("search-components-calendar.search.calendar.canceled")),(Object(Me.declareString)("search-components-calendar.search.calendar.eventsHeading"))),Tr=(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.dateTimeStringForDifferentStartAndEndWeekDays")),Pr=(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.calendarTileConnectionString")),Ir=((Object(Me.declareString)("search-components-calendar.search.calendar.seeMeetingConflicts")),(Object(Me.declareString)("search-components-calendar.search.calendar.joinTeamsMeetingButtonAriaLabel"))),Nr=(Object(Me.declareString)("search-components-calendar.search.calendar.editMeetingButtonAriaLabel")),Ar=(Object(Me.declareString)("search-components-calendar.search.calendar.join")),Fr=Object(Pe.a)(function(e){var t=e.palette.themeLight;return Object(Ge.s)({headerContent:["ms-search-calendarTile-headerContent",{fontSize:14,lineHeight:"24px",verticalAlign:"middle",overflow:"hidden"}],headerIcon:{width:"20px",height:"20px",float:"left",textAlign:"center",borderRadius:"50%",background:t},answerTitle:["ms-search-calendarTile-answerTitle",bt,{fontWeight:"400",fontSize:14,paddingLeft:"8.75px"}],profilePhoto:["ms-search-profile-photo",{float:"left"}],boldText:{fontWeight:"600"},row:{display:"flex",flexDirection:"row"}})}),Dr=n(191),Lr=n(94),Rr=n(512),Wr=10;Object(Pe.a)(function(e,t){var n=(new Date).getTime()/1e3,r=n+86400,a=Object(W.a)(e,function(e){return e.meetingStart>=n&&e.meetingStart<r});return Object(Y.a)(t?a:e,function(e){var t,n=e.meetingSubject,r=e.meetingStart,a=e.meetingEnd,i=e.meetingLocation,o=e.id;return{subject:n,start:Object(Or.b)(r),end:Object(Or.b)(a),location:i,url:(t=o,"https://outlook.office.com/calendar/deeplink/read/"+(t=encodeURIComponent(t)))}})});function Hr(e,t){return void 0===t&&(t=Wr),Object(En.a)(e,t)}function Mr(e,t,n){var r=(new Date).getTime()/1e3;return n?"Canceled":r+15*Lr.h/Lr.u<e?"Pre":r>t?"Post":"During"}function Br(e){var t=Object(Dr.b)();return[t.january,t.february,t.march,t.april,t.may,t.june,t.july,t.august,t.september,t.october,t.november,t.december][Object(Or.b)(e).getMonth()]}var zr,_r,Ur,qr=n(496);!function(e){e.OutOfRoutine="OutOfRoutine",e.Quorum="Quorum",e.Conflicts="Conflicts"}(zr||(zr={})),function(e){e.FileAttachment="FileAttachment",e.RelatedEmail="RelatedEmail",e.RelatedFile="RelatedFile"}(_r||(_r={})),function(e){e.Implicit="Implicit",e.Explicit="Explicit"}(Ur||(Ur={}));var Vr=n(255),Kr=(Object(Me.declareString)("search-components-calendar.search.calendar.edit")),Qr=((Object(Me.declareString)("search-components-calendar.search.calendar.cancel")),(Object(Me.declareString)("search-components-calendar.search.calendar.deleteAppointment")),(Object(Me.declareString)("search-components-calendar.search.calendar.reply"))),Yr=(Object(Me.declareString)("search-components-calendar.search.calendar.replyAll")),Gr=(Object(Me.declareString)("search-components-calendar.search.calendar.forward")),Jr=(Object(Me.declareString)("search-components-calendar.search.calendar.scheduleNextMeeting")),$r=(Object(Me.declareString)("search-components-calendar.search.calendar.rsvp")),Zr=(Object(Me.declareString)("search-components-calendar.search.calendar.yes")),Xr=(Object(Me.declareString)("search-components-calendar.search.calendar.no")),ea=(Object(Me.declareString)("search-components-calendar.search.calendar.maybe")),ta=(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.duringOthersEvent")),na=(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.othersEventStartingSoon")),ra=(Object(Me.declareString)("search-components-calendar.search.calendar.duringYourEvent")),aa=(Object(Me.declareString)("search-components-calendar.search.calendar.eventStartingSoon")),ia=(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.othersPastEvent")),oa=(Object(Me.declareString)("search-components-calendar.search.calendar.yourPastEvent")),ca=(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.othersCanceledEvent")),la=(Object(Me.declareString)("search-components-calendar.search.calendar.yourCanceledEvent")),sa=(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.yourEventInMinutes")),ua=(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.othersEventInMinutes")),da=(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.yourEventInDays")),ma=(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.othersEventInDays")),ha=(Object(Me.declareString)("search-components-calendar.search.calendar.yourEventToday")),pa=(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.othersEventToday")),fa=(Object(Me.declareString)("search-components-calendar.search.calendar.yourEventTomorrow")),ga=(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.othersEventTomorrow")),ba=(Object(Me.declareString)("search-components-calendar.search.calendar.yourEventNextWeek")),va=(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.othersEventNextWeek")),Oa=(Object(Me.declareString)("search-components-calendar.search.calendar.yourEventLaterThisMonth")),ya=(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.othersEventLaterThisMonth")),ja=(Object(Me.declareString)("search-components-calendar.search.calendar.yourUpcomingEvent")),Sa=(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.othersUpcomingEvent")),xa=(Object(Me.declareString)("search-components-calendar.search.calendar.happeningNow")),Ca=(Object(Me.declareString)("search-components-calendar.search.calendar.startingSoon")),ka=(Object(Me.declareString)("search-components-calendar.search.calendar.numberOfConflicts")),Ea=(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.calendarEventListItemAriaLabel")),wa=(Object(Me.declareString)("search-components-calendar.search.calendar.recurring")),Ta=(Object(Me.declareString)("search-components-calendar.search.calendar.hasAttachments")),Pa=(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.meetingLocationWithLabel")),Ia=(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.conflictNameString")),Na=(Object(Me.declareString)("search-components-calendar.search.calendar.noConflictsString")),Aa=(Object(Me.declareString)("search-components-calendar.search.calendar.outOfRoutine")),Fa=((Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.meetingAcceptanceRateString")),(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.meetingAcceptanceString")),(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.acceptedAttendeeCountString"))),Da=(Object(Me.declareStringWithPlaceholders)("search-components-calendar.search.calendar.additionConflictNumberString")),La=(Object(Me.declareString)("search-components-calendar.search.calendar.preReadsTitle")),Ra=(Object(Me.declareString)("search-components-calendar.search.calendar.relatedContentSuggestion")),Wa=(Object(Me.declareString)("search-components-calendar.search.calendar.editRsvpButtonLabel")),Ha=(Object(Me.declareString)("search-components-calendar.search.calendar.noMeetingSubject"));function Ma(e){var t=Object(Dr.b)();return[t.sundayShort,t.mondayShort,t.tuesdayShort,t.wednesdayShort,t.thursdayShort,t.fridayShort,t.saturdayShort][Object(Or.b)(e).getDay()]}function Ba(e,t,n,r){var a,i,o=new Date,c=o.getTime()/1e3,l=Object(Or.b)(e),s=e-c,u=(i=o,(a=l).setHours(0,0,0,0),i.setHours(0,0,0,0),(a.getTime()-i.getTime())/Lr.c),d=o.getDay()||7;if(s<Lr.e/Lr.u){var m=s*Lr.u/Lr.h;return t?sa({minutes:Math.ceil(m).toString()}):ua({name:n,minutes:Math.ceil(m).toString()})}return r===o.getDate()?t?ha():pa({name:n}):Object(Or.p)(o,l)?t?fa():ga({name:n}):u<=Lr.w/Lr.c?t?da({days:Math.ceil(u).toString()}):ma({name:n,days:Math.ceil(u).toString()}):u<=2*Lr.w/Lr.c-d?t?ba():va({name:n}):l.getMonth()===o.getMonth()?t?Oa():ya({name:n}):t?ja():Sa({name:n})}function za(e,t,n){return{key:"no",text:Xr(),iconProps:{iconName:Vr.d},onClick:function(){n(e,"Decline").then(function(e){e&&t("Declined")})}}}function _a(e,t,n){return{key:"maybe",text:ea(),iconProps:{iconName:Vr.f},onClick:function(){n(e,"Tentative").then(function(e){e&&t("TentativelyAccepted")})}}}function Ua(e,t,n){return{key:"yes",text:Zr(),iconProps:{iconName:Vr.b},onClick:function(){n(e,"Accept").then(function(e){e&&t("Accepted")})}}}function qa(e,t,n,r){var a=[];switch(t){case"Accepted":a.push(za(e,n,r)),a.push(_a(e,n,r));break;case"Declined":a.push(Ua(e,n,r)),a.push(_a(e,n,r));break;case"TentativelyAccepted":a.push(Ua(e,n,r)),a.push(za(e,n,r));break;case"None":case"NotResponded":case"Organizer":a.push(Ua(e,n,r)),a.push(za(e,n,r)),a.push(_a(e,n,r));break;default:return Object(s.a)(t)}return{items:a}}function Va(e){switch(e){case"Accepted":return Zr();case"TentativelyAccepted":return ea();case"Declined":return Xr();case"NotResponded":case"None":case"Organizer":return $r();default:return Object(s.a)(e)}}function Ka(e){return e>2}function Qa(e){return Object(qr.a)(ka().replace(Vr.a,String(e)),e)}function Ya(e,t){return Object(R.a)(e)?t?Er():"":e}var Ga=function(e,t){var n,r=e.meetingStart,a=e.meetingEnd,i=e.isCanceled,o=e.insights,c=null===(n=Object(W.a)(o,function(e){return e.Type===zr.Conflicts})[0])||void 0===n?void 0:n.Source,l=Mr(r,a,!!i),s=(new Date).getTime()/1e3,u=c&&!c.ConflictFetchFailed?c.ConflictingEvents.length:0;return{meetingInfoString:"During"===l?s<r?Ca():xa():t&&0===u?"":Qa(u),eventScenario:l}},Ja=function(e){return Object(R.a)(e.seriesMasterId)?"":wa()},$a=function(e){return e.hasAttachments?Ta():""};function Za(e,t,n){var r,a,i,o=e.insights;if(o){var c=null===(r=Object(W.a)(o,function(e){return e.Type===zr.Conflicts})[0])||void 0===r?void 0:r.Source;if(c&&!c.ConflictFetchFailed&&!Object(R.a)(c.ConflictingEvents)){var l=e.id,s=e.hexItemId,u=e.joinOnlineMeetingUrl,d=e.meetingEnd,m=e.meetingStart,h={itemId:l,hexItemId:s,itemIndex:n,onlineMeetingUrl:u,startTime:new Date(1e3*m).toISOString(),endTime:new Date(1e3*d).toISOString()},p=null==t?void 0:t.onConflictClick,f=p?function(e){null==e||e.stopPropagation(),p(h)}:void 0;return{insightType:zr.Conflicts,text:Qa(c.ConflictingEvents.length),iconName:Vr.g,onClick:f,onKeyPress:function(e){f&&Re(e,f)}}}var g=null===(a=Object(W.a)(o,function(e){return e.Type===zr.OutOfRoutine})[0])||void 0===a?void 0:a.Source;if(g&&g.IsOutOfRoutine)return{insightType:zr.OutOfRoutine,text:Aa(),iconName:Vr.i};var b=null===(i=Object(W.a)(o,function(e){return e.Type===zr.Quorum})[0])||void 0===i?void 0:i.Source;return b&&b.AcceptedAttendeesCount&&b.AcceptedAttendeesCount>0?{insightType:zr.Quorum,text:Fa({acceptedCount:b.AcceptedAttendeesCount.toString()}),iconName:Vr.j}:c&&!c.ConflictFetchFailed&&Object(R.a)(c.ConflictingEvents)?{insightType:zr.Conflicts,text:Na(),iconName:Vr.g}:void 0}}var Xa=function(){return(Xa=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},ei=function(e){var t=e.heroCalendar,n=e.imageUrl,r=e.coinSize,a=e.livePersonaCard,o=e.onOrganizerProfileClick,c=t.organizer,l=t.meetingStart,u=t.meetingEnd,d=c.email,m=c.fullName,h=t.isOrganizer,p=t.isCanceled;h=!!h,p=!!p;var f=Object(Or.b)(l).getDate(),g=function(e){return e.split(" ")[0]}(m),b=function(e,t,n,r,a){var i=(new Date).getTime()/1e3;if(t)switch(e){case"Canceled":return la();case"Post":return oa();case"During":return i<n?aa():ra();case"Pre":return Ba(n,t,r,a);default:return Object(s.a)(e)}else switch(e){case"Canceled":return ca({name:r});case"Post":return ia({name:r});case"During":return i<n?na({name:r}):ta({name:r});case"Pre":return Ba(n,t,r,a);default:return Object(s.a)(e)}}(Mr(l,u,p),h,l,m,f).split(m),v=i.useMemo(function(){return tt(a,m,d)},[a,m,d]),O={imageUrl:yr(n)?n:void 0,coinSize:r,size:1,hidePersonaDetails:!0,imageShouldFadeIn:!1,imageShouldStartVisible:!0,showInitialsUntilImageLoads:!0,imageInitials:Object(jr.a)(m,!1),initialsColor:Object(Sr.a)({text:m})},y=Ee(),j=Fr(y),S=i.createElement("div",{className:j.profilePhoto,role:a?"button":void 0,onClick:a?function(){return null==o?void 0:o(t)}:void 0,onKeyPress:a?function(){return null==o?void 0:o(t)}:void 0},i.createElement(xr.a,Xa({},O))),x=v?i.createElement(v,null,S):S,C=i.createElement("span",{className:j.boldText,role:a?"button":void 0,onClick:a?function(){return null==o?void 0:o(t)}:void 0,onKeyPress:a?function(){return null==o?void 0:o(t)}:void 0},g),k=v?i.createElement(v,null,C):C;return i.createElement("div",{className:j.headerContent,title:Pr({preOrganizerNameText:b[0],organizerName:h?"":g,postOrganizerNameText:b[1]})},i.createElement("div",{className:j.row},x,i.createElement("div",{className:j.answerTitle},b[0],!h&&k,b[1])))},ti=n(510),ni=n(498),ri=n(522),ai=n(446),ii=Object(Pe.a)(function(e){return Object(Ge.s)({root:{marginRight:"auto",padding:"8px 0px 8px "+(e?12:24)+"px"}})}),oi=Object(Pe.a)(function(e){return Object(Ge.s)({root:{position:"relative",float:"right",padding:"8px "+(e?14:24)+"px 8px 0px"}})}),ci=Object(Pe.a)(function(e,t){var n=e.palette,r=n.themePrimary,a=n.neutralPrimary;return Object(Ge.s)({body:["ms-search-heroCalender-entity-classname",{cursor:"pointer",overflow:"hidden",margin:"0 0.8px"}],mailActionIcon:{color:r,paddingLeft:"6px"},meetingTitle:[bt,{color:a,display:"inline-block",fontSize:"17px",fontWeight:"600",height:"24px",lineHeight:"22px",textDecoration:t?"line-through":"none"}],meetingTime:[{maxWidth:"100%",maxHeight:"40px",margin:"0 auto",fontSize:"14px",lineHeight:"20px",overflow:"hidden",textOverflow:"ellipsis"}],meetingVenue:[bt,{fontSize:"12px",overflow:"hidden",textOverflow:"ellipsis",display:"inline-block",height:"20px",lineHeight:"20px"}],dateContainer:[{width:"100%",textAlign:"center",fontSize:"17px",fontWeight:"600",color:a}],monthNameContainer:[bt,{width:"100%",textAlign:"center",fontSize:"14px",color:a}],leftContainer:{width:"28px",float:"left",paddingRight:"15px"},rightContainer:{overflow:"hidden"},attachmentIcon:[{fontSize:"14px",lineHeight:"20px"},{float:"right",marginLeft:"auto"}],meetingTitleContainer:{display:"flex",alignItems:"center"}})}),li=Object(Pe.a)(function(){return Object(Ge.s)({root:["ms-search-calendarTile-editButton-root",{borderRadius:"2px"}]})}),si=Object(Pe.a)(function(e){var t=e.palette,n=t.themePrimary,r=t.white,a=t.themeDark,i=t.themeDarker;return Object(Ge.s)({root:["ms-search-calendarTile-joinButton-root",{borderRadius:"2px",backgroundColor:n,padding:"0px 4px 0px 4px",minWidth:"80px",height:"32px",marginLeft:"0px",selectors:{":hover":{backgroundColor:a},":active":{backgroundColor:i}}}],label:{color:r,height:"20px",minWidth:"26px",width:"auto",lineHeight:"20px",margin:"6px 12px 6px 4px"},icon:{color:r,height:"16px",width:"17px",margin:"6px 1px 6px 12px",padding:"0px"},iconHovered:{color:r,height:"16px",width:"17px",margin:"6px 1px 6px 12px",padding:"0px"},iconPressed:{color:r,height:"16px",width:"17px",margin:"6px 1px 6px 12px",padding:"0px"}})}),ui=Object(Pe.a)(function(e){var t=e.palette,n=t.white,r=t.neutralSecondaryAlt;return Object(Ge.s)({root:{borderRadius:"2px",borderColor:r,borderWidth:"1px",border:"solid",backgroundColor:n,padding:"0 8px"},label:{margin:"0px"}})}),di=Object(Pe.a)(function(e,t){var n=e.palette,r=n.white,a=n.neutralSecondaryAlt,i=n.neutralPrimary;return Object(Ge.s)({root:["ms-search-calendarTile-rsvpButton-root",{borderRadius:"2px",borderColor:a,minWidth:"80px",padding:t?"0px 8px 0px 8px":"0px 12px 0px 12px",backgroundColor:r}],label:{margin:"0px",color:i},menuIcon:{margin:"0px",paddingLeft:"8px",color:i},icon:{margin:"0px",paddingRight:"8px"}})}),mi=function(e){var t=e.clientActionItem,n=e.rsvpResponse,r=e.setRsvpResponse,a=e.onRSVPItemClick,o=function(e){switch(e){case"Accepted":return Vr.b;case"Declined":return Vr.d;case"TentativelyAccepted":return Vr.f;case"None":case"NotResponded":case"Organizer":return;default:Object(s.a)(e)}}(n),c=Ee();if(!a)return null;var l=qa(t,n,r,a),u=l.items;return Object(q.a)(u)>0?i.createElement(ai.a,{ariaLabel:Wa(),onKeyPress:function(e){e.stopPropagation()},text:Va(n),menuProps:l,styles:di(c,!!o),iconProps:{iconName:o}}):null};var hi=function(){return(hi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};var pi=function(e){var t=e.heroCalendar,n=e.actionCallbacks,a=e.isOrganizer,o=e.eventScenario,c=e.isSmall,l=Ee(),s=ci(l).mailActionIcon,u={childrenGap:8},d=t.responseStatus,m=t.requiredAttendees,h=t.id,p=t.joinOnlineMeetingUrl,f=t.hexItemId,g=Object(q.a)(m);d=d||"None";var b=i.useState(d),v=b[0],O=b[1],y=n.joinMeeting,j=n.scheduleNextMeeting,S=n.reply,x=n.replyAll,C=n.editEvent,k=n.forwardEvent,E=n.rsvpEvent,w={itemId:h,hexItemId:f,onlineMeetingUrl:p};return i.createElement(i.Fragment,null,i.createElement(ti.a,{horizontal:!0,tokens:u,horizontalAlign:"baseline",styles:ii(c)},a&&("Pre"===o||"Canceled"===o)&&C&&i.createElement(ni.a,{"aria-label":Nr(),text:Kr(),styles:li(),onClick:function(){return C(w)}}),"During"===o&&y&&p&&!Object(r.a)(p)&&i.createElement(ri.a,{"aria-label":Ir(),iconProps:{iconName:Vr.n},styles:si(l),onClick:function(){return y(w)}},Ar()),a&&"Post"===o&&j&&i.createElement(ai.a,{text:Jr(),styles:ui(l),onClick:function(){return j(w)}}),!a&&E&&"Pre"===o&&function(e,t,n,r){var a={clientActionItem:e,rsvpResponse:t,setRsvpResponse:n,onRSVPItemClick:r};return i.createElement(mi,hi({},a))}(w,v,O,E)),i.createElement(ti.a,{horizontal:!0,tokens:u,styles:oi(c),horizontalAlign:"end"},!a&&S&&i.createElement(Te.a,{iconProps:{iconName:Vr.k},className:s,title:Qr(),ariaLabel:Qr(),onClick:function(){return S(w)}}),Ka(g)&&x&&i.createElement(Te.a,{iconProps:{iconName:Vr.l},className:s,title:Yr(),ariaLabel:Yr(),onClick:function(){return x(w)}}),k&&i.createElement(Te.a,{iconProps:{iconName:Vr.e},className:s,title:Gr(),ariaLabel:Gr(),onClick:function(){return k(w)}})))},fi=function(){return(fi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},gi=function(e){var t,n=e.heroCalendar,r=e.actionCallbacks,a=e.getMeetingDateTimeText,o=e.imageUrl,c=e.clientSize,l=e.className,s=e.isDismissible,u=e.onOrganizerProfileClick,d=e.setAnswerHeight,m=e.onDismiss,h=n.meetingSubject,p=n.meetingStart,f=n.meetingEnd,g=n.meetingLocation,b=n.id,v=n.hexItemId,O=n.joinOnlineMeetingUrl,y=n.hasAttachments,j={itemId:b,hexItemId:v,itemIndex:-1},S=Object(R.a)(h)?Ha():h,x=n.isOrganizer,C=n.isCanceled;x=!!x,C=!!C;var k=xe("HeroCalendarTile",752,c),E=k[0],w=k[1],T=null===(t=E.current)||void 0===t?void 0:t.offsetHeight;i.useEffect(function(){T&&d&&d(T)},[T]);var P,I,N,A,F,D,L,W,H,M="Small"===w,B=Object(Or.b)(p).getDate(),z=Br(p),_=Mr(p,f,C),U=Ya(g,!Object(R.a)(O)),q=Ee(),V=ci(q,C),K=V.meetingTitle,Q=V.leftContainer,Y=V.rightContainer,G=V.meetingVenue,J=V.meetingTime,$=V.dateContainer,Z=V.monthNameContainer,X=V.body,ee=V.attachmentIcon,te=V.meetingTitleContainer,ne=r.openEvent,re=r.livePersonaCard,ae={heroCalendar:n,imageUrl:o,livePersonaCard:re,onOrganizerProfileClick:u},ie=function(e){e.preventDefault(),Re(e,function(){return null==ne?void 0:ne(j)})},oe=a(p,f),ce={body:i.createElement("div",{role:"link",tabIndex:0,onClick:function(){return null==ne?void 0:ne(j)},onKeyPress:ie,className:X},i.createElement("div",{className:Q},i.createElement("div",{className:$},B),i.createElement("div",{className:Z,title:z},z)),i.createElement("div",{className:Y},i.createElement("div",{className:te},i.createElement("div",{className:K,title:S},S),y&&i.createElement(ct.a,{iconName:Vr.c,className:ee})),i.createElement("div",{className:J,title:oe},oe),U&&!Object(R.a)(U)&&i.createElement("div",{className:G,title:U},U))),header:i.createElement(ei,fi({},ae)),footer:(H={heroCalendar:n,actionCallbacks:r,isOrganizer:x,eventScenario:_,isSmall:M},!C&&(P=r.rsvpEvent,I=r.forwardEvent,N=r.editEvent,A=r.deleteEvent,F=r.cancelEvent,D=r.reply,L=r.replyAll,W=r.joinMeeting,!(!P&&!I&&!N&&!A&&!F&&!D&&!L&&(!W||"During"!==_||Object(R.a)(O))))&&i.createElement(pi,fi({},H))),isSmall:M,styleOverrides:function(){return{cardStyles:M?void 0:"ms-search-maxContent"}},className:l,isDismissible:s,onDismiss:m};return i.createElement("div",{ref:E},i.createElement(it,fi({},ce)))};gi.displayName="HeroCalendarTile";var bi=Object(Pe.a)(function(e,t){var n=e.palette,r=n.themePrimary,a=n.neutralLighterAlt;return Object(Ge.s)({calendarInsightsActionBlock:["ms-search-calendarInsightsActionBlock",{display:"none",alignItems:"center",cursor:"default",backgroundColor:a,minHeight:"32px"}],insightsIcon:{marginRight:"10px",marginLeft:"12px",minWidth:"26px",height:"20px",lineHeight:"20px",textAlign:"center"},conflictsInfoContainer:["ms-search-conflictsInfoContainer",bt,{fontSize:"14px",lineHeight:"20px"},{display:"flex",paddingRight:"5px",height:"20px",lineHeight:"20px"}],firstConflictName:[bt],primaryActionContainer:{marginLeft:"auto"},conflictsInfoLink:{color:r,cursor:t?"pointer":"default"},insightsInfoContainer:[bt,{fontSize:"14px",lineHeight:"20px"},{paddingRight:"40px"}]})}),vi=Object(Pe.a)(function(e,t){var n,r=e.palette,a=r.white,i=r.neutralLighterAlt,o=r.neutralLighter;return Object(Ge.s)({body:["ms-search-calendarBody-ItemContent",{display:t?"block":"flex",overflow:"hidden",marginBottom:"1px",backgroundColor:a,paddingLeft:t?"18px":"35px",paddingTop:"8px",paddingBottom:"8px",paddingRight:"20px",selectors:{"&:hover":{backgroundColor:i}}}],calendarActionContainer:["ms-search-calendarEntity-calendarActionContainer",{display:"none",selectors:(n={},n["& .ms-search-calendarInsightsActionBlock"]={display:"flex",marginLeft:t?"0":"auto",marginRight:t?"0":"206px",maxWidth:t?"undefined":"294px",borderTop:t?"1px solid "+o:void 0,padding:"4px "+(t?"4px":"20px")},n)}],meetingDetailsWithAction:["ms-search-calendarEntity-meetingDetailsWithActions"],calendarCommandBar:["ms-search-calendarEntity-calendarCommandBar",{display:"none",marginLeft:"auto"}]})}),Oi=function(){return(Oi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},yi=function(e){var t=e.meetingItem,n=e.index,r=e.actionCallbacks,a=e.className,o=e.rsvpResponse,l=e.setRsvpResponse,s=t.meetingStart,u=t.meetingEnd,d=t.isCanceled,m=t.insights,h=t.id,p=t.hexItemId,f=t.joinOnlineMeetingUrl,g=t.isOrganizer,b=Mr(s,u,!!d),v=Ee();if("Post"===b)return null;var O={itemId:h,hexItemId:p,itemIndex:n,onlineMeetingUrl:f,startTime:new Date(1e3*s).toISOString(),endTime:new Date(1e3*u).toISOString()},y=null==r?void 0:r.joinMeeting,j=null==r?void 0:r.rsvpEvent,S=null==r?void 0:r.editEvent,x=null==r?void 0:r.onConflictClick,C="During"===b&&y&&!Object(R.a)(f),k=!g&&j&&"Pre"===b,E=!(!g||!S||"Pre"!==b&&"Canceled"!==b),w=bi(v,!!x);if(!Za(t,r,n)&&!(k||C||E))return null;return i.createElement("div",{className:a},i.createElement("div",{className:w.calendarInsightsActionBlock,role:"presentation",onClick:function(e){return e.stopPropagation()}},function(){var e,t,n;if(!m)return null;var r=x?function(e){null==e||e.stopPropagation(),x(O)}:void 0,a=null===(e=Object(W.a)(m,function(e){return e.Type===zr.Conflicts})[0])||void 0===e?void 0:e.Source;if(a&&!a.ConflictFetchFailed&&!Object(R.a)(a.ConflictingEvents)){var o=Ia({conflictName:a.ConflictingEvents[0].Subject}),l=i.createElement(i.Fragment,null,i.createElement("div",{className:w.firstConflictName,title:o},o),a.ConflictingEvents.length>1&&i.createElement("span",null,Da({additionalNumber:(a.ConflictingEvents.length-1).toString()})));return i.createElement(i.Fragment,null,i.createElement(ct.a,{iconName:Vr.g,className:w.insightsIcon}),r&&i.createElement(c,{role:"button",onClick:r,onKeyPress:function(e){r&&Re(e,r)},className:et(w.conflictsInfoContainer,w.conflictsInfoLink)},l),!r&&i.createElement("div",{className:w.conflictsInfoContainer},l))}var s=null===(t=Object(W.a)(m,function(e){return e.Type===zr.OutOfRoutine})[0])||void 0===t?void 0:t.Source;if(s&&s.IsOutOfRoutine)return i.createElement(i.Fragment,null,i.createElement(ct.a,{iconName:Vr.i,className:w.insightsIcon}),i.createElement("div",{className:w.insightsInfoContainer,title:Aa()},Aa()));var u=null===(n=Object(W.a)(m,function(e){return e.Type===zr.Quorum})[0])||void 0===n?void 0:n.Source;if(u&&u.AcceptedAttendeesCount&&u.AcceptedAttendeesCount>0){var d=Fa({acceptedCount:u.AcceptedAttendeesCount.toString()});return i.createElement(i.Fragment,null,i.createElement(ct.a,{iconName:Vr.j,className:w.insightsIcon}),i.createElement("div",{className:w.insightsInfoContainer,title:d},d))}if(a&&!a.ConflictFetchFailed&&Object(R.a)(a.ConflictingEvents)){o=Na(),l=i.createElement(i.Fragment,null,i.createElement("div",{className:w.firstConflictName,title:o},o),a.ConflictingEvents.length>1&&i.createElement("span",null,Da({additionalNumber:(a.ConflictingEvents.length-1).toString()})));return i.createElement(i.Fragment,null,i.createElement(ct.a,{iconName:Vr.g,className:w.insightsIcon}),i.createElement("div",{className:w.conflictsInfoContainer},l))}return null}(),function(){if(!(k||C||E))return null;var e=function(e){e.stopPropagation(),S&&S(O)},t=function(e){e.stopPropagation(),y&&f&&y(O)},n={clientActionItem:O,rsvpResponse:o,setRsvpResponse:l,onRSVPItemClick:j};return i.createElement("div",{className:w.primaryActionContainer},C&&y&&f&&i.createElement(ri.a,{role:"link","aria-label":Ir(),iconProps:{iconName:Vr.n},styles:si(v),onClick:function(e){return t(e)},onKeyPress:function(e){return t(e)}},Ar()),E&&S&&i.createElement(ai.a,{role:"link","aria-label":Nr(),text:Kr(),styles:li(),onClick:function(t){return e(t)},onKeyPress:function(t){return e(t)}}),k&&j&&i.createElement(mi,Oi({},n)))}()))},ji=n(437),Si=n(507),xi=Object(Pe.a)(function(e,t,n,r){var a,i,o=r.palette,c=o.white,l=o.neutralLighterAlt;return Object(Ge.s)({commandbar:{marginLeft:e?"auto":"0px",width:e?void 0:"100%",alignItems:"center",float:"right",padding:"0px",overflow:"hidden",minWidth:"40px",selectors:(a={},a["& .ms-OverflowSet-overflowButton"]={marginLeft:"auto"},a["& .ms-OverflowSet-item:first-child"]={marginRight:t?"auto":void 0,marginLeft:t?void 0:"auto"},a)},primaryActionInsightsContainer:{selectors:(i={},i["& .ms-search-calendarInsightsActionBlock"]={backgroundColor:n?l:c},i["& .ms-search-conflictsInfoContainer"]={width:"189px",marginRight:"20px"},i)},iconButton:{height:"36px"},joinMeetingButton:{marginLeft:"auto"}})}),Ci=Object(Pe.a)(function(e){var t=e.palette.blue;return Object(Ge.s)({root:{color:t,padding:"0px"}})}),ki=(Object(Pe.a)(function(){return Object(Ge.s)({root:{height:"100%",padding:"0px"}})}),Object(Pe.a)(function(e){var t=e.palette.white;return Object(Ge.s)({root:["ms-search-calendarTile-commandbarButton-root",{background:t,minWidth:"40px",maxWidth:"20px",height:"32px",border:"none"}]})})),Ei=Object(Pe.a)(function(e){var t=e.palette.white;return Object(Ge.s)({root:{background:t,float:"right",height:"100%",padding:"0px",width:"100%"}})}),wi=function(){return(wi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Ti=function(e,t){for(var n=0,r=t.length,a=e.length;n<r;n++,a++)e[a]=t[n];return e},Pi=function(e){var t,n=Ee(),r=e.heroCalendar,a=e.actionCallbacks,o=e.isMultiEntity,c=e.index,l=e.isSmall,s=e.className,u=e.rsvpResponse,d=e.setRsvpResponse,m=r.id,h=r.joinOnlineMeetingUrl,p=r.hexItemId,f=r.requiredAttendees,g=r.meetingStart,b=r.meetingEnd,v=r.isCanceled,O=r.isOrganizer,y=Object(q.a)(f),j=a.reply,S=a.replyAll,x=a.forwardEvent,C=a.rsvpEvent,k=a.editEvent,E=a.joinMeeting,w=Mr(g,b,!!v),T=i.useState(!0),P=T[0],I=T[1],N="During"===w&&E&&!Object(R.a)(h);if(!(j||S||x||C||N))return null;var A=o||!l?Za(r,a,c):void 0;if(A){var F=A.insightType,D=A.text,L=A.onClick,W=A.onKeyPress,H=A.iconName;switch(F){case"Conflicts":t={text:D,key:D,onClick:L,onKeyPress:W,iconProps:{iconName:H},disabled:!L};break;case"OutOfRoutine":case"Quorum":t={text:D,key:D,disabled:!0,iconProps:{iconName:H}};break;default:t=void 0}t&&(t.commandBarButtonAs=function(e){return i.createElement(Ii,wi({},e,{meetingItem:r,actionCallbacks:a,index:c,rsvpResponse:u,setRsvpResponse:d}))})}var M=!!O&&!!k&&(o||!o&&!l||"During"===w)&&"Post"!==w,B=!O&&!!C&&(o||!o&&!l)&&"Pre"===w||M,z=B&&!!t||!o&&!l&&!!t,_=xi(l,z||B,z,n),U=function(e){e.stopPropagation(),E&&h&&E(V)},V={itemId:m,hexItemId:p,onlineMeetingUrl:h},K={text:Qr(),key:Qr(),iconOnly:!0,onClick:function(e){null==e||e.stopPropagation(),null==j||j(V)},onKeyPress:function(e){null==e||e.stopPropagation()},iconProps:{iconName:Vr.k},className:_.iconButton},Q={text:Yr(),key:Yr(),iconOnly:!0,onClick:function(e){null==e||e.stopPropagation(),null==S||S(V)},onKeyPress:function(e){null==e||e.stopPropagation()},iconProps:{iconName:Vr.l},className:_.iconButton},Y={text:Gr(),key:Gr(),iconOnly:!0,onClick:function(e){null==e||e.stopPropagation(),null==x||x(V)},onKeyPress:function(e){null==e||e.stopPropagation()},iconProps:{iconName:Vr.e},className:_.iconButton},G=C?qa(V,u,d,C):void 0,J=function(e){return z&&t?null:i.createElement(Ii,wi({},e,{meetingItem:r,actionCallbacks:a,index:c,rsvpResponse:u,setRsvpResponse:d}))},$=G?{text:$r(),key:$r(),subMenuProps:G,iconProps:{iconName:"Calendar"},commandBarButtonAs:J}:void 0,Z={text:Kr(),key:Kr(),onClick:function(){null==k||k(V)},onKeyPress:function(e){null==e||e.stopPropagation(),null==k||k(V)},iconProps:{iconName:"Edit"},commandBarButtonAs:J},X={key:"divider_1",itemType:ji.a.Divider,commandBarButtonAs:function(e){return null}};t&&(t.className=_.primaryActionInsightsContainer),(!t||!z&&B)&&(Z.className=_.primaryActionInsightsContainer,$&&($.className=_.primaryActionInsightsContainer));var ee=Ti(Ti(Ti(Ti(Ti([],z&&t?[t]:[]),B?M?[Z,X]:$?[$,X]:[]:[]),j&&!O?[K]:[]),S&&Ka(y)&&Q?[Q]:[]),x?[Y]:[]),te=[];return i.createElement(i.Fragment,null,P&&i.createElement(Si.a,{styles:Ei(n),items:l?te:ee,overflowItems:l?ee:te,className:et(_.commandbar,s),overflowButtonProps:{menuIconProps:{styles:Ci(n)},styles:ki(n)},dataDidRender:function(e){e&&0===e.primaryItems.length&&(!N||!o&&l||I(!1))}}),!P&&i.createElement(ri.a,{role:"link","aria-label":Ir(),iconProps:{iconName:Vr.n},styles:si(n),onClick:function(e){return U(e)},onKeyPress:function(e){return U(e)},className:et(_.joinMeetingButton,s)},Ar()))},Ii=function(e){var t={meetingItem:e.meetingItem,actionCallbacks:e.actionCallbacks,index:e.index,className:e.className,rsvpResponse:e.rsvpResponse,setRsvpResponse:e.setRsvpResponse};return i.createElement(yi,wi({},t))},Ni=n(506),Ai=n(260),Fi=Object(Pe.a)(function(e){return Object(Ge.s)({meetingAttachmentContainer:{display:"flex",paddingBottom:"14px",alignItems:"center"},shimmer:{width:"75%",marginLeft:"17px"},attachmentIcon:{marginLeft:e?"15px":"0"},attachmentsContainer:{marginLeft:"17px"},additionAttachmentData:{display:"inline-block"}})}),Di=Object(Pe.a)(function(e){var t;return Object(Ge.s)({root:{display:e?"inline-grid":"inline-block",marginRight:"8px",maxWidth:e?void 0:"122px",marginTop:"4px",selectors:(t={},t["& .ms-Button-flexContainer"]={overflow:"hidden"},t)},label:[bt],textContainer:{overflow:"hidden"}})}),Li=function(e){var t=e.meetingItem,n=e.isSmall,a=e.meetingArtifactsFetchingStatus,o=e.actionCallbacks,c=e.meetingIndex,l=t.hasAttachments,s=t.artifacts,u=Fi(n);if(!l||a===br.Failed)return null;var d=Object(W.a)(s,function(e){return e.Type===_r.FileAttachment});if(a===br.Success&&Object(r.a)(d))return null;var m;return i.createElement("div",{className:u.meetingAttachmentContainer,role:"presentation",onClick:function(e){return e.stopPropagation()}},i.createElement(ct.a,{iconName:Vr.c,className:u.attachmentIcon}),a===br.Pending&&i.createElement(Ni.a,{className:u.shimmer}),a===br.Success&&i.createElement("div",{className:u.attachmentsContainer},(m=d.slice(0,2),i.createElement(i.Fragment,null,Object(Y.a)(m,function(e,t){var r=e.Source,a=Object(Ai.getFileTypeIconProps)({extension:r.FileExtension,size:16}),l=function(e){var t;null==e||e.stopPropagation();var n={accessUrl:r.Url,itemIndex:c};null===(t=null==o?void 0:o.relatedAttachmentClick)||void 0===t||t.call(o,n)};return i.createElement(ai.a,{iconProps:a,styles:Di(n),title:r.Title,onClick:l,onKeyPress:function(e){e.stopPropagation(),"Enter"!==e.key&&" "!==e.key||l(e)},key:t},r.Title)}),d.length>2&&i.createElement("div",{className:u.additionAttachmentData},Da({additionalNumber:(d.length-2).toString()}))))))},Ri=Object(Pe.a)(function(e,t){var n=e.palette.neutralPrimary;return Object(Ge.s)({meetingDateDayContainer:["ms-search-meetingDateDayContainer",{width:"28px",float:"left",marginRight:t?"22px":"16px"}],monthNameContainer:["ms-search-calendarTile-meetingMonth",{fontSize:"14px",lineHeight:"20px"},bt,{color:n,width:"100%",textAlign:"center"}],dateContainer:["ms-search-calendarTile-meetingDate",{fontSize:"17px",fontWeight:"600"},{width:"100%",textAlign:"center",color:n}]})}),Wi=function(e){var t=e.startDate,n=e.startMonth,r=e.isSmall,a=Ee(),o=Ri(a,r),c=o.meetingDateDayContainer,l=o.dateContainer,s=o.monthNameContainer;return i.createElement("div",{className:c},i.createElement("div",{className:l},t),i.createElement("div",{className:s,title:n},n))},Hi=Object(Pe.a)(function(e,t){var n=e.palette,r=n.neutralLighterAlt,a=n.neutralPrimary;return Object(Ge.s)({actionBlockContainer:["ms-search-calender-actionblock-content-classname",{backgroundColor:r,borderRadius:"4px",height:"40px",lineHeight:"40px",display:"flex",marginTop:"5px",width:t?"auto":"294px",maxWidth:"294px",alignItems:"center"}],actionContainer:{marginLeft:"auto",marginRight:"4px",display:"flex"},conflictInfoIcon:["ms-search-conflict-info-classname",{fontSize:"14px",lineHeight:"20px"},{color:a,margin:"0 13px 0 15px"}],conflictData:[bt,{fontSize:"14px",lineHeight:"20px"},{color:a}]})}),Mi=function(){return(Mi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Bi=function(e){var t,n=e.meetingItem,r=e.actionCallbacks,a=e.index,o=e.isSmall,c=n.joinOnlineMeetingUrl,l=n.isOrganizer,s=n.id,u=n.hexItemId,d=n.insights,m={itemId:s,hexItemId:u,itemIndex:a,onlineMeetingUrl:c},h=n.responseStatus||"None",p=i.useState(h),f=p[0],g=p[1],b=Ee(),v=Hi(b,o),O=v.actionBlockContainer,y=v.conflictInfoIcon,j=v.conflictData,S=v.actionContainer,x=null==r?void 0:r.joinMeeting,C=null==r?void 0:r.rsvpEvent,k=null==r?void 0:r.editEvent,E=null===(t=Object(W.a)(d,function(e){return e.Type===zr.Conflicts})[0])||void 0===t?void 0:t.Source,w=E&&!E.ConflictFetchFailed,T=Ga(n),P=T.meetingInfoString,I=T.eventScenario,N="During"===I&&x&&!Object(R.a)(c),A=!l&&C&&"Pre"===I,F=!(!l||!k||"Pre"!==I&&"Canceled"!==I);if(!w)return null;if(!(A||N||F))return null;var D=function(e){e.stopPropagation(),k&&k(m)},L=function(e){e.stopPropagation(),x&&c&&x(m)},H={clientActionItem:m,rsvpResponse:f,setRsvpResponse:g,onRSVPItemClick:C};return i.createElement("div",{className:O},i.createElement(ct.a,{className:y,iconName:Vr.g}),i.createElement("div",{className:j,title:P},P),i.createElement("div",{className:S},N&&x&&c&&i.createElement(ri.a,{role:"link","aria-label":Ir(),iconProps:{iconName:Vr.n},styles:si(b),onClick:function(e){return L(e)},onKeyPress:function(e){return L(e)}},Ar()),F&&k&&i.createElement(ni.a,{role:"link","aria-label":Nr(),text:Kr(),styles:li(),onClick:function(e){return D(e)},onKeyPress:function(e){return D(e)}}),A&&C&&i.createElement(mi,Mi({},H))))},zi=Object(Pe.a)(function(e,t,n){var r=e.palette,a=r.neutralPrimary,i=r.themePrimary;return Object(Ge.s)({meetingDetailsContainer:["ms-search-calender-meeting-detail-content-classname",{overflow:"hidden",display:t?"block":"flex"}],meetingTitleContainer:[{fontSize:"14px",lineHeight:"20px"},{display:"flex",width:t?"auto":"235px",minWidth:t?"auto":"235px",paddingRight:t?"0px":"25px",height:"22px",alignItems:"center",color:a}],moreDetailsContainer:["ms-search-calendarTile-moreDetailsContainer",{overflow:"hidden",width:t?void 0:"100%"}],meetingTitle:["ms-search-calendarTile-meetingTitle",bt,{fontWeight:"600",textDecoration:n?"line-through":"none"}],meetingTimeContainer:{display:"flex"},meetingTime:["ms-search-calendarTile-meetingTime",bt,{fontSize:"14px",lineHeight:"20px"},{maxHeight:"40px",whiteSpace:"nowrap",display:"inline-block"}],meetingVenue:["ms-search-meeting-venue-classname",bt,{fontSize:"14px",lineHeight:"20px"},{display:"inline-block",height:"20px",marginLeft:t?"0px":"16px"}],moreDetails:["ms-search-calender-moredetail-content-classname",{display:t?"block":"flex",overflow:"hidden"}],attachmentIcon:["ms-search-calendarTile-attachmentIcon",{fontSize:"14px",lineHeight:"20px"},{float:"right",marginLeft:"auto"}],recurringIcon:[{fontSize:"14px",lineHeight:"20px"},{padding:"0 8px",verticalAlign:"middle"}],insightsIcon:["ms-search-calendarTile-insightsIcon",{display:"none",color:i,paddingLeft:"8px",fontWeight:"600"}]})}),_i=function(){return(_i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Ui=function(e){var t=e.meetingItem,n=e.meetingDayTimeText,r=e.isSmall,a=e.actionCallbacks,o=e.index,c=e.showActionsInBody,l=e.hasRelatedEmailArtifacts,s=e.meetingArtifactsFetchingStatus,u=t.meetingSubject,d=t.joinOnlineMeetingUrl,m=t.hasAttachments,h=t.isCanceled,p=t.seriesMasterId,f=t.meetingLocation,g=t.meetingStart,b=t.meetingEnd,v=Ee(),O=zi(v,r,h),y=Object(R.a)(u)?Ha():u,j=Mr(g,b,!!h),S=O.meetingDetailsContainer,x=O.meetingTitle,C=O.meetingTime,k=O.meetingVenue,E=O.moreDetails,w=O.attachmentIcon,T=O.meetingTitleContainer,P=O.moreDetailsContainer,I=O.recurringIcon,N=O.meetingTimeContainer,A=O.insightsIcon,F=Ya(f,!Object(R.a)(d)),D={meetingItem:t,actionCallbacks:a,index:o,isSmall:r};return i.createElement("div",{className:S},i.createElement("div",{className:T},i.createElement("div",{className:x,title:y},y),l&&i.createElement(ct.a,{iconName:Vr.h,className:A,title:l?"Post"===j?Ra():La():void 0}),m&&i.createElement(ct.a,{iconName:Vr.c,className:w})),i.createElement("div",{className:P},i.createElement("div",{className:E},i.createElement("div",{className:N},i.createElement("div",{className:C,title:n},n),!Object(R.a)(p)&&i.createElement(ct.a,{className:I,iconName:Vr.m})),F&&!Object(R.a)(F)&&i.createElement("div",{className:k,title:F},F)),!c&&i.createElement(Bi,_i({},D)),!r&&i.createElement(Li,{meetingItem:t,isSmall:r,meetingArtifactsFetchingStatus:s,actionCallbacks:a})))},qi=function(){return(qi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Vi=function(e){var t,n=e.meetingItem,r=e.getMeetingDateTimeText,a=e.isSmall,o=e.useCalendarCallbacks,c=e.maxMeetingsToDisplay,l=e.index,s=e.showActionsInBody,u=e.meetingArtifactsFetchingStatus,d={itemId:n.id||"",hexItemId:n.hexItemId||"",itemIndex:l},m=o(n,d),h=null==m?void 0:m.openEvent,p=n.meetingStart,f=n.meetingEnd,g=n.meetingSubject,b=n.meetingLocation,v=n.joinOnlineMeetingUrl,O=n.artifacts,y=Object(Or.b)(p).getDate(),j=Br(p),S=n.responseStatus||"None",x=i.useState(S),C=x[0],k=x[1],E=Ee(),w=vi(E,a),T={startDate:y,startMonth:j,isSmall:a},P=r(p,f),I=Object(R.a)(g)?Ha():g,N={meetingItem:n,meetingDayTimeText:P,isSmall:a,showActionsInBody:s,actionCallbacks:m,index:l,hasRelatedEmailArtifacts:u===br.Success&&Object(W.a)(O,function(e){return e.Type===_r.RelatedEmail||e.Type===_r.RelatedFile}).length>0,meetingArtifactsFetchingStatus:u},A=Ga(n).meetingInfoString,F=Ya(b,!Object(R.a)(v)),D=Ea({meetingName:I,startDate:y.toString(),startMonth:j,meetingDayTimeText:P,meetingLocation:Object(R.a)(F)?"":Pa({meetingLocation:F}),recurringText:Ja(n),attachmentText:$a(n),additionalMeetingInfo:A}),L=c>1,H={meetingItem:n,actionCallbacks:m,index:l,className:w.calendarActionContainer,rsvpResponse:C,setRsvpResponse:k};return m&&(t={heroCalendar:n,actionCallbacks:m,isSmall:a,isMultiEntity:L,index:l,className:w.calendarCommandBar,setRsvpResponse:k,rsvpResponse:C}),i.createElement(i.Fragment,null,i.createElement("div",{className:w.body,role:"listitem",onClick:function(){return null==h?void 0:h(d)},onKeyPress:function(e){e.preventDefault(),Re(e,function(){return null==h?void 0:h(d)})},tabIndex:h?0:-1,"aria-label":D,"aria-posinset":l+1,"aria-setsize":c},i.createElement(Wi,qi({},T)),i.createElement("div",{className:w.meetingDetailsWithAction},i.createElement(Ui,qi({},N)),a&&t&&i.createElement(Pi,qi({},t))),a&&i.createElement(Li,{meetingItem:n,isSmall:a,meetingArtifactsFetchingStatus:u,actionCallbacks:m}),!a&&t&&i.createElement(Pi,qi({},t))),!L&&a&&i.createElement(yi,qi({},H)))};Vi.displayName="CalendarEntity";var Ki=Object(Pe.a)(function(e,t,n){var r,a=e.palette,i=a.neutralLight,o=a.white;return Object(Ge.s)({calendarListItem:["ms-search-calendarListItem",{selectors:(r={},r["& .ms-search-calendarBody-ItemContent"]={borderBottom:t?"":"1px solid "+i,padding:"8px "+(n?"12px":"20px"),paddingBottom:"8px"},r["& .ms-search-calendarBody-ItemContent:hover"]={backgroundColor:o},r)}]})}),Qi=Object(Pe.a)(function(e,t,n){var r,a=n.palette,i=a.neutralLight,o=a.neutralQuaternaryAlt;return Object(Ge.s)({calendarContainer:{selectors:(r={},r["& .ms-search-calender-moredetail-content-classname"]={display:"flex",flexDirection:"column"},r["& .ms-search-meeting-venue-classname"]={marginLeft:"0px"},r["& .ms-search-calendarEntity-calendarActionContainer"]={display:"block"},r["& .ms-search-calender-actionblock-content-classname"]={display:"none"},r["& .ms-search-calendarEntity-calendarCommandBar"]={display:"block"},r["& .ms-search-calendarTile-attachmentIcon"]={display:"none"},r["& .ms-search-calendarEntity-meetingDetailsWithActions"]={display:"flex"},r["& .ms-search-heroTile-headerContainer"]={display:e?void 0:"block"},r["& .ms-search-heroTile-bodyContainer"]={padding:"0px"},r["& .ms-search-tileHeader"]={margin:"0px",padding:"8px "+(t?"12px":"20px")},r["& .ms-search-tileBody"]={margin:"0px",padding:"0px"},r["& .ms-search-calendarTile-rsvpButton-root"]={border:"none",backgroundColor:i,borderRadius:"4px"},r["& .ms-search-calendarTile-rsvpButton-root:hover"]={backgroundColor:o,borderRadius:"4px"},r["& .ms-search-calendarTile-joinButton-root"]={borderRadius:"4px"},r["& .ms-search-calendarTile-joinButton-root:hover"]={borderRadius:"4px"},r["& .ms-search-calendarTile-commandbarButton-root"]={borderRadius:"4px"},r["& .ms-search-calendarTile-commandbarButton-root:hover"]={borderRadius:"4px"},r["& .ms-search-heroCalender-entity-classname"]={margin:"0px"},r["& .ms-search-calendarTile-editButton-root"]={border:"none",borderRadius:"4px",backgroundColor:i},r["& .ms-search-calendarTile-editButton-root:hover"]={backgroundColor:o,borderRadius:"4px"},r["& .ms-search-calendarTile-moreDetailsContainer"]={width:t?void 0:"337px"},r["& .ms-search-calendarTile-insightsIcon"]={display:"inline-block"},r["& .ms-search-calendarInsightsActionBlock"]={display:"flex"},r["& .ms-search-calender-meeting-detail-content-classname"]={marginRight:t?"10px":"0"},r["& .ms-search-meetingDateDayContainer"]={marginRight:t?"12px":"16px"},r)},multiEntityCalendarHeader:["ms-search-CalendarTile-multiEntityHeader",bt,{fontWeight:"600",fontSize:14}],tileHeaderOverride:["ms-search-tileHeader"],tileBodyOverride:["ms-search-tileBody"]})}),Yi=function(){return(Yi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Gi=function(e){var t,n=e.meetingList,r=e.getMeetingDateTimeText,a=e.clientSize,o=e.getClientSizeCallback,c=e.useCalendarCallbacks,l=e.setAnswerHeight,s=e.imageUrl,u=e.onOrganizerProfileClick,d=e.onDismiss,m=e.livePersonaCard,h=e.isDismissible,p=e.className,f=e.headingLevel,g=e.meetingArtifactsFetchingStatus,b=Ee(),v=e.maxMeetingsToShow||3,O=Hr(n,v),y=xe("HeroMultiEntityCalendarTile",752,a,o),j=y[0],S=y[1],x=null===(t=j.current)||void 0===t?void 0:t.offsetHeight;i.useEffect(function(){x&&l&&l(x)},[x]);var C="Small"===S,k=Qi(!!h,C,b);if(Object(R.a)(n))return null;var E={body:i.createElement("div",{role:"list"},Object(Y.a)(O,function(e,t){var n={meetingItem:e,getMeetingDateTimeText:r,isSmall:C,useCalendarCallbacks:c,index:t,maxMeetingsToDisplay:O.length,showActionsInBody:C,meetingArtifactsFetchingStatus:g},a=ci(b,null==e?void 0:e.isCanceled),o=Ki(b,t===Object(q.a)(O)-1,C);return i.createElement("div",{className:et(o.calendarListItem,a.body),key:t},i.createElement(Vi,Yi({},n)))})),header:function(){if(Object(q.a)(n)>1)return i.createElement("div",{className:k.multiEntityCalendarHeader,role:"heading","aria-level":f},wr());var e={heroCalendar:n[0],imageUrl:s,livePersonaCard:m,onOrganizerProfileClick:u};return i.createElement(ei,Yi({},e))}(),isSmall:C,styleOverrides:function(){return{cardStyles:k.calendarContainer,headerStyles:k.tileHeaderOverride,bodyStyles:k.tileBodyOverride}},isDismissible:h,onDismiss:d,className:p};return i.createElement("div",{ref:j},i.createElement(it,Yi({},E)))},Ji=Object(Pe.a)(function(e,t){var n=e.palette.neutralLighterAlt;return Object(Ge.s)({resultTypeDescription:[{fontSize:"14px",lineHeight:"20px"},{fontWeight:600,backgroundColor:n,height:"40px",display:"flex",alignItems:"center",paddingLeft:t?"52px":"72px",paddingRight:"12px",marginBottom:"1px"}]})}),$i=function(e){var t=e.resultType,n=e.className,r=e.isSmall,a=e.headingLevel,o=Ee(),c=Ji(o,r).resultTypeDescription;return i.createElement("div",{className:n},i.createElement("div",{className:c,role:"heading","aria-level":a},function(e){switch(e){case"Event":return qe();case"File":return Ve();case"People":return Ke();default:Object(s.a)(e)}}(t)),e.children)};$i.displayName="HeroMultiEntityTile";var Zi=function(){return(Zi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Xi=function(e){var t,n=e.meetingList,r=e.getMeetingDateTimeText,a=e.clientSize,o=e.getClientSizeCallback,c=e.useCalendarCallbacks,l=e.headingLevel,s=e.setAnswerHeight,u=Hr(n,e.maxMeetingsToShow||3),d=xe("HeroMultiEntityCalendarTile",752,a,o),m=d[0],h=d[1],p=null===(t=m.current)||void 0===t?void 0:t.offsetHeight;i.useEffect(function(){p&&s&&s(p)},[p]);var f="Small"===h;return Object(R.a)(n)?null:i.createElement("div",{ref:m},i.createElement($i,{resultType:"Event",isSmall:f,headingLevel:l},i.createElement("div",{role:"list"},Object(Y.a)(u,function(e,t){var n={meetingItem:e,getMeetingDateTimeText:r,isSmall:f,useCalendarCallbacks:c,index:t,maxMeetingsToDisplay:u.length,showActionsInBody:!1,meetingArtifactsFetchingStatus:br.Failed};return i.createElement(Vi,Zi({},n,{key:t}))}))))},eo=n(251),to=n(281),no=n(247);var ro=n(263),ao=function(e,t,n,r){return new(n||(n=Promise))(function(a,i){function o(e){try{l(r.next(e))}catch(e){i(e)}}function c(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,c)}l((r=r.apply(e,t||[])).next())})},io=function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},oo="ErrorItemNotFound";function co(e,t){var n=this,r=Object(w.a)(),a=i.useState(void 0),o=a[0],c=a[1],l=Object(ro.b)(function(t){return!!e&&function(e,t){return no.b.getSelectors(e).isCallInProgress(Object(no.c)(t))}(t,e)},function(t){return!!e&&function(e,t){return no.b.getSelectors(e).hasLoaded(Object(no.c)(t))}(t,e)},function(t){return!!e&&function(e,t){return no.b.getSelectors(e).hasError(Object(no.c)(t))}(t,e)},function(t){return e?function(e,t){return no.b.getSelectors(e).getLatestSuccess(Object(no.c)(t))}(t,e):void 0},function(r){return function(e,r){return function(a){return ao(n,void 0,void 0,function(){var n;return io(this,function(i){switch(i.label){case 0:return!r||t?[3,2]:(n=[Object(he.f)("GET","ProfilePhoto",r)],[4,a(Object(to.a)(e,n,r))]);case 1:i.sent(),i.label=2;case 2:return[2]}})})}}(r,e)},"FetchPersonPhoto_"+e);return i.useEffect(function(){var n,a,i;if(e)if(t)Promise.resolve(t(e)).then(function(e){c(e)}).catch(function(){});else{if(l.isFetching||!l.data)return;var o=null===(n=null==l?void 0:l.data)||void 0===n?void 0:n.responses[0].status;if(o&&200!==o){if(404===o)try{if((null===(a=null==l?void 0:l.data)||void 0===a?void 0:a.responses[0].body).error.code===oo)return}catch(e){}return void Object(T.a)(r,o.toString())}c($n(null===(i=l.data)||void 0===i?void 0:i.responses[0].body))}},[l.data,t,e]),o}function lo(e,t,n){void 0===t&&(t=!0),void 0===n&&(n=!1);var r=Object(Rr.a)(String(e.getMinutes()),2,"0");return n?so(e,!1)+":"+r+" "+uo(e,t):so(e,!1)+":"+r+uo(e,t)}function so(e,t){var n=Object(Or.d)(e,t,void 0);return Number(n)}function uo(e,t){void 0===t&&(t=!0);var n=Object(Dr.b)();return t?e.getHours()>=12?n.pmPartOfDayLowercaseAbbreviated:n.amPartOfDayLowercaseAbbreviated:e.getHours()>=12?n.pmPartOfDayLowercase:n.amPartOfDayLowercase}var mo="Calendar";var ho=function(e,t,n,r){return new(n||(n=Promise))(function(a,i){function o(e){try{l(r.next(e))}catch(e){i(e)}}function c(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,c)}l((r=r.apply(e,t||[])).next())})},po=function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}};function fo(e,t,n,r,a,i,o,c,l){var s=this,u=null==l?void 0:l.rsvpEvent,d=u&&t?function(t,n){return ho(s,void 0,void 0,function(){return po(this,function(r){switch(r.label){case 0:return function(e,t,n,r,a,i,o){Object(Nn.b)(e,"CalendarEvent_RSVPItem_Click",mo,n,r,a,t,i,o)}(i,e,"Hero",o,c,!0,t.itemIndex),[4,u(t,n)];case 1:return[2,r.sent()]}})})}:void 0,m=null==l?void 0:l.forwardEvent,h=m&&n?function(t){!function(e,t,n,r,a,i,o){Object(Nn.b)(e,"CalendarEvent_Forward_Click",mo,n,r,a,t,i,o)}(i,e,"Hero",o,c,!0,t.itemIndex),m(t)}:void 0,p=null==l?void 0:l.editEvent,f=p&&r?function(t){!function(e,t,n,r,a,i,o){Object(Nn.b)(e,"CalendarEvent_Edit_Click",mo,n,r,a,t,i,o)}(i,e,"Hero",o,c,!0,t.itemIndex),p(t)}:void 0,g=null==l?void 0:l.reply,b=g&&a?function(t){!function(e,t,n,r,a,i,o){Object(Nn.b)(e,"CalendarEvent_Reply_Click",mo,n,r,a,t,i,o)}(i,e,"Hero",o,c,!0,t.itemIndex),g(t)}:void 0,v=null==l?void 0:l.replyAll,O=v&&a?function(t){!function(e,t,n,r,a,i,o){Object(Nn.b)(e,"CalendarEvent_ReplyAll_Click",mo,n,r,a,t,i,o)}(i,e,"Hero",o,c,!0,t.itemIndex),v(t)}:void 0,y=null==l?void 0:l.joinMeeting,j=null==l?void 0:l.openLink,S=y||j?function(t){!function(e,t,n,r,a,i,o){Object(Nn.b)(e,"CalendarEvent_Join_Teams_Click",mo,n,r,a,t,i,o)}(i,e,"Hero",o,c,!0,t.itemIndex),y?y(t):j&&t.onlineMeetingUrl&&j(t.onlineMeetingUrl)}:void 0,x=null==l?void 0:l.scheduleNextMeeting,C=x?function(t){!function(e,t,n,r,a,i,o){Object(Nn.b)(e,"CalendarEvent_ScheduleNextMeeting_Click",mo,n,r,a,t,i,o)}(i,e,"Hero",o,c,!0,t.itemIndex),x(t)}:void 0,k=null==l?void 0:l.livePersonaCard,E=k?function(e){return k(e)}:void 0,w=null==l?void 0:l.openEvent,T=null==l?void 0:l.onConflictClick,P=T?function(t){!function(e,t,n,r,a,i,o){Object(Nn.b)(e,"CalendarEvent_Conflicts_Expand_Click",mo,n,r,a,t,i,o)}(i,e,"Hero",o,c,!0,t.itemIndex),T(t)}:void 0;return{rsvpEvent:d,forwardEvent:h,editEvent:f,reply:b,replyAll:O,joinMeeting:S,scheduleNextMeeting:C,livePersonaCard:E,openEvent:w?function(t){!function(e,t,n,r,a,i,o){Object(Nn.b)(e,"CalendarEvent_Event_Click",mo,n,r,a,t,i,o)}(i,e,"Hero",o,c,!0,t.itemIndex),w(t)}:void 0,dateTimeFormatter:null==l?void 0:l.dateTimeFormatter,getProfilePhotoUrl:null==l?void 0:l.getProfilePhotoUrl,onConflictClick:P,relatedAttachmentClick:function(t){t.accessUrl&&(j?j(t.accessUrl):window.open(t.accessUrl,"_blank"),function(e,t,n,r,a,i,o){Object(Nn.b)(e,"CalendarEvent_RelatedAttachment_Click",mo,n,r,a,t,i,o)}(i,e,"Hero",o,c,!0,t.itemIndex))}}}function go(e,t){var n=Object(Or.b)(e),r=null==t?void 0:t.formatUserTime,a=r?r(n.toISOString()):void 0;return a&&!Object(R.a)(a)?a:lo(n,!1,!0)}function bo(e,t,n){var r=Object(w.a)(),a=Object(l.b)(),o=Object(se.a)().clientActionCallbacks,c=i.useState(!1),s=c[0],u=c[1],d=i.useState(!1),m=d[0],h=d[1],p=i.useState(!1),f=p[0],g=p[1],b=i.useState(!1),v=b[0],O=b[1];if(i.useEffect(function(){var e,n,r,a;Promise.all([null===(e=null==o?void 0:o.canEdit)||void 0===e?void 0:e.call(o,t),null===(n=null==o?void 0:o.canForward)||void 0===n?void 0:n.call(o,t),null===(r=null==o?void 0:o.canRsvp)||void 0===r?void 0:r.call(o,t),null===(a=null==o?void 0:o.canReply)||void 0===a?void 0:a.call(o,t)]).then(function(e){u(!!e[0]),h(!!e[1]),g(!!e[2]),O(!!e[3])})},[t]),e)return i.useMemo(function(){return fo(e,f,m,s,v,r,a,n,o)},[f,m,s,v])}var vo=n(116);function Oo(){var e,t,n,r=Object(u.useSelector)(vo.c),a=Object(u.useSelector)(vo.b);return e="Calendar",t=Object(u.useSelector)(function(t){return Object(C.b)(t,e)}),n=Object(u.useSelector)(function(t){return Object(C.u)(t,e)}),Object(ro.b)(vo.c,vo.b,vo.d,vo.a,function(e){return Object(de.a)(e,t)},"FetchAsyncResolution",n),r?br.Pending:a?br.Success:br.Failed}var yo,jo,So,xo,Co=function(){return(Co=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},ko=function(e){var t=e.className,n=Object(u.useSelector)(eo.a),r=Object(l.a)(),a=Object(l.b)(),o=Object(u.useSelector)(g.k),c=Object(w.a)(),s=Object(l.h)().additionalAnswerConfigs,d=null==r?void 0:r.setAnswerHeight,m=null==r?void 0:r.dismissAnswer,h=Object(l.i)(),p=null==s?void 0:s.answerBlockId,f=null==r?void 0:r.livePersonaCard,b=Object(En.a)(n,3),v=i.useMemo(function(){var e=b&&b.filter(function(e){var t=function(e){var t=e.organizer,n=e.meetingStart,r=e.meetingEnd;return t.fullName&&t.email&&n&&r?{isValid:!0}:{isValid:!1,missingFields:(t.fullName?"":"organizer_fullName ")+(t.email?"":"organizer_email ")+(n?"":"meetingStart ")+(r?"":"meetingEnd ")}}(e),n=t.isValid,r=t.missingFields;return!n&&Object(T.e)(c,"Event entity dropped due to missing required fields",r),n});return e&&!Object(R.a)(e)||Object(T.e)(c,"Calendar Answer dropped due to missing required fields"),e},[JSON.stringify(b)]),O=pe(v),y=Object(K.a)(v),j=null==y?void 0:y.organizer,S=(null==y?void 0:y.id)||"",x=(null==y?void 0:y.hexItemId)||"",C=bo(y,{itemId:S,hexItemId:x},o),k=null==C?void 0:C.getProfilePhotoUrl,E=!!(null==s?void 0:s.enableMultiEntityCalendarAnswer)&&Object(q.a)(v)>1,P=E?"Hero_MeetingList_Impression":"Hero_SingleMeeting_Impression",I=null==s?void 0:s.enableCalendarInsights,N=zn({entities:v,domain:"Calendar",isHero:!0,impressionEventId:P,intent:"CalendarEntry",groupReferenceId:p,clickEventId:"CalendarEvent_Organizer_Profile_Click",traceId:o}),A=Oo(),F=co(E?void 0:null==j?void 0:j.email,k),D=function(e,t){return function(e,t,n){var r=go(e,n),a=go(t,n),i=kr({start:r.toUpperCase(),end:a.toUpperCase()}),o=Ma(e),c=Ma(t);return o!==c?Tr({startDay:o,endDay:c,startTime:r.toUpperCase(),endTime:a.toUpperCase()}):Cr({day:o,time:i})}(e,t,null==r?void 0:r.dateTimeFormatter)};i.useEffect(function(){var e;!O&&v&&y&&(null===(e=null==r?void 0:r.setAnswerBlockRendered)||void 0===e||e.call(r))});var L=function(e,t){return bo(e,t,o)};if(!b||Object(R.a)(b))return Object(T.h)(c,"Unexpected Empty response received for Calendar"),null;if(!v||Object(R.a)(v)||!y)return null;var W=function(){H&&(null==m||m(),Object(Nn.a)(c,"Hero","Calendar",a,o,p,!0))},H=null==s?void 0:s.isAnswerDismissible,M=null==r?void 0:r.getCurrentClientSize;if(null==s?void 0:s.enableCalendarAnswerV2){var B={meetingList:Object(Y.a)(v,function(e){return Co(Co({},e),{insights:I?e.insights:void 0,artifacts:I?e.artifacts:void 0})}),clientSize:a,getMeetingDateTimeText:D,useCalendarCallbacks:L,headingLevel:h,maxMeetingsToShow:3,imageUrl:F,livePersonaCard:f,getClientSizeCallback:M,setAnswerHeight:d,onOrganizerProfileClick:N.onEntityClick,isDismissible:H,onDismiss:W,className:t,meetingArtifactsFetchingStatus:I?A:br.Failed};return i.createElement(Gi,Co({},B))}if(E){var z={meetingList:v,maxMeetingsToShow:3,getMeetingDateTimeText:D,clientSize:a,getClientSizeCallback:M,useCalendarCallbacks:L,headingLevel:h,setAnswerHeight:d};return i.createElement(Xi,Co({},z))}if(!y||!C)return null;B={heroCalendar:y,actionCallbacks:C,className:t,getMeetingDateTimeText:D,imageUrl:F,clientSize:a,setAnswerHeight:d,onOrganizerProfileClick:N.onEntityClick,isDismissible:H,onDismiss:W};return i.createElement(gi,Co({},B))},Eo=n(406),wo=n(397),To=n(259),Po=(Object(Pe.a)(function(e){var t=e.palette,n=t.blue,r=t.neutralLight;return Object(Ge.s)({commandBarItem:{display:"none"},shareButton:{color:n,height:"28px",width:"28px",float:"left",marginRight:"5px",selectors:{":hover":{backgroundColor:r,color:n}}},commandbar:{float:"left"},appLogo:{height:"16px",width:"16px"}})}),Object(Pe.a)(function(e){var t=e.palette.white;return Object(Ge.s)({root:{background:t,minWidth:"28px",maxWidth:"28px",height:"28px",border:"none"}})}),Object(Pe.a)(function(){return Object(Ge.s)({root:{paddingLeft:"10px",paddingRight:"10px",height:"45px"}})}),Object(Pe.a)(function(e){var t=e.palette.white;return Object(Ge.s)({root:{background:t,float:"right",paddingRight:"0px",paddingLeft:"0px"}})}),Object(Pe.a)(function(e){var t=e.palette.blue;return Object(Ge.s)({root:{color:t}})}),Object(Pe.a)(function(){return Object(Ge.s)({root:{height:"16px",width:"16px"}})}),Object(Pe.a)(function(e){var t=e.palette.neutralSecondary;return Object(Ge.s)({root:{color:t}})}),Object(Pe.a)(function(){return Object(Ge.s)({root:{display:"block"}})}),n(256));function Io(e){return e+"?web=1"}function No(e,t,n,r,a){var i=function(e){a&&e?a(e):window.open(e,"_blank"),r&&r()};return Object(Y.a)(e,function(e,r){var a=function(e,t){if(t>e.length)return;return e.slice(0,t+1).join("/")}(t,r+n);return{key:e,text:decodeURIComponent(e),onClick:function(e){null==e||e.stopPropagation(),i(a)},onKeyPress:function(e){null==e||e.stopPropagation(),i(a)}}})}function Ao(e,t,n,r){void 0===r&&(r=new Date);var a=r.getTime(),i=new Date(t),o=a-i.getTime(),c=Math.floor(o/Lr.c),l=Object(To.a)(i,r);if("Link"===e||"Attachment"===e)return Object(Eo.l)(r,i)?Object(Po.n)({name:n}):Object(Or.p)(i,r)?Object(Po.o)({name:n}):c<r.getDay()?Object(Po.l)({name:n,day:Object(wo.a)(i.getDay())}):c<Lr.w/Lr.c+r.getDay()?Object(Po.k)({name:n}):i.getMonth()===r.getMonth()&&i.getFullYear()===r.getFullYear()?Object(Po.m)({name:n}):Object(Po.l)({name:n,day:l});var s=new Date(t),u=new Date,d=Object(To.b)(s,u),m=Object(Po.v)(d,n);return d?m:Mo(m)}function Fo(e,t,n){var r,a,i,o,c,l,s=e.fileType,u=e.sender,d=e.dateCreated,m=e.modifiedByDisplayName,h=e.dateModified,p=e.modifiedBy,f=e.propertyHits,g=e.author,b=e.authorEmail,v=function(){if(s&&u&&d){var e=u.emailAddress,m=e.name,h=e.address;o=h,c=m,l="Sender",m&&(Do(o,t,n)?(a=Mo(a=Ao(s,d,Object(Po.T)())),i=[a]):(a=Ao(s,d,r=m),i=a.split(r)))}};return Object(L.a)(f,"EmailSenderName")&&u&&d?v():g&&f&&Object(L.a)(f,"Author")?(c=g,l="Author",Do(o=b,t,n)?(a=Mo(a=Object(Po.a)({name:Object(Po.T)()})),i=[a]):(a=Object(Po.a)({name:g}),r=g,i=a.split(r))):("Attachment"===s||"Link"===s)&&u&&d?v():("File"===s||"Folder"===s)&&m&&h&&(o=p,c=m,l="Modifier",Do(p,t,n)?(a=Mo(a=Ao(s,h,Object(Po.T)())),i=[a]):(a=Ao(s,h,m),i=a.split(m),r=m)),{connectionName:r,headerString:a,headerStringSplits:i,connectionEmail:o,personFullName:c,relation:l}}function Do(e,t,n){return(null==t?void 0:t.toLowerCase())===(null==e?void 0:e.toLowerCase())||(null==n?void 0:n.toLowerCase())===(null==e?void 0:e.toLowerCase())}function Lo(e,t,n){return!!n&&("File"===e||"Attachment"===e&&"ClassicAttachment"===t)}function Ro(e,t,n){return!!n&&("Link"===e||"File"===e||"Folder"===e||"Attachment"===e&&"ClassicAttachment"!==t)}function Wo(e,t){return!!e&&!!t}function Ho(e,t,n){if(e)switch(e){case"Mail":return function(e){return Object(Po.i)({title:e||Object(Po.w)()})}(t);case"Teams":return function(e,t){if(e)return Object(Po.N)({chat:e});if(t)return Object(Po.O)({name:t});return Object(Po.N)({chat:Object(Po.w)()})}(t,n);case"CalendarEvent":return function(e){if(e)return Object(Po.M)({title:e});return}(t);default:return}}function Mo(e){var t;return(null===(t=e[0])||void 0===t?void 0:t.toUpperCase())+e.substr(1)}function Bo(e,t,n,r,a,i){var o;if(null==t||t.stopPropagation(),"Attachment"===e.fileType){var c="ClassicAttachment"!==e.fileSourceType;null==r||r({attachmentId:null===(o=e.attachmentId)||void 0===o?void 0:o.id},c)}i?i(e.accessUrl):window.open(e.accessUrl),null==a||a(e,n)}function zo(e,t,n,r,a){null==t||t.stopPropagation();var i=Io(e.accessUrl);null==r||r(i),null==a||a(e,n)}function _o(e,t,n,r,a,i){var o,c=e.fileType,l=e.sharingReferenceType,s=Io(e.accessUrl);null==t||t.stopPropagation(),"Attachment"===c&&"Mail"===l&&(null==a||a(null===(o=e.attachmentId)||void 0===o?void 0:o.id)),("Link"===c||"File"===c||"Folder"===c||"Teams"===l)&&(null==i||i(s)),null==r||r(e,n)}!function(e){e[e.docx=0]="docx",e[e.doc=1]="doc"}(yo||(yo={})),function(e){e[e.pptx=0]="pptx",e[e.ppt=1]="ppt",e[e.pot=2]="pot",e[e.potx=3]="potx",e[e.potm=4]="potm",e[e.ppam=5]="ppam",e[e.ppsx=6]="ppsx",e[e.ppsm=7]="ppsm",e[e.sldx=8]="sldx",e[e.sldm=9]="sldm",e[e.ppa=10]="ppa",e[e.pps=11]="pps",e[e.pptm=12]="pptm",e[e.powerpoint=13]="powerpoint"}(jo||(jo={})),function(e){e[e.xls=0]="xls",e[e.xlsx=1]="xlsx",e[e.xlb=2]="xlb",e[e.xlc=3]="xlc",e[e.xlsb=4]="xlsb",e[e.xlsm=5]="xlsm",e[e.xlt=6]="xlt",e[e.xltx=7]="xltx",e[e.xltm=8]="xltm",e[e.xlm=9]="xlm",e[e.xla=10]="xla",e[e.xll=11]="xll",e[e.xlam=12]="xlam",e[e.xlw=13]="xlw",e[e.excel=14]="excel",e[e.csv=15]="csv"}(So||(So={})),function(e){e[e.one=0]="one",e[e.note=1]="note"}(xo||(xo={}));var Uo=Object(Pe.a)(function(){return Object(Ge.s)({headerContent:["ms-search-fileTile-headerContent",{fontSize:"14px",lineHeight:"24px",verticalAlign:"middle",display:"flex",flexDirection:"row",overflow:"hidden"}],senderFullName:{fontWeight:"600"},answerTitle:["ms-search-fileTile-answerTitle",bt,{fontWeight:"400",fontSize:"14px",paddingLeft:"8.75px"}],profilePhoto:{float:"left"}})}),qo=function(){return(qo=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Vo=function(e){var t=e.file,n=e.profilePictureUrl,r=e.userEmail,a=e.userUpn,o=e.livePersonaCard,c=e.onProfileClick,l=t.fileType,s=t.sender,u=t.dateCreated,d=t.modifiedByDisplayName,m=t.dateModified,h=i.useState(!1),p=h[0],f=h[1],g=Uo(),b=g.headerContent,v=g.profilePhoto,O=g.answerTitle,y=g.senderFullName,j=yr(n);if(!(("File"!==l||d&&m)&&("Link"!==l&&"Attachment"!==l||s&&s.emailAddress&&s.emailAddress.name&&u)))return null;var S=Fo(t,r,a),x=S.connectionName,C=S.headerString,k=S.headerStringSplits,E=S.connectionEmail,w=S.personFullName,T=S.relation;if(!k)return null;var P={imageUrl:j?n:void 0,size:1,hidePersonaDetails:!0,imageShouldFadeIn:!1,imageShouldStartVisible:!0,showInitialsUntilImageLoads:!0,imageInitials:Object(jr.a)(w,!1),initialsColor:Object(Sr.a)({text:w})},I=tt(o,w,E),N=i.createElement("div",{className:v,role:o?"button":void 0,onClick:o?function(){return T&&(null==c?void 0:c(T))}:void 0,onKeyPress:o?function(){return T&&(null==c?void 0:c(T))}:void 0},i.createElement(xr.a,qo({},P))),A=I?i.createElement(I,null,N):N,F=i.createElement("span",{className:y,role:o?"button":void 0,onClick:o?function(){return T&&(null==c?void 0:c(T))}:void 0,onKeyPress:o?function(){return T&&(null==c?void 0:c(T))}:void 0},x),D=I?i.createElement(I,null,F):F;return i.createElement("div",{className:b},A,i.createElement("div",{className:O,title:p?C:void 0,role:"presentation","aria-label":C,onMouseOver:function(e){return function(e){var t=e.currentTarget,n=t.clientWidth,r=t.scrollWidth;f(n!==r)}(e)}},k[0],i.createElement("span",{className:y},D),k[1]))},Ko=Object(Pe.a)(function(e){return Object(Ge.s)({fileTypeIcon:{flexShrink:0,flexGrow:0,width:e+"px",height:e+"px"}})});function Qo(e){if(e)switch(e){case"Folder":case"WebPage":return Ai.FileIconType.folder;default:return Object(s.a)(e)}}var Yo=function(e){var t=e.fileExtension,n=e.fileType,r=e.iconSize,o=e.className,c=Object(Ai.getFileTypeIconProps)({extension:t,size:r||32,type:Qo(n)}),l=Ko(r||32).fileTypeIcon+" "+o;return i.createElement(ct.a,Object(a.__assign)({role:"presentation"},c,{className:l,"aria-hidden":!0}))},Go=n(500),Jo=Object(Pe.a)(function(e,t,n){var r=e.palette,a=r.neutralDark,i=r.neutralLighter;return Object(Ge.s)({breadcrumbContainer:{display:"flex",height:"20px",marginRight:t?"0":"16px"},folderInfoContainer:[bt,{marginRight:t?"0":"16px"}],folderInfo:{color:a,fontWeight:"400",fontSize:14},folder:[bt,"ms-search-file-breadCrumbFolder",{fontSize:14,color:a,maxWidth:t?"120px":"150px",height:"20px",selectors:{"&:hover":{background:n?void 0:i,textDecoration:"underline"},cursor:"Pointer"}}],overflowIcon:{margin:"-5px 0 0 0",height:"20px"},chevron:{margin:"5px 5px",height:"20px",fontSize:"10px"}})}),$o=function(e){var t=e.items,n=e.overflowTitle,r=e.isSmall,a=e.fileSourceType,o=e.isV2,c=Ee(),l=Jo(c,r,o),s=l.folder,u=l.overflowIcon,d=l.chevron,m=l.breadcrumbContainer,h=t[0],p=t[t.length-1],f=t.length>2;if(o){var g=function(e,t){return"SharepointOnline"===e?Object(Po.u)({folder:t}):"OneDriveForBusiness"===e?Object(Po.t)({folder:t}):void 0}(a,p.text),b=null==g?void 0:g.split(p.text);return b?i.createElement("div",{className:l.folderInfoContainer,title:g},i.createElement("span",{className:l.folderInfo},b[0]),i.createElement("span",{role:"Link",tabIndex:0,title:p.text,onClick:p.onClick,onKeyPress:p.onKeyPress,className:s},p.text),i.createElement("span",null,b[1])):null}return i.createElement("div",{className:m},i.createElement("div",{role:"Link",onClick:h.onClick,onKeyPress:h.onKeyPress,tabIndex:0,title:h.text,className:s},h.text),i.createElement(ct.a,{iconName:"ChevronRightMed",className:d}),f&&i.createElement(i.Fragment,null,i.createElement("span",{title:n,className:u,role:"presentation",onClick:function(e){e.stopPropagation()}},"..."),i.createElement(ct.a,{iconName:"ChevronRightMed",className:d})),i.createElement("div",{role:"Link",tabIndex:0,title:p.text,onClick:p.onClick,onKeyPress:p.onKeyPress,className:s},p.text))},Zo=function(e){var t=e.accessUrl,n=e.minFolderPath,r=e.maxFolderPath,a=e.isSmall,o=e.fileSourceType,c=e.isV2,l=e.onMalformedURLError,s=e.onBreadcrumbclick,u=e.openLink,d=i.useRef(null),m=t.split("/");if(m.length<=n+2)return null;var h,p,f=Math.max(n,m.length-(r||m.length+1)-1),g=Object(Go.a)(m,f,m.length-1);try{h=g.map(function(e){return decodeURIComponent(e)}).join(" > "),p=No(g,m,f,s,u)}catch(e){return null==l||l("FolderBreadCrumb"),null}return i.createElement("div",{ref:d},i.createElement($o,{items:p,isSmall:!!a,overflowTitle:h,fileSourceType:o,isV2:c}))},Xo=Object(Pe.a)(function(e){var t=e.palette,n=t.neutralDark,r=t.white;return Object(Ge.s)({actionContainer:{height:"32px",marginTop:"-5px",paddingRight:"8px",borderRadius:"3px",display:"flex",minWidth:"100px"},icon:{height:"20px",width:"20px",margin:"5px 0 10px 12px",color:n},disabledIcon:{opacity:"40%",selectors:{":hover":{background:r}}}})}),ec=function(e){var t=e.file,n=e.index,r=e.onFileShareClick,a=e.shareByEmail,o=e.composeEmail,c=e.onFileCopyLinkClick,l=e.onFileDownloadClick,s=e.downloadAttachment,u=e.copyLink,d=e.openLink,m=t.fileType,h=t.fileSourceType,p=Ee();if(!Wo(a,o)&&!Lo(m,h,s)&&!Ro(m,h,u))return null;var f=Xo(p),g=Wo(a,o),b=Lo(m,h,s),v=Ro(m,h,u),O=et(f.icon,f.disabledIcon);return i.createElement("div",{className:f.actionContainer},i.createElement(Te.a,{iconProps:{iconName:"Share"},title:g?Object(Po.L)():Object(Po.h)({action:Object(Po.L)()}),onClick:g?function(e){return _o(t,e,n,r,a,o)}:function(e){return e.stopPropagation()},className:g?f.icon:O}),i.createElement(Te.a,{iconProps:{iconName:"Download"},title:b?Object(Po.j)():Object(Po.h)({action:Object(Po.j)()}),onClick:b?function(e){return Bo(t,e,n,s,l,d)}:function(e){return e.stopPropagation()},className:b?f.icon:O}),i.createElement(Te.a,{iconProps:{iconName:"PageLink"},title:v?Object(Po.b)():Object(Po.h)({action:Object(Po.b)()}),onClick:v?function(e){return zo(t,e,n,u,c)}:function(e){return e.stopPropagation()},className:v?f.icon:O}))},tc=Object(Pe.a)(function(){return Object(Ge.s)({commandbar:{marginLeft:"auto",marginTop:"16px",alignItems:"center",float:"right",padding:"0"}})}),nc=Object(Pe.a)(function(e){var t=e.palette.blue;return Object(Ge.s)({root:{color:t,padding:"0"}})}),rc=(Object(Pe.a)(function(){return Object(Ge.s)({root:{height:"100%",padding:"0"}})}),Object(Pe.a)(function(e){var t=e.palette.white;return Object(Ge.s)({root:{background:t,minWidth:"20px",maxWidth:"20px",height:"28px",border:"none"}})}),Object(Pe.a)(function(e){var t=e.palette.white;return Object(Ge.s)({root:{background:t,float:"right",height:"100%",padding:"0"}})})),ac=function(e,t){for(var n=0,r=t.length,a=e.length;n<r;n++,a++)e[a]=t[n];return e},ic=function(e){var t=e.file,n=e.index,r=e.onFileShareClick,a=e.shareByEmail,o=e.composeEmail,c=e.onFileCopyLinkClick,l=e.onFileDownloadClick,s=e.downloadAttachment,u=e.copyLink,d=e.openLink,m=t.fileType,h=t.fileSourceType,p=Ee();if(!Wo(a,o)&&!Lo(m,h,s)&&!Ro(m,h,u))return null;var f={text:Object(Po.j)(),key:Object(Po.j)(),onClick:function(e){return Bo(t,e,n,s,l,d)},iconProps:{iconName:"Download"}},g={text:Object(Po.L)(),key:Object(Po.L)(),onClick:function(e){return _o(t,e,n,r,a,o)},iconProps:{iconName:"Share"}},b={text:Object(Po.b)(),key:Object(Po.b)(),onClick:function(e){return zo(t,e,n,u,c)},iconProps:{iconName:"PageLink"}},v=ac(ac(ac([],Wo(a,o)?[g]:[]),Lo(m,h,s)?[f]:[]),Ro(m,h,u)?[b]:[]);return i.createElement(Si.a,{styles:rc(p),items:[],overflowItems:v,className:tc().commandbar,overflowButtonProps:{menuIconProps:{styles:nc(p)}}})},oc=Object(Pe.a)(function(e,t,n,r,a,i,o,c,l){var s=e.palette,u=s.neutralDark,d=s.neutralSecondary,m=s.white,h=s.neutralLight,p=s.neutralLighterAlt;return Object(Ge.s)({fileContainer:["ms-search-fileTile-fileContainer",{backgroundColor:m,height:t?"auto":"40px",borderBottom:c?void 0:a?"none":"1px solid",borderColor:h,selectors:{"&:hover":{backgroundColor:p}}}],fileCard:["ms-search-fileTile-fileCard",{height:t?"auto":"39px",display:t?"flex":"block",padding:t?"8px 0 12px 0":"0",margin:t?"0 12px":c?"0 24px":"0 32px",borderBottom:c?a?"none":"1px solid":void 0,borderColor:h}],fileInfoContainer:{width:o?"calc(100% - 84px)":"calc(100% - 40px)",float:"left",height:t?"auto":"30px",display:t?"block":"flex",marginTop:t?"0":"10px"},fileNameContainer:["ms-search-fileTile-fileNameContainer",{height:"20px",float:"left",width:t?"100%":"240px",marginRight:t?"0":"25px"}],titleText:["ms-search-fileTile-titleText",bt,{color:u,float:"left",width:t?"100%":"240px",fontSize:i?14:17,fontWeight:"600",display:"inline-block",selectors:{"&:hover":{textDecoration:"none",color:u}}}],folderBreadcrumb:{width:n&&t?"calc(100% - 65px)":"100%",float:"left"},emailSubject:["ms-search-fileTile-emailSubject",bt,{color:u,fontWeight:"400",fontSize:14,display:"flex",height:"20px",float:"left",width:t&&n?"calc(100% - 65px)":"100%",maxWidth:t?void 0:"400px",marginRight:t?"0":"16px"}],sourceSubject:[bt,{marginLeft:"3px",selectors:{":hover":{textDecoration:l?"underline":"none"}}}],fileIcon:[xn,{float:"left",marginRight:"12px",marginTop:t?"0":"4px",height:"auto",selectors:{"> img":{height:"28px",width:"28px",marginTop:"2px"}}}],fileIconContainer:{width:"40px",height:"100%",float:"left"},tertiaryInfo:[bt,{fontWeight:"400",fontSize:14,height:"20px",width:t&&n&&!r?"calc(100% - 65px)":"100%",color:d,float:"left"}],actionContainer:{width:"55px",float:"left",fontSize:12,display:"inline-block"},sizeInfo:{width:"55px",float:"right",fontSize:12,textAlign:"right",color:d},sizeContainer:{flex:"auto"},sourceContainer:{width:i||t?void 0:"calc(100% - 373px)"}})}),cc=function(){return(cc=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},lc=function(e){var t=e.file,n=e.index,r=e.isSmall,a=e.userEmail,o=e.userUpn,c=e.showActions,l=e.numberOfFiles,s=e.showConnection,u=e.showSameLargeView,d=e.onFileShareClick,m=e.onFileSourceClick,h=e.shareByEmail,p=e.composeEmail,f=e.onFileCopyLinkClick,g=e.onFileDownloadClick,b=e.downloadAttachment,v=e.copyLink,O=e.onFileClick,y=e.openAttachmentInClient,j=e.onFolderBreadcrumbClick,S=e.onMalformedURLError,x=e.openLink,C=t.fileExtension,k=t.accessUrl,E=t.title,w=t.subject,T=t.fileType,P=t.attachmentId,I=t.itemId,N=(t.fileSize,t.sharingReferenceType),A=t.itemHexId,F=t.fileName,D=t.sharingReferenceUrl,L=t.sender,R=t.fileSourceType,W=Ee(),H=i.useState(!1),M=H[0],B=H[1],z=i.useState(!1),_=z[0],U=z[1],q=Ho(N,w,null==L?void 0:L.emailAddress.name),V=w||("Teams"===N&&(null==L?void 0:L.emailAddress.name)?null==L?void 0:L.emailAddress.name:Object(Po.w)()),K=null==q?void 0:q.split(V),Q=!!q||"File"===T,Y=!(!c||!r||!(h||p||b||v)),G=oc(W,r||!!u,!1,Q,n===l-1,1!==l,Y,!!c,!!(c&&D)),J=G.titleText,$=G.fileIcon,Z=G.fileInfoContainer,X=G.folderBreadcrumb,ee=G.fileIconContainer,te=G.fileNameContainer,ne=G.tertiaryInfo,re=G.emailSubject,ae=G.fileCard,ie=G.fileContainer,oe=(G.sizeInfo,G.sizeContainer,Io(k)),ce=Fo(t,a,o).headerString,le=function(){var e={itemId:null==I?void 0:I.id,accessUrl:oe,attachmentId:null==P?void 0:P.id,hexItemId:A,attachmentName:F,fileType:T};y&&P&&I&&"Attachment"===T&&N&&"Mail"===N?y(e):y&&N&&"Mail"===N?y(e):x?x(oe):window.open(oe),O(t,n)};var se={accessUrl:k,isSmall:r,minFolderPath:4,fileSourceType:R,isV2:c,onBreadcrumbclick:function(){j&&j(t,n)},onMalformedURLError:S,openLink:x},ue={file:t,index:0,onFileShareClick:d,shareByEmail:h,composeEmail:p,onFileCopyLinkClick:f,onFileDownloadClick:g,copyLink:v,downloadAttachment:b,openLink:x};function de(e){D&&c&&(null==e||e.stopPropagation(),x?x(D):window.open(D,"_blank"),null==m||m(t,n,N))}var me=ue,he="Attachment"===T?"button":"link",pe="File"!==T?q:Po.s,fe=(Object(Po.S)({type:C})+" "+F+" "+pe+" "+ce).substring(0,512);return i.createElement("div",{className:ie,tabIndex:0,role:"listitem",onKeyPress:function(){return le()},onClick:le,"aria-posinset":n+1,"aria-setsize":l},i.createElement("div",{role:he,className:ae},i.createElement("div",{className:ee,"aria-label":fe,"aria-hidden":!1},i.createElement(Yo,{className:$,fileExtension:C})),i.createElement("div",{className:Z},i.createElement("div",{className:te},i.createElement("div",{className:J,role:"presentation",onMouseOver:function(e){return function(e){var t=e.currentTarget,n=t.clientWidth,r=t.scrollWidth;B(n!==r)}(e)},title:M?E:void 0},E)),i.createElement("div",{className:G.sourceContainer},"File"===T&&i.createElement("div",{className:X},i.createElement(Zo,cc({},se))),"File"!==T&&q&&Q&&K&&i.createElement("div",{className:re,role:"Tooltip",title:q},i.createElement("span",null,K[0]),i.createElement("span",{className:G.sourceSubject,role:c?"link":"tooltip",tabIndex:c?0:-1,onClick:function(e){return de(e)},onKeyPress:function(e){return Re(e,de)}},V),i.createElement("span",null,K[1])),!1),ce&&s&&i.createElement("div",{className:ne,role:"tooltip",onMouseOver:function(e){return function(e){var t=e.currentTarget,n=t.clientWidth,r=t.scrollWidth;U(n!==r)}(e)},title:_?ce:void 0},ce),c&&!Y&&i.createElement(ec,cc({},ue)),!1),Y&&i.createElement(ic,cc({},me))))};lc.displayName="FileEntity";var sc=Object(Pe.a)(function(e){var t;return Object(Ge.s)({fileContainer:{selectors:(t={},t["& .ms-search-fileTile-fileNameContainer"]={height:"25px"},t["& .ms-search-fileTile-fileCard"]={margin:"0",padding:"0 0 8px 0"},t["& .ms-search-fileTile-fileContainer:hover"]={backgroundColor:e.palette.white,cursor:"pointer"},t)}})}),uc=function(){return(uc=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},dc=function(e){var t,n=e.file,r=e.clientSize,a=e.profilePictureUrl,o=e.userEmail,c=e.userUpn,l=e.className,s=e.isDismissible,u=e.showActions,d=e.onFileClick,m=e.onFileSourceClick,h=e.livePersonaCard,p=e.onMalformedURLError,f=e.openAttachmentInClient,g=e.setAnswerHeight,b=e.openLink,v=e.onFolderBreadcrumbClick,O=e.onProfileClick,y=e.onDismiss,j=e.onFileShareClick,S=e.shareByEmail,x=e.composeEmail,C=e.onFileCopyLinkClick,k=e.onFileDownloadClick,E=e.copyLink,w=e.downloadAttachment,T=n.thumbnailUrl,P=xe("HeroFileTile",752,r),I=P[0],N=P[1],A=Ee(),F=null===(t=I.current)||void 0===t?void 0:t.offsetHeight;i.useEffect(function(){F&&g&&g(F)},[F]);var D,L="Small"===N,R={file:n,profilePictureUrl:a,userEmail:o,userUpn:c,livePersonaCard:h,onProfileClick:O},W={headerImageUrl:T,imagePosition:L?void 0:"Right",imageHeight:"100%",imageWidth:"185px"},H={body:(D={file:n,index:0,isSmall:L,userEmail:o,userUpn:c,numberOfFiles:1,showConnection:!1,showSameLargeView:!u,showActions:u,onFileShareClick:j,shareByEmail:S,onFileSourceClick:m,composeEmail:x,onFileCopyLinkClick:C,onFileDownloadClick:k,copyLink:E,downloadAttachment:w,onFileClick:d,openAttachmentInClient:f,onFolderBreadcrumbClick:v,onMalformedURLError:p,openLink:b},i.createElement(lc,uc({key:"File0"},D))),header:i.createElement(Vo,uc({},R)),isSmall:L,imageProps:W,styleOverrides:function(){return{cardStyles:L||u?void 0:"ms-search-maxContent"}},className:l,isDismissible:s,onDismiss:y},M=sc(A);return i.createElement("div",{className:M.fileContainer,ref:I},i.createElement(it,uc({},H)))};dc.displayName="HeroFileTile";var mc=Object(Pe.a)(function(e){var t,n;return Object(Ge.s)({tileBodyOverride:["ms-search-tile-body"],tile:{selectors:(t={},t["& .ms-search-tile-body"]={margin:"0",padding:"0"},t)},tileHeader:{padding:0},multiEntityFileHeader:["ms-search-fileTile-multiEntityHeader",bt,{fontWeight:"600",fontSize:14}],multiEntityFileBody:["ms-search-multiEntityFileBody",{selectors:(n={},n["& .ms-search-fileTile-fileContainer:hover"]={backgroundColor:e.palette.white},n["& .ms-search-fileTile-fileContainer"]={cursor:"pointer"},n["& .ms-search-heroTile-headerContainer"]={margin:"0",padding:"8px 24px"},n)}]})}),hc=function(){return(hc=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},pc=function(e){var t=e.renderBody,n=e.isSmall,r=e.className,a=e.isDismissible,o=e.onDismiss,c=e.headingLevel,l=Ee(),s=mc(l),u={body:t(),header:i.createElement("div",{className:s.multiEntityFileHeader,role:"heading","aria-level":c},Object(Po.q)()),isSmall:n,styleOverrides:function(){return{bodyStyles:s.tileBodyOverride,cardStyles:s.tile}},className:r,isDismissible:a,onDismiss:o};return i.createElement(it,hc({},u))},fc=function(){return(fc=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},gc=function(e){var t,n=e.files,r=e.userEmail,a=e.userUpn,o=e.clientSize,c=e.headingLevel,l=e.enableFileAnswerV2,s=e.enableFileAnswerV3,u=e.className,d=e.isDismissible,m=e.showActions,h=e.onFileClick,p=e.onFileSourceClick,f=e.onMalformedURLError,g=e.openAttachmentInClient,b=e.getClientSizeCallback,v=e.onFolderBreadcrumbClick,O=e.openLink,y=e.setAnswerHeight,j=e.onDismiss,S=e.onFileShareClick,x=e.shareByEmail,C=e.composeEmail,k=e.onFileCopyLinkClick,E=e.onFileDownloadClick,w=e.copyLink,T=e.downloadAttachment,P=xe("HeroMultiEntityFileTile",752,o,b),I=P[0],N=P[1],A=null===(t=I.current)||void 0===t?void 0:t.offsetHeight,F=Ee(),D=mc(F);if(i.useEffect(function(){A&&y&&y(A)},[A]),!n)return null;var L="Small"===N,R=n.length,W=function(){return n.map(function(e,t){var n={file:e,index:t,isSmall:L,userEmail:r,userUpn:a,numberOfFiles:R,showActions:m,showConnection:!0,onFileClick:h,onFileSourceClick:p,openAttachmentInClient:g,onFolderBreadcrumbClick:v,onMalformedURLError:f,openLink:O,onFileShareClick:S,shareByEmail:x,composeEmail:C,onFileCopyLinkClick:k,onFileDownloadClick:E,copyLink:w,downloadAttachment:T};return i.createElement(lc,fc({key:"File"+t},n))})};if(l||s){var H={renderBody:W,isSmall:L,className:et(u,D.multiEntityFileBody),isDismissible:d,onDismiss:j,headingLevel:c};return i.createElement("div",{ref:I,role:"list"},i.createElement(pc,fc({},H)))}return i.createElement("div",{ref:I,role:"list"},i.createElement($i,{resultType:"File",isSmall:L,headingLevel:c},W()))};gc.displayName="HeroMultiEntityFileTile";var bc=n(295);function vc(e,t){return e.map(function(n,r){var a,i;t&&e.length+r<t.length&&t[r]&&t[r].body&&t[e.length+r]&&t[e.length+r].body&&(a=t[r].body.getUrl,i=t[e.length+r].body.url);var o,c=n.fileExtension,l=n.fileName,s=n.fileSize,u=n.accessUrl,d=n.spoUniqueId,m=n.id,h=n.modifiedBy,p=n.modifiedByDisplayName,f=n.dateModified,g=n.userRelationshipType,b=n.fileType,v=n.subject,O=n.dateCreated,y=n.dateAccessed,j=n.sender,S=n.propertyHits,x=n.author,C=n.authorEmail,k=n.attachmentId,E=n.conversationId,w=n.itemId,T=n.sharingReferenceType,P=n.itemHexId,I=n.fileSourceType,N=n.sharingReferenceUrl;if(c&&l.toLowerCase().includes(c.toLowerCase())){var A=l.toLowerCase().lastIndexOf(c.toLowerCase())-1;o=l.slice(0,A)}else o=l;return{fileExtension:c,title:o,fileSize:s,accessUrl:u,spoUniqueId:d,id:m,mappingId:Object(G.c)(n),modifiedBy:h,modifiedByDisplayName:p,dateModified:f,userRelationshipType:g,previewUrl:a,thumbnailUrl:i,fileType:b,subject:v,dateCreated:O,dateAccessed:y,sender:j,propertyHits:S,author:x,authorEmail:C,attachmentId:k,conversationId:E,itemId:w,sharingReferenceType:T,fileName:l,itemHexId:P,fileSourceType:I,sharingReferenceUrl:N}})}var Oc=function(){return(Oc=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},yc=function(e){var t=e.className,n=Object(u.useSelector)(bc.a),r=pe(n),a=Object(se.a)(),o=Object(l.c)(),c=Object(l.h)().additionalAnswerConfigs,s=a.clientActionCallbacks,d=a.logger,m=Object(l.i)(),h=Object(En.a)(n,3),p=er(),f=tr(),g=i.useMemo(function(){var e=h.filter(function(e){var t=function(e){var t=e.accessUrl,n=e.fileName,r=e.fileType;return t&&n&&r?{isValid:!0}:{isValid:!1,missingFields:(t?"":"accessUrl ")+(n?"":"fileName ")+(r?"":"fileType ")}}(e),n=t.isValid,r=t.missingFields;return!n&&Object(T.e)(d,"File entity dropped due to missing required fields",r),n});return Object(R.a)(e)?(Object(T.e)(d,"File answer dropped due to missing required fields (accessUrl / fileType / fileName)"),null):e},[JSON.stringify(h)]),b=!!(null==c?void 0:c.enableMultiEntityFileAnswer)&&Object(q.a)(n)>1,v=null==c?void 0:c.enableFileAnswerV2,O=null==c?void 0:c.enableFileAnswerV3,y=null==s?void 0:s.livePersonaCard,j=null==s?void 0:s.getCurrentClientSize,S=null==s?void 0:s.setAnswerHeight,x=null==s?void 0:s.getProfilePhotoUrl,C=null==s?void 0:s.dismissAnswer,k=null==c?void 0:c.isAnswerDismissible,E=null==c?void 0:c.answerBlockId,w=Object(l.b)(),P=zn({entities:h,domain:"File",isHero:!0,impressionEventId:b?"Hero_MultiEntity_File_Impression":"Hero_File_Impression",clickEventId:"File_Click",cardType:"Hero",isFromMainSearch:!0,groupReferenceId:E});i.useEffect(function(){var e;n&&!Object(R.a)(n)&&Object(R.a)(r)&&(null===(e=null==s?void 0:s.setAnswerBlockRendered)||void 0===e||e.call(s))},[n,r,a]);var I=co(function(e,t){var n,r;if(e&&!Object(R.a)(e)&&!t){var a=e[0],i=a.fileType,o=a.modifiedBy,c=a.propertyHits,l=a.authorEmail;return c&&Object(L.a)(c,"EmailSenderName")?null===(n=null==a?void 0:a.sender)||void 0===n?void 0:n.emailAddress.address:c&&Object(L.a)(c,"Author")?l:"Attachment"===i||"Link"===i?null===(r=null==a?void 0:a.sender)||void 0===r?void 0:r.emailAddress.address:o}}(n,b),x),N=null==s?void 0:s.openAttachmentInClient,A=null==s?void 0:s.shareByEmail,F=null==s?void 0:s.composeEmail,D=null==s?void 0:s.openLink,W=null==s?void 0:s.downloadAttachment,H=null==s?void 0:s.copyLink;if(!n||Object(R.a)(n))return Object(T.h)(d,"Unexpected Empty response received for File"),null;if(!g||Object(R.a)(g))return null;var M=function(e,t){var n;if(t)try{n=vc(e,t.responses.sort(function(e,t){return e.id.valueOf()-t.id.valueOf()}))}catch(t){n=vc(e)}else n=vc(e);return n}(g);var B={className:t,userUpn:f,userEmail:p,culture:o,clientSize:w,isDismissible:k,showActions:v,onFileClick:function(e,t){P.onEntityClick(e,t,"File",void 0,"File_Click",void 0,void 0,{EntityClickDetails:N&&D?"OpenInViewer":void 0})},onMalformedURLError:function(e){Object(T.d)(d,e)},openAttachmentInClient:N,setAnswerHeight:S,openLink:D,onFolderBreadcrumbClick:function(e,t){return P.onActionClick(e,"File_FolderBreadcrumb_Click",t,void 0,{RelatedEntityType:"EntityLocationClick"})},onDismiss:function(){k&&(null==C||C(),P.nonEntityActions.onSearchActionClick("Answer_DismissButton_Click"))},onFileShareClick:function(e,t){return P.onActionClick(e,"File_Share_Click",t)},shareByEmail:A,composeEmail:F,onFileCopyLinkClick:function(e,t){return P.onActionClick(e,"File_CopyLink_Click",t)},onFileDownloadClick:function(e,t){return P.onActionClick(e,"File_Download_Click",t)},onFileSourceClick:function(e,t,n){P.onActionClick(e,"File_Source_Click",t,void 0,Oc({},function(e){if(e)switch(e){case"Mail":return{RelatedEntityType:"EmailSource"};case"CalendarEvent":return{RelatedEntityType:"EmailCalendarSource"};case"Teams":return{RelatedEntityType:"TeamsChatSource"};default:return}}(n)))},downloadAttachment:W,copyLink:H};if(b){var z=Oc({files:M,headingLevel:m,enableFileAnswerV2:v,enableFileAnswerV3:O,getClientSizeCallback:j},B);return i.createElement(gc,Oc({},z))}var _=Oc({profilePictureUrl:I,file:M[0],livePersonaCard:y,onProfileClick:function(e){var t;if("Author"===e)t="File_Author_Profile_Click";else if("Modifier"===e)t="File_Modifier_Profile_Click";else{if("Sender"!==e)return;t="File_Sender_Profile_Click"}P.onActionClick(M[0],t,0)}},B);return i.createElement(dc,Oc({},_))},jc=n(285),Sc=n(335),xc=n(400),Cc="ConnectingFlights",kc=((Object(Me.declareString)("search-components-flight.search.flights.flights")),(Object(Me.declareString)("search-components-flight.search.flights.flight")),(Object(Me.declareString)("search-components-flight.search.flights.passengersLabel")),(Object(Me.declareStringWithPlaceholders)("search-components-flight.search.flights.layoverIn")),(Object(Me.declareString)("search-components-flight.search.flights.flightsIcon")),(Object(Me.declareString)("search-components-flight.search.flights.confirmationCode")),(Object(Me.declareString)("search-components-flight.search.flights.viewEmail")),(Object(Me.declareString)("search-components-flight.search.flights.webCheckin")),(Object(Me.declareString)("search-components-flight.search.flights.numberOfStops")),(Object(Me.declareStringWithPlaceholders)("search-components-flight.search.flights.airportDetails")),(Object(Me.declareStringWithPlaceholders)("search-components-flight.search.flights.departTimeLabel")),(Object(Me.declareStringWithPlaceholders)("search-components-flight.search.flights.arrivalTimeLabel")),(Object(Me.declareStringWithPlaceholders)("search-components-flight.search.flights.airportLabel")),(Object(Me.declareString)("search-components-flight.search.flights.upcomingFlights")),(Object(Me.declareString)("search-components-flight.search.flights.expandIcon")),(Object(Me.declareStringWithPlaceholders)("search-components-flight.search.flights.flightRoute")),(Object(Me.declareStringWithPlaceholders)("search-components-flight.search.flights.airlineNumber")),(Object(Me.declareString)("search-components-flight.search.flights.nonStop"))),Ec=(Object(Me.declareString)("search-components-flight.search.flights.stops")),wc=(Object(Me.declareStringWithPlaceholders)("search-components-flight.search.flights.flightToday")),Tc=(Object(Me.declareStringWithPlaceholders)("search-components-flight.search.flights.flightTomorrow")),Pc=(Object(Me.declareStringWithPlaceholders)("search-components-flight.search.flights.flightInDays")),Ic=(Object(Me.declareStringWithPlaceholders)("search-components-flight.search.flights.flightNextWeek")),Nc=(Object(Me.declareStringWithPlaceholders)("search-components-flight.search.flights.futureFlight")),Ac=(Object(Me.declareStringWithPlaceholders)("search-components-flight.search.flights.pastFlight")),Fc=(Object(Me.declareStringWithPlaceholders)("search-components-flight.search.flights.flightDetails")),Dc=((Object(Me.declareStringWithPlaceholders)("search-components-flight.search.flights.reservationId")),(Object(Me.declareStringWithPlaceholders)("search-components-flight.search.flights.reservationIdWithLabel"))),Lc=(Object(Me.declareStringWithPlaceholders)("search-components-flight.search.flights.genericDayAndDate")),Rc=(Object(Me.declareString)("search-components-flight.search.flights.viewReservation")),Wc=(Object(Me.declareString)("search-components-flight.search.flight.share")),Hc=(Object(Me.declareString)("search-components-flight.search.flights.checkin")),Mc=(Object(Me.declareString)("search-components-flight.search.flights.openFlightMail")),Bc=(Object(Me.declareString)("search-components-flight.search.flights.departureDetailsAriaLabel")),zc=(Object(Me.declareString)("search-components-flight.search.flights.departureDetailsAriaLabel")),_c=(Object(Me.declareStringWithPlaceholders)("search-components-flight.search.flights.departureDestinationAriaLabel")),Uc=(Object(Me.declareStringWithPlaceholders)("search-components-flight.search.flights.departureCityAriaLabel")),qc=(Object(Me.declareStringWithPlaceholders)("search-components-flight.search.flights.departureDateAriaLabel")),Vc=(Object(Me.declareStringWithPlaceholders)("search-components-flight.search.flights.arrivalDateAriaLabel")),Kc=(Object(Me.declareStringWithPlaceholders)("search-components-flight.search.flights.departureTimeAriaLabel")),Qc=(Object(Me.declareStringWithPlaceholders)("search-components-flight.search.flights.arrivalDateAriaLabel")),Yc=(Object(Me.declareString)("search-components-flight.search.flights.travelDurationDetailsAriaLabel")),Gc=(Object(Me.declareStringWithPlaceholders)("search-components-flight.search.flights.travelDurationAriaLabel")),Jc=function(e,t){return e&&t?Sc.b.getShortDurationTimeString(new Date(e),new Date(t),!1,Object(Dr.b)()):""};function $c(e,t){var n,r;if(!(n=e,r=new Date,!(new Date(n)>=r))){var a=new Date(e),i=new Date;if(Object(Eo.l)(a,i))return wc({destinationCity:t});var o=function(e,t){void 0===t&&(t=new Date),e.setHours(0,0,0,0),t.setHours(0,0,0,0);var n=e.getTime()-t.getTime();return Math.trunc(n/Lr.c)}(a,i),c=o.toString();return Object(Eo.p)(a,i)?Tc({destinationCity:t}):o<Lr.w/Lr.c?Pc({destinationCity:t,days:c}):o<2*Lr.w/Lr.c-(i.getDay()+6)%7?Ic({destinationCity:t}):Nc({destinationCity:t})}return Ac({destinationCity:t})}function Zc(e){var t=new Date(e).getTime()-(new Date).getTime(),n=Math.trunc(t/Lr.e),r=Math.trunc((t-n*Lr.e)/Lr.h);return(n>0||r>0)&&n<24}var Xc={display:"flex",flexDirection:"row",justifyContent:"space-between"},el={display:"inline-block"},tl={display:"inline-block",maxWidth:"45%",textAlign:"right"},nl={fontSize:"12px",fontWeight:"600"},rl=Object(Pe.a)(function(e,t){var n=e.palette.themeDark;return Object(Ge.s)({row:[Xc,{height:"100%",width:"100%",padding:"8px "+(t?"12px":"24px"),maxWidth:"556px"}],actionButton:{padding:"0 8px"},rightColumn:[tl,{display:"flex",fontSize:"14px",maxWidth:"100%"}],confirmation:{paddingRight:"2px",paddingTop:"2px",lineHeight:"32px",verticalAlign:"middle"},shareMail:{border:"none",background:"inherit",color:n,padding:"0 12px",selectors:{"&:hover":{color:n}}},forwardIcon:{paddingLeft:"10px"}})}),al=function(e){var t=e.actionUrl,n=e.onActionButtonClick,r=e.actionType,a=e.isSmall,o=e.onShareClick,c=e.reservationId,l=e.isCheckin,s=e.openLink,u=function(e){e.stopPropagation(),t&&(s?s(t):window.open(t,"_blank"),n())},d=Ee(),m=rl(d,a),h=m.row,p=m.actionButton,f=m.rightColumn,g=m.confirmation,b=m.shareMail,v=m.forwardIcon;return i.createElement("div",{className:h},!l&&t&&i.createElement(ai.a,{role:"link",text:r,onClick:function(e){return u(e)},className:p}),l&&t&&i.createElement(ni.a,{role:"link",text:r,onClick:function(e){return u(e)},className:p}),i.createElement("div",{className:f},!a&&i.createElement("div",{className:g},Dc({reservationId:c})),o&&i.createElement(ai.a,{className:b,onClick:function(e){e.stopPropagation(),o&&o()}},i.createElement("span",null,Wc()),i.createElement(ct.a,{className:v,iconName:"Forward"}))))},il=Object(Pe.a)(function(e){var t=e.palette,n=t.neutralPrimary,r=t.neutralSecondary;return Object(Ge.s)({header:{color:n,fontSize:"14px",fontWeight:"600",lineHeight:"24px",maxWidth:"556px",width:"100%"},row:Xc,leftColumn:[{maxWidth:"100%",width:"100%"},el],rightColumn:[tl,{float:"right"}],airlineDetails:nl,profilePhoto:{float:"left",marginRight:"8.75px"},answerTitle:[bt,{fontWeight:"600",fontSize:"14px",color:r}]})}),ol=function(){return(ol=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},cl=function(e){var t=e.arrivalAirportCity,n=e.departureTimeInUtc,r=e.firstFlight,a=e.isSmall,o=e.imageUrl,c=e.LpcWrapper,l=e.userName,s=Ee(),u=il(s),d=u.header,m=u.row,h=u.leftColumn,p=u.rightColumn,f=u.airlineDetails,g=u.profilePhoto,b=u.answerTitle,v=r.airline,O=r.airlineIata,y=r.flightNumber,j={imageUrl:yr(o)?o:void 0,size:1,hidePersonaDetails:!0,imageShouldFadeIn:!1,imageShouldStartVisible:!0,showInitialsUntilImageLoads:!0,imageInitials:Object(jr.a)(l,!1),initialsColor:Object(Sr.a)({text:l})},S=i.createElement("div",{className:g},i.createElement(xr.a,ol({},j))),x=c?i.createElement(c,null,S):S,C=$c(n,t);return i.createElement("div",{className:d,role:"heading","aria-level":3},i.createElement("div",{className:m},i.createElement("div",{className:h},x,i.createElement("div",{className:b,title:C},C,!a&&i.createElement("div",{className:p},i.createElement("div",{className:f},Fc({airline:v,airlineIata:O,flightNumber:y})))))))},ll=Object(Pe.a)(function(e,t,n,r){var a=e.palette,i=a.neutralPrimary,o=a.neutralSecondary,c=a.neutralTertiaryAlt;return Object(Ge.s)({itineraryContainer:{paddingBottom:"8px",paddingTop:"4px",margin:"0 0.8px",cursor:n?"pointer":"auto",maxWidth:"556px"},row:Xc,departIata:{paddingRight:"24px",color:i,fontSize:"21px",fontWeight:"600"},arrivalIata:{paddingLeft:"24px",color:i,fontSize:"21px",fontWeight:"600"},lineContainer:{flexGrow:"10",display:"flex",flexDirection:"row"},flightIcon:{fontSize:"14px",height:"14px",color:c,position:"relative",letterSpacing:"0px",top:"54%",transform:"translateY(-50%)"},line:{flexGrow:"10",borderTop:c+" 0.5px solid",top:"50%",position:"relative"},durationContainer:{fontSize:"12px",color:o,position:"relative",top:"50%",height:"16px",padding:"4px 2px",transform:"translateY(-50%)",textAlign:"center"},duration:{marginBottom:"2px"},stops:{fontWeight:"600",cursor:0!==t?"pointer":"inherit",color:0===t?o:i},leftColumn:[el,{maxWidth:"45%"}],rightColumn:[tl,{maxWidth:"60%"}],smallText:{color:o,fontSize:r?"12px":"14px",height:"16px",marginTop:"4px"},time:{marginTop:"4px",fontWeight:"600",fontSize:"14px"},stopData:{fontWeight:"600",textAlign:"center",fontSize:"14px",color:i},airlineDetails:[nl,{paddingBottom:"4px",color:o}],confirmation:{fontSize:"12px",paddingBottom:"4px",color:o}})}),sl=/{C}/g,ul=function(e){var t,n,r=e.firstFlight,a=e.departureAirportIata,o=e.arrivalAirportIata,c=e.departureAirportCity,l=e.arrivalAirportCity,s=e.departureTime,u=e.arrivalTime,d=e.departureTimeInUtc,m=e.arrivalTimeInUtc,h=e.stopsCount,p=e.intermediateFlights,f=e.isSmall,g=e.onClick,b=e.getDisplayTime,v=e.dateTimeFormatter,O=Ee(),y=ll(O,h,!!g,f),j=y.itineraryContainer,S=y.row,x=y.departIata,C=y.arrivalIata,k=y.flightIcon,E=y.line,w=y.lineContainer,T=y.durationContainer,P=y.duration,I=y.stops,N=y.leftColumn,A=y.rightColumn,F=y.smallText,D=y.time,L=y.stopData,R=y.airlineDetails,W=y.confirmation,H={onRenderContent:function(){return i.createElement(i.Fragment,null,Object(Y.a)(p,function(e,t){if(0!==t)return i.createElement("div",{className:L},i.createElement("strong",null,e.departureAirportIata),": ",i.createElement("span",null,Jc(p[t-1].arrivalTimeInUtc,p[t].departureTimeInUtc)))}))}},M=function(e,t,n){var r=null==v?void 0:v.formatWeekDayDate,a=null==v?void 0:v.formatUserTime,o=(r?r(t):"")||function(e){if(!e)return"";var t=Object(Dr.b)(),n=Object(xc.formatCalendarDateFromString)(t.generic,e,t),r=Object(Or.l)(new Date(e),t,"short");return Lc({weekDay:r,genericDate:n})}(t),c=(a?a(t):"")||b(t);return i.createElement(i.Fragment,null,i.createElement("div",{className:F,role:"listitem","aria-label":n?_c({cityName:e}):Uc({cityName:e})},e),i.createElement("div",{className:F,role:"listitem","aria-label":n?qc({displayDate:o}):Vc({displayDate:o})},o),i.createElement("div",{className:D,role:"listitem","aria-label":n?Kc({displayTime:c}):Qc({displayTime:c})},c))},B=r.airline,z=r.airlineIata,_=r.flightNumber,U=r.reservationId;return i.createElement("div",{className:j,role:"presentation",onClick:g,tabIndex:g?0:-1,onKeyPress:function(e){e.preventDefault(),Re(e,function(){return null==g?void 0:g()})},"aria-label":Mc()},f&&i.createElement("div",{className:S},i.createElement("div",{className:N},i.createElement("div",{className:R},Fc({airline:B,airlineIata:z,flightNumber:_}))),i.createElement("div",{className:A},i.createElement("div",{className:W},Dc({reservationId:U})))),i.createElement("div",{className:S},i.createElement("div",{className:x},a),i.createElement("div",{className:w},i.createElement(ct.a,{className:k,iconName:"AirplaneSolid"}),i.createElement("div",{className:E}),i.createElement("div",{className:T,role:"list","aria-label":Yc()},i.createElement("div",{className:P,role:"listitem","aria-label":Gc({travelDuration:(t=d,n=m,t&&n?Sc.b.getLongDurationTimeString(new Date(t),new Date(n),void 0):"")})},Jc(d,m)),i.createElement(Kt.a,{tooltipProps:H,directionalHint:Qt.a.bottomCenter,id:r.reservationId,styles:{root:{display:"inline-block"}},hidden:0===h},i.createElement("div",{className:I,role:"listitem","aria-describedby":r.reservationId,tabIndex:0===h?-1:0},dl(h)))),i.createElement("div",{className:E})),i.createElement("div",{className:C},o)),i.createElement("div",{className:S},i.createElement("div",{className:N,role:"list","aria-label":Bc()},M(c,s,!0)),i.createElement("div",{className:A,role:"list","aria-label":zc()},M(l,u,!1))))},dl=function(e){return 0===e?kc():Object(qr.a)(Ec().replace(sl,String(e)),e)},ml=function(){return(ml=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},hl=function(e){var t,n=e.intermediateFlights,r=e.scenarioType,a=e.clientSize,o=e.onCardClick,c=e.onShareClick,l=e.onWebCheckinClick,s=e.onViewReservationClick,u=e.imageUrl,d=e.userName,m=e.userEmail,h=e.getDisplayTime,p=e.livePersonaCard,f=e.dateTimeFormatter,g=e.setAnswerHeight,b=e.openLink,v=Object(K.a)(n),O=xe("HeroFlightsTile",752,a),y=O[0],j=O[1],S=null===(t=y.current)||void 0===t?void 0:t.offsetHeight;i.useEffect(function(){S&&g&&g(S)},[S]);var x=i.useMemo(function(){return tt(p,d,m)},[p,d,m]),C="Small"===j;if(!v)return null;var k=v.immutableItemIdsForMail,E=k[k.length-1],w=function(){if(E){var e=He(E);o&&o({itemId:e})}},T={body:function(e,t,n,r,a,o,c){var l=n===Cc?Object(jc.a)(t):e;if(!l)return null;var s=e.departureAirportIata,u=e.departureAirportCity,d=e.departureTime,m=e.departureTimeInUtc,h=l.arrivalAirportIata,p=l.arrivalAirportCity,f=l.arrivalTime,g=l.arrivalTimeInUtc,b=t.length-1,v={firstFlight:e,intermediateFlights:t,scenarioType:n,departureAirportIata:s,departureAirportCity:u,departureTime:d,departureTimeInUtc:m,arrivalAirportIata:h,arrivalAirportCity:p,arrivalTime:f,arrivalTimeInUtc:g,stopsCount:b,isSmall:r,getDisplayTime:a,onClick:c,dateTimeFormatter:o};return i.createElement(ul,ml({},v))}(v,n,r,C,h,f,o&&E?w:void 0),header:pl(v,n,r,C,u,d,x),footer:fl(v,C,l,s,c&&E?function(){if(E){var e=He(E);c&&c({itemId:e})}}:void 0,b),isSmall:C,styleOverrides:function(){return{cardStyles:"ms-search-maxWidth"}}};return i.createElement("div",{ref:y,role:"presentation"},i.createElement(it,ml({},T)))};function pl(e,t,n,r,a,o,c){var l=n===Cc?Object(jc.a)(t):e;if(!l)return null;var s={arrivalAirportCity:l.arrivalAirportCity,departureTimeInUtc:e.departureTimeInUtc,isSmall:r,firstFlight:e,imageUrl:a,userName:o,LpcWrapper:c};return i.createElement(cl,ml({},s))}function fl(e,t,n,r,a,o){var c=e.potentialActions;if(0===c.length)return null;var l={actionUrl:c[0].value,actionType:Zc(e.departureTimeInUtc)?Hc():Rc(),onActionButtonClick:function(){Zc(e.departureTimeInUtc)?n():r()},isSmall:t,reservationId:e.reservationId,isCheckin:Zc(e.departureTimeInUtc),onShareClick:a,openLink:o};return i.createElement(al,ml({},l))}function gl(e){return Object(C.q)(e,"Flight")}function bl(e){var t=gl(e);return t?Object(K.a)(t):void 0}var vl="Flight";var Ol=function(){return(Ol=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},yl=function(e){var t,n,r,a,o=e.className,c=Object(u.useSelector)(bl),s=er(),d=(n=Object(u.useSelector)(_n.e),r=null===(t=nr())||void 0===t?void 0:t.userData,a=Object(u.useSelector)(Kn),rr()?(null==r?void 0:r.displayName)||a:n),m=Object(l.b)(),h=Object(w.a)(),p=Object(l.a)(),f=O(),g=function(e){if(!e||Object(R.a)(e.flights))return null;var t=e.flights,n=Object(K.a)(t);return n?{firstFlight:n,intermediateFlights:t}:null}(c),b=null==g?void 0:g.firstFlight,v=pe(b),y=null==g?void 0:g.intermediateFlights,j=null==p?void 0:p.setAnswerHeight,S=null==p?void 0:p.openLink,x=co(s,null==p?void 0:p.getProfilePhotoUrl);Bn({domain:"Flight",entity:c,impressionEventId:"Hero_Flight_Impression",cardType:"Hero",isHero:!0}),i.useEffect(function(){var e;!v&&b&&(null===(e=null==p?void 0:p.setAnswerBlockRendered)||void 0===e||e.call(p))},[b,v]);var C=null==p?void 0:p.openMail,k=null==p?void 0:p.forwardMail,E=null==p?void 0:p.livePersonaCard,T=null==p?void 0:p.dateTimeFormatter;if(!c||Object(R.a)(c.flights))return null;var P=c.scenarioType;if(!b||!y)return null;var I={intermediateFlights:y,scenarioType:P,clientSize:m,onWebCheckinClick:function(){!function(e,t,n,r,a,i,o){Object(Nn.b)(e,a?"Flight_Web_CheckIn_Click_Expanded":"Flight_Web_CheckIn_Click_Collapsed",vl,n,r,i,t,o)}(h,c,"Hero",m,!0,f,!0)},onViewReservationClick:function(){!function(e,t,n,r,a,i){Object(Nn.b)(e,"Flight_View_Reservation_Click",vl,n,r,a,t,i)}(h,c,"Hero",m,f,!0)},getDisplayTime:function(e){return lo(new Date(e),!1,!0).toUpperCase()},imageUrl:x,className:o,userEmail:s,userName:d,onCardClick:C?function(e){null==C||C(e),function(e,t,n,r,a,i){Object(Nn.b)(e,"Flight_Card_Click",vl,n,r,a,t,i)}(h,c,"Hero",m,f,!0)}:void 0,onShareClick:k?function(e){null==k||k(e),function(e,t,n,r,a,i){Object(Nn.b)(e,"Flight_Share_Click",vl,n,r,a,t,i)}(h,c,"Hero",m,f,!0)}:void 0,dateTimeFormatter:T,livePersonaCard:E,setAnswerHeight:j,openLink:S};return i.createElement(hl,Ol({},I))},jl=Object(Pe.a)(function(){var e;return Object(Ge.s)({multiEntityFileHeader:[bt,{fontWeight:"600",fontSize:14}],linkContainer:{selectors:(e={},e["& .ms-search-heroTile-bodyContainer"]={padding:"0"},e)}})}),Sl=(Object(Me.declareStringWithPlaceholders)("search-components-link.search.links.linkSharedOnWeekday")),xl=(Object(Me.declareStringWithPlaceholders)("search-components-link.search.links.linkSharedToday")),Cl=(Object(Me.declareStringWithPlaceholders)("search-components-link.search.links.linkSharedYesterday")),kl=(Object(Me.declareStringWithPlaceholders)("search-components-link.search.links.linkSharedLastWeek")),El=(Object(Me.declareStringWithPlaceholders)("search-components-link.search.links.linkSharedThisMonth")),wl=(Object(Me.declareString)("search-components-link.search.links.youText")),Tl=(Object(Me.declareString)("search-components-link.search.links.sharedInTeams")),Pl=(Object(Me.declareStringWithPlaceholders)("search-components-link.search.links.sharedInEmail")),Il=(Object(Me.declareStringWithPlaceholders)("search-components-link.search.links.sharedInTeamsChat")),Nl=(Object(Me.declareStringWithPlaceholders)("search-components-link.search.links.sharedInTeamsChatWith")),Al=(Object(Me.declareString)("search-components-link.search.links.linksHeader"));function Fl(e,t,n){if(void 0===n&&(n=new Date),e&&t){var r=n.getTime(),a=new Date(e),i=r-a.getTime(),o=Math.floor(i/Lr.c),c=Object(To.a)(a,n);return Object(Eo.l)(n,a)?xl({name:t}):Object(Or.p)(a,n)?Cl({name:t}):o<n.getDay()?Sl({name:t,day:Object(wo.a)(a.getDay())}):o<Lr.w/Lr.c+n.getDay()?kl({name:t}):a.getMonth()===n.getMonth()&&a.getFullYear()===n.getFullYear()?El({name:t}):Sl({name:t,day:c})}}function Dl(e,t,n){return(null==t?void 0:t.toLowerCase())===(null==e?void 0:e.toLowerCase())||(null==n?void 0:n.toLowerCase())===(null==e?void 0:e.toLowerCase())}function Ll(e,t,n,r,a,i){var o,c,l;if(void 0===i&&(i=new Date),t&&e&&n){if(Dl(n,r,a)){if(!(c=Fl(e,wl(),i)))return;l=[c=(null===(o=c[0])||void 0===o?void 0:o.toUpperCase())+(null==c?void 0:c.substr(1))]}else{if(!(c=Fl(e,t,i)))return;l=null==c?void 0:c.split(t)}return l}}function Rl(e,t,n,r){if(e)switch(e){case"Outlook":return function(e,t){if(e){var n=Pl({title:e}),r=t?We(He(t)):void 0;return{text:n,splits:n.split(e),sourceSubject:e,sourceUrl:r}}return}(t,r);case"Teams":return function(e,t,n){var r=n?"https://teams.microsoft.com/l/chat/"+n+"/conversations":void 0;if(e){var a=Il({chat:e});return{text:a,splits:a.split(e),sourceSubject:e,sourceUrl:r}}if(t){var i=Nl({name:t});return{text:i,splits:i.split(t),sourceSubject:t,sourceUrl:r}}return{text:Tl()}}(t,n,r);default:return}}var Wl=Object(Pe.a)(function(){return Object(Ge.s)({header:{marginLeft:"5px",fontWeight:"400",fontSize:14},headerContent:{fontSize:14,lineHeight:"24px",verticalAlign:"middle",display:"flex",flexDirection:"row",overflow:"hidden"},senderFullName:{fontWeight:"600"},profilePhoto:{float:"left"},connectionText:[bt,{fontWeight:"400",fontSize:14,paddingLeft:"8.75px"}]})}),Hl=function(e){var t=e.link,n=e.profilePictureUrl,r=e.userEmail,o=e.userUpn,c=e.livePersonaCard,l=e.onProfileClick,s=t.senderName,u=t.senderAddress,d=t.lastSharedTimeUtc,m=Wl(),h=Ll(d,s,u,r,o),p=Fl(d,s),f={imageUrl:yr(n)?n:void 0,size:1,hidePersonaDetails:!0,imageShouldFadeIn:!1,imageShouldStartVisible:!0,showInitialsUntilImageLoads:!0,imageInitials:Object(jr.a)(s,!1),initialsColor:Object(Sr.a)({text:s})},g=tt(c,s,u),b=i.createElement("div",{className:m.profilePhoto,role:"button",onClick:l},i.createElement(xr.a,Object(a.__assign)({},f))),v=g?i.createElement(g,null,b):b,O=i.createElement("span",{className:m.senderFullName,role:"button",onClick:l},s),y=g?i.createElement(g,null,O):O;return h?i.createElement("div",{className:m.headerContent},v,i.createElement("div",{className:m.connectionText,title:p,role:"presentation","aria-label":p},h[0],!Dl(u,r,o)&&i.createElement("span",{className:m.senderFullName},y),h[1])):null},Ml=Object(Pe.a)(function(e,t,n){var r=e.palette,a=r.neutralDark,i=r.neutralPrimary,o=r.neutralSecondary,c=r.neutralLight,l=r.blue;return Object(Ge.s)({linkEntity:{margin:"0 1px",height:t?"auto":"33px",marginTop:"8px",borderBottom:n?"none":"1px solid",display:"flex",borderColor:c,selectors:{"&:hover":{cursor:"pointer"}}},linkIcon:[xn,{float:"left",color:i,width:"40px",height:"100%",marginTop:t?"0":"-4px"}],linkInfoContainer:{width:"calc(100% - 40px)",height:"100%",float:"left",display:"flex",paddingBottom:t?n?"12px":"8px":"0",flexDirection:t?"column":"row"},titleText:[bt,{fontSize:"14px",lineHeight:"20px"},{color:l,display:"inline-block",height:"20px",width:t?"100%":"240px",marginRight:t?"0":"25px",selectors:{"&:hover":{textDecoration:"underline",color:l}}}],teaser:[bt,{fontWeight:"400",fontSize:14,height:"20px",float:"left",color:o}],sourceInfo:[bt,{color:a,fontWeight:"400",fontSize:14,height:"20px",display:"flex",marginRight:t?"0":"16px"}],sourceLink:[bt,{color:a,textDecoration:"none",selectors:{":hover":{textDecoration:"underline"}}}],tertiaryInfo:[bt,{fontWeight:"400",fontSize:14,height:"20px",color:o,float:"left"}]})}),Bl=function(e){var t=e.link,n=e.isSmall,r=e.showConnection,a=e.index,o=e.numberOfLinks,c=e.userEmail,l=e.userUpn,s=e.onLinkClick,u=e.onLinkSourceClick,d=e.openLink,m=t.url,h=t.title,p=t.subject,f=t.safeUrl,g=t.senderName,b=t.description,v=t.senderAddress,O=t.messageThreadId,y=t.lastSharedTimeUtc,j=t.sharingReferenceType,S=Ee(),x=Ml(S,n,a===o-1);function C(e,t,n,r){e.stopPropagation(),d&&r?d(r):window.open(r,"_blank","top=50,left=50,width=1000,height=600"),"Teams"===n?u(t,a,n):"Outlook"===n&&u(t,a,n)}var k=Ll(y,g,v,c,l),E=k&&Dl(v,c,l)?k[0]:Fl(y,g),w=Rl(j,p,g,O),T=null==w?void 0:w.text,P=null==w?void 0:w.splits,I=null==w?void 0:w.sourceSubject,N=null==w?void 0:w.sourceUrl,A=P?i.createElement(i.Fragment,null,P[0],i.createElement("div",{className:x.sourceLink,onClick:function(e){return C(e,t,j,N)},onKeyPress:function(e){return C(e,t,j,N)},tabIndex:0,role:"link"},I),P[1]):T,F=f||m;function D(){d?d(F):window.open(F,"_blank"),s(t,a)}return i.createElement("div",{onClick:D,onKeyPress:D,tabIndex:0,className:x.linkEntity,role:"listitem","aria-posinset":a+1,"aria-setsize":o},i.createElement(ct.a,{className:x.linkIcon,iconName:"Link"}),i.createElement("div",{className:x.linkInfoContainer},i.createElement("div",{className:x.titleText,title:m},h||m),A&&i.createElement("div",{className:x.sourceInfo,title:T},A),b&&!r&&(!h||!A)&&i.createElement("div",{className:x.teaser,title:b},b),r&&E&&i.createElement("div",{className:x.tertiaryInfo,title:E},E)))},zl=function(e){var t,n=e.links,r=e.profilePictureUrl,o=e.clientSize,c=e.userEmail,l=e.userUpn,s=e.headingLevel,u=e.livePersonaCard,d=e.onLinkClick,m=e.onLinkSourceClick,h=e.setAnswerHeight,p=e.openLink,f=e.onProfileClick,g=Object(a.__read)(xe("HeroLinkTile",752,o),2),b=g[0],v="Small"===g[1],O=null===(t=b.current)||void 0===t?void 0:t.offsetHeight;i.useEffect(function(){O&&h&&h(O)},[O]);var y=jl(),j={link:n[0],profilePictureUrl:r,userEmail:c,userUpn:l,livePersonaCard:u,onProfileClick:function(){return null==f?void 0:f(n[0])}},S=n.length>1;var x=S;var C={body:i.createElement("div",{role:"list"},n.map(function(e,t){var r={link:e,isSmall:v,showConnection:x,index:t,userEmail:c,userUpn:l,numberOfLinks:n.length,onLinkClick:d,onLinkSourceClick:m,openLink:p};return i.createElement(Bl,Object(a.__assign)({key:"link"+t},r))})),header:S?i.createElement("div",{className:y.multiEntityFileHeader,role:"heading","aria-level":s},Al()):i.createElement(Hl,Object(a.__assign)({},j)),isSmall:v};return i.createElement("div",{className:y.linkContainer,ref:b},i.createElement(it,Object(a.__assign)({},C)))};zl.displayName="HeroLinkTile";var _l=n(296);var Ul=3,ql=function(e){var t=e.className,n=Object(u.useSelector)(_l.a),r=Object(se.a)(),o=Object(l.b)(),c=Object(w.a)(),s=er(),d=tr(),m=r.clientActionCallbacks,h=null==m?void 0:m.setAnswerHeight,p=null==m?void 0:m.openLink,f=null==m?void 0:m.getProfilePhotoUrl,g=co(function(e){return null==e?void 0:e.senderAddress}(n&&n[0]),f),b=function(e,t){if(!e||Object(R.a)(e))return Object(T.h)(t,"Unexpected Empty response received for Link"),[];var n=e.filter(function(e){var n=function(e){return!!e.url}(e);return!n&&Object(T.e)(t,"Link entity dropped due to missing required fields (url)"),n});return Object(R.a)(n)&&Object(T.e)(t,"Link answer dropped due to missing required fields (url)"),Object(En.a)(n,Ul)}(n,c),v=(null==b?void 0:b.length)>1,O=zn({entities:b,domain:"Link",isHero:!0,impressionEventId:v?"Hero_MultiEntity_Link_Impression":"Hero_Link_Impression",cardType:"Hero",clickEventId:"Link_Answer_Click"});if(i.useEffect(function(){var e;Object(R.a)(b)||null===(e=null==m?void 0:m.setAnswerBlockRendered)||void 0===e||e.call(m)},[b]),Object(R.a)(b))return null;var y=null==m?void 0:m.livePersonaCard,j={className:t,links:b,clientSize:o,userEmail:s,userUpn:d,profilePictureUrl:g,onProfileClick:function(e){O.onEntityClick(e,0,void 0,void 0,"Link_Sender_Profile_Click")},livePersonaCard:y,onLinkClick:function(e,t){O.onEntityClick(e,t)},onLinkSourceClick:function(e,t,n){O.onEntityClick(e,t,void 0,n,"Link_MailSource_Click")},setAnswerHeight:h,openLink:p};return i.createElement(zl,Object(a.__assign)({},j))},Vl="Person";var Kl=n(7);n(343),n(344),n(184),n(224);n(348);n(249),(Object(Me.declareString)("search-components-class.search.class.classes")),(Object(Me.declareString)("search-components-class.search.class.classesLowercase")),(Object(Me.declareString)("search-components-class.search.class.myClasses")),(Object(Me.declareString)("search-components-class.search.class.myClass")),(Object(Me.declareString)("search-components-class.search.class.classesUppercase")),(Object(Me.declareString)("search-components-class.search.shared.ClassesTitleWithCount1")),(Object(Me.declareStringWithPlaceholders)("search-components-class.search.shared.classesTitleWithCount")),(Object(Me.declareString)("search-components-class.search.classes.classPrivacyMessage")),(Object(Me.declareString)("search-components-class.search.classes.teamsImageAltText")),n(163),n(280),(Object(Me.declareString)("search-components.search.punctuation.comma"));n(375);(Object(Me.declareString)("search-answer-person.search.person.overview")),(Object(Me.declareString)("search-answer-person.search.person.overviewLowercase")),(Object(Me.declareString)("search-answer-person.search.person.aboutUppercase")),(Object(Me.declareString)("search-answer-person.search.person.seeMoreOrg")),(Object(Me.declareString)("search-answer-person.search.person.seeMoreGroup")),(Object(Me.declareString)("search-answer-person.search.person.seeMoreFile")),(Object(Me.declareString)("search-answer-person.search.person.reportTo")),(Object(Me.declareString)("search-answer-person.search.person.recentFile")),(Object(Me.declareString)("search-answer-person.search.person.organization")),(Object(Me.declareString)("search-answer-person.search.person.organizationUppercase")),(Object(Me.declareString)("search-answer-person.search.person.organizationLowercase")),(Object(Me.declareString)("search-answer-person.search.person.eduClasses")),(Object(Me.declareString)("search-answer-person.search.person.office")),(Object(Me.declareString)("search-answer-person.search.person.officeLowercase")),(Object(Me.declareStringWithPlaceholders)("search-answer-person.search.person.personOrganization")),(Object(Me.declareStringWithPlaceholders)("search-answer-person.search.person.personFiles")),(Object(Me.declareStringWithPlaceholders)("search-answer-person.search.person.personGroups")),(Object(Me.declareStringWithPlaceholders)("search-answer-person.search.person.personOffice")),(Object(Me.declareStringWithPlaceholders)("search-answer-person.search.person.personCalendar")),(Object(Me.declareStringWithPlaceholders)("search-answer-person.search.person.personClasses")),(Object(Me.declareString)("search-answer-person.search.person.personCalendarIntent")),(Object(Me.declareString)("search-answer-person.search.person.personFilesIntent")),(Object(Me.declareString)("search-answer-person.search.person.personGroupsIntent")),(Object(Me.declareString)("search-answer-person.search.personPersonOfficeIntent")),(Object(Me.declareString)("search-answer-person.search.person.personOrganizationIntent")),(Object(Me.declareString)("search-answer-person.search.person.personClassesIntent"));var Ql=n(3),Yl=n(47),Gl=function(e){var t,n,r=null==e?void 0:e.Source;return{id:function(e){if(!e)return Object(Xe.a)();var t=e.indexOf("@");return e.substring(0,-1!==t?t:e.length)}(null==e?void 0:e.Id),fullName:(null==r?void 0:r.DisplayName)||"",firstName:(null==r?void 0:r.GivenName)||"",lastName:(null==r?void 0:r.Surname)||"",email:(null===(t=null==r?void 0:r.EmailAddresses)||void 0===t?void 0:t[0])||"",userPrincipalName:(null==r?void 0:r.UserPrincipalName)||"",alias:function(e){if(!e)return;var t=e.replace("sip:",""),n=t.indexOf("@");return t.substring(0,-1!==n?n:t.length)}(null==r?void 0:r.ImAddress)||"",department:null==r?void 0:r.Department,jobTitle:null==r?void 0:r.JobTitle,officeLocation:null==r?void 0:r.OfficeLocation,phoneNumbers:null===(n=null==r?void 0:r.Phones)||void 0===n?void 0:n.map(function(e){return e.Number}),mappingId:null==e?void 0:e.ReferenceId}};var Jl=function(e,t,n,r){return new(n||(n=Promise))(function(a,i){function o(e){try{l(r.next(e))}catch(e){i(e)}}function c(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,c)}l((r=r.apply(e,t||[])).next())})},$l=function(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}};function Zl(e,t){return{key:(e||"")+"_"+t}}var Xl=Object(Yl.a)("SubstrateSearchPersons",function(e,t){var n;return Jl(this,void 0,void 0,function(){return $l(this,function(r){switch(r.label){case 0:return[4,e.makeQueryRequest(function(e){var t,n,r,a,i,o=null===(a=null===(r=null===(n=null===(t=null==e?void 0:e.parsedBody)||void 0===t?void 0:t.EntitySets)||void 0===n?void 0:n[0])||void 0===r?void 0:r.ResultSets)||void 0===a?void 0:a[0],c=(null==o?void 0:o.Total)||0,l=null==o?void 0:o.Results,s=(null===(i=null==e?void 0:e.parsedBody)||void 0===i?void 0:i.Instrumentation.TraceId)||"";return{results:Object(Y.a)(l,function(e){return Gl(e)}),totalEstimatedMatches:c,debug:{traceId:s}}},t.request,null===(n=t.flights)||void 0===n?void 0:n.toString())];case 1:return[2,r.sent()]}})})},!0),es=Object(Ql.c)("SubstrateSearchPersonsStore",Xl),ts=n(9);var ns=Object(ts.a)("PersonClasses",function(e,t){return Jl(this,void 0,void 0,function(){var n;return $l(this,function(r){switch(r.label){case 0:return n=e.createRequestUrl("search/classes"),[4,e.makeRequest(n,"POST",t)];case 1:return[2,r.sent()]}})})});Object(Ql.c)("PersonClassesDataStore",ns);var rs=Object(ts.a)("PersonFiles",function(e,t){return Jl(this,void 0,void 0,function(){var n;return $l(this,function(r){return n=e.createRequestUrl("search/documents/personal"),[2,e.makeRequest(n,"POST",t)]})})});Object(Ql.c)("PersonFilesDataStore",rs);n(502);var as=n(327),is=n(293),os=n(110);function cs(e){return{key:e.userId+(e.isPeersRequest?"-peers":"")}}var ls=Object(ts.a)("OrgChart",function(e,t){return Jl(this,void 0,void 0,function(){var n;return $l(this,function(r){switch(r.label){case 0:return n=e.createRequestUrl("browse/person/org/chart"),[4,e.makeRequest(n,"POST",t)];case 1:return[2,r.sent()]}})})}),ss=Object(Ql.c)("OrgChartDataStore",ls),us=Object(as.a)("OrgChart",is.a,{debounce:Object(os.a)()});Object(Ql.c)("LokiOrgChartDataStore",us);var ds=function(){return(ds=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function ms(e,t,n,r,a){void 0===n&&(n=Kl.a);var i=bs(e,n,r,a),o=null==i?void 0:i.results;return t?Object(W.a)(o,function(t){return!function(e,t){return ps(e)===t}(e,t.id)}):o}function hs(e,t,n){if(!Object(M.g)(e,"Person")){var r=function(e){var t=vs(e);return null==t?void 0:t.results}(e),a=ms(e,void 0,t,void 0,n),i=Object(ie.c)(e),o="Person"===Object(g.h)(e),c=i?function(e,t,n){var r=Object(p.a)(e,function(e){return e.userPrincipalName===n||e.id===n});r||(r=Object(p.a)(t,function(e){return e.userPrincipalName===n||e.id===n}));r||(r=Object(K.a)(e));return r}(r,a,i):o?void 0:Object(K.a)(r);if(c){var l=function(e,t){var n=ss.getSelectors(e).getLatestSuccess(cs({userId:t}));return n&&Object(p.a)(n.reportingChain,function(e){return e.id===t})}(e,c.id);if(l)return gs(c,l)}return c}}function ps(e){var t=hs(e);return t&&t.id}function fs(e){var t=Object(g.a)(e,"Person"),n=Object(S.r)(e);return"PersonOrgChart"===t&&n||"PersonEduClasses"===t&&!n?"None":t}var gs=Object(Pe.a)(function(e,t){var n=t.aggregatedOrgStructure,r=t.orgStructure,a=t.customAggregatedAttributes,i=t.customAttributes;return ds(ds({},e),{aggregatedOrgStructure:n,orgStructure:r,customAggregatedAttributes:a,customAttributes:i})});function bs(e,t,n,r){return void 0===t&&(t=Kl.a),!1!==r?vs(e):function(e,t,n){void 0===t&&(t=Kl.a);var r=void 0===n?Os(e):n;return es.getSelectors(e).getLatestSuccess(Zl(r,t))}(e,t,n)}function vs(e){return{results:Object(M.b)(e,"Person")}}function Os(e){return Object(g.f)(e,"Person")}var ys=Object(Pe.a)(function(e){var t,n=e.palette,r=n.white,a=n.neutralLight;return Object(Ge.s)({profilePhoto:{float:"left",height:"40px",margin:"0 12px 0 16px",width:"40px"},personInfoContainer:{paddingRight:"16px",maxWidth:"calc(100% - 68px)"},emailIcon:{fontSize:18,marginTop:"5px",marginRight:"8px"},messageIcon:{fontSize:18,marginTop:"5px",marginRight:"8px",paddingTop:"2px"},personName:[bt,{fontSize:"14px",lineHeight:"20px"},{height:"20px",fontWeight:"600",paddingRight:"15px"}],viewEmailText:[bt,{fontSize:"14px",lineHeight:"20px"},{height:"20px",marginTop:"4px",paddingRight:"15px"}],viewMessageText:[bt,{fontSize:"14px",lineHeight:"20px"},{height:"20px",marginTop:"4px",paddingRight:"15px"}],email:[bt,{fontSize:"14px",lineHeight:"20px"},{height:"20px",paddingRight:"15px"}],personContainer:{height:"40px",display:"flex",padding:"9px 0 11px 0",backgroundColor:r,width:"100%",borderBottom:"1px solid",borderColor:a},tileBodyOverride:["ms-search-tile-body"],tile:[{selectors:(t={},t["& .ms-search-tile-body"]={margin:"0",padding:"0"},t)}],actionContainer:{paddingLeft:"10px",height:"30px",display:"flex",cursor:"pointer",float:"left"},actionChatContainer:{paddingLeft:"10px",height:"30px",display:"flex",cursor:"pointer"}})}),js=(Object(Me.declareStringWithPlaceholders)("search-components-person.search.person.viewEmailsFrom")),Ss=(Object(Me.declareString)("search-components-person.search.person.viewEmails")),xs=(Object(Me.declareString)("search-components-person.search.person.viewMessages")),Cs=function(){return(Cs=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},ks="Mail",Es="Chat",ws=function(e){var t,n=e.person,r=e.profilePictureUrl,a=e.clientSize,o=e.startPersonSearchRequery,c=e.openLink,l=e.logPersonClick,s=e.logPersonProfileClick,u=e.logPersonChatClick,d=e.livePersonaCard,m=e.setAnswerHeight,h=e.isTeamsChatFeatureEnabled,p=n.fullName,f=n.email,g=n.nicknames,b=Ee(),v=xe("HeroLinkTile",752,a),O=v[0],y="Small"===v[1],j=null===(t=O.current)||void 0===t?void 0:t.offsetHeight;i.useEffect(function(){j&&m&&m(j)},[j]);var S=yr(r),x=ys(b),C=x.personContainer,k=x.actionChatContainer,E=x.actionContainer,w=x.profilePhoto,T=x.personInfoContainer,P=x.personName,I=x.viewEmailText,N={imageUrl:S?r:void 0,size:3,hidePersonaDetails:!0,imageShouldFadeIn:!1,imageShouldStartVisible:!0,showInitialsUntilImageLoads:!0,imageInitials:Object(jr.a)(p,!1),initialsColor:Object(Sr.a)({text:p})};function A(){u(n,0);var e="https://teams.microsoft.com/l/search/from:"+p+"?tab=Messages";c?c(e):window.open(e,"_blank")}function F(){l(n,0),o(f,p)}var D=function(e){F&&Re(e,F)},L=function(e){A&&Re(e,A)},W=tt(d,p,f),H=i.createElement("div",{className:w,role:"button",onClick:function(){return s(n)},onKeyPress:function(){return s(n)}},i.createElement(xr.a,Cs({},N))),M=W?i.createElement(W,null,H):H,B=i.createElement("span",{role:"button",onClick:function(){return s(n)},onKeyPress:function(){return s(n)}},p),z=W?i.createElement(W,null,B):B,_=g&&!Object(R.a)(g)&&g[0]?g[0]:p,U=xs(),q=h?Ss():js({name:_});var V={body:function(){var e;return i.createElement("div",null,i.createElement("div",{className:C},M,i.createElement("div",{className:T},i.createElement("div",{className:P},z),i.createElement("div",{className:x.email,title:f},f))),i.createElement("div",{role:"Button",tabIndex:0,className:E,onClick:F,onKeyPress:D},i.createElement(ct.a,{iconName:ks,className:x.emailIcon}),i.createElement("div",{className:I,title:q},q)),h&&(null===(e=null==n?void 0:n.inferences)||void 0===e?void 0:e.HasReceivedMessagesFrom)&&i.createElement("div",{role:"Button",tabIndex:0,className:k,onClick:A,onKeyPress:L},i.createElement(ct.a,{iconName:Es,className:x.messageIcon}),i.createElement("div",{className:x.viewMessageText,title:U},U)))}(),isSmall:y,styleOverrides:function(){return{bodyStyles:x.tileBodyOverride,cardStyles:x.tile}}};return i.createElement("div",{ref:O},i.createElement(it,Cs({},V)))};ws.displayName="HeroPersonTile";var Ts=function(){return(Ts=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Ps=function(e){var t=e.className,n=e.person,r=e.index,a=e.clientSize,o=e.startPersonSearchRequery,c=e.openLink,l=e.logPersonClick,s=e.logPersonProfileClick,u=e.logPersonChatClick,d=e.livePersonaCard,m=e.setAnswerHeight,h=e.getProfilePhotoUrlFromClient,p=e.isTeamsChatFeatureEnabled;Bn({domain:"Person",entity:n,impressionEventId:"Hero_Person_Impression",cardType:"Hero",isHero:!0,queryIntent:e.intent});var f={className:t,person:n,openLink:c,profilePictureUrl:co(null==n?void 0:n.email,h),index:r,clientSize:a,startPersonSearchRequery:o,logPersonClick:l,logPersonProfileClick:s,logPersonChatClick:u,livePersonaCard:d,setAnswerHeight:m,isTeamsChatFeatureEnabled:p};return i.createElement(ws,Ts({},f))},Is=function(){return(Is=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},Ns=function(e){var t=e.className,n=Object(u.useSelector)(ms),r=Object(u.useSelector)(fs),a=Object(w.a)(),o=Object(l.b)(),c=O(),s="Hero",d=Object(l.a)(),m=null==d?void 0:d.livePersonaCard,h=null==d?void 0:d.startPersonSearchRequery,p=null==d?void 0:d.openLink,f=null==d?void 0:d.getProfilePhotoUrl,g=null==d?void 0:d.setAnswerHeight,b=Object(l.h)().additionalAnswerConfigs,v=null==b?void 0:b.isTeamsChatFeatureEnabled;if(i.useEffect(function(){var e;!Object(R.a)(n)&&h&&(null===(e=null==d?void 0:d.setAnswerBlockRendered)||void 0===e||e.call(d))},[]),!n||Object(R.a)(n))return Object(T.h)(a,"Unexpected Empty response received for People"),null;if(!h)return Object(T.b)(a,"startPersonSearchRequery callback undefined"),null;var y={person:n[0],className:t,index:-1,clientSize:o,startPersonSearchRequery:h,openLink:p,logPersonClick:function(e,t){!function(e,t,n,r,a,i,o){Object(Nn.d)(e,r,a,"Person_Entity_Click",Vl,t,i,n,void 0,void 0,o)}(a,e,t,s,o,c,!0)},setAnswerHeight:g,logPersonProfileClick:function(e){!function(e,t,n,r,a){Object(Nn.b)(e,"Person_SeeProfile_Click",Vl,t,n,a,r,!0)}(a,s,o,e,c)},logPersonChatClick:function(e,t){!function(e,t,n,r,a,i,o){Object(Nn.d)(e,r,a,"Person_SeeTeamsChat_Click",Vl,t,i,n,void 0,void 0,o)}(a,e,t,s,o,c,!0)},livePersonaCard:m,getProfilePhotoUrlFromClient:f,isTeamsChatFeatureEnabled:v,intent:r};return i.createElement("div",null,i.createElement(Ps,Is({},y)))};Ns.displayName="HeroPersonTileContainer";var As=function(e){var t=e.domain,n=e.className,r=Object(l.h)().additionalAnswerConfigs;switch(t){case"Bookmark":return(null==r?void 0:r.bookmarkTriggerControl)?null:i.createElement(vr,{className:n});case"Calendar":return(null==r?void 0:r.calendarTriggerControl)?null:i.createElement(ko,{className:n});case"Flight":return(null==r?void 0:r.flightTriggerControl)?null:i.createElement(yl,{className:n});case"File":return(null==r?void 0:r.fileTriggerControl)?null:i.createElement(yc,{className:n});case"Link":return(null==r?void 0:r.linkTriggerControl)?null:i.createElement(ql,{className:n});case"Acronym":return(null==r?void 0:r.acronymTriggerControl)?null:i.createElement(lr,{className:n});case"Person":return(null==r?void 0:r.personTriggerControl)?null:i.createElement(Ns,{className:n});case"TuringQnA":case"MeetingRoomProposal":case"Qna":case"FloorPlan":case"Building":case"Group":case"Calendar":case"FileEntity":case"Conversation":case"Message":case"Site":case"PowerBi":case"CalendarAvailability":case"Notification":case"Turing":case"Topic":case"Connectors":case"External":case"FederatedSearchDomain":case"EmployeeOffer":case"SharePoint":case"EducationAssignment":case"EducationClass":case"QueryReformulation":return null;default:return Object(s.a)(t)}},Fs=Object(u.connect)(function(e){return{topHeroDomain:Object(M.c)(e),shouldShowHeroCard:Object(M.i)(e),rankedConversationProvenances:k(e)}})(function(e){var t=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return B(n,t),n.prototype.render=function(){var t=this.getShownDomains(),n=z({shownDomains:t},this.props);return i.createElement(e,z({},n))},n.prototype.getShownDomains=function(){var e=this.filterConflictedDomains();return this.getEnabledAsyncDomains().forEach(function(t){Object(D.a)(e,function(e){return t===e})||e.push(t)}),Object(L.a)(e,"Turing")||e.push("Turing"),this.sortDomains(e)},n.prototype.getEnabledAsyncDomains=function(){var e=this.props,t=e.domainsFilter,n=e.areConnectorsEnabled,r=e.variantEnabledAsyncDomains,a=Object(R.a)(t)?r:Object(W.a)(r,function(e){return Object(D.a)(t,function(t){return e===Object(H.b)(t)})});return n&&a.push("Connectors"),a},n.prototype.sortDomains=function(e){var t=this.props.heroDomain;return Object(j.a)(e,function(e){return e===t||"External"===t&&"Connectors"===e?-1:Object(F.d)(e)?1:0})},n.prototype.filterConflictedDomains=function(){var e=this.props,t=e.allResultDomains,n=e.heroDomain;return Object(W.a)(t,function(e){return"Calendar"===e?"Calendar"===n:"Person"!==e||"Calendar"!==n})||[]},n}(i.Component);return Object(u.connect)(_)(t)}(function(e){var t,n=e.topHeroDomain,a=e.shouldShowHeroCard,c=e.shownDomains,d=e.rankedConversationProvenances,m=e.entityOverride,h=e.query,p=Object(l.d)()&&m?Object(Oe.j)(m):n,f=Object(w.a)(),b=Object(l.f)(),v=Object(u.useSelector)(C.v),y=Object(l.h)(),j=Object(u.useSelector)(g.g),S=O(),x=y.externalLinkDefaultTarget;return function(e){var t=this,n=Object(u.useDispatch)(),r=Object(se.a)(),a=r.searchOptions,o=pe(e),c=Object(u.useSelector)(g.g),l=Object(u.useSelector)(C.y),s=a.useSubstrateUnifiedSearch,d=a.getVerticalConfig,m=a.isTuringMarkerEnabled,h=function(){return fe(t,void 0,void 0,function(){var i,o,c;return ge(this,function(l){switch(l.label){case 0:return e?s?[4,Object(ue.a)(d)]:[3,3]:[3,5];case 1:return i=l.sent(),o=Object(ue.b)(i,!0),c=Object(he.c)(e,a,void 0,void 0,o),[4,n(Object(de.c)(r,c,o,m))];case 2:return l.sent(),[3,5];case 3:return c=Object(he.b)(e,a),[4,n(Object(de.b)(r,c))];case 4:l.sent(),l.label=5;case 5:return[4,fe(t,void 0,void 0,function(){return ge(this,function(t){switch(t.label){case 0:return[4,n(Object(me.h)({query:e}))];case 1:return t.sent(),[2]}})})];case 6:return l.sent(),[2]}})})};i.useEffect(function(){e!==o&&e!==c&&!l&&de.b&&de.c&&h()},[e,o,c,l,h,a])}(h),te(),t=le(void 0),i.useEffect(function(){return window.addEventListener("beforeunload",t),function(){t(),window.removeEventListener("beforeunload",t)}},[]),i.useEffect(function(){Object(r.a)(c)||Object(be.d)(f,c,d)},[f,c,d]),i.useEffect(function(){p&&ve(f,p)},[f,p]),i.useEffect(function(){if(v&&p&&!function(e,t){if(!t)return!1;switch(e){case"Bookmark":return!!t.bookmarkTriggerControl;case"Calendar":return!!t.calendarTriggerControl;case"Flight":return!!t.flightTriggerControl;case"File":return!!t.fileTriggerControl;case"Link":return!!t.linkTriggerControl;case"Acronym":return!!t.acronymTriggerControl;case"Person":return!!t.personTriggerControl;case"TuringQnA":case"MeetingRoomProposal":case"Qna":case"FloorPlan":case"Building":case"Group":case"Calendar":case"FileEntity":case"Conversation":case"Message":case"Site":case"PowerBi":case"CalendarAvailability":case"Notification":case"Turing":case"Topic":case"Connectors":case"External":case"FederatedSearchDomain":case"EmployeeOffer":case"SharePoint":case"EducationAssignment":case"EducationClass":case"QueryReformulation":return!1;default:return Object(s.a)(e)}}(p,y.additionalAnswerConfigs)){var e=new Date;h!==j&&Object(T.c)(f,"Rendering previous experience for new query",b&&(e.getTime()-b.getTime()).toString()),b&&(!function(e,t,n,r,a){if(n&&r){var i=a&&Object($.b)(a),o={name:"PageLoadTime",value:(r.getTime()-n.getTime()).toString(),eventScope:i};Object(G.B)(e,{eventId:t,properties:o})}}(f,"FullPageLoadTime",b,e,p),Object(J.e)({logger:f,domain:p,impressionEventId:"Answer_Impression",traceId:S,startTime:b,endTime:e}))}},[b,f,v,p]),p?i.createElement(A,{codeLocation:"HeroCardRouterContainer.Owa."+p},i.createElement(o.Provider,{value:x},a&&i.createElement(As,{domain:p}))):null}))}}]);