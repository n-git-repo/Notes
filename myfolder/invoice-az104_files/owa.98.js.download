self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.98.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[98],{3104:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"e",(function(){return s})),n.d(t,"d",(function(){return l}));var r=n(2);const o=Object(r.action)("ON_FLUID_FILE_INSERTED",(e,t)=>({containerId:e,url:t})),i=Object(r.action)("ON_FLUID_FILE_INSERTION_START",(e,t,n)=>({containerId:e,owaSource:t,viewStateId:n})),a=Object(r.action)("ON_FLUID_FILE_CREATION_FAILED",(e,t,n)=>({containerId:e,owaSource:t,viewStateId:n})),s=Object(r.action)("ON_FLUID_PLACEHOLDER_CREATED",(e,t,n)=>({containerId:e,owaSource:t,viewStateId:n})),l=Object(r.action)("ON_FLUID_FILE_LOAD_FAILURE",(e,t,n)=>({owaSource:e,error:t,viewStateId:n}))},3239:function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return c}));const r=new(n(20).c)(()=>n.e(2130).then(n.t.bind(null,4408,7)));let o=null;async function i(){if(!o){const e=await r.import();o=e.default}return o}const a="span",s="unmark",l="mark",c=9},3240:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return l})),n.d(t,"f",(function(){return c}));var r=n(2);const o=Object(r.action)("tryProcessOneDriveLink",(e,t,n,r)=>({element:e,itemId:t,allElements:n,fromQuotedBody:r})),i=Object(r.action)("tryUndoProcessOneDriveLink",e=>({elements:e})),a=Object(r.action)("TRY_MANAGE_ONE_DRIVE_LINKS_STATE",e=>({itemId:e})),s=Object(r.action)("previewLinkInSxS",(e,t,n,r)=>({wacUrlGetter:e,itemId:t,targetWindow:n,selectionSource:r})),l=Object(r.action)("PREVIEW_BEAUTIFUL_LINK_IMAGE_IN_SXS_FROM_READING_PANE",(e,t,n,r)=>({linkId:e,readOnly:t,window:n,parentItemId:r})),c=Object(r.action)("VERIFY_LINK_DATA",(e,t,n,r)=>({linksContainerId:e,linkSharingInformation:t,allElements:n,fromQuotedBody:r}))},3757:function(e,t,n){"use strict";var r=n(1),o=n(929),i=n(5776),a=n(0);let s=class extends a.Component{constructor(){super(...arguments),this.executedContentHandlers=[],this.onMouseUp=e=>{if(this.props.mouseUpHandlerList)for(let t of this.props.mouseUpHandlerList)t.onMouseUp(e,this.htmlContentRef)},this.onContextMenu=e=>{if(this.props.mouseUpHandlerList)for(let t of this.props.mouseUpHandlerList)t.onContextMenu&&t.onContextMenu(e)}}execute(){this.updateRemovedHandlersIfNecessary(),this.props.contentHandlerKeys.forEach(e=>{let t=this.props.contentHandlerDictionary[e];if(!t)return;let n=!(!this.props.isUndoModeDictionary||!this.props.isUndoModeDictionary[e]),r=this.getExecutedContentHandlerIndex(e);if(r<0){let r=null;n||(r=this.handleContent(t),t.undoHandler||(r=null));let o={key:e,isUndoMode:n,matchedElements:r,undoHandler:t.undoHandler};this.executedContentHandlers.push(o)}else{let e=this.executedContentHandlers[r];if(e.isUndoMode!=n){if(n)this.undoHandleContent(e),e.matchedElements=null;else{let n=this.handleContent(t);e.matchedElements=n}e.isUndoMode=n}}})}getExecutedContentHandlerIndex(e){for(let t=0;t<this.executedContentHandlers.length;t++)if(this.executedContentHandlers[t].key==e)return t;return-1}handleContent(e){let t=[];if(e.cssSelector){let n=this.htmlContentRef.querySelectorAll(e.cssSelector);for(let r=0;r<n.length;r++){let o=n.item(r);e.handler&&(e.needsAllElements?e.handler(o,"",void 0,n,this.props.fromQuotedBody):e.handler(o)),t.push(o)}}if(e.keywords){const n=n=>(r,o)=>{e.handler&&e.handler(r,n,o),t.push(r)};Object(i.a)(this.htmlContentRef,e.keywords,n,e.useRegExp,e.markAccuracy||"prefix")}if(e.ranges){const n=n=>(n,r)=>{e.handler&&e.handler(n,n.textContent,r),t.push(n)};Object(i.b)(this.htmlContentRef,e.ranges,n,e.markAccuracy||"prefix")}return e.doneHandlingMatchedElements&&e.doneHandlingMatchedElements(t,this.htmlContentRef),t}undoHandleContent(e){e.undoHandler&&e.matchedElements&&0!=e.matchedElements.length&&e.undoHandler(e.matchedElements)}updateRemovedHandlersIfNecessary(){for(let e=this.executedContentHandlers.length-1;e>=0;e--){let t=this.executedContentHandlers[e];this.props.contentHandlerKeys.indexOf(t.key)<0&&(this.undoHandleContent(t),this.executedContentHandlers.splice(e,1))}}componentDidMount(){this.execute(),this.htmlContentRef.addEventListener("contextmenu",this.onContextMenu),this.htmlContentRef.addEventListener("mouseup",this.onMouseUp)}componentDidUpdate(){this.execute()}componentWillUnmount(){this.htmlContentRef.removeEventListener("contextmenu",this.onContextMenu),this.htmlContentRef.removeEventListener("mouseup",this.onMouseUp),this.executedContentHandlers.forEach(e=>{this.undoHandleContent(e)})}UNSAFE_componentWillReceiveProps(e){this.props.html!=e.html&&(this.executedContentHandlers.forEach(e=>{this.undoHandleContent(e)}),this.executedContentHandlers=[])}render(){return a.createElement("div",{ref:e=>this.htmlContentRef=e,dangerouslySetInnerHTML:{__html:this.props.html}})}};s=Object(r.__decorate)([o.observer],s);var l=s,c=n(220),d=n(168),u=n(1210);const h="min-scale",m=1,f=40;function p(e,t,n,r,o){let i=e.offsetWidth;if(t>0&&i>0){let a,s=(t-=C(e))/i;e.parentElement&&e.parentElement.className.indexOf(r)>=0&&(a=e.parentElement),s<m?(e.style.transform="scale("+s+", "+s+")",e.style.transformOrigin=n(e)?"top right":"top left",e.setAttribute(h,s.toString()),a||(a=v(e)),a.style.height=Math.max(function(e,t){let n=e.offsetHeight;return Math.ceil(n*t)+function(e){let t=window.getComputedStyle(e,null),n=parseInt(t.marginTop)||0,r=parseInt(t.marginBottom)||0;return n+r}(e)}(e,s),f)+"px"):e.scrollWidth>t&&null==a&&(a=v(e)),a&&o&&o(a,e,s)}}function g(e,t){let n=null;for(;e;){if(e.className==t){n=e;break}e=e.parentElement}return n}function b(e,t,n){e.getAttribute(h)&&(e.style.transform="",e.style.transformOrigin="",e.removeAttribute(h));let r=e.parentElement;r.className.indexOf(t)>=0&&(!function(e){let t=e.parentNode,n=t.parentNode;n.insertBefore(e,t),n.removeChild(t)}(e),n&&n(r))}function v(e){let t=document.createElement("div");return e.parentNode.insertBefore(t,e),t.appendChild(e),t}function C(e){let t=window.getComputedStyle(e,null),n=parseInt(t.marginLeft)||0,r=parseInt(t.marginRight)||0;return n=Math.max(n,0),r=Math.max(r,0),n+r}const y="wideContentHandler",E="table",L="img";class I{constructor(e,t,n,r,o,i,a,s){this.wideContentHostClassName=e,this.scaleElementContainerClassName=t,this.scaleElementsInterval=n,this.isRTL=r,this.onScaleElement=o,this.onUndoScaleElement=i,this.onAllElementsFinallyScaled=a,this.traceError=s,this.cssSelector=E,this.keywords=null,this.imagesInTables=[],this.tablesToProcess=[],this.availableWidth=0,this.undoHandler=e=>{this.handlingContentTimer&&clearTimeout(this.handlingContentTimer),this.scaleElementIntervalId&&clearInterval(this.scaleElementIntervalId),this.imagesInTables.forEach(e=>{e.removeEventListener("load",this.onImageComplete),e.removeEventListener("error",this.onImageComplete)}),function(e,t,n,r){for(let n=e.length-1;n>=0;n--){let r=e[n].parentElement;r&&r.className.indexOf(t)<0&&e.splice(n,1)}if(e.length>0){let o=g(e[0],n);if(o){let n=!0,i=o.querySelectorAll(`.${t}`);for(let o=0;o<i.length;o++){let a=i[o].children[0];e.indexOf(a)>=0?b(a,t,r):n=!1}n&&function(e){e.style.width="",e.style.paddingRight="0"}(o)}else e.forEach(e=>{b(e,t,r)})}}(e,this.scaleElementContainerClassName,this.wideContentHostClassName,this.onUndoScaleElement)},this.doneHandlingMatchedElements=(e,t)=>{e.length>0?(this.handlingContentTimer&&clearTimeout(this.handlingContentTimer),this.handlingContentTimer=setTimeout(()=>{this.handlingContentTimer=null,this.tablesToProcess=e,this.availableWidth=t?t.clientWidth:0,this.filterMatchedDescendants(e,E),this.imagesInTables=this.getImagesInTables(e),this.imagesInTables.forEach(e=>{e.addEventListener("load",this.onImageComplete),e.addEventListener("error",this.onImageComplete)}),this.scaleElementIntervalId&&clearInterval(this.scaleElementIntervalId),this.scaleElementIntervalId=setInterval(()=>{this.checkImageStatus(!0)},this.scaleElementsInterval),this.checkImageStatus(!0)},0)):this.onAllElementsFinallyScaled()},this.processImages=e=>{try{e||(e=(new Date).getTime());let t=this.imagesInTables.length;for(let e=0;e<this.imagesInTables.length;e++){let n=this.imagesInTables[e];n&&n.src&&(n.getAttribute(u.b)||!n.complete)||t--}0==t||(new Date).getTime()-e>=2e3?this.processTables():window.requestAnimationFrame(()=>{this.processImages(e)})}catch(e){this.traceError("Error processing images in wideContentHandler: "+e)}},this.processTables=()=>{for(let e=0;e<this.tablesToProcess.length;e++)p(this.tablesToProcess[e],this.availableWidth,this.isRTL,this.scaleElementContainerClassName,this.onScaleElement)},this.filterMatchedDescendants=(e,t)=>{let n=0;for(;e.length>0&&n<e.length;){let r=e[n].querySelectorAll(t);for(let t=0;t<r.length;t++){let o=e.indexOf(r[t]);o>=0&&(e.splice(o,1),o<n&&n--)}n++}},this.getImagesInTables=e=>{let t=[];for(let n=0;n<e.length;n++){let r=e[n].querySelectorAll(L);for(let e=0;e<r.length;e++)t.push(r[e])}return t},this.onImageComplete=()=>{setTimeout(()=>{this.checkImageStatus(!1)},0)},this.checkImageStatus=e=>{try{let t=this.imagesInTables.length;for(let e=0;e<this.imagesInTables.length;e++){let n=this.imagesInTables[e];n&&n.src&&(n.getAttribute(u.b)||!n.complete)||t--}0===t?(this.processTables(),this.scaleElementIntervalId&&clearInterval(this.scaleElementIntervalId),this.onAllElementsFinallyScaled()):e&&this.processTables()}catch(e){this.traceError("Error checkImageStatus in wideContentHandler: "+e)}}}}var w=n(52),x=n(3148),O=n(2873),S=n(1461),A=n(4094);const k=`img[${u.a}],img[${u.c}]`,H="inlineImageHandler";class M{constructor(e,t,n,r){this.loadContext="",this.usePlaceHolder=!1,this.userIdentity="",this.delayRevoke=!1,this.cssSelector=k,this.keywords=null,this.handler=(e,t)=>{A.f.import().then(t=>t(e,this.loadContext,this.usePlaceHolder,this.userIdentity,this.delayRevoke))},this.undoHandler=e=>{this.delayRevoke&&e.forEach(e=>{var t;const n=e;0===(null===(t=n.src)||void 0===t?void 0:t.indexOf("blob:"))&&URL.revokeObjectURL(n.src)})},e&&(this.loadContext=e),t&&(this.usePlaceHolder=t),n&&(this.userIdentity=n),r&&(this.delayRevoke=r)}}var j=n(5513);const T="externalImageHandler";var U={cssSelector:"td[background][data-imageproxyendpoint], tr[background][data-imageproxyendpoint], table[background][data-imageproxyendpoint]",keywords:null,handler:async function(e){const t=await Object(j.a)(e);t&&(Object(A.a)()?e.setAttribute("background",t):e.setAttribute("background",""))},undoHandler:function(e){}},R=n(68);const N="click",_="a[href^='#']",F="href",D="[name^='",P="']",B="fragmentIdentifierHandler";class Z{constructor(){this.cssSelector=_,this.keywords=null,this.handler=(e,t)=>{let n=e.getAttribute(F);n=n.substr(1);let r=document.getElementById(n);if(!r)try{r=document.querySelector(D+n+P)}catch(e){}Object(R.p)("FragmentIdentifierProcessed",[null!=r]);const o=e=>{e.preventDefault(),Object(R.p)("FragmentIdentifierClicked",[null!=r]),r&&r.scrollIntoView()};e.addEventListener(N,o),this.boundElements.push({element:e,handler:o})},this.undoHandler=e=>{this.boundElements.forEach(e=>e.element.removeEventListener(N,e.handler)),this.boundElements=[]},this.boundElements=[]}}var W=n(20);const z=new W.c(()=>Promise.all([n.e(27),n.e(878)]).then(n.bind(null,19494))),K=new W.b(z,e=>e.createLinkPreview),$=new W.b(z,e=>e.rehydrateLinkPreview),V=new W.c(()=>Promise.all([n.e(27),n.e(939)]).then(n.bind(null,20188))),X=new W.a(V,e=>e.addInteractiveElementsForReadingPane);var q=n(22);const Q="linkPreviewHandler",Y="LPNoLP",G="OWAAM",J="a",ee="div";var te={cssSelector:"a,[id^=LPBorder]",keywords:null,handler:function(e){e.tagName.toLowerCase()===ee&&$.import().then(t=>{t(e).then(e=>{e&&X.importAndExecute(e)})})},doneHandlingMatchedElements:function(e){try{let t=[];e.forEach(e=>{e.tagName.toLowerCase()!==J||e.id&&(0===e.id.indexOf(Y)||0===e.id.indexOf(G))||function(e){let t=!1;for(;e;){if(e.id.indexOf("Signature")>=0){t=!0;break}e=e.parentElement}return t}(e)||t.push(e)}),1===t.length&&t.forEach(e=>{(function(e){return e.text.indexOf(e.hostname)>=0})(e)&&K.import().then(t=>{t(e,!1).then(t=>{t&&(e.insertAdjacentElement("afterend",t.border),X.importAndExecute(t))})})})}catch(e){q.h.warn("doneHandlingMatchedElements: Exception occured: "+e.message)}}};const ne="patchEmojiFontsHandler",re="font",oe="face",ie="font-family",ae="serif",se="EmojiFont",le=/[\u0023-\u0039][\u20e3]|[\ud800-\udbff][\udc00-\udfff]|[\u00a9-\u00ae]|[\u2122-\u3299]/;var ce={cssSelector:"div,span,font",keywords:null,handler:function(e){let t=e.style.fontFamily;if(t&&-1==t.indexOf(se)){let n=`${t}, ${ae}, ${se}`;e.tagName.toLowerCase()==re?e[oe]=n:e.style[ie]=n}}},de=n(5807),ue=n(6),he={WCScaledOrTruncated:{name:"WCScaledOrTruncated",customData:e=>[me(e)]},WCScaleContainerHovered:{name:"WCScaleContainerHovered"},WCScaleUp:{name:"WCScaleUp",customData:e=>[me(e)]}};function me(e){return e<0?-1:e<1?Math.floor(10*e)/10:1}var fe=n(6038),pe=n(21),ge=n(1444),be=n(199),ve=n(6039),Ce=n.n(ve);const ye=Object(pe.a)((function(e){return a.createElement(ge.a,{className:Ce.a.scaleControl,title:Object(ue.b)(fe.a),ariaLabel:Object(ue.b)(fe.a),onFocus:e=>{e.stopPropagation(),function(e){e.style.opacity="1",e.style.zIndex="1"}(e.currentTarget.parentElement)},onBlur:e=>{e.stopPropagation(),function(e){e.style.opacity="0",e.style.zIndex="-1"}(e.currentTarget.parentElement)},onClick:()=>{e.onScaleUp()},iconProps:{iconName:"FullScreen"}})}));const Ee="wide-content-host";var Le=a.forwardRef((function({children:e},t){return a.createElement("div",{className:Ee,ref:t},e)})),Ie=n(4977),we=n.n(Ie);const xe="has-hovered",Oe="mouseover";function Se(e,t,n){Object(R.p)(he.WCScaledOrTruncated.name,he.WCScaledOrTruncated.customData(n)),e.className.indexOf(we.a.container)<0&&(e.className=we.a.container,e.addEventListener(Oe,ke),function(e,t){let n=document.createElement("div");n.className=we.a.scaleControlContainer;const r=Array.prototype.slice.call(e.childNodes);for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(n),r.forEach(t=>e.appendChild(t)),function(e,t){be.render(a.createElement(a.StrictMode,null,a.createElement(ye,{onScaleUp:t})),e)}(n,Me(e,t))}(e,t))}function Ae(e){e.removeEventListener(Oe,ke),e.getAttribute(xe)&&(Object(R.p)(he.WCScaleContainerHovered.name),e.removeAttribute(xe)),He(e)}function ke(e){let t=e.currentTarget;t.removeEventListener(Oe,ke),t.setAttribute(xe,"true")}function He(e){let t=e.querySelectorAll(`.${we.a.scaleControlContainer}`);if(t.length>0){let n=t[0];!function(e){be.unmountComponentAtNode(e)}(n),e.removeChild(n)}}let Me=(e,t)=>()=>{let n=g(t,Ee);if(n){let e=0,r=n.querySelectorAll(`.${we.a.container}`);for(let n=0;n<r.length;n++){let o=r[n];He(o);let i=o.children[0],a=je(o,i,i==t);e=Math.max(e,a)}!function(e,t,n){let r=e.offsetWidth+n;e.style.width=r+"px",e.style.paddingRight="20px",function(e,t){e.scrollIntoView();let n=t;for(;n;){if(n.scrollWidth>n.offsetWidth&&"auto"==window.getComputedStyle(n,null).overflowX){n.scrollLeft=0;break}n=n.parentElement}}(t,e)}(n,t,e)}else je(e,t,!0),e.style.overflow="visible",He(e)};function je(e,t,n){let r,o=e.offsetWidth,i=m;return t.getAttribute(h)?(i=parseFloat(t.getAttribute(h)),t.style.transform="scale("+m+", "+m+")",e.style.height="",r=t.offsetWidth):r=t.scrollWidth,n&&Object(R.p)(he.WCScaleUp.name,he.WCScaleUp.customData(i)),r+=C(t),Math.max(r-o,0)}function Te(e){q.d(e)}var Ue=n(6042);const Re="safeLinkHandler",Ne="originalsrc",_e="shash",Fe="data-auth",De="Verified";var Pe={cssSelector:"a",keywords:null,handler:function(e){e.hasAttribute(Ne)&&e.hasAttribute(_e)&&e.hasAttribute(Fe)&&(e.title="",e.getAttribute(Fe)===De&&(e.title=Object(ue.c)(Object(w.r)()?Object(ue.b)(Ue.b):Object(ue.b)(Ue.a),e.getAttribute(Ne))))}},Be=n(4348),Ze=n(25);const We="oneDriveLinkHandler",ze="a";function Ke(e){return async(t,n,r,o,i)=>{(await Be.e.import())(t,e,o,i)}}function $e(e){const t=Be.f.tryImportForRender();t&&t(e)}function Ve(e){return async(t,n)=>{if((Object(Ze.k)("doc-deprecateCloudy-preview")||Object(Ze.k)("doc-deprecateCloudy-preview-thumbnailView"))&&0===t.length){(await Be.d.import())(e)}}}var Xe=n(5),qe=n(3466),Qe=n(3802),Ye=n(3855);const Ge="fluidHandler",Je="a",et="originalsrc";class tt{constructor(e,t,n,r,o,i,a){this.cssSelector=Je,this.keywords=null,this.storeElements=[],this.onComponentLoadedInIframe=null,this.handler=e=>{const t=e.hasAttribute(et)?e.getAttribute(et):e.href;Object(O.d)(e,t)||e.textContent.trim()&&this.getStartTime(this.owaSource).then(n=>{Qe.h.import().then(r=>{Object(qe.d)(8,this.owaSource);const o=r(t);o&&(o.headers={isSharingLinkToRedeem:!0},Qe.e.import().then(r=>{var i;if(Object(qe.d)(10,this.owaSource),r&&(null==e?void 0:e.ownerDocument)){const a=e.ownerDocument.createElement("div");a.dataset.fluidContainer="true",e.insertAdjacentElement("afterend",a);const s=new R.b("FluidReadComponent"),l=null===(i=this.getCustomMenuItems)||void 0===i?void 0:i.call(this);this.storeElements.push(a),Object(qe.d)(11,this.owaSource),r(a,o,n,s,this.owaSource,e,t,this.controlNode,l,this.addRecipientFunc,this.autoFocus).then(e=>{var t;null===(t=this.onComponentLoadedInIframe)||void 0===t||t.call(this,e),Object(qe.d)(12,this.owaSource)}).catch(t=>{this.cleanupAfterFailure(e,a,t)})}}))})})},this.cleanupAfterFailure=(e,t,n)=>{var r;document.body.contains(e)&&Object(Ye.g)(this.owaSource,n,this.viewStateId),t.insertAdjacentElement("beforebegin",e),null===(r=t.parentNode)||void 0===r||r.removeChild(t)},this.undoHandler=e=>{this.storeElements.forEach((t,n)=>{var r;e[n]&&t&&t.insertAdjacentElement("beforebegin",e[n]),null===(r=t.parentNode)||void 0===r||r.removeChild(t),be.unmountComponentAtNode(t)}),this.storeElements=[]},this.storeElements=[],this.owaSource=e,this.onComponentLoadedInIframe=t,this.controlNode=n,this.getCustomMenuItems=r,this.viewStateId=o,this.addRecipientFunc=i,this.autoFocus=a}async getStartTime(e){const t=await qe.c.importAndExecute();return 6!==e&&3!==e&&2!==e||!t?Object(Xe.nc)():t}}function nt(e,t,n,r,o,i,a){return Object(qe.d)(13,e),new tt(e,t,n,r,o,i,a)}var rt=n(6043),ot=n.n(rt),it=n(77),at=n.n(it);const st="MesageBody";class lt extends a.Component{constructor(e){super(e),this.contentHandlerDictionary={},this.mouseUpHandlerList=[],this.setHtmlContentRef=e=>{this.htmlContentRef=e},this.onResize=()=>{if(this.htmlContentRef&&!this.resizeTimer){this.toggleIsUndoModeForKey(y);const e=this;this.resizeTimer=setTimeout((function(){e.resizeTimer=null,e.toggleIsUndoModeForKey(y)}),200)}},this.onCopy=e=>{this.props.copyAllowed?this.props.onCopy&&this.props.onCopy(e):e.preventDefault()};let t={};t[y]=!1,this.state=this.mergeContentHandlers(e,t),this.initMouseUpHandlers()}mergeContentHandlers(e,t){let{item:n,externalContentHandlerDictionary:r,externalContentHandlerKeys:o,externalIsUndoModeDictionary:i,overrideFluidHandler:a,fluidSource:s}=e,l={[B]:new Z,[de.b]:de.c},u=[B,de.b];var h;h=this.props.messageBody,le.test(h)&&(l[ne]=ce,u.push(ne));const m=Object(w.g)();var f;m.LinkPreviewEnabled&&m.UserOptions.LinkPreviewEnabled&&(l[Q]=te,u.push(Q)),void 0!==s&&(a||Object(O.e)(s))&&(l[Ge]=nt(s),u.push(Ge)),!Object(w.t)()&&Object(c.a)()||(l[Re]=Pe,u.push(Re)),l[y]=new I(Ee,we.a.container,2e3,()=>Object(ue.h)(),Se,Ae,()=>{},Te),u.push(y),(null==n?void 0:n.HasBlockedImages)||(l[T]=U,u.push(T),l[H]=new M(st,!1),u.push(H)),l[We]=(f=n?Object.assign(Object.assign({},n.ItemId),{mailboxInfo:Object(d.d)()}):null,{needsAllElements:!0,cssSelector:ze,keywords:null,handler:Ke(f),undoHandler:$e,doneHandlingMatchedElements:Ve(f)}),u.push(We),this.contentHandlerDictionary=Object.assign(Object.assign({},l),r);let p=[...u,...o||[]];return p=p.filter((e,t)=>p.indexOf(e)===t),{contentHandlerKeys:p,internalIsUndoModeDictionary:t,externalIsUndoModeDictionary:Object.assign({},i)}}initMouseUpHandlers(){let{externalMouseUpHandlerList:e}=this.props;e&&e.forEach(e=>{this.mouseUpHandlerList.push(e)})}toggleIsUndoModeForKey(e){const t={};Object.keys(this.state.internalIsUndoModeDictionary).forEach(n=>{const r=this.state.internalIsUndoModeDictionary[n];t[n]=n!=e?r:!r}),this.setState({internalIsUndoModeDictionary:t})}componentDidMount(){x.a.importAndExecute(this.onResize)}UNSAFE_componentWillReceiveProps(e){this.setState(this.mergeContentHandlers(e,this.state.internalIsUndoModeDictionary))}componentWillUnmount(){x.c.importAndExecute(this.onResize),this.resizeTimer&&clearTimeout(this.resizeTimer)}render(){let{isLoading:e,className:t,printAllowed:n,messageBody:r}=this.props;return a.createElement(a.Fragment,null,e?a.createElement("div",{className:t},a.createElement(S.a,{className:ot.a.loadingSpinner})):a.createElement("div",{className:at()(t,"allowTextSelection",n?"":"noPrint"),onCopy:this.onCopy},a.createElement(l,{ref:this.setHtmlContentRef,html:r,contentHandlerDictionary:this.contentHandlerDictionary,contentHandlerKeys:this.state.contentHandlerKeys,isUndoModeDictionary:Object.assign(Object.assign({},this.state.internalIsUndoModeDictionary),this.state.externalIsUndoModeDictionary),mouseUpHandlerList:this.mouseUpHandlerList,fromQuotedBody:this.props.fromQuotedBody})),a.createElement("div",{className:ot.a.clearBoth}))}}const ct=new W.c(()=>n.e(1287).then(n.bind(null,20177))),dt=new W.b(ct,e=>e.createConfettiAnimation);var ut=n(5808),ht=n(6045),mt=n.n(ht);const ft=["happy birthday","congrats","congratulations"],pt="mouseenter";function gt(e,t){return(n,r)=>{n.classList.add(mt.a.confetti),Object(R.p)("Confetti_KeywordHighlighted",[r]),(null==e?void 0:e.Value)&&e.Value.indexOf(n.textContent)>=0&&dt.import().then(e=>{const o=e(),i=n.getBoundingClientRect();(function(e){return e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)})(i)&&t&&bt(r,n,i,o,!0);const a=e=>{setTimeout(()=>{bt(r,n,i,o,!1)},ut.c)};n.addEventListener(pt,a),n[ut.a]=a})}}function bt(e,t,n,r,o){var i;(i=t.children)&&i.length>0||(r.style.position="fixed",o||(n=t.getBoundingClientRect()),r.style.top=n.top.toString()+"px",r.style.left=n.left.toString()+"px",r.style.marginTop=(t.offsetHeight-ut.b).toString()+"px",r.style.marginLeft=(.5*(t.offsetWidth-ut.d)).toString()+"px",t.appendChild(r),Object(R.p)(o?"Confetti_TriggeredAutomatically":"Confetti_TriggeredManually",[e]))}function vt(e){e&&e.forEach(e=>{const t=e[ut.a];t&&(e.removeEventListener(pt,t),e[ut.a]=null)})}function Ct(e,t){return{cssSelector:null,keywords:ft,handler:gt(e,t),undoHandler:vt}}var yt=n(5982);const Et="#FFF100",Lt="black";function It(e){const t=Object(yt.a)(e);e.style.backgroundColor=Et,e.style.color=Lt,Object(yt.c)(e,t)}function wt(e){return{cssSelector:null,keywords:e,handler:It}}var xt=n(1198);function Ot(){return Object(xt.g)(xt.d.Confetti).confettiEnabled}n.d(t,"c",(function(){return l})),n.d(t,"f",(function(){return lt})),n.d(t,"g",(function(){return Le})),n.d(t,"i",(function(){return Ct})),n.d(t,"a",(function(){return"confettiHandler"})),n.d(t,"j",(function(){return wt})),n.d(t,"b",(function(){return"hitHighlightingHandler"})),n.d(t,"h",(function(){return nt})),n.d(t,"k",(function(){return Ot})),n.d(t,"e",(function(){return M})),n.d(t,"d",(function(){return H}))},3855:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(20),o=n(3104);n.d(t,"e",(function(){return o.b})),n.d(t,"f",(function(){return o.c})),n.d(t,"d",(function(){return o.a})),n.d(t,"h",(function(){return o.e})),n.d(t,"g",(function(){return o.d}));const i=new r.c(()=>Promise.all([n.e(23),n.e(26),n.e(29),n.e(31),n.e(41),n.e(50),n.e(57),n.e(60),n.e(87),n.e(122),n.e(170),n.e(699)]).then(n.bind(null,6488))),a=new r.b(i,e=>e.processFluidPlaceholder),s=new r.a(i,e=>e.processCollabSpaceShareLink)},4018:function(e,t,n){"use strict";function r(e,t){return e.hasAttribute(t)?e.getAttribute(t):""}n.d(t,"a",(function(){return r}))},4094:function(e,t,n){"use strict";var r=n(20),o=n(1450),i=n(4254);function a(){return 0==Object.keys(i.a.inlineImages).length}n.d(t,"c",(function(){return l})),n.d(t,"h",(function(){return c})),n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return u})),n.d(t,"g",(function(){return h})),n.d(t,"f",(function(){return m})),n.d(t,"a",(function(){return o.a})),n.d(t,"b",(function(){return a}));const s=new r.c(()=>Promise.all([n.e(0),n.e(27),n.e(771)]).then(n.bind(null,19746)));let l=new r.a(s,e=>e.clearInlineImageStore),c=new r.b(s,e=>e.tryCreateDataURIFromImage),d=(new r.b(s,e=>e.cacheInlineImage),new r.b(s,e=>e.logImageUpload),new r.b(s,e=>e.logImageLoadError),new r.b(s,e=>e.loadFromAttachmentServiceUrl)),u=new r.b(s,e=>e.loadFromAttachment),h=new r.b(s,e=>e.loadFromProxy),m=new r.b(s,e=>e.loadFromImageTag)},4106:function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"g",(function(){return c})),n.d(t,"r",(function(){return d})),n.d(t,"n",(function(){return u})),n.d(t,"m",(function(){return h})),n.d(t,"k",(function(){return m})),n.d(t,"l",(function(){return f})),n.d(t,"h",(function(){return p})),n.d(t,"p",(function(){return g})),n.d(t,"o",(function(){return b})),n.d(t,"q",(function(){return v})),n.d(t,"j",(function(){return C})),n.d(t,"i",(function(){return y}));const r="src",o="data-imagetype",i="crossorigin",a="data-itemid",s="data-inetid",l="data-imageproxyendpoint",c="use-credentials",d="AttachmentByCid",u="OnError",h="NullAttachmentUrl",m="DOMDetached",f="ImageMismatch",p="RP",g="DataUri",b="CrossDomain",v="SameDomain",C="ImageProxySkipForConsumerChild",y="ImageProxyConnectorsAuthTokenFalse"},4254:function(e,t,n){"use strict";var r=n(2);const o=Object(r.createStore)("inlineimages",{inlineImages:{}})();t.a=o},4348:function(e,t,n){"use strict";n.d(t,"e",(function(){return a})),n.d(t,"f",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return u}));var r=n(20),o=n(3240);n.d(t,"h",(function(){return o.b})),n.d(t,"g",(function(){return o.a})),n.d(t,"i",(function(){return o.f}));const i=new r.c(()=>Promise.all([n.e(292),n.e(838)]).then(n.bind(null,6844))),a=new r.b(i,e=>e.tryProcessOneDriveLink),s=new r.b(i,e=>e.tryUndoProcessOneDriveLink),l=new r.b(i,e=>e.tryManageOneDriveLinksState),c=new r.b(i,e=>e.docLinkHadPreviewInfo),d=(new r.b(i,e=>e.forceGetWacInfoOperation),new r.b(i,e=>e.getValidDocLinkPreviewInfo),new r.b(i,e=>e.forceGetValidDocLinkPreviewInfo)),u=new r.b(i,e=>e.checkSafelinkAndOpenLinkInSxS)},4977:function(e,t,n){var r=n(6041);"string"==typeof r&&(r=[[e.i,r,""]]);var o={transform:void 0};n(84)(r,o);r.locals&&(e.exports=r.locals)},5513:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(4106),o=n(3840),i=n(3),a=n(30),s=n(68),l=n(4018),c=n(1210);const d="data-connectorsauthtoken",u="u",h="i",m="d",f="ClientId";async function p(e){const t=Object(l.a)(e,c.c),n=Object(l.a)(e,r.b),p=Object(l.a)(e,d);return t&&n?Object(a.a)().IsConsumerChild?(Object(s.p)(r.j),t):"1"==p?async function(e,t){try{await Object(o.b)()}catch(e){return null}return`${e}?`+`${u}=${encodeURIComponent(t)}&`+`${m}=${encodeURIComponent((new Date).toISOString())}`}(n,t):function(e,t){const n=Object(i.v)(f);if(!n)return null;if("/actions/ei"==e.toLowerCase())return Object(s.p)(r.i),null;return`${e}?`+`${u}=${encodeURIComponent(t)}&`+`${h}=${encodeURIComponent(n)}`}(n,t):""}},5776:function(e,t,n){"use strict";var r=n(3239);function o(){return r.b+Math.random().toString(36).substr(2,r.a)}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));let i=!1;async function a(e,t,n,a,s){if(t.length||i){i=!0;const d=await Object(r.e)(),u=d.call(d,e);t.forEach(e=>{let t=0,i={element:r.c,className:o(),acrossElements:!0,separateWordSearch:!1,accuracy:s,each:r=>{l(r)||(n(e)(r,t),t++)}};if(a){let t="";for(let n=0;n<e.length;n++)c(e[n])&&(t+="\\"),t+=e[n];u.markRegExp(new RegExp(t),i)}else u.mark(e,i)}),u.unmark({className:r.d})}}async function s(e,t,n,a){if(t.length||i){i=!0;const s=await Object(r.e)(),c=s.call(s,e);t.forEach(e=>{let t=0,i={element:r.c,className:o(),acrossElements:!0,separateWordSearch:!1,accuracy:a,each:r=>{l(r)||(n(e)(r,t),t++)}};c.markRanges([e],i)}),c.unmark({className:r.d})}}function l(e){return!e.innerHTML.replace(/&nbsp;/gi,"").trim()&&(e.classList.add(r.d),!0)}function c(e){const t=e[0];return"+"==t||"\\"==t||"*"==t||"."==t||"["==t||"]"==t||"-"==t||"("==t||")"==t||"{"==t||"}"==t||"?"==t||"^"==t||"$"==t}},5807:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return m}));var r=n(0),o=n(199),i=n(30),a=n(1437),s=n(6036),l=n.n(s);const c="mentionHandler",d="a[id^=OWAAM]",u="mailto:";function h(e){const t=Object(a.a)(e);return r.createElement(t,null,r.createElement("span",null,e.children))}class m{constructor(){this.cssSelector=d,this.keywords=null,this.handler=e=>{const t=e,n=e.ownerDocument.createElement("span"),a=t.href.replace(u,""),s=Object(i.a)().SessionSettings.UserEmailAddress;s&&u+s==t.href?e.className=l.a.mentionsMeRead:e.className=l.a.mentionsRead;let c=r.createElement(h,{emailAddress:a,name:void 0,clientScenario:"AtMention"},r.createElement("span",{className:e.className},e.textContent));e.parentElement.replaceChild(n,e),o.render(c,n),this.storeElements.push({originElement:e,lpcElement:n})},this.undoHandler=e=>{this.storeElements.forEach(e=>{var t,n;const{lpcElement:r,originElement:i}=e;r&&(o.unmountComponentAtNode(r),null===(n=null===(t=r.parentNode)||void 0===t?void 0:t.replaceChild)||void 0===n||n.call(t,i,r))}),this.storeElements=[]},this.storeElements=[]}}let f=new m;t.c=f},5808:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return c}));const r=200,o=308,i=100,a="confettiEvent",s=31,l=["M18.16 0L18.16 18.16L0 18.16L0 0L18.16 0Z","M18.16 0L18.16 18.16L0 18.16L0 0L18.16 0Z","M18.16 0L18.16 18.16L0 18.16L0 0L18.16 0Z","M37.5 0C58.21 0 75 16.79 75 37.5C75 58.21 58.21 75 37.5 75C16.79 75 0 58.21 0 37.5C0 16.79 16.79 0 37.5 0Z","M37.5 0C58.21 0 75 16.79 75 37.5C75 58.21 58.21 75 37.5 75C16.79 75 0 58.21 0 37.5C0 16.79 16.79 0 37.5 0Z","M18.16 0L18.16 18.16L0 18.16L0 0L18.16 0Z","M18.16 0L18.16 18.16L0 18.16L0 0L18.16 0Z","M18.16 0L22.97 22.88L0 18.16L18.16 0Z","M18.16 0L18.16 18.16L0 18.16L0 0L18.16 0Z","M18.16 0L18.16 18.16L0 18.16L0 0L18.16 0Z","M37.5 0C58.21 0 75 16.79 75 37.5C75 58.21 58.21 75 37.5 75C16.79 75 0 58.21 0 37.5C0 16.79 16.79 0 37.5 0Z","M37.5 0C58.21 0 75 16.79 75 37.5C75 58.21 58.21 75 37.5 75C16.79 75 0 58.21 0 37.5C0 16.79 16.79 0 37.5 0Z","M18.16 0L18.16 18.16L0 18.16L0 0L18.16 0Z","M18.16 0L18.16 18.16L0 18.16L0 0L18.16 0Z","M18.16 0L22.97 22.88L0 18.16L18.16 0Z","M18.16 0L22.97 22.88L0 18.16L18.16 0Z","M18.16 0L18.16 18.16L0 18.16L0 0L18.16 0Z","M18.16 0L18.16 18.16L0 18.16L0 0L18.16 0Z","M18.16 0L18.16 18.16L0 18.16L0 0L18.16 0Z","M18.16 0L18.16 18.16L0 18.16L0 0L18.16 0Z","M18.16 0L22.97 22.88L0 18.16L18.16 0Z","M18.16 0L22.97 22.88L0 18.16L18.16 0Z","M37.5 0C58.21 0 75 16.79 75 37.5C75 58.21 58.21 75 37.5 75C16.79 75 0 58.21 0 37.5C0 16.79 16.79 0 37.5 0Z","M18.16 0L18.16 18.16L0 18.16L0 0L18.16 0Z","M18.16 0L18.16 18.16L0 18.16L0 0L18.16 0Z","M18.16 0L18.16 18.16L0 18.16L0 0L18.16 0Z","M18.16 0L22.97 22.88L0 18.16L18.16 0Z","M18.16 0L18.16 18.16L0 18.16L0 0L18.16 0Z","M18.16 0L18.16 18.16L0 18.16L0 0L18.16 0Z","M37.5 0C58.21 0 75 16.79 75 37.5C75 58.21 58.21 75 37.5 75C16.79 75 0 58.21 0 37.5C0 16.79 16.79 0 37.5 0Z","M37.5 0C58.21 0 75 16.79 75 37.5C75 58.21 58.21 75 37.5 75C16.79 75 0 58.21 0 37.5C0 16.79 16.79 0 37.5 0Z"],c="http://www.w3.org/2000/svg"},5982:function(e,t,n){"use strict";var r=n(3242);function o(e){return{attrColor:e.getAttribute(r.b)||null,attrBgColor:e.getAttribute(r.a)||null,styleColor:e.style.getPropertyValue("color"),styleBgColor:e.style.getPropertyValue("background-color")}}function i(e,t){return e.hasAttribute(t)?e.getAttribute(t)||null:void 0}function a(e){return{attrColor:i(e,r.d),attrBgColor:i(e,r.c),styleColor:i(e,r.f),styleBgColor:i(e,r.e)}}function s(e,t){void 0!==t.attrColor&&!e.hasAttribute(r.d)&&e.setAttribute(r.d,t.attrColor||""),void 0!==t.attrBgColor&&!e.hasAttribute(r.c)&&e.setAttribute(r.c,t.attrBgColor||""),void 0!==t.styleColor&&!e.hasAttribute(r.f)&&e.setAttribute(r.f,t.styleColor||""),void 0!==t.styleBgColor&&!e.hasAttribute(r.e)&&e.setAttribute(r.e,t.styleBgColor||"")}function l(e,t){void 0!==t.attrColor&&(null===t.attrColor?e.removeAttribute(r.b):e.setAttribute(r.b,t.attrColor||"")),void 0!==t.attrBgColor&&(null===t.attrBgColor?e.removeAttribute(r.a):e.setAttribute(r.a,t.attrBgColor||"")),void 0!==t.styleColor&&e.style.setProperty("color",t.styleColor||""),void 0!==t.styleBgColor&&e.style.setProperty("background-color",t.styleBgColor||"")}var c=n(109);function d(e){const t=e.currentTarget,n=t.getElementsByTagName("*"),r=Object(c.g)();r&&(t.style.backgroundColor="white",t.style.color="black");const i=[];for(let e=0;e<n.length;e++){const t=n[e],r=a(t);i.push(o(t)),l(t,r)}window.requestAnimationFrame(()=>{r&&(t.style.backgroundColor="",t.style.color="");for(let e=0;e<n.length;e++)l(n[e],i[e])})}n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return d}))},6036:function(e,t,n){var r=n(6037);"string"==typeof r&&(r=[[e.i,r,""]]);var o={transform:void 0};n(84)(r,o);r.locals&&(e.exports=r.locals)},6037:function(e,t,n){(t=e.exports=n(83)(!1)).push([e.i,"._3TsRPBAzFzXwn0TkqOckn{text-decoration:inherit}html[dir] ._3TsRPBAzFzXwn0TkqOckn{border-radius:2px;padding:0 1px;background-color:var(--neutralLighter)}html[dir] ._3TsRPBAzFzXwn0TkqOckn:hover{background-color:var(--neutralLight)}._15_bhZvx69MwW0ayhzjFhY{text-decoration:inherit;color:var(--themeDark)}html[dir] ._15_bhZvx69MwW0ayhzjFhY{border-radius:2px;padding:0 1px;background-color:var(--themeLighter)}._15_bhZvx69MwW0ayhzjFhY:hover{color:var(--themeDarker)}html[dir] ._15_bhZvx69MwW0ayhzjFhY:hover{background-color:var(--themeLight)}",""]),t.locals={mentionsRead:"_3TsRPBAzFzXwn0TkqOckn",mentionsMeRead:"_15_bhZvx69MwW0ayhzjFhY"}},6038:function(e){e.exports=JSON.parse('{"a":"K$a"}')},6039:function(e,t,n){var r=n(6040);"string"==typeof r&&(r=[[e.i,r,""]]);var o={transform:void 0};n(84)(r,o);r.locals&&(e.exports=r.locals)},6040:function(e,t,n){(t=e.exports=n(83)(!1)).push([e.i,".KBwACy35vUu44VLeJybtU{position:absolute;top:5px;color:var(--white);font-size:16px;cursor:pointer;font-family:controlIcons!important;z-index:1}html[dir] .KBwACy35vUu44VLeJybtU{padding:8px;background:var(--neutralPrimary);-webkit-box-shadow:0 0 5px var(--neutralSecondary);box-shadow:0 0 5px var(--neutralSecondary);border-radius:2px}html[dir=ltr] .KBwACy35vUu44VLeJybtU{left:5px}html[dir=rtl] .KBwACy35vUu44VLeJybtU{right:5px}",""]),t.locals={scaleControl:"KBwACy35vUu44VLeJybtU"}},6041:function(e,t,n){(t=e.exports=n(83)(!1)).push([e.i,".ugHd8hEKTmP3zNa_t33nm{position:relative;overflow:hidden}.ugHd8hEKTmP3zNa_t33nm ._3OSvA877av7sNgMphVnY6Z{opacity:0;z-index:-1;position:absolute}.ugHd8hEKTmP3zNa_t33nm:hover ._3OSvA877av7sNgMphVnY6Z{opacity:1;z-index:1}html[dir] .ugHd8hEKTmP3zNa_t33nm:hover ._3OSvA877av7sNgMphVnY6Z{background:transparent}",""]),t.locals={container:"ugHd8hEKTmP3zNa_t33nm",scaleControlContainer:"_3OSvA877av7sNgMphVnY6Z"}},6042:function(e){e.exports=JSON.parse('{"b":"I$a","a":"J$a"}')},6043:function(e,t,n){var r=n(6044);"string"==typeof r&&(r=[[e.i,r,""]]);var o={transform:void 0};n(84)(r,o);r.locals&&(e.exports=r.locals)},6044:function(e,t,n){(t=e.exports=n(83)(!1)).push([e.i,"._1SgEp1U4PIR58Iv0wG1X4P{clear:both}.OpChn0T8Xp9CMcvqkx26X{display:inline-block}",""]),t.locals={clearBoth:"_1SgEp1U4PIR58Iv0wG1X4P",loadingSpinner:"OpChn0T8Xp9CMcvqkx26X"}},6045:function(e,t,n){var r=n(6046);"string"==typeof r&&(r=[[e.i,r,""]]);var o={transform:void 0};n(84)(r,o);r.locals&&(e.exports=r.locals)},6046:function(e,t,n){(t=e.exports=n(83)(!1)).push([e.i,"._2mvHg_8QQFEuo2e0RlZLXB{text-decoration:inherit;color:var(--themeDark)}html[dir] ._2mvHg_8QQFEuo2e0RlZLXB{border-radius:2px;padding:0 1px;background-color:var(--themeLighter)}._2mvHg_8QQFEuo2e0RlZLXB:hover{color:var(--themeDarker)}html[dir] ._2mvHg_8QQFEuo2e0RlZLXB:hover{background-color:var(--themeLight)}",""]),t.locals={confetti:"_2mvHg_8QQFEuo2e0RlZLXB"}}}]);
//# sourceMappingURL=owa.98.js.map
self.scriptsLoaded['owa.98.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.98.js'] = (new Date()).getTime();