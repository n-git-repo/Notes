self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.1311.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[1311],{11793:function(e,n,i){"use strict";var a=i(595);const d={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"FolderCounts"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"folder"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}},{kind:"ObjectField",name:{kind:"Name",value:"additionalProperties"},value:{kind:"ListValue",values:[{kind:"StringValue",value:"TotalCount",block:!1},{kind:"StringValue",value:"UnreadCount",block:!1}]}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"FolderId"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"}}]}},{kind:"Field",name:{kind:"Name",value:"TotalCount"}},{kind:"Field",name:{kind:"Name",value:"UnreadCount"}}]}}]}}]};var l=i(7779);const t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"FolderCountsAndPermissions"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"folder"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}},{kind:"ObjectField",name:{kind:"Name",value:"additionalProperties"},value:{kind:"ListValue",values:[{kind:"StringValue",value:"TotalCount",block:!1},{kind:"StringValue",value:"UnreadCount",block:!1},{kind:"StringValue",value:"PermissionSet",block:!1}]}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"FolderId"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"}}]}},{kind:"Field",name:{kind:"Name",value:"TotalCount"}},{kind:"Field",name:{kind:"Name",value:"UnreadCount"}},{kind:"FragmentSpread",name:{kind:"Name",value:"MailFolderPermissionsFragment"}}]}}]}},...l.a.definitions]},o={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"FolderPermissions"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"folder"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}},{kind:"ObjectField",name:{kind:"Name",value:"additionalProperties"},value:{kind:"ListValue",values:[{kind:"StringValue",value:"PermissionSet",block:!1}]}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"FolderId"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"}}]}},{kind:"FragmentSpread",name:{kind:"Name",value:"MailFolderPermissionsFragment"}}]}}]}},...l.a.definitions]};var m=i(7567);function k(e,n){return u(e,"Permissions",n||Object(m.a)(e,!0))}async function u(e,n,i){const l=Object(a.a)();let m;switch(n){case"Counts":m=d;break;case"CountsAndPermissions":m=t;break;case"Permissions":m=o}try{return(await l.query({query:m,variables:{id:e,mailboxInfo:i}})).data.folder}catch(e){return null}}i.d(n,"b",(function(){return k})),i.d(n,"a",(function(){return u}))},20157:function(e,n,i){"use strict";i.r(n);var a=i(3652),d=i(3344),l=i(11793),t=i(2737),o=i(2858),m=i(20),k=i(22);const u=Object(m.e)(a.a,"getFolderDataClone",e=>{!function(e){const n=Object(t.m)().get(e),i="SharedMailbox"===(null==n?void 0:n.mailboxInfo.type),a=Object(o.b)(e),m=i?"CountsAndPermissions":"Counts";Object(l.a)(e,m,a).then(n=>{n&&(Object(d.a)(n.UnreadCount,n.TotalCount,e,!1),i&&t.O.import().then(i=>{i(e,n.PermissionSet.Permissions)}))}).catch(e=>{k.h.warn(`GetFolderDataOrchestrator: ${e}`)})}(e.folderId)});i.d(n,"getFolderDataOrchestrator",(function(){return u}))},7779:function(e,n,i){"use strict";i.d(n,"a",(function(){return a}));const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"MailFolderPermissionsFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MailFolderPermissions"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"PermissionSet"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Permissions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"PermissionLevel"}},{kind:"Field",name:{kind:"Name",value:"ReadItems"}},{kind:"Field",name:{kind:"Name",value:"UserId"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"PrimarySmtpAddress"}},{kind:"Field",name:{kind:"Name",value:"DisplayName"}},{kind:"Field",name:{kind:"Name",value:"DistinguishedUser"}}]}},{kind:"Field",name:{kind:"Name",value:"CanCreateItems"}},{kind:"Field",name:{kind:"Name",value:"CanCreateSubFolders"}},{kind:"Field",name:{kind:"Name",value:"IsFolderOwner"}},{kind:"Field",name:{kind:"Name",value:"IsFolderVisible"}},{kind:"Field",name:{kind:"Name",value:"IsFolderContact"}},{kind:"Field",name:{kind:"Name",value:"EditItems"}},{kind:"Field",name:{kind:"Name",value:"DeleteItems"}}]}}]}}]}}]}}}]);
//# sourceMappingURL=owa.1311.js.map
self.scriptsLoaded['owa.1311.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.1311.js'] = (new Date()).getTime();