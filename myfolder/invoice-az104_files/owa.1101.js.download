self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.1101.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[1101],{2977:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(543);function c(e){return Object(r.a)("calendarDayOfWeek_"+e)}},3283:function(e,t,n){"use strict";var r=n(6),c=n(543),a=n(5);const o=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function i(e){return o.indexOf(e)}var u=n(2977);const b=7;function O(e){let t=function(e){if(e&&0!==e.length){if(1===e.length)return e[0];if(2===e.length)return Object(r.c)(Object(c.a)("formatStringTwoItems"),e[0],e[1]);{let t=Object(r.c)(Object(c.a)("formatStringNItemsStart"),e[0],e[1]);for(let n=2;n<e.length-1;n++)t=Object(r.c)(Object(c.a)("formatStringNItemsMiddle"),t,e[n]);return t=Object(r.c)(Object(c.a)("formatStringNItemsEnd"),t,e[e.length-1]),t}}return""}(e.DaysOfWeek.split(" ").sort(l.bind(null,e.FirstDayOfWeek)).map(e=>Object(u.a)(e)));return 1===e.Interval?Object(r.c)(Object(c.a)("calendarWeekly1FormatString"),t):2===e.Interval?Object(r.c)(Object(c.a)("calendarWeekly2FormatString"),t):Object(r.c)(Object(c.a)("calendarWeeklyNFormatString"),t,e.Interval)}var s={canHandle:function(e){return!!e.DaysOfWeek&&!!e.FirstDayOfWeek&&!!e.Interval},formatRecurrence:O,formatRecurrenceOption:O,getNumberedRecurrenceEndDate:function(e,t,n){let r=function(e){let t=Array(b);return e.forEach(e=>{switch(e){case"Weekday":t[i("Monday")]=!0,t[i("Tuesday")]=!0,t[i("Wednesday")]=!0,t[i("Thursday")]=!0,t[i("Friday")]=!0;break;case"WeekendDay":t[i("Saturday")]=!0,t[i("Sunday")]=!0;break;case"Day":for(let e=0;e<t.length;e++)t[e]=!0;break;default:t[i(e)]=!0}}),t}(e.DaysOfWeek.split(" ")),c=r.reduce((e,t)=>t?e+1:e,0),o=function(e,t,n){let r=i(n),c=Object(a.ob)(e),o=0;do{t[c]&&o++,c=d(c+1,b)}while(c!==r);return o}(t,r,e.FirstDayOfWeek);if(n<=o)return f(r,t,n);{let u=n-o,b=Math.ceil(u/c),O=Object(a.k)(t,e.Interval*b);return f(r,Object(a.ec)(O,i(e.FirstDayOfWeek)),d(u,c)||c)}},formatOptionsForSummary:O};function l(e,t,n){const r={Sunday:0,Monday:1,Tuesday:2,Wednesday:3,Thursday:4,Friday:5,Saturday:6,Day:0,Weekday:0,WeekendDay:0};let c=r[e];return d(r[t]-c,7)-d(r[n]-c,7)}function d(e,t){return(e%t+t)%t}function f(e,t,n){let r=Object(a.ob)(t),c=0;for(;c<n;)e[d(r,b)]&&c++,r++;return r--,Object(a.e)(t,d(r-Object(a.ob)(t),b))}const j=7;function m(e,t,n){let r=Object(a.dc)(e),c=i(t)-Object(a.ob)(r);c<0&&(c+=j);let o=Object(a.e)(r,c);switch(n){case"First":return o;case"Second":return Object(a.k)(o,1);case"Third":return Object(a.k)(o,2);case"Fourth":return Object(a.k)(o,3);case"Last":let e=Object(a.k)(o,4);return Object(a.Mb)(r,e)||(e=Object(a.k)(o,3)),e;default:throw new Error("Invalid DayOfWeekIndexType")}}function y(e){return Object(c.a)("calendarDayOfWeekIndex_"+e)}var I={canHandle:function(e){return!!e.DaysOfWeek&&!!e.DayOfWeekIndex&&!!e.Interval},formatRecurrence:function(e){let t=Object(u.a)(e.DaysOfWeek),n=y(e.DayOfWeekIndex);return 1===e.Interval?Object(r.c)(Object(c.a)("calendarRelativeMonthly1FormatString"),n,t):2===e.Interval?Object(r.c)(Object(c.a)("calendarRelativeMonthly2FormatString"),n,t):Object(r.c)(Object(c.a)("calendarRelativeMonthlyNFormatString"),n,t,e.Interval)},formatRecurrenceOption:function(e){let t=Object(u.a)(e.DaysOfWeek),n=y(e.DayOfWeekIndex);return Object(r.c)(Object(c.a)("calendarRelativeMonthlyOptionFormatString"),n,t)},getNumberedRecurrenceEndDate:function(e,t,n){let r=m(t,e.DaysOfWeek,e.DayOfWeekIndex);return Object(a.Jb)(r,t)&&(r=m(Object(a.i)(r,1),e.DaysOfWeek,e.DayOfWeekIndex)),m(Object(a.i)(r,(n-1)*e.Interval),e.DaysOfWeek,e.DayOfWeekIndex)},formatOptionsForSummary:function(e){let t=Object(u.a)(e.DaysOfWeek),n=y(e.DayOfWeekIndex);return Object(r.c)(Object(c.a)("calendarRelativeMonthlyOptionFormatLowercaseString"),n,t)}};var g={canHandle:function(e){return!!e.DayOfMonth&&!!e.Interval},formatRecurrence:function(e){return 1===e.Interval?Object(r.c)(Object(c.a)("calendarAbsoluteMonthly1FormatString"),e.DayOfMonth):2===e.Interval?Object(r.c)(Object(c.a)("calendarAbsoluteMonthly2FormatString"),e.DayOfMonth):Object(r.c)(Object(c.a)("calendarAbsoluteMonthlyNFormatString"),e.DayOfMonth,e.Interval)},formatRecurrenceOption:function(e){return Object(r.c)(Object(c.a)("calendarAbsoluteMonthlyOptionFormatString"),e.DayOfMonth)},getNumberedRecurrenceEndDate:function(e,t,n){let r=t;return Object(a.mb)(r)!=e.DayOfMonth&&(r=Object(a.Yb)(r,e.DayOfMonth),Object(a.Jb)(r,t)&&(r=Object(a.i)(r,1))),Object(a.i)(r,(n-1)*e.Interval)},formatOptionsForSummary:function(e){return Object(r.c)(Object(c.a)("calendarAbsoluteMonthlyOptionFormatLowercaseString"),e.DayOfMonth)}};function h(e){return Object(c.a)("calendarMonth_"+e)}const R=["January","February","March","April","May","June","July","August","September","October","November","December"];function D(e){return p(Object(c.a)("calendarRelativeYearlyOptionFormatString"),e)}function p(e,t){let n=Object(u.a)(t.DaysOfWeek),c=y(t.DayOfWeekIndex),a=h(t.Month);return Object(r.c)(e,c,n,a)}var v={canHandle:function(e){return!!e.DaysOfWeek&&!!e.Month&&!!e.DayOfWeekIndex},formatRecurrence:function(e){return p(Object(c.a)("calendarRelativeYearlyFormatString"),e)},formatRecurrenceOption:D,getNumberedRecurrenceEndDate:function(e,t,n){let r=t,c=R.indexOf(e.Month);return Object(a.Ab)(r)!=c&&(r=Object(a.Zb)(r,c)),r=m(r,e.DaysOfWeek,e.DayOfWeekIndex),Object(a.Jb)(r,t)&&(r=m(Object(a.l)(r,1),e.DaysOfWeek,e.DayOfWeekIndex)),m(Object(a.l)(r,n-1),e.DaysOfWeek,e.DayOfWeekIndex)},formatOptionsForSummary:D};const M=["January","February","March","April","May","June","July","August","September","October","November","December"];function F(e){return S(Object(c.a)("calendarAbsoluteYearlyOptionFormatString"),e)}function S(e,t){let n=h(t.Month);return Object(r.c)(e,n,t.DayOfMonth)}var k={canHandle:function(e){return!!e.DayOfMonth&&!!e.Month},formatRecurrence:function(e){return S(Object(c.a)("calendarAbsoluteYearlyFormatString"),e)},formatRecurrenceOption:F,getNumberedRecurrenceEndDate:function(e,t,n){let r=t,c=M.indexOf(e.Month);return Object(a.Ab)(r)!=c&&(r=Object(a.Zb)(r,c)),Object(a.mb)(r)!=e.DayOfMonth&&(r=Object(a.Yb)(r,e.DayOfMonth)),Object(a.Jb)(r,t)&&(r=Object(a.l)(r,1)),Object(a.l)(r,n-1)},formatOptionsForSummary:F};function W(e){return 1===e.Interval?Object(c.a)("calendarDaily1Recurrence"):2===e.Interval?Object(c.a)("calendarDaily2Recurrence"):Object(r.c)(Object(c.a)("calendarDailyNRecurrence"),e.Interval)}var w={canHandle:function(e){return("DailyRecurrence:#Exchange"===e.__type||"DailyRecurrence"===e.__typename)&&!!e.Interval},formatRecurrence:W,formatRecurrenceOption:W,getNumberedRecurrenceEndDate:function(e,t,n){return Object(a.e)(t,(n-1)*e.Interval)},formatOptionsForSummary:W};n.d(t,"a",(function(){return T}));const E=[s,I,g,v,k,w];function T(e){let t;for(let n=0;n<E.length;n++)if(E[n].canHandle(e)){t=E[n];break}if(!t)throw new Error("Invalid recurrence type");return t}},5397:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(5),c=n(3283);function a({End:e,Recurrence:t},n){if(t){const{RecurrenceRange:e}=t,{EndDate:a}=e;if(a){const e=Object(r.pc)(a);return Object(r.Jb)(e,n)}const{NumberOfOccurrences:o,StartDate:i}=e;if(o){const e=Object(r.pc)(i),a=Object(c.a)(t.RecurrencePattern).getNumberedRecurrenceEndDate(t.RecurrencePattern,e,o);return Object(r.Jb)(a,n)}return!1}return Object(r.Jb)(Object(r.pc)(e),n)}},543:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return a}));n(659);let r;function c(e){if(!r)throw new Error("Localization has not yet been initialized");return r(e)}function a(e){r=e}},753:function(e,t,n){"use strict";var r=n(2);const c=Object(r.action)("initializeOwaObservableDateTime"),a=Object(r.action)("observableNowChanged"),o=Object(r.action)("observableTodayChanged");var i=n(5),u=n(13),b=Object(r.createStore)("ObservableDateTime",{now:0,today:0});const O=Object(u.computed)(()=>Object(i.pc)(b().now)),s=()=>O.get(),l=Object(u.computed)(()=>Object(i.pc)(b().today)),d=()=>l.get(),f=e=>Object(i.Jb)(e,s()),j=e=>Object(i.Hb)(e,s()),m=e=>I(e,i.Jb),y=e=>I(e,i.Kb),I=(e,t)=>t(Object(i.ac)(Object(i.pc)(e)),d());function g(e){if(!e)return"";const t=Object(i.pc)(e);return function(e,t){const n=Object(i.ac)(e);if(Object(i.Lb)(n,t))return i.ab;const r=e=>Object(i.Qb)(n,Object(i.e)(t,-e),t);if(r(3))return i.ib;if(r(30))return i.hb;return i.Y}(t,d())(t)}function h(e){if(!e)return"";const t=Object(i.pc)(e);return function(e,t){const n=Object(i.ac)(e);if(Object(i.Lb)(n,t))return i.T;return i.U}(t,d())(t)}function R(e){if(!e)return"";return function(e,t){const n=Object(i.ac)(e);return Object(i.Lb)(n,t)?Object(i.ab)(e):D(n,t,2)?Object(i.lb)(e):D(n,t,7)?Object(i.H)(Object(i.bb)(e),Object(i.ab)(e)):Object(i.H)(Object(i.J)(e),Object(i.ab)(e))}(Object(i.pc)(e),d())}function D(e,t,n){return Object(i.Qb)(e,Object(i.e)(t,-n),t)}const p=Object(r.action)("updateTimes"),v=Object(r.action)("setNow"),M=Object(r.action)("setToday",e=>({today:e}));Object(r.mutator)(v,()=>{b().now=Object(i.nc)()}),Object(r.mutator)(M,({today:e})=>{b().today=e});var F=n(24),S=n(80);let k=!1;Object(r.orchestrator)(c,()=>{if(p(),!k){const e=Object(i.Tb)(),t=Object(i.cc)(Object(i.h)(e,1)),n=Object(i.w)(t,e);setTimeout(()=>setInterval(p,F.g),n),document&&document.addEventListener("visibilitychange",p),k=!0}}),Object(r.orchestrator)(S.l,()=>{p()}),Object(r.orchestrator)(p,()=>{v();const e=Object(i.Cb)(Object(i.oc)()),t=b().today!=e;t&&M(e),a(),t&&o()}),n.d(t,"d",(function(){return c})),n.d(t,"j",(function(){return a})),n.d(t,"l",(function(){return o})),n.d(t,"i",(function(){return s})),n.d(t,"k",(function(){return d})),n.d(t,"g",(function(){return f})),n.d(t,"e",(function(){return j})),n.d(t,"f",(function(){return m})),n.d(t,"h",(function(){return y})),n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return R}))},9050:function(e,t,n){"use strict";n.r(t);var r=n(2);const c=Object(r.action)("parseGetItemResponseAction",(e,t)=>({items:e,clientItemIds:t})),a=Object(r.action)("tryPrefetchMeetingMessage",(e,t,n)=>({mailboxInfo:e,listViewType:t,shouldDelayPrefetch:n})),o=Object(r.action)("removeMeetingMessagesFromStore",e=>({itemIds:e}));var i=n(5829),u=n(68),b=n(2733),O=n(2742),s=n(9592),l=n(1087),d=n(1085),f=n(138),j=n(22),m=n(9593);const y=Object(r.mutatorAction)("updateMailStoreForRsvp",(e,t)=>{e.shouldShowRSVP=t}),I=Object(r.mutatorAction)("updateTableRelationMapForRsvp",(e,t)=>{e.shouldShowRSVP=t}),g=[Object(d.a)({FieldURI:"Start"}),Object(d.a)({FieldURI:"End"}),Object(d.a)({FieldURI:"AssociatedCalendarItemId"}),Object(d.a)({FieldURI:"RecurrenceId"}),Object(d.a)({FieldURI:"Recurrence"}),Object(d.a)({FieldURI:"ConflictingMeetings"}),Object(d.a)({FieldURI:"CalendarItemType"}),Object(d.a)({FieldURI:"IsResponseRequested"}),Object(d.a)({FieldURI:"Organizer"}),Object(d.a)({FieldURI:"ItemClass"}),Object(d.a)({FieldURI:"MeetingRequestType"}),Object(d.a)({FieldURI:"ItemParentId"}),Object(d.a)({FieldURI:"Sender"}),Object(d.a)({FieldURI:"ConversationId"}),Object(d.a)({FieldURI:"IsDelegated"}),Object(d.a)({FieldURI:"ReceivedRepresenting"}),Object(d.a)({FieldURI:"ResponseType"})];async function h(e,t,n){const r=new u.b("LoadMeetingMessage");r.addCustomProperty("count",e.length);const a=e.map(e=>e.Id);try{const t=await Object(O.e)(a,Object(l.a)({BaseShape:"IdOnly",AdditionalProperties:g}),null,null,null,null,null,null,"RSVPInListView",!0);if(!t||t instanceof Error)r.endWithError("ServerError");else{const n=e.filter(e=>t.some(t=>t.ItemId.Id===e.Id));c(t,n),r.end()}(t instanceof Error||t.length!==a.length)&&j.h.warn(`[loadingmeetingmessage] some items failed in: ${a}`)}catch(e){r.endWithError("ServerError",Error(e)),j.h.warn(`[loadingmeetingmessage] all items failed in: ${a}`)}!function(e,t){t.forEach(t=>{if(1===e){const e=O.u.items.get(t.itemId);if(!e)return;const n=Object(s.a)(t.itemId);n&&Object(m.a)(n)||y(e,!1)}else{const e=Object(b.M)(t.rowKey,t.tableViewId);if(!e)return;const n=Object(s.a)(t.itemId);n&&Object(m.a)(n)||I(e,!1)}})}(n,t)}Object(r.orchestrator)(a,e=>{const{listViewType:t,mailboxInfo:n,shouldDelayPrefetch:r}=e,c=n.mailboxSmtpAddress,a=i.b(c);if(i.c(c),!a||0===a.length)return;const o=a.map(e=>({Id:e.itemId,mailboxInfo:n}));r?Object(f.a)(()=>{h(o,a,t)}):h(o,a,t)}),Object(r.mutator)(c,e=>{const{items:t,clientItemIds:n}=e;for(let e=0;e<t.length;e++){const r=t[e],c=n[e],a=Object(b.L)().meetingMessageItems.get(c.Id);if(a){Object.keys(a).forEach(e=>{r[e]&&(a[e]=r[e])})}else{const e=Object.assign(Object.assign({},r),{MailboxInfo:c.mailboxInfo,SmartTimeData:null,SmartTimeExtendedProperty:null,smartPillFeedbackSubmitted:!1});Object(b.L)().meetingMessageItems.set(c.Id,e)}}}),Object(r.mutator)(o,e=>{const{itemIds:t}=e,n=Object(b.L)();t.forEach(e=>{n.meetingMessageItems.has(e)&&setTimeout(()=>{n.meetingMessageItems.delete(e)},1e3)})}),n.d(t,"tryPrefetchMeetingMessage",(function(){return a})),n.d(t,"removeMeetingMessagesFromStore",(function(){return o}))},9592:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2733);function c(e){const t=Object(r.L)().meetingMessageItems.get(e);if(!t)return null;const n=t;return n.Start&&n.End&&n.CalendarItemType?n:null}},9593:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3202),c=n(753),a=n(2751),o=n(5397);function i(e){const t=Object(a.a)(e.ParentFolderId.Id);if("deleteditems"===t||"sentitems"===t)return!1;if(e.IsDelegated&&e.ReceivedRepresenting)return!1;if(!e.AssociatedCalendarItemId)return!1;if(Object(r.q)(e.ItemClass)){const t=e;if("InformationalUpdate"===t.MeetingRequestType)return!1;if("NoResponseReceived"!==e.ResponseType)return!1;if(Object(o.a)(t,Object(c.i)()))return!1}return!0}}}]);
//# sourceMappingURL=owa.1101.js.map
self.scriptsLoaded['owa.1101.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.1101.js'] = (new Date()).getTime();