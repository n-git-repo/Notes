self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.169.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[169],{10217:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o}));const i=[];function r(t){i.push(t)}function o(t){return i.reduce((e,n)=>e||n(t),!1)}},10218:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o}));const i=[];function r(t){i.push(t)}function o(t){return i.reduce((e,n)=>e||n(t),!1)}},10219:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o}));const i=[];function r(t){i.push(t)}function o(t){return i.reduce((e,n)=>e||n(t),!1)}},1207:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"c",(function(){return o})),n.d(e,"d",(function(){return c})),n.d(e,"b",(function(){return a}));var i=n(2);const r=Object(i.action)("initializeOwaAccountsStore"),o=Object(i.action)("owaConnectedAccountAdded",(t,e,n)=>({userIdentity:t,accountProviderType:e,source:n})),c=Object(i.action)("removeAccount",t=>({userIdentity:t})),a=Object(i.action)("owaAccountStoreInitializationFailed",(t,e,n,i)=>({userIdentity:t,isRetry:e,accountProvider:n,error:i}))},12137:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return r})),n.d(e,"c",(function(){return a})),n.d(e,"d",(function(){return s}));var i,r,o=n(102);!function(t){t.TwoActionNotificationWithImage="TwoActionNotificationWithImage",t.ThreeActionNotificationWithImage="ThreeActionNotificationWithImage",t.ThreeActionNotificationWithDropdown="ThreeActionNotificationWithDropdown"}(i||(i={})),function(t){t.ButtonAction="ButtonAction",t.DropdownAction="DropdownAction"}(r||(r={}));class c{static ArrayOfDropdownActionValue(t){for(let e=0;e<t.length;e++)t[e]=c.DropdownActionValue(t[e]);return t}static ArrayOfNotificationCustomActionValue(t){for(let e=0;e<t.length;e++)t[e]=c.NotificationCustomActionValue(t[e]);return t}static ArrayOfStringValue(t){return t}static ArrayOfByteValue(t){return t}static NotificationDisplayTypeValue(t){return t}static ActionTypeValue(t){return t}static ButtonPropertyValue(t){return t}static NotificationActionValue(t){const e=t;return e.actionType=c.ActionTypeValue(e.actionType),e.button=c.ButtonPropertyValue(e.button),e}static ActionPropertyValue(t){const e=t;return void 0!==e.items&&(e.items=c.ArrayOfDropdownActionValue(e.items)),c.ButtonPropertyValue(t),e}static NotificationCustomActionValue(t){const e=t;return void 0!==e.action&&(e.action=c.ActionPropertyValue(e.action)),c.NotificationActionValue(t),e}static DropdownActionValue(t){return t}static NotificationContextValue(t){const e=t;return e.notificationActions=c.ArrayOfNotificationCustomActionValue(e.notificationActions),e.notificationDisplayType=c.NotificationDisplayTypeValue(e.notificationDisplayType),void 0!==e.scheduledTime&&(e.scheduledTime=new Date(e.scheduledTime)),e}static UserInteractionValue(t){return t}static RaiseNotificationParamsValue(t){const e=t;return e.context=c.NotificationContextValue(e.context),e}static HandleUserActionOnNotificationParamsValue(t){const e=t;return e.action=c.UserInteractionValue(e.action),e}}async function a(t){await o.throwIfVersionIsNotSupported("Notification",.2);const e={context:t};return o.HostBridge.invokeHost("Notification.raiseNotification",e,void 0)}function s(t){return o.HostBridge.registerForEvent("Notification.handleUserActionOnNotification",(function(e){if(e){const n=c.HandleUserActionOnNotificationParamsValue(e);t(n.action)}}))}},12138:function(t,e,n){"use strict";var i=n(2);e.a=Object(i.action)("ON_NEW_MAIL_OS_NOTIFICATION_NAVIGATED",t=>({itemId:t}))},12139:function(t,e,n){"use strict";var i,r;n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return r})),function(t){t.SnoozeButton="SnoozeButton",t.DismissButton="DismissButton",t.Click="Click",t.SnoozeDropdownOptions="SnoozeDropdownOptions"}(i||(i={})),function(t){t.SetFlagButton="SetFlagButton",t.DismissButton="DismissButton",t.ArchiveButton="ArchiveButton",t.Click="Click"}(r||(r={}))},12140:function(t,e,n){"use strict";var i;n.d(e,"a",(function(){return i})),function(t){t.NewEmail="NewEmail",t.EventReminder="EventReminder"}(i||(i={}))},1218:function(t,e,n){"use strict";var i=n(1224),r=n(2364);function o(t,e){return 55296==(64512&t.charCodeAt(e))&&(!(e<0||e+1>=t.length)&&56320==(64512&t.charCodeAt(e+1)))}function c(t){return(t>>>24|t>>>8&65280|t<<8&16711680|(255&t)<<24)>>>0}function a(t){return 1===t.length?"0"+t:t}function s(t){return 7===t.length?"0"+t:6===t.length?"00"+t:5===t.length?"000"+t:4===t.length?"0000"+t:3===t.length?"00000"+t:2===t.length?"000000"+t:1===t.length?"0000000"+t:t}e.inherits=r,e.toArray=function(t,e){if(Array.isArray(t))return t.slice();if(!t)return[];var n=[];if("string"==typeof t)if(e){if("hex"===e)for((t=t.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(t="0"+t),r=0;r<t.length;r+=2)n.push(parseInt(t[r]+t[r+1],16))}else for(var i=0,r=0;r<t.length;r++){var c=t.charCodeAt(r);c<128?n[i++]=c:c<2048?(n[i++]=c>>6|192,n[i++]=63&c|128):o(t,r)?(c=65536+((1023&c)<<10)+(1023&t.charCodeAt(++r)),n[i++]=c>>18|240,n[i++]=c>>12&63|128,n[i++]=c>>6&63|128,n[i++]=63&c|128):(n[i++]=c>>12|224,n[i++]=c>>6&63|128,n[i++]=63&c|128)}else for(r=0;r<t.length;r++)n[r]=0|t[r];return n},e.toHex=function(t){for(var e="",n=0;n<t.length;n++)e+=a(t[n].toString(16));return e},e.htonl=c,e.toHex32=function(t,e){for(var n="",i=0;i<t.length;i++){var r=t[i];"little"===e&&(r=c(r)),n+=s(r.toString(16))}return n},e.zero2=a,e.zero8=s,e.join32=function(t,e,n,r){var o=n-e;i(o%4==0);for(var c=new Array(o/4),a=0,s=e;a<c.length;a++,s+=4){var u;u="big"===r?t[s]<<24|t[s+1]<<16|t[s+2]<<8|t[s+3]:t[s+3]<<24|t[s+2]<<16|t[s+1]<<8|t[s],c[a]=u>>>0}return c},e.split32=function(t,e){for(var n=new Array(4*t.length),i=0,r=0;i<t.length;i++,r+=4){var o=t[i];"big"===e?(n[r]=o>>>24,n[r+1]=o>>>16&255,n[r+2]=o>>>8&255,n[r+3]=255&o):(n[r+3]=o>>>24,n[r+2]=o>>>16&255,n[r+1]=o>>>8&255,n[r]=255&o)}return n},e.rotr32=function(t,e){return t>>>e|t<<32-e},e.rotl32=function(t,e){return t<<e|t>>>32-e},e.sum32=function(t,e){return t+e>>>0},e.sum32_3=function(t,e,n){return t+e+n>>>0},e.sum32_4=function(t,e,n,i){return t+e+n+i>>>0},e.sum32_5=function(t,e,n,i,r){return t+e+n+i+r>>>0},e.sum64=function(t,e,n,i){var r=t[e],o=i+t[e+1]>>>0,c=(o<i?1:0)+n+r;t[e]=c>>>0,t[e+1]=o},e.sum64_hi=function(t,e,n,i){return(e+i>>>0<e?1:0)+t+n>>>0},e.sum64_lo=function(t,e,n,i){return e+i>>>0},e.sum64_4_hi=function(t,e,n,i,r,o,c,a){var s=0,u=e;return s+=(u=u+i>>>0)<e?1:0,s+=(u=u+o>>>0)<o?1:0,t+n+r+c+(s+=(u=u+a>>>0)<a?1:0)>>>0},e.sum64_4_lo=function(t,e,n,i,r,o,c,a){return e+i+o+a>>>0},e.sum64_5_hi=function(t,e,n,i,r,o,c,a,s,u){var d=0,f=e;return d+=(f=f+i>>>0)<e?1:0,d+=(f=f+o>>>0)<o?1:0,d+=(f=f+a>>>0)<a?1:0,t+n+r+c+s+(d+=(f=f+u>>>0)<u?1:0)>>>0},e.sum64_5_lo=function(t,e,n,i,r,o,c,a,s,u){return e+i+o+a+u>>>0},e.rotr64_hi=function(t,e,n){return(e<<32-n|t>>>n)>>>0},e.rotr64_lo=function(t,e,n){return(t<<32-n|e>>>n)>>>0},e.shr64_hi=function(t,e,n){return t>>>n},e.shr64_lo=function(t,e,n){return(t<<32-n|e>>>n)>>>0}},1224:function(t,e){function n(t,e){if(!t)throw new Error(e||"Assertion failed")}t.exports=n,n.equal=function(t,e,n){if(t!=e)throw new Error(n||"Assertion failed: "+t+" != "+e)}},1457:function(t,e,n){"use strict";var i;n.d(e,"a",(function(){return i})),function(t){t[t.Add=0]="Add",t[t.Init=1]="Init"}(i||(i={}))},1531:function(t,e,n){"use strict";var i=n(1218),r=n(2359),o=n(2365),c=n(1224),a=i.sum32,s=i.sum32_4,u=i.sum32_5,d=o.ch32,f=o.maj32,h=o.s0_256,l=o.s1_256,m=o.g0_256,b=o.g1_256,p=r.BlockHash,O=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function g(){if(!(this instanceof g))return new g;p.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=O,this.W=new Array(64)}i.inherits(g,p),t.exports=g,g.blockSize=512,g.outSize=256,g.hmacStrength=192,g.padLength=64,g.prototype._update=function(t,e){for(var n=this.W,i=0;i<16;i++)n[i]=t[e+i];for(;i<n.length;i++)n[i]=s(b(n[i-2]),n[i-7],m(n[i-15]),n[i-16]);var r=this.h[0],o=this.h[1],p=this.h[2],O=this.h[3],g=this.h[4],I=this.h[5],j=this.h[6],v=this.h[7];for(c(this.k.length===n.length),i=0;i<n.length;i++){var T=u(v,l(g),d(g,I,j),this.k[i],n[i]),y=a(h(r),f(r,o,p));v=j,j=I,I=g,g=a(O,T),O=p,p=o,o=r,r=a(T,y)}this.h[0]=a(this.h[0],r),this.h[1]=a(this.h[1],o),this.h[2]=a(this.h[2],p),this.h[3]=a(this.h[3],O),this.h[4]=a(this.h[4],g),this.h[5]=a(this.h[5],I),this.h[6]=a(this.h[6],j),this.h[7]=a(this.h[7],v)},g.prototype._digest=function(t){return"hex"===t?i.toHex32(this.h,"big"):i.split32(this.h,"big")}},2359:function(t,e,n){"use strict";var i=n(1218),r=n(1224);function o(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}e.BlockHash=o,o.prototype.update=function(t,e){if(t=i.toArray(t,e),this.pending?this.pending=this.pending.concat(t):this.pending=t,this.pendingTotal+=t.length,this.pending.length>=this._delta8){var n=(t=this.pending).length%this._delta8;this.pending=t.slice(t.length-n,t.length),0===this.pending.length&&(this.pending=null),t=i.join32(t,0,t.length-n,this.endian);for(var r=0;r<t.length;r+=this._delta32)this._update(t,r,r+this._delta32)}return this},o.prototype.digest=function(t){return this.update(this._pad()),r(null===this.pending),this._digest(t)},o.prototype._pad=function(){var t=this.pendingTotal,e=this._delta8,n=e-(t+this.padLength)%e,i=new Array(n+this.padLength);i[0]=128;for(var r=1;r<n;r++)i[r]=0;if(t<<=3,"big"===this.endian){for(var o=8;o<this.padLength;o++)i[r++]=0;i[r++]=0,i[r++]=0,i[r++]=0,i[r++]=0,i[r++]=t>>>24&255,i[r++]=t>>>16&255,i[r++]=t>>>8&255,i[r++]=255&t}else for(i[r++]=255&t,i[r++]=t>>>8&255,i[r++]=t>>>16&255,i[r++]=t>>>24&255,i[r++]=0,i[r++]=0,i[r++]=0,i[r++]=0,o=8;o<this.padLength;o++)i[r++]=0;return i}},2364:function(t,e){"function"==typeof Object.create?t.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(t,e){if(e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}}},2365:function(t,e,n){"use strict";var i=n(1218).rotr32;function r(t,e,n){return t&e^~t&n}function o(t,e,n){return t&e^t&n^e&n}function c(t,e,n){return t^e^n}e.ft_1=function(t,e,n,i){return 0===t?r(e,n,i):1===t||3===t?c(e,n,i):2===t?o(e,n,i):void 0},e.ch32=r,e.maj32=o,e.p32=c,e.s0_256=function(t){return i(t,2)^i(t,13)^i(t,22)},e.s1_256=function(t){return i(t,6)^i(t,11)^i(t,25)},e.g0_256=function(t){return i(t,7)^i(t,18)^t>>>3},e.g1_256=function(t){return i(t,17)^i(t,19)^t>>>10}},3976:function(t,e,n){"use strict";var i=n(2),r={newMailNotifications:[],newMailNotificationsSentToHost:new Map,likeNotifications:[],reactionNotifications:[],reminders:[],remindersHost:[],showReminders:!1,showAutomaticRepliesNotification:!0,forwardingNotice:{showForwardingNotice:!1}};e.a=Object(i.createStore)("inAppNotifications",r)},5343:function(t,e,n){"use strict";var i=n(1448),r=n(165),o="Expected a function";e.a=function(t,e,n){var c=!0,a=!0;if("function"!=typeof t)throw new TypeError(o);return Object(r.a)(n)&&(c="leading"in n?!!n.leading:c,a="trailing"in n?!!n.trailing:a),Object(i.a)(t,e,{leading:c,maxWait:e,trailing:a})}},6481:function(t,e,n){"use strict";var i=n(10217),r=n(10218),o=n(10219),c=n(9312),a=n(9313),s=n(9314),u=n(7624),d=n(12137),f=n(9829),h=n(5),l=n(9315),m=n(12138),b=n(12139),p=n(12140),O=n(22),g=n(68),I=n(2),j=n(3976),v=Object(I.mutatorAction)("REMOVE_REMINDERS_SENTTONATIVE",t=>{Object(j.a)().remindersHost=Object(j.a)().remindersHost.filter(e=>e.reminder.itemId.Id!=t)});function T(){Object(d.d)(t=>{let e=t.notificationType;switch(Object(g.p)("NativeNotificationReceivedAction"),e){case p.a.EventReminder:!function(t){let e=JSON.parse(t.itemId);switch(Object(g.p)("NativeNotificationReceivedEventReminderAction"),t.buttonId){case b.a.SnoozeButton:!function(t,e){let n=Object(h.Ub)("UTC",e.meetingTime),i=t;Object(g.p)("NativeNotificationEventReminderSnoozeAction",{snoozedTillTime:Object(h.Z)(Object(h.h)(Object(h.Tb)(),+i)),meetingStartTime:Object(h.Z)(n)}),i&&(Object(f.c)({Id:e.itemId,ChangeKey:e.changeKey},Object(h.h)(Object(h.Tb)(),+i)),v(e.itemId))}(t.selectedActionId,e);break;case b.a.DismissButton:i=e.itemId,Object(g.p)("NativeNotificationEventReminderDismissAction"),Object(f.a)({Id:i});break;case b.a.Click:n=e,Object(g.p)("NativeNotificationEventReminderClickAction"),Object(u.a)(n.itemId,n.reminderType);break;default:O.d("Got an action type for a button which was not recognised. Falling back to the default action"+t.buttonId),Object(u.a)(e.itemId,e.reminderType)}var n;var i}(t);break;case p.a.NewEmail:!function(t){let e=t.buttonId;switch(e){case b.b.DismissButton:n=t.itemId,Object(g.p)("NativeNotificationNewEmailDismissAction"),n&&Object(l.a)(n);break;case b.b.SetFlagButton:t.itemId,Object(g.p)("NativeNotificationNewEmailFlagAction");break;case b.b.Click:y(t.itemId);break;default:y(t.itemId),O.d("Got an action type for a button which was not recognised. Falling back to the default action "+e)}var n}(t);break;default:O.d("Got an eventType action handler which is not known "+e)}})}function y(t){Object(g.p)("NativeNotificationNewEmailClickAction"),t&&Object(m.a)(t)}var A=n(6523);n.d(e,"g",(function(){return i.a})),n.d(e,"f",(function(){return r.a})),n.d(e,"h",(function(){return o.a})),n.d(e,"b",(function(){return c.a})),n.d(e,"d",(function(){return a.a})),n.d(e,"c",(function(){return s.a})),n.d(e,"e",(function(){return u.a})),n.d(e,"i",(function(){return T})),n.d(e,"a",(function(){return A.b}))},7624:function(t,e,n){"use strict";var i=n(2);e.a=Object(i.action)("ON_REMINDER_CLICKED",(t,e)=>({itemId:t,reminderType:e}))},9312:function(t,e,n){"use strict";var i=n(2);e.a=Object(i.action)("ON_LIKE_NOTIFICATION_CLICKED",t=>({notification:t}))},9313:function(t,e,n){"use strict";var i=n(2);e.a=Object(i.action)("ON_REACTION_NOTIFICATION_CLICKED",t=>({notification:t}))},9314:function(t,e,n){"use strict";var i=n(2);e.a=Object(i.action)("ON_NEW_MAIL_NOTIFICATION_NAVIGATED",t=>({notification:t}))},9315:function(t,e,n){"use strict";var i=n(2),r=n(3976);e.a=Object(i.mutatorAction)("REMOVE_NEW_IN_APP_MAIL_NOTIFICATION",t=>{let e=Object(r.a)().newMailNotifications,n=-1;for(let i=0;i<e.length;i++)if(e[i].ItemId===t){n=i;break}n>=0&&e.splice(n,1)})},958:function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return s})),n.d(e,"d",(function(){return u}));var i=n(1207);n.d(e,"f",(function(){return i.c})),n.d(e,"e",(function(){return i.b}));var r=n(1457);n.d(e,"a",(function(){return r.a}));var o=n(20);const c=new o.c(()=>n.e(825).then(n.bind(null,2652))),a=new o.a(c,t=>t.initializeOwaAccountsStore),s=new o.a(c,t=>t.initializeOwaConnectedAccount),u=new o.a(c,t=>t.removeOWAConnectedAccount)},9829:function(t,e,n){"use strict";var i=n(2),r=Object(i.action)("REFRESH_REMINDERS",(t,e)=>({userIdentity:t,updateSource:e})),o=Object(i.action)("GET_REMINDERS_FOR_WEBPUSH"),c=n(4807),a=(Object(i.orchestrator)(c.d,({notification:t,targetAccount:e})=>{t.shouldGetReminders&&r(e,"reminderNotification")}),n(68)),s=n(5),u=n(35);function d(t,e){var n;return void 0===t||t.__type||(n=t,t=Object.assign({__type:"GetRemindersJsonRequest:#Exchange"},n)),Object(u.a)("GetReminders",t,e)}var f=n(167),h=n(391),l=n(168);async function m(t,e,n){const i=Object(s.Tb)();let r;if(t){const e=Object(l.d)(t);r=Object(h.a)(e)}var o;return(await d({Header:Object(f.b)(),Body:(o={BeginTime:Object(s.vb)(Object(s.h)(i,e)),EndTime:Object(s.vb)(Object(s.h)(i,n)),ReminderType:1},Object.assign({__type:"GetRemindersRequest:#Exchange"},o))},null!=r?r:void 0)).Body}var b=n(155),p=n(22),O=n(52),g=n(91),I=n(1531),j=n.n(I),v=n(483);const T="ows/v1.0/Timers/timerbatch",y="/ows/api/ReminderProcessor/processItem",A=Object(v.n)();function R(t){const e=t.filter(t=>1===t.ReminderGroupTypes&&Object(s.Cb)(t.parsedReminderTime)>Object(s.nc)()&&Object(s.Cb)(t.parsedReminderTime)<=Object(s.nc)()+g.a.MillisecondsInOneDay);let n=Object(O.g)();const i=n.UserOptions.TimeZone,r=n.SessionSettings.UserPrincipalName,o=n.SessionSettings.UserPuid,c=n.SessionSettings.ExternalDirectoryTenantGuid;setTimeout(()=>{let t=new Array;e.forEach(e=>{t.push({timerName:j()().update(e.ItemId.Id).digest("hex"),payload:JSON.stringify({id:e.ItemId.Id,timeZoneId:i,userPrincipalName:r,puid:o,tenantId:c}),callbackURL:A+y,scheduledTime:e.parsedReminderTime})});try{t.length>0&&Object(b.f)(T,{Batch:t})}catch(t){p.d(`scheduleTimerForWebPushReminderFailure, error in batch api: ${t}`)}},1e4)}const N=-15,_=120,w=3e5,E=60*_*1e3-w,S=w,D=20736e5;function C(t){let e;return t.forEach(t=>{let n=Object(s.Cb)(t.parsedReminderTime);n>Object(s.nc)()&&(!e||n<Object(s.Cb)(e.parsedReminderTime))&&(e=t)}),void 0===e?E:Math.max(S,Math.min(Object(s.w)(Object(s.g)(e.parsedReminderTime,-w),Object(s.Tb)()),E))}var k=Object(i.action)("ON_UPDATE_ACTIVE_REMINDERS",t=>({activeReminders:t}));function M(t){const e=(null!=t?t:[]).filter(t=>{let e=Object(s.nc)();var n=function(t,e,n,i){return 2!==i?Object(s.Cb)(t)>n&&Object(s.Cb)(e)<n:Object(s.Cb)(e)<n}(t.parsedEndDate,t.parsedReminderTime,e,t.ReminderGroupTypes);const i=n?"activeReminder":"filteredReminder";return Object(a.p)(i,{itemId:t.ItemId.Id,reminderTime:t.ReminderTime,reminderTimeTimestamp:Object(s.Cb)(t.parsedReminderTime),endTime:t.EndDate,endTimeTimestamp:Object(s.Cb)(t.parsedEndDate),currentTimestamp:e}),n});return Object(a.p)("remindersReceived",{totalReminders:null==t?void 0:t.length,activeReminders:null==e?void 0:e.length}),null==e||e.sort((t,e)=>Object(s.p)(t.parsedStartDate,e.parsedStartDate)||(t.ItemId.Id>e.ItemId.Id?1:-1)),e}function V(t){const e=Object(s.nc)();let n={reminder:null,refreshTime:Number.MAX_VALUE};if(t.forEach(t=>{let i=function(t,e,n,i){return 2!=i?Math.min(Object(s.Cb)(t),Math.max(Object(s.Cb)(e),n)):Math.max(Object(s.Cb)(e),n)}(t.parsedEndDate,t.parsedReminderTime,e,t.ReminderGroupTypes);i>e&&i<n.refreshTime&&(n={reminder:t,refreshTime:i})}),!n.reminder)return-1;let i=n.refreshTime-e;return i>D?-1:i}var B=n(13),x={reminders:new B.ObservableMap,charmIdMap:new B.ObservableMap},F=Object(i.createStore)("reminders",x);function P(t){return F().reminders.get(t)}let z=null;function H(t){var e;z&&clearTimeout(z);const n=null!==(e=P(t))&&void 0!==e?e:[];k(M(n));const i=V(n);i>0&&(z=window.setTimeout(t=>H(t),i))}var W=Object(i.mutatorAction)("SET_REMINDERS",(t,e)=>{F().reminders.set(t,e)}),L=n(5343),G=n(25),U=n(3659);const K=2,q=3e5,Z=6e4;let J=0,$=new Map;function X(t,e){let n=$.get(t);return n||(n={timerId:null,inRefresh:!1,throttledFunctionForRefresh:Object(L.a)(()=>(async function(t,e){const n=X(t,e),i=n.inRefresh;if(Object(a.p)("refreshReminders",{inRefreshFlag:i,retryCount:J,updateSource:e},{sessionSampleRate:10}),n.inRefresh)return;n.inRefresh=!0,n.timerId&&(clearTimeout(n.timerId),n.timerId=0);let o=Z,c=null,u=0;try{const i=await m(t,N,_),d=(null==i?void 0:i.Reminders)?i.Reminders:[];u=d.length;const f=d.map(e=>Object.assign(Object.assign({},e),{parsedStartDate:Object(s.pc)(e.StartDate),parsedEndDate:Object(s.pc)(e.EndDate),parsedReminderTime:Object(s.pc)(e.ReminderTime),userIdentity:t}));W(t,f),H(t),Object(G.k)("auth-scheduleTimerForReminderWebPush")&&Object(U.d)()&&R(f);const h=P(t);o=C(h||[]),J=0}catch(t){c="Error:"+t;const e=Math.pow(K,J++)*Z;o=Math.min(e,q)}finally{Object(a.p)("refreshReminders/setTimeout",{remindersResponseCount:u,refreshTime:o,error:c,retryCount:J,updateSource:e},{sessionSampleRate:10}),n.timerId=window.setTimeout(r,o,t,"setTimeout"),n.inRefresh=!1}})(t,e),Z,{leading:!0,trailing:!0})},$.set(t,n)),n}Object(i.orchestrator)(r,({userIdentity:t,updateSource:e})=>{X(t,e).throttledFunctionForRefresh()});var Q=Object(i.action)("DISMISS_REMINDERS",t=>({itemId:t}));function Y(t,e){var n;return void 0===t||t.__type||(n=t,t=Object.assign({__type:"PerformReminderActionJsonRequest:#Exchange"},n)),Object(u.a)("PerformReminderAction",t,e)}function tt(t){return Object.assign({__type:"PerformReminderActionRequest:#Exchange"},t)}function et(t){return Object.assign({__type:"ReminderItemAction:#Exchange"},t)}var nt=Object(i.mutatorAction)("DELETE_REMINDER",t=>{const e=P(t.userIdentity);if(!e)return;const n=e.indexOf(t);n>=0&&e.splice(n,1)});function it(t){const e=[...F().reminders.values()];let n=null;for(let i=0;i<e.length;i++)if(n=e[i].filter(e=>e.ItemId.Id===t.Id)[0],n)return n;return null}Object(i.orchestrator)(Q,t=>{let{itemId:e}=t;const n=(Array.isArray(e)?e:[e]).map(it).filter(t=>!!t),i=new Map;n.forEach(t=>{i.has(t.userIdentity)?i.set(t.userIdentity,i.get(t.userIdentity).concat([t.ItemId])):i.set(t.userIdentity,[t.ItemId]),nt(t)}),i.forEach((t,e)=>{H(e),async function(t,e){let n;if(t){const e=Object(l.d)(t);n=Object(h.a)(e)}await Y({Header:Object(f.b)(),Body:tt({ReminderItemActions:e.map(t=>et({ActionType:0,ItemId:t}))})},null!=n?n:void 0)}(e,i.get(e))})});var rt=Object(i.action)("SNOOZE_REMINDER",(t,e)=>({itemId:t,newReminderTime:e}));var ot=Object(i.mutatorAction)("SET_REMINDER_TIME",(t,e)=>{t.ReminderTime=Object(s.sb)(e),t.parsedReminderTime=e}),ct=(Object(i.orchestrator)(rt,async t=>{let{itemId:e,newReminderTime:n}=t;const i=it(e);i&&(ot(i,n),H(i.userIdentity),await async function(t,e,n){let i;if(t){const e=Object(l.d)(t);i=Object(h.a)(e)}await Y({Header:Object(f.b)(),Body:tt({ReminderItemActions:[et({ActionType:1,ItemId:e,NewReminderTime:Object(s.sb)(n)})]})},null!=i?i:void 0)}(i.userIdentity,e,n))}),n(958));Object(i.orchestrator)(ct.f,({userIdentity:t,accountProviderType:e})=>{r(t,"connectedAccount"),!Object(G.k)("auth-subscribeToConnectedAccountReminders")||"Outlook"!==e&&"Google"!==e||Object(c.f)(t,e)});var at=n(30);Object(i.orchestrator)(o,async()=>{if(await async function(){var t;let e=null===(t=Object(at.a)().SessionSettings)||void 0===t?void 0:t.MailboxGuid,n=await U.f.import();if(e){let t=Object(U.b)(e,await n());Object(U.k)(window,t)}}(),Object(G.k)("auth-scheduleTimerForReminderWebPush")&&Object(U.d)())try{const t=await m(null,105,1440);R(((null==t?void 0:t.Reminders)||[]).map(t=>Object.assign(Object.assign({},t),{parsedStartDate:Object(s.pc)(t.StartDate),parsedEndDate:Object(s.pc)(t.EndDate),parsedReminderTime:Object(s.pc)(t.ReminderTime),userIdentity:null})))}catch(t){Object(a.p)("getRemindersForWebPush",{Error:t.toString()})}});n.d(e,"b",(function(){return k})),n.d(e,"a",(function(){return Q})),n.d(e,"c",(function(){return rt})),r(null,"bootstrap"),o()}}]);
//# sourceMappingURL=owa.169.js.map
self.scriptsLoaded['owa.169.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.169.js'] = (new Date()).getTime();