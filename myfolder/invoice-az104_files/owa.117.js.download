self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.117.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[117],{2935:function(e,n,t){"use strict";t.d(n,"b",(function(){return a}));var r=t(2);const i={bulkActionInformationMap:new(t(13).ObservableMap)},a=Object(r.createStore)("bulkActionStore",i),o=a();n.a=o},2951:function(e,n){e.exports=function(e){return e instanceof Date}},3027:function(e,n,t){"use strict";var r=t(2);const i=Object(r.createStore)("undo",{hasUndoableAction:!1,undoableActionFolderId:null});var a=i(),o=t(3020),u=t(68),c=t(595);const s={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DismissUndo"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"dismissUndo"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"undoRequestId"},value:{kind:"Variable",name:{kind:"Name",value:"undoRequestId"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"}}]}}]}}]};var l=t(3962),d=t(3572);let f,b;t.d(n,"a",(function(){return p})),t.d(n,"b",(function(){return v})),t.d(n,"c",(function(){return I})),t.d(n,"d",(function(){return T})),t.d(n,"e",(function(){return w}));const m=Object(r.mutatorAction)("setUndoableAction",(e,n)=>{const t=i();t.hasUndoableAction=e,t.undoableActionFolderId=n});function p(e,n,t){null!==e&&(f=e,b=t||null,m(!0,n))}async function v(){await I(),f=null,m(!1,null)}async function I(){if(b){try{const e=await b;if(e.success){const n=e.undoRequestId;if(n){let e={undoRequestId:n};await O.invokeDismissUndoMutation(e)}}}catch(e){}b=null}}const O={invokeDismissUndoMutation:async function(e){const n=Object(c.a)();n&&await n.mutate({variables:e,mutation:s})}};function T(){return i().hasUndoableAction}function w(e){const n=new u.b("TnS_Undo");n.addCustomData([e]),a.undoableActionFolderId?o.a.clearMapForFolder(a.undoableActionFolderId):o.a.removeAll();return null!==f&&(f().then(()=>{Object(l.a)()||Object(d.a)()}),v()),n.end(),Promise.resolve()}},3030:function(e,n,t){var r=t(2951),i=36e5,a=6e4,o=2,u=/[T ]/,c=/:/,s=/^(\d{2})$/,l=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],d=/^(\d{4})/,f=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],b=/^-(\d{2})$/,m=/^-?(\d{3})$/,p=/^-?(\d{2})-?(\d{2})$/,v=/^-?W(\d{2})$/,I=/^-?W(\d{2})-?(\d{1})$/,O=/^(\d{2}([.,]\d*)?)$/,T=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,w=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,D=/([Z+-].*)$/,A=/^(Z)$/,k=/^([+-])(\d{2})$/,g=/^([+-])(\d{2}):?(\d{2})$/;function R(e,n,t){n=n||0,t=t||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var i=7*n+t+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+i),r}e.exports=function(e,n){if(r(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var t=(n||{}).additionalDigits;t=null==t?o:Number(t);var S=function(e){var n,t={},r=e.split(u);c.test(r[0])?(t.date=null,n=r[0]):(t.date=r[0],n=r[1]);if(n){var i=D.exec(n);i?(t.time=n.replace(i[1],""),t.timezone=i[1]):t.time=n}return t}(e),y=function(e,n){var t,r=l[n],i=f[n];if(t=d.exec(e)||i.exec(e)){var a=t[1];return{year:parseInt(a,10),restDateString:e.slice(a.length)}}if(t=s.exec(e)||r.exec(e)){var o=t[1];return{year:100*parseInt(o,10),restDateString:e.slice(o.length)}}return{year:null}}(S.date,t),C=y.year,j=function(e,n){if(null===n)return null;var t,r,i,a;if(0===e.length)return(r=new Date(0)).setUTCFullYear(n),r;if(t=b.exec(e))return r=new Date(0),i=parseInt(t[1],10)-1,r.setUTCFullYear(n,i),r;if(t=m.exec(e)){r=new Date(0);var o=parseInt(t[1],10);return r.setUTCFullYear(n,0,o),r}if(t=p.exec(e)){r=new Date(0),i=parseInt(t[1],10)-1;var u=parseInt(t[2],10);return r.setUTCFullYear(n,i,u),r}if(t=v.exec(e))return a=parseInt(t[1],10)-1,R(n,a);if(t=I.exec(e)){a=parseInt(t[1],10)-1;var c=parseInt(t[2],10)-1;return R(n,a,c)}return null}(y.restDateString,C);if(j){var E,h=j.getTime(),F=0;return S.time&&(F=function(e){var n,t,r;if(n=O.exec(e))return(t=parseFloat(n[1].replace(",",".")))%24*i;if(n=T.exec(e))return t=parseInt(n[1],10),r=parseFloat(n[2].replace(",",".")),t%24*i+r*a;if(n=w.exec(e)){t=parseInt(n[1],10),r=parseInt(n[2],10);var o=parseFloat(n[3].replace(",","."));return t%24*i+r*a+1e3*o}return null}(S.time)),S.timezone?E=function(e){var n,t;if(n=A.exec(e))return 0;if(n=k.exec(e))return t=60*parseInt(n[2],10),"+"===n[1]?-t:t;if(n=g.exec(e))return t=60*parseInt(n[2],10)+parseInt(n[3],10),"+"===n[1]?-t:t;return 0}(S.timezone):(E=new Date(h+F).getTimezoneOffset(),E=new Date(h+F+E*a).getTimezoneOffset()),new Date(h+F+E*a)}return new Date(e)}},3085:function(e,n,t){"use strict";var r=t(20),i=t(2935),a=t(3724),o=t(22);function u(e){const n=i.a.bulkActionInformationMap.get(e);return!!n&&(!(n.customData&&!function(e){let n;try{n=JSON.parse(e)}catch(e){return o.d("Failed to parse bulkActionInfo.customData"),!1}return null!==n&&null!==n.Scenario}(n.customData))&&!Object(a.a)(n,e))}function c(e,n){const t=i.a.bulkActionInformationMap.get(e);return u(e)&&t.state==n}function s(e){return(c(e,l.b.Uninitialized)||c(e,l.b.Running))&&u(e)}var l=t(3136);t.d(n,"a",(function(){return f})),t.d(n,"j",(function(){return b})),t.d(n,"i",(function(){return m})),t.d(n,"k",(function(){return p})),t.d(n,"f",(function(){return v})),t.d(n,"h",(function(){return I})),t.d(n,"g",(function(){return O})),t.d(n,"c",(function(){return c})),t.d(n,"e",(function(){return u})),t.d(n,"d",(function(){return s})),t.d(n,"b",(function(){return l.b})),t.d(n,"l",(function(){return i.a}));const d=new r.c(()=>Promise.all([t.e(1),t.e(291),t.e(1061)]).then(t.bind(null,13283))),f=Object(r.d)(d,e=>e.BulkActionSpinner);let b=new r.a(d,e=>e.subscribeToBulkActionNotification),m=new r.a(d,e=>e.onBulkActionSubmitted),p=new r.a(d,e=>e.findBulkActionItemAction),v=new r.a(d,e=>e.onBulkActionCancel),I=new r.a(d,e=>e.onBulkActionHierarchyNotification),O=new r.a(d,e=>e.onBulkActionDismiss)},3101:function(e,n,t){"use strict";var r=t(20),i=t(3027),a=t(2733),o=t(2742),u=t(1084),c=t(2737);function s(e,n){return!(!e||Object(a.y)()||!n||"UserMailbox"!==n.type||Object(o.m)(e)||e==Object(u.a)("recoverableitemsdeletions")||Object(c.C)(e,"SharedMailbox"))}t.d(n,"f",(function(){return d})),t.d(n,"a",(function(){return i.a})),t.d(n,"b",(function(){return i.b})),t.d(n,"e",(function(){return i.d})),t.d(n,"c",(function(){return i.c})),t.d(n,"d",(function(){return s}));const l=new r.c(()=>t.e(2188).then(t.bind(null,19509)));let d=new r.a(l,e=>e.undo)},3136:function(e,n,t){"use strict";var r,i;t.d(n,"a",(function(){return i})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Running=1]="Running",e[e.Cancelled=2]="Cancelled",e[e.Complete=3]="Complete",e[e.Failed=4]="Failed",e[e.Timeout=5]="Timeout",e[e.Cancelling=6]="Cancelling"}(r||(r={})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Running=1]="Running",e[e.Cancelled=2]="Cancelled",e[e.Complete=3]="Complete",e[e.Failed=4]="Failed",e[e.Timeout=5]="Timeout"}(i||(i={})),n.b=r},3329:function(e,n,t){"use strict";function r(e){return Object.assign({__type:"SortResults:#Exchange"},e)}t.d(n,"a",(function(){return r}))},3451:function(e,n,t){"use strict";function r(e){let n="";return e.graphQLErrors&&e.graphQLErrors.forEach(e=>{var t;(null===(t=e.extensions)||void 0===t?void 0:t.responseCode)&&(n=e.extensions.responseCode)}),n}t.d(n,"a",(function(){return r}))},3545:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(2733);function i(e,n,t={tableViews:r.Z.tableViews}){const{tableViews:i}=t,a=[];return i.forEach(t=>{if(t.tableQuery.folderId===e||t.serverFolderId===e||n&&1===t.tableQuery.type)a.push(t);else if(n){const e=t.tableQuery.scenarioType;"category"!==e&&"persona"!==e&&"privatedistributionlist"!==e||a.push(t)}}),a}},3572:function(e,n,t){"use strict";var r=t(2);n.a=Object(r.action)("RESTORE_ROW_FAIL")},3652:function(e,n,t){"use strict";var r=t(2);n.a=Object(r.action)("GET_FOLDER_DATA",e=>({folderId:e}))},3724:function(e,n,t){"use strict";t.d(n,"a",(function(){return u}));var r=t(3805),i=t.n(r),a=t(3136),o=t(2935);function u(e,n){const t=new Date,r=new Date(e.sendTime),u=i()(t,r),c=isNaN(u),s=u>7.5,l=Object(o.b)().bulkActionInformationMap.get(n);return!(!c&&!s)||!!l&&[a.b.Cancelled,a.b.Failed,a.b.Complete].indexOf(l.state)>-1}},3767:function(e,n,t){var r=t(3030);e.exports=function(e,n){var t=r(e),i=r(n);return t.getTime()-i.getTime()}},3805:function(e,n,t){var r=t(3767),i=36e5;e.exports=function(e,n){var t=r(e,n)/i;return t>0?Math.floor(t):Math.ceil(t)}},3919:function(e,n,t){"use strict";t.d(n,"a",(function(){return s}));var r=t(3012),i=t(2733),a=t(395),o=t(1085),u=t(3329),c=t(1084);function s(e){const n=e.sortBy;let t,s;switch(n.sortColumn){case 1:Object(r.l)(e)?t="ReceivedOrRenewTime":Object(c.a)("drafts")==e.folderId&&(t="ItemLastModifiedTime");break;case 3:s=!0,t=Object(a.a)({PropertyTag:"0x0042",PropertyType:"String"});break;case 7:t="Size";break;case 5:t="Importance";break;case 8:t="Subject";break;default:throw new Error("getMailItemSortByProperty: sort column not supported"+n.sortColumn)}const l=[];if(t){let e=t;s||(e=Object(o.a)({FieldURI:t})),l.push(Object(u.a)({Order:n.sortDirection,Path:e}))}const d=1==e.sortBy.sortColumn?e.sortBy.sortDirection:i.c.DESCENDING_SORT_DIR;return l.push(Object(u.a)({Order:d,Path:Object(o.a)({FieldURI:"DateTimeReceived"})})),l}},3962:function(e,n,t){"use strict";let r;function i(){r=!0}function a(){return r}t.d(n,"b",(function(){return i})),t.d(n,"a",(function(){return a}))},4174:function(e,n,t){"use strict";var r=t(2);n.a=Object(r.action)("MARK_CONVERSATIONS_PINNED_STORE_UPDATE",(e,n,t)=>({rowKeys:e,tableViewId:n,shouldMarkAsPinned:t}))},4175:function(e,n,t){"use strict";var r=t(2);n.a=Object(r.action)("MARK_ITEMS_PINNED_STORE_UPDATE",(e,n,t)=>({rowKeys:e,tableViewId:n,shouldMarkAsPinned:t}))},4353:function(e,n,t){"use strict";var r=t(2);n.a=Object(r.action)("RELOAD_TABLE_ON_TRIAGE_ACTION_FAIL",e=>({tableView:e}))},4571:function(e,n,t){"use strict";var r=t(2);n.a=Object(r.action)("CONVERSATION_CATEGORIES_STORE_UPDATE",(e,n,t,r,i)=>({conversationRowKeys:e,tableViewId:n,categoriesToAdd:t,categoriesToRemove:r,clearCategories:i}))},4572:function(e,n,t){"use strict";var r=t(2);n.a=Object(r.action)("ITEMS_CATEGORIES_STORE_UPDATE",(e,n,t,r)=>({itemIds:e,categoriesToAdd:n,categoriesToRemove:t,clearCategories:r}))}}]);
//# sourceMappingURL=owa.117.js.map
self.scriptsLoaded['owa.117.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.117.js'] = (new Date()).getTime();