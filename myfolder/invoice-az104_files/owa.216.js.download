self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.216.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[216],{1218:function(e,t,r){"use strict";var n=r(1224),a=r(2364);function o(e,t){return 55296==(64512&e.charCodeAt(t))&&(!(t<0||t+1>=e.length)&&56320==(64512&e.charCodeAt(t+1)))}function i(e){return(e>>>24|e>>>8&65280|e<<8&16711680|(255&e)<<24)>>>0}function s(e){return 1===e.length?"0"+e:e}function c(e){return 7===e.length?"0"+e:6===e.length?"00"+e:5===e.length?"000"+e:4===e.length?"0000"+e:3===e.length?"00000"+e:2===e.length?"000000"+e:1===e.length?"0000000"+e:e}t.inherits=a,t.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var r=[];if("string"==typeof e)if(t){if("hex"===t)for((e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e),a=0;a<e.length;a+=2)r.push(parseInt(e[a]+e[a+1],16))}else for(var n=0,a=0;a<e.length;a++){var i=e.charCodeAt(a);i<128?r[n++]=i:i<2048?(r[n++]=i>>6|192,r[n++]=63&i|128):o(e,a)?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++a)),r[n++]=i>>18|240,r[n++]=i>>12&63|128,r[n++]=i>>6&63|128,r[n++]=63&i|128):(r[n++]=i>>12|224,r[n++]=i>>6&63|128,r[n++]=63&i|128)}else for(a=0;a<e.length;a++)r[a]=0|e[a];return r},t.toHex=function(e){for(var t="",r=0;r<e.length;r++)t+=s(e[r].toString(16));return t},t.htonl=i,t.toHex32=function(e,t){for(var r="",n=0;n<e.length;n++){var a=e[n];"little"===t&&(a=i(a)),r+=c(a.toString(16))}return r},t.zero2=s,t.zero8=c,t.join32=function(e,t,r,a){var o=r-t;n(o%4==0);for(var i=new Array(o/4),s=0,c=t;s<i.length;s++,c+=4){var d;d="big"===a?e[c]<<24|e[c+1]<<16|e[c+2]<<8|e[c+3]:e[c+3]<<24|e[c+2]<<16|e[c+1]<<8|e[c],i[s]=d>>>0}return i},t.split32=function(e,t){for(var r=new Array(4*e.length),n=0,a=0;n<e.length;n++,a+=4){var o=e[n];"big"===t?(r[a]=o>>>24,r[a+1]=o>>>16&255,r[a+2]=o>>>8&255,r[a+3]=255&o):(r[a+3]=o>>>24,r[a+2]=o>>>16&255,r[a+1]=o>>>8&255,r[a]=255&o)}return r},t.rotr32=function(e,t){return e>>>t|e<<32-t},t.rotl32=function(e,t){return e<<t|e>>>32-t},t.sum32=function(e,t){return e+t>>>0},t.sum32_3=function(e,t,r){return e+t+r>>>0},t.sum32_4=function(e,t,r,n){return e+t+r+n>>>0},t.sum32_5=function(e,t,r,n,a){return e+t+r+n+a>>>0},t.sum64=function(e,t,r,n){var a=e[t],o=n+e[t+1]>>>0,i=(o<n?1:0)+r+a;e[t]=i>>>0,e[t+1]=o},t.sum64_hi=function(e,t,r,n){return(t+n>>>0<t?1:0)+e+r>>>0},t.sum64_lo=function(e,t,r,n){return t+n>>>0},t.sum64_4_hi=function(e,t,r,n,a,o,i,s){var c=0,d=t;return c+=(d=d+n>>>0)<t?1:0,c+=(d=d+o>>>0)<o?1:0,e+r+a+i+(c+=(d=d+s>>>0)<s?1:0)>>>0},t.sum64_4_lo=function(e,t,r,n,a,o,i,s){return t+n+o+s>>>0},t.sum64_5_hi=function(e,t,r,n,a,o,i,s,c,d){var u=0,l=t;return u+=(l=l+n>>>0)<t?1:0,u+=(l=l+o>>>0)<o?1:0,u+=(l=l+s>>>0)<s?1:0,e+r+a+i+c+(u+=(l=l+d>>>0)<d?1:0)>>>0},t.sum64_5_lo=function(e,t,r,n,a,o,i,s,c,d){return t+n+o+s+d>>>0},t.rotr64_hi=function(e,t,r){return(t<<32-r|e>>>r)>>>0},t.rotr64_lo=function(e,t,r){return(e<<32-r|t>>>r)>>>0},t.shr64_hi=function(e,t,r){return e>>>r},t.shr64_lo=function(e,t,r){return(e<<32-r|t>>>r)>>>0}},1224:function(e,t){function r(e,t){if(!e)throw new Error(t||"Assertion failed")}e.exports=r,r.equal=function(e,t,r){if(e!=t)throw new Error(r||"Assertion failed: "+e+" != "+t)}},1531:function(e,t,r){"use strict";var n=r(1218),a=r(2359),o=r(2365),i=r(1224),s=n.sum32,c=n.sum32_4,d=n.sum32_5,u=o.ch32,l=o.maj32,h=o.s0_256,p=o.s1_256,f=o.g0_256,g=o.g1_256,v=a.BlockHash,b=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function m(){if(!(this instanceof m))return new m;v.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=b,this.W=new Array(64)}n.inherits(m,v),e.exports=m,m.blockSize=512,m.outSize=256,m.hmacStrength=192,m.padLength=64,m.prototype._update=function(e,t){for(var r=this.W,n=0;n<16;n++)r[n]=e[t+n];for(;n<r.length;n++)r[n]=c(g(r[n-2]),r[n-7],f(r[n-15]),r[n-16]);var a=this.h[0],o=this.h[1],v=this.h[2],b=this.h[3],m=this.h[4],C=this.h[5],A=this.h[6],y=this.h[7];for(i(this.k.length===r.length),n=0;n<r.length;n++){var S=d(y,p(m),u(m,C,A),this.k[n],r[n]),k=s(h(a),l(a,o,v));y=A,A=C,C=m,m=s(b,S),b=v,v=o,o=a,a=s(S,k)}this.h[0]=s(this.h[0],a),this.h[1]=s(this.h[1],o),this.h[2]=s(this.h[2],v),this.h[3]=s(this.h[3],b),this.h[4]=s(this.h[4],m),this.h[5]=s(this.h[5],C),this.h[6]=s(this.h[6],A),this.h[7]=s(this.h[7],y)},m.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"big"):n.split32(this.h,"big")}},1606:function(e,t,r){"use strict";var n=r(2384);function a(e){this.message=e}a.prototype=new Error,a.prototype.name="InvalidTokenError",e.exports=function(e,t){if("string"!=typeof e)throw new a("Invalid token specified");var r=!0===(t=t||{}).header?0:1;try{return JSON.parse(n(e.split(".")[r]))}catch(e){throw new a("Invalid token specified: "+e.message)}},e.exports.InvalidTokenError=a},17991:function(e,t,r){var n=r(17992);"string"==typeof n&&(n=[[e.i,n,""]]);var a={transform:void 0};r(84)(n,a);n.locals&&(e.exports=n.locals)},17992:function(e,t,r){(t=e.exports=r(83)(!1)).push([e.i,"._25Un94GIU9iwJI_fbgP-cb{-webkit-box-sizing:border-box;box-sizing:border-box}html[dir] ._25Un94GIU9iwJI_fbgP-cb{border-width:1px;border-style:dashed;border-color:var(--themePrimary)}",""]),t.locals={imagePlaceholder:"_25Un94GIU9iwJI_fbgP-cb"}},2359:function(e,t,r){"use strict";var n=r(1218),a=r(1224);function o(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}t.BlockHash=o,o.prototype.update=function(e,t){if(e=n.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){var r=(e=this.pending).length%this._delta8;this.pending=e.slice(e.length-r,e.length),0===this.pending.length&&(this.pending=null),e=n.join32(e,0,e.length-r,this.endian);for(var a=0;a<e.length;a+=this._delta32)this._update(e,a,a+this._delta32)}return this},o.prototype.digest=function(e){return this.update(this._pad()),a(null===this.pending),this._digest(e)},o.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,r=t-(e+this.padLength)%t,n=new Array(r+this.padLength);n[0]=128;for(var a=1;a<r;a++)n[a]=0;if(e<<=3,"big"===this.endian){for(var o=8;o<this.padLength;o++)n[a++]=0;n[a++]=0,n[a++]=0,n[a++]=0,n[a++]=0,n[a++]=e>>>24&255,n[a++]=e>>>16&255,n[a++]=e>>>8&255,n[a++]=255&e}else for(n[a++]=255&e,n[a++]=e>>>8&255,n[a++]=e>>>16&255,n[a++]=e>>>24&255,n[a++]=0,n[a++]=0,n[a++]=0,n[a++]=0,o=8;o<this.padLength;o++)n[a++]=0;return n}},2364:function(e,t){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},2365:function(e,t,r){"use strict";var n=r(1218).rotr32;function a(e,t,r){return e&t^~e&r}function o(e,t,r){return e&t^e&r^t&r}function i(e,t,r){return e^t^r}t.ft_1=function(e,t,r,n){return 0===e?a(t,r,n):1===e||3===e?i(t,r,n):2===e?o(t,r,n):void 0},t.ch32=a,t.maj32=o,t.p32=i,t.s0_256=function(e){return n(e,2)^n(e,13)^n(e,22)},t.s1_256=function(e){return n(e,6)^n(e,11)^n(e,25)},t.g0_256=function(e){return n(e,7)^n(e,18)^e>>>3},t.g1_256=function(e){return n(e,17)^n(e,19)^e>>>10}},2384:function(e,t,r){var n=r(2385);e.exports=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(n(e).replace(/(.)/g,(function(e,t){var r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r})))}(t)}catch(e){return n(t)}}},2385:function(e,t){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function n(e){this.message=e}n.prototype=new Error,n.prototype.name="InvalidCharacterError",e.exports="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new n("'atob' failed: The string to be decoded is not correctly encoded.");for(var a,o,i=0,s=0,c="";o=t.charAt(s++);~o&&(a=i%4?64*a+o:o,i++%4)?c+=String.fromCharCode(255&a>>(-2*i&6)):0)o=r.indexOf(o);return c}},4511:function(e,t,r){"use strict";var n=r(4688),a=r(22),o=r(2),i=r(6769);Object(o.mutator)(i.a,e=>{n.a.cards.set(e.cardId,{autoInvokeActionAlreadyRan:!1})}),Object(o.mutator)(i.b,e=>{n.a.cards.delete(e.cardId)}),Object(o.mutator)(i.c,e=>{const t=n.a.cards.get(e.cardId);t?t.autoInvokeActionAlreadyRan=e.autoInvokeActionAlreadyRan:a.h.warn(`[ActionableMessageDebug] setAutoInvokeActionAlreadyRanMutator: card is undefined for cardId ${e.cardId}`)});var s=r(20),c=r(5),d=r(6310);class u{constructor(e,t,r){this.perfCheckpoints={currentCardCheckpoints:{},previousCardCheckpoints:{}},this.telemetryProvider=e,this.messageContext=t,this.perfData=r}stampPerfCheckpoint(e,t){!function(e,t,r){const n=r||Object(c.Ub)();switch(t){case d.a.LoadStart:e.loadStart=n;break;case d.a.AutoInvokeActionStart:e.autoInvokeActionStart=n;break;case d.a.AutoInvokeActionEnd:e.autoInvokeActionEnd=n;break;case d.a.CardRenderStart:e.currentCardCheckpoints.cardRenderStart=n;break;case d.a.CardRenderEnd:e.currentCardCheckpoints.cardRenderEnd=n;break;case d.a.ThemeResolveStart:e.currentCardCheckpoints.themeResolveStart=n;break;case d.a.ThemeResolveEnd:e.currentCardCheckpoints.themeResolveEnd=n;break;case d.a.CardCreateStart:e.currentCardCheckpoints.cardCreateStart=n;break;case d.a.CardCreateEnd:e.currentCardCheckpoints.cardCreateEnd=n;break;case d.a.CardLibraryRenderStart:e.currentCardCheckpoints.cardLibraryRenderStart=n;break;case d.a.CardLibraryRenderEnd:e.currentCardCheckpoints.cardLibraryRenderEnd=n;break;case d.a.PrepareCardStart:e.currentCardCheckpoints.prepareCardStart=n;break;case d.a.PrepareCardEnd:e.currentCardCheckpoints.prepareCardEnd=n;break;default:a.h.info("Actionable Message Card: markPerfCheckpointMutator called with unespected PerfMarker")}}(this.perfCheckpoints,e,t)}logTelemetryProvider(e,t,r,n){let a=this.getTelemetryDetailsForEvent(e,t,r,n);this.telemetryProvider.logTelemetry(a)}setTotalFetchTimeForCard(){this.perfCheckpoints&&this.perfCheckpoints.currentCardCheckpoints&&(this.perfCheckpoints.currentCardCheckpoints.totalFetchTime=Object(c.w)(this.perfData.fetchEndTime,this.perfData.fetchStartTime))}getTelemetryDetailsForEvent(e,t,r,n){return{messageContext:this.messageContext,cardDetails:e,eventName:t,actionContext:r,elementDetails:n,perfCheckpoints:this.perfCheckpoints}}updatePerfCheckpointsBeforeUpdatingAutoInvokeResponse(){this.perfCheckpoints&&(this.perfCheckpoints.previousCardCheckpoints=this.perfCheckpoints.currentCardCheckpoints,this.perfCheckpoints.currentCardCheckpoints={})}}var l,h=r(159);function p(e,t,r,n,a){return Object.assign(Object.assign({},e),{isAdaptiveCard:void 0===n?"AdaptiveCard"===t.type:n,cardSignature:r,card:t,cardHash:void 0,cardId:a||Object(h.a)()})}!function(e){e[e.NotLoaded=0]="NotLoaded",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded"}(l||(l={}));var f=r(6770),g=Object(o.mutatorAction)("setThemeLoadStatus",(function(e){n.a.themeStore.loadStatus=e}));var v=e=>{if(e){const t=e[0];Object.keys(t).forEach(e=>{Object(f.a)(e,t[e])});const r=e[1];Object.keys(r).forEach(e=>{Object(f.a)(e,r[e])}),g(1)}else a.h.info("Error in getting theme definitions: null value returned"),g(2)};r.d(t,"a",(function(){return m})),r.d(t,"d",(function(){return C})),r.d(t,"b",(function(){return u})),r.d(t,"e",(function(){return p})),r.d(t,"c",(function(){return l})),r.d(t,"f",(function(){return v}));const b=new s.c(()=>Promise.all([r.e(0),r.e(5),r.e(6),r.e(7),r.e(8),r.e(9),r.e(13),r.e(15),r.e(22),r.e(25),r.e(27),r.e(32),r.e(38),r.e(44),r.e(124),r.e(150),r.e(192),r.e(644)]).then(r.bind(null,19703))),m=Object(s.d)(b,e=>e.ActionableMessageCardWrapper),C=new s.b(b,e=>e.parseCardFromStringOrObject)},4688:function(e,t,r){"use strict";var n=r(13),a=r(2);const o={themeStore:{loadStatus:0,themeMapping:{},themeMappingDarkMode:{}},cards:new n.ObservableMap},i=Object(a.createStore)("ActionableMessageV2",o);t.a=i()},5758:function(e,t,r){"use strict";var n=r(68),a=r(8897),o=r(9179),i=r(9707),s=r(11505),c=r(11846),d=r(8900);var u=(e,t=!0)=>{const{eventName:r,messageContext:n,cardDetails:a,elementDetails:u,actionContext:l,perfCheckpoints:h}=e;if(void 0===r)return;let p;switch(Object(d.a)(r)){case o.a.type:p=new o.a(r,n,a);break;case i.a.type:p=new i.a(r,n,a,u);break;case s.a.type:p=new s.a(r,n,a,u,l);break;case c.a.type:p=new c.a(r,n,a,l,h)}return null==p?void 0:p.getProperties(t)},l=r(8901);var h=async e=>{if(Object(l.a)())return;const t=u(e);if(!t)return;const r=await Object(n.g)(),o={name:a.a.ClientEvent,properties:t};r.logEvent(o)},p=r(9174),f=r(11506);var g=(e,t)=>{if(void 0===e)return;let r;switch(Object(d.a)(e)){case f.a.type:r=new f.a(e,t)}return null==r?void 0:r.getProperties(!0)};var v=async(e,t)=>{if(Object(l.a)())return;const r=g(e,t);if(!r)return;const o=await Object(n.g)(),i={name:a.a.ClientEvent,properties:r};o.logEvent(i)},b=r(8899),m=r(7872),C=r(7873);r.d(t,"g",(function(){return A})),r.d(t,"e",(function(){return p.a})),r.d(t,"f",(function(){return v})),r.d(t,"d",(function(){return u})),r.d(t,"c",(function(){return b.a})),r.d(t,"b",(function(){return m.a})),r.d(t,"a",(function(){return C.a}));const A={logTelemetry:h}},6310:function(e,t,r){"use strict";var n;!function(e){e[e.LoadStart=0]="LoadStart",e[e.AutoInvokeActionStart=1]="AutoInvokeActionStart",e[e.AutoInvokeActionEnd=2]="AutoInvokeActionEnd",e[e.CardRenderStart=3]="CardRenderStart",e[e.CardRenderEnd=4]="CardRenderEnd",e[e.ThemeLoadTotalStart=5]="ThemeLoadTotalStart",e[e.ThemeLoadTotalEnd=6]="ThemeLoadTotalEnd",e[e.ThemeDefinitionsLoadStart=7]="ThemeDefinitionsLoadStart",e[e.ThemeDefinitionsLoadEnd=8]="ThemeDefinitionsLoadEnd",e[e.ThemeResolveStart=9]="ThemeResolveStart",e[e.ThemeResolveEnd=10]="ThemeResolveEnd",e[e.CardCreateStart=11]="CardCreateStart",e[e.CardCreateEnd=12]="CardCreateEnd",e[e.CardLibraryRenderStart=13]="CardLibraryRenderStart",e[e.CardLibraryRenderEnd=14]="CardLibraryRenderEnd",e[e.PrepareCardStart=15]="PrepareCardStart",e[e.PrepareCardEnd=16]="PrepareCardEnd"}(n||(n={})),t.a=n},6769:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return i}));var n=r(2);const a=Object(n.action)("addCard",e=>({cardId:e})),o=Object(n.action)("removeCard",e=>({cardId:e})),i=Object(n.action)("setAutoInvokeActionAlreadyRan",(e,t)=>({cardId:e,autoInvokeActionAlreadyRan:t}))},6770:function(e,t,r){"use strict";var n=r(4688),a=r(2);t.a=Object(a.mutatorAction)("setThemeForKey",(function(e,t){t.isDarkModeTheme?n.a.themeStore.themeMappingDarkMode[e]=t:n.a.themeStore.themeMapping[e]=t}))},6838:function(e,t,r){"use strict";var n=r(25),a=r(22),o=r(3397);class i extends o.HttpAction{constructor(e){super(),this.preserveBody=e}internalPrepareForExecution(e){const t=this.body;super.internalPrepareForExecution(e),this.preserveBody&&(this.body=t)}parse(e){super.parse(e),this.isPrimary=e.isPrimary}}var s,c,d=r(2);!function(e){e[e.UnResolved=0]="UnResolved",e[e.InProgress=1]="InProgress",e[e.Resolved=2]="Resolved"}(s||(s={})),function(e){e[e.Empty=0]="Empty",e[e.Success=1]="Success",e[e.Error=2]="Error"}(c||(c={}));const u={cache:{data:null,state:c.Empty,time:null},requestState:s.UnResolved};var l=Object(d.createStore)("amClientConfigurationStore",u)();var h=()=>{var e,t;let r=null;return(null===(t=null===(e=l.cache.data)||void 0===e?void 0:e.clientTimeouts)||void 0===t?void 0:t.default)&&(r=l.cache.data.clientTimeouts.default),r},p=r(68),f=r(3840),g=r(6),v=r(7869),b=r(9704),m=r(69),C=r(106),A=r(30);const y="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";var S,k,w=r(5758),O=r(11);!function(e){e[e.Empty=0]="Empty",e[e.Success=1]="Success",e[e.Error=2]="Error"}(S||(S={})),function(e){e[e.UnResolved=0]="UnResolved",e[e.InProgress=1]="InProgress",e[e.Resolved=2]="Resolved"}(k||(k={}));const j={cache:{data:{Url:(()=>Object(n.k)("rp-actionableMessages-action-endpoint-b2")?"/actionsb2":"/actions")()},state:S.Empty,time:null},requestState:k.UnResolved};var E=Object(d.createStore)("amActionEndpointStore",j)();var I=()=>!!Object(O.c)(window)&&!!Object(O.a)(window,"ActionableMessages.ActionEndpoint");const T=()=>(()=>E.cache.data)().Url;var x=(e,t,r,a,i)=>{var s;const c=e["@id"]?e["@id"]:e.id;let d={"@type":"HttpPOST",name:e.title,target:e.url,body:e.body,"@id":c,hideCardOnInvoke:e.hideCardOnInvoke,isPrimaryAction:!!e.isPrimary&&e.isPrimary};e.headers&&e.headers.length>0&&(d.headers=e.headers);const u=Object(A.a)(),l=[];if(t)for(let e=0;e<t.length;e++){const r=t[e],n=new o.ValidationResults;if(r.internalValidateProperties(n),n.failures.length>0)return Promise.resolve({success:!1,displayMessage:n.failures[0].errors[0].message});if(!r)continue;let a;a="Input.Date"===r.getJsonTypeName()?{id:r.id,value:r.value,usertimezone:u.UserOptions.TimeZone}:{id:r.id,value:r.value},l.push(a)}const h={type:o.HttpAction.JsonTypeName,url:e.url,body:e.body,method:e.method,id:e.id?e.id:"30d2f5e2-6e6f-43b0-a2bd-c9d87a5cd6fd",headers:e.headers},p=Object(g.e)();let f;const v={type:e.getJsonTypeName(),id:e.id},b={eventName:R(e,i),messageContext:a,cardDetails:r,elementDetails:v,actionContext:e.actionContext},m=Object(w.d)(b,!1);if(m.messageCardContext)try{m.messageCardContext=JSON.parse(m.messageCardContext)}catch(e){}if(m.messageCardExtensionContext)try{m.messageCardExtensionContext=JSON.parse(m.messageCardExtensionContext)}catch(e){}if(m.actionContext)try{m.actionContext=JSON.parse(m.actionContext)}catch(e){}r.isAdaptiveCard?f={httpAction:h,inputParameters:l,connectorSenderGuid:r.connectorSenderGuid,SmtpAddressesSerialized:r.smtpAddressesSerialized,adaptiveCardSignature:r.cardSignature,providerAccountUniqueId:r.providerAccountUniqueId,clientTelemetry:m,adaptiveCardHash:r.cardHash}:(d=Object.assign(Object.assign({},e.originalJsonPayload),d),f={inputParameters:l,connectorSenderGuid:r.connectorSenderGuid,potentialAction:JSON.stringify(d),SmtpAddressesSerialized:r.smtpAddressesSerialized,messageCardSignature:r.cardSignature,providerAccountUniqueId:r.providerAccountUniqueId,clientTelemetry:m,tenantObjectId:u.SessionSettings.ExternalDirectoryTenantGuid,messageCardHash:r.cardHash,culture:p,uiCulture:p}),Object(n.k)("rp-actionableMessagesSenderAddress")&&(f.senderAddress=a.senderAddress);const C=null===(s=a.mailboxInfo)||void 0===s?void 0:s.mailboxSmtpAddress;return P(M(a,p,r.isAdaptiveCard),JSON.stringify(f),"HttpAction",C,null,U(r),i)};const R=(e,t)=>t?"AutoInvokeActionClicked":e.parent&&(e=>{for(;e.parent;){if(e instanceof o.AdaptiveCard)return!0;e=e.parent}return!1})(e.parent)?"ActionCardHttpPostActionClicked":"SingleClickHttpPostActionClicked",M=(e,t,r)=>{const n="UserMailbox"===e.mailboxInfo.type?"userid":e.mailboxInfo.mailboxSmtpAddress,a=e.odataItemId,o=e.odataConversationId,i=T();switch(e.mailboxInfo.type){case"UserMailbox":return r?Object(g.c)("{0}/{1}/messages/{2}/adaptiveCard/executeAction?culture={3}",i,n,a,t):Object(g.c)("{0}/{1}/messages/{2}/executeAction?culture={3}",i,n,a,t);case"GroupMailbox":case"TeamsMailbox":return r?Object(g.c)("{0}/{1}/threads/{2}/posts/{3}/adaptiveCard/executeAction?culture={4}",i,n,o,a,t):Object(g.c)("{0}/{1}/threads/{2}/posts/{3}/executeAction?culture={4}",i,n,o,a,t);case"PublicMailbox":case"SharedMailbox":case"ArchiveMailbox":return null}},P=async(e,t,r,n,o,i,s=!1)=>{const c=o||Object(C.b)(),d={correlationVector:c,cardCorrelationId:i,requestType:r};let u;try{if(u=await Object(f.a)(),u||(a.h.warn("[ActionableMessageDebug] makePostRequest: Unable to get the client Auth token possibly AAD token"),u=await Object(f.b)()),!u)throw new Error(`Token is empty: ${u}`)}catch(e){return a.h.warn(`[ActionableMessageDebug] makePostRequest: Error while getting token, error: ${e}`),d.err=e.message,Object(p.p)("ActionableMessageConnectorsPostRequestErrorGettingToken",d,{isCore:!0}),{success:!1,displayMessage:Object(g.b)(v.a)}}return _(e,u,t,n,s,c,d)},_=(e,t,r,n,a,o,i)=>new Promise(s=>{const c=new XMLHttpRequest;c.onreadystatechange=function(){4===c.readyState&&s(D(200===c.status,c.responseText))},c.ontimeout=function(){s({success:!1,displayMessage:Object(g.b)(v.a)}),Object(p.p)("ActionableMessageConnectorsPostRequestTimeout",i,{isCore:!0})},c.open("POST",e,!0),c.timeout=(e=>{let t=e?6e3:1e4;const r=h();return e&&(null==r?void 0:r.AutoInvokedActionTimeoutInMsec)?t=r.AutoInvokedActionTimeoutInMsec:!e&&(null==r?void 0:r.HttpActionTimeoutInMsec)&&(t=r.HttpActionTimeoutInMsec),t})(a),c.setRequestHeader("MS-CV",o),c.setRequestHeader("X-OWA-CANARY",Object(m.a)()),c.setRequestHeader("X-RoutingParameter-SessionKey",n),c.setRequestHeader("X-AnchorMailbox",n),c.setRequestHeader("Authorization",`Bearer ${t}`),c.send(r)}),D=(e,t)=>{try{const r=JSON.parse(t),n=!!e&&L(r.status);return{success:n,status:r.status,displayMessage:r.displayMessage?r.displayMessage:n?Object(g.b)(b.a):Object(g.b)(v.a),performedAt:r.performedAt,newCardPayload:r.refreshCardSerialized,newCardSignature:r.refreshCardSignature,removeCard:r.removeCard,showOriginalCard:r.showOriginalCard,hideCard:r.hideCard,authenticationUrl:r.authenticationUrl,cardUpdates:r.cardUpdates,errors:r.errors}}catch(e){return{success:!1,displayMessage:Object(g.b)(v.a)}}},L=e=>e&&"completed"===e.toLowerCase(),U=e=>{try{return e.card.messageCardContext.correlationId}catch(e){return""}};var H=r(1606),q=r.n(H),N=r(1531),J=r.n(N);var z=(e,t,r,n)=>{try{const t=e.displayMessage;if(!r||e.success||!t||-1===t.indexOf("Failed to validate the signature of the actionable message card"))return;const a=r.cardHash;let o="",i="";if(r.cardSignature)try{const e=q()(r.cardSignature);o=e.messagecardhash,i=e.senderaddress}catch(e){}let s="";try{const e=JSON.stringify(r.card),t=J()().update(e).digest();s=btoa(String.fromCharCode.apply(null,new Uint8Array(t)))}catch(e){}const c={originator:r.connectorSenderGuid,vals:{ch:a,sch:o,cch:s,csa:i===n.senderAddress}};a!==o&&Object(w.e)(w.b.FailedToValidateSignature,w.a.Critical,JSON.stringify(c))}catch(e){}};function $(e){const t=new i(!0);return t.method="POST",t.body=e.body,t.title=e.name,t.originalJsonPayload=e,e.headers&&e.headers.length>0&&(t.headers=[],e.headers.forEach(e=>{t.headers.push(new o.HttpHeader(e.name,e.value))})),t.url=e.target,t["@id"]=e["@id"],t.hideCardOnInvoke=e.hideCardOnInvoke,t}const B="HttpPOST";var F=r(220);var G=r(4511);var X=Object(d.mutatorAction)("setClientConfiguration",e=>{l.cache=e});var V=Object(d.mutatorAction)("updateRequestState",e=>{l.requestState=e});var W=()=>l.cache;var K=()=>{var e,t,r,n;const a=W(),o=null===(t=null===(e=null==a?void 0:a.data)||void 0===e?void 0:e.themeMappings)||void 0===t?void 0:t.connectors,i=null===(n=null===(r=null==a?void 0:a.data)||void 0===r?void 0:r.themeMappingsDarkMode)||void 0===n?void 0:n.connectors;if(!o&&!i)return null;let s={};o&&Object.keys(o).forEach(e=>{const t={themeConfigUrl:o[e],hostConfig:null,stylesheetUrl:null,isResolved:!1,isDarkModeTheme:!1};s[e]=t});let c={};return i&&Object.keys(i).forEach(e=>{const t={themeConfigUrl:i[e],hostConfig:null,stylesheetUrl:null,isResolved:!1,isDarkModeTheme:!0};c[e]=t}),[s,c]};var Q=()=>!!Object(O.c)(window)&&!!Object(O.a)(window,"ActionableMessages.ClientConfiguration");var Y=()=>Q()?JSON.parse(Object(O.a)(window,"ActionableMessages.ClientConfiguration")):null;var Z=()=>l.cache.state!==c.Empty;var ee=()=>{const e=Date.now()-l.cache.time;return l.cache.state===c.Success&&e>=432e6||l.cache.state===c.Error&&e>=864e5||(()=>{var e,t;const r=null===(t=null===(e=l.cache.data)||void 0===e?void 0:e.themeMappings)||void 0===t?void 0:t.connectors;return l.cache.state===c.Success&&null===r})()},te=r(168),re=r(52);const ne=e=>{var t,r;const n=Object(re.g)(),a=null===(t=n.SessionSettings)||void 0===t?void 0:t.UserPrincipalName,o=null===(r=n.SessionSettings)||void 0===r?void 0:r.UserEmailAddress,i=a||o;return e.set("X-RoutingParameter-SessionKey",i),e.set("X-AnchorMailbox",i),e.set(C.a,Object(C.b)()),e};var ae=(e,t,r=9e4)=>new Promise((n,a)=>{let o;"AbortController"in window&&(o=new AbortController,t.signal=o.signal);const i=window.setTimeout(()=>{o?o.abort():a()},r);fetch(e,t).then(e=>{window.clearTimeout(i),n(e)}).catch(e=>{window.clearTimeout(i),a(e)})});var oe=async()=>{try{const e=(()=>{const e=Object(te.c)(),t=Object(w.c)();return`${T()}/v1.0/${e}/clientConfigs/WAC_Outlook_React?clientVersion=${t}&clientColorScheme=default&$expand=providerConfigs`})(),t={method:"GET",headers:await(async()=>{const e=ne(new Headers),t=await Object(f.a)();return e.set("Authorization",(e=>`Bearer ${e}`)(t)),e})()},r=await ae(e,t);if(r.ok)return await r.json();throw r}catch(e){throw e}};const ie=(e,t=null)=>{const r={data:t,state:e,time:Date.now()};if(null===t){const e=W();r.data=e.data}return r},se=Object(d.action)("loadClientConfiguration");Object(d.orchestrator)(se,async()=>{V(s.InProgress);let e=null;try{const t=await oe();e=ie(c.Success,t)}catch(t){e=ie(c.Error)}finally{X(e),(e=>{if(Object(O.c)(window))try{Object(O.e)(window,"ActionableMessages.ClientConfiguration",JSON.stringify(e))}catch(e){a.h.info("[ActionableMessageDebug] owa-actionable-message-connectors loadClientConfiguration setClientConfigurationInLocalStorage Exception on setItem|JSON.stringify "+e.toString())}})(e),Object(G.f)(K()),V(s.Resolved)}});var ce=se;var de=()=>{l.requestState!==s.InProgress&&ce()};var ue=()=>E.cache.state!==S.Empty;var le=()=>{const e=Date.now()-E.cache.time;return E.cache.state===S.Success&&e>=432e6||E.cache.state===S.Error&&e>=864e5};var he=Object(d.mutatorAction)("updateActionEndpointRequestState",e=>{E.requestState=e});var pe=async()=>{try{const e=`https://outlook.office365.com/autodiscover/autodiscover.json/v1.0/${Object(te.c)()}?Protocol=Actions`,t={method:"GET",headers:ne(new Headers)},r=await ae(e,t);if(r.ok)return await r.json();throw r}catch(e){try{if(e instanceof Response){const t=await e.text();Object(w.e)(w.b.AutoDFailure,w.a.Standard,t)}else{let t;(e.name||e.message)&&(t=`${e.name}: ${e.message}`),Object(w.e)(w.b.AutoDFailure,w.a.Standard,t,e.stack)}}catch(e){}throw e}};var fe=Object(d.mutatorAction)("setActionEndpoint",e=>{E.cache=e});var ge=()=>l.cache.state;const ve=(e,t=null)=>{let r=T();return(null==t?void 0:t.Url)?r="/"+t.Url.split("/").pop():e=S.Error,{data:{Url:r},state:e,time:Date.now()}},be=Object(d.action)("loadActionEndpoint");Object(d.orchestrator)(be,async()=>{he(k.InProgress);let e=null;try{const t=await pe();e=ve(S.Success,t)}catch(t){e=ve(S.Error)}finally{if(fe(e),(e=>{if(Object(O.c)(window))try{Object(O.e)(window,"ActionableMessages.ActionEndpoint",JSON.stringify(e))}catch(e){a.h.info("[ActionableMessageDebug] owa-actionable-message-connectors loadActionEndpoint setActionEndpointInLocalStorage Exception on setItem|JSON.stringify "+e.toString())}})(e),he(k.Resolved),Object(n.k)("rp-actionableMessagesDebug")){const t={AutoD:{model:e.data.Url,status:e.state},ConfigAPI:{status:ge()}};Object(w.f)(w.b.SessionDetails,t)}}});var me=be;var Ce=()=>{E.requestState!==k.InProgress&&me()};var Ae=()=>{ue()?le()&&Ce():I()?(fe((()=>I()?JSON.parse(Object(O.a)(window,"ActionableMessages.ActionEndpoint")):null)()),he(k.Resolved),le()&&Ce()):Ce()};const ye=()=>E.cache.state,Se=()=>{return null!==W().data};var ke=()=>{if(Ae(),Z())return ee()&&de(),Se();if(Q()){if(X(Y()),Object(G.f)(K()),V(s.Resolved),ee()&&de(),Object(n.k)("rp-actionableMessagesDebug")){const e={AutoD:{model:T(),status:ye()},ConfigAPI:{status:ge()}};Object(w.f)(w.b.SessionDetails,e)}return Se()}return de(),!1};var we=()=>{var e,t;let r=!1;if(ke()){const n=W();(null===(t=null===(e=null==n?void 0:n.data)||void 0===e?void 0:e.organizationConfigs)||void 0===t?void 0:t.SmtpActionableMessagesEnabled)&&(r=!0)}return r};const Oe=(e,t)=>{let r=!1;for(const n of e)if(n.originator===t){r=!0;break}return r};var je=(e,t)=>{var r,n;let a=!1;if(ke()){const o=W();!t&&(null===(r=null==o?void 0:o.data)||void 0===r?void 0:r.providerConfigs)?a=Oe(o.data.providerConfigs,e):t&&(null===(n=null==o?void 0:o.data)||void 0===n?void 0:n.providerConfigsDarkMode)&&(a=Oe(o.data.providerConfigsDarkMode,e))}return a},Ee=r(17991),Ie=r.n(Ee);const Te="data:",xe="blob:";function Re(e,t,r){const n=e.querySelectorAll('img:not([src^="cid:"])');if(n)for(let e=0;e<n.length;e++)0!==n[e].src.indexOf(Te)&&0!==n[e].src.indexOf(xe)&&Me(n[e],t.mailboxSmtpAddress,r)}async function Me(e,t,r){try{const n=e.src,a=`${T()}/${t}/th?u=${encodeURIComponent(n)}`;e.src=y,e.setAttribute("originalSrc",n),e.classList.add(Ie.a.imagePlaceholder);const o=await async function(e,t,r){return new Promise(async(n,a)=>{const o=await Object(f.b)();if(o){const i=new XMLHttpRequest;i.open("GET",e),i.responseType="blob",i.setRequestHeader("Authorization",`Bearer ${o}`),i.setRequestHeader("X-RoutingParameter-SessionKey",t),i.setRequestHeader("X-AnchorMailbox",t),r&&i.setRequestHeader("X-OriginatorId",r),i.onreadystatechange=function(){if(4===i.readyState)try{let e=function(e){try{if(200==e.status){const t=e.response,r=e.getResponseHeader("Content-Type");if(r&&0===r.toLowerCase().indexOf("image")&&t instanceof Blob)return URL.createObjectURL(t)}}catch(e){throw e}return null}(i);n(e)}catch(e){a(e)}},i.send()}else a(new Error("token not generated"))})}(a,t,r);e.src=o,e.classList.remove(Ie.a.imagePlaceholder)}catch(e){a.h.warn("[ActionableMessageDebug] fixSrcForExternalImage: Error setting src value. Exception: "+e.message)}}var Pe=e=>{return["https://outlook.office365.com","https://outlook.office.com","https://outlook-sdf.office.com","https://outlook-sdf.office365.com","https://emea.mail.microsoft.com","https://outlook-sdf.live.com","https://outlook.live.com"].includes(e)};var _e=e=>{var t,r;const n=T(),a="UserMailbox"!==(null===(t=e.mailboxInfo)||void 0===t?void 0:t.type)?null===(r=e.mailboxInfo)||void 0===r?void 0:r.mailboxSmtpAddress:"userid",o=e.odataItemId;return Object(g.c)("{0}/{1}/messages/{2}/adaptiveCardV2/action",n,a,o)};var De=()=>{var e,t,r;let n=null;return(null===(r=null===(t=null===(e=l.cache.data)||void 0===e?void 0:e.clientTimeouts)||void 0===t?void 0:t.default)||void 0===r?void 0:r.SnackBarTimeoutInMsec)&&(n=l.cache.data.clientTimeouts.default.SnackBarTimeoutInMsec),null!==n?n:8e3};var Le=()=>{var e,t,r;let n=null;return(null===(r=null===(t=null===(e=l.cache.data)||void 0===e?void 0:e.clientTimeoutsACv2)||void 0===t?void 0:t.default)||void 0===r?void 0:r.SnackBarTimeoutInMsec)&&(n=l.cache.data.clientTimeoutsACv2.default.SnackBarTimeoutInMsec),null!==n?n:8e3};var Ue=()=>{var e,t;let r=null;return(null===(t=null===(e=l.cache.data)||void 0===e?void 0:e.clientTimeoutsACv2)||void 0===t?void 0:t.default)&&(r=l.cache.data.clientTimeoutsACv2.default),r};r.d(t,"b",(function(){return He})),r.d(t,"d",(function(){return we})),r.d(t,"l",(function(){return je})),r.d(t,"f",(function(){return Re})),r.d(t,"m",(function(){return Pe})),r.d(t,"h",(function(){return _e})),r.d(t,"e",(function(){return ae})),r.d(t,"c",(function(){return ne})),r.d(t,"i",(function(){return De})),r.d(t,"k",(function(){return Le})),r.d(t,"j",(function(){return Ue})),r.d(t,"g",(function(){return T})),r.d(t,"a",(function(){return y}));const He={registerActions:function(){o.AdaptiveCard.actionTypeRegistry.unregisterType(o.SubmitAction.JsonTypeName),o.AdaptiveCard.actionTypeRegistry.registerType(o.HttpAction.JsonTypeName,()=>new i(!1))},executeAction:function(e,t,r,o,s,c,d){return e instanceof i&&(x(e,r,t,s,d).then(r=>{a.h.info("[ActionableMessageDebug] onExecuteAction: executeHttpAction response: "+r),Object(n.k)("rp-actionableMessagesFailDebug")&&d&&z(r,e,t,s),o(r)}),!0)},parseLegacyMessageCardAction:function(e,t){switch(e["@type"]){case"HttpPOST":return $(e)}return null},processAutoInvokeAction:function(e,t){if(e.type===o.HttpAction.JsonTypeName||e["@type"]===B){let r;return t.isAdaptiveCard?(r=new i(!1),r.parse(e),r.hideCardOnInvoke=e.hideCardOnInvoke):r=$(e),r}return null},registerHostCapabilities:function(e){Object(n.k)("rp-actionableMessages-aad-token")&&!Object(F.a)()&&(e.AADAuthentication="*")}}},7869:function(e){e.exports=JSON.parse('{"a":"QTb"}')},9704:function(e){e.exports=JSON.parse('{"a":"PTb"}')}}]);
//# sourceMappingURL=owa.216.js.map
self.scriptsLoaded['owa.216.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.216.js'] = (new Date()).getTime();