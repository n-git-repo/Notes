self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.707.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[707,2148],{124:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var i=n(46);function r(){let e=Object(i.b)(),t=e.origin;return t||(t=e.protocol+"//"+e.hostname+(e.port?":"+e.port:"")),t}function o(){return r()+"/"}},141:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));let i={};function r(e){i=e}function o(){return i}},1521:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));class i{constructor(){this.eventDictionary={}}on(e,t,n){return(this.eventDictionary[e]||(this.eventDictionary[e]=[])).push({callback:t,callbackThis:n}),this}emit(e,...t){return(this.eventDictionary[e]||[]).slice().forEach(e=>e.callback.apply(e.callbackThis,t)),this}off(e,t){let n=this.eventDictionary[e];if(n){let i=n.filter(e=>e.callback!==t);i.length?this.eventDictionary[e]=i:delete this.eventDictionary[e]}return this}once(e,t,n){const i=this,r=(...o)=>(i.off(e,r),t.apply(n,o));return(this.eventDictionary[e]||(this.eventDictionary[e]=[])).push({callback:r,callbackThis:n}),this}}},154:function(e,t,n){"use strict";var i=n(3);const r={showOwaBranding:{default:!0,native:!1},includePartnerIn3SRequest:{default:!1},loadThemeFromHostApp:{default:!1,opx:!0},loadCultureFromHostApp:{default:!1,opx:!0},opxDeeplink:{default:!1,opx:!0},authRedirectOnSessionTimeout:{default:!0,native:!1,opx:!1},opxComponentLifecycle:{default:!1,native:!1,opx:!0},navigateToView:{default:!1,opx:!0},readingPaneModal:{default:!0,teams:!1},readingPaneHeaderTitleAndJoinLink:{default:!0,teams:!1},composeFormSaveCloseHandlers:{default:!1,teams:!0},opxServiceWorker:{default:!1,opx:!0},routeOptionsStaticUrl:{default:!1,opx:!0},scenarioData:{default:!1,opx:!0},teamsChannelOptions:{default:!1,teams:!0},macA11y:{default:!1,macoutlook:!0},teamsCalendarPicker:{default:!1,teams:!0},joinTeamsMeeting:{default:!1,hub:!0,opx:!0},calendarPaneHeaderWeather:{default:!0,teams:!1},use3SPeopleSuggestions:{default:!0,macoutlook:!1},defaultCalendarColor:{default:!1,opx:!0},roomAddedHandler:{default:!1,opx:!0},roomFinderFreeBusyStyles:{default:!1,macoutlook:!0,outlookdesktop:!0},defaultSelectCalendarItemSvg:{default:!0,opx:!1},opxInboxRules:{default:!1,opx:!0},moduleNameFromWindow:{default:!0,opx:!1},showArchiveUnreadCount:{default:!1,native:!0},headerFeedback:{default:!0,opx:!1},ribbonFeedback:{default:!1,hub:!0},composeFrom:{default:!1,opx:!0},groupDiscoverCloseButton:{default:!1,opx:!0},updateModalProps:{default:!1,opx:!0},modalOpenedHandler:{default:!1,opx:!0},fullscreenComposeFormPopOut:{default:!1,teams:!0},defaultOutlookThemeColor:{default:!0,opx:!1},yammerDailyDigest:{default:!1,outlookdesktop:!0},yammerDirectFollower:{default:!1,outlookdesktop:!0},yammerDiscovery:{default:!1,outlookdesktop:!0},yammerHostClientType:{default:!1,native:!0,opx:!0},linkClicked:{default:!1,outlookdesktop:!0},showMinimumThreeInsights:{default:!1,opx:!0},groupCreatedHandler:{default:!1,opx:!0},groupDeletedHandler:{default:!1,opx:!0},updateSearchAnswerOnQueryChange:{default:!1,opx:!0},insightsCountUpdatedHandler:{default:!1,opx:!0},processMeetingInsightsHandler:{default:!1,opx:!0},processEmptyYammerPublishersHandler:{default:!1,opx:!0},focusZoneCicularNavigation:{default:!1,opx:!0},componentTokenProvider:{default:!1,opx:!0,native:!0,hub:!0},hideCalendarModuleContent:{default:!1,teams:!0},hideCalendarLeftNav:{default:!1,teamshub:!0},hideAppSuiteHeader:{default:!1,hub:!0},metaOSTest:{default:!1,hub:!0},hideOfficeRail:{default:!1,hub:!0},openMailInHub:{default:!1,win32outlookhub:!0},openComposeMailInHub:{default:!1,win32outlookhub:!0},fullComposeFormModal:{default:!0,teams:!1},renderCalendarHeader:{default:!0,teams:!1},weekWeatherIcon:{default:!0,teams:!1},surfacePLTDataPoint:{default:!1,teams:!0},schedulingAssistant:{default:!0,teams:!1},composeFormHeader:{default:!0,teams:!1},saveInFullCompose:{default:!0,teams:!1},discardInFullCompose:{default:!0,teams:!1},addIns:{default:!0,teams:!1},settings:{default:!0,teams:!1},multiAccounts:{default:!0,teams:!1,outlookdesktop:!1,widget:!1,native:!1,hub:!1},accountSettingsHx:{default:!1,native:!0},nativeDiagnostics:{default:!1,native:!0},nativeQsp:{default:!1,native:!0},moduleSwitch:{default:!1,native:!0},diagInAppSupport:{default:!1,native:!0},diagFeedbackJs:{default:!1,native:!0},diagFeedbackEmailGroup:{default:!1,native:!0},diagFeedbackNoAttachSR:{default:!1,native:!0},diagFeatureCrew:{default:!1,native:!0},diagThrottleFeedbackEmail:{default:!1,native:!0},diagToggleFeedback:{default:!1,native:!0},newOutlookToggle:{default:!1,native:!0},folderHierarchyHx:{default:!1,native:!0},monarchErrorMessage:{default:!1,native:!0},noteFeedSidePanel:{default:!0,native:!1},whatsNew:{default:!0,native:!1},owaBrandingCharm:{default:!0,native:!1},appLauncher:{default:!0,native:!1},incorrectNativeEntryPoint:{default:!1,native:!0},metaOSFeedback:{default:!1,hub:!0},monarchFeedback:{default:!1,native:!0},native:{default:!1,native:!0},nativeResolvers:{default:!1,native:!0},managedQueryLink:{default:!1,native:!0},wrongIndex:{default:!1,native:!0},outlookSuiteHeaderStrategy:{default:!1,native:!0},calendarRibbon:{default:!1,native:!0},mailRibbon:{default:!1,native:!0},pauseInbox:{default:!0,native:!1},hxVersionQueryStringParam:{default:!1,native:!0},nativeServiceWorker:{default:!1,native:!0},nativeHostAttachmentHijack:{default:!1,native:!0},useNativeConversationOptions:{default:!1,native:!0},reboot:{default:!1,native:!0},calendarFolderHx:{default:!1,native:!0},skipAwaitLpcConfig:{default:!1,opx:!0},workloadScenarioSettings:{default:!0,opx:!1},ribbonDefaultToSLR:{default:!1,native:!0},ribbonPersistDefault:{default:!1,native:!0},updateHostAppIcon:{default:!1,native:!0},projectionCustomTitlebar:{default:!1,native:!0},monarchDensity:{default:!1,native:!0},toDoNewTab:{default:!1,native:!0},reduceCalBarExp:{default:!0,native:!1,opx:!1},floodgate:{default:!0,opx:!1},meControlAccountSwitching:{default:!0,native:!1},smimeExtension:{default:!0,native:!1},platformAppSdk:{default:!1,hub:!0},resourceTokenFromHost:{default:!1,native:!0,opx:!0},useBaseTheme:{default:!1,win32outlookhub:!0,hub:!1},acctmonaccounts:{default:!1,native:!0},showOWAMailtoBanner:{default:!0,native:!1},copyLinkUsingClipboardApi:{default:!1,native:!0},outlookDesktopToMonarchPreferenceMigration:{default:!1,native:!0},disableServiceWorker:{default:!1,native:!0},nativeMessaging:{default:!1,native:!0,widget:!0},disableAppModuleKeys:{default:!1,hub:!0},nativeReactions:{default:!1,native:!0},promptRebootNativeHost:{default:!1,native:!0},openNewEventInNewWindow:{default:!1,native:!0}};var o=n(170),a=n(160);const u=e=>{const t=(e=>r[e])(e);if(t){if(Object(o.a)()&&i.e in t)return t[i.e];if(Object(a.b)()&&i.h in t)return t[i.h];let e=Object(i.A)();if(e&&e in t)return t[e];if(e&&(e===i.i||e===i.k)&&i.b in t)return t[i.b];const n=Object(i.E)();return n&&n in t?t[n]:n&&(n===i.g||n===i.d||n===i.c||n===i.a||n===i.h||n===i.f||n===i.j)&&"opx"in t?t.opx:t.default}return!1};n.d(t,"a",(function(){return u}))},159:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));const i=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function r(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function o(){return r()+r()+"-"+r()+"-"+r()+"-"+r()+"-"+r()+r()+r()}function a(e){return i.test(e)}},160:function(e,t,n){"use strict";var i=n(162),r=n(3),o=n(14),a=n(7);function u(){return!!Object(a.f)("hostApp",Object(o.a)().location)&&Object(a.c)("hostApp").toLowerCase()==r.h}n.d(t,"a",(function(){return i.a})),n.d(t,"c",(function(){return i.b})),n.d(t,"b",(function(){return u}))},162:function(e,t,n){"use strict";let i;function r(){if(!i)throw new Error("OpxHostApi has not been initialized yet.");return i}function o(){return!!i}function a(e){i=e}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a}))},167:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return s}));var i=n(433),r=n(558),o=n(557),a=n(395),u=n(12);function c(e){return e||(e=Object(u.a)().timezone),e?Object(i.a)({RequestServerVersion:"V2018_01_08",TimeZoneContext:Object(r.a)({TimeZoneDefinition:Object(o.a)({Id:e})})}):Object(i.a)({RequestServerVersion:"V2018_01_08"})}function s(e,t,n){return Object(a.a)({PropertySetId:e,PropertyName:t,PropertyType:n})}},180:function(e,t,n){"use strict";var i=n(22);let r;function o(){return null==r&&(r="undefined"!=typeof window&&null!=window.performance&&null!=window.performance.timing&&null!=window.performance.navigation&&null!=window.performance.getEntriesByName),r}const a=500,u=[],c=[],s=[],l=[];let f,d=!0;function p(e,t){Object(i.g)((e,t,n)=>{d&&(t==i.b.Error&&c.push({message:e,error:n}),u.push({message:e,level:t}))}),e(h),t(h),o()&&(window.performance.setResourceTimingBufferSize?window.performance.setResourceTimingBufferSize(a):window.performance.webkitSetResourceTimingBufferSize&&window.performance.webkitSetResourceTimingBufferSize(a))}function b(e,t,n){f?f(e,t,n):l.push({name:e,customData:t})}function m(e){return f=e,d=!1,{traces:u,errors:c,network:s,usage:l}}function h(){d&&s.push(arguments)}n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return m})),n.d(t,"d",(function(){return b})),n.d(t,"c",(function(){return o}))},181:function(e,t,n){"use strict";function i(){var e=Object.create(null),t=0,n=0,i=0,r=!1;function o(t){i--,delete e[t]}this.put=function(t,n,r,a){if(void 0!==r&&("number"!=typeof r||isNaN(r)||r<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==a&&"function"!=typeof a)throw new Error("Cache timeout callback must be a function");var u=e[t];u?clearTimeout(u.timeout):i++;var c={value:n,expire:r+Date.now()};return isNaN(c.expire)||(c.timeout=setTimeout(function(){o(t),a&&a(t,n)}.bind(this),r)),e[t]=c,n},this.del=function(t){var n=!0,i=e[t];return i?(clearTimeout(i.timeout),!isNaN(i.expire)&&i.expire<Date.now()&&(n=!1)):n=!1,n&&o(t),n},this.clear=function(){for(var o in e)clearTimeout(e[o].timeout);i=0,e=Object.create(null),r&&(t=0,n=0)},this.get=function(o){var a=e[o];if(void 0!==a){if(isNaN(a.expire)||a.expire>=Date.now())return r&&t++,a.value;r&&n++,i--,delete e[o]}else r&&n++;return null},this.size=function(){return i},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){r=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var i=e[n];t[n]={value:i.value,expire:i.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var i=JSON.parse(t),r=Date.now(),o=n&&n.skipDuplicates;for(var a in i)if(i.hasOwnProperty(a)){if(o)if(e[a])continue;var u=i[a],c=u.expire-r;if(c<=0){this.del(a);continue}c=c>0?c:void 0,this.put(a,u.value,c)}return this.size()}}e.exports=new i,e.exports.Cache=i},184:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return s}));var i=n(309),r=n(11),o=n(141);const a="featureOverrides";function u(){const e=Object(r.a)(self,a);return e?Object(i.a)(e):{}}function c(){Object(r.d)(self,a)}function s(e){const t=Object(r.a)(self,a);let n=t?t.split(","):[];for(const t of e){const e=t.name.toLowerCase(),i=t.isEnabled?e:`-${e}`,r=Object(o.a)()[e],a=t.isEnabled===!r,u=new RegExp(`^-?${e}$`,"i");n=n.filter(e=>!u.test(e)),a&&n.push(i)}Object(r.e)(self,a,n.join(","))}},19753:function(e,t,n){"use strict";n.r(t);let i=[],r=!1;const o=()=>i,a=e=>i.push(e),u=()=>i=[],c=e=>r=e,s=()=>r;var l=n(1521);var f={ChannelData:"ChannelData",SubscriptionAdded:"SubscriptionAdded",SubscriptionRemoved:"SubscriptionRemoved",SubscriptionUpdated:"SubscriptionUpdated",NotificationData:"NotificationData",TraceWarn:"TraceWarn",TraceError:"TraceError"};let d,p;function b(){return d||(d=new l.a),d}function m(e){b().emit(f.ChannelData,e)}function h(e){b().emit(f.TraceWarn,e)}let v=!1;function g(){return v||j(),Object.keys(p).map(e=>p[e].refs[0].subscription)}function w(e){return v||j(),O(e)?p[e].refs:[]}function k(e){return p[e]}function O(e){return e in p}function j(){p={},v=!0}function y(e){try{e()}catch(e){t=e,b().emit(f.TraceError,t)}var t}var T=n(35);function C(e){return Object.assign({__type:"SubscriptionData:#Exchange"},e)}function x(e,t){var n;if(void 0===e.request||e.request.__type||(e.request=(n=e.request,Object.assign({__type:"NotificationSubscribeJsonRequest:#Exchange"},n))),void 0!==e.subscriptionData)for(var i=0;i<e.subscriptionData.length;i++)void 0===e.subscriptionData[i]||e.subscriptionData[i].__type||(e.subscriptionData[i]=C(e.subscriptionData[i]));return Object(T.a)("SubscribeToNotification",e,t)}var R=n(167);const S="Reload";function I(e){b().emit(f.NotificationData,e);let t=w(e.id).map(e=>e.callback);for(let n of t)y(()=>{n(e)})}function D(e){return{id:e,EventType:S}}function N(){let e=g();for(let t of e){I(D(t.subscriptionId))}}const E=3,A=8,F=3e5,M=500;async function H(e){e.requiresExplicitSubscribe&&(O(e.subscriptionId)||(b().emit(f.SubscriptionRemoved,e),await async function(e){try{await function(e,t){if(void 0!==e.subscriptionData)for(var n=0;n<e.subscriptionData.length;n++)void 0===e.subscriptionData[n]||e.subscriptionData[n].__type||(e.subscriptionData[n]=C(e.subscriptionData[n]));return Object(T.a)("UnsubscribeToNotification",e,t)}({subscriptionData:[{SubscriptionId:e.subscriptionId,Parameters:e.subscriptionParameters}]})}catch(e){h(`Subscription unsubscribe failed: ${e.message}`)}}(e)))}function P(e){let t=k(e.subscriptionId);0!==t.pendingRetryHandle&&(window.clearTimeout(t.pendingRetryHandle),t.pendingRetryHandle=0),t.status=2,z(e,t),a(e),s()||(window.setTimeout(async()=>{let e=o();u(),c(!1),await async function(e){try{let t=await x({request:{Header:Object(R.b)()},subscriptionData:e.map(e=>({SubscriptionId:e.subscriptionId,Parameters:e.subscriptionParameters}))});_(e,(e,n)=>{let i=t.filter(e=>e.SubscriptionId===n.subscriptionId);0!==i.length?function(e,t,n){if(e.SuccessfullyCreated){if(n.retries>0){let e=w(t.subscriptionId);for(let t=0;t<e.length;t++){let n=e[t];n.subscription.onReconnected&&y(n.subscription.onReconnected)}}n.retries=0,n.pendingRetryHandle=0,n.status=3,z(t,n,"")}else L(t,n,e.ErrorInfo)}(i[0],n,e):U(n,e,new Error(`${n.subscriptionId} not in subscription responses`))})}catch(t){_(e,(e,n)=>{U(n,e,t)})}}(e)},M),c(!0))}function U(e,t,n){L(e,t,n.message)}function L(e,t,n){if(function(e){let t=D(e),n=w(e);for(let e of n)!0!==e.subscription.noSubscriptionFailureReload&&y(()=>{e.callback(t)})}(e.subscriptionId),0===t.retries){let t=w(e.subscriptionId);for(let e=0;e<t.length;e++){let i=t[e];i.subscription.onDisconnected&&y(()=>{i.subscription.onDisconnected(n)})}}t.retries+=1,t.status=1,t.retries<E?P(e):t.retries<A&&(t.pendingRetryHandle=window.setTimeout(()=>{t.pendingRetryHandle=0,P(e)},F)),z(e,t,n)}function _(e,t){e.map(e=>{let n=k(e.subscriptionId);n&&t(n,e)})}function z(e,t,n){b().emit(f.SubscriptionUpdated,e,t,n)}var q=n(25),W=n(68);function B(e,t){!function(e,t){v||j(),O(e.subscriptionId)||(p[e.subscriptionId]={refs:[],status:0,retries:0,pendingRetryHandle:0}),p[e.subscriptionId].refs.push({subscription:e,callback:t})}(e,t),function(e){if(!e.requiresExplicitSubscribe)return;let t=k(e.subscriptionId);0===t.status?(b().emit(f.SubscriptionAdded,e),P(e)):z(e,t)}(e),Object(q.k)("auth-signalrChannelLogging")&&Object(W.p)("SignalRNotification",{SubscriptionId:e.subscriptionId,Action:"Subscribe"})}function J(e,t){!function(e,t){if(!O(e.subscriptionId))return void h(`Tried to remove ${e.subscriptionId} from the subscription tracker when it didn't exist`);let n=p[e.subscriptionId].refs;for(let e=0;e<n.length;e++)if(n[e].callback===t){n.splice(e,1);break}0===n.length&&(0!==p[e.subscriptionId].pendingRetryHandle&&window.clearTimeout(p[e.subscriptionId].pendingRetryHandle),delete p[e.subscriptionId])}(e,t),H(e),Object(q.k)("auth-signalrChannelLogging")&&Object(W.p)("SignalRNotification",{SubscriptionId:e.subscriptionId,Action:"Unsubscribe"})}var V=n(159);let Q,Z,K;const Y=()=>(Q||(Q=Object(V.a)()),Q),G=()=>{void 0===Z&&(Z=new Promise(e=>{K=e}))},X=()=>(G(),Z),ee=()=>{G(),K()};var te=n(69);function ne(e,t){var n;return void 0===e||e.__type||(n=e,e=Object.assign({__type:"ChannelRoundTripNotificationRequest:#Exchange"},n)),Object(T.a)("SendChannelRoundTripNotification",e,t)}const ie=-1,re=6e4,oe=3e5,ae=9e5;let ue,ce=!1,se=ie,le=ie;function fe(){if(!Object(q.k)("auth-SignalRActivityTimer"))return;le!==ie&&window.clearTimeout(le),se!==ie&&window.clearTimeout(se);let e=Math.floor(Math.random()*(ae-oe+1)+oe);le=window.setInterval(be,e)}function de(){le!==ie&&window.clearTimeout(le),se!==ie&&window.clearTimeout(se)}function pe(){ue()}function be(){m("Channel inactive, starting liveness round-trip check"),ne({}),se=window.setTimeout(pe,re)}function me(){m("Received liveness round-trip payload, channel still live"),window.clearTimeout(se),fe()}var he=n(154);let ve,ge,we,ke;const Oe="pg",je="ReloadAllNotification",ye=-1,Te=6e4,Ce=3e4;function xe(){ve.qs=Object.assign({UA:"0",cid:we.channelId,"X-OWA-CANARY":Object(te.a)(),app:ke.appName},ke.getNotificationToken&&{access_token:Ue()})}function Re(){we.giveUpReconnecting=!1,we.reconnectScheduled=!1,ve.start(ge)}function Se(e){fe();let t=e;for(let e of t)e.id===Oe?Ie(e):e.id===je?(N(),m("reload all"),we.mark++):(I(e),we.mark++)}function Ie(e){switch("update"!==e.data&&m(e.data),e.data){case"alive1":!function(e){2===we.state&&m("alive1 when channel was already ready");m(`channel ids: local ${we.channelId} server ${e.cid}`),m(`client mark: ${we.mark}, server mark: ${e.mark}`),we.channelId=e.cid,we.state=2,xe(),De(e),we.mark=0,ee()}(e);break;case"reinitSubscriptions":g().map(e=>{P(e)}),m("reinit subscriptions");break;case"validateSubscriptions":m(`validate subscriptions:${function(e){let t=[];if(null!=e){let n={};for(let t=0;t<e.length;++t)null!=e[t]&&(n[e[t]]=!0);let i=g();for(let e=0;e<i.length;++e){3!=k(i[e].subscriptionId).status||n[i[e].subscriptionId]||(t.push(i[e].subscriptionId),P(i[e]))}}return t}(e.subscriptionIds).join("|")}`);break;case"update":De(e);break;case"backendConnectionDropped":Ee(),we.reconnectTimeout=ke.backoffMaximum,Me("ChannelReconnectConnectionDropped",Te),m("backend connection dropped");break;case"diagnostic":m(`diagnostic: ${e.message}`)}}function De(e){e.mark!==we.mark&&(m(`mark mismatch local: ${we.mark}, server: ${e.mark}`),N(),we.mark=e.mark)}function Ne(e){de(),e.context&&(401===e.context.status||440===e.context.status?(m("session timed out"),we.giveUpReconnecting=!0,ke.handleSessionTimeout&&ke.handleSessionTimeout(),Object(he.a)("componentTokenProvider")&&(we.giveUpReconnecting=!1,xe())):449===e.context.status&&(m("Canary cookie expiration"),xe()))}function Ee(){we?(m("connection stopped"),de(),we.state=3,we.giveUpReconnecting=!0,ve.stop()):m("attempting to stop connection before initialization")}function Ae(e=!1){de(),1==we.state?we.state=0:2!=we.state&&4!=we.state||(we.state=3),e&&(we.reconnectTimeout=Math.abs(ke.minimumReconnectInterval)),!0!==we.giveUpReconnecting&&Me("ChannelReconnectConnectionDisconnected",e?0:Ce)}function Fe(e){switch(e.newState){case 1:0===we.state?(we.state=1,m("channel initialized")):3===we.state&&(we.state=4,m("channel reconnecting")),we.reconnectTimeout=Math.abs(ke.minimumReconnectInterval),we.checkReadyTimer=window.setTimeout(He,ke.readyCheckTimeout);break;case 4:case 2:de(),1===we.state?(we.state=0,m("channel uninitialized")):2===we.state&&(we.state=4,m("channel reconnecting")),we.checkReadyTimer!==ye&&(window.clearTimeout(we.checkReadyTimer),we.checkReadyTimer=ye)}}function Me(e,t){let n=Math.abs(we.reconnectTimeout);n+=Math.floor(Math.random()*t),m(`retrying connection with backoff ${n}`),Object(q.k)("auth-notificationChannelTelemetry")&&Object(W.p)(e,{domain:window.location.hostname,delay:n},{isCore:!0}),window.setTimeout(Re,n),we.reconnectTimeout=Math.min(2*Math.abs(we.reconnectTimeout),Math.abs(ke.backoffMaximum)),we.reconnectScheduled=!0}function He(){2!==we.state&&(m("ready check timer expired"),Ee(),Me("ChannelReconnectNotReady",0))}function Pe(){N(),Object(W.p)("ChannelLivenessFailure",{domain:window.location.hostname},{isCore:!0}),m("restarting channel due to liveness check failure"),Ee(),Re(),fe()}function Ue(){let[e]=ke.getNotificationToken();return e}async function Le(){let[e,t]=ke.getNotificationToken();return e||(e=await t),e}async function $e(e,t,n,i){ve=e,ge=t,we=n,ke=i,we.channelId=Y(),ve.received(Se),ve.error(Ne),ve.disconnected(Ae),ve.stateChanged(Fe),await async function(){ve.qs=Object.assign({UA:"0",cid:we.channelId,"X-OWA-CANARY":Object(te.a)(),app:ke.appName},ke.getNotificationToken&&{access_token:await Le()})}();let r=ve.stop.bind(ve);var o;ve.stop=(e,t)=>{r(!0,t)},o=Pe,ce||(ce=!0,ue=o,B({subscriptionId:"RoundTrip",requiresExplicitSubscribe:!1,subscriptionParameters:{},noSubscriptionFailureReload:!0},me)),$.signalR.ajaxDefaults.timeout=6e4,$.signalR.transports.serverSentEvents.timeOut=6e4,Object(q.k)("auth-notificationChannelTelemetry")&&Object(W.p)("ChannelInitialization",{domain:window.location.hostname},{isCore:!0}),Re()}var _e=n(398),ze=n(483),qe=n(3);async function We(e){window.owaLogSignalRError=(e,t)=>{Object(q.k)("auth-reportSignalRError")&&Object(W.p)("ChannelInitNetworkFailure",t,{isCore:!0})};const t=(await n.e(2131).then(n.t.bind(null,19536,7))).default;window.$=t,window.jQuery=t,await n.e(2191).then(n.bind(null,19537)),Object(he.a)("componentTokenProvider")&&null==e.getNotificationToken&&(e.getNotificationToken=Je),null==e.appName&&(e.appName=Object(qe.m)());let i={state:0,channelId:null,mark:0,reconnectTimeout:e.minimumReconnectInterval,reconnectScheduled:!1,giveUpReconnecting:!1,checkReadyTimer:-1,notificationInactivityTimer:-1},r=$.signalR.transports._logic.getUrl;$.signalR.transports._logic.getUrl=(e,t,n,i,o)=>(e.appRelativeUrl=e.url,r(e,t,n,i,o)),$e($.connection(e.channelEndpoint),{transport:[$.signalR.transports.serverSentEvents.name,$.signalR.transports.foreverFrame.name],pingInterval:e.pingInterval},i,e)}function Be(){we&&(we.giveUpReconnecting=!1,we.reconnectScheduled=!1,Ae(!0))}function Je(){return Object(_e.getAccessTokenforResourceAsLazy)(Object(ze.n)()+Object(ze.t)("/owa")+"/notificationchannel/","OwaNotifications")}function Ve(){window.owaNotification={subscribe:B,unsubscribe:J,getChannelId:Y},window.dispatchEvent(new Event("owaNotificationLoaded"))}n.d(t,"setup",(function(){return Ve})),n.d(t,"subscribe",(function(){return B})),n.d(t,"unsubscribe",(function(){return J})),n.d(t,"getChannelId",(function(){return Y})),n.d(t,"getChannelReady",(function(){return X})),n.d(t,"NotificationEventType",(function(){return f})),n.d(t,"initializeNotificationManager",(function(){return We})),n.d(t,"retryDisconnectionWithMinimumReconnectInterval",(function(){return Be})),n.d(t,"getNotificationEmitter",(function(){return b})),n.d(t,"handleNotification",(function(){return I})),n.d(t,"stopConnection",(function(){return Ee}))},212:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(86),r=n(308),o=n(22);function a(e,t){if(!Object(r.a)()){if(t)return!1;o.d(`Attempted to read ${e} before feature flags were initialized.`)}return Object(i.a)().featureFlags.get(e.toLowerCase())||!1}},24:function(e,t,n){"use strict";n.d(t,"i",(function(){return i})),n.d(t,"e",(function(){return r})),n.d(t,"f",(function(){return o})),n.d(t,"g",(function(){return a})),n.d(t,"h",(function(){return u})),n.d(t,"l",(function(){return c})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"j",(function(){return f})),n.d(t,"c",(function(){return d})),n.d(t,"k",(function(){return p})),n.d(t,"d",(function(){return b}));const i=6048e5,r=864e5,o=36e5,a=6e4,u=1e3,c=12,s=30,l=365,f=-864e13,d=864e13,p=Date.UTC(1601,0,1),b=Date.UTC(4501,0,1)},244:function(e,t,n){"use strict";t.decode=t.parse=n(492),t.encode=t.stringify=n(493)},246:function(e,t,n){"use strict";var i=n(24);t.a=(e,t)=>new Date(+e+t*i.g)},25:function(e,t,n){"use strict";var i=n(86),r=n(2);var o=Object(r.action)("UPDATE_ACTIVE_FLIGHTS",e=>({featureOverrides:e}));function a(e){if(!e)return[];let t=[];return["addin","an","auth","cal","cmp","doc","eventify","fms","fwk","getstarted","grp","gsx","help","honeybee","inline","iris","lightning","lpc","mc","notes","nps","outlookSpaces","spaces","peo","people","mc","platform","rp","sea","sxs","todo","tra","tri","sig","mon","usv","woven"].forEach(n=>{Object.keys(e[n]||{}).forEach(i=>{!0===e[n][i]&&t.push(`${n}-${i}`)})}),t}function u(e){return Object(i.a)().featureFlags.get(e)}Object(r.mutator)(o,e=>{for(const t of e.featureOverrides)Object(i.a)().featureFlags.set(t.name.toLowerCase(),t.isEnabled)});var c=n(13),s=n(212);function l(e,t){if(Object(s.a)(e))t();else{let n=Object(c.autorun)(()=>{Object(s.a)(e)&&(t(),n())})}}var f=n(308),d=n(184);let p=Object(r.action)("setFeatureFlag<T>",(e,t)=>({feature:e,isOn:t}));Object(r.mutator)(p,(function(e){Object(i.a)().featureFlags.set(e.feature.toLowerCase(),e.isOn)})),Object(r.orchestrator)(p,(function(e){let t=e.feature,n=e.isOn;Object(d.c)([{name:t.toLowerCase(),isEnabled:n}])}));var b=p,m=n(141);function h(){const e=Object(m.a)();for(let t of Object(i.a)().featureFlags.keys())b(t,!!e[t]);Object(d.a)()}function v(){return Object.keys(Object(m.a)())}const g="fwk-uberflag",w="fwk-consumer",k="fwk-business";function O(){return T().includes(g)?1:0}function j(e){const t=T();return e&&t.includes(w)&&!t.includes(k)||!e&&t.includes(k)&&!t.includes(w)?1:0}let y;function T(){return y||(y=v().filter(e=>e===g||e===w||e===k)),y}function C(e){const t=Object(i.a)().featureFlags;return[...t.keys()].filter(n=>0==n.indexOf(e)&&t.get(n.toLowerCase()))}n.d(t,"d",(function(){return x})),n.d(t,"c",(function(){return a})),n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return l})),n.d(t,"j",(function(){return f.b})),n.d(t,"k",(function(){return s.a})),n.d(t,"m",(function(){return b})),n.d(t,"l",(function(){return h})),n.d(t,"o",(function(){return d.c})),n.d(t,"n",(function(){return o})),n.d(t,"e",(function(){return v})),n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return j})),n.d(t,"f",(function(){return m.a})),n.d(t,"g",(function(){return C}));let x=Object(i.a)().featureFlags},273:function(e,t,n){"use strict";var i=n(24);t.a=(e,t)=>new Date(+e+t*i.h)},30:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(58);function r(){return i.a.userConfiguration}},308:function(e,t,n){"use strict";var i=n(86),r=n(2),o=n(13),a=n(309),u=n(7);var c=n(133),s=n(212);var l=n(184),f=n(141),d=n(369);n.d(t,"a",(function(){return b}));let p=!1;function b(){return p}const m=Object(r.action)("initializeFeatureFlags",e=>{const t=(e||[]).reduce((e,t)=>(e[t.toLowerCase()]=!0,e),{}),n=function(e=s.a){return e("ring-dogfood")?"Dogfood":e("ring-microsoft")?"Microsoft":e("ring-firstrelease")?"FirstRelease":e("ring-ww")?"WW":"Unknown"}(e=>t[e]);return h(t,function(e){return Object.keys(d.a).reduce((t,n)=>(t[n.toLowerCase()]=d.a[n].ring.indexOf(e)>-1,t),{})}(n)),Object(c.b)(n),Object(f.b)(function(e){let t={};for(let n of Object.keys(e))t[n]=e[n];return t}(t)),"Dogfood"==n&&h(t,Object(l.b)()),t["fwk-devtools"]&&h(t,function(e){for(const[t,n]of Object.entries(Object(u.d)()))if(t.toLowerCase()===e.toLowerCase())return Object(a.a)(n);return{}}("features")),t});function h(e,t){for(let n of Object.keys(t))e[n.toLowerCase()]=t[n]}Object(r.mutator)(m,e=>{Object(i.a)().featureFlags=new o.ObservableMap(e),p=!0});t.b=m},309:function(e,t,n){"use strict";function i(e){let t={};return e.split(",").forEach(e=>{let n=!0;0===e.indexOf("-")&&(n=!1,e=e.slice(1,e.length)),t[e.toLowerCase()]=n}),t}n.d(t,"a",(function(){return i}))},316:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return c}));var i=n(124),r=n(117),o=n(3);let a;function u(e){a=e}async function c(){var e,t;if(Object(o.P)())return r.f.importAndExecute(Object(i.a)());const n=a&&await a();if(n&&n.length>0){if("bearer"===(null===(e=null==n?void 0:n.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return n.split(" ")[1];if("msauth1.0"===(null===(t=null==n?void 0:n.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return n}}},369:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const i={"fwk-betterDiagnostics-panel":{ring:["Dogfood"]},"fwk-betterDiagnostics-service":{ring:["Dogfood"]},"fwk-feedbackCharm":{ring:["Dogfood","Microsoft"]}}},395:function(e,t,n){"use strict";function i(e){return Object.assign({__type:"ExtendedPropertyUri:#Exchange"},e)}n.d(t,"a",(function(){return i}))},430:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(89);function r(e){return Object(i.a)(e,[i.c])}},433:function(e,t,n){"use strict";function i(e){return Object.assign({__type:"JsonRequestHeaders:#Exchange"},e)}n.d(t,"a",(function(){return i}))},462:function(e,t,n){"use strict";class i{constructor(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}add(e){this.taskList.unshift(e),this.scheduleTask()}clear(){this.taskList.splice(0,this.taskList.length)}canRunMoreTasks(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0}scheduleTask(){this.canRunMoreTasks()&&setTimeout(()=>{this.tryRunTask()},this.taskDelay)}onTaskComplete(){this.numberOfTasksRunning--,this.scheduleTask()}tryRunTask(){if(this.canRunMoreTasks()){let e=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(e).then(()=>{this.onTaskComplete()}).catch(()=>{this.onTaskComplete()}),this.scheduleTask()}}}n.d(t,"a",(function(){return i}))},483:function(e,t,n){"use strict";var i=n(430),r=n(36),o=n(89);function a(e){return Object(o.a)(e,[o.b])}var u=n(40),c=n(73);function s(e){return Object(u.b)(Object(u.c)(Object(u.a)(Object(c.a)()||"",e)))}var l=n(600),f=n(763),d=n(223);let p,b,m;function h(){return p||(p=Object(r.a)("/calendar")+"/"),p}function v(){return b||(b=Object(r.a)("/mail")+"/"),b}function g(){return m||(m=Object(r.a)("/files")+"/"),m}var w=n(945);let k,O,j;function y(e){return k&&O===e||(O=e,k=e?Object(r.a)("/people/group/owner")+"/":Object(r.a)("/people/group/member")+"/"),k}function T(){return j||(j=Object(r.a)("/people/group/deleted")+"/"),j}function C(e){return window.location.origin+h()+"showPeek/item/"+encodeURIComponent(e)}var x=n(724),R=n(7),S=n(629);const I=Object(x.a)().split("/").slice(1).join("/")+"deeplink/";function D(e,t,n,i){n&&((i=i||{}).minus="");let r="";if(i){const e=Object(R.d)();Object(S.a)(e),Object.keys(i).filter(e=>e).forEach(t=>e[t]=i[t]),r="?"+Object(R.i)(e)}return`${`/${e}/${I}`}${t}${r}`}var N=n(224),E=n(30);const A="https://to-do.microsoft.com";function F(e,t){var n,i;const r=Object(E.a)(),o=r.UserOptions,a=null===(n=r.SessionSettings)||void 0===n?void 0:n.UserPrincipalName;let u=A,c={};if(null===(i=null==o?void 0:o.ReactOptinSettings)||void 0===i?void 0:i.TasksRedirectUrl){let e="";[u,e]=o.ReactOptinSettings.TasksRedirectUrl.split("?"),c=Object(R.g)(e),a&&(c.auth_upn=a)}return e&&(c.utm_source=e),t&&delete c.fromOwa,Object.keys(c).length>0?Object(d.a)(u,c):u}let M;function H(){return M||(M=Object(r.a)("/eventify")+"?entryPoint=owa"),M}var P=n(124);let U;function L(){return U||(U=Object(r.a)("/host")+"/"),U}n(46);n.d(t,"k",(function(){return i.a})),n.d(t,"t",(function(){return r.a})),n.d(t,"g",(function(){return a})),n.d(t,"m",(function(){return s})),n.d(t,"s",(function(){return l.a})),n.d(t,"x",(function(){return u.a})),n.d(t,"a",(function(){return u.b})),n.d(t,"b",(function(){return u.c})),n.d(t,"o",(function(){return f.a})),n.d(t,"v",(function(){return d.a})),n.d(t,"e",(function(){return h})),n.d(t,"l",(function(){return v})),n.d(t,"h",(function(){return g})),n.d(t,"p",(function(){return w.a})),n.d(t,"j",(function(){return y})),n.d(t,"i",(function(){return T})),n.d(t,"d",(function(){return C})),n.d(t,"q",(function(){return D})),n.d(t,"w",(function(){return N.a})),n.d(t,"u",(function(){return F})),n.d(t,"f",(function(){return H})),n.d(t,"n",(function(){return P.a})),n.d(t,"r",(function(){return c.a})),n.d(t,"c",(function(){return L}))},492:function(e,t,n){"use strict";function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,o){t=t||"&",n=n||"=";var a={};if("string"!=typeof e||0===e.length)return a;var u=/\+/g;e=e.split(t);var c=1e3;o&&"number"==typeof o.maxKeys&&(c=o.maxKeys);var s=e.length;c>0&&s>c&&(s=c);for(var l=0;l<s;++l){var f,d,p,b,m=e[l].replace(u,"%20"),h=m.indexOf(n);h>=0?(f=m.substr(0,h),d=m.substr(h+1)):(f=m,d=""),p=decodeURIComponent(f),b=decodeURIComponent(d),i(a,p)?r(a[p])?a[p].push(b):a[p]=[a[p],b]:a[p]=b}return a};var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},493:function(e,t,n){"use strict";var i=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,u){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?o(a(e),(function(a){var u=encodeURIComponent(i(a))+n;return r(e[a])?o(e[a],(function(e){return u+encodeURIComponent(i(e))})).join(t):u+encodeURIComponent(i(e[a]))})).join(t):u?encodeURIComponent(i(u))+n+encodeURIComponent(i(e)):""};var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function o(e,t){if(e.map)return e.map(t);for(var n=[],i=0;i<e.length;i++)n.push(t(e[i],i));return n}var a=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},557:function(e,t,n){"use strict";function i(e){return Object.assign({__type:"TimeZoneDefinitionType:#Exchange"},e)}n.d(t,"a",(function(){return i}))},558:function(e,t,n){"use strict";function i(e){return Object.assign({__type:"TimeZoneContext:#Exchange"},e)}n.d(t,"a",(function(){return i}))},58:function(e,t,n){"use strict";var i=n(2),r=n(13);const o={userConfiguration:{},connectedAccountsUserConfigurationMap:new r.ObservableMap({}),defaultFolderNameToIdMap:new r.ObservableMap({}),defaultFolderIdToNameMap:new r.ObservableMap({})},a=i.createStore("owaSessionStore",o)();t.a=a},600:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(7),r=n(629);function o(){const e=Object(i.d)();Object(r.a)(e);const t=Object(i.i)(e);return t.length>0?"?"+t:""}},629:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const i=["hostApp","isanonymous","cspoff","frameName","opxInstanceId","hxVersion"];function r(e){e&&Object.keys(e).forEach(t=>{i.includes(t)&&delete e[t]})}},724:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(73),r=n(36);function o(e){return(Object(r.a)("/"+(e||Object(i.a)()))+"/").replace(/^\//,"")}},763:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(46),r=n(36),o=n(124);function a(e){let t=Object(i.b)(),n=Object(o.a)()+Object(r.a)("/owa")+"/",a=t.search&&t.search.length>0;n+=a?t.search:"?";let u=Object.keys(e),c=a;for(let t=0;t<u.length;t++)c?n+="&":c=!0,n+=u[t]+"="+e[u[t]];return n}},86:function(e,t,n){"use strict";var i=n(2);let r={featureFlags:new(n(13).ObservableMap)};t.a=Object(i.createStore)("featureFlags",r)},945:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(36);let r;function o(){return r||(r=Object(i.a)("/people")+"/"),r}}}]);
//# sourceMappingURL=owa.707.js.map
self.scriptsLoaded['owa.707.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.707.js'] = (new Date()).getTime();