self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.994.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[994,2148],{11015:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(2892),r=n(2808);function i(e,t){const n=e[e.length-1],i=t.rowKeys.indexOf(n);i<t.rowKeys.length-1?Object(o.q)(t,t.rowKeys[i+1],!1,r.a.RowRemoval):Object(o.i)(t,r.a.Reset)}},13282:function(e,t,n){"use strict";n.r(t);var o=n(2827),r=n(3046),i=n(3203),a=n(22),s=n(3012);async function c(e,t){const n=t.tableQuery;if(1===n.listViewType){const t={Id:e,mailboxInfo:Object(o.d)(n)};return await i.f.importAndExecute(t,"LoadNudgedItem")}return async function(e,t){const n=t.tableQuery,i=Object(o.d)(n);return r.i.importAndExecute(e,n.folderId,n.sortBy,Object(s.l)(n),n.requestShapeName,i).then(e=>e).catch(e=>(a.h.warn("loadNudgedConversation throws an exception"+e.message),null))}(e,t)}var u=n(25),d=n(220),l=n(398);const f="https://outlook.office.com/FocusedInboxB2",w="https://outlook.office.com/M365.Access";async function b(e,t){const n=await async function(e,t){if(!Object(d.a)()){let[n,o]=Object(l.getAccessTokenforResourceAsLazy)(f,t,e);return n||(n=await o),n}if(Object(u.k)("tri-nudge-consumer"))return Object(l.getDelegationTokenForOwa)(w,t,e);return null}(e,t);if(n){const e=new Headers;return e.authorization=`Bearer ${n}`,e}return null}var m=n(155),I=n(211),g=n(70),O=n(206);function y(e){const t=parseInt(e)||-1;return-1!=t&&Object(O.a)(t)||503==t||-1==t}const N="FocusedInboxB2/api/v1/Nudges/GetNudges",p=1500;function v(e){return async function e(t,n,o){if(n>2)return o;if(y((o=await async function(e){const t=await b(e,"getNudge");if(!t)return{getNudgesResponse:null,errorOrStatus:"Token Failure"};let n;try{n=await Object(m.b)(N,e,!0,t,!0,!1,"GetNudges")}catch(e){return{errorDetails:e.message,errorOrStatus:"RequestNotComplete"}}try{if(Object(I.a)(n.status)){const e=await n.json();if(e.Nudges)return{getNudgesResponse:e,errorOrStatus:n.status};return{errorOrStatus:"No Nudges",errorDetails:await n.text()}}{let e=await n.text();return(null==e?void 0:e.toLowerCase().indexOf("html"))>-1&&(e=""),{errorOrStatus:n.status,errorDetails:e}}}catch(e){return{errorOrStatus:"Parse Error"}}}(t)).errorOrStatus))return await Object(g.a)(p),e(t,n+1,o);return o.retryAttempt=n,o}(e,1,null)}var h=n(2733),j=n(7),R=n(1084);var T=n(5320),S=n(3653),E=n(8673),_=n(11015),C=n(3399),K=n(3441);function L(e,t){const n=t.rowKeys.indexOf(e);if(-1==n)return;const o=h.b.getLastDeliveryOrRenewTimeStamp(e,t);if(!Object(K.a)(e,t.id,o))return;let r=Object(E.a)(o,h.b.getLastDeliveryTimeStamp(e,t),t,n+1);-1==r?Object(S.a)([e],t,"NotNudgeAnymore"):(Object(_.a)([e],t),C.a.updateRowPosition(--r,e,t))}var D=n(68),A=n(20),x=n(159),V=n(3608),M=n(2740),P=n(5);function U(e,t,n){Object(D.p)("Nudge_RowRemove",{owa_1:t,owa_2:n,rKey:e},{isCore:!0})}var k=n(6575),F=n(2751),G=n(154);function B(e){var t;const n=(null!==(t=e.IconIndex)&&void 0!==t?t:"").toString().toLowerCase();return n.indexOf("replied")>-1||n.indexOf("forwarded")>-1}function W(e,t,n,o,r,i,s,c,u,d,l){const f=s?"inbox":"sentitems";Object(D.p)("Nudge_Discarded",{owa_1:e,owa_2:r,owa_3:i,owa_4:f,owa_5:u,rt:c,itemId:t,cId:n,crId:o,nIt:l,lGId:d},{isCore:!0}),a.h.warn("Nudge Discarded - isConversationView: "+r+" itemId: "+t+" conversationId: "+n+" folderId: "+f+" isNudgeFromOtherTable: "+i)}function z(e,t,n,o,r,i,a,s=!0,c,u){let d,l;h.b.getIsPinned(i,o)&&(d="RowPinned");const f=Object(h.R)(o),w=h.b.getLastDeliveryOrRenewTimeStamp(i,o);if(!d&&f){l=h.b.getLatestGlobalItemId(i,o);const t=h.b.getDraftItemIds(i,o);if(i&&-1==t.indexOf(l)&&l!=e){const e=new Date(w),t=new Date(c);d=(r?0==u:1==u)&&e.getTime()<t.getTime()?"ItemNotUpToDate":"NotLatestItemInRow"}}else{const t=Object(M.b)().items.get(e);t&&B(t)&&(d="NotLatestItemInRow")}return d?(s&&W(d,e,t,n,f,!1,r,w,a,l,c),d):null}var Q=n(3);let H,q,J=!1,X={};const Y=36e5,$=18e5,Z=Object(A.e)(k.a,"getNudgesOnNudgeOptionChangeClone",e=>{oe(!0,"SettingChange")}),ee=Object(A.e)(V.a,"clone_onSelectFolderComplete",e=>{const{selectedFolderId:t,previousFolderId:n,isExitingSearch:o}=e;t==n||o||oe(!1,"FolderSwitch")}),te=Object(A.e)(K.i,"clone_getNudgesOnNudgeRemoved",e=>{Object(u.k)("tri-nudgePolling")&&(q=setTimeout(()=>oe(!0,"NudgeRemoval"),9e5))});function ne(e,t){"visible"===document.visibilityState&&oe(e,t)}function oe(e,t){if(J||!Object(T.b)())return;const n=Object(u.k)("tri-nudgePolling");!H&&n&&(H=!0,document.addEventListener("visibilitychange",()=>ne(!1,"VisibilityChange")));const o=Object(h.I)(),r=o.tableQuery.folderId;if(Object(T.a)(r)){if(n){if(!e&&Date.now()-X[r]<=$)return;q&&(clearTimeout(q),q=null),q=setTimeout(()=>ne(!1,"Timer"),Y)}!async function(e,t,n){var o;J=!0;const r=Object(x.a)(),i=Date.now(),c=await v(r),u=[],d=c,l=Date.now()-i;if(null===(o=null==d?void 0:d.getNudgesResponse)||void 0===o?void 0:o.Nudges){const o=d.getNudgesResponse.Nudges;let i=0;const a=[],s=[],c="sentitems"==Object(F.a)(e);for(let d=0;d<o.length;d++){const l=o[d],f=l.FolderId.Id,w=re(l);if(a.push(w),c&&f!=e)continue;const b=await ie(l,t,r,!c,n);b&&(u.push(b),s.push(w)),i++}ae(o.length,i,u.length,n,r,a.join(","),l,s.join(","),d.errorOrStatus,"",d.retryAttempt)}else ae(0,0,0,n,r,"",l,"",d.errorOrStatus,Object(Q.T)(d.errorDetails),d.retryAttempt);const f=Object(j.c)("testOldNudge");if(0!=decodeURIComponent(f||"").trim().length){u.push({rowKey:"testNudgeRowKey",itemId:"getTestNudgeRowDataForRowNotLoadedInTableViewItemId=",conversationId:"getTestNudgeRowDataForRowNotLoadedInTableViewConversationId=",tableViewId:t.id,reason:0,daysAgo:7,nudgeItemTime:"2020-08-31T17:00:00-07:00",entryId:"testEntryId"});const e={ConversationId:{__type:"ItemId:#Exchange",Id:"getTestNudgeRowDataForRowNotLoadedInTableViewConversationId="},ConversationTopic:"This is a test Nudge Email that is older than the loaded rows",UniqueSenders:["Sayali Shah"],LastDeliveryTime:"2019-10-01T15:30:58-07:00",HasAttachments:!1,MessageCount:1,GlobalMessageCount:1,UnreadCount:1,GlobalUnreadCount:1,Size:1234,ItemClasses:["IPM.Note"],Importance:null,ItemIds:[{__type:"ItemId:#Exchange",ChangeKey:"CQAAAA==",Id:"getTestNudgeRowDataForRowNotLoadedInTableViewItemId="}],GlobalItemIds:[{__type:"ItemId:#Exchange",ChangeKey:"CQAAAA==",Id:"getTestNudgeRowDataForRowNotLoadedInTableViewItemId="}],LastModifiedTime:"2019-10-29T15:30:59-07:00",InstanceKey:"testNudgeRowKey",Preview:"Test nudge email for row that is not loaded",HasIrm:!1,IsLocked:!1,FamilyId:{__type:"ItemId:#Exchange",Id:"AAQkAGZjM2NmMGY1LTkzMzgtNGNhMy04ODg5LWQwMjJjMDc0YjJlMAAQAH9+ZbR0rbRFncY81mWHT1E="},LastDeliveryOrRenewTime:"2019-10-01T15:30:58-07:00",HasAttachmentPreviews:!1,LastSender:{Mailbox:{Name:"Sayali Shah",EmailAddress:"sayalis@microsoft.com",RoutingType:"SMTP"}}};if(t.rowKeys.indexOf("testNudgeRowKey")<0){const n=Object(s.f)(t,0);C.a.addRow(n,e,t)}}u.push(...function(e){const t=Object(j.c)("testNudge");if(0==decodeURIComponent(t||"").trim().length)return[];const n=[];if(e.rowKeys.length>0){const t=e.tableQuery.folderId===Object(R.a)("sentitems")?1:0,o={rowKey:e.rowKeys[4],itemId:h.b.getItemIds(e.rowKeys[0],e)[0],conversationId:h.b.getConversationId(e.rowKeys[4],e),tableViewId:e.id,reason:t,daysAgo:1};if(n.push(o),e.rowKeys.length>3){const o={rowKey:e.rowKeys[6],itemId:h.b.getItemIds(e.rowKeys[3],e)[0],conversationId:h.b.getConversationId(e.rowKeys[6],e),tableViewId:e.id,reason:t,daysAgo:0};n.push(o)}if(e.rowKeys.length>10&&1===Math.floor(2*Math.random())){const o={rowKey:e.rowKeys[10],itemId:h.b.getItemIds(e.rowKeys[10],e)[0],conversationId:h.b.getConversationId(e.rowKeys[10],e),tableViewId:e.id,reason:t,daysAgo:3};n.push(o)}}return n}(t)),Object(K.f)().nudgedRows.forEach(e=>{const n=e.rowKey;e.tableViewId!=t.id||u.some(t=>t.rowKey===n&&t.tableViewId===e.tableViewId)||(L(n,t),U(n,"NotReceivedAsNudgeAnyMore",e.reason)),e.tableViewId!=t.id&&u.push(e)}),Object(K.h)(u,t),a.h.info("Nudge: onSelectFolderCompleteOrchestrator new nudges length: "+u.length),J=!1}(r,o,t),X[r]=Date.now()}}function re(e){return Object(u.k)("fwk-immutable-ids")||Object(G.a)("native")?e.ImmutableId.Id:e.ItemId.Id}async function ie(e,t,n,r,u){try{let d,l;const f=re(e),w=e.ConversationId.Id,b=e.NudgeReason.Reason,m=Object(h.R)(t),I=m?w:f,g=Object(h.F)([I],t),O=r?"Sent"==b:"Received"==b,y=function(e){switch(e){case"Received":return 0;case"Sent":return 1;default:return a.h.warn("No nudge reason returned in GetNudge server response"),0}}(e.NudgeReason.Reason);if(0===g.length){const o=await c(I,t);if(l=function(e,t,n,o,r,i,a,s,c,u){var d;let l,f,w;if(e||(l=s?"ItemFromOtherTable":"RowNotFound"),!l){let t;t=r?e.LastDeliveryOrRenewTime:e.ReceivedOrRenewTime,Object(h.x)(t)&&(l="RowPinned")}if(!l)if(r){const n=e;if(w=n.LastDeliveryOrRenewTime,f=n.GlobalItemIds[0].Id,0==(n.DraftItemIds||[]).filter(e=>e.Id==f).length&&f!=t){const e=new Date(w),t=new Date(u);l=e.getTime()<t.getTime()?"ItemNotUpToDate":"NotLatestItemInRow"}}else{const t=e;w=t.ReceivedOrRenewTime,B(t)?l="NotLatestItemInRow":(null===(d=t.ParentFolderId)||void 0===d?void 0:d.Id)!=i.tableQuery.folderId&&(l="ItemFromOtherTable")}return l?(W(l,t,n,o,r,s,a,w,c,f,u),l):null}(o,f,w,n,m,t,r,O,u,e.MessageReceivedOrSentTimeUTC),d=null==o?void 0:o.InstanceKey,!l&&t.rowKeys.indexOf(d)<0){const e=Object(s.f)(t,0);C.a.addRow(e,o,t)}}else l=z(f,w,n,t,r,g[0],u,!0,e.MessageReceivedOrSentTimeUTC,y),d=g[0];if(!l&&d){!function(e,t){if(1===e.listViewType){const n=Object(M.b)().items.get(t);n&&n.NormalizedBody||i.f.importAndExecute({Id:t,mailboxInfo:Object(o.d)(e)},"LoadNudgedItem")}else Object(M.b)().conversations.get(t)||i.e.importAndExecute({Id:t,mailboxInfo:Object(o.d)(e)},"LoadNudgedConversation")}(t.tableQuery,I);const n=e.MessageReceivedOrSentTimeUTC||h.b.getLastDeliveryTimeStamp(d,t),r=Object(P.s)(Object(P.pc)(),Object(P.pc)(n));return{rowKey:d,itemId:f,conversationId:w,tableViewId:t.id,reason:y,daysAgo:r,nudgeItemTime:e.MessageReceivedOrSentTimeUTC,entryId:e.ItemId.Id}}return null}catch(e){return a.h.warn("Nudge: processNudgeResponse throws an exception"+e.message),null}}function ae(e,t,n,o,r,i,a,s,c,u,d){Object(D.p)("Nudge_GetNudge",{owa_1:e,owa_2:t,owa_3:n,owa_4:o,cId:r,itemId:i,latency:a,validItemId:s,error:null==c?void 0:c.toString(),errorMessage:u,retryAttempt:d})}const se="FocusedInboxB2/api/v1/Nudges/UpdateNudge",ce=1500;function ue(e,t,n,o){const r=Object(x.a)();let i;try{i={ItemId:{Id:e},NudgeAction:t}}catch(e){de(null==i?void 0:i.NudgeAction,n,o,null==i?void 0:i.ItemId.Id,e.message,"RequestPayloadError",null,0,r,i)}return async function e(t,n,o,r,i,a){if(r>3)return;const s=null==t?void 0:t.NudgeAction,c=await async function(e,t){const n=await b(t,"updateNudge");if(!n)return{errorMessage:"Token Failure"};let o;try{o=await Object(m.e)(se,e,t,!0,n,!0,!1,!1,"UpdateNudges",null)}catch(e){return{errorDetails:e.message,errorMessage:"RequestNotComplete"}}try{const e=o.status;if(Object(I.a)(e))return{status:e,errorMessage:"No error",errorDetails:""};let t=await o.text();return(null==t?void 0:t.toLowerCase().indexOf("html"))>-1&&(t=""),{status:e,errorMessage:e,errorDetails:t}}catch(e){return{errorMessage:"Parse Error"}}}(t,a);de(s,n,o,null==t?void 0:t.ItemId.Id,c.errorMessage,c.errorDetails,c.status,r,a,t),y(c.status.toString())&&(await Object(g.a)(i),e(t,n,o,r+1,2*i,a))}(i,n,o,1,ce,r)}function de(e,t,n,o,r,i,a,s,c,u){Object(D.p)("Nudge_Update",{owa_1:e,owa_2:t,owa_3:n,owa_4:r,owa_5:a,itemId:o,errorDetails:Object(Q.T)(i),rA:s,crId:c,rp:!!u},{isCore:!0})}var le=n(3077),fe=n(4174),we=n(4175),be=n(4984),me=n(6983),Ie=n(8139),ge=n(4570),Oe=n(7590);let ye,Ne;const pe=Object(A.e)(Ie.b,"clone_onNudgeInfoBarClicked",e=>{const t=e.response===Ie.a.MarkComplete?"MarkedComplete":"DismissedOnView";Ke(e.rowKey,e.itemId,t,"ReadingPane")}),ve=Object(A.e)(me.a,"clone_onDismissNudgeClicked",e=>{Object(K.f)().nudgedRows.filter(t=>t.rowKey===e.rowKey&&t.tableViewId===e.tableViewId).forEach(t=>{Ke(e.rowKey,t.itemId,"Dismissed",e.actionSource)})}),he=Object(A.e)(we.a,"clone_markItemsAsPinnedStoreUpdate",e=>{Ce(e.rowKeys,e.tableViewId,e.shouldMarkAsPinned)}),je=Object(A.e)(fe.a,"clone_markConversationsAsPinnedStoreUpdate",e=>{Ce(e.rowKeys,e.tableViewId,e.shouldMarkAsPinned)}),Re=Object(A.e)(le.a,"clone_deleteItemsStoreUpdate",e=>{e.itemContexts.map(e=>e.itemId).forEach(t=>{const n=Object(K.e)(t);n&&(Object(K.i)(n),U(n,e.actionType,De(n)))})}),Te=Object(A.e)(S.a,"clone_removeRowsFromListViewStore",e=>{Le(e.rowKeys,e.tableView.id,e.actionType)}),Se=Object(A.e)(be.a,"clone_onSendMessageSucceeded",e=>{const t=e.operation;if(1!==t&&2!==t&&3!==t)return;e.referenceItemId||a.h.warn("Nudge: referenceItemId should not be null for r/R/f operations");const n=e.referenceItemId.Id,o=e.conversationId;let r,i=Object(K.e)(n);i||(i=Object(K.d)(o)),i?(L(i,Object(h.I)()),r=De(i),Object(K.i)(i)):ye==n&&(i=Ne),i&&Object(D.p)("Nudge_Reply",{owa_1:t,owa_2:r,refId:n,cId:o,rKey:i},{isCore:!0})}),Ee=Object(A.e)(Oe.a,"clone_removeNudgeUponRowUpdate",e=>{const t=Object(K.f)().nudgedRows.filter(t=>t.rowKey===e.rowKey);if(t.length>0){const n=z(t[0].itemId,t[0].conversationId,null,e.tableView,"inbox"==Object(F.a)(e.tableView.tableQuery.folderId),e.rowKey,"RowRemove",!1,t[0].nudgeItemTime,t[0].reason);n&&(ye=t[0].itemId,Ne=e.rowKey,L(e.rowKey,e.tableView),Le([e.rowKey],e.tableView.id,n))}}),_e=Object(A.e)(k.a,"updateNudgesOnNudgeOptionChangeClone",e=>{if(Object(ge.a)(32)){const e=Object(K.f)().nudgedRows.map(e=>e.rowKey),t=Object(h.I)();e.forEach(e=>{L(e,t),Le([e],t.id,"NudgeDisabled")})}});function Ce(e,t,n){const o=n?"Pinned":"Unpinned";e.forEach(e=>{Object(K.f)().nudgedRows.filter(n=>n.rowKey===e&&n.tableViewId===t).forEach(e=>{ue(e.itemId,o,"PinUnpin",e.reason)})}),Le(e,t,"PinUnpin")}function Ke(e,t,n,o){ue(t,n,o,De(e)),L(e,Object(h.I)()),Object(K.i)(e)}function Le(e,t,n){e.forEach(e=>{if(Object(K.g)(e,t)){const t=De(e);Object(K.i)(e),U(e,n,t)}})}function De(e){const t=Object(K.f)().nudgedRows.filter(t=>t.rowKey===e);return t.length>0?t[0].reason:null}var Ae=n(2);function xe(e,t,n){if(e.tableViewId!=t.id)return;let o,r="Nudge_Render";const{rowKey:i,conversationId:c,itemId:u}=e;Object(K.a)(i,t.id,h.b.getLastDeliveryOrRenewTimeStamp(i,t))?(o=Object(s.f)(t,0),C.a.updateRowPosition(o,i,t),a.h.info("Nudge: "+n+" updateNudgedRowPosition - row is inserted at "+o)):(r="Nudge_NotRender",a.h.info("Nudge: "+n+" updateNudgedRowPosition - row is pinned")),Object(D.p)(r,{owa_1:n,rKey:i,iId:u,cId:c,index:o},{isCore:!0})}Object(Ae.orchestrator)(K.h,e=>{e.nudgedRows.forEach(t=>xe(t,e.tableView,"onGetNudge"))}),Object(Ae.orchestrator)(s.i,e=>{const t=Object(K.f)().nudgedRows,n=e.tableView;t.filter(e=>e.tableViewId==n.id).forEach(t=>xe(t,e.tableView,"onMerge"))});var Ve=n(52);function Me(){Object(ge.b)(!0,32),Ve.u.importAndExecute([{key:"FocusedInboxBitFlags",valuetype:"Integer32",value:[`${Object(Ve.g)().ViewStateConfiguration.FocusedInboxBitFlags}`]}],"OWA.ViewStateConfiguration"),Object(D.p)("TnS_SaveNudgeOption",[!1,"InlineFeedback"]),Object(k.a)()}n.d(t,"getNudgesOnSelectFolderComplete",(function(){return ee})),n.d(t,"getNudgesOnNudgeOptionChange",(function(){return Z})),n.d(t,"getNudgesOnNudgeRemoved",(function(){return te})),n.d(t,"removeNudgeOnInfoBarClickedOrchestrator",(function(){return pe})),n.d(t,"removeNudgeOnDismissNudgeClickedOrchestrator",(function(){return ve})),n.d(t,"removeNudgeOnItemDeleteStoreUpdateOrchestrator",(function(){return Re})),n.d(t,"removeNudgeOnRowsDeleteStoreUpdateOrchestrator",(function(){return Te})),n.d(t,"removeNudgeOnItemsPinnedStoreUpdateOrchestrator",(function(){return he})),n.d(t,"removeNudgeOnConversationsPinnedStoreUpdateOrchestrator",(function(){return je})),n.d(t,"removeNudgeOnReplyOrReplyAllOrForwardOrchestrator",(function(){return Se})),n.d(t,"updateNudgesOnNudgeOptionChange",(function(){return _e})),n.d(t,"removeNudgeUponRowUpdate",(function(){return Ee})),n.d(t,"disableNudgeOption",(function(){return Me}))},180:function(e,t,n){"use strict";var o=n(22);let r;function i(){return null==r&&(r="undefined"!=typeof window&&null!=window.performance&&null!=window.performance.timing&&null!=window.performance.navigation&&null!=window.performance.getEntriesByName),r}const a=500,s=[],c=[],u=[],d=[];let l,f=!0;function w(e,t){Object(o.g)((e,t,n)=>{f&&(t==o.b.Error&&c.push({message:e,error:n}),s.push({message:e,level:t}))}),e(I),t(I),i()&&(window.performance.setResourceTimingBufferSize?window.performance.setResourceTimingBufferSize(a):window.performance.webkitSetResourceTimingBufferSize&&window.performance.webkitSetResourceTimingBufferSize(a))}function b(e,t,n){l?l(e,t,n):d.push({name:e,customData:t})}function m(e){return l=e,f=!1,{traces:s,errors:c,network:u,usage:d}}function I(){f&&u.push(arguments)}n.d(t,"a",(function(){return w})),n.d(t,"b",(function(){return m})),n.d(t,"d",(function(){return b})),n.d(t,"c",(function(){return i}))},181:function(e,t,n){"use strict";function o(){var e=Object.create(null),t=0,n=0,o=0,r=!1;function i(t){o--,delete e[t]}this.put=function(t,n,r,a){if(void 0!==r&&("number"!=typeof r||isNaN(r)||r<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==a&&"function"!=typeof a)throw new Error("Cache timeout callback must be a function");var s=e[t];s?clearTimeout(s.timeout):o++;var c={value:n,expire:r+Date.now()};return isNaN(c.expire)||(c.timeout=setTimeout(function(){i(t),a&&a(t,n)}.bind(this),r)),e[t]=c,n},this.del=function(t){var n=!0,o=e[t];return o?(clearTimeout(o.timeout),!isNaN(o.expire)&&o.expire<Date.now()&&(n=!1)):n=!1,n&&i(t),n},this.clear=function(){for(var i in e)clearTimeout(e[i].timeout);o=0,e=Object.create(null),r&&(t=0,n=0)},this.get=function(i){var a=e[i];if(void 0!==a){if(isNaN(a.expire)||a.expire>=Date.now())return r&&t++,a.value;r&&n++,o--,delete e[i]}else r&&n++;return null},this.size=function(){return o},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){r=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var o=e[n];t[n]={value:o.value,expire:o.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var o=JSON.parse(t),r=Date.now(),i=n&&n.skipDuplicates;for(var a in o)if(o.hasOwnProperty(a)){if(i)if(e[a])continue;var s=o[a],c=s.expire-r;if(c<=0){this.del(a);continue}c=c>0?c:void 0,this.put(a,s.value,c)}return this.size()}}e.exports=new o,e.exports.Cache=o},211:function(e,t,n){"use strict";var o=n(930);n.d(t,"a",(function(){return o.a}))},2855:function(e,t,n){"use strict";function o(e){return Object.assign({__type:"IndexedPageView:#Exchange"},e)}n.d(t,"a",(function(){return o}))},2892:function(e,t,n){"use strict";n.d(t,"q",(function(){return u})),n.d(t,"t",(function(){return d})),n.d(t,"d",(function(){return l})),n.d(t,"h",(function(){return f})),n.d(t,"o",(function(){return w})),n.d(t,"a",(function(){return b})),n.d(t,"l",(function(){return m})),n.d(t,"e",(function(){return I})),n.d(t,"p",(function(){return g})),n.d(t,"s",(function(){return O})),n.d(t,"r",(function(){return y})),n.d(t,"f",(function(){return N})),n.d(t,"i",(function(){return p})),n.d(t,"j",(function(){return v})),n.d(t,"m",(function(){return h})),n.d(t,"n",(function(){return j})),n.d(t,"c",(function(){return R})),n.d(t,"b",(function(){return T})),n.d(t,"g",(function(){return S})),n.d(t,"k",(function(){return E}));var o=n(66),r=n(2733),i=n(2742),a=n(2),s=n(2788),c=n(30);const u=Object(a.action)("SINGLE_SELECT_ROW",(e,t,n,r)=>Object(o.b)(_(r,e,t),{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})),d=Object(a.action)("TOGGLE_SELECT_ROW",(e,t,n,r)=>Object(o.b)(_(r,e,t),{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})),l=Object(a.action)("ON_AFTER_SELECTION_CHANGED",(e,t,n,o,r)=>({rowKey:e,tableView:t,mailListItemSelectionSource:n,listViewType:o,sxsId:r})),f=Object(a.action)("RESET_LIST_VIEW_EXPANSION_VIEW_STATE"),w=Object(a.action)("SET_SECOND_LEVEL_LIST_VIEW_EXPANSION",e=>({rowKey:e})),b=Object(a.action)("ITEM_PART_SELECTED",(e,t,n,o,r)=>({nodeId:e,itemId:t,allNodeIds:n,tableView:o,mailListItemSelectionSource:r})),m=Object(a.action)("SELECT_NEXT_ITEM_PART",(e,t)=>({rowKey:e,tableView:t})),I=Object(a.action)("ON_ITEM_PART_CONTEXT_MENU",(e,t,n)=>({contextMenuAnchor:e,nodeId:t,tableViewId:n})),g=Object(a.action)("SINGLE_SELECT_ITEM_PART",(e,t,n,o,r)=>({rowKey:e,nodeIdToSelect:t,allNodeIds:n,tableViewId:o,currentSelectedNodeIds:r})),O=Object(a.action)("TOGGLE_SELECT_ITEM_PART",e=>({nodeId:e})),y=Object(a.action)("TOGGLE_SELECT_ALL_ROWS",e=>({tableView:e})),N=Object(a.action)("RANGE_SELECT_ROW",(e,t,n,o)=>({tableView:e,targetRowKey:t,mailListItemSelectionSource:n,isCtrlOrCmdKeyDown:o})),p=Object(a.action)("RESET_SELECTION",(e,t,n)=>({tableView:e,mailListItemSelectionSource:t,isUserNavigation:n})),v=Object(a.action)("RESET_SELECTION",e=>({tableView:e})),h=Object(a.action)("SELECT_ROW_IN_DIRECTION",(e,t,n)=>Object(o.b)(_(n,e,void 0,t),{tableView:e,selectionDirection:t,mailListItemSelectionSource:n})),j=Object(a.action)("SET_EXPANSION_FOR_ROW",(e,t)=>({rowKey:e,mailListItemSelectionSource:t})),R=Object(a.action)("KEYBOARD_MULTI_SELECT_ROW",(e,t,n,o)=>({tableView:e,mailListItemSelectionSource:t,selectionDirection:n,isCtrlOrCmdKeyDown:o})),T=Object(a.action)("KEYBOARD_COLLAPSE_CONVERSATION",e=>({rowKey:e})),S=Object(a.action)("RESET_BUS_STOP_STATE_MAP"),E=Object(a.action)("SELECT_NEW_ITEM_UPON_ROW_REMOVAL",(e,t,n)=>({tableView:e,lastSelectedRowIndex:t,lastSelectedRowWasPinned:n}));function _(e,t,n,o){return{name:function(e,t,n,o){return!(function(e){return e===i.b.MailListItemRichPreview||e===i.b.KeyboardShiftEnter||e===i.b.MailListItemBodyDoubleClick}(e)||Object(s.d)()&&!function(e){var t;return e===i.b.KeyboardEnter||e===i.b.MailListItemBody||e===i.b.RouteHandler||e===i.b.CommandBarArrows||e===i.b.ImmersiveReadingPaneDelete&&"ReturnToView"!==(null===(t=Object(c.a)().UserOptions)||void 0===t?void 0:t.NextSelection)}(e)||function(e,t,n,o){if(Object(s.d)())return!1;if(e===i.b.KeyboardUpDown){const e=t.rowKeys.indexOf(t.selectionAnchorRowKey);if(-1!==e&&1===t.selectedRowKeys.size){const n=t.rowKeys.indexOf([...t.selectedRowKeys.keys()][0]);return o===r.d.Next?n===e+1||n===t.rowKeys.length-1&&e===t.rowKeys.length-1:n===e-1||0===n&&0===e}return!1}return n&&t.selectedRowKeys.has(n)&&1===t.selectedRowKeys.size}(e,t,n,o))}(e,t,n,o)?"SelectMailItem":"SelectMailItemNonCritical",options:{timeout:9e4}}}},316:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var o=n(124),r=n(117),i=n(3);let a;function s(e){a=e}async function c(){var e,t;if(Object(i.P)())return r.f.importAndExecute(Object(o.a)());const n=a&&await a();if(n&&n.length>0){if("bearer"===(null===(e=null==n?void 0:n.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return n.split(" ")[1];if("msauth1.0"===(null===(t=null==n?void 0:n.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return n}}},468:function(e,t,n){"use strict";function o(e,t){const n=Math.pow(2,32);if(e>=n||t>=n){const o=e%n,r=t%n;return(((e-=o)/n&(t-=r)/n)>>>0)*n+((o&r)>>>0)}return(e&t)>>>0}n.d(t,"a",(function(){return o}))},8673:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var o=n(3441),r=n(2733),i=n(3012);function a(e,t,n,o){const a=new Date(r.b.getLastDeliveryTimeStamp(n,o)).getTime()-new Date(t).getTime();if(Object(i.l)(o.tableQuery)){const t=new Date(r.b.getLastDeliveryOrRenewTimeStamp(n,o)).getTime()-new Date(e).getTime();return 0!=t?t:a}return a}function s(e,t,n,r,a){return Object(o.a)(a,n.id,e)?Object(i.f)(n,0):c(e,t,n,r)}function c(e,t,n,i){const s=n.rowKeys.length;if(0==s)return 0;const c=Object(r.K)(n).sortDirection==r.c.DESCENDING_SORT_DIR;let u;for(u=i;u<s;u++){const r=n.rowKeys[u];if(Object(o.a)(r,n.id,e))continue;const i=a(e,t,r,n);if(c?i<=0:i>0)return u}return s==n.totalRowsInView?s:-1}},930:function(e,t,n){"use strict";function o(e){return e>=200&&e<300}n.d(t,"a",(function(){return o}))},963:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return r}));const o=1,r=16}}]);
//# sourceMappingURL=owa.994.js.map
self.scriptsLoaded['owa.994.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.994.js'] = (new Date()).getTime();