self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.1143.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[1143],{159:function(t,a,e){"use strict";e.d(a,"a",(function(){return s})),e.d(a,"b",(function(){return i}));const n=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function c(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function s(){return c()+c()+"-"+c()+"-"+c()+"-"+c()+"-"+c()+c()+c()}function i(t){return n.test(t)}},20073:function(t,a,e){"use strict";e.r(a);var n=e(3382),c=e(5991),s=e(3473),i=e(4033),o=e(4158),r=e(2),b=e(2891),u=e(2754),d=e(2750);var l=Object(r.mutatorAction)("Tab_ReloadSecondaryTabAsDeeplink",(t,a)=>{const e=function(t){var a,e;const n=Object(d.a)();for(const c of n.tabs)if(c.type!==u.a.Primary&&c.type!==u.a.SxS&&(null===(e=null===(a=c.data)||void 0===a?void 0:a.id)||void 0===e?void 0:e.Id)==t)return c;return null}(t);if(e){const t=Object(b.a)(e.type);t&&t.reloadAsDeeplink(e,a)}});e.d(a,"activateTab",(function(){return n.a})),e.d(a,"closeTab",(function(){return c.a})),e.d(a,"setTabIsShown",(function(){return s.a})),e.d(a,"getTabById",(function(){return i.a})),e.d(a,"addTab",(function(){return o.a})),e.d(a,"reloadSecondaryTabAsDeeplink",(function(){return l}))},3382:function(t,a,e){"use strict";var n=e(2754),c=e(2902),s=e(3473),i=e(68),o=e(358),r=e(2891);a.a=Object(o.action)("activateTab")((function(t,a){const e=new i.b("TabViewActivateTab",{isVerbose:!0});switch(e.addCustomData([t.type,a]),Object(s.a)(t,!0),t.type){case n.a.Primary:case n.a.OverflowMenu:case n.a.SecondaryReadingPane:case n.a.MailCompose:if(2!=t.state){const a=Object(c.a)();if(a){a.state=1;const t=Object(r.a)(a.type);(null==t?void 0:t.onDeactivate)&&t.onDeactivate(a)}if(t){t.state=2,t.blink=!1;const a=Object(r.a)(t.type);(null==a?void 0:a.onActivate)&&a.onActivate(t)}}}e.end()}))},3473:function(t,a,e){"use strict";var n=e(3382),c=e(358),s=e(2750);a.a=Object(c.action)("setTabIsShown")((function(t,a){switch(t.state){case 0:a&&(t.state=1,t.blink=!0);break;case 1:case 2:case 3:if(!a){const a=2==t.state&&function(t){const a=Object(s.a)().tabs,e=Math.max(a.indexOf(t),0),n=a.filter(a=>a.id==t.parentTabId&&1==a.state)[0];if(n)return n;for(let t=e;t<a.length;t++)if(1==a[t].state)return a[t];for(let t=e-1;t>=0;t--)if(1==a[t].state)return a[t];return null}(t);a&&Object(n.a)(a),t.state=0}}}))},4033:function(t,a,e){"use strict";e.d(a,"a",(function(){return c}));var n=e(2750);function c(t){if(t){const a=Object(n.a)();for(const e of a.tabs)if(e.id==t)return e}return null}},4158:function(t,a,e){"use strict";var n=e(2902),c=e(2754),s=e(159),i=e(2),o=e(2750),r=e(3382);let b=Object(i.action)("ADD_TAB_VIEW_STATE",(t,a)=>({viewState:t,makeActive:a}));var u=b;Object(i.orchestrator)(b,t=>{const{viewState:a,makeActive:e}=t,n=Object(o.a)();d(a),e&&Object(r.a)(n.tabs[n.tabs.length-1])});const d=Object(i.mutatorAction)("addTabToStore",t=>{Object(o.a)().tabs.push(t)});e.d(a,"a",(function(){return O}));let l=1;const f="SXSID_";function O(t,a,e,i){const o=Object(n.a)(),r={id:c.a[t]+(l++).toString(),state:a?1:0,startTime:(new Date).getTime(),parentTabId:o?o.id:null,blink:a,data:i,sxsId:t===c.a.SxS&&i||f+Object(s.a)()};let b=null;switch(t){case c.a.Primary:b=Object.assign(Object.assign({},r),{type:c.a.Primary});break;case c.a.OverflowMenu:b=Object.assign(Object.assign({},r),{type:c.a.OverflowMenu,data:i});break;case c.a.SecondaryReadingPane:b=Object.assign(Object.assign({},r),{type:c.a.SecondaryReadingPane,data:i});break;case c.a.MailCompose:b=Object.assign(Object.assign({},r),{type:c.a.MailCompose,data:i,projectionRPTabId:null});break;case c.a.SxS:b=Object.assign(Object.assign({},r),{type:c.a.SxS});break;case c.a.CalendarCompose:b=Object.assign(Object.assign({},r),{type:c.a.CalendarCompose,data:i})}return u(b,e),b.id}},5991:function(t,a,e){"use strict";var n={TabViewAddTab:{name:"TabViewAddTab",customData:(t,a,e,n)=>[t,a,e]},TabViewCloseTab:{name:"TabViewCloseTab",customData:(t,a)=>[t.type,1==t.state||2==t.state,2==t.state,a,t.startTime?(new Date).getTime()-t.startTime:0]}},c=e(3473),s=e(68),i=e(2),o=e(2891),r=e(2750);a.a=Object(s.s)(n.TabViewCloseTab,(async function(t,a){let e=!0;const n=Object(o.a)(t.type);if(!a&&n&&n.canClose&&(e=await n.canClose(t)),e){Object(c.a)(t,!1);const a=Object(r.a)().tabs.indexOf(t);a>=0&&b(a)}}));const b=Object(i.mutatorAction)("spliceTabs",t=>{Object(r.a)().tabs.splice(t,1)})}}]);
//# sourceMappingURL=owa.1143.js.map
self.scriptsLoaded['owa.1143.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.1143.js'] = (new Date()).getTime();